/*! For license information please see main.f1daa222.js.LICENSE.txt */
(()=>{var e={3:e=>{e.exports=e=>{const t={};return"undefined"!==typeof WorkerGlobalScope?t.type="webworker":"object"===typeof document?t.type="browser":"object"===typeof process&&(t.type="node"),"undefined"===typeof e?t:t[e]}},34:(e,t,s)=>{const n=s(597),i=s(476),a=s(871),r=s(942),o=s(870),l=s(383);e.exports={defaultOptions:n,spawnWorker:i,terminateWorker:a,onMessage:r,send:o,loadImage:l}},43:(e,t,s)=>{"use strict";e.exports=s(202)},95:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AuthAdminApi:()=>Nt,AuthApiError:()=>We,AuthClient:()=>Tt,AuthError:()=>Ue,AuthImplicitGrantRedirectError:()=>Ze,AuthInvalidCredentialsError:()=>Qe,AuthInvalidTokenResponseError:()=>Je,AuthPKCEGrantCodeExchangeError:()=>tt,AuthRetryableFetchError:()=>st,AuthSessionMissingError:()=>Ye,AuthUnknownError:()=>Ge,AuthWeakPasswordError:()=>it,CustomAuthError:()=>Xe,FunctionRegion:()=>o,FunctionsError:()=>n,FunctionsFetchError:()=>i,FunctionsHttpError:()=>r,FunctionsRelayError:()=>a,GoTrueAdminApi:()=>vt,GoTrueClient:()=>jt,NavigatorLockAcquireTimeoutError:()=>St,PostgrestError:()=>g,REALTIME_CHANNEL_STATES:()=>H,REALTIME_LISTEN_TYPES:()=>z,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:()=>F,REALTIME_PRESENCE_LISTEN_EVENTS:()=>O,REALTIME_SUBSCRIBE_STATES:()=>$,RealtimeChannel:()=>U,RealtimeClient:()=>q,RealtimePresence:()=>B,SupabaseClient:()=>Rt,createClient:()=>It,isAuthApiError:()=>qe,isAuthError:()=>Ve,isAuthImplicitGrantRedirectError:()=>et,isAuthRetryableFetchError:()=>nt,isAuthSessionMissingError:()=>Ke,isAuthWeakPasswordError:()=>at,lockInternals:()=>wt,navigatorLock:()=>At});class n extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",s=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=s}}class i extends n{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class a extends n{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class r extends n{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var o;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(o||(o={}));var l=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{l(n.next(e))}catch(t){a(t)}}function o(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};class c{constructor(e){let{headers:t={},customFetch:n,region:i=o.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=i,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(s.bind(s,630)).then((e=>{let{default:s}=e;return s(...t)}))}:fetch),function(){return t(...arguments)}})(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s;return l(this,void 0,void 0,(function*(){try{const{headers:n,method:o,body:l}=t;let c,d={},{region:h}=t;h||(h=this.region),h&&"any"!==h&&(d["x-region"]=h),l&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",c=l):"string"===typeof l?(d["Content-Type"]="text/plain",c=l):"undefined"!==typeof FormData&&l instanceof FormData?c=l:(d["Content-Type"]="application/json",c=JSON.stringify(l)));const u=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),n),body:c}).catch((e=>{throw new i(e)})),p=u.headers.get("x-relay-error");if(p&&"true"===p)throw new a(u);if(!u.ok)throw new r(u);let f,m=(null!==(s=u.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return f="application/json"===m?yield u.json():"application/octet-stream"===m?yield u.blob():"text/event-stream"===m?u:"multipart/form-data"===m?yield u.formData():yield u.text(),{data:f,error:null}}catch(n){return{data:null,error:n}}}))}}var d=s(980);const{PostgrestClient:h,PostgrestQueryBuilder:u,PostgrestFilterBuilder:p,PostgrestTransformBuilder:f,PostgrestBuilder:m,PostgrestError:g}=d,b={"X-Client-Info":"realtime-js/2.11.2"};var v,y,x,w,_,S;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(v||(v={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(y||(y={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(x||(x={})),function(e){e.websocket="websocket"}(w||(w={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(_||(_={}));class A{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const r=s.decode(e.slice(a,a+n));a+=n;const o=s.decode(e.slice(a,a+i));a+=i;return{ref:null,topic:r,event:o,payload:JSON.parse(s.decode(e.slice(a,e.byteLength)))}}}class k{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(S||(S={}));const E=function(e,t){var s;const n=null!==(s=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==s?s:[];return Object.keys(t).reduce(((s,i)=>(s[i]=C(i,e,t,n),s)),{})},C=(e,t,s,n)=>{const i=t.find((t=>t.name===e)),a=null===i||void 0===i?void 0:i.type,r=s[e];return a&&!n.includes(a)?j(a,r):N(r)},j=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return R(t,s)}switch(e){case S.bool:return T(t);case S.float4:case S.float8:case S.int2:case S.int4:case S.int8:case S.numeric:case S.oid:return P(t);case S.json:case S.jsonb:return M(t);case S.timestamp:return I(t);case S.abstime:case S.date:case S.daterange:case S.int4range:case S.int8range:case S.money:case S.reltime:case S.text:case S.time:case S.timestamptz:case S.timetz:case S.tsrange:case S.tstzrange:default:return N(t)}},N=e=>e,T=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},P=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},M=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},R=(e,t)=>{if("string"!==typeof e)return e;const s=e.length-1,n=e[s];if("{"===e[0]&&"}"===n){let n;const a=e.slice(1,s);try{n=JSON.parse("["+a+"]")}catch(i){n=a?a.split(","):[]}return n.map((e=>j(t,e)))}return e},I=e=>"string"===typeof e?e.replace(" ","T"):e,D=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class L{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:s}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(s)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var O,F,z,$;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(O||(O={}));class B{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},(e=>{const{onJoin:t,onLeave:s,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=B.syncState(this.state,e,t,s),this.pendingDiffs.forEach((e=>{this.state=B.syncDiff(this.state,e,t,s)})),this.pendingDiffs=[],n()})),this.channel._on(s.diff,{},(e=>{const{onJoin:t,onLeave:s,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=B.syncDiff(this.state,e,t,s),n())})),this.onJoin(((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})})),this.onLeave(((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,s,n){const i=this.cloneDeep(e),a=this.transformState(t),r={},o={};return this.map(i,((e,t)=>{a[e]||(o[e]=t)})),this.map(a,((e,t)=>{const s=i[e];if(s){const n=t.map((e=>e.presence_ref)),i=s.map((e=>e.presence_ref)),a=t.filter((e=>i.indexOf(e.presence_ref)<0)),l=s.filter((e=>n.indexOf(e.presence_ref)<0));a.length>0&&(r[e]=a),l.length>0&&(o[e]=l)}else r[e]=t})),this.syncDiff(i,{joins:r,leaves:o},s,n)}static syncDiff(e,t,s,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,((t,n)=>{var i;const a=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(n),a.length>0){const s=e[t].map((e=>e.presence_ref)),n=a.filter((e=>s.indexOf(e.presence_ref)<0));e[t].unshift(...n)}s(t,a,n)})),this.map(a,((t,s)=>{let i=e[t];if(!i)return;const a=s.map((e=>e.presence_ref));i=i.filter((e=>a.indexOf(e.presence_ref)<0)),e[t]=i,n(t,i,s),0===i.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((s=>t(s,e[s])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,s)=>{const n=e[s];return t[s]="metas"in n?n.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):n,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(F||(F={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(z||(z={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}($||($={}));const H=y;class U{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},s=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=y.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new L(this,x.join,this.params,this.timeout),this.rejoinTimer=new k((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=y.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=y.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=y.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=y.errored,this.rejoinTimer.scheduleTimeout())})),this._on(x.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new B(this),this.broadcastEndpointURL=D(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:r}}=this.params;this._onError((t=>null===e||void 0===e?void 0:e($.CHANNEL_ERROR,t))),this._onClose((()=>null===e||void 0===e?void 0:e($.CLOSED)));const o={},l={broadcast:i,presence:a,postgres_changes:null!==(n=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map((e=>e.filter)))&&void 0!==n?n:[],private:r};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async t=>{let{postgres_changes:s}=t;var n;if(this.socket.setAuth(),void 0!==s){const t=this.bindings.postgres_changes,i=null!==(n=null===t||void 0===t?void 0:t.length)&&void 0!==n?n:0,a=[];for(let n=0;n<i;n++){const i=t[n],{filter:{event:r,schema:o,table:l,filter:c}}=i,d=s&&s[n];if(!d||d.event!==r||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null===e||void 0===e||e($.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));a.push(Object.assign(Object.assign({},i),{id:d.id}))}return this.bindings.postgres_changes=a,void(e&&e($.SUBSCRIBED))}null===e||void 0===e||e($.SUBSCRIBED)})).receive("error",(t=>{null===e||void 0===e||e($.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null===e||void 0===e||e($.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,n;if(this._canPush()||"broadcast"!==e.type)return new Promise((s=>{var n,i,a;const r=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(a=null===(i=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===i?void 0:i.broadcast)||void 0===a?void 0:a.ack)||s("ok"),r.receive("ok",(()=>s("ok"))),r.receive("error",(()=>s("error"))),r.receive("timeout",(()=>s("timed out")))}));{const{event:a,payload:r}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:r,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(i){return"AbortError"===i.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=y.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(x.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((s=>{const n=new L(this,x.leave,{},e);n.receive("ok",(()=>{t(),s("ok")})).receive("timeout",(()=>{t(),s("timed out")})).receive("error",(()=>{s("error")})),n.send(),this._canPush()||n.trigger("ok",{})}))}async _fetchWithTimeout(e,t,s){const n=new AbortController,i=setTimeout((()=>n.abort()),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new L(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,i;const a=e.toLocaleLowerCase(),{close:r,error:o,leave:l,join:c}=x;if(s&&[r,o,l,c].indexOf(a)>=0&&s!==this._joinRef())return;let d=this._onMessage(a,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter((e=>{var t,s,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===n?void 0:n.toLocaleLowerCase())===a})).map((e=>e.callback(d,s))):null===(i=this.bindings[a])||void 0===i||i.filter((e=>{var s,n,i,r,o,l;if(["broadcast","presence","postgres_changes"].includes(a)){if("id"in e){const a=e.id,r=null===(s=e.filter)||void 0===s?void 0:s.event;return a&&(null===(n=t.ids)||void 0===n?void 0:n.includes(a))&&("*"===r||(null===r||void 0===r?void 0:r.toLocaleLowerCase())===(null===(i=t.data)||void 0===i?void 0:i.type.toLocaleLowerCase()))}{const s=null===(o=null===(r=null===e||void 0===e?void 0:e.filter)||void 0===r?void 0:r.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===a})).map((e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:n,type:i,errors:a}=e,r={schema:t,table:s,commit_timestamp:n,eventType:i,new:{},old:{},errors:a};d=Object.assign(Object.assign({},r),this._getPayloadRecords(e))}e.callback(d,s)}))}_isClosed(){return this.state===y.closed}_isJoined(){return this.state===y.joined}_isJoining(){return this.state===y.joining}_isLeaving(){return this.state===y.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter((e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===s&&U.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(x.close,{},e)}_onError(e){this._on(x.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=y.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=E(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=E(e.columns,e.old_record)),t}}const V=()=>{},W="undefined"!==typeof WebSocket;class q{constructor(e,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=b,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=V,this.conn=null,this.sendBuffer=[],this.serializer=new A,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(s.bind(s,630)).then((e=>{let{default:s}=e;return s(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint=`${e}/${w.websocket}`,this.httpEndpoint=D(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=null===(n=null===t||void 0===t?void 0:t.params)||void 0===n?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new k((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(W)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new G(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),s.e(198).then(s.t.bind(s,198,23)).then((e=>{let{default:t}=e;this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case v.connecting:return _.Connecting;case v.open:return _.Open;case v.closing:return _.Closing;default:return _.Closed}}isConnected(){return this.connectionState()===_.Open}channel(e){const t=new U(`realtime:${e}`,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},this);return this.channels.push(t),t}push(e){const{topic:t,event:s,payload:n,ref:i}=e,a=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${s} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let s=null;try{s=JSON.parse(atob(e.split(".")[1]))}catch(t){}if(s&&s.exp){if(!(Math.floor(Date.now()/1e3)-s.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`)}this.accessTokenValue=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(x.access_token,{access_token:e})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:s,payload:n,ref:i}=e;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${s} ${i&&"("+i+")"||""}`,n),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(s,n,i))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(x.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class G{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=v.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class X extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Y(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class K extends X{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class J extends X{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Q=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{l(n.next(e))}catch(t){a(t)}}function o(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};const Z=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(s.bind(s,630)).then((e=>{let{default:s}=e;return s(...t)}))}:fetch),function(){return t(...arguments)}},ee=e=>{if(Array.isArray(e))return e.map((e=>ee(e)));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((e=>{let[s,n]=e;const i=s.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[i]=ee(n)})),t};var te=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{l(n.next(e))}catch(t){a(t)}}function o(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};const se=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ne=(e,t,n)=>te(void 0,void 0,void 0,(function*(){const i=yield Q(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(s.bind(s,630))).Response:Response}));e instanceof i&&!(null===n||void 0===n?void 0:n.noResolveJson)?e.json().then((s=>{t(new K(se(s),e.status||500))})).catch((e=>{t(new J(se(e),e))})):t(new J(se(e),e))}));function ie(e,t,s,n,i,a){return te(this,void 0,void 0,(function*(){return new Promise(((r,o)=>{e(s,((e,t,s,n)=>{const i={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),s))})(t,n,i,a)).then((e=>{if(!e.ok)throw e;return(null===n||void 0===n?void 0:n.noResolveJson)?e:e.json()})).then((e=>r(e))).catch((e=>ne(e,o,n)))}))}))}function ae(e,t,s,n){return te(this,void 0,void 0,(function*(){return ie(e,"GET",t,s,n)}))}function re(e,t,s,n,i){return te(this,void 0,void 0,(function*(){return ie(e,"POST",t,n,i,s)}))}function oe(e,t,s,n,i){return te(this,void 0,void 0,(function*(){return ie(e,"DELETE",t,n,i,s)}))}var le=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{l(n.next(e))}catch(t){a(t)}}function o(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};const ce={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},de={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class he{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=s,this.fetch=Z(n)}uploadOrUpdate(e,t,s,n){return le(this,void 0,void 0,(function*(){try{let i;const a=Object.assign(Object.assign({},de),n);let r=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(a.upsert)});const o=a.metadata;"undefined"!==typeof Blob&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",s)):"undefined"!==typeof FormData&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=s,r["cache-control"]=`max-age=${a.cacheControl}`,r["content-type"]=a.contentType,o&&(r["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null===n||void 0===n?void 0:n.headers)&&(r=Object.assign(Object.assign({},r),n.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:r},(null===a||void 0===a?void 0:a.duplex)?{duplex:a.duplex}:{})),h=yield d.json();if(d.ok)return{data:{path:l,id:h.Id,fullPath:h.Key},error:null};return{data:null,error:h}}catch(i){if(Y(i))return{data:null,error:i};throw i}}))}upload(e,t,s){return le(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,s)}))}uploadToSignedUrl(e,t,s,n){return le(this,void 0,void 0,(function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),r=new URL(this.url+`/object/upload/sign/${a}`);r.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:de.upsert},n),a=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!==typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,a["cache-control"]=`max-age=${t.cacheControl}`,a["content-type"]=t.contentType);const o=yield this.fetch(r.toString(),{method:"PUT",body:e,headers:a}),l=yield o.json();if(o.ok)return{data:{path:i,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(Y(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return le(this,void 0,void 0,(function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(n["x-upsert"]="true");const i=yield re(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+i.url),r=a.searchParams.get("token");if(!r)throw new X("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:r},error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}}))}update(e,t,s){return le(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,s)}))}move(e,t,s){return le(this,void 0,void 0,(function*(){try{return{data:yield re(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===s||void 0===s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}copy(e,t,s){return le(this,void 0,void 0,(function*(){try{return{data:{path:(yield re(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===s||void 0===s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}createSignedUrl(e,t,s){return le(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e),i=yield re(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null===s||void 0===s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const a=(null===s||void 0===s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}createSignedUrls(e,t,s){return le(this,void 0,void 0,(function*(){try{const n=yield re(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=(null===s||void 0===s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:n.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${i}`):null}))),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}download(e,t){return le(this,void 0,void 0,(function*(){const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),i=n?`?${n}`:"";try{const t=this._getFinalPath(e),n=yield ae(this.fetch,`${this.url}/${s}/${t}${i}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(a){if(Y(a))return{data:null,error:a};throw a}}))}info(e){return le(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield ae(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ee(e),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}}))}exists(e){return le(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,n){return te(this,void 0,void 0,(function*(){return ie(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),n)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Y(s)&&s instanceof J){const e=s.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:s}}throw s}}))}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],i=(null===t||void 0===t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==i&&n.push(i);const a="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",r=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==r&&n.push(r);let o=n.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${o}`)}}}remove(e){return le(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}))}list(e,t,s){return le(this,void 0,void 0,(function*(){try{const n=Object.assign(Object.assign(Object.assign({},ce),t),{prefix:e||""});return{data:yield re(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ue={"X-Client-Info":"storage-js/2.7.1"};var pe=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{l(n.next(e))}catch(t){a(t)}}function o(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};class fe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},ue),t),this.fetch=Z(s)}listBuckets(){return pe(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}}))}getBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return pe(this,void 0,void 0,(function*(){try{return{data:yield re(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}}))}updateBucket(e,t){return pe(this,void 0,void 0,(function*(){try{const s=yield function(e,t,s,n,i){return te(this,void 0,void 0,(function*(){return ie(e,"PUT",t,n,i,s)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(s){if(Y(s))return{data:null,error:s};throw s}}))}emptyBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield re(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}))}}class me extends fe{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new he(this.url,this.headers,e,this.fetch)}}let ge="";ge="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const be={headers:{"X-Client-Info":`supabase-js-${ge}/2.48.1`}},ve={schema:"public"},ye={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},xe={};var we=s(630),_e=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{l(n.next(e))}catch(t){a(t)}}function o(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};const Se=e=>{let t;return t=e||("undefined"===typeof fetch?we.default:fetch),function(){return t(...arguments)}},Ae=(e,t,s)=>{const n=Se(s),i="undefined"===typeof Headers?we.Headers:Headers;return(s,a)=>_e(void 0,void 0,void 0,(function*(){var r;const o=null!==(r=yield t())&&void 0!==r?r:e;let l=new i(null===a||void 0===a?void 0:a.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),n(s,Object.assign(Object.assign({},a),{headers:l}))}))};var ke=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{l(n.next(e))}catch(t){a(t)}}function o(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};const Ee="2.67.3",Ce={"X-Client-Info":`gotrue-js/${Ee}`},je="X-Supabase-Api-Version",Ne={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"};const Te=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Pe={tested:!1,writable:!1},Me=()=>{if(!Te())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(Pe.tested)return Pe.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Pe.tested=!0,Pe.writable=!0}catch(t){Pe.tested=!0,Pe.writable=!1}return Pe.writable};const Re=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Promise.resolve().then(s.bind(s,630)).then((e=>{let{default:s}=e;return s(...t)}))}:fetch),function(){return t(...arguments)}},Ie=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},De=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(n){return s}},Le=async(e,t)=>{await e.removeItem(t)};class Oe{constructor(){this.promise=new Oe.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Fe(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s,n,i,a,r,o,l,c="",d=0;for(e=e.replace("-","+").replace("_","/");d<e.length;)a=t.indexOf(e.charAt(d++)),r=t.indexOf(e.charAt(d++)),o=t.indexOf(e.charAt(d++)),l=t.indexOf(e.charAt(d++)),s=a<<2|r>>4,n=(15&r)<<4|o>>2,i=(3&o)<<6|l,c+=String.fromCharCode(s),64!=o&&0!=n&&(c+=String.fromCharCode(n)),64!=l&&0!=i&&(c+=String.fromCharCode(i));return c}(s))}function ze(e){return("0"+e.toString(16)).substr(-2)}async function $e(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Be(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let n=0;n<56;n++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,ze).join("")}();let i=n;s&&(i+="/PASSWORD_RECOVERY"),await Ie(e,`${t}-code-verifier`,i);const a=await $e(n);return[a,n===a?"plain":"s256"]}Oe.promiseConstructor=Promise;const He=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class Ue extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Ve(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class We extends Ue{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function qe(e){return Ve(e)&&"AuthApiError"===e.name}class Ge extends Ue{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Xe extends Ue{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class Ye extends Xe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Ke(e){return Ve(e)&&"AuthSessionMissingError"===e.name}class Je extends Xe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qe extends Xe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ze extends Xe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function et(e){return Ve(e)&&"AuthImplicitGrantRedirectError"===e.name}class tt extends Xe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class st extends Xe{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function nt(e){return Ve(e)&&"AuthRetryableFetchError"===e.name}class it extends Xe{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}function at(e){return Ve(e)&&"AuthWeakPasswordError"===e.name}var rt=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(s[n[i]]=e[n[i]])}return s};const ot=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),lt=[502,503,504];async function ct(e){var t,s;if(!("object"===typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"===typeof s.json))throw new st(ot(e),0);if(lt.includes(e.status))throw new st(ot(e),e.status);let n,i;try{n=await e.json()}catch(r){throw new Ge(ot(r),r)}const a=function(e){const t=e.headers.get(je);if(!t)return null;if(!t.match(He))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(r){return null}}(e);if(a&&a.getTime()>=Ne.timestamp&&"object"===typeof n&&n&&"string"===typeof n.code?i=n.code:"object"===typeof n&&n&&"string"===typeof n.error_code&&(i=n.error_code),i){if("weak_password"===i)throw new it(ot(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new Ye}else if("object"===typeof n&&n&&"object"===typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0))throw new it(ot(n),e.status,n.weak_password.reasons);throw new We(ot(n),e.status||500,i)}async function dt(e,t,s,n){var i;const a=Object.assign({},null===n||void 0===n?void 0:n.headers);a[je]||(a[je]=Ne.name),(null===n||void 0===n?void 0:n.jwt)&&(a.Authorization=`Bearer ${n.jwt}`);const r=null!==(i=null===n||void 0===n?void 0:n.query)&&void 0!==i?i:{};(null===n||void 0===n?void 0:n.redirectTo)&&(r.redirect_to=n.redirectTo);const o=Object.keys(r).length?"?"+new URLSearchParams(r).toString():"",l=await async function(e,t,s,n,i,a){const r=((e,t,s,n)=>{const i={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),s))})(t,n,i,a);let o;try{o=await e(s,Object.assign({},r))}catch(l){throw console.error(l),new st(ot(l),0)}o.ok||await ct(o);if(null===n||void 0===n?void 0:n.noResolveJson)return o;try{return await o.json()}catch(l){await ct(l)}}(e,t,s+o,{headers:a,noResolveJson:null===n||void 0===n?void 0:n.noResolveJson},{},null===n||void 0===n?void 0:n.body);return(null===n||void 0===n?void 0:n.xform)?null===n||void 0===n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function ht(e){var t;let s=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ut(e){const t=ht(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function pt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ft(e){return{data:e,error:null}}function mt(e){const{action_link:t,email_otp:s,hashed_token:n,redirect_to:i,verification_type:a}=e,r=rt(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:n,redirect_to:i,verification_type:a},user:Object.assign({},r)},error:null}}function gt(e){return e}var bt=function(e,t){var s={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(s[n[i]]=e[n[i]])}return s};class vt{constructor(e){let{url:t="",headers:s={},fetch:n}=e;this.url=t,this.headers=s,this.fetch=Re(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await dt(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ve(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:pt})}catch(s){if(Ve(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=bt(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=null===s||void 0===s?void 0:s.newEmail,delete n.newEmail),await dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:mt,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Ve(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await dt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:pt})}catch(t){if(Ve(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,i,a,r,o;try{const l={nextPage:null,lastPage:0,total:0},c=await dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(i=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==i?i:""},xform:gt});if(c.error)throw c.error;const d=await c.json(),h=null!==(a=c.headers.get("x-total-count"))&&void 0!==a?a:0,u=null!==(o=null===(r=c.headers.get("link"))||void 0===r?void 0:r.split(","))&&void 0!==o?o:[];return u.length>0&&(u.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t})),l.total=parseInt(h)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ve(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await dt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:pt})}catch(t){if(Ve(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await dt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:pt})}catch(s){if(Ve(s))return{data:{user:null},error:s};throw s}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await dt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:pt})}catch(s){if(Ve(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await dt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await dt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}}}const yt={getItem:e=>Me()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Me()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Me()&&globalThis.localStorage.removeItem(e)}};function xt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const wt={debug:!!(globalThis&&Me()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class _t extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class St extends _t{}async function At(e,t,s){wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout((()=>{n.abort(),wt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},(async n=>{if(!n){if(0===t)throw wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new St(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wt.debug)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await s()}finally{wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const kt={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ce,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Et=3e4;async function Ct(e,t,s){return await s()}class jt{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=jt.nextInstanceID,jt.nextInstanceID+=1,this.instanceID>0&&Te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},kt),e);if(this.logDebugMessages=!!n.debug,"function"===typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new vt({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Re(n.fetch),this.lock=n.lock||Ct,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:Te()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=At:this.lock=Ct,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Me()?this.storage=yt:(this.memoryStorage={},this.storage=xt(this.memoryStorage)):(this.memoryStorage={},this.storage=xt(this.memoryStorage)),Te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.logger(`GoTrueClient@${this.instanceID} (${Ee}) ${(new Date).toISOString()}`,...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach(((e,s)=>{t[s]=e}))}catch(n){}return s.searchParams.forEach(((e,s)=>{t[s]=e})),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Te()&&this.detectSessionInUrl&&"none"!==s){const{data:n,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),et(i)){const t=null===(e=i.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:r}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",r),await this._saveSession(a),setTimeout((async()=>{"recovery"===r?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ve(t)?{error:t}:{error:new Ge("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const i=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:ht}),{data:a,error:r}=i;if(r||!a)return{data:{user:null,session:null},error:r};const o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(Ve(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,n;try{let i;if("email"in e){const{email:s,password:n,options:a}=e;let r=null,o=null;"pkce"===this.flowType&&([r,o]=await Be(this.storage,this.storageKey)),i=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo,body:{email:s,password:n,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:r,code_challenge_method:o},xform:ht})}else{if(!("phone"in e))throw new Qe("You must provide either an email or phone number and a password");{const{phone:t,password:a,options:r}=e;i=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:a,data:null!==(s=null===r||void 0===r?void 0:r.data)&&void 0!==s?s:{},channel:null!==(n=null===r||void 0===r?void 0:r.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:ht})}}const{data:a,error:r}=i;if(r||!a)return{data:{user:null,session:null},error:r};const o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(Ve(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:n,options:i}=e;t=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:ut})}else{if(!("phone"in e))throw new Qe("You must provide either an email or phone number and a password");{const{phone:s,password:n,options:i}=e;t=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:ut})}}const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n}):{data:{user:null,session:null},error:new Je}}catch(t){if(Ve(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(i=e.options)||void 0===i?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await De(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:i}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ht});if(await Le(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==n&&void 0!==n?n:null}),error:i}):{data:{user:null,session:null,redirectType:null},error:new Je}}catch(i){if(Ve(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:i,nonce:a}=e,r=await dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:ht}),{data:o,error:l}=r;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Je}}catch(t){if(Ve(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,i,a;try{if("email"in e){const{email:n,options:i}=e;let a=null,r=null;"pkce"===this.flowType&&([a,r]=await Be(this.storage,this.storageKey));const{error:o}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null===i||void 0===i?void 0:i.data)&&void 0!==t?t:{},create_user:null===(s=null===i||void 0===i?void 0:i.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken},code_challenge:a,code_challenge_method:r},redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:s}=e,{data:r,error:o}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null===s||void 0===s?void 0:s.data)&&void 0!==n?n:{},create_user:null===(i=null===s||void 0===s?void 0:s.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},channel:null!==(a=null===s||void 0===s?void 0:s.channel)&&void 0!==a?a:"sms"}});return{data:{user:null,session:null,messageId:null===r||void 0===r?void 0:r.message_id},error:o}}throw new Qe("You must provide either an email or phone number.")}catch(r){if(Ve(r))return{data:{user:null,session:null},error:r};throw r}}async verifyOtp(e){var t,s;try{let n,i;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,i=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:a,error:r}=await dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:ht});if(r)throw r;if(!a)throw new Error("An error occurred on token verification.");const o=a.session,l=a.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(n){if(Ve(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let i=null,a=null;return"pkce"===this.flowType&&([i,a]=await Be(this.storage,this.storageKey)),await dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:ft})}catch(i){if(Ve(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Ye;const{error:n}=await dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}}))}catch(e){if(Ve(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:a}=await dt(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},redirectTo:null===i||void 0===i?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:s,type:n,options:i}=e,{data:a,error:r}=await dt(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:null===a||void 0===a?void 0:a.message_id},error:r}}throw new Qe("You must provide either an email or phone number and a type")}catch(t){if(Ve(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await De(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,n)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,n))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:pt}):await this._useSession((async e=>{var t,s,n;const{data:i,error:a}=e;if(a)throw a;return(null===(t=i.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0,xform:pt}):{data:{user:null},error:new Ye}}))}catch(t){if(Ve(t))return Ke(t)&&(await this._removeSession(),await Le(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Ye;const a=n.session;let r=null,o=null;"pkce"===this.flowType&&null!=e.email&&([r,o]=await Be(this.storage,this.storageKey));const{data:l,error:c}=await dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:r,code_challenge_method:o}),jwt:a.access_token,xform:pt});if(c)throw c;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}}))}catch(s){if(Ve(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return Fe(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ye;const t=Date.now()/1e3;let s=t,n=!0,i=null;const a=Fe(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};i=t}else{const{data:n,error:a}=await this._getUser(e.access_token);if(a)throw a;i={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(Ve(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var s;if(!e){const{data:n,error:i}=t;if(i)throw i;e=null!==(s=n.session)&&void 0!==s?s:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Ye;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Ve(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Te())throw new Ze("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ze(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new tt("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Ze("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new tt("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:r,expires_at:o,token_type:l}=e;if(!i||!r||!a||!l)throw new Ze("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(r);let h=c+d;o&&(h=parseInt(o));const u=h-c;1e3*u<=Et&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${d}s`);const p=h-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,c);const{data:f,error:m}=await this._getUser(i);if(m)throw m;const g={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:d,expires_at:h,refresh_token:a,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(s){if(Ve(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await De(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var s;const{data:n,error:i}=t;if(i)return{error:i};const a=null===(s=n.session)||void 0===s?void 0:s.access_token;if(a){const{error:t}=await this.admin.signOut(a,e);if(t&&(!qe(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Le(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession((async t=>{var s,n;try{const{data:{session:n},error:i}=t;if(i)throw i;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(i){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=null,n=null;"pkce"===this.flowType&&([s,n]=await Be(this.storage,this.storageKey,!0));try{return await dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(Ve(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession((async t=>{var s,n,i,a,r;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:!0});return await dt(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(r=null===(a=o.session)||void 0===a?void 0:a.access_token)&&void 0!==r?r:void 0})}));if(n)throw n;return Te()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===s||void 0===s?void 0:s.url),{data:{provider:e.provider,url:null===s||void 0===s?void 0:s.url},error:null}}catch(s){if(Ve(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var s,n;const{data:i,error:a}=t;if(a)throw a;return await dt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ht})),n=(e,t)=>{const s=200*Math.pow(2,e);return t&&nt(t)&&Date.now()+s-i<Et},new Promise(((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{const t=await s(a);if(!n(a,null,t))return void e(t)}catch(i){if(!n(a,i))return void t(i)}})()})))}catch(i){if(this._debug(t,"error",i),Ve(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(t,"end")}var s,n}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Te()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await De(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s))return this._debug(t,"session is not valid"),void(null!==s&&await this._removeSession());const n=Math.round(Date.now()/1e3),i=(null!==(e=s.expires_at)&&void 0!==e?e:1/0)<n+10;if(this._debug(t,`session has${i?"":" not"} expired with margin of 10s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),nt(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return this._debug(t,"error",s),void console.error(s)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Ye;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Oe;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new Ye;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(i){if(this._debug(n,"error",i),Ve(i)){const e={session:null,error:i};return nt(i)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],i=Array.from(this.stateChangeEmitters.values()).map((async s=>{try{await s.callback(e,t)}catch(i){n.push(i)}}));if(await Promise.all(i),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ie(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Le(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Te()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Et);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*s.expires_at-t)/Et);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(s.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof _t))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Te()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if((null===s||void 0===s?void 0:s.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null===s||void 0===s?void 0:s.scopes)&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await Be(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(s.toString())}if(null===s||void 0===s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);n.push(e.toString())}return(null===s||void 0===s?void 0:s.skipBrowserRedirect)&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await dt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null===n||void 0===n?void 0:n.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var s,n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const r=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await dt(this.fetch,"POST",`${this.url}/factors`,{body:r,headers:this.headers,jwt:null===(s=null===i||void 0===i?void 0:i.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(n=null===o||void 0===o?void 0:o.totp)||void 0===n?void 0:n.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:r}=await dt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null===n||void 0===n?void 0:n.session)||void 0===s?void 0:s.access_token});return r?{data:null,error:r}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:r})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await dt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null===n||void 0===n?void 0:n.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null===e||void 0===e?void 0:e.factors)||[],n=s.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),i=s.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(n.access_token);let r=null;a.aal&&(r=a.aal);let o=r;(null!==(s=null===(t=n.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==s?s:[]).length>0&&(o="aal2");return{data:{currentLevel:r,nextLevel:o,currentAuthenticationMethods:a.amr||[]},error:null}}))))}}jt.nextInstanceID=0;const Nt=vt,Tt=jt;class Pt extends Tt{constructor(e){super(e)}}var Mt=function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function r(e){try{l(n.next(e))}catch(t){a(t)}}function o(e){try{l(n.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};class Rt{constructor(e,t,s){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const r=e.replace(/\/$/,"");this.realtimeUrl=`${r}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${r}/auth/v1`,this.storageUrl=`${r}/storage/v1`,this.functionsUrl=`${r}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:s,auth:n,realtime:i,global:a}=e,{db:r,auth:o,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},r),s),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),i),global:Object.assign(Object.assign({},c),a),accessToken:()=>ke(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!==s&&void 0!==s?s:{},{db:ve,realtime:xe,auth:Object.assign(Object.assign({},ye),{storageKey:o}),global:be});this.storageKey=null!==(n=l.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(i=l.global.headers)&&void 0!==i?i:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(a=l.auth)&&void 0!==a?a:{},this.headers,l.global.fetch),this.fetch=Ae(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new h(`${r}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new me(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,s)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Mt(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,s){let{autoRefreshToken:n,persistSession:i,detectSessionInUrl:a,storage:r,storageKey:o,flowType:l,lock:c,debug:d}=e;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Pt({url:this.authUrl,headers:Object.assign(Object.assign({},h),t),storageKey:o,autoRefreshToken:n,persistSession:i,detectSessionInUrl:a,storage:r,flowType:l,lock:c,debug:d,fetch:s,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new q(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const It=(e,t,s)=>new Rt(e,t,s)},125:e=>{"use strict";e.exports={rE:"6.0.0"}},139:(e,t)=>{var s;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var s=arguments[t];s&&(e=r(e,a(s)))}return e}function a(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var s in e)n.call(e,s)&&e[s]&&(t=r(t,s));return t}function r(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(s=function(){return i}.apply(t,[]))||(e.exports=s)}()},147:e=>{e.exports={workerBlobURL:!0,logger:()=>{}}},153:(e,t,s)=>{"use strict";var n=s(43),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,s){var n,a={},c=null,d=null;for(n in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)r.call(t,n)&&!l.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:i,type:e,key:c,ref:d,props:a,_owner:o.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},173:(e,t,s)=>{e.exports=s(497)()},202:(e,t)=>{"use strict";var s=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function b(e,t,s){this.props=e,this.context=t,this.refs=g,this.updater=s||f}function v(){}function y(e,t,s){this.props=e,this.context=t,this.refs=g,this.updater=s||f}b.prototype.isReactComponent={},b.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},b.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=b.prototype;var x=y.prototype=new v;x.constructor=y,m(x,b.prototype),x.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,S={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var i,a={},r=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(r=""+t.key),t)_.call(t,i)&&!A.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:s,type:e,key:r,ref:o,props:a,_owner:S.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===s}var C=/\/+/g;function j(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,a,r){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case s:case n:l=!0}}if(l)return r=r(l=e),e=""===a?"."+j(l,0):a,w(r)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),N(r,t,i,"",(function(e){return e}))):null!=r&&(E(r)&&(r=function(e,t){return{$$typeof:s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(r,i+(!r.key||l&&l.key===r.key?"":(""+r.key).replace(C,"$&/")+"/")+e)),t.push(r)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var d=a+j(o=e[c],c);l+=N(o,t,i,d,r)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=N(o=o.value,t,i,d=a+j(o,c++),r);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,s){if(null==e)return e;var n=[],i=0;return N(e,n,"","",(function(e){return t.call(s,e,i++)})),n}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M={current:null},R={transition:null},I={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:R,ReactCurrentOwner:S};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,s){T(e,(function(){t.apply(this,arguments)}),s)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=b,t.Fragment=i,t.Profiler=r,t.PureComponent=y,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.act=D,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),a=e.key,r=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(r=t.ref,o=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!A.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:s,type:e.type,key:a,ref:r,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return M.current.useCallback(e,t)},t.useContext=function(e){return M.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return M.current.useDeferredValue(e)},t.useEffect=function(e,t){return M.current.useEffect(e,t)},t.useId=function(){return M.current.useId()},t.useImperativeHandle=function(e,t,s){return M.current.useImperativeHandle(e,t,s)},t.useInsertionEffect=function(e,t){return M.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return M.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return M.current.useMemo(e,t)},t.useReducer=function(e,t,s){return M.current.useReducer(e,t,s)},t.useRef=function(e){return M.current.useRef(e)},t.useState=function(e){return M.current.useState(e)},t.useSyncExternalStore=function(e,t,s){return M.current.useSyncExternalStore(e,t,s)},t.useTransition=function(){return M.current.useTransition()},t.version="18.3.1"},210:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(s(829)),a=n(s(736)),r=s(745);class o{constructor(e){let{headers:t={},schema:s,fetch:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new i.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:n=!1,get:i=!1,count:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=new URL(`${this.url}/rpc/${e}`);let l;n||i?(t=n?"HEAD":"GET",Object.entries(s).filter((e=>{let[t,s]=e;return void 0!==s})).map((e=>{let[t,s]=e;return[t,Array.isArray(s)?`{${s.join(",")}}`:`${s}`]})).forEach((e=>{let[t,s]=e;o.searchParams.append(t,s)}))):(t="POST",l=s);const c=Object.assign({},this.headers);return r&&(c.Prefer=`count=${r}`),new a.default({method:t,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=o},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},234:(e,t)=>{"use strict";function s(e,t){var s=e.length;e.push(t);e:for(;0<s;){var n=s-1>>>1,i=e[n];if(!(0<a(i,t)))break e;e[n]=t,e[s]=i,s=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],s=e.pop();if(s!==t){e[0]=s;e:for(var n=0,i=e.length,r=i>>>1;n<r;){var o=2*(n+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,s))c<i&&0>a(d,l)?(e[n]=d,e[c]=s,n=c):(e[n]=l,e[o]=s,n=o);else{if(!(c<i&&0>a(d,s)))break e;e[n]=d,e[c]=s,n=c}}}return t}function a(e,t){var s=e.sortIndex-t.sortIndex;return 0!==s?s:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,u=null,p=3,f=!1,m=!1,g=!1,b="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=n(d);null!==t;){if(null===t.callback)i(d);else{if(!(t.startTime<=e))break;i(d),t.sortIndex=t.expirationTime,s(c,t)}t=n(d)}}function w(e){if(g=!1,x(e),!m)if(null!==n(c))m=!0,R(_);else{var t=n(d);null!==t&&I(w,t.startTime-e)}}function _(e,s){m=!1,g&&(g=!1,v(E),E=-1),f=!0;var a=p;try{for(x(s),u=n(c);null!==u&&(!(u.expirationTime>s)||e&&!N());){var r=u.callback;if("function"===typeof r){u.callback=null,p=u.priorityLevel;var o=r(u.expirationTime<=s);s=t.unstable_now(),"function"===typeof o?u.callback=o:u===n(c)&&i(c),x(s)}else i(c);u=n(c)}if(null!==u)var l=!0;else{var h=n(d);null!==h&&I(w,h.startTime-s),l=!1}return l}finally{u=null,p=a,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,A=!1,k=null,E=-1,C=5,j=-1;function N(){return!(t.unstable_now()-j<C)}function T(){if(null!==k){var e=t.unstable_now();j=e;var s=!0;try{s=k(!0,e)}finally{s?S():(A=!1,k=null)}}else A=!1}if("function"===typeof y)S=function(){y(T)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,M=P.port2;P.port1.onmessage=T,S=function(){M.postMessage(null)}}else S=function(){b(T,0)};function R(e){k=e,A||(A=!0,S())}function I(e,s){E=b((function(){e(t.unstable_now())}),s)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,R(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var s=p;p=t;try{return e()}finally{p=s}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var s=p;p=e;try{return t()}finally{p=s}},t.unstable_scheduleCallback=function(e,i,a){var r=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?r+a:r:a=r,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>r?(e.sortIndex=a,s(d,e),null===n(c)&&e===n(d)&&(g?(v(E),E=-1):g=!0,I(w,a-r))):(e.sortIndex=o,s(c,e),m||f||(m=!0,R(_))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=p;return function(){var s=p;p=t;try{return e.apply(this,arguments)}finally{p=s}}}},286:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(s(630)),a=n(s(611));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=i.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,s,n;let i=null,r=null,o=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(r="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),a=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");n&&a&&a.length>1&&(o=parseInt(a[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(r)&&(r.length>1?(i={code:"PGRST116",details:`Results contain ${r.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},r=null,o=null,l=406,c="Not Acceptable"):r=1===r.length?r[0]:null)}else{const t=await e.text();try{i=JSON.parse(t),Array.isArray(i)&&404===e.status&&(r=[],i=null,l=200,c="OK")}catch(d){404===e.status&&""===t?(l=204,c="No Content"):i={message:t}}if(i&&this.isMaybeSingle&&(null===(n=null===i||void 0===i?void 0:i.details)||void 0===n?void 0:n.includes("0 rows"))&&(i=null,l=200,c="OK"),i&&this.shouldThrowOnError)throw new a.default(i)}return{error:i,data:r,count:o,status:l,statusText:c}}));return this.shouldThrowOnError||(s=s.catch((e=>{var t,s,n;return{error:{message:`${null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null===e||void 0===e?void 0:e.message}`,details:`${null!==(s=null===e||void 0===e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(n=null===e||void 0===e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}}))),s.then(e,t)}}},346:(e,t,s)=>{const n=s(402),i=s(701),{log:a}=s(926),r=s(593),o=s(511),{defaultOptions:l,spawnWorker:c,terminateWorker:d,onMessage:h,loadImage:u,send:p}=s(34);let f=0;e.exports=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eng",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.LSTM_ONLY,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const g=r("Worker",f),{logger:b,errorHandler:v,...y}=n({...l,...s}),x={},w="string"===typeof e?e.split("+"):e;let _=t,S=m;const A=[o.DEFAULT,o.LSTM_ONLY].includes(t)&&!y.legacyCore;let k,E;const C=new Promise(((e,t)=>{E=e,k=t}));let j=c(y);j.onerror=e=>{k(e.message)},f+=1;const N=e=>{let{id:t,action:s,payload:n}=e;return new Promise(((e,i)=>{a(`[${g}]: Start ${t}, action=${s}`);x[`${s}-${t}`]={resolve:e,reject:i},p(j,{workerId:g,jobId:t,action:s,payload:n})}))},T=(e,t)=>N(i({id:t,action:"loadLanguage",payload:{langs:e,options:{langPath:y.langPath,dataPath:y.dataPath,cachePath:y.cachePath,cacheMethod:y.cacheMethod,gzip:y.gzip,lstmOnly:[o.DEFAULT,o.LSTM_ONLY].includes(_)&&!y.legacyLang}}})),P=(e,t,s,n)=>N(i({id:n,action:"initialize",payload:{langs:e,oem:t,config:s}}));h(j,(e=>{let{workerId:t,jobId:s,status:n,action:i,data:r}=e;const o=`${i}-${s}`;if("resolve"===n)a(`[${t}]: Complete ${s}`),x[o].resolve({jobId:s,data:r}),delete x[o];else if("reject"===n){if(x[o].reject(r),delete x[o],"load"===i&&k(r),!v)throw Error(r);v(r)}else"progress"===n&&b({...r,userJobId:s})}));const M={id:g,worker:j,load:()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),writeText:(e,t,s)=>N(i({id:s,action:"FS",payload:{method:"writeFile",args:[e,t]}})),readText:(e,t)=>N(i({id:t,action:"FS",payload:{method:"readFile",args:[e,{encoding:"utf8"}]}})),removeFile:(e,t)=>N(i({id:t,action:"FS",payload:{method:"unlink",args:[e]}})),FS:(e,t,s)=>N(i({id:s,action:"FS",payload:{method:e,args:t}})),reinitialize:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"eng",t=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;if(A&&[o.TESSERACT_ONLY,o.TESSERACT_LSTM_COMBINED].includes(t))throw Error("Legacy model requested but code missing.");const i=t||_;_=i;const a=s||S;S=a;const r=("string"===typeof e?e.split("+"):e).filter((e=>!w.includes(e)));return w.push(...r),r.length>0?T(r,n).then((()=>P(e,i,a,n))):P(e,i,a,n)},setParameters:function(){return N(i({id:arguments.length>1?arguments[1]:void 0,action:"setParameters",payload:{params:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}}))},recognize:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{text:!0};return N(i({id:arguments.length>3?arguments[3]:void 0,action:"recognize",payload:{image:await u(e),options:t,output:s}}))},detect:async(e,t)=>{if(A)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return N(i({id:t,action:"detect",payload:{image:await u(e)}}))},terminate:async()=>(null!==j&&(d(j),j=null),Promise.resolve())};var R;return N(i({id:R,action:"load",payload:{options:{lstmOnly:A,corePath:y.corePath,logging:y.logging}}})).then((()=>T(e))).then((()=>P(e,t,m))).then((()=>E(M))).catch((()=>{})),C}},374:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(s(286));class a extends i.default{select(e){let t=!1;const s=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:s,foreignTable:n,referencedTable:i=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=i?`${i}.order`:"order",r=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${r?`${r},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e){let{foreignTable:t,referencedTable:s=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="undefined"===typeof s?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t){let{foreignTable:s,referencedTable:n=s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i="undefined"===typeof n?"offset":`${n}.offset`,a="undefined"===typeof n?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:n=!1,wal:i=!1,format:a="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=null!==(r=this.headers.Accept)&&void 0!==r?r:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=a},383:e=>{const t=e=>new Promise(((t,s)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=e=>{let{target:{error:{code:t}}}=e;s(Error(`File could not be read! Code=${t}`))},n.readAsArrayBuffer(e)})),s=async e=>{let n=e;if("undefined"===typeof e)return"undefined";if("string"===typeof e)if(/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e))n=atob(e.split(",")[1]).split("").map((e=>e.charCodeAt(0)));else{const t=await fetch(e);n=await t.arrayBuffer()}else if("undefined"!==typeof HTMLElement&&e instanceof HTMLElement)"IMG"===e.tagName&&(n=await s(e.src)),"VIDEO"===e.tagName&&(n=await s(e.poster)),"CANVAS"===e.tagName&&await new Promise((s=>{e.toBlob((async e=>{n=await t(e),s()}))}));else if("undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas){const s=await e.convertToBlob();n=await t(s)}else(e instanceof File||e instanceof Blob)&&(n=await t(e));return new Uint8Array(n)};e.exports=s},391:(e,t,s)=>{"use strict";var n=s(950);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},400:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},402:(e,t,s)=>{const n="browser"===s(3)("type")?e=>new URL(e,window.location.href).href:e=>e;e.exports=e=>{const t={...e};return["corePath","workerPath","langPath"].forEach((s=>{e[s]&&(t[s]=n(t[s]))})),t}},440:e=>{"use strict";var t=function(){};e.exports=t},447:function(e,t,s){const n=s(701),{log:i}=s(926),a=s(593);let r=0;e.exports=()=>{const e=a("Scheduler",r),t={},s={};let o=[];r+=1;const l=()=>Object.keys(t).length,c=()=>{if(0!==o.length){const e=Object.keys(t);for(let n=0;n<e.length;n+=1)if("undefined"===typeof s[e[n]]){o[0](t[e[n]]);break}}},d=(t,a)=>new Promise(((r,l)=>{const d=n({action:t,payload:a});o.push((async e=>{o.shift(),s[e.id]=d;try{r(await e[t].apply(this,[...a,d.id]))}catch(n){l(n)}finally{delete s[e.id],c()}})),i(`[${e}]: Add ${d.id} to JobQueue`),i(`[${e}]: JobQueue length=${o.length}`),c()}));return{addWorker:s=>(t[s.id]=s,i(`[${e}]: Add ${s.id}`),i(`[${e}]: Number of workers=${l()}`),c(),s.id),addJob:async function(t){if(0===l())throw Error(`[${e}]: You need to have at least one worker before adding jobs`);for(var s=arguments.length,n=new Array(s>1?s-1:0),i=1;i<s;i++)n[i-1]=arguments[i];return d(t,n)},terminate:async()=>{Object.keys(t).forEach((async e=>{await t[e].terminate()})),o=[]},getQueueLen:()=>o.length,getNumWorkers:l}}},476:e=>{e.exports=e=>{let t,{workerPath:s,workerBlobURL:n}=e;if(Blob&&URL&&n){const e=new Blob([`importScripts("${s}");`],{type:"application/javascript"});t=new Worker(URL.createObjectURL(e))}else t=new Worker(s);return t}},497:(e,t,s)=>{"use strict";var n=s(218);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,s,i,a,r){if(r!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return s.PropTypes=s,s}},511:e=>{e.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}},571:e=>{e.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}},579:(e,t,s)=>{"use strict";e.exports=s(153)},588:e=>{e.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}},593:e=>{e.exports=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`},597:(e,t,s)=>{const n=s(125).rE,i=s(147);e.exports={...i,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`}},611:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=s},630:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Headers:()=>r,Request:()=>o,Response:()=>l,default:()=>a,fetch:()=>i});var n=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof s.g)return s.g;throw new Error("unable to locate global object")}();const i=n.fetch,a=n.fetch.bind(n),r=n.Headers,o=n.Request,l=n.Response},701:(e,t,s)=>{const n=s(593);let i=0;e.exports=e=>{let{id:t,action:s,payload:a={}}=e,r=t;return"undefined"===typeof r&&(r=n("Job",i),i+=1),{id:r,action:s,payload:a}}},730:(e,t,s)=>{"use strict";var n=s(43),i=s(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)r.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,s,n,i,a,r){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=r}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var b=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function y(e,t,s,n){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,s,n){if(null===t||"undefined"===typeof t||function(e,t,s,n){if(null!==s&&0===s.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==s?!s.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,s,n))return!0;if(n)return!1;if(null!==s)switch(s.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,s,i,n)&&(s=null),n||null===i?function(e){return!!h.call(f,e)||!h.call(p,e)&&(u.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===s?e.removeAttribute(t):e.setAttribute(t,""+s)):i.mustUseProperty?e[i.propertyName]=null===s?3!==i.type&&"":s:(t=i.attributeName,n=i.attributeNamespace,null===s?e.removeAttribute(t):(s=3===(i=i.type)||4===i&&!0===s?"":""+s,n?e.setAttributeNS(n,t,s):e.setAttribute(t,s))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(b,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(b,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(b,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),C=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),M=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var L,O=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var z=!1;function $(e,t){if(!e||z)return"";z=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=n.stack.split("\n"),r=i.length-1,o=a.length-1;1<=r&&0<=o&&i[r]!==a[o];)o--;for(;1<=r&&0<=o;r--,o--)if(i[r]!==a[o]){if(1!==r||1!==o)do{if(r--,0>--o||i[r]!==a[o]){var l="\n"+i[r].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=r&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?F(e):""}function B(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=$(e.type,!1);case 11:return e=$(e.type.render,!1);case 1:return e=$(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case _:return"Portal";case k:return"Profiler";case A:return"StrictMode";case N:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case j:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return H(e(t))}catch(s){}}return null}function U(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof s&&"function"===typeof s.get&&"function"===typeof s.set){var i=s.get,a=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),n="";return e&&(n=W(e)?e.checked?"true":"false":e.value),(e=n)!==s&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var s=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=s?s:e._wrapperState.initialChecked})}function K(e,t){var s=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;s=V(null!=t.value?t.value:s),e._wrapperState={initialChecked:n,initialValue:s,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Q(e,t){J(e,t);var s=V(t.value),n=t.type;if(null!=s)"number"===n?(0===s&&""===e.value||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,s):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}""!==(s=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==s&&(e.name=s)}function ee(e,t,s){"number"===t&&X(e.ownerDocument)===e||(null==s?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var te=Array.isArray;function se(e,t,s,n){if(e=e.options,t){t={};for(var i=0;i<s.length;i++)t["$"+s[i]]=!0;for(s=0;s<e.length;s++)i=t.hasOwnProperty("$"+e[s].value),e[s].selected!==i&&(e[s].selected=i),i&&n&&(e[s].defaultSelected=!0)}else{for(s=""+V(s),t=null,i=0;i<e.length;i++){if(e[i].value===s)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var s=t.value;if(null==s){if(s=t.children,t=t.defaultValue,null!=s){if(null!=t)throw Error(a(92));if(te(s)){if(1<s.length)throw Error(a(93));s=s[0]}t=s}null==t&&(t=""),s=t}e._wrapperState={initialValue:V(s)}}function ae(e,t){var s=V(t.value),n=V(t.defaultValue);null!=s&&((s=""+s)!==e.value&&(e.value=s),null==t.defaultValue&&e.defaultValue!==s&&(e.defaultValue=s)),null!=n&&(e.defaultValue=""+n)}function re(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,he=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,s,n){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function ue(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&3===s.nodeType)return void(s.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,s){return null==t||"boolean"===typeof t||""===t?"":s||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var s in e=e.style,t)if(t.hasOwnProperty(s)){var n=0===s.indexOf("--"),i=me(s,t[s],n);"float"===s&&(s="cssFloat"),n?e.setProperty(s,i):e[s]=i}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var be=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(be[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Se=null,Ae=null;function ke(e){if(e=yi(e)){if("function"!==typeof _e)throw Error(a(280));var t=e.stateNode;t&&(t=wi(t),_e(e.stateNode,e.type,t))}}function Ee(e){Se?Ae?Ae.push(e):Ae=[e]:Se=e}function Ce(){if(Se){var e=Se,t=Ae;if(Ae=Se=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function je(e,t){return e(t)}function Ne(){}var Te=!1;function Pe(e,t,s){if(Te)return e(t,s);Te=!0;try{return je(e,t,s)}finally{Te=!1,(null!==Se||null!==Ae)&&(Ne(),Ce())}}function Me(e,t){var s=e.stateNode;if(null===s)return null;var n=wi(s);if(null===n)return null;s=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(s&&"function"!==typeof s)throw Error(a(231,t,typeof s));return s}var Re=!1;if(d)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){Re=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(de){Re=!1}function De(e,t,s,n,i,a,r,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(s,c)}catch(d){this.onError(d)}}var Le=!1,Oe=null,Fe=!1,ze=null,$e={onError:function(e){Le=!0,Oe=e}};function Be(e,t,s,n,i,a,r,o,l){Le=!1,Oe=null,De.apply($e,arguments)}function He(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(s=t.return),e=t.return}while(e)}return 3===t.tag?s:null}function Ue(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(He(e)!==e)throw Error(a(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(a(188));return t!==e?null:e}for(var s=e,n=t;;){var i=s.return;if(null===i)break;var r=i.alternate;if(null===r){if(null!==(n=i.return)){s=n;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===s)return Ve(i),e;if(r===n)return Ve(i),t;r=r.sibling}throw Error(a(188))}if(s.return!==n.return)s=i,n=r;else{for(var o=!1,l=i.child;l;){if(l===s){o=!0,s=i,n=r;break}if(l===n){o=!0,n=i,s=r;break}l=l.sibling}if(!o){for(l=r.child;l;){if(l===s){o=!0,s=r,n=i;break}if(l===n){o=!0,n=r,s=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(s.alternate!==n)throw Error(a(190))}if(3!==s.tag)throw Error(a(188));return s.stateNode.current===s?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ge=i.unstable_scheduleCallback,Xe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Ke=i.unstable_requestPaint,Je=i.unstable_now,Qe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,st=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,at=null;var rt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var s=e.pendingLanes;if(0===s)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,r=268435455&s;if(0!==r){var o=r&~i;0!==o?n=ht(o):0!==(a&=r)&&(n=ht(a))}else 0!==(r=s&~i)?n=ht(r):0!==a&&(n=ht(a));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&n)&&(n|=16&s),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(s=31-rt(t)),n|=e[s],t&=~i;return n}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function bt(e,t,s){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-rt(t)]=s}function vt(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var n=31-rt(s),i=1<<n;i&t|e[n]&t&&(e[n]|=t),s&=~i}}var yt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,St,At,kt,Et=!1,Ct=[],jt=null,Nt=null,Tt=null,Pt=new Map,Mt=new Map,Rt=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":jt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mt.delete(t.pointerId)}}function Lt(e,t,s,n,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:s,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&_t(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ot(e){var t=vi(e.target);if(null!==t){var s=He(t);if(null!==s)if(13===(t=s.tag)){if(null!==(t=Ue(s)))return e.blockedOn=t,void kt(e.priority,(function(){St(s)}))}else if(3===t&&s.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===s.tag?s.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var s=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==s)return null!==(t=yi(s))&&_t(t),e.blockedOn=s,!1;var n=new(s=e.nativeEvent).constructor(s.type,s);xe=n,s.target.dispatchEvent(n),xe=null,t.shift()}return!0}function zt(e,t,s){Ft(e)&&s.delete(t)}function $t(){Et=!1,null!==jt&&Ft(jt)&&(jt=null),null!==Nt&&Ft(Nt)&&(Nt=null),null!==Tt&&Ft(Tt)&&(Tt=null),Pt.forEach(zt),Mt.forEach(zt)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,$t)))}function Ht(e){function t(t){return Bt(t,e)}if(0<Ct.length){Bt(Ct[0],e);for(var s=1;s<Ct.length;s++){var n=Ct[s];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==jt&&Bt(jt,e),null!==Nt&&Bt(Nt,e),null!==Tt&&Bt(Tt,e),Pt.forEach(t),Mt.forEach(t),s=0;s<Rt.length;s++)(n=Rt[s]).blockedOn===e&&(n.blockedOn=null);for(;0<Rt.length&&null===(s=Rt[0]).blockedOn;)Ot(s),null===s.blockedOn&&Rt.shift()}var Ut=x.ReactCurrentBatchConfig,Vt=!0;function Wt(e,t,s,n){var i=yt,a=Ut.transition;Ut.transition=null;try{yt=1,Gt(e,t,s,n)}finally{yt=i,Ut.transition=a}}function qt(e,t,s,n){var i=yt,a=Ut.transition;Ut.transition=null;try{yt=4,Gt(e,t,s,n)}finally{yt=i,Ut.transition=a}}function Gt(e,t,s,n){if(Vt){var i=Yt(e,t,s,n);if(null===i)Vn(e,t,n,Xt,s),Dt(e,n);else if(function(e,t,s,n,i){switch(t){case"focusin":return jt=Lt(jt,e,t,s,n,i),!0;case"dragenter":return Nt=Lt(Nt,e,t,s,n,i),!0;case"mouseover":return Tt=Lt(Tt,e,t,s,n,i),!0;case"pointerover":var a=i.pointerId;return Pt.set(a,Lt(Pt.get(a)||null,e,t,s,n,i)),!0;case"gotpointercapture":return a=i.pointerId,Mt.set(a,Lt(Mt.get(a)||null,e,t,s,n,i)),!0}return!1}(i,e,t,s,n))n.stopPropagation();else if(Dt(e,n),4&t&&-1<It.indexOf(e)){for(;null!==i;){var a=yi(i);if(null!==a&&wt(a),null===(a=Yt(e,t,s,n))&&Vn(e,t,n,Xt,s),a===i)break;i=a}null!==i&&n.stopPropagation()}else Vn(e,t,n,null,s)}}var Xt=null;function Yt(e,t,s,n){if(Xt=null,null!==(e=vi(e=we(n))))if(null===(t=He(e)))e=null;else if(13===(s=t.tag)){if(null!==(e=Ue(t)))return e;e=null}else if(3===s){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case st:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,Zt=null;function es(){if(Zt)return Zt;var e,t,s=Qt,n=s.length,i="value"in Jt?Jt.value:Jt.textContent,a=i.length;for(e=0;e<n&&s[e]===i[e];e++);var r=n-e;for(t=1;t<=r&&s[n-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function ts(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ss(){return!0}function ns(){return!1}function is(e){function t(t,s,n,i,a){for(var r in this._reactName=t,this._targetInst=n,this.type=s,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(r)&&(t=e[r],this[r]=t?t(i):i[r]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?ss:ns,this.isPropagationStopped=ns,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ss)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ss)},persist:function(){},isPersistent:ss}),t}var as,rs,os,ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cs=is(ls),ds=O({},ls,{view:0,detail:0}),hs=is(ds),us=O({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:As,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==os&&(os&&"mousemove"===e.type?(as=e.screenX-os.screenX,rs=e.screenY-os.screenY):rs=as=0,os=e),as)},movementY:function(e){return"movementY"in e?e.movementY:rs}}),ps=is(us),fs=is(O({},us,{dataTransfer:0})),ms=is(O({},ds,{relatedTarget:0})),gs=is(O({},ls,{animationName:0,elapsedTime:0,pseudoElement:0})),bs=O({},ls,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vs=is(bs),ys=is(O({},ls,{data:0})),xs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ws={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_s={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ss(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_s[e])&&!!t[e]}function As(){return Ss}var ks=O({},ds,{key:function(e){if(e.key){var t=xs[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ts(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ws[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:As,charCode:function(e){return"keypress"===e.type?ts(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ts(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Es=is(ks),Cs=is(O({},us,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),js=is(O({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:As})),Ns=is(O({},ls,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ts=O({},us,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ps=is(Ts),Ms=[9,13,27,32],Rs=d&&"CompositionEvent"in window,Is=null;d&&"documentMode"in document&&(Is=document.documentMode);var Ds=d&&"TextEvent"in window&&!Is,Ls=d&&(!Rs||Is&&8<Is&&11>=Is),Os=String.fromCharCode(32),Fs=!1;function zs(e,t){switch(e){case"keyup":return-1!==Ms.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $s(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bs=!1;var Hs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Us(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hs[e.type]:"textarea"===t}function Vs(e,t,s,n){Ee(n),0<(t=qn(t,"onChange")).length&&(s=new cs("onChange","change",null,s,n),e.push({event:s,listeners:t}))}var Ws=null,qs=null;function Gs(e){Fn(e,0)}function Xs(e){if(G(xi(e)))return e}function Ys(e,t){if("change"===e)return t}var Ks=!1;if(d){var Js;if(d){var Qs="oninput"in document;if(!Qs){var Zs=document.createElement("div");Zs.setAttribute("oninput","return;"),Qs="function"===typeof Zs.oninput}Js=Qs}else Js=!1;Ks=Js&&(!document.documentMode||9<document.documentMode)}function en(){Ws&&(Ws.detachEvent("onpropertychange",tn),qs=Ws=null)}function tn(e){if("value"===e.propertyName&&Xs(qs)){var t=[];Vs(t,qs,e,we(e)),Pe(Gs,t)}}function sn(e,t,s){"focusin"===e?(en(),qs=s,(Ws=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xs(qs)}function an(e,t){if("click"===e)return Xs(t)}function rn(e,t){if("input"===e||"change"===e)return Xs(t)}var on="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(on(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var i=s[n];if(!h.call(t,i)||!on(e[i],t[i]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dn(e,t){var s,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function un(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var s="string"===typeof t.contentWindow.location.href}catch(n){s=!1}if(!s)break;t=X((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fn(e){var t=un(),s=e.focusedElem,n=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&hn(s.ownerDocument.documentElement,s)){if(null!==n&&pn(s))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if((e=(t=s.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=s.textContent.length,a=Math.min(n.start,i);n=void 0===n.end?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=dn(s,a);var r=dn(s,n);i&&r&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==r.node||e.focusOffset!==r.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(r.node,r.offset)):(t.setEnd(r.node,r.offset),e.addRange(t)))}for(t=[],e=s;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<t.length;s++)(e=t[s]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mn=d&&"documentMode"in document&&11>=document.documentMode,gn=null,bn=null,vn=null,yn=!1;function xn(e,t,s){var n=s.window===s?s.document:9===s.nodeType?s:s.ownerDocument;yn||null==gn||gn!==X(n)||("selectionStart"in(n=gn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&ln(vn,n)||(vn=n,0<(n=qn(bn,"onSelect")).length&&(t=new cs("onSelect","select",null,t,s),e.push({event:t,listeners:n}),t.target=gn)))}function wn(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var _n={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionend:wn("Transition","TransitionEnd")},Sn={},An={};function kn(e){if(Sn[e])return Sn[e];if(!_n[e])return e;var t,s=_n[e];for(t in s)if(s.hasOwnProperty(t)&&t in An)return Sn[e]=s[t];return e}d&&(An=document.createElement("div").style,"AnimationEvent"in window||(delete _n.animationend.animation,delete _n.animationiteration.animation,delete _n.animationstart.animation),"TransitionEvent"in window||delete _n.transitionend.transition);var En=kn("animationend"),Cn=kn("animationiteration"),jn=kn("animationstart"),Nn=kn("transitionend"),Tn=new Map,Pn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mn(e,t){Tn.set(e,t),l(t,[e])}for(var Rn=0;Rn<Pn.length;Rn++){var In=Pn[Rn];Mn(In.toLowerCase(),"on"+(In[0].toUpperCase()+In.slice(1)))}Mn(En,"onAnimationEnd"),Mn(Cn,"onAnimationIteration"),Mn(jn,"onAnimationStart"),Mn("dblclick","onDoubleClick"),Mn("focusin","onFocus"),Mn("focusout","onBlur"),Mn(Nn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ln=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dn));function On(e,t,s){var n=e.type||"unknown-event";e.currentTarget=s,function(e,t,s,n,i,r,o,l,c){if(Be.apply(this,arguments),Le){if(!Le)throw Error(a(198));var d=Oe;Le=!1,Oe=null,Fe||(Fe=!0,ze=d)}}(n,t,void 0,e),e.currentTarget=null}function Fn(e,t){t=0!==(4&t);for(var s=0;s<e.length;s++){var n=e[s],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var r=n.length-1;0<=r;r--){var o=n[r],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;On(i,o,c),a=l}else for(r=0;r<n.length;r++){if(l=(o=n[r]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;On(i,o,c),a=l}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function zn(e,t){var s=t[mi];void 0===s&&(s=t[mi]=new Set);var n=e+"__bubble";s.has(n)||(Un(t,e,2,!1),s.add(n))}function $n(e,t,s){var n=0;t&&(n|=4),Un(s,e,n,t)}var Bn="_reactListening"+Math.random().toString(36).slice(2);function Hn(e){if(!e[Bn]){e[Bn]=!0,r.forEach((function(t){"selectionchange"!==t&&(Ln.has(t)||$n(t,!1,e),$n(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bn]||(t[Bn]=!0,$n("selectionchange",!1,t))}}function Un(e,t,s,n){switch(Kt(t)){case 1:var i=Wt;break;case 4:i=qt;break;default:i=Gt}s=i.bind(null,t,s,e),i=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,s,{capture:!0,passive:i}):e.addEventListener(t,s,!0):void 0!==i?e.addEventListener(t,s,{passive:i}):e.addEventListener(t,s,!1)}function Vn(e,t,s,n,i){var a=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var r=n.tag;if(3===r||4===r){var o=n.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===r)for(r=n.return;null!==r;){var l=r.tag;if((3===l||4===l)&&((l=r.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;r=r.return}for(;null!==o;){if(null===(r=vi(o)))return;if(5===(l=r.tag)||6===l){n=a=r;continue e}o=o.parentNode}}n=n.return}Pe((function(){var n=a,i=we(s),r=[];e:{var o=Tn.get(e);if(void 0!==o){var l=cs,c=e;switch(e){case"keypress":if(0===ts(s))break e;case"keydown":case"keyup":l=Es;break;case"focusin":c="focus",l=ms;break;case"focusout":c="blur",l=ms;break;case"beforeblur":case"afterblur":l=ms;break;case"click":if(2===s.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=ps;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=js;break;case En:case Cn:case jn:l=gs;break;case Nn:l=Ns;break;case"scroll":l=hs;break;case"wheel":l=Ps;break;case"copy":case"cut":case"paste":l=vs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cs}var d=0!==(4&t),h=!d&&"scroll"===e,u=d?null!==o?o+"Capture":null:o;d=[];for(var p,f=n;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==u&&(null!=(m=Me(f,u))&&d.push(Wn(f,m,p)))),h)break;f=f.return}0<d.length&&(o=new l(o,c,null,s,i),r.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||s===xe||!(c=s.relatedTarget||s.fromElement)||!vi(c)&&!c[fi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=s.relatedTarget||s.toElement)?vi(c):null)&&(c!==(h=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(d=ps,m="onMouseLeave",u="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=Cs,m="onPointerLeave",u="onPointerEnter",f="pointer"),h=null==l?o:xi(l),p=null==c?o:xi(c),(o=new d(m,f+"leave",l,s,i)).target=h,o.relatedTarget=p,m=null,vi(i)===n&&((d=new d(u,f+"enter",c,s,i)).target=p,d.relatedTarget=h,m=d),h=m,l&&c)e:{for(u=c,f=0,p=d=l;p;p=Gn(p))f++;for(p=0,m=u;m;m=Gn(m))p++;for(;0<f-p;)d=Gn(d),f--;for(;0<p-f;)u=Gn(u),p--;for(;f--;){if(d===u||null!==u&&d===u.alternate)break e;d=Gn(d),u=Gn(u)}d=null}else d=null;null!==l&&Xn(r,o,l,d,!1),null!==c&&null!==h&&Xn(r,h,c,d,!0)}if("select"===(l=(o=n?xi(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Ys;else if(Us(o))if(Ks)g=rn;else{g=nn;var b=sn}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=an);switch(g&&(g=g(e,n))?Vs(r,g,s,i):(b&&b(e,o,n),"focusout"===e&&(b=o._wrapperState)&&b.controlled&&"number"===o.type&&ee(o,"number",o.value)),b=n?xi(n):window,e){case"focusin":(Us(b)||"true"===b.contentEditable)&&(gn=b,bn=n,vn=null);break;case"focusout":vn=bn=gn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,xn(r,s,i);break;case"selectionchange":if(mn)break;case"keydown":case"keyup":xn(r,s,i)}var v;if(Rs)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Bs?zs(e,s)&&(y="onCompositionEnd"):"keydown"===e&&229===s.keyCode&&(y="onCompositionStart");y&&(Ls&&"ko"!==s.locale&&(Bs||"onCompositionStart"!==y?"onCompositionEnd"===y&&Bs&&(v=es()):(Qt="value"in(Jt=i)?Jt.value:Jt.textContent,Bs=!0)),0<(b=qn(n,y)).length&&(y=new ys(y,e,null,s,i),r.push({event:y,listeners:b}),v?y.data=v:null!==(v=$s(s))&&(y.data=v))),(v=Ds?function(e,t){switch(e){case"compositionend":return $s(t);case"keypress":return 32!==t.which?null:(Fs=!0,Os);case"textInput":return(e=t.data)===Os&&Fs?null:e;default:return null}}(e,s):function(e,t){if(Bs)return"compositionend"===e||!Rs&&zs(e,t)?(e=es(),Zt=Qt=Jt=null,Bs=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ls&&"ko"!==t.locale?null:t.data}}(e,s))&&(0<(n=qn(n,"onBeforeInput")).length&&(i=new ys("onBeforeInput","beforeinput",null,s,i),r.push({event:i,listeners:n}),i.data=v))}Fn(r,t)}))}function Wn(e,t,s){return{instance:e,listener:t,currentTarget:s}}function qn(e,t){for(var s=t+"Capture",n=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Me(e,s))&&n.unshift(Wn(e,a,i)),null!=(a=Me(e,t))&&n.push(Wn(e,a,i))),e=e.return}return n}function Gn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xn(e,t,s,n,i){for(var a=t._reactName,r=[];null!==s&&s!==n;){var o=s,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=Me(s,a))&&r.unshift(Wn(s,l,o)):i||null!=(l=Me(s,a))&&r.push(Wn(s,l,o))),s=s.return}0!==r.length&&e.push({event:t,listeners:r})}var Yn=/\r\n?/g,Kn=/\u0000|\uFFFD/g;function Jn(e){return("string"===typeof e?e:""+e).replace(Yn,"\n").replace(Kn,"")}function Qn(e,t,s){if(t=Jn(t),Jn(e)!==t&&s)throw Error(a(425))}function Zn(){}var ei=null,ti=null;function si(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,ri="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ni;function oi(e){setTimeout((function(){throw e}))}function li(e,t){var s=t,n=0;do{var i=s.nextSibling;if(e.removeChild(s),i&&8===i.nodeType)if("/$"===(s=i.data)){if(0===n)return e.removeChild(i),void Ht(t);n--}else"$"!==s&&"$?"!==s&&"$!"!==s||n++;s=i}while(s);Ht(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function di(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var s=e.data;if("$"===s||"$!"===s||"$?"===s){if(0===t)return e;t--}else"/$"===s&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),ui="__reactFiber$"+hi,pi="__reactProps$"+hi,fi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,bi="__reactHandles$"+hi;function vi(e){var t=e[ui];if(t)return t;for(var s=e.parentNode;s;){if(t=s[fi]||s[ui]){if(s=t.alternate,null!==t.child||null!==s&&null!==s.child)for(e=di(e);null!==e;){if(s=e[ui])return s;e=di(e)}return t}s=(e=s).parentNode}return null}function yi(e){return!(e=e[ui]||e[fi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wi(e){return e[pi]||null}var _i=[],Si=-1;function Ai(e){return{current:e}}function ki(e){0>Si||(e.current=_i[Si],_i[Si]=null,Si--)}function Ei(e,t){Si++,_i[Si]=e.current,e.current=t}var Ci={},ji=Ai(Ci),Ni=Ai(!1),Ti=Ci;function Pi(e,t){var s=e.type.contextTypes;if(!s)return Ci;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in s)a[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Mi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ri(){ki(Ni),ki(ji)}function Ii(e,t,s){if(ji.current!==Ci)throw Error(a(168));Ei(ji,t),Ei(Ni,s)}function Di(e,t,s){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return s;for(var i in n=n.getChildContext())if(!(i in t))throw Error(a(108,U(e)||"Unknown",i));return O({},s,n)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ci,Ti=ji.current,Ei(ji,e),Ei(Ni,Ni.current),!0}function Oi(e,t,s){var n=e.stateNode;if(!n)throw Error(a(169));s?(e=Di(e,t,Ti),n.__reactInternalMemoizedMergedChildContext=e,ki(Ni),ki(ji),Ei(ji,e)):ki(Ni),Ei(Ni,s)}var Fi=null,zi=!1,$i=!1;function Bi(e){null===Fi?Fi=[e]:Fi.push(e)}function Hi(){if(!$i&&null!==Fi){$i=!0;var e=0,t=yt;try{var s=Fi;for(yt=1;e<s.length;e++){var n=s[e];do{n=n(!0)}while(null!==n)}Fi=null,zi=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ge(Ze,Hi),i}finally{yt=t,$i=!1}}return null}var Ui=[],Vi=0,Wi=null,qi=0,Gi=[],Xi=0,Yi=null,Ki=1,Ji="";function Qi(e,t){Ui[Vi++]=qi,Ui[Vi++]=Wi,Wi=e,qi=t}function Zi(e,t,s){Gi[Xi++]=Ki,Gi[Xi++]=Ji,Gi[Xi++]=Yi,Yi=e;var n=Ki;e=Ji;var i=32-rt(n)-1;n&=~(1<<i),s+=1;var a=32-rt(t)+i;if(30<a){var r=i-i%5;a=(n&(1<<r)-1).toString(32),n>>=r,i-=r,Ki=1<<32-rt(t)+i|s<<i|n,Ji=a+e}else Ki=1<<a|s<<i|n,Ji=e}function ea(e){null!==e.return&&(Qi(e,1),Zi(e,1,0))}function ta(e){for(;e===Wi;)Wi=Ui[--Vi],Ui[Vi]=null,qi=Ui[--Vi],Ui[Vi]=null;for(;e===Yi;)Yi=Gi[--Xi],Gi[Xi]=null,Ji=Gi[--Xi],Gi[Xi]=null,Ki=Gi[--Xi],Gi[Xi]=null}var sa=null,na=null,ia=!1,aa=null;function ra(e,t){var s=Pc(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,null===(t=e.deletions)?(e.deletions=[s],e.flags|=16):t.push(s)}function oa(e,t){switch(e.tag){case 5:var s=e.type;return null!==(t=1!==t.nodeType||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,sa=e,na=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,sa=e,na=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(s=null!==Yi?{id:Ki,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},(s=Pc(18,null,null,0)).stateNode=t,s.return=e,e.child=s,sa=e,na=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=na;if(t){var s=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=ci(s.nextSibling);var n=sa;t&&oa(e,t)?ra(n,s):(e.flags=-4097&e.flags|2,ia=!1,sa=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,sa=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;sa=e}function ha(e){if(e!==sa)return!1;if(!ia)return da(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!si(e.type,e.memoizedProps)),t&&(t=na)){if(la(e))throw ua(),Error(a(418));for(;t;)ra(e,t),t=ci(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var s=e.data;if("/$"===s){if(0===t){na=ci(e.nextSibling);break e}t--}else"$"!==s&&"$!"!==s&&"$?"!==s||t++}e=e.nextSibling}na=null}}else na=sa?ci(e.stateNode.nextSibling):null;return!0}function ua(){for(var e=na;e;)e=ci(e.nextSibling)}function pa(){na=sa=null,ia=!1}function fa(e){null===aa?aa=[e]:aa.push(e)}var ma=x.ReactCurrentBatchConfig;function ga(e,t,s){if(null!==(e=s.ref)&&"function"!==typeof e&&"object"!==typeof e){if(s._owner){if(s=s._owner){if(1!==s.tag)throw Error(a(309));var n=s.stateNode}if(!n)throw Error(a(147,e));var i=n,r=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===r?t.ref:(t=function(e){var t=i.refs;null===e?delete t[r]:t[r]=e},t._stringRef=r,t)}if("string"!==typeof e)throw Error(a(284));if(!s._owner)throw Error(a(290,e))}return e}function ba(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function va(e){return(0,e._init)(e._payload)}function ya(e){function t(t,s){if(e){var n=t.deletions;null===n?(t.deletions=[s],t.flags|=16):n.push(s)}}function s(s,n){if(!e)return null;for(;null!==n;)t(s,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function r(t,s,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<s?(t.flags|=2,s):n:(t.flags|=2,s):(t.flags|=1048576,s)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,s,n){return null===t||6!==t.tag?((t=Oc(s,e.mode,n)).return=e,t):((t=i(t,s)).return=e,t)}function c(e,t,s,n){var a=s.type;return a===S?h(e,t,s.props.children,n,s.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===M&&va(a)===t.type)?((n=i(t,s.props)).ref=ga(e,t,s),n.return=e,n):((n=Ic(s.type,s.key,s.props,null,e.mode,n)).ref=ga(e,t,s),n.return=e,n)}function d(e,t,s,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==s.containerInfo||t.stateNode.implementation!==s.implementation?((t=Fc(s,e.mode,n)).return=e,t):((t=i(t,s.children||[])).return=e,t)}function h(e,t,s,n,a){return null===t||7!==t.tag?((t=Dc(s,e.mode,n,a)).return=e,t):((t=i(t,s)).return=e,t)}function u(e,t,s){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,s)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(s=Ic(t.type,t.key,t.props,null,e.mode,s)).ref=ga(e,null,t),s.return=e,s;case _:return(t=Fc(t,e.mode,s)).return=e,t;case M:return u(e,(0,t._init)(t._payload),s)}if(te(t)||D(t))return(t=Dc(t,e.mode,s,null)).return=e,t;ba(e,t)}return null}function p(e,t,s,n){var i=null!==t?t.key:null;if("string"===typeof s&&""!==s||"number"===typeof s)return null!==i?null:l(e,t,""+s,n);if("object"===typeof s&&null!==s){switch(s.$$typeof){case w:return s.key===i?c(e,t,s,n):null;case _:return s.key===i?d(e,t,s,n):null;case M:return p(e,t,(i=s._init)(s._payload),n)}if(te(s)||D(s))return null!==i?null:h(e,t,s,n,null);ba(e,s)}return null}function f(e,t,s,n,i){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(s)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return c(t,e=e.get(null===n.key?s:n.key)||null,n,i);case _:return d(t,e=e.get(null===n.key?s:n.key)||null,n,i);case M:return f(e,t,s,(0,n._init)(n._payload),i)}if(te(n)||D(n))return h(t,e=e.get(s)||null,n,i,null);ba(t,n)}return null}function m(i,a,o,l){for(var c=null,d=null,h=a,m=a=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var b=p(i,h,o[m],l);if(null===b){null===h&&(h=g);break}e&&h&&null===b.alternate&&t(i,h),a=r(b,a,m),null===d?c=b:d.sibling=b,d=b,h=g}if(m===o.length)return s(i,h),ia&&Qi(i,m),c;if(null===h){for(;m<o.length;m++)null!==(h=u(i,o[m],l))&&(a=r(h,a,m),null===d?c=h:d.sibling=h,d=h);return ia&&Qi(i,m),c}for(h=n(i,h);m<o.length;m++)null!==(g=f(h,i,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),a=r(g,a,m),null===d?c=g:d.sibling=g,d=g);return e&&h.forEach((function(e){return t(i,e)})),ia&&Qi(i,m),c}function g(i,o,l,c){var d=D(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var h=d=null,m=o,g=o=0,b=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(b=m,m=null):b=m.sibling;var y=p(i,m,v.value,c);if(null===y){null===m&&(m=b);break}e&&m&&null===y.alternate&&t(i,m),o=r(y,o,g),null===h?d=y:h.sibling=y,h=y,m=b}if(v.done)return s(i,m),ia&&Qi(i,g),d;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=u(i,v.value,c))&&(o=r(v,o,g),null===h?d=v:h.sibling=v,h=v);return ia&&Qi(i,g),d}for(m=n(i,m);!v.done;g++,v=l.next())null!==(v=f(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),o=r(v,o,g),null===h?d=v:h.sibling=v,h=v);return e&&m.forEach((function(e){return t(i,e)})),ia&&Qi(i,g),d}return function e(n,a,r,l){if("object"===typeof r&&null!==r&&r.type===S&&null===r.key&&(r=r.props.children),"object"===typeof r&&null!==r){switch(r.$$typeof){case w:e:{for(var c=r.key,d=a;null!==d;){if(d.key===c){if((c=r.type)===S){if(7===d.tag){s(n,d.sibling),(a=i(d,r.props.children)).return=n,n=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===M&&va(c)===d.type){s(n,d.sibling),(a=i(d,r.props)).ref=ga(n,d,r),a.return=n,n=a;break e}s(n,d);break}t(n,d),d=d.sibling}r.type===S?((a=Dc(r.props.children,n.mode,l,r.key)).return=n,n=a):((l=Ic(r.type,r.key,r.props,null,n.mode,l)).ref=ga(n,a,r),l.return=n,n=l)}return o(n);case _:e:{for(d=r.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===r.containerInfo&&a.stateNode.implementation===r.implementation){s(n,a.sibling),(a=i(a,r.children||[])).return=n,n=a;break e}s(n,a);break}t(n,a),a=a.sibling}(a=Fc(r,n.mode,l)).return=n,n=a}return o(n);case M:return e(n,a,(d=r._init)(r._payload),l)}if(te(r))return m(n,a,r,l);if(D(r))return g(n,a,r,l);ba(n,r)}return"string"===typeof r&&""!==r||"number"===typeof r?(r=""+r,null!==a&&6===a.tag?(s(n,a.sibling),(a=i(a,r)).return=n,n=a):(s(n,a),(a=Oc(r,n.mode,l)).return=n,n=a),o(n)):s(n,a)}}var xa=ya(!0),wa=ya(!1),_a=Ai(null),Sa=null,Aa=null,ka=null;function Ea(){ka=Aa=Sa=null}function Ca(e){var t=_a.current;ki(_a),e._currentValue=t}function ja(e,t,s){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===s)break;e=e.return}}function Na(e,t){Sa=e,ka=Aa=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yo=!0),e.firstContext=null)}function Ta(e){var t=e._currentValue;if(ka!==e)if(e={context:e,memoizedValue:t,next:null},null===Aa){if(null===Sa)throw Error(a(308));Aa=e,Sa.dependencies={lanes:0,firstContext:e}}else Aa=Aa.next=e;return t}var Pa=null;function Ma(e){null===Pa?Pa=[e]:Pa.push(e)}function Ra(e,t,s,n){var i=t.interleaved;return null===i?(s.next=s,Ma(t)):(s.next=i.next,i.next=s),t.interleaved=s,Ia(e,n)}function Ia(e,t){e.lanes|=t;var s=e.alternate;for(null!==s&&(s.lanes|=t),s=e,e=e.return;null!==e;)e.childLanes|=t,null!==(s=e.alternate)&&(s.childLanes|=t),s=e,e=e.return;return 3===s.tag?s.stateNode:null}var Da=!1;function La(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oa(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function za(e,t,s){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&jl)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Ia(e,s)}return null===(i=n.interleaved)?(t.next=t,Ma(n)):(t.next=i.next,i.next=t),n.interleaved=t,Ia(e,s)}function $a(e,t,s){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&s))){var n=t.lanes;s|=n&=e.pendingLanes,t.lanes=s,vt(e,s)}}function Ba(e,t){var s=e.updateQueue,n=e.alternate;if(null!==n&&s===(n=n.updateQueue)){var i=null,a=null;if(null!==(s=s.firstBaseUpdate)){do{var r={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};null===a?i=a=r:a=a.next=r,s=s.next}while(null!==s);null===a?i=a=t:a=a.next=t}else i=a=t;return s={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},void(e.updateQueue=s)}null===(e=s.lastBaseUpdate)?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Ha(e,t,s,n){var i=e.updateQueue;Da=!1;var a=i.firstBaseUpdate,r=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===r?a=c:r.next=c,r=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==r&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==a){var h=i.baseState;for(r=0,d=c=l=null,o=a;;){var u=o.lane,p=o.eventTime;if((n&u)===u){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(u=t,p=s,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,u);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(u="function"===typeof(f=m.payload)?f.call(p,h,u):f)||void 0===u)break e;h=O({},h,u);break e;case 2:Da=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(u=i.effects)?i.effects=[o]:u.push(o))}else p={eventTime:p,lane:u,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=h):d=d.next=p,r|=u;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(u=o).next,u.next=null,i.lastBaseUpdate=u,i.shared.pending=null}}if(null===d&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,null!==(t=i.shared.interleaved)){i=t;do{r|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ll|=r,e.lanes=r,e.memoizedState=h}}function Ua(e,t,s){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=s,"function"!==typeof i)throw Error(a(191,i));i.call(n)}}}var Va={},Wa=Ai(Va),qa=Ai(Va),Ga=Ai(Va);function Xa(e){if(e===Va)throw Error(a(174));return e}function Ya(e,t){switch(Ei(Ga,t),Ei(qa,e),Ei(Wa,Va),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ki(Wa),Ei(Wa,t)}function Ka(){ki(Wa),ki(qa),ki(Ga)}function Ja(e){Xa(Ga.current);var t=Xa(Wa.current),s=le(t,e.type);t!==s&&(Ei(qa,e),Ei(Wa,s))}function Qa(e){qa.current===e&&(ki(Wa),ki(qa))}var Za=Ai(0);function er(e){for(var t=e;null!==t;){if(13===t.tag){var s=t.memoizedState;if(null!==s&&(null===(s=s.dehydrated)||"$?"===s.data||"$!"===s.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tr=[];function sr(){for(var e=0;e<tr.length;e++)tr[e]._workInProgressVersionPrimary=null;tr.length=0}var nr=x.ReactCurrentDispatcher,ir=x.ReactCurrentBatchConfig,ar=0,rr=null,or=null,lr=null,cr=!1,dr=!1,hr=0,ur=0;function pr(){throw Error(a(321))}function fr(e,t){if(null===t)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!on(e[s],t[s]))return!1;return!0}function mr(e,t,s,n,i,r){if(ar=r,rr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nr.current=null===e||null===e.memoizedState?Qr:Zr,e=s(n,i),dr){r=0;do{if(dr=!1,hr=0,25<=r)throw Error(a(301));r+=1,lr=or=null,t.updateQueue=null,nr.current=eo,e=s(n,i)}while(dr)}if(nr.current=Jr,t=null!==or&&null!==or.next,ar=0,lr=or=rr=null,cr=!1,t)throw Error(a(300));return e}function gr(){var e=0!==hr;return hr=0,e}function br(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lr?rr.memoizedState=lr=e:lr=lr.next=e,lr}function vr(){if(null===or){var e=rr.alternate;e=null!==e?e.memoizedState:null}else e=or.next;var t=null===lr?rr.memoizedState:lr.next;if(null!==t)lr=t,or=e;else{if(null===e)throw Error(a(310));e={memoizedState:(or=e).memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},null===lr?rr.memoizedState=lr=e:lr=lr.next=e}return lr}function yr(e,t){return"function"===typeof t?t(e):t}function xr(e){var t=vr(),s=t.queue;if(null===s)throw Error(a(311));s.lastRenderedReducer=e;var n=or,i=n.baseQueue,r=s.pending;if(null!==r){if(null!==i){var o=i.next;i.next=r.next,r.next=o}n.baseQueue=i=r,s.pending=null}if(null!==i){r=i.next,n=n.baseState;var l=o=null,c=null,d=r;do{var h=d.lane;if((ar&h)===h)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var u={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=u,o=n):c=c.next=u,rr.lanes|=h,Ll|=h}d=d.next}while(null!==d&&d!==r);null===c?o=n:c.next=l,on(n,t.memoizedState)||(yo=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,s.lastRenderedState=n}if(null!==(e=s.interleaved)){i=e;do{r=i.lane,rr.lanes|=r,Ll|=r,i=i.next}while(i!==e)}else null===i&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function wr(e){var t=vr(),s=t.queue;if(null===s)throw Error(a(311));s.lastRenderedReducer=e;var n=s.dispatch,i=s.pending,r=t.memoizedState;if(null!==i){s.pending=null;var o=i=i.next;do{r=e(r,o.action),o=o.next}while(o!==i);on(r,t.memoizedState)||(yo=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),s.lastRenderedState=r}return[r,n]}function _r(){}function Sr(e,t){var s=rr,n=vr(),i=t(),r=!on(n.memoizedState,i);if(r&&(n.memoizedState=i,yo=!0),n=n.queue,Dr(Er.bind(null,s,n,e),[e]),n.getSnapshot!==t||r||null!==lr&&1&lr.memoizedState.tag){if(s.flags|=2048,Tr(9,kr.bind(null,s,n,i,t),void 0,null),null===Nl)throw Error(a(349));0!==(30&ar)||Ar(s,t,i)}return i}function Ar(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},null===(t=rr.updateQueue)?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.stores=[e]):null===(s=t.stores)?t.stores=[e]:s.push(e)}function kr(e,t,s,n){t.value=s,t.getSnapshot=n,Cr(t)&&jr(e)}function Er(e,t,s){return s((function(){Cr(t)&&jr(e)}))}function Cr(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!on(e,s)}catch(n){return!0}}function jr(e){var t=Ia(e,1);null!==t&&sc(t,e,1,-1)}function Nr(e){var t=br();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yr,lastRenderedState:e},t.queue=e,e=e.dispatch=Gr.bind(null,rr,e),[t.memoizedState,e]}function Tr(e,t,s,n){return e={tag:e,create:t,destroy:s,deps:n,next:null},null===(t=rr.updateQueue)?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.lastEffect=e.next=e):null===(s=t.lastEffect)?t.lastEffect=e.next=e:(n=s.next,s.next=e,e.next=n,t.lastEffect=e),e}function Pr(){return vr().memoizedState}function Mr(e,t,s,n){var i=br();rr.flags|=e,i.memoizedState=Tr(1|t,s,void 0,void 0===n?null:n)}function Rr(e,t,s,n){var i=vr();n=void 0===n?null:n;var a=void 0;if(null!==or){var r=or.memoizedState;if(a=r.destroy,null!==n&&fr(n,r.deps))return void(i.memoizedState=Tr(t,s,a,n))}rr.flags|=e,i.memoizedState=Tr(1|t,s,a,n)}function Ir(e,t){return Mr(8390656,8,e,t)}function Dr(e,t){return Rr(2048,8,e,t)}function Lr(e,t){return Rr(4,2,e,t)}function Or(e,t){return Rr(4,4,e,t)}function Fr(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zr(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Rr(4,4,Fr.bind(null,t,e),s)}function $r(){}function Br(e,t){var s=vr();t=void 0===t?null:t;var n=s.memoizedState;return null!==n&&null!==t&&fr(t,n[1])?n[0]:(s.memoizedState=[e,t],e)}function Hr(e,t){var s=vr();t=void 0===t?null:t;var n=s.memoizedState;return null!==n&&null!==t&&fr(t,n[1])?n[0]:(e=e(),s.memoizedState=[e,t],e)}function Ur(e,t,s){return 0===(21&ar)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=s):(on(s,t)||(s=mt(),rr.lanes|=s,Ll|=s,e.baseState=!0),t)}function Vr(e,t){var s=yt;yt=0!==s&&4>s?s:4,e(!0);var n=ir.transition;ir.transition={};try{e(!1),t()}finally{yt=s,ir.transition=n}}function Wr(){return vr().memoizedState}function qr(e,t,s){var n=tc(e);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},Xr(e))Yr(t,s);else if(null!==(s=Ra(e,t,s,n))){sc(s,e,n,ec()),Kr(s,t,n)}}function Gr(e,t,s){var n=tc(e),i={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(Xr(e))Yr(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var r=t.lastRenderedState,o=a(r,s);if(i.hasEagerState=!0,i.eagerState=o,on(o,r)){var l=t.interleaved;return null===l?(i.next=i,Ma(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(s=Ra(e,t,i,n))&&(sc(s,e,n,i=ec()),Kr(s,t,n))}}function Xr(e){var t=e.alternate;return e===rr||null!==t&&t===rr}function Yr(e,t){dr=cr=!0;var s=e.pending;null===s?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Kr(e,t,s){if(0!==(4194240&s)){var n=t.lanes;s|=n&=e.pendingLanes,t.lanes=s,vt(e,s)}}var Jr={readContext:Ta,useCallback:pr,useContext:pr,useEffect:pr,useImperativeHandle:pr,useInsertionEffect:pr,useLayoutEffect:pr,useMemo:pr,useReducer:pr,useRef:pr,useState:pr,useDebugValue:pr,useDeferredValue:pr,useTransition:pr,useMutableSource:pr,useSyncExternalStore:pr,useId:pr,unstable_isNewReconciler:!1},Qr={readContext:Ta,useCallback:function(e,t){return br().memoizedState=[e,void 0===t?null:t],e},useContext:Ta,useEffect:Ir,useImperativeHandle:function(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Mr(4194308,4,Fr.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Mr(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mr(4,2,e,t)},useMemo:function(e,t){var s=br();return t=void 0===t?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var n=br();return t=void 0!==s?s(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=qr.bind(null,rr,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},br().memoizedState=e},useState:Nr,useDebugValue:$r,useDeferredValue:function(e){return br().memoizedState=e},useTransition:function(){var e=Nr(!1),t=e[0];return e=Vr.bind(null,e[1]),br().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var n=rr,i=br();if(ia){if(void 0===s)throw Error(a(407));s=s()}else{if(s=t(),null===Nl)throw Error(a(349));0!==(30&ar)||Ar(n,t,s)}i.memoizedState=s;var r={value:s,getSnapshot:t};return i.queue=r,Ir(Er.bind(null,n,r,e),[e]),n.flags|=2048,Tr(9,kr.bind(null,n,r,s,t),void 0,null),s},useId:function(){var e=br(),t=Nl.identifierPrefix;if(ia){var s=Ji;t=":"+t+"R"+(s=(Ki&~(1<<32-rt(Ki)-1)).toString(32)+s),0<(s=hr++)&&(t+="H"+s.toString(32)),t+=":"}else t=":"+t+"r"+(s=ur++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zr={readContext:Ta,useCallback:Br,useContext:Ta,useEffect:Dr,useImperativeHandle:zr,useInsertionEffect:Lr,useLayoutEffect:Or,useMemo:Hr,useReducer:xr,useRef:Pr,useState:function(){return xr(yr)},useDebugValue:$r,useDeferredValue:function(e){return Ur(vr(),or.memoizedState,e)},useTransition:function(){return[xr(yr)[0],vr().memoizedState]},useMutableSource:_r,useSyncExternalStore:Sr,useId:Wr,unstable_isNewReconciler:!1},eo={readContext:Ta,useCallback:Br,useContext:Ta,useEffect:Dr,useImperativeHandle:zr,useInsertionEffect:Lr,useLayoutEffect:Or,useMemo:Hr,useReducer:wr,useRef:Pr,useState:function(){return wr(yr)},useDebugValue:$r,useDeferredValue:function(e){var t=vr();return null===or?t.memoizedState=e:Ur(t,or.memoizedState,e)},useTransition:function(){return[wr(yr)[0],vr().memoizedState]},useMutableSource:_r,useSyncExternalStore:Sr,useId:Wr,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var s in t=O({},t),e=e.defaultProps)void 0===t[s]&&(t[s]=e[s]);return t}return t}function so(e,t,s,n){s=null===(s=s(n,t=e.memoizedState))||void 0===s?t:O({},t,s),e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}var no={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,s){e=e._reactInternals;var n=ec(),i=tc(e),a=Fa(n,i);a.payload=t,void 0!==s&&null!==s&&(a.callback=s),null!==(t=za(e,a,i))&&(sc(t,e,i,n),$a(t,e,i))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var n=ec(),i=tc(e),a=Fa(n,i);a.tag=1,a.payload=t,void 0!==s&&null!==s&&(a.callback=s),null!==(t=za(e,a,i))&&(sc(t,e,i,n),$a(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=ec(),n=tc(e),i=Fa(s,n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=za(e,i,n))&&(sc(t,e,n,s),$a(t,e,n))}};function io(e,t,s,n,i,a,r){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,r):!t.prototype||!t.prototype.isPureReactComponent||(!ln(s,n)||!ln(i,a))}function ao(e,t,s){var n=!1,i=Ci,a=t.contextType;return"object"===typeof a&&null!==a?a=Ta(a):(i=Mi(t)?Ti:ji.current,a=(n=null!==(n=t.contextTypes)&&void 0!==n)?Pi(e,i):Ci),t=new t(s,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=no,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ro(e,t,s,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(s,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(s,n),t.state!==e&&no.enqueueReplaceState(t,t.state,null)}function oo(e,t,s,n){var i=e.stateNode;i.props=s,i.state=e.memoizedState,i.refs={},La(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Ta(a):(a=Mi(t)?Ti:ji.current,i.context=Pi(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(so(e,t,a,s),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&no.enqueueReplaceState(i,i.state,null),Ha(e,s,i,n),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var s="",n=t;do{s+=B(n),n=n.return}while(n);var i=s}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function co(e,t,s){return{value:e,source:null,stack:null!=s?s:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(s){setTimeout((function(){throw s}))}}var uo="function"===typeof WeakMap?WeakMap:Map;function po(e,t,s){(s=Fa(-1,s)).tag=3,s.payload={element:null};var n=t.value;return s.callback=function(){Vl||(Vl=!0,Wl=n),ho(0,t)},s}function fo(e,t,s){(s=Fa(-1,s)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;s.payload=function(){return n(i)},s.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(s.callback=function(){ho(0,t),"function"!==typeof n&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),s}function mo(e,t,s){var n=e.pingCache;if(null===n){n=e.pingCache=new uo;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(s)||(i.add(s),e=kc.bind(null,e,t,s),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bo(e,t,s,n,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,1===s.tag&&(null===s.alternate?s.tag=17:((t=Fa(-1,1)).tag=2,za(s,t,1))),s.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vo=x.ReactCurrentOwner,yo=!1;function xo(e,t,s,n){t.child=null===e?wa(t,null,s,n):xa(t,e.child,s,n)}function wo(e,t,s,n,i){s=s.render;var a=t.ref;return Na(t,i),n=mr(e,t,s,n,a,i),s=gr(),null===e||yo?(ia&&s&&ea(t),t.flags|=1,xo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vo(e,t,i))}function _o(e,t,s,n,i){if(null===e){var a=s.type;return"function"!==typeof a||Mc(a)||void 0!==a.defaultProps||null!==s.compare||void 0!==s.defaultProps?((e=Ic(s.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,So(e,t,a,n,i))}if(a=e.child,0===(e.lanes&i)){var r=a.memoizedProps;if((s=null!==(s=s.compare)?s:ln)(r,n)&&e.ref===t.ref)return Vo(e,t,i)}return t.flags|=1,(e=Rc(a,n)).ref=t.ref,e.return=t,t.child=e}function So(e,t,s,n,i){if(null!==e){var a=e.memoizedProps;if(ln(a,n)&&e.ref===t.ref){if(yo=!1,t.pendingProps=n=a,0===(e.lanes&i))return t.lanes=e.lanes,Vo(e,t,i);0!==(131072&e.flags)&&(yo=!0)}}return Eo(e,t,s,n,i)}function Ao(e,t,s){var n=t.pendingProps,i=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ei(Rl,Ml),Ml|=s;else{if(0===(1073741824&s))return e=null!==a?a.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ei(Rl,Ml),Ml|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==a?a.baseLanes:s,Ei(Rl,Ml),Ml|=n}else null!==a?(n=a.baseLanes|s,t.memoizedState=null):n=s,Ei(Rl,Ml),Ml|=n;return xo(e,t,i,s),t.child}function ko(e,t){var s=t.ref;(null===e&&null!==s||null!==e&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,s,n,i){var a=Mi(s)?Ti:ji.current;return a=Pi(t,a),Na(t,i),s=mr(e,t,s,n,a,i),n=gr(),null===e||yo?(ia&&n&&ea(t),t.flags|=1,xo(e,t,s,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Vo(e,t,i))}function Co(e,t,s,n,i){if(Mi(s)){var a=!0;Li(t)}else a=!1;if(Na(t,i),null===t.stateNode)Uo(e,t),ao(t,s,n),oo(t,s,n,i),n=!0;else if(null===e){var r=t.stateNode,o=t.memoizedProps;r.props=o;var l=r.context,c=s.contextType;"object"===typeof c&&null!==c?c=Ta(c):c=Pi(t,c=Mi(s)?Ti:ji.current);var d=s.getDerivedStateFromProps,h="function"===typeof d||"function"===typeof r.getSnapshotBeforeUpdate;h||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(o!==n||l!==c)&&ro(t,r,n,c),Da=!1;var u=t.memoizedState;r.state=u,Ha(t,n,r,i),l=t.memoizedState,o!==n||u!==l||Ni.current||Da?("function"===typeof d&&(so(t,s,d,n),l=t.memoizedState),(o=Da||io(t,s,o,n,u,l,c))?(h||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||("function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"===typeof r.componentDidMount&&(t.flags|=4194308)):("function"===typeof r.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),r.props=n,r.state=l,r.context=c,n=o):("function"===typeof r.componentDidMount&&(t.flags|=4194308),n=!1)}else{r=t.stateNode,Oa(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),r.props=c,h=t.pendingProps,u=r.context,"object"===typeof(l=s.contextType)&&null!==l?l=Ta(l):l=Pi(t,l=Mi(s)?Ti:ji.current);var p=s.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof r.getSnapshotBeforeUpdate)||"function"!==typeof r.UNSAFE_componentWillReceiveProps&&"function"!==typeof r.componentWillReceiveProps||(o!==h||u!==l)&&ro(t,r,n,l),Da=!1,u=t.memoizedState,r.state=u,Ha(t,n,r,i);var f=t.memoizedState;o!==h||u!==f||Ni.current||Da?("function"===typeof p&&(so(t,s,p,n),f=t.memoizedState),(c=Da||io(t,s,c,n,u,f,l)||!1)?(d||"function"!==typeof r.UNSAFE_componentWillUpdate&&"function"!==typeof r.componentWillUpdate||("function"===typeof r.componentWillUpdate&&r.componentWillUpdate(n,f,l),"function"===typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof r.componentDidUpdate&&(t.flags|=4),"function"===typeof r.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof r.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),r.props=n,r.state=f,r.context=l,n=c):("function"!==typeof r.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!==typeof r.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),n=!1)}return jo(e,t,s,n,a,i)}function jo(e,t,s,n,i,a){ko(e,t);var r=0!==(128&t.flags);if(!n&&!r)return i&&Oi(t,s,!1),Vo(e,t,a);n=t.stateNode,vo.current=t;var o=r&&"function"!==typeof s.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&r?(t.child=xa(t,e.child,null,a),t.child=xa(t,null,o,a)):xo(e,t,o,a),t.memoizedState=n.state,i&&Oi(t,s,!0),t.child}function No(e){var t=e.stateNode;t.pendingContext?Ii(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ii(0,t.context,!1),Ya(e,t.containerInfo)}function To(e,t,s,n,i){return pa(),fa(i),t.flags|=256,xo(e,t,s,n),t.child}var Po,Mo,Ro,Io,Do={dehydrated:null,treeContext:null,retryLane:0};function Lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oo(e,t,s){var n,i=t.pendingProps,r=Za.current,o=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&r)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(r|=1),Ei(Za,1&r),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Lc(l,i,0,null),e=Dc(e,i,s,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Lo(s),t.memoizedState=Do,e):Fo(t,l));if(null!==(r=e.memoizedState)&&null!==(n=r.dehydrated))return function(e,t,s,n,i,r,o){if(s)return 256&t.flags?(t.flags&=-257,zo(e,t,o,n=co(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(r=n.fallback,i=t.mode,n=Lc({mode:"visible",children:n.children},i,0,null),(r=Dc(r,i,o,null)).flags|=2,n.return=t,r.return=t,n.sibling=r,t.child=n,0!==(1&t.mode)&&xa(t,e.child,null,o),t.child.memoizedState=Lo(o),t.memoizedState=Do,r);if(0===(1&t.mode))return zo(e,t,o,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var l=n.dgst;return n=l,zo(e,t,o,n=co(r=Error(a(419)),n,void 0))}if(l=0!==(o&e.childLanes),yo||l){if(null!==(n=Nl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(n.suspendedLanes|o))?0:i)&&i!==r.retryLane&&(r.retryLane=i,Ia(e,i),sc(n,e,i,-1))}return mc(),zo(e,t,o,n=co(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),i._reactRetry=t,null):(e=r.treeContext,na=ci(i.nextSibling),sa=t,ia=!0,aa=null,null!==e&&(Gi[Xi++]=Ki,Gi[Xi++]=Ji,Gi[Xi++]=Yi,Ki=e.id,Ji=e.overflow,Yi=t),t=Fo(t,n.children),t.flags|=4096,t)}(e,t,l,i,n,r,s);if(o){o=i.fallback,l=t.mode,n=(r=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==r?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Rc(r,c)).subtreeFlags=14680064&r.subtreeFlags,null!==n?o=Rc(n,o):(o=Dc(o,l,s,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Lo(s):{baseLanes:l.baseLanes|s,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~s,t.memoizedState=Do,i}return e=(o=e.child).sibling,i=Rc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=s),i.return=t,i.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=i,t.memoizedState=null,i}function Fo(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zo(e,t,s,n){return null!==n&&fa(n),xa(t,e.child,null,s),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function $o(e,t,s){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ja(e.return,t,s)}function Bo(e,t,s,n,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=s,a.tailMode=i)}function Ho(e,t,s){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(xo(e,t,n.children,s),0!==(2&(n=Za.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&$o(e,s,t);else if(19===e.tag)$o(e,s,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ei(Za,n),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(s=t.child,i=null;null!==s;)null!==(e=s.alternate)&&null===er(e)&&(i=s),s=s.sibling;null===(s=i)?(i=t.child,t.child=null):(i=s.sibling,s.sibling=null),Bo(t,!1,i,s,a);break;case"backwards":for(s=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===er(e)){t.child=i;break}e=i.sibling,i.sibling=s,s=i,i=e}Bo(t,!0,s,null,a);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vo(e,t,s){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(s&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(s=Rc(e=t.child,e.pendingProps),t.child=s,s.return=t;null!==e.sibling;)e=e.sibling,(s=s.sibling=Rc(e,e.pendingProps)).return=t;s.sibling=null}return t.child}function Wo(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;null!==t;)null!==t.alternate&&(s=t),t=t.sibling;null===s?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var n=null;null!==s;)null!==s.alternate&&(n=s),s=s.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,s=0,n=0;if(t)for(var i=e.child;null!==i;)s|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)s|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=s,t}function Go(e,t,s){var n=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Mi(t.type)&&Ri(),qo(t),null;case 3:return n=t.stateNode,Ka(),ki(Ni),ki(ji),sr(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(rc(aa),aa=null))),Mo(e,t),qo(t),null;case 5:Qa(t);var i=Xa(Ga.current);if(s=t.type,null!==e&&null!=t.stateNode)Ro(e,t,s,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(a(166));return qo(t),null}if(e=Xa(Wa.current),ha(t)){n=t.stateNode,s=t.type;var r=t.memoizedProps;switch(n[ui]=t,n[pi]=r,e=0!==(1&t.mode),s){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(i=0;i<Dn.length;i++)zn(Dn[i],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":K(n,r),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!r.multiple},zn("invalid",n);break;case"textarea":ie(n,r),zn("invalid",n)}for(var l in ve(s,r),i=null,r)if(r.hasOwnProperty(l)){var c=r[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==r.suppressHydrationWarning&&Qn(n.textContent,c,e),i=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==r.suppressHydrationWarning&&Qn(n.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zn("scroll",n)}switch(s){case"input":q(n),Z(n,r,!0);break;case"textarea":q(n),re(n);break;case"select":case"option":break;default:"function"===typeof r.onClick&&(n.onclick=Zn)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(s)),"http://www.w3.org/1999/xhtml"===e?"script"===s?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(s,{is:n.is}):(e=l.createElement(s),"select"===s&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,s),e[ui]=t,e[pi]=n,Po(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(s,n),s){case"dialog":zn("cancel",e),zn("close",e),i=n;break;case"iframe":case"object":case"embed":zn("load",e),i=n;break;case"video":case"audio":for(i=0;i<Dn.length;i++)zn(Dn[i],e);i=n;break;case"source":zn("error",e),i=n;break;case"img":case"image":case"link":zn("error",e),zn("load",e),i=n;break;case"details":zn("toggle",e),i=n;break;case"input":K(e,n),i=Y(e,n),zn("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=O({},n,{value:void 0}),zn("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),zn("invalid",e)}for(r in ve(s,i),c=i)if(c.hasOwnProperty(r)){var d=c[r];"style"===r?ge(e,d):"dangerouslySetInnerHTML"===r?null!=(d=d?d.__html:void 0)&&he(e,d):"children"===r?"string"===typeof d?("textarea"!==s||""!==d)&&ue(e,d):"number"===typeof d&&ue(e,""+d):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(o.hasOwnProperty(r)?null!=d&&"onScroll"===r&&zn("scroll",e):null!=d&&y(e,r,d,l))}switch(s){case"input":q(e),Z(e,n,!1);break;case"textarea":q(e),re(e);break;case"option":null!=n.value&&e.setAttribute("value",""+V(n.value));break;case"select":e.multiple=!!n.multiple,null!=(r=n.value)?se(e,!!n.multiple,r,!1):null!=n.defaultValue&&se(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zn)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)Io(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(a(166));if(s=Xa(Ga.current),Xa(Wa.current),ha(t)){if(n=t.stateNode,s=t.memoizedProps,n[ui]=t,(r=n.nodeValue!==s)&&null!==(e=sa))switch(e.tag){case 3:Qn(n.nodeValue,s,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qn(n.nodeValue,s,0!==(1&e.mode))}r&&(t.flags|=4)}else(n=(9===s.nodeType?s:s.ownerDocument).createTextNode(n))[ui]=t,t.stateNode=n}return qo(t),null;case 13:if(ki(Za),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==na&&0!==(1&t.mode)&&0===(128&t.flags))ua(),pa(),t.flags|=98560,r=!1;else if(r=ha(t),null!==n&&null!==n.dehydrated){if(null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[ui]=t}else pa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),r=!1}else null!==aa&&(rc(aa),aa=null),r=!0;if(!r)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=s,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Za.current)?0===Il&&(Il=3):mc())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return Ka(),Mo(e,t),null===e&&Hn(t.stateNode.containerInfo),qo(t),null;case 10:return Ca(t.type._context),qo(t),null;case 19:if(ki(Za),null===(r=t.memoizedState))return qo(t),null;if(n=0!==(128&t.flags),null===(l=r.rendering))if(n)Wo(r,!1);else{if(0!==Il||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=er(e))){for(t.flags|=128,Wo(r,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=s,s=t.child;null!==s;)e=n,(r=s).flags&=14680066,null===(l=r.alternate)?(r.childLanes=0,r.lanes=e,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,e=l.dependencies,r.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Ei(Za,1&Za.current|2),t.child}e=e.sibling}null!==r.tail&&Je()>Hl&&(t.flags|=128,n=!0,Wo(r,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=er(l))){if(t.flags|=128,n=!0,null!==(s=e.updateQueue)&&(t.updateQueue=s,t.flags|=4),Wo(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!ia)return qo(t),null}else 2*Je()-r.renderingStartTime>Hl&&1073741824!==s&&(t.flags|=128,n=!0,Wo(r,!1),t.lanes=4194304);r.isBackwards?(l.sibling=t.child,t.child=l):(null!==(s=r.last)?s.sibling=l:t.child=l,r.last=l)}return null!==r.tail?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Je(),t.sibling=null,s=Za.current,Ei(Za,n?1&s|2:1&s),t):(qo(t),null);case 22:case 23:return hc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Ml)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Xo(e,t){switch(ta(t),t.tag){case 1:return Mi(t.type)&&Ri(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ka(),ki(Ni),ki(ji),sr(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qa(t),null;case 13:if(ki(Za),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));pa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ki(Za),null;case 4:return Ka(),null;case 10:return Ca(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Po=function(e,t){for(var s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},Mo=function(){},Ro=function(e,t,s,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Xa(Wa.current);var a,r=null;switch(s){case"input":i=Y(e,i),n=Y(e,n),r=[];break;case"select":i=O({},i,{value:void 0}),n=O({},n,{value:void 0}),r=[];break;case"textarea":i=ne(e,i),n=ne(e,n),r=[];break;default:"function"!==typeof i.onClick&&"function"===typeof n.onClick&&(e.onclick=Zn)}for(d in ve(s,n),s=null,i)if(!n.hasOwnProperty(d)&&i.hasOwnProperty(d)&&null!=i[d])if("style"===d){var l=i[d];for(a in l)l.hasOwnProperty(a)&&(s||(s={}),s[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?r||(r=[]):(r=r||[]).push(d,null));for(d in n){var c=n[d];if(l=null!=i?i[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(s||(s={}),s[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(s||(s={}),s[a]=c[a])}else s||(r||(r=[]),r.push(d,s)),s=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(r=r||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(r=r||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&zn("scroll",e),r||l===c||(r=[])):(r=r||[]).push(d,c))}s&&(r=r||[]).push("style",s);var d=r;(t.updateQueue=d)&&(t.flags|=4)}},Io=function(e,t,s,n){s!==n&&(t.flags|=4)};var Yo=!1,Ko=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Qo=null;function Zo(e,t){var s=e.ref;if(null!==s)if("function"===typeof s)try{s(null)}catch(n){Ac(e,t,n)}else s.current=null}function el(e,t,s){try{s()}catch(n){Ac(e,t,n)}}var tl=!1;function sl(e,t,s){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&el(t,s,a)}i=i.next}while(i!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var s=t=t.next;do{if((s.tag&e)===e){var n=s.create;s.destroy=n()}s=s.next}while(s!==t)}}function il(e){var t=e.ref;if(null!==t){var s=e.stateNode;e.tag,e=s,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ui],delete t[pi],delete t[mi],delete t[gi],delete t[bi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rl(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||rl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,s){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===s.nodeType?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(8===s.nodeType?(t=s.parentNode).insertBefore(e,s):(t=s).appendChild(e),null!==(s=s._reactRootContainer)&&void 0!==s||null!==t.onclick||(t.onclick=Zn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,s),e=e.sibling;null!==e;)ll(e,t,s),e=e.sibling}function cl(e,t,s){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,s),e=e.sibling;null!==e;)cl(e,t,s),e=e.sibling}var dl=null,hl=!1;function ul(e,t,s){for(s=s.child;null!==s;)pl(e,t,s),s=s.sibling}function pl(e,t,s){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,s)}catch(o){}switch(s.tag){case 5:Ko||Zo(s,t);case 6:var n=dl,i=hl;dl=null,ul(e,t,s),hl=i,null!==(dl=n)&&(hl?(e=dl,s=s.stateNode,8===e.nodeType?e.parentNode.removeChild(s):e.removeChild(s)):dl.removeChild(s.stateNode));break;case 18:null!==dl&&(hl?(e=dl,s=s.stateNode,8===e.nodeType?li(e.parentNode,s):1===e.nodeType&&li(e,s),Ht(e)):li(dl,s.stateNode));break;case 4:n=dl,i=hl,dl=s.stateNode.containerInfo,hl=!0,ul(e,t,s),dl=n,hl=i;break;case 0:case 11:case 14:case 15:if(!Ko&&(null!==(n=s.updateQueue)&&null!==(n=n.lastEffect))){i=n=n.next;do{var a=i,r=a.destroy;a=a.tag,void 0!==r&&(0!==(2&a)||0!==(4&a))&&el(s,t,r),i=i.next}while(i!==n)}ul(e,t,s);break;case 1:if(!Ko&&(Zo(s,t),"function"===typeof(n=s.stateNode).componentWillUnmount))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(o){Ac(s,t,o)}ul(e,t,s);break;case 21:ul(e,t,s);break;case 22:1&s.mode?(Ko=(n=Ko)||null!==s.memoizedState,ul(e,t,s),Ko=n):ul(e,t,s);break;default:ul(e,t,s)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new Jo),t.forEach((function(t){var n=jc.bind(null,e,t);s.has(t)||(s.add(t),t.then(n,n))}))}}function ml(e,t){var s=t.deletions;if(null!==s)for(var n=0;n<s.length;n++){var i=s[n];try{var r=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(a(160));pl(r,o,i),dl=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(d){Ac(i,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var s=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),bl(e),4&n){try{sl(3,e,e.return),nl(3,e)}catch(g){Ac(e,e.return,g)}try{sl(5,e,e.return)}catch(g){Ac(e,e.return,g)}}break;case 1:ml(t,e),bl(e),512&n&&null!==s&&Zo(s,s.return);break;case 5:if(ml(t,e),bl(e),512&n&&null!==s&&Zo(s,s.return),32&e.flags){var i=e.stateNode;try{ue(i,"")}catch(g){Ac(e,e.return,g)}}if(4&n&&null!=(i=e.stateNode)){var r=e.memoizedProps,o=null!==s?s.memoizedProps:r,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===r.type&&null!=r.name&&J(i,r),ye(l,o);var d=ye(l,r);for(o=0;o<c.length;o+=2){var h=c[o],u=c[o+1];"style"===h?ge(i,u):"dangerouslySetInnerHTML"===h?he(i,u):"children"===h?ue(i,u):y(i,h,u,d)}switch(l){case"input":Q(i,r);break;case"textarea":ae(i,r);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var f=r.value;null!=f?se(i,!!r.multiple,f,!1):p!==!!r.multiple&&(null!=r.defaultValue?se(i,!!r.multiple,r.defaultValue,!0):se(i,!!r.multiple,r.multiple?[]:"",!1))}i[pi]=r}catch(g){Ac(e,e.return,g)}}break;case 6:if(ml(t,e),bl(e),4&n){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,r=e.memoizedProps;try{i.nodeValue=r}catch(g){Ac(e,e.return,g)}}break;case 3:if(ml(t,e),bl(e),4&n&&null!==s&&s.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(g){Ac(e,e.return,g)}break;case 4:default:ml(t,e),bl(e);break;case 13:ml(t,e),bl(e),8192&(i=e.child).flags&&(r=null!==i.memoizedState,i.stateNode.isHidden=r,!r||null!==i.alternate&&null!==i.alternate.memoizedState||(Bl=Je())),4&n&&fl(e);break;case 22:if(h=null!==s&&null!==s.memoizedState,1&e.mode?(Ko=(d=Ko)||h,ml(t,e),Ko=d):ml(t,e),bl(e),8192&n){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!h&&0!==(1&e.mode))for(Qo=e,h=e.child;null!==h;){for(u=Qo=h;null!==Qo;){switch(f=(p=Qo).child,p.tag){case 0:case 11:case 14:case 15:sl(4,p,p.return);break;case 1:Zo(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){n=p,s=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ac(n,s,g)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){wl(u);continue}}null!==f?(f.return=p,Qo=f):wl(u)}h=h.sibling}e:for(h=null,u=e;;){if(5===u.tag){if(null===h){h=u;try{i=u.stateNode,d?"function"===typeof(r=i.style).setProperty?r.setProperty("display","none","important"):r.display="none":(l=u.stateNode,o=void 0!==(c=u.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Ac(e,e.return,g)}}}else if(6===u.tag){if(null===h)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(g){Ac(e,e.return,g)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:ml(t,e),bl(e),4&n&&fl(e);case 21:}}function bl(e){var t=e.flags;if(2&t){try{e:{for(var s=e.return;null!==s;){if(rl(s)){var n=s;break e}s=s.return}throw Error(a(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(ue(i,""),n.flags&=-33),cl(e,ol(e),i);break;case 3:case 4:var r=n.stateNode.containerInfo;ll(e,ol(e),r);break;default:throw Error(a(161))}}catch(o){Ac(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,s){Qo=e,yl(e,t,s)}function yl(e,t,s){for(var n=0!==(1&e.mode);null!==Qo;){var i=Qo,a=i.child;if(22===i.tag&&n){var r=null!==i.memoizedState||Yo;if(!r){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Ko;o=Yo;var c=Ko;if(Yo=r,(Ko=l)&&!c)for(Qo=i;null!==Qo;)l=(r=Qo).child,22===r.tag&&null!==r.memoizedState?_l(i):null!==l?(l.return=r,Qo=l):_l(i);for(;null!==a;)Qo=a,yl(a,t,s),a=a.sibling;Qo=i,Yo=o,Ko=c}xl(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Qo=a):xl(e)}}function xl(e){for(;null!==Qo;){var t=Qo;if(0!==(8772&t.flags)){var s=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ko||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Ko)if(null===s)n.componentDidMount();else{var i=t.elementType===t.type?s.memoizedProps:to(t.type,s.memoizedProps);n.componentDidUpdate(i,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var r=t.updateQueue;null!==r&&Ua(t,r,n);break;case 3:var o=t.updateQueue;if(null!==o){if(s=null,null!==t.child)switch(t.child.tag){case 5:case 1:s=t.child.stateNode}Ua(t,o,s)}break;case 5:var l=t.stateNode;if(null===s&&4&t.flags){s=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var h=d.memoizedState;if(null!==h){var u=h.dehydrated;null!==u&&Ht(u)}}}break;default:throw Error(a(163))}Ko||512&t.flags&&il(t)}catch(p){Ac(t,t.return,p)}}if(t===e){Qo=null;break}if(null!==(s=t.sibling)){s.return=t.return,Qo=s;break}Qo=t.return}}function wl(e){for(;null!==Qo;){var t=Qo;if(t===e){Qo=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qo=s;break}Qo=t.return}}function _l(e){for(;null!==Qo;){var t=Qo;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{nl(4,t)}catch(l){Ac(t,s,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(l){Ac(t,i,l)}}var a=t.return;try{il(t)}catch(l){Ac(t,a,l)}break;case 5:var r=t.return;try{il(t)}catch(l){Ac(t,r,l)}}}catch(l){Ac(t,t.return,l)}if(t===e){Qo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Qo=o;break}Qo=t.return}}var Sl,Al=Math.ceil,kl=x.ReactCurrentDispatcher,El=x.ReactCurrentOwner,Cl=x.ReactCurrentBatchConfig,jl=0,Nl=null,Tl=null,Pl=0,Ml=0,Rl=Ai(0),Il=0,Dl=null,Ll=0,Ol=0,Fl=0,zl=null,$l=null,Bl=0,Hl=1/0,Ul=null,Vl=!1,Wl=null,ql=null,Gl=!1,Xl=null,Yl=0,Kl=0,Jl=null,Ql=-1,Zl=0;function ec(){return 0!==(6&jl)?Je():-1!==Ql?Ql:Ql=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&jl)&&0!==Pl?Pl&-Pl:null!==ma.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function sc(e,t,s,n){if(50<Kl)throw Kl=0,Jl=null,Error(a(185));bt(e,s,n),0!==(2&jl)&&e===Nl||(e===Nl&&(0===(2&jl)&&(Ol|=s),4===Il&&oc(e,Pl)),nc(e,n),1===s&&0===jl&&0===(1&t.mode)&&(Hl=Je()+500,zi&&Hi()))}function nc(e,t){var s=e.callbackNode;!function(e,t){for(var s=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var r=31-rt(a),o=1<<r,l=i[r];-1===l?0!==(o&s)&&0===(o&n)||(i[r]=pt(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var n=ut(e,e===Nl?Pl:0);if(0===n)null!==s&&Xe(s),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=s&&Xe(s),1===t)0===e.tag?function(e){zi=!0,Bi(e)}(lc.bind(null,e)):Bi(lc.bind(null,e)),ri((function(){0===(6&jl)&&Hi()})),s=null;else{switch(xt(n)){case 1:s=Ze;break;case 4:s=et;break;case 16:default:s=tt;break;case 536870912:s=nt}s=Nc(s,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function ic(e,t){if(Ql=-1,Zl=0,0!==(6&jl))throw Error(a(327));var s=e.callbackNode;if(_c()&&e.callbackNode!==s)return null;var n=ut(e,e===Nl?Pl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=gc(e,n);else{t=n;var i=jl;jl|=2;var r=fc();for(Nl===e&&Pl===t||(Ul=null,Hl=Je()+500,uc(e,t));;)try{vc();break}catch(l){pc(e,l)}Ea(),kl.current=r,jl=i,null!==Tl?t=0:(Nl=null,Pl=0,t=Il)}if(0!==t){if(2===t&&(0!==(i=ft(e))&&(n=i,t=ac(e,i))),1===t)throw s=Dl,uc(e,0),oc(e,n),nc(e,Je()),s;if(6===t)oc(e,n);else{if(i=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var s=t.updateQueue;if(null!==s&&null!==(s=s.stores))for(var n=0;n<s.length;n++){var i=s[n],a=i.getSnapshot;i=i.value;try{if(!on(a(),i))return!1}catch(o){return!1}}}if(s=t.child,16384&t.subtreeFlags&&null!==s)s.return=t,t=s;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,n))&&(0!==(r=ft(e))&&(n=r,t=ac(e,r))),1===t))throw s=Dl,uc(e,0),oc(e,n),nc(e,Je()),s;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,$l,Ul);break;case 3:if(oc(e,n),(130023424&n)===n&&10<(t=Bl+500-Je())){if(0!==ut(e,0))break;if(((i=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(wc.bind(null,e,$l,Ul),t);break}wc(e,$l,Ul);break;case 4:if(oc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-rt(n);r=1<<o,(o=t[o])>i&&(i=o),n&=~r}if(n=i,10<(n=(120>(n=Je()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Al(n/1960))-n)){e.timeoutHandle=ni(wc.bind(null,e,$l,Ul),n);break}wc(e,$l,Ul);break;default:throw Error(a(329))}}}return nc(e,Je()),e.callbackNode===s?ic.bind(null,e):null}function ac(e,t){var s=zl;return e.current.memoizedState.isDehydrated&&(uc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=$l,$l=s,null!==t&&rc(t)),e}function rc(e){null===$l?$l=e:$l.push.apply($l,e)}function oc(e,t){for(t&=~Fl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-rt(t),n=1<<s;e[s]=-1,t&=~n}}function lc(e){if(0!==(6&jl))throw Error(a(327));_c();var t=ut(e,0);if(0===(1&t))return nc(e,Je()),null;var s=gc(e,t);if(0!==e.tag&&2===s){var n=ft(e);0!==n&&(t=n,s=ac(e,n))}if(1===s)throw s=Dl,uc(e,0),oc(e,t),nc(e,Je()),s;if(6===s)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,$l,Ul),nc(e,Je()),null}function cc(e,t){var s=jl;jl|=1;try{return e(t)}finally{0===(jl=s)&&(Hl=Je()+500,zi&&Hi())}}function dc(e){null!==Xl&&0===Xl.tag&&0===(6&jl)&&_c();var t=jl;jl|=1;var s=Cl.transition,n=yt;try{if(Cl.transition=null,yt=1,e)return e()}finally{yt=n,Cl.transition=s,0===(6&(jl=t))&&Hi()}}function hc(){Ml=Rl.current,ki(Rl)}function uc(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(-1!==s&&(e.timeoutHandle=-1,ii(s)),null!==Tl)for(s=Tl.return;null!==s;){var n=s;switch(ta(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Ri();break;case 3:Ka(),ki(Ni),ki(ji),sr();break;case 5:Qa(n);break;case 4:Ka();break;case 13:case 19:ki(Za);break;case 10:Ca(n.type._context);break;case 22:case 23:hc()}s=s.return}if(Nl=e,Tl=e=Rc(e.current,null),Pl=Ml=t,Il=0,Dl=null,Fl=Ol=Ll=0,$l=zl=null,null!==Pa){for(t=0;t<Pa.length;t++)if(null!==(n=(s=Pa[t]).interleaved)){s.interleaved=null;var i=n.next,a=s.pending;if(null!==a){var r=a.next;a.next=i,n.next=r}s.pending=n}Pa=null}return e}function pc(e,t){for(;;){var s=Tl;try{if(Ea(),nr.current=Jr,cr){for(var n=rr.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}cr=!1}if(ar=0,lr=or=rr=null,dr=!1,hr=0,El.current=null,null===s||null===s.return){Il=1,Dl=t,Tl=null;break}e:{var r=e,o=s.return,l=s,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,h=l,u=h.tag;if(0===(1&h.mode)&&(0===u||11===u||15===u)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=go(o);if(null!==f){f.flags&=-257,bo(f,o,l,0,t),1&f.mode&&mo(r,d,t),c=d;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mo(r,d,t),mc();break e}c=Error(a(426))}else if(ia&&1&l.mode){var b=go(o);if(null!==b){0===(65536&b.flags)&&(b.flags|=256),bo(b,o,l,0,t),fa(lo(c,l));break e}}r=c=lo(c,l),4!==Il&&(Il=2),null===zl?zl=[r]:zl.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,t&=-t,r.lanes|=t,Ba(r,po(0,c,t));break e;case 1:l=c;var v=r.type,y=r.stateNode;if(0===(128&r.flags)&&("function"===typeof v.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===ql||!ql.has(y)))){r.flags|=65536,t&=-t,r.lanes|=t,Ba(r,fo(r,l,t));break e}}r=r.return}while(null!==r)}xc(s)}catch(x){t=x,Tl===s&&null!==s&&(Tl=s=s.return);continue}break}}function fc(){var e=kl.current;return kl.current=Jr,null===e?Jr:e}function mc(){0!==Il&&3!==Il&&2!==Il||(Il=4),null===Nl||0===(268435455&Ll)&&0===(268435455&Ol)||oc(Nl,Pl)}function gc(e,t){var s=jl;jl|=2;var n=fc();for(Nl===e&&Pl===t||(Ul=null,uc(e,t));;)try{bc();break}catch(i){pc(e,i)}if(Ea(),jl=s,kl.current=n,null!==Tl)throw Error(a(261));return Nl=null,Pl=0,Il}function bc(){for(;null!==Tl;)yc(Tl)}function vc(){for(;null!==Tl&&!Ye();)yc(Tl)}function yc(e){var t=Sl(e.alternate,e,Ml);e.memoizedProps=e.pendingProps,null===t?xc(e):Tl=t,El.current=null}function xc(e){var t=e;do{var s=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(s=Go(s,t,Ml)))return void(Tl=s)}else{if(null!==(s=Xo(s,t)))return s.flags&=32767,void(Tl=s);if(null===e)return Il=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Il&&(Il=5)}function wc(e,t,s){var n=yt,i=Cl.transition;try{Cl.transition=null,yt=1,function(e,t,s,n){do{_c()}while(null!==Xl);if(0!==(6&jl))throw Error(a(327));s=e.finishedWork;var i=e.finishedLanes;if(null===s)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var r=s.lanes|s.childLanes;if(function(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<s;){var i=31-rt(s),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,s&=~a}}(e,r),e===Nl&&(Tl=Nl=null,Pl=0),0===(2064&s.subtreeFlags)&&0===(2064&s.flags)||Gl||(Gl=!0,Nc(tt,(function(){return _c(),null}))),r=0!==(15990&s.flags),0!==(15990&s.subtreeFlags)||r){r=Cl.transition,Cl.transition=null;var o=yt;yt=1;var l=jl;jl|=4,El.current=null,function(e,t){if(ei=Vt,pn(e=un())){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(n&&0!==n.rangeCount){s=n.anchorNode;var i=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{s.nodeType,r.nodeType}catch(w){s=null;break e}var o=0,l=-1,c=-1,d=0,h=0,u=e,p=null;t:for(;;){for(var f;u!==s||0!==i&&3!==u.nodeType||(l=o+i),u!==r||0!==n&&3!==u.nodeType||(c=o+n),3===u.nodeType&&(o+=u.nodeValue.length),null!==(f=u.firstChild);)p=u,u=f;for(;;){if(u===e)break t;if(p===s&&++d===i&&(l=o),p===r&&++h===n&&(c=o),null!==(f=u.nextSibling))break;p=(u=p).parentNode}u=f}s=-1===l||-1===c?null:{start:l,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(ti={focusedElem:e,selectionRange:s},Vt=!1,Qo=t;null!==Qo;)if(e=(t=Qo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qo=e;else for(;null!==Qo;){t=Qo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,b=m.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),b);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(a(163))}}catch(w){Ac(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qo=e;break}Qo=t.return}m=tl,tl=!1}(e,s),gl(s,e),fn(ti),Vt=!!ei,ti=ei=null,e.current=s,vl(s,e,i),Ke(),jl=l,yt=o,Cl.transition=r}else e.current=s;if(Gl&&(Gl=!1,Xl=e,Yl=i),r=e.pendingLanes,0===r&&(ql=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(s.stateNode),nc(e,Je()),null!==t)for(n=e.onRecoverableError,s=0;s<t.length;s++)i=t[s],n(i.value,{componentStack:i.stack,digest:i.digest});if(Vl)throw Vl=!1,e=Wl,Wl=null,e;0!==(1&Yl)&&0!==e.tag&&_c(),r=e.pendingLanes,0!==(1&r)?e===Jl?Kl++:(Kl=0,Jl=e):Kl=0,Hi()}(e,t,s,n)}finally{Cl.transition=i,yt=n}return null}function _c(){if(null!==Xl){var e=xt(Yl),t=Cl.transition,s=yt;try{if(Cl.transition=null,yt=16>e?16:e,null===Xl)var n=!1;else{if(e=Xl,Xl=null,Yl=0,0!==(6&jl))throw Error(a(331));var i=jl;for(jl|=4,Qo=e.current;null!==Qo;){var r=Qo,o=r.child;if(0!==(16&Qo.flags)){var l=r.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Qo=d;null!==Qo;){var h=Qo;switch(h.tag){case 0:case 11:case 15:sl(8,h,r)}var u=h.child;if(null!==u)u.return=h,Qo=u;else for(;null!==Qo;){var p=(h=Qo).sibling,f=h.return;if(al(h),h===d){Qo=null;break}if(null!==p){p.return=f,Qo=p;break}Qo=f}}}var m=r.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var b=g.sibling;g.sibling=null,g=b}while(null!==g)}}Qo=r}}if(0!==(2064&r.subtreeFlags)&&null!==o)o.return=r,Qo=o;else e:for(;null!==Qo;){if(0!==(2048&(r=Qo).flags))switch(r.tag){case 0:case 11:case 15:sl(9,r,r.return)}var v=r.sibling;if(null!==v){v.return=r.return,Qo=v;break e}Qo=r.return}}var y=e.current;for(Qo=y;null!==Qo;){var x=(o=Qo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Qo=x;else e:for(o=y;null!==Qo;){if(0!==(2048&(l=Qo).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(_){Ac(l,l.return,_)}if(l===o){Qo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qo=w;break e}Qo=l.return}}if(jl=i,Hi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(_){}n=!0}return n}finally{yt=s,Cl.transition=t}}return!1}function Sc(e,t,s){e=za(e,t=po(0,t=lo(s,t),1),1),t=ec(),null!==e&&(bt(e,1,t),nc(e,t))}function Ac(e,t,s){if(3===e.tag)Sc(e,e,s);else for(;null!==t;){if(3===t.tag){Sc(t,e,s);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===ql||!ql.has(n))){t=za(t,e=fo(t,e=lo(s,e),1),1),e=ec(),null!==t&&(bt(t,1,e),nc(t,e));break}}t=t.return}}function kc(e,t,s){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&s,Nl===e&&(Pl&s)===s&&(4===Il||3===Il&&(130023424&Pl)===Pl&&500>Je()-Bl?uc(e,0):Fl|=s),nc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var s=ec();null!==(e=Ia(e,t))&&(bt(e,t,s),nc(e,s))}function Cc(e){var t=e.memoizedState,s=0;null!==t&&(s=t.retryLane),Ec(e,s)}function jc(e,t){var s=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(s=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(a(314))}null!==n&&n.delete(t),Ec(e,s)}function Nc(e,t){return Ge(e,t)}function Tc(e,t,s,n){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,s,n){return new Tc(e,t,s,n)}function Mc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var s=e.alternate;return null===s?((s=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=14680064&e.flags,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Ic(e,t,s,n,i,r){var o=2;if(n=e,"function"===typeof e)Mc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Dc(s.children,i,r,t);case A:o=8,i|=8;break;case k:return(e=Pc(12,s,t,2|i)).elementType=k,e.lanes=r,e;case N:return(e=Pc(13,s,t,i)).elementType=N,e.lanes=r,e;case T:return(e=Pc(19,s,t,i)).elementType=T,e.lanes=r,e;case R:return Lc(s,i,r,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:o=10;break e;case C:o=9;break e;case j:o=11;break e;case P:o=14;break e;case M:o=16,n=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Pc(o,s,t,i)).elementType=e,t.type=n,t.lanes=r,t}function Dc(e,t,s,n){return(e=Pc(7,e,n,t)).lanes=s,e}function Lc(e,t,s,n){return(e=Pc(22,e,n,t)).elementType=R,e.lanes=s,e.stateNode={isHidden:!1},e}function Oc(e,t,s){return(e=Pc(6,e,null,t)).lanes=s,e}function Fc(e,t,s){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,s,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function $c(e,t,s,n,i,a,r,o,l){return e=new zc(e,t,s,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Pc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},La(a),e}function Bc(e){if(!e)return Ci;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var s=e.type;if(Mi(s))return Di(e,s,t)}return t}function Hc(e,t,s,n,i,a,r,o,l){return(e=$c(s,n,!0,e,0,a,0,o,l)).context=Bc(null),s=e.current,(a=Fa(n=ec(),i=tc(s))).callback=void 0!==t&&null!==t?t:null,za(s,a,i),e.current.lanes=i,bt(e,i,n),nc(e,n),e}function Uc(e,t,s,n){var i=t.current,a=ec(),r=tc(i);return s=Bc(s),null===t.context?t.context=s:t.pendingContext=s,(t=Fa(a,r)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=za(i,t,r))&&(sc(e,i,r,a),$a(e,i,r)),r}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var s=e.retryLane;e.retryLane=0!==s&&s<t?s:t}}function qc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}Sl=function(e,t,s){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ni.current)yo=!0;else{if(0===(e.lanes&s)&&0===(128&t.flags))return yo=!1,function(e,t,s){switch(t.tag){case 3:No(t),pa();break;case 5:Ja(t);break;case 1:Mi(t.type)&&Li(t);break;case 4:Ya(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ei(_a,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Ei(Za,1&Za.current),t.flags|=128,null):0!==(s&t.child.childLanes)?Oo(e,t,s):(Ei(Za,1&Za.current),null!==(e=Vo(e,t,s))?e.sibling:null);Ei(Za,1&Za.current);break;case 19:if(n=0!==(s&t.childLanes),0!==(128&e.flags)){if(n)return Ho(e,t,s);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ei(Za,Za.current),n)break;return null;case 22:case 23:return t.lanes=0,Ao(e,t,s)}return Vo(e,t,s)}(e,t,s);yo=0!==(131072&e.flags)}else yo=!1,ia&&0!==(1048576&t.flags)&&Zi(t,qi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Uo(e,t),e=t.pendingProps;var i=Pi(t,ji.current);Na(t,s),i=mr(null,t,n,e,i,s);var r=gr();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mi(n)?(r=!0,Li(t)):r=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,La(t),i.updater=no,t.stateNode=i,i._reactInternals=t,oo(t,n,e,s),t=jo(null,t,n,!0,r,s)):(t.tag=0,ia&&r&&ea(t),xo(null,t,i,s),t=t.child),t;case 16:n=t.elementType;e:{switch(Uo(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"===typeof e)return Mc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===j)return 11;if(e===P)return 14}return 2}(n),e=to(n,e),i){case 0:t=Eo(null,t,n,e,s);break e;case 1:t=Co(null,t,n,e,s);break e;case 11:t=wo(null,t,n,e,s);break e;case 14:t=_o(null,t,n,to(n.type,e),s);break e}throw Error(a(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,Eo(e,t,n,i=t.elementType===n?i:to(n,i),s);case 1:return n=t.type,i=t.pendingProps,Co(e,t,n,i=t.elementType===n?i:to(n,i),s);case 3:e:{if(No(t),null===e)throw Error(a(387));n=t.pendingProps,i=(r=t.memoizedState).element,Oa(e,t),Ha(t,n,null,s);var o=t.memoizedState;if(n=o.element,r.isDehydrated){if(r={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=r,t.memoizedState=r,256&t.flags){t=To(e,t,n,s,i=lo(Error(a(423)),t));break e}if(n!==i){t=To(e,t,n,s,i=lo(Error(a(424)),t));break e}for(na=ci(t.stateNode.containerInfo.firstChild),sa=t,ia=!0,aa=null,s=wa(t,null,n,s),t.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(pa(),n===i){t=Vo(e,t,s);break e}xo(e,t,n,s)}t=t.child}return t;case 5:return Ja(t),null===e&&ca(t),n=t.type,i=t.pendingProps,r=null!==e?e.memoizedProps:null,o=i.children,si(n,i)?o=null:null!==r&&si(n,r)&&(t.flags|=32),ko(e,t),xo(e,t,o,s),t.child;case 6:return null===e&&ca(t),null;case 13:return Oo(e,t,s);case 4:return Ya(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=xa(t,null,n,s):xo(e,t,n,s),t.child;case 11:return n=t.type,i=t.pendingProps,wo(e,t,n,i=t.elementType===n?i:to(n,i),s);case 7:return xo(e,t,t.pendingProps,s),t.child;case 8:case 12:return xo(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,r=t.memoizedProps,o=i.value,Ei(_a,n._currentValue),n._currentValue=o,null!==r)if(on(r.value,o)){if(r.children===i.children&&!Ni.current){t=Vo(e,t,s);break e}}else for(null!==(r=t.child)&&(r.return=t);null!==r;){var l=r.dependencies;if(null!==l){o=r.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===r.tag){(c=Fa(-1,s&-s)).tag=2;var d=r.updateQueue;if(null!==d){var h=(d=d.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}r.lanes|=s,null!==(c=r.alternate)&&(c.lanes|=s),ja(r.return,s,t),l.lanes|=s;break}c=c.next}}else if(10===r.tag)o=r.type===t.type?null:r.child;else if(18===r.tag){if(null===(o=r.return))throw Error(a(341));o.lanes|=s,null!==(l=o.alternate)&&(l.lanes|=s),ja(o,s,t),o=r.sibling}else o=r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===t){o=null;break}if(null!==(r=o.sibling)){r.return=o.return,o=r;break}o=o.return}r=o}xo(e,t,i.children,s),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Na(t,s),n=n(i=Ta(i)),t.flags|=1,xo(e,t,n,s),t.child;case 14:return i=to(n=t.type,t.pendingProps),_o(e,t,n,i=to(n.type,i),s);case 15:return So(e,t,t.type,t.pendingProps,s);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:to(n,i),Uo(e,t),t.tag=1,Mi(n)?(e=!0,Li(t)):e=!1,Na(t,s),ao(t,n,i),oo(t,n,i,s),jo(null,t,n,!0,e,s);case 19:return Ho(e,t,s);case 22:return Ao(e,t,s)}throw Error(a(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Xc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Zc(e,t,s,n,i){var a=s._reactRootContainer;if(a){var r=a;if("function"===typeof i){var o=i;i=function(){var e=Vc(r);o.call(e)}}Uc(t,r,e,i)}else r=function(e,t,s,n,i){if(i){if("function"===typeof n){var a=n;n=function(){var e=Vc(r);a.call(e)}}var r=Hc(t,n,e,0,null,!1,0,"",Qc);return e._reactRootContainer=r,e[fi]=r.current,Hn(8===e.nodeType?e.parentNode:e),dc(),r}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof n){var o=n;n=function(){var e=Vc(l);o.call(e)}}var l=$c(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[fi]=l.current,Hn(8===e.nodeType?e.parentNode:e),dc((function(){Uc(t,l,s,n)})),l}(s,t,e,i,n);return Vc(r)}Yc.prototype.render=Xc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Uc(e,t,null,null)},Yc.prototype.unmount=Xc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Uc(null,e,null,null)})),t[fi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=At();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Rt.length&&0!==t&&t<Rt[s].priority;s++);Rt.splice(s,0,e),0===s&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=ht(t.pendingLanes);0!==s&&(vt(t,1|s),nc(t,Je()),0===(6&jl)&&(Hl=Je()+500,Hi()))}break;case 13:dc((function(){var t=Ia(e,1);if(null!==t){var s=ec();sc(t,e,1,s)}})),qc(e,1)}},_t=function(e){if(13===e.tag){var t=Ia(e,134217728);if(null!==t)sc(t,e,134217728,ec());qc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),s=Ia(e,t);if(null!==s)sc(s,e,t,ec());qc(e,t)}},At=function(){return yt},kt=function(e,t){var s=yt;try{return yt=e,t()}finally{yt=s}},_e=function(e,t,s){switch(t){case"input":if(Q(e,s),t=s.name,"radio"===s.type&&null!=t){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var n=s[t];if(n!==e&&n.form===e.form){var i=wi(n);if(!i)throw Error(a(90));G(n),Q(n,i)}}}break;case"textarea":ae(e,s);break;case"select":null!=(t=s.value)&&se(e,!!s.multiple,t,!1)}},je=cc,Ne=dc;var ed={usingClientEntryPoint:!1,Events:[yi,xi,wi,Ee,Ce,cc]},td={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{it=nd.inject(sd),at=nd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Kc(t))throw Error(a(200));return function(e,t,s){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==n?null:""+n,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},t.createRoot=function(e,t){if(!Kc(e))throw Error(a(299));var s=!1,n="",i=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(s=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=$c(e,1,!1,null,0,s,0,n,i),e[fi]=t.current,Hn(8===e.nodeType?e.parentNode:e),new Xc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,s){if(!Jc(t))throw Error(a(200));return Zc(null,e,t,!0,s)},t.hydrateRoot=function(e,t,s){if(!Kc(e))throw Error(a(405));var n=null!=s&&s.hydratedSources||null,i=!1,r="",o=Gc;if(null!==s&&void 0!==s&&(!0===s.unstable_strictMode&&(i=!0),void 0!==s.identifierPrefix&&(r=s.identifierPrefix),void 0!==s.onRecoverableError&&(o=s.onRecoverableError)),t=Hc(t,null,e,1,null!=s?s:null,i,0,r,o),e[fi]=t.current,Hn(e),n)for(e=0;e<n.length;e++)i=(i=(s=n[e])._getVersion)(s._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[s,i]:t.mutableSourceEagerHydrationData.push(s,i);return new Yc(t)},t.render=function(e,t,s){if(!Jc(t))throw Error(a(200));return Zc(null,e,t,!1,s)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(a(40));return!!e._reactRootContainer&&(dc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,s,n){if(!Jc(s))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zc(e,t,s,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},736:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(s(374));class a extends i.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t){let{config:s,type:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");const a=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach((e=>{let[t,s]=e;this.url.searchParams.append(t,`eq.${s}`)})),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e){let{foreignTable:t,referencedTable:s=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=s?`${s}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}}t.default=a},745:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const n=s(400);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`}},829:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(s(736));t.default=class{constructor(e,t){let{headers:s={},schema:n,fetch:i}=t;this.url=e,this.headers=s,this.schema=n,this.fetch=i}select(e){let{head:t=!1,count:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=t?"HEAD":"GET";let a=!1;const r=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!a?"":('"'===e&&(a=!a),e))).join("");return this.url.searchParams.set("select",r),s&&(this.headers.Prefer=`count=${s}`),new i.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),s||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:s=!1,count:n,defaultToNull:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),a||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new i.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new i.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new i.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},853:(e,t,s)=>{"use strict";e.exports=s(234)},870:e=>{e.exports=async(e,t)=>{e.postMessage(t)}},871:e=>{e.exports=e=>{e.terminate()}},884:(e,t,s)=>{const n=s(346);e.exports={recognize:async(e,t,s)=>{const i=await n(t,1,s);return i.recognize(e).finally((async()=>{await i.terminate()}))},detect:async(e,t)=>{const s=await n("osd",0,t);return s.detect(e).finally((async()=>{await s.terminate()}))}}},926:function(e,t){var s=this;let n=!1;t.logging=n,t.setLogging=e=>{n=e},t.log=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n?console.log.apply(s,t):null}},938:(e,t,s)=>{const n=s(447),i=s(346),a=s(884),r=s(571),o=s(511),l=s(588),{setLogging:c}=s(926);e.exports={languages:r,OEM:o,PSM:l,createScheduler:n,createWorker:i,setLogging:c,...a}},942:e=>{e.exports=(e,t)=>{e.onmessage=e=>{let{data:s}=e;t(s)}}},950:(e,t,s)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=s(730)},980:function(e,t,s){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const i=n(s(210));t.PostgrestClient=i.default;const a=n(s(829));t.PostgrestQueryBuilder=a.default;const r=n(s(736));t.PostgrestFilterBuilder=r.default;const o=n(s(374));t.PostgrestTransformBuilder=o.default;const l=n(s(286));t.PostgrestBuilder=l.default;const c=n(s(611));t.PostgrestError=c.default,t.default={PostgrestClient:i.default,PostgrestQueryBuilder:a.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}},985:(e,t,s)=>{const{createClient:n}=s(95),i="https://aqdzmfhakqdwquszaqle.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ";const r=n(i,a);e.exports={createExecuteSqlFunction:async()=>{try{const e="\n      CREATE OR REPLACE FUNCTION execute_sql(sql text)\n      RETURNS void AS $$\n      BEGIN\n        EXECUTE sql;\n      END;\n      $$ LANGUAGE plpgsql SECURITY DEFINER;\n    ",{error:t}=await r.rpc("execute_sql",{sql:e});t&&console.warn("Warning: Could not create execute_sql function. It might already exist.")}catch(e){console.warn("Warning: Error creating execute_sql function:",e.message)}},insertSampleData:async()=>{try{console.log("Inserting sample data...");const e=[{name:"Hypertension",category:"Cardiovascular",description:"High blood pressure condition"},{name:"Diabetes",category:"Endocrine",description:"Blood sugar regulation disorder"},{name:"Asthma",category:"Respiratory",description:"Chronic respiratory condition"},{name:"Arthritis",category:"Musculoskeletal",description:"Joint inflammation condition"},{name:"Depression",category:"Mental Health",description:"Mood disorder"},{name:"Anxiety",category:"Mental Health",description:"Anxiety disorder"},{name:"Migraine",category:"Neurological",description:"Severe headache condition"},{name:"Allergies",category:"Immunological",description:"Immune system response"},{name:"Hypothyroidism",category:"Endocrine",description:"Underactive thyroid condition"},{name:"Hyperthyroidism",category:"Endocrine",description:"Overactive thyroid condition"}],{error:t}=await r.from("diseases").upsert(e);if(t)throw t;console.log("Sample data inserted successfully")}catch(e){throw console.error("Error inserting sample data:",e),e}},createStorageBuckets:async()=>{try{console.log("Creating storage buckets...");const t="\n      ALTER DATABASE postgres SET \"app.settings.storage.enabled\" TO 'true';\n    ";await r.rpc("execute_sql",{sql:t});const s=["profile-pictures","medical-reports","health-reports","chat-attachments","support-attachments"];for(const i of s)try{const{error:e}=await r.storage.createBucket(i,{public:!0});e&&!e.message.includes("already exists")&&console.warn(`Warning creating bucket ${i}:`,e.message)}catch(e){console.warn(`Error creating bucket ${i}:`,e.message)}const n="\n      DO $$ \n      BEGIN\n        CREATE POLICY \"Allow public access to profile pictures\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'profile-pictures');\n        \n        CREATE POLICY \"Allow public access to medical reports\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'medical-reports');\n        \n        CREATE POLICY \"Allow public access to health reports\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'health-reports');\n        \n        CREATE POLICY \"Allow public access to chat attachments\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'chat-attachments');\n        \n        CREATE POLICY \"Allow public access to support attachments\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'support-attachments');\n      EXCEPTION\n        WHEN others THEN\n          NULL;\n      END $$;\n    ";await r.rpc("execute_sql",{sql:n}),console.log("Storage buckets and policies created successfully")}catch(e){console.warn("Warning: Error setting up storage:",e.message)}}}}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,s),a.exports}s.m=e,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var a=Object.create(null);s.r(a);var r={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>r[e]=()=>n[e]));return r.default=()=>n,s.d(a,r),a}})(),s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>"static/js/"+e+"."+{198:"6056d451",453:"a0b1a081"}[e]+".chunk.js",s.miniCssF=e=>{},s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="digihealth:";s.l=(n,i,a,r)=>{if(e[n])e[n].push(i);else{var o,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var h=c[d];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+a){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",t+a),o.src=n),e[n]=[i];var u=(t,s)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[n];if(delete e[n],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(s))),t)return t(s)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="/DiGiHealthAdv/",(()=>{var e={792:0};s.f.j=(t,n)=>{var i=s.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var a=new Promise(((s,n)=>i=e[t]=[s,n]));n.push(i[2]=a);var r=s.p+s.u(t),o=new Error;s.l(r,(n=>{if(s.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+r+")",o.name="ChunkLoadError",o.type=a,o.request=r,i[1](o)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,a,r=n[0],o=n[1],l=n[2],c=0;if(r.some((t=>0!==e[t]))){for(i in o)s.o(o,i)&&(s.m[i]=o[i]);if(l)l(s)}for(t&&t(n);c<r.length;c++)a=r[c],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0},n=self.webpackChunkdigihealth=self.webpackChunkdigihealth||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e,t=s(43),n=s.t(t,2),i=s(391),a=s(950),r=s.t(a,2);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},o.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function d(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(s){}}}function h(e,t){return{usr:e.state,key:e.key,idx:t}}function u(e,t,s,n){return void 0===s&&(s=null),o({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:s,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:s="",hash:n=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function f(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function m(t,s,n,i){void 0===i&&(i={});let{window:a=document.defaultView,v5Compat:r=!1}=i,d=a.history,f=e.Pop,m=null,g=b();function b(){return(d.state||{idx:null}).idx}function v(){f=e.Pop;let t=b(),s=null==t?null:t-g;g=t,m&&m({action:f,location:x.location,delta:s})}function y(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,s="string"===typeof e?e:p(e);return s=s.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,t)}null==g&&(g=0,d.replaceState(o({},d.state,{idx:g}),""));let x={get action(){return f},get location(){return t(a,d)},listen(e){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(l,v),m=e,()=>{a.removeEventListener(l,v),m=null}},createHref:e=>s(a,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,s){f=e.Push;let i=u(x.location,t,s);n&&n(i,t),g=b()+1;let o=h(i,g),l=x.createHref(i);try{d.pushState(o,"",l)}catch(c){if(c instanceof DOMException&&"DataCloneError"===c.name)throw c;a.location.assign(l)}r&&m&&m({action:f,location:x.location,delta:1})},replace:function(t,s){f=e.Replace;let i=u(x.location,t,s);n&&n(i,t),g=b();let a=h(i,g),o=x.createHref(i);d.replaceState(a,"",o),r&&m&&m({action:f,location:x.location,delta:0})},go:e=>d.go(e)};return x}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,s){return void 0===s&&(s="/"),v(e,t,s,!1)}function v(e,t,s,n){let i=M(("string"===typeof t?f(t):t).pathname||"/",s);if(null==i)return null;let a=y(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every(((e,s)=>e===t[s]));return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let r=null;for(let o=0;null==r&&o<a.length;++o){let e=P(i);r=N(a[o],e,n)}return r}function y(e,t,s,n){void 0===t&&(t=[]),void 0===s&&(s=[]),void 0===n&&(n="");let i=(e,i,a)=>{let r={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};r.relativePath.startsWith("/")&&(c(r.relativePath.startsWith(n),'Absolute route path "'+r.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),r.relativePath=r.relativePath.slice(n.length));let o=O([n,r.relativePath]),l=s.concat(r);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),y(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:j(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var s;if(""!==e.path&&null!=(s=e.path)&&s.includes("?"))for(let n of x(e.path))i(e,t,n);else i(e,t)})),t}function x(e){let t=e.split("/");if(0===t.length)return[];let[s,...n]=t,i=s.endsWith("?"),a=s.replace(/\?$/,"");if(0===n.length)return i?[a,""]:[a];let r=x(n.join("/")),o=[];return o.push(...r.map((e=>""===e?a:[a,e].join("/")))),i&&o.push(...r),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const w=/^:[\w-]+$/,_=3,S=2,A=1,k=10,E=-2,C=e=>"*"===e;function j(e,t){let s=e.split("/"),n=s.length;return s.some(C)&&(n+=E),t&&(n+=S),s.filter((e=>!C(e))).reduce(((e,t)=>e+(w.test(t)?_:""===t?A:k)),n)}function N(e,t,s){void 0===s&&(s=!1);let{routesMeta:n}=e,i={},a="/",r=[];for(let o=0;o<n.length;++o){let e=n[o],l=o===n.length-1,c="/"===a?t:t.slice(a.length)||"/",d=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!d&&l&&s&&!n[n.length-1].route.index&&(d=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(i,d.params),r.push({params:i,pathname:O([a,d.pathname]),pathnameBase:F(O([a,d.pathnameBase])),route:h}),"/"!==d.pathnameBase&&(a=O([a,d.pathnameBase]))}return r}function T(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,n]=function(e,t,s){void 0===t&&(t=!1);void 0===s&&(s=!0);d("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,s)=>(n.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let a=new RegExp(i,t?void 0:"i");return[a,n]}(e.path,e.caseSensitive,e.end),i=t.match(s);if(!i)return null;let a=i[0],r=a.replace(/(.)\/+$/,"$1"),o=i.slice(1),l=n.reduce(((e,t,s)=>{let{paramName:n,isOptional:i}=t;if("*"===n){let e=o[s]||"";r=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[s];return e[n]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:a,pathnameBase:r,pattern:e}}function P(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return d(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function M(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,n=e.charAt(s);return n&&"/"!==n?null:e.slice(s)||"/"}function R(e,t,s,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function I(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function D(e,t){let s=I(e);return t?s.map(((e,t)=>t===s.length-1?e.pathname:e.pathnameBase)):s.map((e=>e.pathnameBase))}function L(e,t,s,n){let i;void 0===n&&(n=!1),"string"===typeof e?i=f(e):(i=o({},e),c(!i.pathname||!i.pathname.includes("?"),R("?","pathname","search",i)),c(!i.pathname||!i.pathname.includes("#"),R("#","pathname","hash",i)),c(!i.search||!i.search.includes("#"),R("#","search","hash",i)));let a,r=""===e||""===i.pathname,l=r?"/":i.pathname;if(null==l)a=s;else{let e=t.length-1;if(!n&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}a=e>=0?t[e]:"/"}let d=function(e,t){void 0===t&&(t="/");let{pathname:s,search:n="",hash:i=""}="string"===typeof e?f(e):e,a=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)})),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:a,search:z(n),hash:$(i)}}(i,a),h=l&&"/"!==l&&l.endsWith("/"),u=(r||"."===l)&&s.endsWith("/");return d.pathname.endsWith("/")||!h&&!u||(d.pathname+="/"),d}const O=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),z=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",$=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function B(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const H=["post","put","patch","delete"],U=(new Set(H),["get",...H]);new Set(U),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function V(){return V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},V.apply(this,arguments)}const W=t.createContext(null);const q=t.createContext(null);const G=t.createContext(null);const X=t.createContext(null);const Y=t.createContext({outlet:null,matches:[],isDataRoute:!1});const K=t.createContext(null);function J(){return null!=t.useContext(X)}function Q(){return J()||c(!1),t.useContext(X).location}function Z(e){t.useContext(G).static||t.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=t.useContext(Y);return e?function(){let{router:e}=de(le.UseNavigateStable),s=ue(ce.UseNavigateStable),n=t.useRef(!1);Z((()=>{n.current=!0}));let i=t.useCallback((function(t,i){void 0===i&&(i={}),n.current&&("number"===typeof t?e.navigate(t):e.navigate(t,V({fromRouteId:s},i)))}),[e,s]);return i}():function(){J()||c(!1);let e=t.useContext(W),{basename:s,future:n,navigator:i}=t.useContext(G),{matches:a}=t.useContext(Y),{pathname:r}=Q(),o=JSON.stringify(D(a,n.v7_relativeSplatPath)),l=t.useRef(!1);Z((()=>{l.current=!0}));let d=t.useCallback((function(t,n){if(void 0===n&&(n={}),!l.current)return;if("number"===typeof t)return void i.go(t);let a=L(t,JSON.parse(o),r,"path"===n.relative);null==e&&"/"!==s&&(a.pathname="/"===a.pathname?s:O([s,a.pathname])),(n.replace?i.replace:i.push)(a,n.state,n)}),[s,i,o,r,e]);return d}()}function te(e,s){let{relative:n}=void 0===s?{}:s,{future:i}=t.useContext(G),{matches:a}=t.useContext(Y),{pathname:r}=Q(),o=JSON.stringify(D(a,i.v7_relativeSplatPath));return t.useMemo((()=>L(e,JSON.parse(o),r,"path"===n)),[e,o,r,n])}function se(s,n,i,a){J()||c(!1);let{navigator:r,static:o}=t.useContext(G),{matches:l}=t.useContext(Y),d=l[l.length-1],h=d?d.params:{},u=(d&&d.pathname,d?d.pathnameBase:"/");d&&d.route;let p,m=Q();if(n){var g;let e="string"===typeof n?f(n):n;"/"===u||(null==(g=e.pathname)?void 0:g.startsWith(u))||c(!1),p=e}else p=m;let v=p.pathname||"/",y=v;if("/"!==u){let e=u.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=!o&&i&&i.matches&&i.matches.length>0?i.matches:b(s,{pathname:y});let w=oe(x&&x.map((e=>Object.assign({},e,{params:Object.assign({},h,e.params),pathname:O([u,r.encodeLocation?r.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:O([u,r.encodeLocation?r.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,i,a);return n&&w?t.createElement(X.Provider,{value:{location:V({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:e.Pop}},w):w}function ne(){let e=function(){var e;let s=t.useContext(K),n=he(ce.UseRouteError),i=ue(ce.UseRouteError);if(void 0!==s)return s;return null==(e=n.errors)?void 0:e[i]}(),s=B(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},s),n?t.createElement("pre",{style:a},n):null,null)}const ie=t.createElement(ne,null);class ae extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(Y.Provider,{value:this.props.routeContext},t.createElement(K.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function re(e){let{routeContext:s,match:n,children:i}=e,a=t.useContext(W);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),t.createElement(Y.Provider,{value:s},i)}function oe(e,s,n,i){var a;if(void 0===s&&(s=[]),void 0===n&&(n=null),void 0===i&&(i=null),null==e){var r;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(r=i)&&r.v7_partialHydration&&0===s.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(a=n)?void 0:a.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||c(!1),o=o.slice(0,Math.min(o.length,e+1))}let d=!1,h=-1;if(n&&i&&i.v7_partialHydration)for(let t=0;t<o.length;t++){let e=o[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(h=t),e.route.id){let{loaderData:t,errors:s}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!s||void 0===s[e.route.id]);if(e.route.lazy||i){d=!0,o=h>=0?o.slice(0,h+1):[o[0]];break}}}return o.reduceRight(((e,i,a)=>{let r,c=!1,u=null,p=null;var f;n&&(r=l&&i.route.id?l[i.route.id]:void 0,u=i.route.errorElement||ie,d&&(h<0&&0===a?(f="route-fallback",!1||pe[f]||(pe[f]=!0),c=!0,p=null):h===a&&(c=!0,p=i.route.hydrateFallbackElement||null)));let m=s.concat(o.slice(0,a+1)),g=()=>{let s;return s=r?u:c?p:i.route.Component?t.createElement(i.route.Component,null):i.route.element?i.route.element:e,t.createElement(re,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:s})};return n&&(i.route.ErrorBoundary||i.route.errorElement||0===a)?t.createElement(ae,{location:n.location,revalidation:n.revalidation,component:u,error:r,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var le=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(le||{}),ce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ce||{});function de(e){let s=t.useContext(W);return s||c(!1),s}function he(e){let s=t.useContext(q);return s||c(!1),s}function ue(e){let s=function(){let e=t.useContext(Y);return e||c(!1),e}(),n=s.matches[s.matches.length-1];return n.route.id||c(!1),n.route.id}const pe={};function fe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}n.startTransition;function me(e){let{to:s,replace:n,state:i,relative:a}=e;J()||c(!1);let{future:r,static:o}=t.useContext(G),{matches:l}=t.useContext(Y),{pathname:d}=Q(),h=ee(),u=L(s,D(l,r.v7_relativeSplatPath),d,"path"===a),p=JSON.stringify(u);return t.useEffect((()=>h(JSON.parse(p),{replace:n,state:i,relative:a})),[h,p,a,n,i]),null}function ge(e){c(!1)}function be(s){let{basename:n="/",children:i=null,location:a,navigationType:r=e.Pop,navigator:o,static:l=!1,future:d}=s;J()&&c(!1);let h=n.replace(/^\/*/,"/"),u=t.useMemo((()=>({basename:h,navigator:o,static:l,future:V({v7_relativeSplatPath:!1},d)})),[h,d,o,l]);"string"===typeof a&&(a=f(a));let{pathname:p="/",search:m="",hash:g="",state:b=null,key:v="default"}=a,y=t.useMemo((()=>{let e=M(p,h);return null==e?null:{location:{pathname:e,search:m,hash:g,state:b,key:v},navigationType:r}}),[h,p,m,g,b,v,r]);return null==y?null:t.createElement(G.Provider,{value:u},t.createElement(X.Provider,{children:i,value:y}))}function ve(e){let{children:t,location:s}=e;return se(ye(t),s)}new Promise((()=>{}));t.Component;function ye(e,s){void 0===s&&(s=[]);let n=[];return t.Children.forEach(e,((e,i)=>{if(!t.isValidElement(e))return;let a=[...s,i];if(e.type===t.Fragment)return void n.push.apply(n,ye(e.props.children,a));e.type!==ge&&c(!1),e.props.index&&e.props.children&&c(!1);let r={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(r.children=ye(e.props.children,a)),n.push(r)})),n}function xe(){return xe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},xe.apply(this,arguments)}function we(e,t){if(null==e)return{};var s,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||(i[s]=e[s]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const _e=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(zS){}new Map;const Se=n.startTransition;r.flushSync,n.useId;function Ae(e){let{basename:s,children:n,future:i,window:a}=e,r=t.useRef();null==r.current&&(r.current=function(e){return void 0===e&&(e={}),m((function(e,t){let{pathname:s,search:n,hash:i}=e.location;return u("",{pathname:s,search:n,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:p(t)}),null,e)}({window:a,v5Compat:!0}));let o=r.current,[l,c]=t.useState({action:o.action,location:o.location}),{v7_startTransition:d}=i||{},h=t.useCallback((e=>{d&&Se?Se((()=>c(e))):c(e)}),[c,d]);return t.useLayoutEffect((()=>o.listen(h)),[o,h]),t.useEffect((()=>fe(i)),[i]),t.createElement(be,{basename:s,children:n,location:l.location,navigationType:l.action,navigator:o,future:i})}const ke="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ee=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ce=t.forwardRef((function(e,s){let n,{onClick:i,relative:a,reloadDocument:r,replace:o,state:l,target:d,to:h,preventScrollReset:u,viewTransition:f}=e,m=we(e,_e),{basename:g}=t.useContext(G),b=!1;if("string"===typeof h&&Ee.test(h)&&(n=h,ke))try{let e=new URL(window.location.href),t=h.startsWith("//")?new URL(e.protocol+h):new URL(h),s=M(t.pathname,g);t.origin===e.origin&&null!=s?h=s+t.search+t.hash:b=!0}catch(zS){}let v=function(e,s){let{relative:n}=void 0===s?{}:s;J()||c(!1);let{basename:i,navigator:a}=t.useContext(G),{hash:r,pathname:o,search:l}=te(e,{relative:n}),d=o;return"/"!==i&&(d="/"===o?i:O([i,o])),a.createHref({pathname:d,search:l,hash:r})}(h,{relative:a}),y=function(e,s){let{target:n,replace:i,state:a,preventScrollReset:r,relative:o,viewTransition:l}=void 0===s?{}:s,c=ee(),d=Q(),h=te(e,{relative:o});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let s=void 0!==i?i:p(d)===p(h);c(e,{replace:s,state:a,preventScrollReset:r,relative:o,viewTransition:l})}}),[d,c,h,i,a,n,e,r,o,l])}(h,{replace:o,state:l,target:d,preventScrollReset:u,relative:a,viewTransition:f});return t.createElement("a",xe({},m,{href:n||v,onClick:b||r?i:function(e){i&&i(e),e.defaultPrevented||y(e)},ref:s,target:d}))}));var je,Ne;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(je||(je={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ne||(Ne={}));var Te=s(95);const Pe=(0,Te.createClient)("https://aqdzmfhakqdwquszaqle.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ");var Me=s(579);const Re=(0,t.createContext)();function Ie(){return(0,t.useContext)(Re)}function De(e){let{children:s}=e;const[n,i]=(0,t.useState)(null),[a,r]=(0,t.useState)(!0);(0,t.useEffect)((()=>{Pe.auth.getSession().then((e=>{var t;let{data:{session:s}}=e;i(null!==(t=null===s||void 0===s?void 0:s.user)&&void 0!==t?t:null),r(!1)}));const{data:{subscription:e}}=Pe.auth.onAuthStateChange(((e,t)=>{var s;i(null!==(s=null===t||void 0===t?void 0:t.user)&&void 0!==s?s:null),r(!1)}));return()=>e.unsubscribe()}),[]);const o={user:n,loading:a,signUp:e=>Pe.auth.signUp(e),signIn:e=>Pe.auth.signInWithPassword(e),signOut:()=>Pe.auth.signOut()};return(0,Me.jsx)(Re.Provider,{value:o,children:!a&&s})}function Le(e){var t,s,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(s=Le(e[t]))&&(n&&(n+=" "),n+=s)}else for(s in e)e[s]&&(n&&(n+=" "),n+=s);return n}const Oe=function(){for(var e,t,s=0,n="",i=arguments.length;s<i;s++)(e=arguments[s])&&(t=Le(e))&&(n&&(n+=" "),n+=t);return n};!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t.firstChild?t.insertBefore(s,t.firstChild):t.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var Fe=e=>"number"==typeof e&&!isNaN(e),ze=e=>"string"==typeof e,$e=e=>"function"==typeof e,Be=e=>ze(e)||$e(e)?e:null,He=(e,t)=>!1===e||Fe(e)&&e>0?e:t,Ue=e=>(0,t.isValidElement)(e)||ze(e)||$e(e)||Fe(e);function Ve(e){let{enter:s,exit:n,appendPosition:i=!1,collapse:a=!0,collapseDuration:r=300}=e;return function(e){let{children:o,position:l,preventExitTransition:c,done:d,nodeRef:h,isIn:u,playToast:p}=e,f=i?`${s}--${l}`:s,m=i?`${n}--${l}`:n,g=(0,t.useRef)(0);return(0,t.useLayoutEffect)((()=>{let e=h.current,t=f.split(" "),s=n=>{n.target===h.current&&(p(),e.removeEventListener("animationend",s),e.removeEventListener("animationcancel",s),0===g.current&&"animationcancel"!==n.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",s),e.addEventListener("animationcancel",s)}),[]),(0,t.useEffect)((()=>{let e=h.current,t=()=>{e.removeEventListener("animationend",t),a?function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:n,style:i}=e;requestAnimationFrame((()=>{i.minHeight="initial",i.height=n+"px",i.transition=`all ${s}ms`,requestAnimationFrame((()=>{i.height="0",i.padding="0",i.margin="0",setTimeout(t,s)}))}))}(e,d,r):d()};u||(c?t():(g.current=1,e.className+=` ${m}`,e.addEventListener("animationend",t)))}),[u]),t.createElement(t.Fragment,null,o)}}function We(e,t){return{content:qe(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function qe(e,s){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,t.isValidElement)(e)&&!ze(e.type)?(0,t.cloneElement)(e,{closeToast:s.closeToast,toastProps:s,data:s.data,isPaused:n}):$e(e)?e({closeToast:s.closeToast,toastProps:s,data:s.data,isPaused:n}):e}function Ge(e){let{delay:s,isRunning:n,closeToast:i,type:a="default",hide:r,className:o,controlledProgress:l,progress:c,rtl:d,isIn:h,theme:u}=e,p=r||l&&0===c,f={animationDuration:`${s}ms`,animationPlayState:n?"running":"paused"};l&&(f.transform=`scaleX(${c})`);let m=Oe("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${u}`,`Toastify__progress-bar--${a}`,{"Toastify__progress-bar--rtl":d}),g=$e(o)?o({rtl:d,type:a,defaultClassName:m}):Oe(m,o),b={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{h&&i()}};return t.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":p},t.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${u} Toastify__progress-bar--${a}`}),t.createElement("div",{role:"progressbar","aria-hidden":p?"true":"false","aria-label":"notification timer",className:g,style:f,...b}))}var Xe=1,Ye=()=>""+Xe++;function Ke(e,t,s){let n=1,i=0,a=[],r=[],o=t,l=new Map,c=new Set,d=()=>{r=Array.from(l.values()),c.forEach((e=>e()))},h=e=>{var t,s;null==(s=null==(t=e.props)?void 0:t.onClose)||s.call(t,e.removalReason),e.isActive=!1},u=e=>{if(null==e)l.forEach(h);else{let t=l.get(e);t&&h(t)}d()},p=e=>{var t,n;let{toastId:i,updateId:a}=e.props,r=null==a;e.staleId&&l.delete(e.staleId),e.isActive=!0,l.set(i,e),d(),s(We(e,r?"added":"updated")),r&&(null==(n=(t=e.props).onOpen)||n.call(t))};return{id:e,props:o,observe:e=>(c.add(e),()=>c.delete(e)),toggle:(e,t)=>{l.forEach((s=>{var n;(null==t||t===s.props.toastId)&&(null==(n=s.toggle)||n.call(s,e))}))},removeToast:u,toasts:l,clearQueue:()=>{i-=a.length,a=[]},buildToast:(t,r)=>{if((t=>{let{containerId:s,toastId:n,updateId:i}=t,a=s?s!==e:1!==e,r=l.has(n)&&null==i;return a||r})(r))return;let{toastId:c,updateId:h,data:f,staleId:m,delay:g}=r,b=null==h;b&&i++;let v={...o,style:o.toastStyle,key:n++,...Object.fromEntries(Object.entries(r).filter((e=>{let[t,s]=e;return null!=s}))),toastId:c,updateId:h,data:f,isIn:!1,className:Be(r.className||o.toastClassName),progressClassName:Be(r.progressClassName||o.progressClassName),autoClose:!r.isLoading&&He(r.autoClose,o.autoClose),closeToast(e){l.get(c).removalReason=e,u(c)},deleteToast(){let e=l.get(c);if(null!=e){if(s(We(e,"removed")),l.delete(c),i--,i<0&&(i=0),a.length>0)return void p(a.shift());d()}}};v.closeButton=o.closeButton,!1===r.closeButton||Ue(r.closeButton)?v.closeButton=r.closeButton:!0===r.closeButton&&(v.closeButton=!Ue(o.closeButton)||o.closeButton);let y={content:t,props:v,staleId:m};o.limit&&o.limit>0&&i>o.limit&&b?a.push(y):Fe(g)?setTimeout((()=>{p(y)}),g):p(y)},setProps(e){o=e},setToggle:(e,t)=>{let s=l.get(e);s&&(s.toggle=t)},isToastActive:e=>{var t;return null==(t=l.get(e))?void 0:t.isActive},getSnapshot:()=>r}}var Je=new Map,Qe=[],Ze=new Set,et=e=>Ze.forEach((t=>t(e))),tt=()=>Je.size>0;function st(e,t){var s;if(t)return!(null==(s=Je.get(t))||!s.isToastActive(e));let n=!1;return Je.forEach((t=>{t.isToastActive(e)&&(n=!0)})),n}function nt(e){if(tt()){if(null==e||(e=>ze(e)||Fe(e))(e))Je.forEach((t=>{t.removeToast(e)}));else if(e&&("containerId"in e||"id"in e)){let t=Je.get(e.containerId);t?t.removeToast(e.id):Je.forEach((t=>{t.removeToast(e.id)}))}}else Qe=Qe.filter((t=>null!=e&&t.options.toastId!==e))}function it(e,t){Ue(e)&&(tt()||Qe.push({content:e,options:t}),Je.forEach((s=>{s.buildToast(e,t)})))}function at(e,t){Je.forEach((s=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===s.id)&&s.toggle(e,null==t?void 0:t.id)}))}function rt(e){let t=e.containerId||1;return{subscribe(s){let n=Ke(t,e,et);Je.set(t,n);let i=n.observe(s);return Qe.forEach((e=>it(e.content,e.options))),Qe=[],()=>{i(),Je.delete(t)}},setProps(e){var s;null==(s=Je.get(t))||s.setProps(e)},getSnapshot(){var e;return null==(e=Je.get(t))?void 0:e.getSnapshot()}}}function ot(e){return e&&(ze(e.toastId)||Fe(e.toastId))?e.toastId:Ye()}function lt(e,t){return it(e,t),t.toastId}function ct(e,t){return{...t,type:t&&t.type||e,toastId:ot(t)}}function dt(e){return(t,s)=>lt(t,ct(e,s))}function ht(e,t){return lt(e,ct("default",t))}function ut(e){let[s,n]=(0,t.useState)(!1),[i,a]=(0,t.useState)(!1),r=(0,t.useRef)(null),o=(0,t.useRef)({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:d,onClick:h,closeOnClick:u}=e;function p(){n(!0)}function f(){n(!1)}function m(t){let n=r.current;if(o.canDrag&&n){o.didMove=!0,s&&f(),"x"===e.draggableDirection?o.delta=t.clientX-o.start:o.delta=t.clientY-o.start,o.start!==t.clientX&&(o.canCloseOnClick=!1);let i="x"===e.draggableDirection?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;n.style.transform=`translate3d(${i},0)`,n.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance))}}function g(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",g);let t=r.current;if(o.canDrag&&o.didMove&&t){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return a(!0),e.closeToast(!0),void e.collapseAll();t.style.transition="transform 0.2s, opacity 0.2s",t.style.removeProperty("transform"),t.style.removeProperty("opacity")}}(function(e){var t;null==(t=Je.get(e.containerId||1))||t.setToggle(e.id,e.fn)})({id:e.toastId,containerId:e.containerId,fn:n}),(0,t.useEffect)((()=>{if(e.pauseOnFocusLoss)return document.hasFocus()||f(),window.addEventListener("focus",p),window.addEventListener("blur",f),()=>{window.removeEventListener("focus",p),window.removeEventListener("blur",f)}}),[e.pauseOnFocusLoss]);let b={onPointerDown:function(t){if(!0===e.draggable||e.draggable===t.pointerType){o.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",g);let s=r.current;o.canCloseOnClick=!0,o.canDrag=!0,s.style.transition="none","x"===e.draggableDirection?(o.start=t.clientX,o.removalDistance=s.offsetWidth*(e.draggablePercent/100)):(o.start=t.clientY,o.removalDistance=s.offsetHeight*(80===e.draggablePercent?1.5*e.draggablePercent:e.draggablePercent)/100)}},onPointerUp:function(t){let{top:s,bottom:n,left:i,right:a}=r.current.getBoundingClientRect();"touchend"!==t.nativeEvent.type&&e.pauseOnHover&&t.clientX>=i&&t.clientX<=a&&t.clientY>=s&&t.clientY<=n?f():p()}};return l&&c&&(b.onMouseEnter=f,e.stacked||(b.onMouseLeave=p)),u&&(b.onClick=e=>{h&&h(e),o.canCloseOnClick&&d(!0)}),{playToast:p,pauseToast:f,isRunning:s,preventExitTransition:i,toastRef:r,eventHandlers:b}}ht.loading=(e,t)=>lt(e,ct("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t})),ht.promise=function(e,t,s){let n,{pending:i,error:a,success:r}=t;i&&(n=ze(i)?ht.loading(i,s):ht.loading(i.render,{...s,...i}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(e,t,i)=>{if(null==t)return void ht.dismiss(n);let a={type:e,...o,...s,data:i},r=ze(t)?{render:t}:t;return n?ht.update(n,{...a,...r}):ht(r.render,{...a,...r}),i},c=$e(e)?e():e;return c.then((e=>l("success",r,e))).catch((e=>l("error",a,e))),c},ht.success=dt("success"),ht.info=dt("info"),ht.error=dt("error"),ht.warning=dt("warning"),ht.warn=ht.warning,ht.dark=(e,t)=>lt(e,ct("default",{theme:"dark",...t})),ht.dismiss=function(e){nt(e)},ht.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Je.forEach((t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()}))},ht.isActive=st,ht.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=((e,t)=>{let{containerId:s}=t;var n;return null==(n=Je.get(s||1))?void 0:n.toasts.get(e)})(e,t);if(s){let{props:n,content:i}=s,a={delay:100,...n,...t,toastId:t.toastId||e,updateId:Ye()};a.toastId!==e&&(a.staleId=e);let r=a.render||i;delete a.render,lt(r,a)}},ht.done=e=>{ht.update(e,{progress:1})},ht.onChange=function(e){return Ze.add(e),()=>{Ze.delete(e)}},ht.play=e=>at(!0,e),ht.pause=e=>at(!1,e);var pt="undefined"!=typeof window?t.useLayoutEffect:t.useEffect,ft=e=>{let{theme:s,type:n,isLoading:i,...a}=e;return t.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===s?"currentColor":`var(--toastify-icon-color-${n})`,...a})};var mt={info:function(e){return t.createElement(ft,{...e},t.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(e){return t.createElement(ft,{...e},t.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(e){return t.createElement(ft,{...e},t.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(e){return t.createElement(ft,{...e},t.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return t.createElement("div",{className:"Toastify__spinner"})}};function gt(e){let{theme:s,type:n,isLoading:i,icon:a}=e,r=null,o={theme:s,type:n};return!1===a||($e(a)?r=a({...o,isLoading:i}):(0,t.isValidElement)(a)?r=(0,t.cloneElement)(a,o):i?r=mt.spinner():(e=>e in mt)(n)&&(r=mt[n](o))),r}var bt=e=>{let{isRunning:s,preventExitTransition:n,toastRef:i,eventHandlers:a,playToast:r}=ut(e),{closeButton:o,children:l,autoClose:c,onClick:d,type:h,hideProgressBar:u,closeToast:p,transition:f,position:m,className:g,style:b,progressClassName:v,updateId:y,role:x,progress:w,rtl:_,toastId:S,deleteToast:A,isIn:k,isLoading:E,closeOnClick:C,theme:j,ariaLabel:N}=e,T=Oe("Toastify__toast",`Toastify__toast-theme--${j}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":_},{"Toastify__toast--close-on-click":C}),P=$e(g)?g({rtl:_,position:m,type:h,defaultClassName:T}):Oe(T,g),M=gt(e),R=!!w||!c,I={closeToast:p,type:h,theme:j},D=null;return!1===o||(D=$e(o)?o(I):(0,t.isValidElement)(o)?(0,t.cloneElement)(o,I):function(e){let{closeToast:s,theme:n,ariaLabel:i="close"}=e;return t.createElement("button",{className:`Toastify__close-button Toastify__close-button--${n}`,type:"button",onClick:e=>{e.stopPropagation(),s(!0)},"aria-label":i},t.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},t.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(I)),t.createElement(f,{isIn:k,done:A,position:m,preventExitTransition:n,nodeRef:i,playToast:r},t.createElement("div",{id:S,tabIndex:0,onClick:d,"data-in":k,className:P,...a,style:b,ref:i,...k&&{role:x,"aria-label":N}},null!=M&&t.createElement("div",{className:Oe("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!E})},M),qe(l,e,!s),D,!e.customProgressBar&&t.createElement(Ge,{...y&&!R?{key:`p-${y}`}:{},rtl:_,theme:j,delay:c,isRunning:s,isIn:k,closeToast:p,hide:u,type:h,className:v,controlledProgress:R,progress:w||0})))},vt=function(e){return{enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},yt=Ve(vt("bounce",!0)),xt=(Ve(vt("slide",!0)),Ve(vt("zoom")),Ve(vt("flip")),{position:"top-right",transition:yt,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&"KeyT"===e.code});function wt(e){let s={...xt,...e},n=e.stacked,[i,a]=(0,t.useState)(!0),r=(0,t.useRef)(null),{getToastToRender:o,isToastActive:l,count:c}=function(e){var s;let{subscribe:n,getSnapshot:i,setProps:a}=(0,t.useRef)(rt(e)).current;a(e);let r=null==(s=(0,t.useSyncExternalStore)(n,i,i))?void 0:s.slice();return{getToastToRender:function(t){if(!r)return[];let s=new Map;return e.newestOnTop&&r.reverse(),r.forEach((e=>{let{position:t}=e.props;s.has(t)||s.set(t,[]),s.get(t).push(e)})),Array.from(s,(e=>t(e[0],e[1])))},isToastActive:st,count:null==r?void 0:r.length}}(s),{className:d,style:h,rtl:u,containerId:p,hotKeys:f}=s;function m(e){let t=Oe("Toastify__toast-container",`Toastify__toast-container--${e}`,{"Toastify__toast-container--rtl":u});return $e(d)?d({position:e,rtl:u,defaultClassName:t}):Oe(t,Be(d))}function g(){n&&(a(!0),ht.play())}return pt((()=>{var e;if(n){let t=r.current.querySelectorAll('[data-in="true"]'),n=12,a=null==(e=s.position)?void 0:e.includes("top"),o=0,l=0;Array.from(t).reverse().forEach(((e,t)=>{let s=e;s.classList.add("Toastify__toast--stacked"),t>0&&(s.dataset.collapsed=`${i}`),s.dataset.pos||(s.dataset.pos=a?"top":"bot");let r=o*(i?.2:1)+(i?0:n*t);s.style.setProperty("--y",`${a?r:-1*r}px`),s.style.setProperty("--g",`${n}`),s.style.setProperty("--s",""+(1-(i?l:0))),o+=s.offsetHeight,l+=.025}))}}),[i,c,n]),(0,t.useEffect)((()=>{function e(e){var t;let s=r.current;f(e)&&(null==(t=s.querySelector('[tabIndex="0"]'))||t.focus(),a(!1),ht.pause()),"Escape"===e.key&&(document.activeElement===s||null!=s&&s.contains(document.activeElement))&&(a(!0),ht.play())}return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}}),[f]),t.createElement("section",{ref:r,className:"Toastify",id:p,onMouseEnter:()=>{n&&(a(!1),ht.pause())},onMouseLeave:g,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":s["aria-label"]},o(((e,s)=>{let i=s.length?{...h}:{...h,pointerEvents:"none"};return t.createElement("div",{tabIndex:-1,className:m(e),"data-stacked":n,style:i,key:`c-${e}`},s.map((e=>{let{content:s,props:i}=e;return t.createElement(bt,{...i,stacked:n,collapseAll:g,isIn:l(i.toastId,i.containerId),key:`t-${i.key}`},s)})))})))}function _t(){const e=document.querySelectorAll(".menu-item"),t=document.querySelector(".overlay");e.forEach((e=>{e.classList.remove("active");const t=e.querySelector(".sub-menu");t&&t.classList.remove("active")})),t&&t.classList.remove("active"),document.body.style.overflow=""}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("health-overview");e&&e.addEventListener("click",(()=>{window.location.href="view-reports.html"}))}));const St=()=>{const e=ee(),[s,n]=(0,t.useState)(!1);(0,t.useEffect)((()=>{!function(){const e=document.querySelectorAll(".menu-item"),t=document.querySelector(".overlay");e.forEach((e=>{e.addEventListener("click",(s=>{s.preventDefault();const n=e.querySelector(".sub-menu");n&&(n.classList.toggle("active"),e.classList.toggle("active"),t&&t.classList.toggle("active"),document.body.style.overflow=n.classList.contains("active")?"hidden":"")}))})),t&&t.addEventListener("click",_t)}(),i()}),[]);const i=async()=>{try{var e;const{data:{user:t}}=await Pe.auth.getUser();t&&"admin"===(null===(e=t.user_metadata)||void 0===e?void 0:e.role)&&n(!0)}catch(t){console.error("Error checking user role:",t)}},a=t=>{t.preventDefault();switch(t.currentTarget.id){case"health-overview":e("/health-overview");break;case"medical-history":e("/medical-history");break;case"chronic-disease-management":e("/chronic-disease-management");break;case"vaccination-history":e("/vaccination-history");break;case"health-analytics":e("/health-analytics");break;case"medication-tracker":e("/medication-tracker");break;case"profile-settings":e("/profile");break;case"upcoming-appointments":e("/appointments/upcoming");break;case"appointment-history":e("/appointments/history");break;case"telehealth-consultations":e("/appointments/telehealth");break;case"appointment-reminders":e("/appointments/reminders");break;case"help-center":e("/help-center");break;case"contact-support":e("/support/contact");break;case"live-chat":e("/support/chat");break;case"security-settings":e("/settings/security");break;case"data-backup":e("/settings/backup");break;case"database-setup":e("/admin/database-setup");break;case"logout-div":r()}},r=async()=>{try{const{error:t}=await Pe.auth.signOut();if(t)throw t;e("/")}catch(t){console.error("Error logging out:",t.message)}};return(0,Me.jsxs)("nav",{id:"menu",children:[(0,Me.jsx)("div",{className:"logo",children:(0,Me.jsx)(Ce,{to:"/dashboard",children:(0,Me.jsx)("img",{src:"/DiGiHealthAdv/favicon_io/android-chrome-512x512-Photoroom.png",alt:"Logo",className:"logo"})})}),(0,Me.jsxs)("div",{className:"menu-item",children:[(0,Me.jsx)("div",{className:"menu-text",children:(0,Me.jsx)("a",{href:"#","data-link":!0,children:"Your Journey"})}),(0,Me.jsxs)("div",{className:"sub-menu triple",children:[(0,Me.jsxs)("div",{className:"icon-box",id:"health-overview",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-hospital-user"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Health Overview"}),(0,Me.jsx)("div",{className:"sub-text",children:"See, add and update your Journey"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"medical-history",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-timeline"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Medical History"}),(0,Me.jsx)("div",{className:"sub-text",children:"Through your Journey"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"chronic-disease-management",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-diagnoses"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Chronic Disease Management"}),(0,Me.jsx)("div",{className:"sub-text",children:"Manage your chronic conditions"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"vaccination-history",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-syringe"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Vaccination History"}),(0,Me.jsx)("div",{className:"sub-text",children:"View and manage vaccinations"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"medication-tracker",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-pills"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Medication Tracker"}),(0,Me.jsx)("div",{className:"sub-text",children:"Track prescribed medications"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"health-analytics",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-chart-line"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Health Analytics"}),(0,Me.jsx)("div",{className:"sub-text",children:"View your health trends"})]})]})]})]}),(0,Me.jsxs)("div",{className:"menu-item",children:[(0,Me.jsx)("div",{className:"menu-text",children:(0,Me.jsx)("a",{href:"#","data-link":!0,children:"Appointments"})}),(0,Me.jsxs)("div",{className:"sub-menu double",children:[(0,Me.jsxs)("div",{className:"icon-box",id:"upcoming-appointments",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-calendar-check"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Upcoming Appointments"}),(0,Me.jsx)("div",{className:"sub-text",children:"View and manage appointments"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"appointment-history",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-history"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Appointment History"}),(0,Me.jsx)("div",{className:"sub-text",children:"Check past appointments"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"telehealth-consultations",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-phone-alt"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Telehealth Consultations"}),(0,Me.jsx)("div",{className:"sub-text",children:"Book virtual appointments"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"appointment-reminders",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-clock"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Appointment Reminders"}),(0,Me.jsx)("div",{className:"sub-text",children:"Set and manage reminders"})]})]})]})]}),(0,Me.jsxs)("div",{className:"menu-item",children:[(0,Me.jsx)("div",{className:"menu-text",children:(0,Me.jsx)("a",{href:"#","data-link":!0,children:"Support"})}),(0,Me.jsxs)("div",{className:"sub-menu double",children:[(0,Me.jsxs)("div",{className:"icon-box",id:"help-center",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-book"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Help Center"}),(0,Me.jsx)("div",{className:"sub-text",children:"FAQs and tutorials"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"contact-support",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-life-ring"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Contact Support"}),(0,Me.jsx)("div",{className:"sub-text",children:"Reach out to our team"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"live-chat",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-comment-dots"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Live Chat"}),(0,Me.jsx)("div",{className:"sub-text",children:"Chat with support agents"})]})]})]})]}),(0,Me.jsxs)("div",{className:"menu-item",children:[(0,Me.jsx)("div",{className:"menu-text",children:(0,Me.jsx)("a",{href:"#","data-link":!0,children:"Account"})}),(0,Me.jsxs)("div",{className:"sub-menu double",children:[(0,Me.jsxs)("div",{className:"icon-box",id:"profile-settings",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-user-cog"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Profile Settings"}),(0,Me.jsx)("div",{className:"sub-text",children:"Edit your personal details"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"security-settings",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-lock"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Security Settings"}),(0,Me.jsx)("div",{className:"sub-text",children:"Manage passwords and 2FA"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"data-backup",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-download"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Data Backup & Export"}),(0,Me.jsx)("div",{className:"sub-text",children:"Backup and download your data"})]})]}),s&&(0,Me.jsxs)("div",{className:"icon-box",id:"database-setup",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-database"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Database Setup"}),(0,Me.jsx)("div",{className:"sub-text",children:"Reset and setup database tables"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"logout-div",onClick:a,children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa-solid fa-arrow-right-from-bracket"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Logout"}),(0,Me.jsx)("div",{className:"sub-text",children:"Logout your account"})]})]})]})]}),(0,Me.jsxs)("div",{className:"menu-item",children:[(0,Me.jsx)("div",{className:"menu-text",children:(0,Me.jsx)("a",{href:"#","data-link":!0,children:"AI Tools"})}),(0,Me.jsxs)("div",{className:"sub-menu double",children:[(0,Me.jsxs)("div",{className:"icon-box",id:"ai-image-analysis",onClick:t=>{t.preventDefault(),e("/ai/image-analysis")},children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-microscope"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Medical Image Analysis"}),(0,Me.jsx)("div",{className:"sub-text",children:"AI analysis of medical images"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"ai-health-assistant",onClick:t=>{t.preventDefault(),e("/ai/health-assistant")},children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-robot"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Health Assistant"}),(0,Me.jsx)("div",{className:"sub-text",children:"Chat with our AI assistant"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"ai-recommendations",onClick:t=>{t.preventDefault(),e("/ai/health-recommendations")},children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-lightbulb"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Health Recommendations"}),(0,Me.jsx)("div",{className:"sub-text",children:"Get personalized AI recommendations"})]})]}),(0,Me.jsxs)("div",{className:"icon-box",id:"ai-symptom-checker",onClick:t=>{t.preventDefault(),e("/ai/symptom-checker")},children:[(0,Me.jsx)("div",{className:"icon",children:(0,Me.jsx)("i",{className:"fa fa-stethoscope"})}),(0,Me.jsxs)("div",{className:"text",children:[(0,Me.jsx)("div",{className:"title",children:"Symptom Checker"}),(0,Me.jsx)("div",{className:"sub-text",children:"AI analysis of symptoms"})]})]})]})]})]})},At=()=>(0,Me.jsx)("footer",{style:{position:"relative",backgroundImage:"linear-gradient(0deg, #2AF598 0%, #08AEEA 100%)",width:"100%",textAlign:"center",padding:"1rem",marginTop:"auto",color:"#fff"},children:(0,Me.jsxs)("p",{children:["\xa9 ",(new Date).getFullYear()," DiGiHealth. All rights reserved."]})}),kt=e=>{let{children:t}=e;return(0,Me.jsxs)("div",{className:"dashboard-layout",children:[(0,Me.jsx)(St,{}),(0,Me.jsx)("main",{children:t}),(0,Me.jsx)(At,{})]})},Et=(0,Te.createClient)("https://aqdzmfhakqdwquszaqle.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ"),Ct=()=>{const[e,s]=(0,t.useState)(!1),[n,i]=(0,t.useState)(null),[a,r]=(0,t.useState)(""),[o,l]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[h,u]=(0,t.useState)(""),[p,f]=(0,t.useState)(""),[m,g]=(0,t.useState)(""),[b,v]=(0,t.useState)(""),y=ee(),x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";console.log(`Notification: ${e}, Type: ${t}`),i({message:e,type:t}),setTimeout((()=>i(null)),3e3)};return(0,Me.jsxs)("div",{id:"app",children:[(0,Me.jsx)("header",{children:(0,Me.jsx)("img",{src:"/DiGiHealthAdv/favicon_io/android-chrome-512x512-Photoroom.png",alt:"Logo",className:"logo",style:{width:"250px",height:"100%"}})}),n&&(0,Me.jsx)("div",{className:`alert alert-${n.type} alert-dismissible fade show`,role:"alert",children:n.message}),(0,Me.jsx)("div",{id:"login-signup",children:e?(0,Me.jsx)("div",{id:"signup-form",children:(0,Me.jsxs)("form",{className:"form",onSubmit:async e=>{if(e.preventDefault(),m===b)try{const{data:e,error:t}=await Et.auth.signUp({email:p,password:m,options:{data:{first_name:c,last_name:h}}});if(t)throw t;if(e.user){const{error:t}=await Et.from("detailed_profiles").insert([{id:e.user.id,first_name:c,last_name:h,email:p,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}]);if(t)throw t}x("Account created successfully!","success"),y("/dashboard")}catch(t){console.error("Signup error:",t.message),x(t.message,"danger")}else x("Passwords don't match","error")},children:[(0,Me.jsx)("p",{className:"message",children:"Signup now"}),(0,Me.jsxs)("div",{className:"flex",children:[(0,Me.jsxs)("label",{children:[(0,Me.jsx)("input",{required:!0,name:"firstname",type:"text",className:"input",placeholder:" ",value:c,onChange:e=>d(e.target.value)}),(0,Me.jsx)("span",{children:"Firstname"})]}),(0,Me.jsxs)("label",{children:[(0,Me.jsx)("input",{required:!0,name:"lastname",type:"text",className:"input",placeholder:" ",value:h,onChange:e=>u(e.target.value)}),(0,Me.jsx)("span",{children:"Lastname"})]})]}),(0,Me.jsxs)("label",{children:[(0,Me.jsx)("input",{required:!0,name:"email",type:"email",className:"input",id:"signup-email",placeholder:" ",value:p,onChange:e=>f(e.target.value)}),(0,Me.jsx)("span",{children:"Email"})]}),(0,Me.jsxs)("label",{children:[(0,Me.jsx)("input",{required:!0,name:"password",type:"password",className:"input",id:"signup-password",placeholder:" ",value:m,onChange:e=>g(e.target.value)}),(0,Me.jsx)("span",{children:"Password"})]}),(0,Me.jsxs)("label",{children:[(0,Me.jsx)("input",{required:!0,name:"confirmPassword",type:"password",className:"input",placeholder:" ",value:b,onChange:e=>v(e.target.value)}),(0,Me.jsx)("span",{children:"Confirm password"})]}),(0,Me.jsx)("button",{type:"submit",className:"submit",children:"Submit"}),(0,Me.jsxs)("p",{className:"signin",children:["Already have an account?"," ",(0,Me.jsx)("a",{href:"/",onClick:()=>s(!1),children:"Signin"})]})]})}):(0,Me.jsxs)("div",{id:"login-form",children:[(0,Me.jsx)("h2",{children:"Login"}),(0,Me.jsxs)("form",{className:"form1",onSubmit:async e=>{e.preventDefault();try{const{error:e}=await Et.auth.signInWithPassword({email:a,password:o});if(e)throw e;x("Login successful!","success"),setTimeout((()=>{y("/dashboard")}),3e3)}catch(t){console.error("Login error:",t.message),x(t.message,"danger")}},children:[(0,Me.jsxs)("label",{children:[(0,Me.jsx)("input",{required:!0,name:"email",type:"email",className:"input",id:"login-email",autoComplete:"new-password",value:a,onChange:e=>r(e.target.value)}),(0,Me.jsx)("span",{children:"Email"})]}),(0,Me.jsxs)("label",{children:[(0,Me.jsx)("input",{required:!0,name:"password",type:"password",className:"input",id:"login-password",autoComplete:"login-password",value:o,onChange:e=>l(e.target.value)}),(0,Me.jsx)("span",{children:"Password"})]}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("button",{type:"submit",id:"login-button",children:"Login"}),(0,Me.jsx)("button",{type:"button",onClick:()=>s(!0),children:"Sign Up"})]})]})]})})]})};var jt={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Nt=t.createContext&&t.createContext(jt),Tt=["attr","size","title"];function Pt(e,t){if(null==e)return{};var s,n,i=function(e,t){if(null==e)return{};var s={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;s[n]=e[n]}return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)s=a[n],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}return i}function Mt(){return Mt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},Mt.apply(this,arguments)}function Rt(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function It(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(s),!0).forEach((function(t){Dt(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Rt(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Dt(e,t,s){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Lt(e){return e&&e.map(((e,s)=>t.createElement(e.tag,It({key:s},e.attr),Lt(e.child))))}function Ot(e){return s=>t.createElement(Ft,Mt({attr:It({},e.attr)},s),Lt(e.child))}function Ft(e){var s=s=>{var n,{attr:i,size:a,title:r}=e,o=Pt(e,Tt),l=a||s.size||"1em";return s.className&&(n=s.className),e.className&&(n=(n?n+" ":"")+e.className),t.createElement("svg",Mt({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,i,o,{className:n,style:It(It({color:e.color||s.color},s.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),r&&t.createElement("title",null,r),e.children)};return void 0!==Nt?t.createElement(Nt.Consumer,null,(e=>s(e))):s(jt)}function zt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(e)}function $t(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"},child:[]}]})(e)}function Bt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M208 0c-29.9 0-54.7 20.5-61.8 48.2-.8 0-1.4-.2-2.2-.2-35.3 0-64 28.7-64 64 0 4.8.6 9.5 1.7 14C52.5 138 32 166.6 32 200c0 12.6 3.2 24.3 8.3 34.9C16.3 248.7 0 274.3 0 304c0 33.3 20.4 61.9 49.4 73.9-.9 4.6-1.4 9.3-1.4 14.1 0 39.8 32.2 72 72 72 4.1 0 8.1-.5 12-1.2 9.6 28.5 36.2 49.2 68 49.2 39.8 0 72-32.2 72-72V64c0-35.3-28.7-64-64-64zm368 304c0-29.7-16.3-55.3-40.3-69.1 5.2-10.6 8.3-22.3 8.3-34.9 0-33.4-20.5-62-49.7-74 1-4.5 1.7-9.2 1.7-14 0-35.3-28.7-64-64-64-.8 0-1.5.2-2.2.2C422.7 20.5 397.9 0 368 0c-35.3 0-64 28.6-64 64v376c0 39.8 32.2 72 72 72 31.8 0 58.4-20.7 68-49.2 3.9.7 7.9 1.2 12 1.2 39.8 0 72-32.2 72-72 0-4.8-.5-9.5-1.4-14.1 29-12 49.4-40.6 49.4-73.9z"},child:[]}]})(e)}function Ht(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function Ut(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 160H12c-6.627 0-12-5.373-12-12v-36c0-26.51 21.49-48 48-48h48V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h128V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h48c26.51 0 48 21.49 48 48v36c0 6.627-5.373 12-12 12zM12 192h424c6.627 0 12 5.373 12 12v260c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V204c0-6.627 5.373-12 12-12zm333.296 95.947l-28.169-28.398c-4.667-4.705-12.265-4.736-16.97-.068L194.12 364.665l-45.98-46.352c-4.667-4.705-12.266-4.736-16.971-.068l-28.397 28.17c-4.705 4.667-4.736 12.265-.068 16.97l82.601 83.269c4.667 4.705 12.265 4.736 16.97.068l142.953-141.805c4.705-4.667 4.736-12.265.068-16.97z"},child:[]}]})(e)}function Vt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(e)}function Wt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function qt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(e)}function Gt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"},child:[]}]})(e)}function Xt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(e)}function Yt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"},child:[]}]})(e)}function Kt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"},child:[]}]})(e)}function Jt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M496 256c8.8 0 16-7.2 16-16s-7.2-16-16-16-16 7.2-16 16 7.2 16 16 16zm-176-80c48.5 0 88-39.5 88-88S368.5 0 320 0s-88 39.5-88 88 39.5 88 88 88zM59.8 364c10.2 15.3 29.3 17.8 42.9 9.8 16.2-9.6 56.2-31.7 105.3-48.6V416h224v-90.7c49.1 16.8 89.1 39 105.3 48.6 13.6 8 32.7 5.3 42.9-9.8l17.8-26.7c8.8-13.2 7.6-34.6-10-45.1-11.9-7.1-29.7-17-51.1-27.4-28.1 46.1-99.4 17.8-87.7-35.1C409.3 217.2 365.1 208 320 208c-57 0-112.9 14.5-160 32.2-.2 40.2-47.6 63.3-79.2 36-11.2 6-21.3 11.6-28.7 16-17.6 10.5-18.8 31.8-10 45.1L59.8 364zM368 344c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm-96-96c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm-160 8c8.8 0 16-7.2 16-16s-7.2-16-16-16-16 7.2-16 16 7.2 16 16 16zm512 192H16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h608c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16z"},child:[]}]})(e)}function Qt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function Zt(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function es(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function ts(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function ss(e){return Ot({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function ns(e){return Ot({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"},child:[]}]})(e)}function is(e){return Ot({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 160v48c0 4.4-3.6 8-8 8h-56v56c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-56h-56c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h56v-56c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v56h56c4.4 0 8 3.6 8 8z"},child:[]}]})(e)}function as(e){return Ot({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function rs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M0 80v352c0 26.5 21.5 48 48 48h48V32H48C21.5 32 0 53.5 0 80zm128 400h320V32H128v448zm64-248c0-4.4 3.6-8 8-8h56v-56c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v56h56c4.4 0 8 3.6 8 8v48c0 4.4-3.6 8-8 8h-56v56c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-56h-56c-4.4 0-8-3.6-8-8v-48zM528 32h-48v448h48c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function os(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z"},child:[]}]})(e)}function ls(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M320.2 243.8l-49.7 99.4c-6 12.1-23.4 11.7-28.9-.6l-56.9-126.3-30 71.7H60.6l182.5 186.5c7.1 7.3 18.6 7.3 25.7 0L451.4 288H342.3l-22.1-44.2zM473.7 73.9l-2.4-2.5c-51.5-52.6-135.8-52.6-187.4 0L256 100l-27.9-28.5c-51.5-52.7-135.9-52.7-187.4 0l-2.4 2.4C-10.4 123.7-12.5 203 31 256h102.4l35.9-86.2c5.4-12.9 23.6-13.2 29.4-.4l58.2 129.3 49-97.9c5.9-11.8 22.7-11.8 28.6 0l27.6 55.2H481c43.5-53 41.4-132.3-7.3-182.1z"},child:[]}]})(e)}function cs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(e)}function ds(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function hs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176 160 78.798 238.797.001 335.999 0 433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"},child:[]}]})(e)}function us(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm173.696 119.559l-63.399 63.399c-10.987-18.559-26.67-34.252-45.255-45.255l63.399-63.399a218.396 218.396 0 0 1 45.255 45.255zM256 352c-53.019 0-96-42.981-96-96s42.981-96 96-96 96 42.981 96 96-42.981 96-96 96zM127.559 82.304l63.399 63.399c-18.559 10.987-34.252 26.67-45.255 45.255l-63.399-63.399a218.372 218.372 0 0 1 45.255-45.255zM82.304 384.441l63.399-63.399c10.987 18.559 26.67 34.252 45.255 45.255l-63.399 63.399a218.396 218.396 0 0 1-45.255-45.255zm302.137 45.255l-63.399-63.399c18.559-10.987 34.252-26.67 45.255-45.255l63.399 63.399a218.403 218.403 0 0 1-45.255 45.255z"},child:[]}]})(e)}function ps(e){return Ot({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"},child:[]}]})(e)}function fs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"},child:[]}]})(e)}function ms(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(e)}function gs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M636.11 390.15C614.44 308.85 580.07 231 534.1 159.13 511.98 124.56 498.03 96 454.05 96 415.36 96 384 125.42 384 161.71v60.11l-32.88-21.92a15.996 15.996 0 0 1-7.12-13.31V16c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v170.59c0 5.35-2.67 10.34-7.12 13.31L256 221.82v-60.11C256 125.42 224.64 96 185.95 96c-43.98 0-57.93 28.56-80.05 63.13C59.93 231 25.56 308.85 3.89 390.15 1.3 399.84 0 409.79 0 419.78c0 61.23 62.48 105.44 125.24 88.62l59.5-15.95c42.18-11.3 71.26-47.47 71.26-88.62v-87.49l-85.84 57.23a7.992 7.992 0 0 1-11.09-2.22l-8.88-13.31a7.992 7.992 0 0 1 2.22-11.09L320 235.23l167.59 111.72a7.994 7.994 0 0 1 2.22 11.09l-8.88 13.31a7.994 7.994 0 0 1-11.09 2.22L384 316.34v87.49c0 41.15 29.08 77.31 71.26 88.62l59.5 15.95C577.52 525.22 640 481.01 640 419.78c0-9.99-1.3-19.94-3.89-29.63z"},child:[]}]})(e)}function bs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(e)}function vs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(e)}function ys(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(e)}function xs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function ws(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function _s(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"},child:[]}]})(e)}function Ss(e){return Ot({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M32,224H64V416H32A31.96166,31.96166,0,0,1,0,384V256A31.96166,31.96166,0,0,1,32,224Zm512-48V448a64.06328,64.06328,0,0,1-64,64H160a64.06328,64.06328,0,0,1-64-64V176a79.974,79.974,0,0,1,80-80H288V32a32,32,0,0,1,64,0V96H464A79.974,79.974,0,0,1,544,176ZM264,256a40,40,0,1,0-40,40A39.997,39.997,0,0,0,264,256Zm-8,128H192v32h64Zm96,0H288v32h64ZM456,256a40,40,0,1,0-40,40A39.997,39.997,0,0,0,456,256Zm-8,128H384v32h64ZM640,256V384a31.96166,31.96166,0,0,1-32,32H576V224h32A31.96166,31.96166,0,0,1,640,256Z"},child:[]}]})(e)}function As(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function ks(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z"},child:[]}]})(e)}function Es(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(e)}function Cs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M201.5 174.8l55.7 55.8c3.1 3.1 3.1 8.2 0 11.3l-11.3 11.3c-3.1 3.1-8.2 3.1-11.3 0l-55.7-55.8-45.3 45.3 55.8 55.8c3.1 3.1 3.1 8.2 0 11.3l-11.3 11.3c-3.1 3.1-8.2 3.1-11.3 0L111 265.2l-26.4 26.4c-17.3 17.3-25.6 41.1-23 65.4l7.1 63.6L2.3 487c-3.1 3.1-3.1 8.2 0 11.3l11.3 11.3c3.1 3.1 8.2 3.1 11.3 0l66.3-66.3 63.6 7.1c23.9 2.6 47.9-5.4 65.4-23l181.9-181.9-135.7-135.7-64.9 65zm308.2-93.3L430.5 2.3c-3.1-3.1-8.2-3.1-11.3 0l-11.3 11.3c-3.1 3.1-3.1 8.2 0 11.3l28.3 28.3-45.3 45.3-56.6-56.6-17-17c-3.1-3.1-8.2-3.1-11.3 0l-33.9 33.9c-3.1 3.1-3.1 8.2 0 11.3l17 17L424.8 223l17 17c3.1 3.1 8.2 3.1 11.3 0l33.9-34c3.1-3.1 3.1-8.2 0-11.3l-73.5-73.5 45.3-45.3 28.3 28.3c3.1 3.1 8.2 3.1 11.3 0l11.3-11.3c3.1-3.2 3.1-8.2 0-11.4z"},child:[]}]})(e)}function js(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z"},child:[]}]})(e)}function Ns(e){return Ot({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function Ts(e){return Ot({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M205.22 22.09c-7.94-28.78-49.44-30.12-58.44 0C100.01 179.85 0 222.72 0 333.91 0 432.35 78.72 512 176 512s176-79.65 176-178.09c0-111.75-99.79-153.34-146.78-311.82zM176 448c-61.75 0-112-50.25-112-112 0-8.84 7.16-16 16-16s16 7.16 16 16c0 44.11 35.89 80 80 80 8.84 0 16 7.16 16 16s-7.16 16-16 16z"},child:[]}]})(e)}function Ps(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 64H192C85.961 64 0 149.961 0 256s85.961 192 192 192h192c106.039 0 192-85.961 192-192S490.039 64 384 64zM64 256c0-70.741 57.249-128 128-128 70.741 0 128 57.249 128 128 0 70.741-57.249 128-128 128-70.741 0-128-57.249-128-128zm320 128h-48.905c65.217-72.858 65.236-183.12 0-256H384c70.741 0 128 57.249 128 128 0 70.74-57.249 128-128 128z"},child:[]}]})(e)}function Ms(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 64H192C86 64 0 150 0 256s86 192 192 192h192c106 0 192-86 192-192S490 64 384 64zm0 320c-70.8 0-128-57.3-128-128 0-70.8 57.3-128 128-128 70.8 0 128 57.3 128 128 0 70.8-57.3 128-128 128z"},child:[]}]})(e)}function Rs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function Is(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function Ds(e){return Ot({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256A128 128 0 1 0 96 128a128 128 0 0 0 128 128zm96 64a63.08 63.08 0 0 1 8.1-30.5c-4.8-.5-9.5-1.5-14.5-1.5h-16.7a174.08 174.08 0 0 1-145.8 0h-16.7A134.43 134.43 0 0 0 0 422.4V464a48 48 0 0 0 48 48h280.9a63.54 63.54 0 0 1-8.9-32zm288-32h-32v-80a80 80 0 0 0-160 0v80h-32a32 32 0 0 0-32 32v160a32 32 0 0 0 32 32h224a32 32 0 0 0 32-32V320a32 32 0 0 0-32-32zM496 432a32 32 0 1 1 32-32 32 32 0 0 1-32 32zm32-144h-64v-80a32 32 0 0 1 64 0z"},child:[]}]})(e)}function Ls(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Os(e){return Ot({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function Fs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 416 512"},child:[{tag:"path",attr:{d:"M207.9 15.2c.8 4.7 16.1 94.5 16.1 128.8 0 52.3-27.8 89.6-68.9 104.6L168 486.7c.7 13.7-10.2 25.3-24 25.3H80c-13.7 0-24.7-11.5-24-25.3l12.9-238.1C27.7 233.6 0 196.2 0 144 0 109.6 15.3 19.9 16.1 15.2 19.3-5.1 61.4-5.4 64 16.3v141.2c1.3 3.4 15.1 3.2 16 0 1.4-25.3 7.9-139.2 8-141.8 3.3-20.8 44.7-20.8 47.9 0 .2 2.7 6.6 116.5 8 141.8.9 3.2 14.8 3.4 16 0V16.3c2.6-21.6 44.8-21.4 48-1.1zm119.2 285.7l-15 185.1c-1.2 14 9.9 26 23.9 26h56c13.3 0 24-10.7 24-24V24c0-13.2-10.7-24-24-24-82.5 0-221.4 178.5-64.9 300.9z"},child:[]}]})(e)}function zs(e){return Ot({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z"},child:[]}]})(e)}function $s(e){return Ot({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M448 64h-25.98C438.44 92.28 448 125.01 448 160c0 105.87-86.13 192-192 192S64 265.87 64 160c0-34.99 9.56-67.72 25.98-96H64C28.71 64 0 92.71 0 128v320c0 35.29 28.71 64 64 64h384c35.29 0 64-28.71 64-64V128c0-35.29-28.71-64-64-64zM256 320c88.37 0 160-71.63 160-160S344.37 0 256 0 96 71.63 96 160s71.63 160 160 160zm-.3-151.94l33.58-78.36c3.5-8.17 12.94-11.92 21.03-8.41 8.12 3.48 11.88 12.89 8.41 21l-33.67 78.55C291.73 188 296 197.45 296 208c0 22.09-17.91 40-40 40s-40-17.91-40-40c0-21.98 17.76-39.77 39.7-39.94z"},child:[]}]})(e)}const Bs=()=>{const e=ee(),[s,n]=(0,t.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",role:"patient"}),[i,a]=(0,t.useState)(null),[r,o]=(0,t.useState)(!1),l=e=>{n({...s,[e.target.name]:e.target.value})};return(0,Me.jsx)("div",{className:"container mt-5",children:(0,Me.jsx)("div",{className:"row justify-content-center",children:(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsx)("div",{className:"card shadow",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h2",{className:"text-center mb-4",children:"Register"}),i&&(0,Me.jsx)("div",{className:"alert alert-danger",role:"alert",children:i}),(0,Me.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),a(null),o(!0),s.password!==s.confirmPassword)return a("Passwords do not match"),void o(!1);try{const{data:t,error:n}=await Pe.auth.signUp({email:s.email,password:s.password,options:{data:{first_name:s.firstName,last_name:s.lastName,role:s.role}}});if(n)throw n;if(t.user){const{error:e}=await Pe.from("detailed_profiles").insert([{id:t.user.id,first_name:s.firstName,last_name:s.lastName,email:s.email,created_at:(new Date).toISOString()}]);if(e)throw e;const{error:n}=await Pe.from("profiles").insert([{id:t.user.id,full_name:`${s.firstName} ${s.lastName}`,email:s.email,role:s.role,created_at:(new Date).toISOString()}]);if(n)throw n}e("/dashboard")}catch(i){a(i.message)}finally{o(!1)}},children:[(0,Me.jsxs)("div",{className:"row mb-3",children:[(0,Me.jsxs)("div",{className:"col-md-6",children:[(0,Me.jsx)("label",{className:"form-label",children:"First Name"}),(0,Me.jsxs)("div",{className:"input-group",children:[(0,Me.jsx)("span",{className:"input-group-text",children:(0,Me.jsx)(Os,{})}),(0,Me.jsx)("input",{type:"text",className:"form-control",name:"firstName",value:s.firstName,onChange:l,required:!0})]})]}),(0,Me.jsxs)("div",{className:"col-md-6",children:[(0,Me.jsx)("label",{className:"form-label",children:"Last Name"}),(0,Me.jsxs)("div",{className:"input-group",children:[(0,Me.jsx)("span",{className:"input-group-text",children:(0,Me.jsx)(Os,{})}),(0,Me.jsx)("input",{type:"text",className:"form-control",name:"lastName",value:s.lastName,onChange:l,required:!0})]})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{className:"form-label",children:"Email"}),(0,Me.jsxs)("div",{className:"input-group",children:[(0,Me.jsx)("span",{className:"input-group-text",children:(0,Me.jsx)(es,{})}),(0,Me.jsx)("input",{type:"email",className:"form-control",name:"email",value:s.email,onChange:l,required:!0})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{className:"form-label",children:"Password"}),(0,Me.jsxs)("div",{className:"input-group",children:[(0,Me.jsx)("span",{className:"input-group-text",children:(0,Me.jsx)(ms,{})}),(0,Me.jsx)("input",{type:"password",className:"form-control",name:"password",value:s.password,onChange:l,required:!0})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{className:"form-label",children:"Confirm Password"}),(0,Me.jsxs)("div",{className:"input-group",children:[(0,Me.jsx)("span",{className:"input-group-text",children:(0,Me.jsx)(ms,{})}),(0,Me.jsx)("input",{type:"password",className:"form-control",name:"confirmPassword",value:s.confirmPassword,onChange:l,required:!0})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{className:"form-label",children:"Role"}),(0,Me.jsxs)("div",{className:"input-group",children:[(0,Me.jsx)("span",{className:"input-group-text",children:(0,Me.jsx)(Ls,{})}),(0,Me.jsxs)("select",{className:"form-select",name:"role",value:s.role,onChange:l,children:[(0,Me.jsx)("option",{value:"patient",children:"Patient"}),(0,Me.jsx)("option",{value:"doctor",children:"Doctor"}),(0,Me.jsx)("option",{value:"admin",children:"Admin"})]})]})]}),(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary w-100",disabled:r,children:r?"Registering...":"Register"})]}),(0,Me.jsxs)("div",{className:"text-center mt-3",children:["Already have an account?"," ",(0,Me.jsx)("a",{href:"/",className:"text-decoration-none",children:"Login"})]})]})})})})})},Hs=()=>(0,Me.jsx)("div",{className:"spinner-overlay",children:(0,Me.jsx)("div",{className:"loader"})});function Us(e){return e+.5|0}const Vs=(e,t,s)=>Math.max(Math.min(e,s),t);function Ws(e){return Vs(Us(2.55*e),0,255)}function qs(e){return Vs(Us(255*e),0,255)}function Gs(e){return Vs(Us(e/2.55)/100,0,1)}function Xs(e){return Vs(Us(100*e),0,100)}const Ys={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Ks=[..."0123456789ABCDEF"],Js=e=>Ks[15&e],Qs=e=>Ks[(240&e)>>4]+Ks[15&e],Zs=e=>(240&e)>>4===(15&e);function en(e){var t=(e=>Zs(e.r)&&Zs(e.g)&&Zs(e.b)&&Zs(e.a))(e)?Js:Qs;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const tn=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function sn(e,t,s){const n=t*Math.min(s,1-s),i=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return s-n*Math.max(Math.min(i-3,9-i,1),-1)};return[i(0),i(8),i(4)]}function nn(e,t,s){const n=function(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(n+e/60)%6;return s-s*t*Math.max(Math.min(i,4-i,1),0)};return[n(5),n(3),n(1)]}function an(e,t,s){const n=sn(e,1,.5);let i;for(t+s>1&&(i=1/(t+s),t*=i,s*=i),i=0;i<3;i++)n[i]*=1-t-s,n[i]+=t;return n}function rn(e){const t=e.r/255,s=e.g/255,n=e.b/255,i=Math.max(t,s,n),a=Math.min(t,s,n),r=(i+a)/2;let o,l,c;return i!==a&&(c=i-a,l=r>.5?c/(2-i-a):c/(i+a),o=function(e,t,s,n,i){return e===i?(t-s)/n+(t<s?6:0):t===i?(s-e)/n+2:(e-t)/n+4}(t,s,n,c,i),o=60*o+.5),[0|o,l||0,r]}function on(e,t,s,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,s,n)).map(qs)}function ln(e,t,s){return on(sn,e,t,s)}function cn(e){return(e%360+360)%360}function dn(e){const t=tn.exec(e);let s,n=255;if(!t)return;t[5]!==s&&(n=t[6]?Ws(+t[5]):qs(+t[5]));const i=cn(+t[2]),a=+t[3]/100,r=+t[4]/100;return s="hwb"===t[1]?function(e,t,s){return on(an,e,t,s)}(i,a,r):"hsv"===t[1]?function(e,t,s){return on(nn,e,t,s)}(i,a,r):ln(i,a,r),{r:s[0],g:s[1],b:s[2],a:n}}const hn={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},un={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let pn;function fn(e){pn||(pn=function(){const e={},t=Object.keys(un),s=Object.keys(hn);let n,i,a,r,o;for(n=0;n<t.length;n++){for(r=o=t[n],i=0;i<s.length;i++)a=s[i],o=o.replace(a,hn[a]);a=parseInt(un[r],16),e[o]=[a>>16&255,a>>8&255,255&a]}return e}(),pn.transparent=[0,0,0,0]);const t=pn[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const mn=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const gn=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,bn=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function vn(e,t,s){if(e){let n=rn(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*s,0===t?360:1)),n=ln(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function yn(e,t){return e?Object.assign(t||{},e):e}function xn(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=qs(e[3]))):(t=yn(e,{r:0,g:0,b:0,a:1})).a=qs(t.a),t}function wn(e){return"r"===e.charAt(0)?function(e){const t=mn.exec(e);let s,n,i,a=255;if(t){if(t[7]!==s){const e=+t[7];a=t[8]?Ws(e):Vs(255*e,0,255)}return s=+t[1],n=+t[3],i=+t[5],s=255&(t[2]?Ws(s):Vs(s,0,255)),n=255&(t[4]?Ws(n):Vs(n,0,255)),i=255&(t[6]?Ws(i):Vs(i,0,255)),{r:s,g:n,b:i,a:a}}}(e):dn(e)}class _n{constructor(e){if(e instanceof _n)return e;const t=typeof e;let s;"object"===t?s=xn(e):"string"===t&&(s=function(e){var t,s=e.length;return"#"===e[0]&&(4===s||5===s?t={r:255&17*Ys[e[1]],g:255&17*Ys[e[2]],b:255&17*Ys[e[3]],a:5===s?17*Ys[e[4]]:255}:7!==s&&9!==s||(t={r:Ys[e[1]]<<4|Ys[e[2]],g:Ys[e[3]]<<4|Ys[e[4]],b:Ys[e[5]]<<4|Ys[e[6]],a:9===s?Ys[e[7]]<<4|Ys[e[8]]:255})),t}(e)||fn(e)||wn(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=yn(this._rgb);return e&&(e.a=Gs(e.a)),e}set rgb(e){this._rgb=xn(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Gs(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid?en(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=rn(e),s=t[0],n=Xs(t[1]),i=Xs(t[2]);return e.a<255?`hsla(${s}, ${n}%, ${i}%, ${Gs(e.a)})`:`hsl(${s}, ${n}%, ${i}%)`}(this._rgb):void 0}mix(e,t){if(e){const s=this.rgb,n=e.rgb;let i;const a=t===i?.5:t,r=2*a-1,o=s.a-n.a,l=((r*o===-1?r:(r+o)/(1+r*o))+1)/2;i=1-l,s.r=255&l*s.r+i*n.r+.5,s.g=255&l*s.g+i*n.g+.5,s.b=255&l*s.b+i*n.b+.5,s.a=a*s.a+(1-a)*n.a,this.rgb=s}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,s){const n=bn(Gs(e.r)),i=bn(Gs(e.g)),a=bn(Gs(e.b));return{r:qs(gn(n+s*(bn(Gs(t.r))-n))),g:qs(gn(i+s*(bn(Gs(t.g))-i))),b:qs(gn(a+s*(bn(Gs(t.b))-a))),a:e.a+s*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new _n(this.rgb)}alpha(e){return this._rgb.a=qs(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=Us(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return vn(this._rgb,2,e),this}darken(e){return vn(this._rgb,2,-e),this}saturate(e){return vn(this._rgb,1,e),this}desaturate(e){return vn(this._rgb,1,-e),this}rotate(e){return function(e,t){var s=rn(e);s[0]=cn(s[0]+t),s=ln(s),e.r=s[0],e.g=s[1],e.b=s[2]}(this._rgb,e),this}}function Sn(){}const An=(()=>{let e=0;return()=>e++})();function kn(e){return null===e||void 0===e}function En(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function Cn(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function jn(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function Nn(e,t){return jn(e)?e:t}function Tn(e,t){return"undefined"===typeof e?t:e}const Pn=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Mn(e,t,s){if(e&&"function"===typeof e.call)return e.apply(s,t)}function Rn(e,t,s,n){let i,a,r;if(En(e))if(a=e.length,n)for(i=a-1;i>=0;i--)t.call(s,e[i],i);else for(i=0;i<a;i++)t.call(s,e[i],i);else if(Cn(e))for(r=Object.keys(e),a=r.length,i=0;i<a;i++)t.call(s,e[r[i]],r[i])}function In(e,t){let s,n,i,a;if(!e||!t||e.length!==t.length)return!1;for(s=0,n=e.length;s<n;++s)if(i=e[s],a=t[s],i.datasetIndex!==a.datasetIndex||i.index!==a.index)return!1;return!0}function Dn(e){if(En(e))return e.map(Dn);if(Cn(e)){const t=Object.create(null),s=Object.keys(e),n=s.length;let i=0;for(;i<n;++i)t[s[i]]=Dn(e[s[i]]);return t}return e}function Ln(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function On(e,t,s,n){if(!Ln(e))return;const i=t[e],a=s[e];Cn(i)&&Cn(a)?Fn(i,a,n):t[e]=Dn(a)}function Fn(e,t,s){const n=En(t)?t:[t],i=n.length;if(!Cn(e))return e;const a=(s=s||{}).merger||On;let r;for(let o=0;o<i;++o){if(r=n[o],!Cn(r))continue;const t=Object.keys(r);for(let n=0,i=t.length;n<i;++n)a(t[n],e,r,s)}return e}function zn(e,t){return Fn(e,t,{merger:$n})}function $n(e,t,s){if(!Ln(e))return;const n=t[e],i=s[e];Cn(n)&&Cn(i)?zn(n,i):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Dn(i))}const Bn={"":e=>e,x:e=>e.x,y:e=>e.y};function Hn(e,t){const s=Bn[t]||(Bn[t]=function(e){const t=function(e){const t=e.split("."),s=[];let n="";for(const i of t)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(s.push(n),n="");return s}(e);return e=>{for(const s of t){if(""===s)break;e=e&&e[s]}return e}}(t));return s(e)}function Un(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Vn=e=>"undefined"!==typeof e,Wn=e=>"function"===typeof e,qn=(e,t)=>{if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0};const Gn=Math.PI,Xn=2*Gn,Yn=Xn+Gn,Kn=Number.POSITIVE_INFINITY,Jn=Gn/180,Qn=Gn/2,Zn=Gn/4,ei=2*Gn/3,ti=Math.log10,si=Math.sign;function ni(e,t,s){return Math.abs(e-t)<s}function ii(e){const t=Math.round(e);e=ni(e,t,e/1e3)?t:e;const s=Math.pow(10,Math.floor(ti(e))),n=e/s;return(n<=1?1:n<=2?2:n<=5?5:10)*s}function ai(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function ri(e,t,s){let n,i,a;for(n=0,i=e.length;n<i;n++)a=e[n][s],isNaN(a)||(t.min=Math.min(t.min,a),t.max=Math.max(t.max,a))}function oi(e){return e*(Gn/180)}function li(e){return e*(180/Gn)}function ci(e){if(!jn(e))return;let t=1,s=0;for(;Math.round(e*t)/t!==e;)t*=10,s++;return s}function di(e,t){const s=t.x-e.x,n=t.y-e.y,i=Math.sqrt(s*s+n*n);let a=Math.atan2(n,s);return a<-.5*Gn&&(a+=Xn),{angle:a,distance:i}}function hi(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function ui(e,t){return(e-t+Yn)%Xn-Gn}function pi(e){return(e%Xn+Xn)%Xn}function fi(e,t,s,n){const i=pi(e),a=pi(t),r=pi(s),o=pi(a-i),l=pi(r-i),c=pi(i-a),d=pi(i-r);return i===a||i===r||n&&a===r||o>l&&c<d}function mi(e,t,s){return Math.max(t,Math.min(s,e))}function gi(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,s)-n&&e<=Math.max(t,s)+n}function bi(e,t,s){s=s||(s=>e[s]<t);let n,i=e.length-1,a=0;for(;i-a>1;)n=a+i>>1,s(n)?a=n:i=n;return{lo:a,hi:i}}const vi=(e,t,s,n)=>bi(e,s,n?n=>{const i=e[n][t];return i<s||i===s&&e[n+1][t]===s}:n=>e[n][t]<s),yi=(e,t,s)=>bi(e,s,(n=>e[n][t]>=s));const xi=["push","pop","shift","splice","unshift"];function wi(e,t){const s=e._chartjs;if(!s)return;const n=s.listeners,i=n.indexOf(t);-1!==i&&n.splice(i,1),n.length>0||(xi.forEach((t=>{delete e[t]})),delete e._chartjs)}function _i(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const Si="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function Ai(e,t){let s=[],n=!1;return function(){for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];s=a,n||(n=!0,Si.call(window,(()=>{n=!1,e.apply(t,s)})))}}const ki=e=>"start"===e?"left":"end"===e?"right":"center",Ei=(e,t,s)=>"start"===e?t:"end"===e?s:(t+s)/2;function Ci(e,t,s){const n=t.length;let i=0,a=n;if(e._sorted){const{iScale:r,vScale:o,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=r.axis,{min:h,max:u,minDefined:p,maxDefined:f}=r.getUserBounds();if(p){if(i=Math.min(vi(l,d,h).lo,s?n:vi(t,d,r.getPixelForValue(h)).lo),c){const e=l.slice(0,i+1).reverse().findIndex((e=>!kn(e[o.axis])));i-=Math.max(0,e)}i=mi(i,0,n-1)}if(f){let e=Math.max(vi(l,r.axis,u,!0).hi+1,s?0:vi(t,d,r.getPixelForValue(u),!0).hi+1);if(c){const t=l.slice(e-1).findIndex((e=>!kn(e[o.axis])));e+=Math.max(0,t)}a=mi(e,i,n)-i}else a=n-i}return{start:i,count:a}}function ji(e){const{xScale:t,yScale:s,_scaleRanges:n}=e,i={xmin:t.min,xmax:t.max,ymin:s.min,ymax:s.max};if(!n)return e._scaleRanges=i,!0;const a=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==s.min||n.ymax!==s.max;return Object.assign(n,i),a}const Ni=e=>0===e||1===e,Ti=(e,t,s)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*Xn/s),Pi=(e,t,s)=>Math.pow(2,-10*e)*Math.sin((e-t)*Xn/s)+1,Mi={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Qn),easeOutSine:e=>Math.sin(e*Qn),easeInOutSine:e=>-.5*(Math.cos(Gn*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>Ni(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Ni(e)?e:Ti(e,.075,.3),easeOutElastic:e=>Ni(e)?e:Pi(e,.075,.3),easeInOutElastic(e){const t=.1125;return Ni(e)?e:e<.5?.5*Ti(2*e,t,.45):.5+.5*Pi(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-Mi.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,s=2.75;return e<1/s?t*e*e:e<2/s?t*(e-=1.5/s)*e+.75:e<2.5/s?t*(e-=2.25/s)*e+.9375:t*(e-=2.625/s)*e+.984375},easeInOutBounce:e=>e<.5?.5*Mi.easeInBounce(2*e):.5*Mi.easeOutBounce(2*e-1)+.5};function Ri(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function Ii(e){return Ri(e)?e:new _n(e)}function Di(e){return Ri(e)?e:new _n(e).saturate(.5).darken(.1).hexString()}const Li=["x","y","borderWidth","radius","tension"],Oi=["color","borderColor","backgroundColor"];const Fi=new Map;function zi(e,t,s){return function(e,t){t=t||{};const s=e+JSON.stringify(t);let n=Fi.get(s);return n||(n=new Intl.NumberFormat(e,t),Fi.set(s,n)),n}(t,s).format(e)}const $i={values:e=>En(e)?e:""+e,numeric(e,t,s){if(0===e)return"0";const n=this.chart.options.locale;let i,a=e;if(s.length>1){const t=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(t<1e-4||t>1e15)&&(i="scientific"),a=function(e,t){let s=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(s)>=1&&e!==Math.floor(e)&&(s=e-Math.floor(e));return s}(e,s)}const r=ti(Math.abs(a)),o=isNaN(r)?1:Math.max(Math.min(-1*Math.floor(r),20),0),l={notation:i,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),zi(e,n,l)},logarithmic(e,t,s){if(0===e)return"0";const n=s[t].significand||e/Math.pow(10,Math.floor(ti(e)));return[1,2,3,5,10,15].includes(n)||t>.8*s.length?$i.numeric.call(this,e,t,s):""}};var Bi={formatters:$i};const Hi=Object.create(null),Ui=Object.create(null);function Vi(e,t){if(!t)return e;const s=t.split(".");for(let n=0,i=s.length;n<i;++n){const t=s[n];e=e[t]||(e[t]=Object.create(null))}return e}function Wi(e,t,s){return"string"===typeof t?Fn(Vi(e,t),s):Fn(Vi(e,""),t)}class qi{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>Di(t.backgroundColor),this.hoverBorderColor=(e,t)=>Di(t.borderColor),this.hoverColor=(e,t)=>Di(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Wi(this,e,t)}get(e){return Vi(this,e)}describe(e,t){return Wi(Ui,e,t)}override(e,t){return Wi(Hi,e,t)}route(e,t,s,n){const i=Vi(this,e),a=Vi(this,s),r="_"+t;Object.defineProperties(i,{[r]:{value:i[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[r],t=a[n];return Cn(e)?Object.assign({},t,e):Tn(e,t)},set(e){this[r]=e}}})}apply(e){e.forEach((e=>e(this)))}}var Gi=new qi({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:Oi},numbers:{type:"number",properties:Li}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Bi.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function Xi(e,t,s,n,i){let a=t[i];return a||(a=t[i]=e.measureText(i).width,s.push(i)),a>n&&(n=a),n}function Yi(e,t,s,n){let i=(n=n||{}).data=n.data||{},a=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(i=n.data={},a=n.garbageCollect=[],n.font=t),e.save(),e.font=t;let r=0;const o=s.length;let l,c,d,h,u;for(l=0;l<o;l++)if(h=s[l],void 0===h||null===h||En(h)){if(En(h))for(c=0,d=h.length;c<d;c++)u=h[c],void 0===u||null===u||En(u)||(r=Xi(e,i,a,r,u))}else r=Xi(e,i,a,r,h);e.restore();const p=a.length/2;if(p>s.length){for(l=0;l<p;l++)delete i[a[l]];a.splice(0,p)}return r}function Ki(e,t,s){const n=e.currentDevicePixelRatio,i=0!==s?Math.max(s/2,.5):0;return Math.round((t-i)*n)/n+i}function Ji(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Qi(e,t,s,n){Zi(e,t,s,n,null)}function Zi(e,t,s,n,i){let a,r,o,l,c,d,h,u;const p=t.pointStyle,f=t.rotation,m=t.radius;let g=(f||0)*Jn;if(p&&"object"===typeof p&&(a=p.toString(),"[object HTMLImageElement]"===a||"[object HTMLCanvasElement]"===a))return e.save(),e.translate(s,n),e.rotate(g),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void e.restore();if(!(isNaN(m)||m<=0)){switch(e.beginPath(),p){default:i?e.ellipse(s,n,i/2,m,0,0,Xn):e.arc(s,n,m,0,Xn),e.closePath();break;case"triangle":d=i?i/2:m,e.moveTo(s+Math.sin(g)*d,n-Math.cos(g)*m),g+=ei,e.lineTo(s+Math.sin(g)*d,n-Math.cos(g)*m),g+=ei,e.lineTo(s+Math.sin(g)*d,n-Math.cos(g)*m),e.closePath();break;case"rectRounded":c=.516*m,l=m-c,r=Math.cos(g+Zn)*l,h=Math.cos(g+Zn)*(i?i/2-c:l),o=Math.sin(g+Zn)*l,u=Math.sin(g+Zn)*(i?i/2-c:l),e.arc(s-h,n-o,c,g-Gn,g-Qn),e.arc(s+u,n-r,c,g-Qn,g),e.arc(s+h,n+o,c,g,g+Qn),e.arc(s-u,n+r,c,g+Qn,g+Gn),e.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,d=i?i/2:l,e.rect(s-d,n-l,2*d,2*l);break}g+=Zn;case"rectRot":h=Math.cos(g)*(i?i/2:m),r=Math.cos(g)*m,o=Math.sin(g)*m,u=Math.sin(g)*(i?i/2:m),e.moveTo(s-h,n-o),e.lineTo(s+u,n-r),e.lineTo(s+h,n+o),e.lineTo(s-u,n+r),e.closePath();break;case"crossRot":g+=Zn;case"cross":h=Math.cos(g)*(i?i/2:m),r=Math.cos(g)*m,o=Math.sin(g)*m,u=Math.sin(g)*(i?i/2:m),e.moveTo(s-h,n-o),e.lineTo(s+h,n+o),e.moveTo(s+u,n-r),e.lineTo(s-u,n+r);break;case"star":h=Math.cos(g)*(i?i/2:m),r=Math.cos(g)*m,o=Math.sin(g)*m,u=Math.sin(g)*(i?i/2:m),e.moveTo(s-h,n-o),e.lineTo(s+h,n+o),e.moveTo(s+u,n-r),e.lineTo(s-u,n+r),g+=Zn,h=Math.cos(g)*(i?i/2:m),r=Math.cos(g)*m,o=Math.sin(g)*m,u=Math.sin(g)*(i?i/2:m),e.moveTo(s-h,n-o),e.lineTo(s+h,n+o),e.moveTo(s+u,n-r),e.lineTo(s-u,n+r);break;case"line":r=i?i/2:Math.cos(g)*m,o=Math.sin(g)*m,e.moveTo(s-r,n-o),e.lineTo(s+r,n+o);break;case"dash":e.moveTo(s,n),e.lineTo(s+Math.cos(g)*(i?i/2:m),n+Math.sin(g)*m);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function ea(e,t,s){return s=s||.5,!t||e&&e.x>t.left-s&&e.x<t.right+s&&e.y>t.top-s&&e.y<t.bottom+s}function ta(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function sa(e){e.restore()}function na(e,t,s,n,i){if(!t)return e.lineTo(s.x,s.y);if("middle"===i){const n=(t.x+s.x)/2;e.lineTo(n,t.y),e.lineTo(n,s.y)}else"after"===i!==!!n?e.lineTo(t.x,s.y):e.lineTo(s.x,t.y);e.lineTo(s.x,s.y)}function ia(e,t,s,n){if(!t)return e.lineTo(s.x,s.y);e.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?s.cp2x:s.cp1x,n?s.cp2y:s.cp1y,s.x,s.y)}function aa(e,t,s,n,i){if(i.strikethrough||i.underline){const a=e.measureText(n),r=t-a.actualBoundingBoxLeft,o=t+a.actualBoundingBoxRight,l=s-a.actualBoundingBoxAscent,c=s+a.actualBoundingBoxDescent,d=i.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=i.decorationWidth||2,e.moveTo(r,d),e.lineTo(o,d),e.stroke()}}function ra(e,t){const s=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=s}function oa(e,t,s,n,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const r=En(t)?t:[t],o=a.strokeWidth>0&&""!==a.strokeColor;let l,c;for(e.save(),e.font=i.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),kn(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,a),l=0;l<r.length;++l)c=r[l],a.backdrop&&ra(e,a.backdrop),o&&(a.strokeColor&&(e.strokeStyle=a.strokeColor),kn(a.strokeWidth)||(e.lineWidth=a.strokeWidth),e.strokeText(c,s,n,a.maxWidth)),e.fillText(c,s,n,a.maxWidth),aa(e,s,n,c,a),n+=Number(i.lineHeight);e.restore()}function la(e,t){const{x:s,y:n,w:i,h:a,radius:r}=t;e.arc(s+r.topLeft,n+r.topLeft,r.topLeft,1.5*Gn,Gn,!0),e.lineTo(s,n+a-r.bottomLeft),e.arc(s+r.bottomLeft,n+a-r.bottomLeft,r.bottomLeft,Gn,Qn,!0),e.lineTo(s+i-r.bottomRight,n+a),e.arc(s+i-r.bottomRight,n+a-r.bottomRight,r.bottomRight,Qn,0,!0),e.lineTo(s+i,n+r.topRight),e.arc(s+i-r.topRight,n+r.topRight,r.topRight,0,-Qn,!0),e.lineTo(s+r.topLeft,n)}const ca=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,da=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function ha(e,t){const s=(""+e).match(ca);if(!s||"normal"===s[1])return 1.2*t;switch(e=+s[2],s[3]){case"px":return e;case"%":e/=100}return t*e}function ua(e,t){const s={},n=Cn(t),i=n?Object.keys(t):t,a=Cn(e)?n?s=>Tn(e[s],e[t[s]]):t=>e[t]:()=>e;for(const r of i)s[r]=+a(r)||0;return s}function pa(e){return ua(e,{top:"y",right:"x",bottom:"y",left:"x"})}function fa(e){return ua(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ma(e){const t=pa(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function ga(e,t){e=e||{},t=t||Gi.font;let s=Tn(e.size,t.size);"string"===typeof s&&(s=parseInt(s,10));let n=Tn(e.style,t.style);n&&!(""+n).match(da)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:Tn(e.family,t.family),lineHeight:ha(Tn(e.lineHeight,t.lineHeight),s),size:s,style:n,weight:Tn(e.weight,t.weight),string:""};return i.string=function(e){return!e||kn(e.size)||kn(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(i),i}function ba(e,t,s,n){let i,a,r,o=!0;for(i=0,a=e.length;i<a;++i)if(r=e[i],void 0!==r&&(void 0!==t&&"function"===typeof r&&(r=r(t),o=!1),void 0!==s&&En(r)&&(r=r[s%r.length],o=!1),void 0!==r))return n&&!o&&(n.cacheable=!1),r}function va(e,t){return Object.assign(Object.create(e),t)}function ya(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],s=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const i=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof s&&(s=Ta("_fallback",e));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:i,_fallback:s,_getTarget:n,override:n=>ya([n,...e],t,i,s)};return new Proxy(a,{deleteProperty:(t,s)=>(delete t[s],delete t._keys,delete e[0][s],!0),get:(s,n)=>Aa(s,n,(()=>function(e,t,s,n){let i;for(const a of t)if(i=Ta(_a(a,e),s),"undefined"!==typeof i)return Sa(e,i)?ja(s,n,e,i):i}(n,t,e,s))),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>Pa(e).includes(t),ownKeys:e=>Pa(e),set(e,t,s){const i=e._storage||(e._storage=n());return e[t]=i[t]=s,delete e._keys,!0}})}function xa(e,t,s,n){const i={_cacheable:!1,_proxy:e,_context:t,_subProxy:s,_stack:new Set,_descriptors:wa(e,n),setContext:t=>xa(e,t,s,n),override:i=>xa(e.override(i),t,s,n)};return new Proxy(i,{deleteProperty:(t,s)=>(delete t[s],delete e[s],!0),get:(e,t,s)=>Aa(e,t,(()=>function(e,t,s){const{_proxy:n,_context:i,_subProxy:a,_descriptors:r}=e;let o=n[t];Wn(o)&&r.isScriptable(t)&&(o=function(e,t,s,n){const{_proxy:i,_context:a,_subProxy:r,_stack:o}=s;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(a,r||n);o.delete(e),Sa(e,l)&&(l=ja(i._scopes,i,e,l));return l}(t,o,e,s));En(o)&&o.length&&(o=function(e,t,s,n){const{_proxy:i,_context:a,_subProxy:r,_descriptors:o}=s;if("undefined"!==typeof a.index&&n(e))return t[a.index%t.length];if(Cn(t[0])){const s=t,n=i._scopes.filter((e=>e!==s));t=[];for(const l of s){const s=ja(n,i,e,l);t.push(xa(s,a,r&&r[e],o))}}return t}(t,o,e,r.isIndexable));Sa(t,o)&&(o=xa(o,i,a&&a[t],r));return o}(e,t,s))),getOwnPropertyDescriptor:(t,s)=>t._descriptors.allKeys?Reflect.has(e,s)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,s),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,s)=>Reflect.has(e,s),ownKeys:()=>Reflect.ownKeys(e),set:(t,s,n)=>(e[s]=n,delete t[s],!0)})}function wa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:s=t.scriptable,_indexable:n=t.indexable,_allKeys:i=t.allKeys}=e;return{allKeys:i,scriptable:s,indexable:n,isScriptable:Wn(s)?s:()=>s,isIndexable:Wn(n)?n:()=>n}}const _a=(e,t)=>e?e+Un(t):t,Sa=(e,t)=>Cn(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function Aa(e,t,s){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const n=s();return e[t]=n,n}function ka(e,t,s){return Wn(e)?e(t,s):e}const Ea=(e,t)=>!0===e?t:"string"===typeof e?Hn(t,e):void 0;function Ca(e,t,s,n,i){for(const a of t){const t=Ea(s,a);if(t){e.add(t);const a=ka(t._fallback,s,i);if("undefined"!==typeof a&&a!==s&&a!==n)return a}else if(!1===t&&"undefined"!==typeof n&&s!==n)return null}return!1}function ja(e,t,s,n){const i=t._rootScopes,a=ka(t._fallback,s,n),r=[...e,...i],o=new Set;o.add(n);let l=Na(o,r,s,a||s,n);return null!==l&&(("undefined"===typeof a||a===s||(l=Na(o,r,a,l,n),null!==l))&&ya(Array.from(o),[""],i,a,(()=>function(e,t,s){const n=e._getTarget();t in n||(n[t]={});const i=n[t];if(En(i)&&Cn(s))return s;return i||{}}(t,s,n))))}function Na(e,t,s,n,i){for(;s;)s=Ca(e,t,s,n,i);return s}function Ta(e,t){for(const s of t){if(!s)continue;const t=s[e];if("undefined"!==typeof t)return t}}function Pa(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const s of e)for(const e of Object.keys(s).filter((e=>!e.startsWith("_"))))t.add(e);return Array.from(t)}(e._scopes)),t}function Ma(e,t,s,n){const{iScale:i}=e,{key:a="r"}=this._parsing,r=new Array(n);let o,l,c,d;for(o=0,l=n;o<l;++o)c=o+s,d=t[c],r[o]={r:i.parse(Hn(d,a),c)};return r}const Ra=Number.EPSILON||1e-14,Ia=(e,t)=>t<e.length&&!e[t].skip&&e[t],Da=e=>"x"===e?"y":"x";function La(e,t,s,n){const i=e.skip?t:e,a=t,r=s.skip?t:s,o=hi(a,i),l=hi(r,a);let c=o/(o+l),d=l/(o+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const h=n*c,u=n*d;return{previous:{x:a.x-h*(r.x-i.x),y:a.y-h*(r.y-i.y)},next:{x:a.x+u*(r.x-i.x),y:a.y+u*(r.y-i.y)}}}function Oa(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const s=Da(t),n=e.length,i=Array(n).fill(0),a=Array(n);let r,o,l,c=Ia(e,0);for(r=0;r<n;++r)if(o=l,l=c,c=Ia(e,r+1),l){if(c){const e=c[t]-l[t];i[r]=0!==e?(c[s]-l[s])/e:0}a[r]=o?c?si(i[r-1])!==si(i[r])?0:(i[r-1]+i[r])/2:i[r-1]:i[r]}!function(e,t,s){const n=e.length;let i,a,r,o,l,c=Ia(e,0);for(let d=0;d<n-1;++d)l=c,c=Ia(e,d+1),l&&c&&(ni(t[d],0,Ra)?s[d]=s[d+1]=0:(i=s[d]/t[d],a=s[d+1]/t[d],o=Math.pow(i,2)+Math.pow(a,2),o<=9||(r=3/Math.sqrt(o),s[d]=i*r*t[d],s[d+1]=a*r*t[d])))}(e,i,a),function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const n=Da(s),i=e.length;let a,r,o,l=Ia(e,0);for(let c=0;c<i;++c){if(r=o,o=l,l=Ia(e,c+1),!o)continue;const i=o[s],d=o[n];r&&(a=(i-r[s])/3,o[`cp1${s}`]=i-a,o[`cp1${n}`]=d-a*t[c]),l&&(a=(l[s]-i)/3,o[`cp2${s}`]=i+a,o[`cp2${n}`]=d+a*t[c])}}(e,a,t)}function Fa(e,t,s){return Math.max(Math.min(e,s),t)}function za(e,t,s,n,i){let a,r,o,l;if(t.spanGaps&&(e=e.filter((e=>!e.skip))),"monotone"===t.cubicInterpolationMode)Oa(e,i);else{let s=n?e[e.length-1]:e[0];for(a=0,r=e.length;a<r;++a)o=e[a],l=La(s,o,e[Math.min(a+1,r-(n?0:1))%r],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,s=o}t.capBezierPoints&&function(e,t){let s,n,i,a,r,o=ea(e[0],t);for(s=0,n=e.length;s<n;++s)r=a,a=o,o=s<n-1&&ea(e[s+1],t),a&&(i=e[s],r&&(i.cp1x=Fa(i.cp1x,t.left,t.right),i.cp1y=Fa(i.cp1y,t.top,t.bottom)),o&&(i.cp2x=Fa(i.cp2x,t.left,t.right),i.cp2y=Fa(i.cp2y,t.top,t.bottom)))}(e,s)}function $a(){return"undefined"!==typeof window&&"undefined"!==typeof document}function Ba(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function Ha(e,t,s){let n;return"string"===typeof e?(n=parseInt(e,10),-1!==e.indexOf("%")&&(n=n/100*t.parentNode[s])):n=e,n}const Ua=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const Va=["top","right","bottom","left"];function Wa(e,t,s){const n={};s=s?"-"+s:"";for(let i=0;i<4;i++){const a=Va[i];n[a]=parseFloat(e[t+"-"+a+s])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function qa(e,t){if("native"in e)return e;const{canvas:s,currentDevicePixelRatio:n}=t,i=Ua(s),a="border-box"===i.boxSizing,r=Wa(i,"padding"),o=Wa(i,"border","width"),{x:l,y:c,box:d}=function(e,t){const s=e.touches,n=s&&s.length?s[0]:e,{offsetX:i,offsetY:a}=n;let r,o,l=!1;if(((e,t,s)=>(e>0||t>0)&&(!s||!s.shadowRoot))(i,a,e.target))r=i,o=a;else{const e=t.getBoundingClientRect();r=n.clientX-e.left,o=n.clientY-e.top,l=!0}return{x:r,y:o,box:l}}(e,s),h=r.left+(d&&o.left),u=r.top+(d&&o.top);let{width:p,height:f}=t;return a&&(p-=r.width+o.width,f-=r.height+o.height),{x:Math.round((l-h)/p*s.width/n),y:Math.round((c-u)/f*s.height/n)}}const Ga=e=>Math.round(10*e)/10;function Xa(e,t,s,n){const i=Ua(e),a=Wa(i,"margin"),r=Ha(i.maxWidth,e,"clientWidth")||Kn,o=Ha(i.maxHeight,e,"clientHeight")||Kn,l=function(e,t,s){let n,i;if(void 0===t||void 0===s){const a=e&&Ba(e);if(a){const e=a.getBoundingClientRect(),r=Ua(a),o=Wa(r,"border","width"),l=Wa(r,"padding");t=e.width-l.width-o.width,s=e.height-l.height-o.height,n=Ha(r.maxWidth,a,"clientWidth"),i=Ha(r.maxHeight,a,"clientHeight")}else t=e.clientWidth,s=e.clientHeight}return{width:t,height:s,maxWidth:n||Kn,maxHeight:i||Kn}}(e,t,s);let{width:c,height:d}=l;if("content-box"===i.boxSizing){const e=Wa(i,"border","width"),t=Wa(i,"padding");c-=t.width+e.width,d-=t.height+e.height}c=Math.max(0,c-a.width),d=Math.max(0,n?c/n:d-a.height),c=Ga(Math.min(c,r,l.maxWidth)),d=Ga(Math.min(d,o,l.maxHeight)),c&&!d&&(d=Ga(c/2));return(void 0!==t||void 0!==s)&&n&&l.height&&d>l.height&&(d=l.height,c=Ga(Math.floor(d*n))),{width:c,height:d}}function Ya(e,t,s){const n=t||1,i=Math.floor(e.height*n),a=Math.floor(e.width*n);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const r=e.canvas;return r.style&&(s||!r.style.height&&!r.style.width)&&(r.style.height=`${e.height}px`,r.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==n||r.height!==i||r.width!==a)&&(e.currentDevicePixelRatio=n,r.height=i,r.width=a,e.ctx.setTransform(n,0,0,n,0,0),!0)}const Ka=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};$a()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(zS){}return e}();function Ja(e,t){const s=function(e,t){return Ua(e).getPropertyValue(t)}(e,t),n=s&&s.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Qa(e,t,s,n){return{x:e.x+s*(t.x-e.x),y:e.y+s*(t.y-e.y)}}function Za(e,t,s,n){return{x:e.x+s*(t.x-e.x),y:"middle"===n?s<.5?e.y:t.y:"after"===n?s<1?e.y:t.y:s>0?t.y:e.y}}function er(e,t,s,n){const i={x:e.cp2x,y:e.cp2y},a={x:t.cp1x,y:t.cp1y},r=Qa(e,i,s),o=Qa(i,a,s),l=Qa(a,t,s),c=Qa(r,o,s),d=Qa(o,l,s);return Qa(c,d,s)}function tr(e,t,s){return e?function(e,t){return{x:s=>e+e+t-s,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,s):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function sr(e,t){let s,n;"ltr"!==t&&"rtl"!==t||(s=e.canvas.style,n=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",t,"important"),e.prevTextDirection=n)}function nr(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function ir(e){return"angle"===e?{between:fi,compare:ui,normalize:pi}:{between:gi,compare:(e,t)=>e-t,normalize:e=>e}}function ar(e){let{start:t,end:s,count:n,loop:i,style:a}=e;return{start:t%n,end:s%n,loop:i&&(s-t+1)%n===0,style:a}}function rr(e,t,s){if(!s)return[e];const{property:n,start:i,end:a}=s,r=t.length,{compare:o,between:l,normalize:c}=ir(n),{start:d,end:h,loop:u,style:p}=function(e,t,s){const{property:n,start:i,end:a}=s,{between:r,normalize:o}=ir(n),l=t.length;let c,d,{start:h,end:u,loop:p}=e;if(p){for(h+=l,u+=l,c=0,d=l;c<d&&r(o(t[h%l][n]),i,a);++c)h--,u--;h%=l,u%=l}return u<h&&(u+=l),{start:h,end:u,loop:p,style:e.style}}(e,t,s),f=[];let m,g,b,v=!1,y=null;const x=()=>v||l(i,b,m)&&0!==o(i,b),w=()=>!v||0===o(a,m)||l(a,b,m);for(let _=d,S=d;_<=h;++_)g=t[_%r],g.skip||(m=c(g[n]),m!==b&&(v=l(m,i,a),null===y&&x()&&(y=0===o(m,i)?_:S),null!==y&&w()&&(f.push(ar({start:y,end:_,loop:u,count:r,style:p})),y=null),S=_,b=m));return null!==y&&f.push(ar({start:y,end:h,loop:u,count:r,style:p})),f}function or(e,t){const s=[],n=e.segments;for(let i=0;i<n.length;i++){const a=rr(n[i],e.points,t);a.length&&s.push(...a)}return s}function lr(e,t,s,n){return n&&n.setContext&&s?function(e,t,s,n){const i=e._chart.getContext(),a=cr(e.options),{_datasetIndex:r,options:{spanGaps:o}}=e,l=s.length,c=[];let d=a,h=t[0].start,u=h;function p(e,t,n,i){const a=o?-1:1;if(e!==t){for(e+=l;s[e%l].skip;)e-=a;for(;s[t%l].skip;)t+=a;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:n,style:i}),d=i,h=t%l)}}for(const f of t){h=o?h:f.start;let e,t=s[h%l];for(u=h+1;u<=f.end;u++){const a=s[u%l];e=cr(n.setContext(va(i,{type:"segment",p0:t,p1:a,p0DataIndex:(u-1)%l,p1DataIndex:u%l,datasetIndex:r}))),dr(e,d)&&p(h,u-1,f.loop,d),t=a,d=e}h<u-1&&p(h,u-1,f.loop,d)}return c}(e,t,s,n):t}function cr(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function dr(e,t){if(!t)return!1;const s=[],n=function(e,t){return Ri(t)?(s.includes(t)||s.push(t),s.indexOf(t)):t};return JSON.stringify(e,n)!==JSON.stringify(t,n)}class hr{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,s,n){const i=t.listeners[n],a=t.duration;i.forEach((n=>n({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(s-t.start,a)})))}_refresh(){this._request||(this._running=!0,this._request=Si.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach(((s,n)=>{if(!s.running||!s.items.length)return;const i=s.items;let a,r=i.length-1,o=!1;for(;r>=0;--r)a=i[r],a._active?(a._total>s.duration&&(s.duration=a._total),a.tick(e),o=!0):(i[r]=i[i.length-1],i.pop());o&&(n.draw(),this._notify(n,s,e,"progress")),i.length||(s.running=!1,this._notify(n,s,e,"complete"),s.initial=!1),t+=i.length})),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let s=t.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,s)),s}listen(e,t,s){this._getAnims(e).listeners[t].push(s)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(((e,t)=>Math.max(e,t._duration)),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const s=t.items;let n=s.length-1;for(;n>=0;--n)s[n].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ur=new hr;const pr="transparent",fr={boolean:(e,t,s)=>s>.5?t:e,color(e,t,s){const n=Ii(e||pr),i=n.valid&&Ii(t||pr);return i&&i.valid?i.mix(n,s).hexString():t},number:(e,t,s)=>e+(t-e)*s};class mr{constructor(e,t,s,n){const i=t[s];n=ba([e.to,n,i,e.from]);const a=ba([e.from,i,n]);this._active=!0,this._fn=e.fn||fr[e.type||typeof a],this._easing=Mi[e.easing]||Mi.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=s,this._from=a,this._to=n,this._promises=void 0}active(){return this._active}update(e,t,s){if(this._active){this._notify(!1);const n=this._target[this._prop],i=s-this._start,a=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=ba([e.to,t,n,e.from]),this._from=ba([e.from,n,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,s=this._duration,n=this._prop,i=this._from,a=this._loop,r=this._to;let o;if(this._active=i!==r&&(a||t<s),!this._active)return this._target[n]=r,void this._notify(!0);t<0?this._target[n]=i:(o=t/s%2,o=a&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[n]=this._fn(i,r,o))}wait(){const e=this._promises||(this._promises=[]);return new Promise(((t,s)=>{e.push({res:t,rej:s})}))}_notify(e){const t=e?"res":"rej",s=this._promises||[];for(let n=0;n<s.length;n++)s[n][t]()}}class gr{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Cn(e))return;const t=Object.keys(Gi.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach((n=>{const i=e[n];if(!Cn(i))return;const a={};for(const e of t)a[e]=i[e];(En(i.properties)&&i.properties||[n]).forEach((e=>{e!==n&&s.has(e)||s.set(e,a)}))}))}_animateOptions(e,t){const s=t.options,n=function(e,t){if(!t)return;let s=e.options;if(!s)return void(e.options=t);s.$shared&&(e.options=s=Object.assign({},s,{$shared:!1,$animations:{}}));return s}(e,s);if(!n)return[];const i=this._createAnimations(n,s);return s.$shared&&function(e,t){const s=[],n=Object.keys(t);for(let i=0;i<n.length;i++){const t=e[n[i]];t&&t.active()&&s.push(t.wait())}return Promise.all(s)}(e.options.$animations,s).then((()=>{e.options=s}),(()=>{})),i}_createAnimations(e,t){const s=this._properties,n=[],i=e.$animations||(e.$animations={}),a=Object.keys(t),r=Date.now();let o;for(o=a.length-1;o>=0;--o){const l=a[o];if("$"===l.charAt(0))continue;if("options"===l){n.push(...this._animateOptions(e,t));continue}const c=t[l];let d=i[l];const h=s.get(l);if(d){if(h&&d.active()){d.update(h,c,r);continue}d.cancel()}h&&h.duration?(i[l]=d=new mr(h,e,l,c),n.push(d)):e[l]=c}return n}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const s=this._createAnimations(e,t);return s.length?(ur.add(this._chart,s),!0):void 0}}function br(e,t){const s=e&&e.options||{},n=s.reverse,i=void 0===s.min?t:0,a=void 0===s.max?t:0;return{start:n?a:i,end:n?i:a}}function vr(e,t){const s=[],n=e._getSortedDatasetMetas(t);let i,a;for(i=0,a=n.length;i<a;++i)s.push(n[i].index);return s}function yr(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=e.keys,a="single"===n.mode;let r,o,l,c;if(null===t)return;let d=!1;for(r=0,o=i.length;r<o;++r){if(l=+i[r],l===s){if(d=!0,n.all)continue;break}c=e.values[l],jn(c)&&(a||0===t||si(t)===si(c))&&(t+=c)}return d||n.all?t:0}function xr(e,t){const s=e&&e.options.stacked;return s||void 0===s&&void 0!==t.stack}function wr(e,t,s){const n=e[t]||(e[t]={});return n[s]||(n[s]={})}function _r(e,t,s,n){for(const i of t.getMatchingVisibleMetas(n).reverse()){const t=e[i.index];if(s&&t>0||!s&&t<0)return i.index}return null}function Sr(e,t){const{chart:s,_cachedMeta:n}=e,i=s._stacks||(s._stacks={}),{iScale:a,vScale:r,index:o}=n,l=a.axis,c=r.axis,d=function(e,t,s){return`${e.id}.${t.id}.${s.stack||s.type}`}(a,r,n),h=t.length;let u;for(let p=0;p<h;++p){const e=t[p],{[l]:s,[c]:a}=e;u=(e._stacks||(e._stacks={}))[c]=wr(i,d,s),u[o]=a,u._top=_r(u,r,!0,n.type),u._bottom=_r(u,r,!1,n.type);(u._visualValues||(u._visualValues={}))[o]=a}}function Ar(e,t){const s=e.scales;return Object.keys(s).filter((e=>s[e].axis===t)).shift()}function kr(e,t){const s=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[n]||void 0===t[n][s])return;delete t[n][s],void 0!==t[n]._visualValues&&void 0!==t[n]._visualValues[s]&&delete t[n]._visualValues[s]}}}const Er=e=>"reset"===e||"none"===e,Cr=(e,t)=>t?e:Object.assign({},e);class jr{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=xr(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&kr(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,s=this.getDataset(),n=(e,t,s,n)=>"x"===e?t:"r"===e?n:s,i=t.xAxisID=Tn(s.xAxisID,Ar(e,"x")),a=t.yAxisID=Tn(s.yAxisID,Ar(e,"y")),r=t.rAxisID=Tn(s.rAxisID,Ar(e,"r")),o=t.indexAxis,l=t.iAxisID=n(o,i,a,r),c=t.vAxisID=n(o,a,i,r);t.xScale=this.getScaleForId(i),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(r),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&wi(this._data,this),e._stacked&&kr(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),s=this._data;if(Cn(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:s,vScale:n}=t,i="x"===s.axis?"x":"y",a="x"===n.axis?"x":"y",r=Object.keys(e),o=new Array(r.length);let l,c,d;for(l=0,c=r.length;l<c;++l)d=r[l],o[l]={[i]:d,[a]:e[d]};return o}(t,e)}else if(s!==t){if(s){wi(s,this);const e=this._cachedMeta;kr(e),e._parsed=[]}t&&Object.isExtensible(t)&&(i=this,(n=t)._chartjs?n._chartjs.listeners.push(i):(Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[i]}}),xi.forEach((e=>{const t="_onData"+Un(e),s=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];const r=s.apply(this,i);return n._chartjs.listeners.forEach((e=>{"function"===typeof e[t]&&e[t](...i)})),r}})})))),this._syncList=[],this._data=t}var n,i}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,s=this.getDataset();let n=!1;this._dataCheck();const i=t._stacked;t._stacked=xr(t.vScale,t),t.stack!==s.stack&&(n=!0,kr(t),t.stack=s.stack),this._resyncElements(e),(n||i!==t._stacked)&&(Sr(this,t._parsed),t._stacked=xr(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:s,_data:n}=this,{iScale:i,_stacked:a}=s,r=i.axis;let o,l,c,d=0===e&&t===n.length||s._sorted,h=e>0&&s._parsed[e-1];if(!1===this._parsing)s._parsed=n,s._sorted=!0,c=n;else{c=En(n[e])?this.parseArrayData(s,n,e,t):Cn(n[e])?this.parseObjectData(s,n,e,t):this.parsePrimitiveData(s,n,e,t);const i=()=>null===l[r]||h&&l[r]<h[r];for(o=0;o<t;++o)s._parsed[o+e]=l=c[o],d&&(i()&&(d=!1),h=l);s._sorted=d}a&&Sr(this,c)}parsePrimitiveData(e,t,s,n){const{iScale:i,vScale:a}=e,r=i.axis,o=a.axis,l=i.getLabels(),c=i===a,d=new Array(n);let h,u,p;for(h=0,u=n;h<u;++h)p=h+s,d[h]={[r]:c||i.parse(l[p],p),[o]:a.parse(t[p],p)};return d}parseArrayData(e,t,s,n){const{xScale:i,yScale:a}=e,r=new Array(n);let o,l,c,d;for(o=0,l=n;o<l;++o)c=o+s,d=t[c],r[o]={x:i.parse(d[0],c),y:a.parse(d[1],c)};return r}parseObjectData(e,t,s,n){const{xScale:i,yScale:a}=e,{xAxisKey:r="x",yAxisKey:o="y"}=this._parsing,l=new Array(n);let c,d,h,u;for(c=0,d=n;c<d;++c)h=c+s,u=t[h],l[c]={x:i.parse(Hn(u,r),h),y:a.parse(Hn(u,o),h)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,s){const n=this.chart,i=this._cachedMeta,a=t[e.axis];return yr({keys:vr(n,!0),values:t._stacks[e.axis]._visualValues},a,i.index,{mode:s})}updateRangeFromParsed(e,t,s,n){const i=s[t.axis];let a=null===i?NaN:i;const r=n&&s._stacks[t.axis];n&&r&&(n.values=r,a=yr(n,i,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const s=this._cachedMeta,n=s._parsed,i=s._sorted&&e===s.iScale,a=n.length,r=this._getOtherScale(e),o=((e,t,s)=>e&&!t.hidden&&t._stacked&&{keys:vr(s,!0),values:null})(t,s,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(e){const{min:t,max:s,minDefined:n,maxDefined:i}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:i?s:Number.POSITIVE_INFINITY}}(r);let h,u;function p(){u=n[h];const t=u[r.axis];return!jn(u[e.axis])||c>t||d<t}for(h=0;h<a&&(p()||(this.updateRangeFromParsed(l,e,u,o),!i));++h);if(i)for(h=a-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(l,e,u,o);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,s=[];let n,i,a;for(n=0,i=t.length;n<i;++n)a=t[n][e.axis],jn(a)&&s.push(a);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,s=t.iScale,n=t.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:n?""+n.getLabelForValue(i[n.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,s,n,i;return Cn(e)?(t=e.top,s=e.right,n=e.bottom,i=e.left):t=s=n=i=e,{top:t,right:s,bottom:n,left:i,disabled:!1===e}}(Tn(this.options.clip,function(e,t,s){if(!1===s)return!1;const n=br(e,s),i=br(t,s);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,s=this._cachedMeta,n=s.data||[],i=t.chartArea,a=[],r=this._drawStart||0,o=this._drawCount||n.length-r,l=this.options.drawActiveElementsOnTop;let c;for(s.dataset&&s.dataset.draw(e,i,r,o),c=r;c<r+o;++c){const t=n[c];t.hidden||(t.active&&l?a.push(t):t.draw(e,i))}for(c=0;c<a.length;++c)a[c].draw(e,i)}getStyle(e,t){const s=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,t,s){const n=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];i=t.$context||(t.$context=function(e,t,s){return va(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:s,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),i.parsed=this.getParsed(e),i.raw=n.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=function(e,t){return va(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),i.dataset=n,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=arguments.length>2?arguments[2]:void 0;const n="active"===t,i=this._cachedDataOpts,a=e+"-"+t,r=i[a],o=this.enableOptionSharing&&Vn(s);if(r)return Cr(r,o);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),d=n?[`${e}Hover`,"hover",e,""]:[e,""],h=l.getOptionScopes(this.getDataset(),c),u=Object.keys(Gi.elements[e]),p=l.resolveNamedOptions(h,u,(()=>this.getContext(s,n,t)),d);return p.$shared&&(p.$shared=o,i[a]=Object.freeze(Cr(p,o))),p}_resolveAnimations(e,t,s){const n=this.chart,i=this._cachedDataOpts,a=`animation-${t}`,r=i[a];if(r)return r;let o;if(!1!==n.options.animation){const n=this.chart.config,i=n.datasetAnimationScopeKeys(this._type,t),a=n.getOptionScopes(this.getDataset(),i);o=n.createResolver(a,this.getContext(e,s,t))}const l=new gr(n,o&&o.animations);return o&&o._cacheable&&(i[a]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Er(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const s=this.resolveDataElementOptions(e,t),n=this._sharedOptions,i=this.getSharedOptions(s),a=this.includeOptions(t,i)||i!==n;return this.updateSharedOptions(i,t,s),{sharedOptions:i,includeOptions:a}}updateElement(e,t,s,n){Er(n)?Object.assign(e,s):this._resolveAnimations(t,n).update(e,s)}updateSharedOptions(e,t,s){e&&!Er(t)&&this._resolveAnimations(void 0,t).update(e,s)}_setStyle(e,t,s,n){e.active=n;const i=this.getStyle(t,n);this._resolveAnimations(t,s,n).update(e,{options:!n&&this.getSharedOptions(i)||i})}removeHoverStyle(e,t,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,t,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,s=this._cachedMeta.data;for(const[r,o,l]of this._syncList)this[r](o,l);this._syncList=[];const n=s.length,i=t.length,a=Math.min(i,n);a&&this.parse(0,a),i>n?this._insertElements(n,i-n,e):i<n&&this._removeElements(i,n-i)}_insertElements(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=this._cachedMeta,i=n.data,a=e+t;let r;const o=e=>{for(e.length+=t,r=e.length-1;r>=a;r--)e[r]=e[r-t]};for(o(i),r=e;r<a;++r)i[r]=new this.dataElementType;this._parsing&&o(n._parsed),this.parse(e,t),s&&this.updateElements(i,e,t,"reset")}updateElements(e,t,s,n){}_removeElements(e,t){const s=this._cachedMeta;if(this._parsing){const n=s._parsed.splice(e,t);s._stacked&&kr(s,n)}s.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,s,n]=e;this[t](s,n)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Nr(e){const t=e.iScale,s=function(e,t){if(!e._cache.$bar){const s=e.getMatchingVisibleMetas(t);let n=[];for(let t=0,i=s.length;t<i;t++)n=n.concat(s[t].controller.getAllParsedValues(e));e._cache.$bar=_i(n.sort(((e,t)=>e-t)))}return e._cache.$bar}(t,e.type);let n,i,a,r,o=t._length;const l=()=>{32767!==a&&-32768!==a&&(Vn(r)&&(o=Math.min(o,Math.abs(a-r)||o)),r=a)};for(n=0,i=s.length;n<i;++n)a=t.getPixelForValue(s[n]),l();for(r=void 0,n=0,i=t.ticks.length;n<i;++n)a=t.getPixelForTick(n),l();return o}function Tr(e,t,s,n){return En(e)?function(e,t,s,n){const i=s.parse(e[0],n),a=s.parse(e[1],n),r=Math.min(i,a),o=Math.max(i,a);let l=r,c=o;Math.abs(r)>Math.abs(o)&&(l=o,c=r),t[s.axis]=c,t._custom={barStart:l,barEnd:c,start:i,end:a,min:r,max:o}}(e,t,s,n):t[s.axis]=s.parse(e,n),t}function Pr(e,t,s,n){const i=e.iScale,a=e.vScale,r=i.getLabels(),o=i===a,l=[];let c,d,h,u;for(c=s,d=s+n;c<d;++c)u=t[c],h={},h[i.axis]=o||i.parse(r[c],c),l.push(Tr(u,h,a,c));return l}function Mr(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function Rr(e,t,s,n){let i=t.borderSkipped;const a={};if(!i)return void(e.borderSkipped=a);if(!0===i)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:r,end:o,reverse:l,top:c,bottom:d}=function(e){let t,s,n,i,a;return e.horizontal?(t=e.base>e.x,s="left",n="right"):(t=e.base<e.y,s="bottom",n="top"),t?(i="end",a="start"):(i="start",a="end"),{start:s,end:n,reverse:t,top:i,bottom:a}}(e);"middle"===i&&s&&(e.enableBorderRadius=!0,(s._top||0)===n?i=c:(s._bottom||0)===n?i=d:(a[Ir(d,r,o,l)]=!0,i=c)),a[Ir(i,r,o,l)]=!0,e.borderSkipped=a}function Ir(e,t,s,n){var i,a,r;return n?(r=s,e=Dr(e=(i=e)===(a=t)?r:i===r?a:i,s,t)):e=Dr(e,t,s),e}function Dr(e,t,s){return"start"===e?t:"end"===e?s:e}function Lr(e,t,s){let{inflateAmount:n}=t;e.inflateAmount="auto"===n?1===s?.33:0:n}class Or extends jr{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,s,n){return Pr(e,t,s,n)}parseArrayData(e,t,s,n){return Pr(e,t,s,n)}parseObjectData(e,t,s,n){const{iScale:i,vScale:a}=e,{xAxisKey:r="x",yAxisKey:o="y"}=this._parsing,l="x"===i.axis?r:o,c="x"===a.axis?r:o,d=[];let h,u,p,f;for(h=s,u=s+n;h<u;++h)f=t[h],p={},p[i.axis]=i.parse(Hn(f,l),h),d.push(Tr(Hn(f,c),p,a,h));return d}updateRangeFromParsed(e,t,s,n){super.updateRangeFromParsed(e,t,s,n);const i=s._custom;i&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:s,vScale:n}=t,i=this.getParsed(e),a=i._custom,r=Mr(a)?"["+a.start+", "+a.end+"]":""+n.getLabelForValue(i[n.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:r}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,s,n){const i="reset"===n,{index:a,_cachedMeta:{vScale:r}}=this,o=r.getBasePixel(),l=r.isHorizontal(),c=this._getRuler(),{sharedOptions:d,includeOptions:h}=this._getSharedOptions(t,n);for(let u=t;u<t+s;u++){const t=this.getParsed(u),s=i||kn(t[r.axis])?{base:o,head:o}:this._calculateBarValuePixels(u),p=this._calculateBarIndexPixels(u,c),f=(t._stacks||{})[r.axis],m={horizontal:l,base:s.base,enableBorderRadius:!f||Mr(t._custom)||a===f._top||a===f._bottom,x:l?s.head:p.center,y:l?p.center:s.head,height:l?p.size:Math.abs(s.size),width:l?Math.abs(s.size):p.size};h&&(m.options=d||this.resolveDataElementOptions(u,e[u].active?"active":n));const g=m.options||e[u].options;Rr(m,g,f,a),Lr(m,g,c.ratio),this.updateElement(e[u],u,m,n)}}_getStacks(e,t){const{iScale:s}=this._cachedMeta,n=s.getMatchingVisibleMetas(this._type).filter((e=>e.controller.options.grouped)),i=s.options.stacked,a=[],r=this._cachedMeta.controller.getParsed(t),o=r&&r[s.axis],l=e=>{const t=e._parsed.find((e=>e[s.axis]===o)),n=t&&t[e.vScale.axis];if(kn(n)||isNaN(n))return!0};for(const c of n)if((void 0===t||!l(c))&&((!1===i||-1===a.indexOf(c.stack)||void 0===i&&void 0===c.stack)&&a.push(c.stack),c.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,s){const n=this._getStacks(e,s),i=void 0!==t?n.indexOf(t):-1;return-1===i?n.length-1:i}_getRuler(){const e=this.options,t=this._cachedMeta,s=t.iScale,n=[];let i,a;for(i=0,a=t.data.length;i<a;++i)n.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const r=e.barThickness;return{min:r||Nr(t),pixels:n,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:r?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:s,index:n},options:{base:i,minBarLength:a}}=this,r=i||0,o=this.getParsed(e),l=o._custom,c=Mr(l);let d,h,u=o[t.axis],p=0,f=s?this.applyStack(t,o,s):u;f!==u&&(p=f-u,f=u),c&&(u=l.barStart,f=l.barEnd-l.barStart,0!==u&&si(u)!==si(l.barEnd)&&(p=0),p+=u);const m=kn(i)||c?p:i;let g=t.getPixelForValue(m);if(d=this.chart.getDataVisibility(e)?t.getPixelForValue(p+f):g,h=d-g,Math.abs(h)<a){h=function(e,t,s){return 0!==e?si(e):(t.isHorizontal()?1:-1)*(t.min>=s?1:-1)}(h,t,r)*a,u===r&&(g-=h/2);const e=t.getPixelForDecimal(0),i=t.getPixelForDecimal(1),l=Math.min(e,i),p=Math.max(e,i);g=Math.max(Math.min(g,p),l),d=g+h,s&&!c&&(o._stacks[t.axis]._visualValues[n]=t.getValueForPixel(d)-t.getValueForPixel(g))}if(g===t.getPixelForValue(r)){const e=si(h)*t.getLineWidthForValue(r)/2;g+=e,h-=e}return{size:h,base:g,head:d,center:d+h/2}}_calculateBarIndexPixels(e,t){const s=t.scale,n=this.options,i=n.skipNull,a=Tn(n.maxBarThickness,1/0);let r,o;if(t.grouped){const s=i?this._getStackCount(e):t.stackCount,l="flex"===n.barThickness?function(e,t,s,n){const i=t.pixels,a=i[e];let r=e>0?i[e-1]:null,o=e<i.length-1?i[e+1]:null;const l=s.categoryPercentage;null===r&&(r=a-(null===o?t.end-t.start:o-a)),null===o&&(o=a+a-r);const c=a-(a-Math.min(r,o))/2*l;return{chunk:Math.abs(o-r)/2*l/n,ratio:s.barPercentage,start:c}}(e,t,n,s):function(e,t,s,n){const i=s.barThickness;let a,r;return kn(i)?(a=t.min*s.categoryPercentage,r=s.barPercentage):(a=i*n,r=1),{chunk:a/n,ratio:r,start:t.pixels[e]-a/2}}(e,t,n,s),c=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0);r=l.start+l.chunk*c+l.chunk/2,o=Math.min(a,l.chunk*l.ratio)}else r=s.getPixelForValue(this.getParsed(e)[s.axis],e),o=Math.min(a,t.min*t.ratio);return{base:r-o/2,head:r+o/2,center:r,size:o}}draw(){const e=this._cachedMeta,t=e.vScale,s=e.data,n=s.length;let i=0;for(;i<n;++i)null===this.getParsed(i)[t.axis]||s[i].hidden||s[i].draw(this._ctx)}}class Fr extends jr{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:s,color:n}}=e.legend.options;return t.labels.map(((t,i)=>{const a=e.getDatasetMeta(0).controller.getStyle(i);return{text:t,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,fontColor:n,lineWidth:a.borderWidth,pointStyle:s,hidden:!e.getDataVisibility(i),index:i}}))}return[]}},onClick(e,t,s){s.chart.toggleDataVisibility(t.index),s.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const s=this.getDataset().data,n=this._cachedMeta;if(!1===this._parsing)n._parsed=s;else{let i,a,r=e=>+s[e];if(Cn(s[e])){const{key:e="value"}=this._parsing;r=t=>+Hn(s[t],e)}for(i=e,a=e+t;i<a;++i)n._parsed[i]=r(i)}}_getRotation(){return oi(this.options.rotation-90)}_getCircumference(){return oi(this.options.circumference)}_getRotationExtents(){let e=Xn,t=-Xn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const n=this.chart.getDatasetMeta(s).controller,i=n._getRotation(),a=n._getCircumference();e=Math.min(e,i),t=Math.max(t,i+a)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:s}=t,n=this._cachedMeta,i=n.data,a=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,r=Math.max((Math.min(s.width,s.height)-a)/2,0),o=Math.min((l=this.options.cutout,c=r,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const d=this._getRingWeight(this.index),{circumference:h,rotation:u}=this._getRotationExtents(),{ratioX:p,ratioY:f,offsetX:m,offsetY:g}=function(e,t,s){let n=1,i=1,a=0,r=0;if(t<Xn){const o=e,l=o+t,c=Math.cos(o),d=Math.sin(o),h=Math.cos(l),u=Math.sin(l),p=(e,t,n)=>fi(e,o,l,!0)?1:Math.max(t,t*s,n,n*s),f=(e,t,n)=>fi(e,o,l,!0)?-1:Math.min(t,t*s,n,n*s),m=p(0,c,h),g=p(Qn,d,u),b=f(Gn,c,h),v=f(Gn+Qn,d,u);n=(m-b)/2,i=(g-v)/2,a=-(m+b)/2,r=-(g+v)/2}return{ratioX:n,ratioY:i,offsetX:a,offsetY:r}}(u,h,o),b=(s.width-a)/p,v=(s.height-a)/f,y=Math.max(Math.min(b,v)/2,0),x=Pn(this.options.radius,y),w=(x-Math.max(x*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=m*x,this.offsetY=g*x,n.total=this.calculateTotal(),this.outerRadius=x-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*d,0),this.updateElements(i,0,i.length,e)}_circumference(e,t){const s=this.options,n=this._cachedMeta,i=this._getCircumference();return t&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||null===n._parsed[e]||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*i/Xn)}updateElements(e,t,s,n){const i="reset"===n,a=this.chart,r=a.chartArea,o=a.options.animation,l=(r.left+r.right)/2,c=(r.top+r.bottom)/2,d=i&&o.animateScale,h=d?0:this.innerRadius,u=d?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(t,n);let m,g=this._getRotation();for(m=0;m<t;++m)g+=this._circumference(m,i);for(m=t;m<t+s;++m){const t=this._circumference(m,i),s=e[m],a={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+t,circumference:t,outerRadius:u,innerRadius:h};f&&(a.options=p||this.resolveDataElementOptions(m,s.active?"active":n)),g+=t,this.updateElement(s,m,a,n)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let s,n=0;for(s=0;s<t.length;s++){const i=e._parsed[s];null===i||isNaN(i)||!this.chart.getDataVisibility(s)||t[s].hidden||(n+=Math.abs(i))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Xn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,s=this.chart,n=s.data.labels||[],i=zi(t._parsed[e],s.options.locale);return{label:n[e]||"",value:i}}getMaxBorderWidth(e){let t=0;const s=this.chart;let n,i,a,r,o;if(!e)for(n=0,i=s.data.datasets.length;n<i;++n)if(s.isDatasetVisible(n)){a=s.getDatasetMeta(n),e=a.data,r=a.controller;break}if(!e)return 0;for(n=0,i=e.length;n<i;++n)o=r.resolveDataElementOptions(n),"inner"!==o.borderAlign&&(t=Math.max(t,o.borderWidth||0,o.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let s=0,n=e.length;s<n;++s){const e=this.resolveDataElementOptions(s);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(t+=this._getRingWeight(s));return t}_getRingWeight(e){return Math.max(Tn(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class zr extends jr{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:s,data:n=[],_dataset:i}=t,a=this.chart._animationsDisabled;let{start:r,count:o}=Ci(t,n,a);this._drawStart=r,this._drawCount=o,ji(t)&&(r=0,o=n.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=n;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(s,void 0,{animated:!a,options:l},e),this.updateElements(n,r,o,e)}updateElements(e,t,s,n){const i="reset"===n,{iScale:a,vScale:r,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(t,n),h=a.axis,u=r.axis,{spanGaps:p,segment:f}=this.options,m=ai(p)?p:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||i||"none"===n,b=t+s,v=e.length;let y=t>0&&this.getParsed(t-1);for(let x=0;x<v;++x){const s=e[x],p=g?s:{};if(x<t||x>=b){p.skip=!0;continue}const v=this.getParsed(x),w=kn(v[u]),_=p[h]=a.getPixelForValue(v[h],x),S=p[u]=i||w?r.getBasePixel():r.getPixelForValue(o?this.applyStack(r,v,o):v[u],x);p.skip=isNaN(_)||isNaN(S)||w,p.stop=x>0&&Math.abs(v[h]-y[h])>m,f&&(p.parsed=v,p.raw=l.data[x]),d&&(p.options=c||this.resolveDataElementOptions(x,s.active?"active":n)),g||this.updateElement(s,x,p,n),y=v}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,s=t.options&&t.options.borderWidth||0,n=e.data||[];if(!n.length)return s;const i=n[0].size(this.resolveDataElementOptions(0)),a=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(s,i,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class $r extends Fr{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class Br extends jr{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const t=this._cachedMeta.vScale,s=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(s[t.axis])}}parseObjectData(e,t,s,n){return Ma.bind(this)(e,t,s,n)}update(e){const t=this._cachedMeta,s=t.dataset,n=t.data||[],i=t.iScale.getLabels();if(s.points=n,"resize"!==e){const t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);const a={_loop:!0,_fullLoop:i.length===n.length,options:t};this.updateElement(s,void 0,a,e)}this.updateElements(n,0,n.length,e)}updateElements(e,t,s,n){const i=this._cachedMeta.rScale,a="reset"===n;for(let r=t;r<t+s;r++){const t=e[r],s=this.resolveDataElementOptions(r,t.active?"active":n),o=i.getPointPositionForValue(r,this.getParsed(r).r),l=a?i.xCenter:o.x,c=a?i.yCenter:o.y,d={x:l,y:c,angle:o.angle,skip:isNaN(l)||isNaN(c),options:s};this.updateElement(t,r,d,n)}}}function Hr(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ur{static override(e){Object.assign(Ur.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Hr()}parse(){return Hr()}format(){return Hr()}add(){return Hr()}diff(){return Hr()}startOf(){return Hr()}endOf(){return Hr()}}var Vr=Ur;function Wr(e,t,s,n){const{controller:i,data:a,_sorted:r}=e,o=i._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&"r"!==t&&r&&a.length){const r=o._reversePixels?yi:vi;if(!n){const n=r(a,t,s);if(l){const{vScale:t}=i._cachedMeta,{_parsed:s}=e,a=s.slice(0,n.lo+1).reverse().findIndex((e=>!kn(e[t.axis])));n.lo-=Math.max(0,a);const r=s.slice(n.hi).findIndex((e=>!kn(e[t.axis])));n.hi+=Math.max(0,r)}return n}if(i._sharedOptions){const e=a[0],n="function"===typeof e.getRange&&e.getRange(t);if(n){const e=r(a,t,s-n),i=r(a,t,s+n);return{lo:e.lo,hi:i.hi}}}}return{lo:0,hi:a.length-1}}function qr(e,t,s,n,i){const a=e.getSortedVisibleDatasetMetas(),r=s[t];for(let o=0,l=a.length;o<l;++o){const{index:e,data:s}=a[o],{lo:l,hi:c}=Wr(a[o],t,r,i);for(let t=l;t<=c;++t){const i=s[t];i.skip||n(i,e,t)}}}function Gr(e,t,s,n,i){const a=[];if(!i&&!e.isPointInArea(t))return a;return qr(e,s,t,(function(s,r,o){(i||ea(s,e.chartArea,0))&&s.inRange(t.x,t.y,n)&&a.push({element:s,datasetIndex:r,index:o})}),!0),a}function Xr(e,t,s,n,i,a){let r=[];const o=function(e){const t=-1!==e.indexOf("x"),s=-1!==e.indexOf("y");return function(e,n){const i=t?Math.abs(e.x-n.x):0,a=s?Math.abs(e.y-n.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(a,2))}}(s);let l=Number.POSITIVE_INFINITY;return qr(e,s,t,(function(s,c,d){const h=s.inRange(t.x,t.y,i);if(n&&!h)return;const u=s.getCenterPoint(i);if(!(!!a||e.isPointInArea(u))&&!h)return;const p=o(t,u);p<l?(r=[{element:s,datasetIndex:c,index:d}],l=p):p===l&&r.push({element:s,datasetIndex:c,index:d})})),r}function Yr(e,t,s,n,i,a){return a||e.isPointInArea(t)?"r"!==s||n?Xr(e,t,s,n,i,a):function(e,t,s,n){let i=[];return qr(e,s,t,(function(e,s,a){const{startAngle:r,endAngle:o}=e.getProps(["startAngle","endAngle"],n),{angle:l}=di(e,{x:t.x,y:t.y});fi(l,r,o)&&i.push({element:e,datasetIndex:s,index:a})})),i}(e,t,s,i):[]}function Kr(e,t,s,n,i){const a=[],r="x"===s?"inXRange":"inYRange";let o=!1;return qr(e,s,t,((e,n,l)=>{e[r]&&e[r](t[s],i)&&(a.push({element:e,datasetIndex:n,index:l}),o=o||e.inRange(t.x,t.y,i))})),n&&!o?[]:a}var Jr={evaluateInteractionItems:qr,modes:{index(e,t,s,n){const i=qa(t,e),a=s.axis||"x",r=s.includeInvisible||!1,o=s.intersect?Gr(e,i,a,n,r):Yr(e,i,a,!1,n,r),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach((e=>{const t=o[0].index,s=e.data[t];s&&!s.skip&&l.push({element:s,datasetIndex:e.index,index:t})})),l):[]},dataset(e,t,s,n){const i=qa(t,e),a=s.axis||"xy",r=s.includeInvisible||!1;let o=s.intersect?Gr(e,i,a,n,r):Yr(e,i,a,!1,n,r);if(o.length>0){const t=o[0].datasetIndex,s=e.getDatasetMeta(t).data;o=[];for(let e=0;e<s.length;++e)o.push({element:s[e],datasetIndex:t,index:e})}return o},point:(e,t,s,n)=>Gr(e,qa(t,e),s.axis||"xy",n,s.includeInvisible||!1),nearest(e,t,s,n){const i=qa(t,e),a=s.axis||"xy",r=s.includeInvisible||!1;return Yr(e,i,a,s.intersect,n,r)},x:(e,t,s,n)=>Kr(e,qa(t,e),"x",s.intersect,n),y:(e,t,s,n)=>Kr(e,qa(t,e),"y",s.intersect,n)}};const Qr=["left","top","right","bottom"];function Zr(e,t){return e.filter((e=>e.pos===t))}function eo(e,t){return e.filter((e=>-1===Qr.indexOf(e.pos)&&e.box.axis===t))}function to(e,t){return e.sort(((e,s)=>{const n=t?s:e,i=t?e:s;return n.weight===i.weight?n.index-i.index:n.weight-i.weight}))}function so(e,t){const s=function(e){const t={};for(const s of e){const{stack:e,pos:n,stackWeight:i}=s;if(!e||!Qr.includes(n))continue;const a=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=i}return t}(e),{vBoxMaxWidth:n,hBoxMaxHeight:i}=t;let a,r,o;for(a=0,r=e.length;a<r;++a){o=e[a];const{fullSize:r}=o.box,l=s[o.stack],c=l&&o.stackWeight/l.weight;o.horizontal?(o.width=c?c*n:r&&t.availableWidth,o.height=i):(o.width=n,o.height=c?c*i:r&&t.availableHeight)}return s}function no(e,t,s,n){return Math.max(e[s],t[s])+Math.max(e[n],t[n])}function io(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function ao(e,t,s,n){const{pos:i,box:a}=s,r=e.maxPadding;if(!Cn(i)){s.size&&(e[i]-=s.size);const t=n[s.stack]||{size:0,count:1};t.size=Math.max(t.size,s.horizontal?a.height:a.width),s.size=t.size/t.count,e[i]+=s.size}a.getPadding&&io(r,a.getPadding());const o=Math.max(0,t.outerWidth-no(r,e,"left","right")),l=Math.max(0,t.outerHeight-no(r,e,"top","bottom")),c=o!==e.w,d=l!==e.h;return e.w=o,e.h=l,s.horizontal?{same:c,other:d}:{same:d,other:c}}function ro(e,t){const s=t.maxPadding;function n(e){const n={left:0,top:0,right:0,bottom:0};return e.forEach((e=>{n[e]=Math.max(t[e],s[e])})),n}return n(e?["left","right"]:["top","bottom"])}function oo(e,t,s,n){const i=[];let a,r,o,l,c,d;for(a=0,r=e.length,c=0;a<r;++a){o=e[a],l=o.box,l.update(o.width||t.w,o.height||t.h,ro(o.horizontal,t));const{same:r,other:h}=ao(t,s,o,n);c|=r&&i.length,d=d||h,l.fullSize||i.push(o)}return c&&oo(i,t,s,n)||d}function lo(e,t,s,n,i){e.top=s,e.left=t,e.right=t+n,e.bottom=s+i,e.width=n,e.height=i}function co(e,t,s,n){const i=s.padding;let{x:a,y:r}=t;for(const o of e){const e=o.box,l=n[o.stack]||{count:1,placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){const n=t.w*c,a=l.size||e.height;Vn(l.start)&&(r=l.start),e.fullSize?lo(e,i.left,r,s.outerWidth-i.right-i.left,a):lo(e,t.left+l.placed,r,n,a),l.start=r,l.placed+=n,r=e.bottom}else{const n=t.h*c,r=l.size||e.width;Vn(l.start)&&(a=l.start),e.fullSize?lo(e,a,i.top,r,s.outerHeight-i.bottom-i.top):lo(e,a,t.top+l.placed,r,n),l.start=a,l.placed+=n,a=e.right}}t.x=a,t.y=r}var ho={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const s=e.boxes?e.boxes.indexOf(t):-1;-1!==s&&e.boxes.splice(s,1)},configure(e,t,s){t.fullSize=s.fullSize,t.position=s.position,t.weight=s.weight},update(e,t,s,n){if(!e)return;const i=ma(e.options.layout.padding),a=Math.max(t-i.width,0),r=Math.max(s-i.height,0),o=function(e){const t=function(e){const t=[];let s,n,i,a,r,o;for(s=0,n=(e||[]).length;s<n;++s)i=e[s],({position:a,options:{stack:r,stackWeight:o=1}}=i),t.push({index:s,box:i,pos:a,horizontal:i.isHorizontal(),weight:i.weight,stack:r&&a+r,stackWeight:o});return t}(e),s=to(t.filter((e=>e.box.fullSize)),!0),n=to(Zr(t,"left"),!0),i=to(Zr(t,"right")),a=to(Zr(t,"top"),!0),r=to(Zr(t,"bottom")),o=eo(t,"x"),l=eo(t,"y");return{fullSize:s,leftAndTop:n.concat(a),rightAndBottom:i.concat(l).concat(r).concat(o),chartArea:Zr(t,"chartArea"),vertical:n.concat(i).concat(l),horizontal:a.concat(r).concat(o)}}(e.boxes),l=o.vertical,c=o.horizontal;Rn(e.boxes,(e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()}));const d=l.reduce(((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1),0)||1,h=Object.freeze({outerWidth:t,outerHeight:s,padding:i,availableWidth:a,availableHeight:r,vBoxMaxWidth:a/2/d,hBoxMaxHeight:r/2}),u=Object.assign({},i);io(u,ma(n));const p=Object.assign({maxPadding:u,w:a,h:r,x:i.left,y:i.top},i),f=so(l.concat(c),h);oo(o.fullSize,p,h,f),oo(l,p,h,f),oo(c,p,h,f)&&oo(l,p,h,f),function(e){const t=e.maxPadding;function s(s){const n=Math.max(t[s]-e[s],0);return e[s]+=n,n}e.y+=s("top"),e.x+=s("left"),s("right"),s("bottom")}(p),co(o.leftAndTop,p,h,f),p.x+=p.w,p.y+=p.h,co(o.rightAndBottom,p,h,f),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Rn(o.chartArea,(t=>{const s=t.box;Object.assign(s,e.chartArea),s.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})}))}};class uo{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,s){}removeEventListener(e,t,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,s,n){return t=Math.max(0,t||e.width),s=s||e.height,{width:t,height:Math.max(0,n?Math.floor(t/n):s)}}isAttached(e){return!0}updateConfig(e){}}class po extends uo{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const fo="$chartjs",mo={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},go=e=>null===e||""===e;const bo=!!Ka&&{passive:!0};function vo(e,t,s){e&&e.canvas&&e.canvas.removeEventListener(t,s,bo)}function yo(e,t){for(const s of e)if(s===t||s.contains(t))return!0}function xo(e,t,s){const n=e.canvas,i=new MutationObserver((e=>{let t=!1;for(const s of e)t=t||yo(s.addedNodes,n),t=t&&!yo(s.removedNodes,n);t&&s()}));return i.observe(document,{childList:!0,subtree:!0}),i}function wo(e,t,s){const n=e.canvas,i=new MutationObserver((e=>{let t=!1;for(const s of e)t=t||yo(s.removedNodes,n),t=t&&!yo(s.addedNodes,n);t&&s()}));return i.observe(document,{childList:!0,subtree:!0}),i}const _o=new Map;let So=0;function Ao(){const e=window.devicePixelRatio;e!==So&&(So=e,_o.forEach(((t,s)=>{s.currentDevicePixelRatio!==e&&t()})))}function ko(e,t,s){const n=e.canvas,i=n&&Ba(n);if(!i)return;const a=Ai(((e,t)=>{const n=i.clientWidth;s(e,t),n<i.clientWidth&&s()}),window),r=new ResizeObserver((e=>{const t=e[0],s=t.contentRect.width,n=t.contentRect.height;0===s&&0===n||a(s,n)}));return r.observe(i),function(e,t){_o.size||window.addEventListener("resize",Ao),_o.set(e,t)}(e,a),r}function Eo(e,t,s){s&&s.disconnect(),"resize"===t&&function(e){_o.delete(e),_o.size||window.removeEventListener("resize",Ao)}(e)}function Co(e,t,s){const n=e.canvas,i=Ai((t=>{null!==e.ctx&&s(function(e,t){const s=mo[e.type]||e.type,{x:n,y:i}=qa(e,t);return{type:s,chart:t,native:e,x:void 0!==n?n:null,y:void 0!==i?i:null}}(t,e))}),e);return function(e,t,s){e&&e.addEventListener(t,s,bo)}(n,t,i),i}class jo extends uo{acquireContext(e,t){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(function(e,t){const s=e.style,n=e.getAttribute("height"),i=e.getAttribute("width");if(e[fo]={initial:{height:n,width:i,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",go(i)){const t=Ja(e,"width");void 0!==t&&(e.width=t)}if(go(n))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Ja(e,"height");void 0!==t&&(e.height=t)}}(e,t),s):null}releaseContext(e){const t=e.canvas;if(!t[fo])return!1;const s=t[fo].initial;["height","width"].forEach((e=>{const n=s[e];kn(n)?t.removeAttribute(e):t.setAttribute(e,n)}));const n=s.style||{};return Object.keys(n).forEach((e=>{t.style[e]=n[e]})),t.width=t.width,delete t[fo],!0}addEventListener(e,t,s){this.removeEventListener(e,t);const n=e.$proxies||(e.$proxies={}),i={attach:xo,detach:wo,resize:ko}[t]||Co;n[t]=i(e,t,s)}removeEventListener(e,t){const s=e.$proxies||(e.$proxies={}),n=s[t];if(!n)return;({attach:Eo,detach:Eo,resize:Eo}[t]||vo)(e,t,n),s[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,s,n){return Xa(e,t,s,n)}isAttached(e){const t=e&&Ba(e);return!(!t||!t.isConnected)}}class No{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}hasValue(){return ai(this.x)&&ai(this.y)}getProps(e,t){const s=this.$animations;if(!t||!s)return this;const n={};return e.forEach((e=>{n[e]=s[e]&&s[e].active()?s[e]._to:this[e]})),n}}function To(e,t){const s=e.options.ticks,n=function(e){const t=e.options.offset,s=e._tickSize(),n=e._length/s+(t?0:1),i=e._maxLength/s;return Math.floor(Math.min(n,i))}(e),i=Math.min(s.maxTicksLimit||n,n),a=s.major.enabled?function(e){const t=[];let s,n;for(s=0,n=e.length;s<n;s++)e[s].major&&t.push(s);return t}(t):[],r=a.length,o=a[0],l=a[r-1],c=[];if(r>i)return function(e,t,s,n){let i,a=0,r=s[0];for(n=Math.ceil(n),i=0;i<e.length;i++)i===r&&(t.push(e[i]),a++,r=s[a*n])}(t,c,a,r/i),c;const d=function(e,t,s){const n=function(e){const t=e.length;let s,n;if(t<2)return!1;for(n=e[0],s=1;s<t;++s)if(e[s]-e[s-1]!==n)return!1;return n}(e),i=t.length/s;if(!n)return Math.max(i,1);const a=function(e){const t=[],s=Math.sqrt(e);let n;for(n=1;n<s;n++)e%n===0&&(t.push(n),t.push(e/n));return s===(0|s)&&t.push(s),t.sort(((e,t)=>e-t)).pop(),t}(n);for(let r=0,o=a.length-1;r<o;r++){const e=a[r];if(e>i)return e}return Math.max(i,1)}(a,t,i);if(r>0){let e,s;const n=r>1?Math.round((l-o)/(r-1)):null;for(Po(t,c,d,kn(n)?0:o-n,o),e=0,s=r-1;e<s;e++)Po(t,c,d,a[e],a[e+1]);return Po(t,c,d,l,kn(n)?t.length:l+n),c}return Po(t,c,d),c}function Po(e,t,s,n,i){const a=Tn(n,0),r=Math.min(Tn(i,e.length),e.length);let o,l,c,d=0;for(s=Math.ceil(s),i&&(o=i-n,s=o/Math.floor(o/s)),c=a;c<0;)d++,c=Math.round(a+d*s);for(l=Math.max(a,0);l<r;l++)l===c&&(t.push(e[l]),d++,c=Math.round(a+d*s))}const Mo=(e,t,s)=>"top"===t||"left"===t?e[t]+s:e[t]-s,Ro=(e,t)=>Math.min(t||e,e);function Io(e,t){const s=[],n=e.length/t,i=e.length;let a=0;for(;a<i;a+=n)s.push(e[Math.floor(a)]);return s}function Do(e,t,s){const n=e.ticks.length,i=Math.min(t,n-1),a=e._startPixel,r=e._endPixel,o=1e-6;let l,c=e.getPixelForTick(i);if(!(s&&(l=1===n?Math.max(c-a,r-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(i-1))/2,c+=i<t?l:-l,c<a-o||c>r+o)))return c}function Lo(e){return e.drawTicks?e.tickLength:0}function Oo(e,t){if(!e.display)return 0;const s=ga(e.font,t),n=ma(e.padding);return(En(e.text)?e.text.length:1)*s.lineHeight+n.height}function Fo(e,t,s){let n=ki(e);return(s&&"right"!==t||!s&&"right"===t)&&(n=(e=>"left"===e?"right":"right"===e?"left":e)(n)),n}class zo extends No{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:s,_suggestedMax:n}=this;return e=Nn(e,Number.POSITIVE_INFINITY),t=Nn(t,Number.NEGATIVE_INFINITY),s=Nn(s,Number.POSITIVE_INFINITY),n=Nn(n,Number.NEGATIVE_INFINITY),{min:Nn(e,s),max:Nn(t,n),minDefined:jn(e),maxDefined:jn(t)}}getMinMax(e){let t,{min:s,max:n,minDefined:i,maxDefined:a}=this.getUserBounds();if(i&&a)return{min:s,max:n};const r=this.getMatchingVisibleMetas();for(let o=0,l=r.length;o<l;++o)t=r[o].controller.getMinMax(this,e),i||(s=Math.min(s,t.min)),a||(n=Math.max(n,t.max));return s=a&&s>n?n:s,n=i&&s>n?s:n,{min:Nn(s,Nn(n,s)),max:Nn(n,Nn(s,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Mn(this.options.beforeUpdate,[this])}update(e,t,s){const{beginAtZero:n,grace:i,ticks:a}=this.options,r=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,s){const{min:n,max:i}=e,a=Pn(t,(i-n)/2),r=(e,t)=>s&&0===e?0:e+t;return{min:r(n,-Math.abs(a)),max:r(i,a)}}(this,i,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=r<this.ticks.length;this._convertTicksToLabels(o?Io(this.ticks,r):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||"auto"===a.source)&&(this.ticks=To(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,s=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,s=!s),this._startPixel=e,this._endPixel=t,this._reversePixels=s,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Mn(this.options.afterUpdate,[this])}beforeSetDimensions(){Mn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Mn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Mn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Mn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let s,n,i;for(s=0,n=e.length;s<n;s++)i=e[s],i.label=Mn(t.callback,[i.value,s,e],this)}afterTickToLabelConversion(){Mn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Mn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,s=Ro(this.ticks.length,e.ticks.maxTicksLimit),n=t.minRotation||0,i=t.maxRotation;let a,r,o,l=n;if(!this._isVisible()||!t.display||n>=i||s<=1||!this.isHorizontal())return void(this.labelRotation=n);const c=this._getLabelSizes(),d=c.widest.width,h=c.highest.height,u=mi(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/s:u/(s-1),d+6>a&&(a=u/(s-(e.offset?.5:1)),r=this.maxHeight-Lo(e.grid)-t.padding-Oo(e.title,this.chart.options.font),o=Math.sqrt(d*d+h*h),l=li(Math.min(Math.asin(mi((c.highest.height+6)/a,-1,1)),Math.asin(mi(r/o,-1,1))-Math.asin(mi(h/o,-1,1)))),l=Math.max(n,Math.min(i,l))),this.labelRotation=l}afterCalculateLabelRotation(){Mn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Mn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:s,title:n,grid:i}}=this,a=this._isVisible(),r=this.isHorizontal();if(a){const a=Oo(n,t.options.font);if(r?(e.width=this.maxWidth,e.height=Lo(i)+a):(e.height=this.maxHeight,e.width=Lo(i)+a),s.display&&this.ticks.length){const{first:t,last:n,widest:i,highest:a}=this._getLabelSizes(),o=2*s.padding,l=oi(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(r){const t=s.mirror?0:d*i.width+c*a.height;e.height=Math.min(this.maxHeight,e.height+t+o)}else{const t=s.mirror?0:c*i.width+d*a.height;e.width=Math.min(this.maxWidth,e.width+t+o)}this._calculatePadding(t,n,d,c)}}this._handleMargins(),r?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,s,n){const{ticks:{align:i,padding:a},position:r}=this.options,o=0!==this.labelRotation,l="top"!==r&&"x"===this.axis;if(this.isHorizontal()){const r=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,h=0;o?l?(d=n*e.width,h=s*t.height):(d=s*e.height,h=n*t.width):"start"===i?h=t.width:"end"===i?d=e.width:"inner"!==i&&(d=e.width/2,h=t.width/2),this.paddingLeft=Math.max((d-r+a)*this.width/(this.width-r),0),this.paddingRight=Math.max((h-c+a)*this.width/(this.width-c),0)}else{let s=t.height/2,n=e.height/2;"start"===i?(s=0,n=e.height):"end"===i&&(s=t.height,n=0),this.paddingTop=s+a,this.paddingBottom=n+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Mn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,s;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,s=e.length;t<s;t++)kn(e[t].label)&&(e.splice(t,1),s--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let s=this.ticks;t<s.length&&(s=Io(s,t)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,s){const{ctx:n,_longestTextCache:i}=this,a=[],r=[],o=Math.floor(t/Ro(t,s));let l,c,d,h,u,p,f,m,g,b,v,y=0,x=0;for(l=0;l<t;l+=o){if(h=e[l].label,u=this._resolveTickFontOptions(l),n.font=p=u.string,f=i[p]=i[p]||{data:{},gc:[]},m=u.lineHeight,g=b=0,kn(h)||En(h)){if(En(h))for(c=0,d=h.length;c<d;++c)v=h[c],kn(v)||En(v)||(g=Xi(n,f.data,f.gc,g,v),b+=m)}else g=Xi(n,f.data,f.gc,g,h),b=m;a.push(g),r.push(b),y=Math.max(g,y),x=Math.max(b,x)}!function(e,t){Rn(e,(e=>{const s=e.gc,n=s.length/2;let i;if(n>t){for(i=0;i<n;++i)delete e.data[s[i]];s.splice(0,n)}}))}(i,t);const w=a.indexOf(y),_=r.indexOf(x),S=e=>({width:a[e]||0,height:r[e]||0});return{first:S(0),last:S(t-1),widest:S(w),highest:S(_),widths:a,heights:r}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return mi(this._alignToPixels?Ki(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const s=t[e];return s.$context||(s.$context=function(e,t,s){return va(e,{tick:s,index:t,type:"tick"})}(this.getContext(),e,s))}return this.$context||(this.$context=va(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=oi(this.labelRotation),s=Math.abs(Math.cos(t)),n=Math.abs(Math.sin(t)),i=this._getLabelSizes(),a=e.autoSkipPadding||0,r=i?i.widest.width+a:0,o=i?i.highest.height+a:0;return this.isHorizontal()?o*s>r*n?r/s:o/n:o*n<r*s?o/s:r/n}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,s=this.chart,n=this.options,{grid:i,position:a,border:r}=n,o=i.offset,l=this.isHorizontal(),c=this.ticks.length+(o?1:0),d=Lo(i),h=[],u=r.setContext(this.getContext()),p=u.display?u.width:0,f=p/2,m=function(e){return Ki(s,e,p)};let g,b,v,y,x,w,_,S,A,k,E,C;if("top"===a)g=m(this.bottom),w=this.bottom-d,S=g-f,k=m(e.top)+f,C=e.bottom;else if("bottom"===a)g=m(this.top),k=e.top,C=m(e.bottom)-f,w=g+f,S=this.top+d;else if("left"===a)g=m(this.right),x=this.right-d,_=g-f,A=m(e.left)+f,E=e.right;else if("right"===a)g=m(this.left),A=e.left,E=m(e.right)-f,x=g+f,_=this.left+d;else if("x"===t){if("center"===a)g=m((e.top+e.bottom)/2+.5);else if(Cn(a)){const e=Object.keys(a)[0],t=a[e];g=m(this.chart.scales[e].getPixelForValue(t))}k=e.top,C=e.bottom,w=g+f,S=w+d}else if("y"===t){if("center"===a)g=m((e.left+e.right)/2);else if(Cn(a)){const e=Object.keys(a)[0],t=a[e];g=m(this.chart.scales[e].getPixelForValue(t))}x=g-f,_=x-d,A=e.left,E=e.right}const j=Tn(n.ticks.maxTicksLimit,c),N=Math.max(1,Math.ceil(c/j));for(b=0;b<c;b+=N){const e=this.getContext(b),t=i.setContext(e),n=r.setContext(e),a=t.lineWidth,c=t.color,d=n.dash||[],u=n.dashOffset,p=t.tickWidth,f=t.tickColor,m=t.tickBorderDash||[],g=t.tickBorderDashOffset;v=Do(this,b,o),void 0!==v&&(y=Ki(s,v,a),l?x=_=A=E=y:w=S=k=C=y,h.push({tx1:x,ty1:w,tx2:_,ty2:S,x1:A,y1:k,x2:E,y2:C,width:a,color:c,borderDash:d,borderDashOffset:u,tickWidth:p,tickColor:f,tickBorderDash:m,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,h}_computeLabelItems(e){const t=this.axis,s=this.options,{position:n,ticks:i}=s,a=this.isHorizontal(),r=this.ticks,{align:o,crossAlign:l,padding:c,mirror:d}=i,h=Lo(s.grid),u=h+c,p=d?-c:u,f=-oi(this.labelRotation),m=[];let g,b,v,y,x,w,_,S,A,k,E,C,j="middle";if("top"===n)w=this.bottom-p,_=this._getXAxisLabelAlignment();else if("bottom"===n)w=this.top+p,_=this._getXAxisLabelAlignment();else if("left"===n){const e=this._getYAxisLabelAlignment(h);_=e.textAlign,x=e.x}else if("right"===n){const e=this._getYAxisLabelAlignment(h);_=e.textAlign,x=e.x}else if("x"===t){if("center"===n)w=(e.top+e.bottom)/2+u;else if(Cn(n)){const e=Object.keys(n)[0],t=n[e];w=this.chart.scales[e].getPixelForValue(t)+u}_=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===n)x=(e.left+e.right)/2-u;else if(Cn(n)){const e=Object.keys(n)[0],t=n[e];x=this.chart.scales[e].getPixelForValue(t)}_=this._getYAxisLabelAlignment(h).textAlign}"y"===t&&("start"===o?j="top":"end"===o&&(j="bottom"));const N=this._getLabelSizes();for(g=0,b=r.length;g<b;++g){v=r[g],y=v.label;const e=i.setContext(this.getContext(g));S=this.getPixelForTick(g)+i.labelOffset,A=this._resolveTickFontOptions(g),k=A.lineHeight,E=En(y)?y.length:1;const t=E/2,s=e.color,o=e.textStrokeColor,c=e.textStrokeWidth;let h,u=_;if(a?(x=S,"inner"===_&&(u=g===b-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),C="top"===n?"near"===l||0!==f?-E*k+k/2:"center"===l?-N.highest.height/2-t*k+k:-N.highest.height+k/2:"near"===l||0!==f?k/2:"center"===l?N.highest.height/2-t*k:N.highest.height-E*k,d&&(C*=-1),0===f||e.showLabelBackdrop||(x+=k/2*Math.sin(f))):(w=S,C=(1-E)*k/2),e.showLabelBackdrop){const t=ma(e.backdropPadding),s=N.heights[g],n=N.widths[g];let i=C-t.top,a=0-t.left;switch(j){case"middle":i-=s/2;break;case"bottom":i-=s}switch(_){case"center":a-=n/2;break;case"right":a-=n;break;case"inner":g===b-1?a-=n:g>0&&(a-=n/2)}h={left:a,top:i,width:n+t.width,height:s+t.height,color:e.backdropColor}}m.push({label:y,font:A,textOffset:C,options:{rotation:f,color:s,strokeColor:o,strokeWidth:c,textAlign:u,textBaseline:j,translation:[x,w],backdrop:h}})}return m}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-oi(this.labelRotation))return"top"===e?"left":"right";let s="center";return"start"===t.align?s="left":"end"===t.align?s="right":"inner"===t.align&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:s,mirror:n,padding:i}}=this.options,a=e+i,r=this._getLabelSizes().widest.width;let o,l;return"left"===t?n?(l=this.right+i,"near"===s?o="left":"center"===s?(o="center",l+=r/2):(o="right",l+=r)):(l=this.right-a,"near"===s?o="right":"center"===s?(o="center",l-=r/2):(o="left",l=this.left)):"right"===t?n?(l=this.left+i,"near"===s?o="right":"center"===s?(o="center",l-=r/2):(o="left",l-=r)):(l=this.left+a,"near"===s?o="left":"center"===s?(o="center",l+=r/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:s,top:n,width:i,height:a}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(s,n,i,a),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex((t=>t.value===e));if(s>=0){return t.setContext(this.getContext(s)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,s=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,a;const r=(e,t,n)=>{n.width&&n.color&&(s.save(),s.lineWidth=n.width,s.strokeStyle=n.color,s.setLineDash(n.borderDash||[]),s.lineDashOffset=n.borderDashOffset,s.beginPath(),s.moveTo(e.x,e.y),s.lineTo(t.x,t.y),s.stroke(),s.restore())};if(t.display)for(i=0,a=n.length;i<a;++i){const e=n[i];t.drawOnChartArea&&r({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&r({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:s,grid:n}}=this,i=s.setContext(this.getContext()),a=s.display?i.width:0;if(!a)return;const r=n.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,d,h;this.isHorizontal()?(l=Ki(e,this.left,a)-a/2,c=Ki(e,this.right,r)+r/2,d=h=o):(d=Ki(e,this.top,a)-a/2,h=Ki(e,this.bottom,r)+r/2,l=c=o),t.save(),t.lineWidth=i.width,t.strokeStyle=i.color,t.beginPath(),t.moveTo(l,d),t.lineTo(c,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,s=this._computeLabelArea();s&&ta(t,s);const n=this.getLabelItems(e);for(const i of n){const e=i.options,s=i.font;oa(t,i.label,0,i.textOffset,s,e)}s&&sa(t)}drawTitle(){const{ctx:e,options:{position:t,title:s,reverse:n}}=this;if(!s.display)return;const i=ga(s.font),a=ma(s.padding),r=s.align;let o=i.lineHeight/2;"bottom"===t||"center"===t||Cn(t)?(o+=a.bottom,En(s.text)&&(o+=i.lineHeight*(s.text.length-1))):o+=a.top;const{titleX:l,titleY:c,maxWidth:d,rotation:h}=function(e,t,s,n){const{top:i,left:a,bottom:r,right:o,chart:l}=e,{chartArea:c,scales:d}=l;let h,u,p,f=0;const m=r-i,g=o-a;if(e.isHorizontal()){if(u=Ei(n,a,o),Cn(s)){const e=Object.keys(s)[0],n=s[e];p=d[e].getPixelForValue(n)+m-t}else p="center"===s?(c.bottom+c.top)/2+m-t:Mo(e,s,t);h=o-a}else{if(Cn(s)){const e=Object.keys(s)[0],n=s[e];u=d[e].getPixelForValue(n)-g+t}else u="center"===s?(c.left+c.right)/2-g+t:Mo(e,s,t);p=Ei(n,r,i),f="left"===s?-Qn:Qn}return{titleX:u,titleY:p,maxWidth:h,rotation:f}}(this,o,t,r);oa(e,s.text,0,0,i,{color:s.color,maxWidth:d,rotation:h,textAlign:Fo(r,t,n),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,s=Tn(e.grid&&e.grid.z,-1),n=Tn(e.border&&e.border.z,0);return this._isVisible()&&this.draw===zo.prototype.draw?[{z:s,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",n=[];let i,a;for(i=0,a=t.length;i<a;++i){const a=t[i];a[s]!==this.id||e&&a.type!==e||n.push(a)}return n}_resolveTickFontOptions(e){return ga(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class $o{constructor(e,t,s){this.type=e,this.scope=t,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let s;(function(e){return"id"in e&&"defaults"in e})(t)&&(s=this.register(t));const n=this.items,i=e.id,a=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in n||(n[i]=e,function(e,t,s){const n=Fn(Object.create(null),[s?Gi.get(s):{},Gi.get(t),e.defaults]);Gi.set(t,n),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((s=>{const n=s.split("."),i=n.pop(),a=[e].concat(n).join("."),r=t[s].split("."),o=r.pop(),l=r.join(".");Gi.route(a,i,l,o)}))}(t,e.defaultRoutes);e.descriptors&&Gi.describe(t,e.descriptors)}(e,a,s),this.override&&Gi.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,s=e.id,n=this.scope;s in t&&delete t[s],n&&s in Gi[n]&&(delete Gi[n][s],this.override&&delete Hi[s])}}class Bo{constructor(){this.controllers=new $o(jr,"datasets",!0),this.elements=new $o(No,"elements"),this.plugins=new $o(Object,"plugins"),this.scales=new $o(zo,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t,this.scales)}_each(e,t,s){[...t].forEach((t=>{const n=s||this._getRegistryForType(t);s||n.isForType(t)||n===this.plugins&&t.id?this._exec(e,n,t):Rn(t,(t=>{const n=s||this._getRegistryForType(t);this._exec(e,n,t)}))}))}_exec(e,t,s){const n=Un(e);Mn(s["before"+n],[],s),t[e](s),Mn(s["after"+n],[],s)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const s=this._typedRegistries[t];if(s.isForType(e))return s}return this.plugins}_get(e,t,s){const n=t.get(e);if(void 0===n)throw new Error('"'+e+'" is not a registered '+s+".");return n}}var Ho=new Bo;class Uo{constructor(){this._init=[]}notify(e,t,s,n){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const i=n?this._descriptors(e).filter(n):this._descriptors(e),a=this._notify(i,e,t,s);return"afterDestroy"===t&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,t,s,n){n=n||{};for(const i of e){const e=i.plugin;if(!1===Mn(e[s],[t,n,i.options],e)&&n.cancelable)return!1}return!0}invalidate(){kn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const s=e&&e.config,n=Tn(s.options&&s.options.plugins,{}),i=function(e){const t={},s=[],n=Object.keys(Ho.plugins.items);for(let a=0;a<n.length;a++)s.push(Ho.getPlugin(n[a]));const i=e.plugins||[];for(let a=0;a<i.length;a++){const e=i[a];-1===s.indexOf(e)&&(s.push(e),t[e.id]=!0)}return{plugins:s,localIds:t}}(s);return!1!==n||t?function(e,t,s,n){let{plugins:i,localIds:a}=t;const r=[],o=e.getContext();for(const l of i){const t=l.id,i=Vo(s[t],n);null!==i&&r.push({plugin:l,options:Wo(e.config,{plugin:l,local:a[t]},i,o)})}return r}(e,i,n,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],s=this._cache,n=(e,t)=>e.filter((e=>!t.some((t=>e.plugin.id===t.plugin.id))));this._notify(n(t,s),e,"stop"),this._notify(n(s,t),e,"start")}}function Vo(e,t){return t||!1!==e?!0===e?{}:e:null}function Wo(e,t,s,n){let{plugin:i,local:a}=t;const r=e.pluginScopeKeys(i),o=e.getOptionScopes(s,r);return a&&i.defaults&&o.push(i.defaults),e.createResolver(o,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function qo(e,t){const s=Gi.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||s.indexAxis||"x"}function Go(e){if("x"===e||"y"===e||"r"===e)return e}function Xo(e){if(Go(e))return e;for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];for(const a of s){const t=a.axis||("top"===(i=a.position)||"bottom"===i?"x":"left"===i||"right"===i?"y":void 0)||e.length>1&&Go(e[0].toLowerCase());if(t)return t}var i;throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function Yo(e,t,s){if(s[t+"AxisID"]===e)return{axis:t}}function Ko(e,t){const s=Hi[e.type]||{scales:{}},n=t.scales||{},i=qo(e.type,t),a=Object.create(null);return Object.keys(n).forEach((t=>{const r=n[t];if(!Cn(r))return console.error(`Invalid scale configuration for scale: ${t}`);if(r._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const o=Xo(t,r,function(e,t){if(t.data&&t.data.datasets){const s=t.data.datasets.filter((t=>t.xAxisID===e||t.yAxisID===e));if(s.length)return Yo(e,"x",s[0])||Yo(e,"y",s[0])}return{}}(t,e),Gi.scales[r.type]),l=function(e,t){return e===t?"_index_":"_value_"}(o,i),c=s.scales||{};a[t]=zn(Object.create(null),[{axis:o},r,c[o],c[l]])})),e.data.datasets.forEach((s=>{const i=s.type||e.type,r=s.indexAxis||qo(i,t),o=(Hi[i]||{}).scales||{};Object.keys(o).forEach((e=>{const t=function(e,t){let s=e;return"_index_"===e?s=t:"_value_"===e&&(s="x"===t?"y":"x"),s}(e,r),i=s[t+"AxisID"]||t;a[i]=a[i]||Object.create(null),zn(a[i],[{axis:t},n[i],o[e]])}))})),Object.keys(a).forEach((e=>{const t=a[e];zn(t,[Gi.scales[t.type],Gi.scale])})),a}function Jo(e){const t=e.options||(e.options={});t.plugins=Tn(t.plugins,{}),t.scales=Ko(e,t)}function Qo(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Zo=new Map,el=new Set;function tl(e,t){let s=Zo.get(e);return s||(s=t(),Zo.set(e,s),el.add(s)),s}const sl=(e,t,s)=>{const n=Hn(t,s);void 0!==n&&e.add(n)};class nl{constructor(e){this._config=function(e){return(e=e||{}).data=Qo(e.data),Jo(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Qo(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Jo(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return tl(e,(()=>[[`datasets.${e}`,""]]))}datasetAnimationScopeKeys(e,t){return tl(`${e}.transition.${t}`,(()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]]))}datasetElementScopeKeys(e,t){return tl(`${e}-${t}`,(()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]]))}pluginScopeKeys(e){const t=e.id;return tl(`${this.type}-plugin-${t}`,(()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]]))}_cachedScopes(e,t){const s=this._scopeCache;let n=s.get(e);return n&&!t||(n=new Map,s.set(e,n)),n}getOptionScopes(e,t,s){const{options:n,type:i}=this,a=this._cachedScopes(e,s),r=a.get(t);if(r)return r;const o=new Set;t.forEach((t=>{e&&(o.add(e),t.forEach((t=>sl(o,e,t)))),t.forEach((e=>sl(o,n,e))),t.forEach((e=>sl(o,Hi[i]||{},e))),t.forEach((e=>sl(o,Gi,e))),t.forEach((e=>sl(o,Ui,e)))}));const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),el.has(t)&&a.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,Hi[t]||{},Gi.datasets[t]||{},{type:t},Gi,Ui]}resolveNamedOptions(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const i={$shared:!0},{resolver:a,subPrefixes:r}=il(this._resolverCache,e,n);let o=a;if(function(e,t){const{isScriptable:s,isIndexable:n}=wa(e);for(const i of t){const t=s(i),a=n(i),r=(a||t)&&e[i];if(t&&(Wn(r)||al(r))||a&&En(r))return!0}return!1}(a,t)){i.$shared=!1;o=xa(a,s=Wn(s)?s():s,this.createResolver(e,s,r))}for(const l of t)i[l]=o[l];return i}createResolver(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],n=arguments.length>3?arguments[3]:void 0;const{resolver:i}=il(this._resolverCache,e,s);return Cn(t)?xa(i,t,void 0,n):i}}function il(e,t,s){let n=e.get(t);n||(n=new Map,e.set(t,n));const i=s.join();let a=n.get(i);if(!a){a={resolver:ya(t,s),subPrefixes:s.filter((e=>!e.toLowerCase().includes("hover")))},n.set(i,a)}return a}const al=e=>Cn(e)&&Object.getOwnPropertyNames(e).some((t=>Wn(e[t])));const rl=["top","bottom","left","right","chartArea"];function ol(e,t){return"top"===e||"bottom"===e||-1===rl.indexOf(e)&&"x"===t}function ll(e,t){return function(s,n){return s[e]===n[e]?s[t]-n[t]:s[e]-n[e]}}function cl(e){const t=e.chart,s=t.options.animation;t.notifyPlugins("afterRender"),Mn(s&&s.onComplete,[e],t)}function dl(e){const t=e.chart,s=t.options.animation;Mn(s&&s.onProgress,[e],t)}function hl(e){return $a()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const ul={},pl=e=>{const t=hl(e);return Object.values(ul).filter((e=>e.canvas===t)).pop()};function fl(e,t,s){const n=Object.keys(e);for(const i of n){const n=+i;if(n>=t){const a=e[i];delete e[i],(s>0||n>t)&&(e[n+s]=a)}}}function ml(e,t,s){return e.options.clip?e[s]:t[s]}class gl{static defaults=(()=>Gi)();static instances=(()=>ul)();static overrides=(()=>Hi)();static registry=(()=>Ho)();static version="4.4.8";static getChart=(()=>pl)();static register(){Ho.add(...arguments),bl()}static unregister(){Ho.remove(...arguments),bl()}constructor(e,t){const s=this.config=new nl(t),n=hl(e),i=pl(n);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const a=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||function(e){return!$a()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?po:jo}(n)),this.platform.updateConfig(s);const r=this.platform.acquireContext(n,a.aspectRatio),o=r&&r.canvas,l=o&&o.height,c=o&&o.width;this.id=An(),this.ctx=r,this.canvas=o,this.width=c,this.height=l,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Uo,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let s;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t?(clearTimeout(s),s=setTimeout(e,t,i)):e.apply(this,i),t}}((e=>this.update(e)),a.resizeDelay||0),this._dataChanges=[],ul[this.id]=this,r&&o?(ur.listen(this,"complete",cl),ur.listen(this,"progress",dl),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:s,height:n,_aspectRatio:i}=this;return kn(e)?t&&i?i:n?s/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Ho}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Ya(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ji(this.canvas,this.ctx),this}stop(){return ur.stop(this),this}resize(e,t){ur.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const s=this.options,n=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(n,e,t,i),r=s.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,Ya(this,r,!0)&&(this.notifyPlugins("resize",{size:a}),Mn(s.onResize,[this,a],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){Rn(this.options.scales||{},((e,t)=>{e.id=t}))}buildOrUpdateScales(){const e=this.options,t=e.scales,s=this.scales,n=Object.keys(s).reduce(((e,t)=>(e[t]=!1,e)),{});let i=[];t&&(i=i.concat(Object.keys(t).map((e=>{const s=t[e],n=Xo(e,s),i="r"===n,a="x"===n;return{options:s,dposition:i?"chartArea":a?"bottom":"left",dtype:i?"radialLinear":a?"category":"linear"}})))),Rn(i,(t=>{const i=t.options,a=i.id,r=Xo(a,i),o=Tn(i.type,t.dtype);void 0!==i.position&&ol(i.position,r)===ol(t.dposition)||(i.position=t.dposition),n[a]=!0;let l=null;if(a in s&&s[a].type===o)l=s[a];else{l=new(Ho.getScale(o))({id:a,type:o,ctx:this.ctx,chart:this}),s[l.id]=l}l.init(i,e)})),Rn(n,((e,t)=>{e||delete s[t]})),Rn(s,(e=>{ho.configure(this,e,e.options),ho.addBox(this,e)}))}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,s=e.length;if(e.sort(((e,t)=>e.index-t.index)),s>t){for(let e=t;e<s;++e)this._destroyDatasetMeta(e);e.splice(t,s-t)}this._sortedMetasets=e.slice(0).sort(ll("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach(((e,s)=>{0===t.filter((t=>t===e._dataset)).length&&this._destroyDatasetMeta(s)}))}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let s,n;for(this._removeUnreferencedMetasets(),s=0,n=t.length;s<n;s++){const n=t[s];let i=this.getDatasetMeta(s);const a=n.type||this.config.type;if(i.type&&i.type!==a&&(this._destroyDatasetMeta(s),i=this.getDatasetMeta(s)),i.type=a,i.indexAxis=n.indexAxis||qo(a,this.options),i.order=n.order||0,i.index=s,i.label=""+n.label,i.visible=this.isDatasetVisible(s),i.controller)i.controller.updateIndex(s),i.controller.linkScales();else{const t=Ho.getController(a),{datasetElementType:n,dataElementType:r}=Gi.datasets[a];Object.assign(t,{dataElementType:Ho.getElement(r),datasetElementType:n&&Ho.getElement(n)}),i.controller=new t(this,s),e.push(i.controller)}}return this._updateMetasets(),e}_resetElements(){Rn(this.data.datasets,((e,t)=>{this.getDatasetMeta(t).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const s=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!n&&-1===i.indexOf(e);e.buildOrUpdateElements(t),a=Math.max(+e.getMaxOverflow(),a)}a=this._minPadding=s.layout.autoPadding?a:0,this._updateLayout(a),n||Rn(i,(e=>{e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(ll("z","_idx"));const{_active:r,_lastEvent:o}=this;o?this._eventHandler(o,!0):r.length&&this._updateHoverStyles(r,r,!0),this.render()}_updateScales(){Rn(this.scales,(e=>{ho.removeBox(this,e)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),s=new Set(e.events);qn(t,s)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:s,start:n,count:i}of t){fl(e,n,"_removeElements"===s?-i:i)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,s=t=>new Set(e.filter((e=>e[0]===t)).map(((e,t)=>t+","+e.splice(1).join(",")))),n=s(0);for(let i=1;i<t;i++)if(!qn(n,s(i)))return;return Array.from(n).map((e=>e.split(","))).map((e=>({method:e[1],start:+e[2],count:+e[3]})))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;ho.update(this,this.width,this.height,e);const t=this.chartArea,s=t.width<=0||t.height<=0;this._layers=[],Rn(this.boxes,(e=>{s&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))}),this),this._layers.forEach(((e,t)=>{e._idx=t})),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,s=this.data.datasets.length;t<s;++t)this._updateDataset(t,Wn(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const s=this.getDatasetMeta(e),n={meta:s,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",n)&&(s.controller._update(t),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(ur.has(this)?this.attached&&!ur.running(this)&&ur.start(this):(this.draw(),cl({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,s=[];let n,i;for(n=0,i=t.length;n<i;++n){const i=t[n];e&&!i.visible||s.push(i)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,s=e._clip,n=!s.disabled,i=function(e,t){const{xScale:s,yScale:n}=e;return s&&n?{left:ml(s,t,"left"),right:ml(s,t,"right"),top:ml(n,t,"top"),bottom:ml(n,t,"bottom")}:t}(e,this.chartArea),a={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",a)&&(n&&ta(t,{left:!1===s.left?0:i.left-s.left,right:!1===s.right?this.width:i.right+s.right,top:!1===s.top?0:i.top-s.top,bottom:!1===s.bottom?this.height:i.bottom+s.bottom}),e.controller.draw(),n&&sa(t),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(e){return ea(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,s,n){const i=Jr.modes[t];return"function"===typeof i?i(this,e,s,n):[]}getDatasetMeta(e){const t=this.data.datasets[e],s=this._metasets;let n=s.filter((e=>e&&e._dataset===t)).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},s.push(n)),n}getContext(){return this.$context||(this.$context=va(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const s=this.getDatasetMeta(e);return"boolean"===typeof s.hidden?!s.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,s){const n=s?"show":"hide",i=this.getDatasetMeta(e),a=i.controller._resolveAnimations(void 0,n);Vn(t)?(i.data[t].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),a.update(i,{visible:s}),this.update((t=>t.datasetIndex===e?n:void 0)))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ur.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Ji(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete ul[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,s=(s,n)=>{t.addEventListener(this,s,n),e[s]=n},n=(e,t,s)=>{e.offsetX=t,e.offsetY=s,this._eventHandler(e)};Rn(this.options.events,(e=>s(e,n)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,s=(s,n)=>{t.addEventListener(this,s,n),e[s]=n},n=(s,n)=>{e[s]&&(t.removeEventListener(this,s,n),delete e[s])},i=(e,t)=>{this.canvas&&this.resize(e,t)};let a;const r=()=>{n("attach",r),this.attached=!0,this.resize(),s("resize",i),s("detach",a)};a=()=>{this.attached=!1,n("resize",i),this._stop(),this._resize(0,0),s("attach",r)},t.isAttached(this.canvas)?r():a()}unbindEvents(){Rn(this._listeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._listeners={},Rn(this._responsiveListeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._responsiveListeners=void 0}updateHoverStyle(e,t,s){const n=s?"set":"remove";let i,a,r,o;for("dataset"===t&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+n+"DatasetHoverStyle"]()),r=0,o=e.length;r<o;++r){a=e[r];const t=a&&this.getDatasetMeta(a.datasetIndex).controller;t&&t[n+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],s=e.map((e=>{let{datasetIndex:t,index:s}=e;const n=this.getDatasetMeta(t);if(!n)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:n.data[s],index:s}}));!In(s,t)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,t))}notifyPlugins(e,t,s){return this._plugins.notify(this,e,t,s)}isPluginEnabled(e){return 1===this._plugins._cache.filter((t=>t.plugin.id===e)).length}_updateHoverStyles(e,t,s){const n=this.options.hover,i=(e,t)=>e.filter((e=>!t.some((t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)))),a=i(t,e),r=s?e:i(e,t);a.length&&this.updateHoverStyle(a,n.mode,!1),r.length&&n.mode&&this.updateHoverStyle(r,n.mode,!0)}_eventHandler(e,t){const s={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},n=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",s,n))return;const i=this._handleEvent(e,t,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,n),(i||s.changed)&&this.render(),this}_handleEvent(e,t,s){const{_active:n=[],options:i}=this,a=t,r=this._getActiveElements(e,n,s,a),o=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,s,n){return s&&"mouseout"!==e.type?n?t:e:null}(e,this._lastEvent,s,o);s&&(this._lastEvent=null,Mn(i.onHover,[e,r,this],this),o&&Mn(i.onClick,[e,r,this],this));const c=!In(r,n);return(c||t)&&(this._active=r,this._updateHoverStyles(r,n,t)),this._lastEvent=l,c}_getActiveElements(e,t,s,n){if("mouseout"===e.type)return[];if(!s)return t;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,n)}}function bl(){return Rn(gl.instances,(e=>e._plugins.invalidate()))}function vl(e,t,s,n){const i=ua(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const a=(s-t)/2,r=Math.min(a,n*t/2),o=e=>{const t=(s-Math.min(a,e))*n/2;return mi(e,0,Math.min(a,t))};return{outerStart:o(i.outerStart),outerEnd:o(i.outerEnd),innerStart:mi(i.innerStart,0,r),innerEnd:mi(i.innerEnd,0,r)}}function yl(e,t,s,n){return{x:s+e*Math.cos(t),y:n+e*Math.sin(t)}}function xl(e,t,s,n,i,a){const{x:r,y:o,startAngle:l,pixelMargin:c,innerRadius:d}=t,h=Math.max(t.outerRadius+n+s-c,0),u=d>0?d+n+s+c:0;let p=0;const f=i-l;if(n){const e=((d>0?d-n:0)+(h>0?h-n:0))/2;p=(f-(0!==e?f*e/(e+n):f))/2}const m=(f-Math.max(.001,f*h-s/Gn)/h)/2,g=l+m+p,b=i-m-p,{outerStart:v,outerEnd:y,innerStart:x,innerEnd:w}=vl(t,u,h,b-g),_=h-v,S=h-y,A=g+v/_,k=b-y/S,E=u+x,C=u+w,j=g+x/E,N=b-w/C;if(e.beginPath(),a){const t=(A+k)/2;if(e.arc(r,o,h,A,t),e.arc(r,o,h,t,k),y>0){const t=yl(S,k,r,o);e.arc(t.x,t.y,y,k,b+Qn)}const s=yl(C,b,r,o);if(e.lineTo(s.x,s.y),w>0){const t=yl(C,N,r,o);e.arc(t.x,t.y,w,b+Qn,N+Math.PI)}const n=(b-w/u+(g+x/u))/2;if(e.arc(r,o,u,b-w/u,n,!0),e.arc(r,o,u,n,g+x/u,!0),x>0){const t=yl(E,j,r,o);e.arc(t.x,t.y,x,j+Math.PI,g-Qn)}const i=yl(_,g,r,o);if(e.lineTo(i.x,i.y),v>0){const t=yl(_,A,r,o);e.arc(t.x,t.y,v,g-Qn,A)}}else{e.moveTo(r,o);const t=Math.cos(A)*h+r,s=Math.sin(A)*h+o;e.lineTo(t,s);const n=Math.cos(k)*h+r,i=Math.sin(k)*h+o;e.lineTo(n,i)}e.closePath()}function wl(e,t,s,n,i){const{fullCircles:a,startAngle:r,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:d,borderDash:h,borderDashOffset:u}=l,p="inner"===l.borderAlign;if(!c)return;e.setLineDash(h||[]),e.lineDashOffset=u,p?(e.lineWidth=2*c,e.lineJoin=d||"round"):(e.lineWidth=c,e.lineJoin=d||"bevel");let f=t.endAngle;if(a){xl(e,t,s,n,f,i);for(let t=0;t<a;++t)e.stroke();isNaN(o)||(f=r+(o%Xn||Xn))}p&&function(e,t,s){const{startAngle:n,pixelMargin:i,x:a,y:r,outerRadius:o,innerRadius:l}=t;let c=i/o;e.beginPath(),e.arc(a,r,o,n-c,s+c),l>i?(c=i/l,e.arc(a,r,l,s+c,n-c,!0)):e.arc(a,r,i,s+Qn,n-Qn),e.closePath(),e.clip()}(e,t,f),a||(xl(e,t,s,n,f,i),e.stroke())}class _l extends No{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,s){const n=this.getProps(["x","y"],s),{angle:i,distance:a}=di(n,{x:e,y:t}),{startAngle:r,endAngle:o,innerRadius:l,outerRadius:c,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),h=(this.options.spacing+this.options.borderWidth)/2,u=Tn(d,o-r),p=fi(i,r,o)&&r!==o,f=u>=Xn||p,m=gi(a,l+h,c+h);return f&&m}getCenterPoint(e){const{x:t,y:s,startAngle:n,endAngle:i,innerRadius:a,outerRadius:r}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:o,spacing:l}=this.options,c=(n+i)/2,d=(a+r+l+o)/2;return{x:t+Math.cos(c)*d,y:s+Math.sin(c)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:s}=this,n=(t.offset||0)/4,i=(t.spacing||0)/2,a=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=s>Xn?Math.floor(s/Xn):0,0===s||this.innerRadius<0||this.outerRadius<0)return;e.save();const r=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(r)*n,Math.sin(r)*n);const o=n*(1-Math.sin(Math.min(Gn,s||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,s,n,i){const{fullCircles:a,startAngle:r,circumference:o}=t;let l=t.endAngle;if(a){xl(e,t,s,n,l,i);for(let t=0;t<a;++t)e.fill();isNaN(o)||(l=r+(o%Xn||Xn))}xl(e,t,s,n,l,i),e.fill()}(e,this,o,i,a),wl(e,this,o,i,a),e.restore()}}function Sl(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=Tn(s.borderCapStyle,t.borderCapStyle),e.setLineDash(Tn(s.borderDash,t.borderDash)),e.lineDashOffset=Tn(s.borderDashOffset,t.borderDashOffset),e.lineJoin=Tn(s.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Tn(s.borderWidth,t.borderWidth),e.strokeStyle=Tn(s.borderColor,t.borderColor)}function Al(e,t,s){e.lineTo(s.x,s.y)}function kl(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=e.length,{start:i=0,end:a=n-1}=s,{start:r,end:o}=t,l=Math.max(i,r),c=Math.min(a,o),d=i<r&&a<r||i>o&&a>o;return{count:n,start:l,loop:t.loop,ilen:c<l&&!d?n+c-l:c-l}}function El(e,t,s,n){const{points:i,options:a}=t,{count:r,start:o,loop:l,ilen:c}=kl(i,s,n),d=function(e){return e.stepped?na:e.tension||"monotone"===e.cubicInterpolationMode?ia:Al}(a);let h,u,p,{move:f=!0,reverse:m}=n||{};for(h=0;h<=c;++h)u=i[(o+(m?c-h:h))%r],u.skip||(f?(e.moveTo(u.x,u.y),f=!1):d(e,p,u,m,a.stepped),p=u);return l&&(u=i[(o+(m?c:0))%r],d(e,p,u,m,a.stepped)),!!l}function Cl(e,t,s,n){const i=t.points,{count:a,start:r,ilen:o}=kl(i,s,n),{move:l=!0,reverse:c}=n||{};let d,h,u,p,f,m,g=0,b=0;const v=e=>(r+(c?o-e:e))%a,y=()=>{p!==f&&(e.lineTo(g,f),e.lineTo(g,p),e.lineTo(g,m))};for(l&&(h=i[v(0)],e.moveTo(h.x,h.y)),d=0;d<=o;++d){if(h=i[v(d)],h.skip)continue;const t=h.x,s=h.y,n=0|t;n===u?(s<p?p=s:s>f&&(f=s),g=(b*g+t)/++b):(y(),e.lineTo(t,s),u=n,b=0,p=f=s),m=s}y()}function jl(e){const t=e.options,s=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!s?Cl:El}const Nl="function"===typeof Path2D;function Tl(e,t,s,n){Nl&&!t.options.segment?function(e,t,s,n){let i=t._path;i||(i=t._path=new Path2D,t.path(i,s,n)&&i.closePath()),Sl(e,t.options),e.stroke(i)}(e,t,s,n):function(e,t,s,n){const{segments:i,options:a}=t,r=jl(t);for(const o of i)Sl(e,a,o.style),e.beginPath(),r(e,t,o,{start:s,end:s+n-1})&&e.closePath(),e.stroke()}(e,t,s,n)}class Pl extends No{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const s=this.options;if((s.tension||"monotone"===s.cubicInterpolationMode)&&!s.stepped&&!this._pointsUpdated){const n=s.spanGaps?this._loop:this._fullLoop;za(this._points,s,e,n,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const s=e.points,n=e.options.spanGaps,i=s.length;if(!i)return[];const a=!!e._loop,{start:r,end:o}=function(e,t,s,n){let i=0,a=t-1;if(s&&!n)for(;i<t&&!e[i].skip;)i++;for(;i<t&&e[i].skip;)i++;for(i%=t,s&&(a+=i);a>i&&e[a%t].skip;)a--;return a%=t,{start:i,end:a}}(s,i,a,n);return lr(e,!0===n?[{start:r,end:o,loop:a}]:function(e,t,s,n){const i=e.length,a=[];let r,o=t,l=e[t];for(r=t+1;r<=s;++r){const s=e[r%i];s.skip||s.stop?l.skip||(n=!1,a.push({start:t%i,end:(r-1)%i,loop:n}),t=o=s.stop?r:null):(o=r,l.skip&&(t=r)),l=s}return null!==o&&a.push({start:t%i,end:o%i,loop:n}),a}(s,r,o<r?o+i:o,!!e._fullLoop&&0===r&&o===i-1),s,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,s=e.length;return s&&t[e[s-1].end]}interpolate(e,t){const s=this.options,n=e[t],i=this.points,a=or(this,{property:t,start:n,end:n});if(!a.length)return;const r=[],o=function(e){return e.stepped?Za:e.tension||"monotone"===e.cubicInterpolationMode?er:Qa}(s);let l,c;for(l=0,c=a.length;l<c;++l){const{start:c,end:d}=a[l],h=i[c],u=i[d];if(h===u){r.push(h);continue}const p=o(h,u,Math.abs((n-h[t])/(u[t]-h[t])),s.stepped);p[t]=e[t],r.push(p)}return 1===r.length?r[0]:r}pathSegment(e,t,s){return jl(this)(e,this,t,s)}path(e,t,s){const n=this.segments,i=jl(this);let a=this._loop;t=t||0,s=s||this.points.length-t;for(const r of n)a&=i(e,this,r,{start:t,end:t+s-1});return!!a}draw(e,t,s,n){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),Tl(e,this,s,n),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Ml(e,t,s,n){const i=e.options,{[s]:a}=e.getProps([s],n);return Math.abs(t-a)<i.radius+i.hitRadius}class Rl extends No{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,s){const n=this.options,{x:i,y:a}=this.getProps(["x","y"],s);return Math.pow(e-i,2)+Math.pow(t-a,2)<Math.pow(n.hitRadius+n.radius,2)}inXRange(e,t){return Ml(this,e,"x",t)}inYRange(e,t){return Ml(this,e,"y",t)}getCenterPoint(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const s=this.options;this.skip||s.radius<.1||!ea(this,t,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,Qi(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Il(e,t){const{x:s,y:n,base:i,width:a,height:r}=e.getProps(["x","y","base","width","height"],t);let o,l,c,d,h;return e.horizontal?(h=r/2,o=Math.min(s,i),l=Math.max(s,i),c=n-h,d=n+h):(h=a/2,o=s-h,l=s+h,c=Math.min(n,i),d=Math.max(n,i)),{left:o,top:c,right:l,bottom:d}}function Dl(e,t,s,n){return e?0:mi(t,s,n)}function Ll(e){const t=Il(e),s=t.right-t.left,n=t.bottom-t.top,i=function(e,t,s){const n=e.options.borderWidth,i=e.borderSkipped,a=pa(n);return{t:Dl(i.top,a.top,0,s),r:Dl(i.right,a.right,0,t),b:Dl(i.bottom,a.bottom,0,s),l:Dl(i.left,a.left,0,t)}}(e,s/2,n/2),a=function(e,t,s){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),i=e.options.borderRadius,a=fa(i),r=Math.min(t,s),o=e.borderSkipped,l=n||Cn(i);return{topLeft:Dl(!l||o.top||o.left,a.topLeft,0,r),topRight:Dl(!l||o.top||o.right,a.topRight,0,r),bottomLeft:Dl(!l||o.bottom||o.left,a.bottomLeft,0,r),bottomRight:Dl(!l||o.bottom||o.right,a.bottomRight,0,r)}}(e,s/2,n/2);return{outer:{x:t.left,y:t.top,w:s,h:n,radius:a},inner:{x:t.left+i.l,y:t.top+i.t,w:s-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,a.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(i.b,i.r))}}}}function Ol(e,t,s,n){const i=null===t,a=null===s,r=e&&!(i&&a)&&Il(e,n);return r&&(i||gi(t,r.left,r.right))&&(a||gi(s,r.top,r.bottom))}function Fl(e,t){e.rect(t.x,t.y,t.w,t.h)}function zl(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=e.x!==s.x?-t:0,i=e.y!==s.y?-t:0,a=(e.x+e.w!==s.x+s.w?t:0)-n,r=(e.y+e.h!==s.y+s.h?t:0)-i;return{x:e.x+n,y:e.y+i,w:e.w+a,h:e.h+r,radius:e.radius}}class $l extends No{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:s,backgroundColor:n}}=this,{inner:i,outer:a}=Ll(this),r=(o=a.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?la:Fl;var o;e.save(),a.w===i.w&&a.h===i.h||(e.beginPath(),r(e,zl(a,t,i)),e.clip(),r(e,zl(i,-t,a)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),r(e,zl(i,t)),e.fillStyle=n,e.fill(),e.restore()}inRange(e,t,s){return Ol(this,e,t,s)}inXRange(e,t){return Ol(this,e,null,t)}inYRange(e,t){return Ol(this,null,e,t)}getCenterPoint(e){const{x:t,y:s,base:n,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(t+n)/2:t,y:i?s:(s+n)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}const Bl=(e,t)=>{let{boxHeight:s=t,boxWidth:n=t}=e;return e.usePointStyle&&(s=Math.min(s,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:s,itemHeight:Math.max(t,s)}};class Hl extends No{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,s){this.maxWidth=e,this.maxHeight=t,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Mn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter((t=>e.filter(t,this.chart.data)))),e.sort&&(t=t.sort(((t,s)=>e.sort(t,s,this.chart.data)))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const s=e.labels,n=ga(s.font),i=n.size,a=this._computeTitleHeight(),{boxWidth:r,itemHeight:o}=Bl(s,i);let l,c;t.font=n.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(a,i,r,o)+10):(c=this.maxHeight,l=this._fitCols(a,n,r,o)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,s,n){const{ctx:i,maxWidth:a,options:{labels:{padding:r}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=n+r;let d=e;i.textAlign="left",i.textBaseline="middle";let h=-1,u=-c;return this.legendItems.forEach(((e,p)=>{const f=s+t/2+i.measureText(e.text).width;(0===p||l[l.length-1]+f+2*r>a)&&(d+=c,l[l.length-(p>0?0:1)]=0,u+=c,h++),o[p]={left:0,top:u,row:h,width:f,height:n},l[l.length-1]+=f+r})),d}_fitCols(e,t,s,n){const{ctx:i,maxHeight:a,options:{labels:{padding:r}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=a-e;let d=r,h=0,u=0,p=0,f=0;return this.legendItems.forEach(((e,a)=>{const{itemWidth:m,itemHeight:g}=function(e,t,s,n,i){const a=function(e,t,s,n){let i=e.text;i&&"string"!==typeof i&&(i=i.reduce(((e,t)=>e.length>t.length?e:t)));return t+s.size/2+n.measureText(i).width}(n,e,t,s),r=function(e,t,s){let n=e;"string"!==typeof t.text&&(n=Ul(t,s));return n}(i,n,t.lineHeight);return{itemWidth:a,itemHeight:r}}(s,t,i,e,n);a>0&&u+g+2*r>c&&(d+=h+r,l.push({width:h,height:u}),p+=h+r,f++,h=u=0),o[a]={left:p,top:u,col:f,width:m,height:g},h=Math.max(h,m),u+=g+r})),d+=h,l.push({width:h,height:u}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:s,labels:{padding:n},rtl:i}}=this,a=tr(i,this.left,this.width);if(this.isHorizontal()){let i=0,r=Ei(s,this.left+n,this.right-this.lineWidths[i]);for(const o of t)i!==o.row&&(i=o.row,r=Ei(s,this.left+n,this.right-this.lineWidths[i])),o.top+=this.top+e+n,o.left=a.leftForLtr(a.x(r),o.width),r+=o.width+n}else{let i=0,r=Ei(s,this.top+e+n,this.bottom-this.columnSizes[i].height);for(const o of t)o.col!==i&&(i=o.col,r=Ei(s,this.top+e+n,this.bottom-this.columnSizes[i].height)),o.top=r,o.left+=this.left+n,o.left=a.leftForLtr(a.x(o.left),o.width),r+=o.height+n}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;ta(e,this),this._draw(),sa(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:s,ctx:n}=this,{align:i,labels:a}=e,r=Gi.color,o=tr(e.rtl,this.left,this.width),l=ga(a.font),{padding:c}=a,d=l.size,h=d/2;let u;this.drawTitle(),n.textAlign=o.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=l.string;const{boxWidth:p,boxHeight:f,itemHeight:m}=Bl(a,d),g=this.isHorizontal(),b=this._computeTitleHeight();u=g?{x:Ei(i,this.left+c,this.right-s[0]),y:this.top+c+b,line:0}:{x:this.left+c,y:Ei(i,this.top+b+c,this.bottom-t[0].height),line:0},sr(this.ctx,e.textDirection);const v=m+c;this.legendItems.forEach(((y,x)=>{n.strokeStyle=y.fontColor,n.fillStyle=y.fontColor;const w=n.measureText(y.text).width,_=o.textAlign(y.textAlign||(y.textAlign=a.textAlign)),S=p+h+w;let A=u.x,k=u.y;o.setWidth(this.width),g?x>0&&A+S+c>this.right&&(k=u.y+=v,u.line++,A=u.x=Ei(i,this.left+c,this.right-s[u.line])):x>0&&k+v>this.bottom&&(A=u.x=A+t[u.line].width+c,u.line++,k=u.y=Ei(i,this.top+b+c,this.bottom-t[u.line].height));if(function(e,t,s){if(isNaN(p)||p<=0||isNaN(f)||f<0)return;n.save();const i=Tn(s.lineWidth,1);if(n.fillStyle=Tn(s.fillStyle,r),n.lineCap=Tn(s.lineCap,"butt"),n.lineDashOffset=Tn(s.lineDashOffset,0),n.lineJoin=Tn(s.lineJoin,"miter"),n.lineWidth=i,n.strokeStyle=Tn(s.strokeStyle,r),n.setLineDash(Tn(s.lineDash,[])),a.usePointStyle){const r={radius:f*Math.SQRT2/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:i},l=o.xPlus(e,p/2);Zi(n,r,l,t+h,a.pointStyleWidth&&p)}else{const a=t+Math.max((d-f)/2,0),r=o.leftForLtr(e,p),l=fa(s.borderRadius);n.beginPath(),Object.values(l).some((e=>0!==e))?la(n,{x:r,y:a,w:p,h:f,radius:l}):n.rect(r,a,p,f),n.fill(),0!==i&&n.stroke()}n.restore()}(o.x(A),k,y),A=((e,t,s,n)=>e===(n?"left":"right")?s:"center"===e?(t+s)/2:t)(_,A+p+h,g?A+S:this.right,e.rtl),function(e,t,s){oa(n,s.text,e,t+m/2,l,{strikethrough:s.hidden,textAlign:o.textAlign(s.textAlign)})}(o.x(A),k,y),g)u.x+=S+c;else if("string"!==typeof y.text){const e=l.lineHeight;u.y+=Ul(y,e)+c}else u.y+=v})),nr(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,s=ga(t.font),n=ma(t.padding);if(!t.display)return;const i=tr(e.rtl,this.left,this.width),a=this.ctx,r=t.position,o=s.size/2,l=n.top+o;let c,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),c=this.top+l,d=Ei(e.align,d,this.right-h);else{const t=this.columnSizes.reduce(((e,t)=>Math.max(e,t.height)),0);c=l+Ei(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const u=Ei(r,d,d+h);a.textAlign=i.textAlign(ki(r)),a.textBaseline="middle",a.strokeStyle=t.color,a.fillStyle=t.color,a.font=s.string,oa(a,t.text,u,c,s)}_computeTitleHeight(){const e=this.options.title,t=ga(e.font),s=ma(e.padding);return e.display?t.lineHeight+s.height:0}_getLegendItemAt(e,t){let s,n,i;if(gi(e,this.left,this.right)&&gi(t,this.top,this.bottom))for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(n=i[s],gi(e,n.left,n.left+n.width)&&gi(t,n.top,n.top+n.height))return this.legendItems[s];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const s=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const a=this._hoveredItem,r=(i=s,null!==(n=a)&&null!==i&&n.datasetIndex===i.datasetIndex&&n.index===i.index);a&&!r&&Mn(t.onLeave,[e,a,this],this),this._hoveredItem=s,s&&!r&&Mn(t.onHover,[e,s,this],this)}else s&&Mn(t.onClick,[e,s,this],this);var n,i}}function Ul(e,t){return t*(e.text?e.text.length:0)}var Vl={id:"legend",_element:Hl,start(e,t,s){const n=e.legend=new Hl({ctx:e.ctx,options:s,chart:e});ho.configure(e,n,s),ho.addBox(e,n)},stop(e){ho.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,s){const n=e.legend;ho.configure(e,n,s),n.options=s},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,s){const n=t.datasetIndex,i=s.chart;i.isDatasetVisible(n)?(i.hide(n),t.hidden=!0):(i.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:s,pointStyle:n,textAlign:i,color:a,useBorderRadius:r,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map((e=>{const l=e.controller.getStyle(s?0:void 0),c=ma(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:a,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:n||l.pointStyle,rotation:l.rotation,textAlign:i||l.textAlign,borderRadius:r&&(o||l.borderRadius),datasetIndex:e.index}}),this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Wl extends No{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const s=this.options;if(this.left=0,this.top=0,!s.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const n=En(s.text)?s.text.length:1;this._padding=ma(s.padding);const i=n*ga(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=i:this.width=i}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:s,bottom:n,right:i,options:a}=this,r=a.align;let o,l,c,d=0;return this.isHorizontal()?(l=Ei(r,s,i),c=t+e,o=i-s):("left"===a.position?(l=s+e,c=Ei(r,n,t),d=-.5*Gn):(l=i-e,c=Ei(r,t,n),d=.5*Gn),o=n-t),{titleX:l,titleY:c,maxWidth:o,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const s=ga(t.font),n=s.lineHeight/2+this._padding.top,{titleX:i,titleY:a,maxWidth:r,rotation:o}=this._drawArgs(n);oa(e,t.text,0,0,s,{color:t.color,maxWidth:r,rotation:o,textAlign:ki(t.align),textBaseline:"middle",translation:[i,a]})}}var ql={id:"title",_element:Wl,start(e,t,s){!function(e,t){const s=new Wl({ctx:e.ctx,options:t,chart:e});ho.configure(e,s,t),ho.addBox(e,s),e.titleBlock=s}(e,s)},stop(e){const t=e.titleBlock;ho.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,s){const n=e.titleBlock;ho.configure(e,n,s),n.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const Gl={average(e){if(!e.length)return!1;let t,s,n=new Set,i=0,a=0;for(t=0,s=e.length;t<s;++t){const s=e[t].element;if(s&&s.hasValue()){const e=s.tooltipPosition();n.add(e.x),i+=e.y,++a}}if(0===a||0===n.size)return!1;return{x:[...n].reduce(((e,t)=>e+t))/n.size,y:i/a}},nearest(e,t){if(!e.length)return!1;let s,n,i,a=t.x,r=t.y,o=Number.POSITIVE_INFINITY;for(s=0,n=e.length;s<n;++s){const n=e[s].element;if(n&&n.hasValue()){const e=hi(t,n.getCenterPoint());e<o&&(o=e,i=n)}}if(i){const e=i.tooltipPosition();a=e.x,r=e.y}return{x:a,y:r}}};function Xl(e,t){return t&&(En(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Yl(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Kl(e,t){const{element:s,datasetIndex:n,index:i}=t,a=e.getDatasetMeta(n).controller,{label:r,value:o}=a.getLabelAndValue(i);return{chart:e,label:r,parsed:a.getParsed(i),raw:e.data.datasets[n].data[i],formattedValue:o,dataset:a.getDataset(),dataIndex:i,datasetIndex:n,element:s}}function Jl(e,t){const s=e.chart.ctx,{body:n,footer:i,title:a}=e,{boxWidth:r,boxHeight:o}=t,l=ga(t.bodyFont),c=ga(t.titleFont),d=ga(t.footerFont),h=a.length,u=i.length,p=n.length,f=ma(t.padding);let m=f.height,g=0,b=n.reduce(((e,t)=>e+t.before.length+t.lines.length+t.after.length),0);if(b+=e.beforeBody.length+e.afterBody.length,h&&(m+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),b){m+=p*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(b-p)*l.lineHeight+(b-1)*t.bodySpacing}u&&(m+=t.footerMarginTop+u*d.lineHeight+(u-1)*t.footerSpacing);let v=0;const y=function(e){g=Math.max(g,s.measureText(e).width+v)};return s.save(),s.font=c.string,Rn(e.title,y),s.font=l.string,Rn(e.beforeBody.concat(e.afterBody),y),v=t.displayColors?r+2+t.boxPadding:0,Rn(n,(e=>{Rn(e.before,y),Rn(e.lines,y),Rn(e.after,y)})),v=0,s.font=d.string,Rn(e.footer,y),s.restore(),g+=f.width,{width:g,height:m}}function Ql(e,t,s,n){const{x:i,width:a}=s,{width:r,chartArea:{left:o,right:l}}=e;let c="center";return"center"===n?c=i<=(o+l)/2?"left":"right":i<=a/2?c="left":i>=r-a/2&&(c="right"),function(e,t,s,n){const{x:i,width:a}=n,r=s.caretSize+s.caretPadding;return"left"===e&&i+a+r>t.width||"right"===e&&i-a-r<0||void 0}(c,e,t,s)&&(c="center"),c}function Zl(e,t,s){const n=s.yAlign||t.yAlign||function(e,t){const{y:s,height:n}=t;return s<n/2?"top":s>e.height-n/2?"bottom":"center"}(e,s);return{xAlign:s.xAlign||t.xAlign||Ql(e,t,s,n),yAlign:n}}function ec(e,t,s,n){const{caretSize:i,caretPadding:a,cornerRadius:r}=e,{xAlign:o,yAlign:l}=s,c=i+a,{topLeft:d,topRight:h,bottomLeft:u,bottomRight:p}=fa(r);let f=function(e,t){let{x:s,width:n}=e;return"right"===t?s-=n:"center"===t&&(s-=n/2),s}(t,o);const m=function(e,t,s){let{y:n,height:i}=e;return"top"===t?n+=s:n-="bottom"===t?i+s:i/2,n}(t,l,c);return"center"===l?"left"===o?f+=c:"right"===o&&(f-=c):"left"===o?f-=Math.max(d,u)+i:"right"===o&&(f+=Math.max(h,p)+i),{x:mi(f,0,n.width-t.width),y:mi(m,0,n.height-t.height)}}function tc(e,t,s){const n=ma(s.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-n.right:e.x+n.left}function sc(e){return Xl([],Yl(e))}function nc(e,t){const s=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return s?e.override(s):e}const ic={beforeTitle:Sn,title(e){if(e.length>0){const t=e[0],s=t.chart.data.labels,n=s?s.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return s[t.dataIndex]}return""},afterTitle:Sn,beforeBody:Sn,beforeLabel:Sn,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const s=e.formattedValue;return kn(s)||(t+=s),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Sn,afterBody:Sn,beforeFooter:Sn,footer:Sn,afterFooter:Sn};function ac(e,t,s,n){const i=e[t].call(s,n);return"undefined"===typeof i?ic[t].call(s,n):i}class rc extends No{static positioners=(()=>Gl)();constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,s=this.options.setContext(this.getContext()),n=s.enabled&&t.options.animation&&s.animations,i=new gr(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,s=this._tooltipItems,va(e,{tooltip:t,tooltipItems:s,type:"tooltip"})));var e,t,s}getTitle(e,t){const{callbacks:s}=t,n=ac(s,"beforeTitle",this,e),i=ac(s,"title",this,e),a=ac(s,"afterTitle",this,e);let r=[];return r=Xl(r,Yl(n)),r=Xl(r,Yl(i)),r=Xl(r,Yl(a)),r}getBeforeBody(e,t){return sc(ac(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:s}=t,n=[];return Rn(e,(e=>{const t={before:[],lines:[],after:[]},i=nc(s,e);Xl(t.before,Yl(ac(i,"beforeLabel",this,e))),Xl(t.lines,ac(i,"label",this,e)),Xl(t.after,Yl(ac(i,"afterLabel",this,e))),n.push(t)})),n}getAfterBody(e,t){return sc(ac(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:s}=t,n=ac(s,"beforeFooter",this,e),i=ac(s,"footer",this,e),a=ac(s,"afterFooter",this,e);let r=[];return r=Xl(r,Yl(n)),r=Xl(r,Yl(i)),r=Xl(r,Yl(a)),r}_createItems(e){const t=this._active,s=this.chart.data,n=[],i=[],a=[];let r,o,l=[];for(r=0,o=t.length;r<o;++r)l.push(Kl(this.chart,t[r]));return e.filter&&(l=l.filter(((t,n,i)=>e.filter(t,n,i,s)))),e.itemSort&&(l=l.sort(((t,n)=>e.itemSort(t,n,s)))),Rn(l,(t=>{const s=nc(e.callbacks,t);n.push(ac(s,"labelColor",this,t)),i.push(ac(s,"labelPointStyle",this,t)),a.push(ac(s,"labelTextColor",this,t))})),this.labelColors=n,this.labelPointStyles=i,this.labelTextColors=a,this.dataPoints=l,l}update(e,t){const s=this.options.setContext(this.getContext()),n=this._active;let i,a=[];if(n.length){const e=Gl[s.position].call(this,n,this._eventPosition);a=this._createItems(s),this.title=this.getTitle(a,s),this.beforeBody=this.getBeforeBody(a,s),this.body=this.getBody(a,s),this.afterBody=this.getAfterBody(a,s),this.footer=this.getFooter(a,s);const t=this._size=Jl(this,s),r=Object.assign({},e,t),o=Zl(this.chart,s,r),l=ec(s,r,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,i={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(i={opacity:0});this._tooltipItems=a,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,s,n){const i=this.getCaretPosition(e,s,n);t.lineTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3)}getCaretPosition(e,t,s){const{xAlign:n,yAlign:i}=this,{caretSize:a,cornerRadius:r}=s,{topLeft:o,topRight:l,bottomLeft:c,bottomRight:d}=fa(r),{x:h,y:u}=e,{width:p,height:f}=t;let m,g,b,v,y,x;return"center"===i?(y=u+f/2,"left"===n?(m=h,g=m-a,v=y+a,x=y-a):(m=h+p,g=m+a,v=y-a,x=y+a),b=m):(g="left"===n?h+Math.max(o,c)+a:"right"===n?h+p-Math.max(l,d)-a:this.caretX,"top"===i?(v=u,y=v-a,m=g-a,b=g+a):(v=u+f,y=v+a,m=g+a,b=g-a),x=v),{x1:m,x2:g,x3:b,y1:v,y2:y,y3:x}}drawTitle(e,t,s){const n=this.title,i=n.length;let a,r,o;if(i){const l=tr(s.rtl,this.x,this.width);for(e.x=tc(this,s.titleAlign,s),t.textAlign=l.textAlign(s.titleAlign),t.textBaseline="middle",a=ga(s.titleFont),r=s.titleSpacing,t.fillStyle=s.titleColor,t.font=a.string,o=0;o<i;++o)t.fillText(n[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+r,o+1===i&&(e.y+=s.titleMarginBottom-r)}}_drawColorBox(e,t,s,n,i){const a=this.labelColors[s],r=this.labelPointStyles[s],{boxHeight:o,boxWidth:l}=i,c=ga(i.bodyFont),d=tc(this,"left",i),h=n.x(d),u=o<c.lineHeight?(c.lineHeight-o)/2:0,p=t.y+u;if(i.usePointStyle){const t={radius:Math.min(l,o)/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:1},s=n.leftForLtr(h,l)+l/2,c=p+o/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,Qi(e,t,s,c),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,Qi(e,t,s,c)}else{e.lineWidth=Cn(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const t=n.leftForLtr(h,l),s=n.leftForLtr(n.xPlus(h,1),l-2),r=fa(a.borderRadius);Object.values(r).some((e=>0!==e))?(e.beginPath(),e.fillStyle=i.multiKeyBackground,la(e,{x:t,y:p,w:l,h:o,radius:r}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),la(e,{x:s,y:p+1,w:l-2,h:o-2,radius:r}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(t,p,l,o),e.strokeRect(t,p,l,o),e.fillStyle=a.backgroundColor,e.fillRect(s,p+1,l-2,o-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,t,s){const{body:n}=this,{bodySpacing:i,bodyAlign:a,displayColors:r,boxHeight:o,boxWidth:l,boxPadding:c}=s,d=ga(s.bodyFont);let h=d.lineHeight,u=0;const p=tr(s.rtl,this.x,this.width),f=function(s){t.fillText(s,p.x(e.x+u),e.y+h/2),e.y+=h+i},m=p.textAlign(a);let g,b,v,y,x,w,_;for(t.textAlign=a,t.textBaseline="middle",t.font=d.string,e.x=tc(this,m,s),t.fillStyle=s.bodyColor,Rn(this.beforeBody,f),u=r&&"right"!==m?"center"===a?l/2+c:l+2+c:0,y=0,w=n.length;y<w;++y){for(g=n[y],b=this.labelTextColors[y],t.fillStyle=b,Rn(g.before,f),v=g.lines,r&&v.length&&(this._drawColorBox(t,e,y,p,s),h=Math.max(d.lineHeight,o)),x=0,_=v.length;x<_;++x)f(v[x]),h=d.lineHeight;Rn(g.after,f)}u=0,h=d.lineHeight,Rn(this.afterBody,f),e.y-=i}drawFooter(e,t,s){const n=this.footer,i=n.length;let a,r;if(i){const o=tr(s.rtl,this.x,this.width);for(e.x=tc(this,s.footerAlign,s),e.y+=s.footerMarginTop,t.textAlign=o.textAlign(s.footerAlign),t.textBaseline="middle",a=ga(s.footerFont),t.fillStyle=s.footerColor,t.font=a.string,r=0;r<i;++r)t.fillText(n[r],o.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+s.footerSpacing}}drawBackground(e,t,s,n){const{xAlign:i,yAlign:a}=this,{x:r,y:o}=e,{width:l,height:c}=s,{topLeft:d,topRight:h,bottomLeft:u,bottomRight:p}=fa(n.cornerRadius);t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.beginPath(),t.moveTo(r+d,o),"top"===a&&this.drawCaret(e,t,s,n),t.lineTo(r+l-h,o),t.quadraticCurveTo(r+l,o,r+l,o+h),"center"===a&&"right"===i&&this.drawCaret(e,t,s,n),t.lineTo(r+l,o+c-p),t.quadraticCurveTo(r+l,o+c,r+l-p,o+c),"bottom"===a&&this.drawCaret(e,t,s,n),t.lineTo(r+u,o+c),t.quadraticCurveTo(r,o+c,r,o+c-u),"center"===a&&"left"===i&&this.drawCaret(e,t,s,n),t.lineTo(r,o+d),t.quadraticCurveTo(r,o,r+d,o),t.closePath(),t.fill(),n.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,s=this.$animations,n=s&&s.x,i=s&&s.y;if(n||i){const s=Gl[e.position].call(this,this._active,this._eventPosition);if(!s)return;const a=this._size=Jl(this,e),r=Object.assign({},s,this._size),o=Zl(t,e,r),l=ec(e,r,o,t);n._to===l.x&&i._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=a.width,this.height=a.height,this.caretX=s.x,this.caretY=s.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(t);const n={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const a=ma(t.padding),r=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&r&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,n,t),sr(e,t.textDirection),i.y+=a.top,this.drawTitle(i,e,t),this.drawBody(i,e,t),this.drawFooter(i,e,t),nr(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const s=this._active,n=e.map((e=>{let{datasetIndex:t,index:s}=e;const n=this.chart.getDatasetMeta(t);if(!n)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:n.data[s],index:s}})),i=!In(s,n),a=this._positionChanged(n,t);(i||a)&&(this._active=n,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,i=this._active||[],a=this._getActiveElements(e,i,t,s),r=this._positionChanged(a,e),o=t||!In(a,i)||r;return o&&(this._active=a,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}_getActiveElements(e,t,s,n){const i=this.options;if("mouseout"===e.type)return[];if(!n)return t.filter((e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index)));const a=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&a.reverse(),a}_positionChanged(e,t){const{caretX:s,caretY:n,options:i}=this,a=Gl[i.position].call(this,e,t);return!1!==a&&(s!==a.x||n!==a.y)}}var oc={id:"tooltip",_element:rc,positioners:Gl,afterInit(e,t,s){s&&(e.tooltip=new rc({chart:e,options:s}))},beforeUpdate(e,t,s){e.tooltip&&e.tooltip.initialize(s)},reset(e,t,s){e.tooltip&&e.tooltip.initialize(s)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const s={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",{...s,cancelable:!0}))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",s)}},afterEvent(e,t){if(e.tooltip){const s=t.replay;e.tooltip.handleEvent(t.event,s,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:ic},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function lc(e,t,s,n){const i=e.indexOf(t);if(-1===i)return((e,t,s,n)=>("string"===typeof t?(s=e.push(t)-1,n.unshift({index:s,label:t})):isNaN(t)&&(s=null),s))(e,t,s,n);return i!==e.lastIndexOf(t)?s:i}function cc(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class dc extends zo{static id="category";static defaults=(()=>({ticks:{callback:cc}}))();constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:s,label:n}of t)e[s]===n&&e.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(kn(e))return null;const s=this.getLabels();return((e,t)=>null===e?null:mi(Math.round(e),0,t))(t=isFinite(t)&&s[t]===e?t:lc(s,e,Tn(t,e),this._addedLabels),s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:s,max:n}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(s=0),t||(n=this.getLabels().length-1)),this.min=s,this.max=n}buildTicks(){const e=this.min,t=this.max,s=this.options.offset,n=[];let i=this.getLabels();i=0===e&&t===i.length-1?i:i.slice(e,t+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let a=e;a<=t;a++)n.push({value:a});return n}getLabelForValue(e){return cc.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function hc(e,t){const s=[],{bounds:n,step:i,min:a,max:r,precision:o,count:l,maxTicks:c,maxDigits:d,includeBounds:h}=e,u=i||1,p=c-1,{min:f,max:m}=t,g=!kn(a),b=!kn(r),v=!kn(l),y=(m-f)/(d+1);let x,w,_,S,A=ii((m-f)/p/u)*u;if(A<1e-14&&!g&&!b)return[{value:f},{value:m}];S=Math.ceil(m/A)-Math.floor(f/A),S>p&&(A=ii(S*A/p/u)*u),kn(o)||(x=Math.pow(10,o),A=Math.ceil(A*x)/x),"ticks"===n?(w=Math.floor(f/A)*A,_=Math.ceil(m/A)*A):(w=f,_=m),g&&b&&i&&function(e,t){const s=Math.round(e);return s-t<=e&&s+t>=e}((r-a)/i,A/1e3)?(S=Math.round(Math.min((r-a)/A,c)),A=(r-a)/S,w=a,_=r):v?(w=g?a:w,_=b?r:_,S=l-1,A=(_-w)/S):(S=(_-w)/A,S=ni(S,Math.round(S),A/1e3)?Math.round(S):Math.ceil(S));const k=Math.max(ci(A),ci(w));x=Math.pow(10,kn(o)?k:o),w=Math.round(w*x)/x,_=Math.round(_*x)/x;let E=0;for(g&&(h&&w!==a?(s.push({value:a}),w<a&&E++,ni(Math.round((w+E*A)*x)/x,a,uc(a,y,e))&&E++):w<a&&E++);E<S;++E){const e=Math.round((w+E*A)*x)/x;if(b&&e>r)break;s.push({value:e})}return b&&h&&_!==r?s.length&&ni(s[s.length-1].value,r,uc(r,y,e))?s[s.length-1].value=r:s.push({value:r}):b&&_!==r||s.push({value:_}),s}function uc(e,t,s){let{horizontal:n,minRotation:i}=s;const a=oi(i),r=(n?Math.sin(a):Math.cos(a))||.001,o=.75*t*(""+e).length;return Math.min(t/r,o)}class pc extends zo{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return kn(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:s}=this.getUserBounds();let{min:n,max:i}=this;const a=e=>n=t?n:e,r=e=>i=s?i:e;if(e){const e=si(n),t=si(i);e<0&&t<0?r(0):e>0&&t>0&&a(0)}if(n===i){let t=0===i?1:Math.abs(.05*i);r(i+t),e||a(n-t)}this.min=n,this.max=i}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:s,stepSize:n}=e;return n?(t=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,t>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${t} ticks. Limiting to 1000.`),t=1e3)):(t=this.computeTickLimit(),s=s||11),s&&(t=Math.min(s,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const n=hc({maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&ri(n,this,"value"),e.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}configure(){const e=this.ticks;let t=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const n=(s-t)/Math.max(e.length-1,1)/2;t-=n,s+=n}this._startValue=t,this._endValue=s,this._valueRange=s-t}getLabelForValue(e){return zi(e,this.chart.options.locale,this.options.ticks.format)}}class fc extends pc{static id="linear";static defaults=(()=>({ticks:{callback:Bi.formatters.numeric}}))();determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=jn(e)?e:0,this.max=jn(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,s=oi(this.options.ticks.minRotation),n=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,i.lineHeight/n))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Bi.formatters.logarithmic;function mc(e){const t=e.ticks;if(t.display&&e.display){const e=ma(t.backdropPadding);return Tn(t.font&&t.font.size,Gi.font.size)+e.height}return 0}function gc(e,t,s,n,i){return e===n||e===i?{start:t-s/2,end:t+s/2}:e<n||e>i?{start:t-s,end:t}:{start:t,end:t+s}}function bc(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},s=Object.assign({},t),n=[],i=[],a=e._pointLabels.length,r=e.options.pointLabels,o=r.centerPointLabels?Gn/a:0;for(let h=0;h<a;h++){const a=r.setContext(e.getPointLabelContext(h));i[h]=a.padding;const u=e.getPointPosition(h,e.drawingArea+i[h],o),p=ga(a.font),f=(l=e.ctx,c=p,d=En(d=e._pointLabels[h])?d:[d],{w:Yi(l,c.string,d),h:d.length*c.lineHeight});n[h]=f;const m=pi(e.getIndexAngle(h)+o),g=Math.round(li(m));vc(s,t,m,gc(g,u.x,f.w,0,180),gc(g,u.y,f.h,90,270))}var l,c,d;e.setCenterPoint(t.l-s.l,s.r-t.r,t.t-s.t,s.b-t.b),e._pointLabelItems=function(e,t,s){const n=[],i=e._pointLabels.length,a=e.options,{centerPointLabels:r,display:o}=a.pointLabels,l={extra:mc(a)/2,additionalAngle:r?Gn/i:0};let c;for(let d=0;d<i;d++){l.padding=s[d],l.size=t[d];const i=yc(e,d,l);n.push(i),"auto"===o&&(i.visible=xc(i,c),i.visible&&(c=i))}return n}(e,n,i)}function vc(e,t,s,n,i){const a=Math.abs(Math.sin(s)),r=Math.abs(Math.cos(s));let o=0,l=0;n.start<t.l?(o=(t.l-n.start)/a,e.l=Math.min(e.l,t.l-o)):n.end>t.r&&(o=(n.end-t.r)/a,e.r=Math.max(e.r,t.r+o)),i.start<t.t?(l=(t.t-i.start)/r,e.t=Math.min(e.t,t.t-l)):i.end>t.b&&(l=(i.end-t.b)/r,e.b=Math.max(e.b,t.b+l))}function yc(e,t,s){const n=e.drawingArea,{extra:i,additionalAngle:a,padding:r,size:o}=s,l=e.getPointPosition(t,n+i+r,a),c=Math.round(li(pi(l.angle+Qn))),d=function(e,t,s){90===s||270===s?e-=t/2:(s>270||s<90)&&(e-=t);return e}(l.y,o.h,c),h=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),u=function(e,t,s){"right"===s?e-=t:"center"===s&&(e-=t/2);return e}(l.x,o.w,h);return{visible:!0,x:l.x,y:d,textAlign:h,left:u,top:d,right:u+o.w,bottom:d+o.h}}function xc(e,t){if(!t)return!0;const{left:s,top:n,right:i,bottom:a}=e;return!(ea({x:s,y:n},t)||ea({x:s,y:a},t)||ea({x:i,y:n},t)||ea({x:i,y:a},t))}function wc(e,t,s){const{left:n,top:i,right:a,bottom:r}=s,{backdropColor:o}=t;if(!kn(o)){const s=fa(t.borderRadius),l=ma(t.backdropPadding);e.fillStyle=o;const c=n-l.left,d=i-l.top,h=a-n+l.width,u=r-i+l.height;Object.values(s).some((e=>0!==e))?(e.beginPath(),la(e,{x:c,y:d,w:h,h:u,radius:s}),e.fill()):e.fillRect(c,d,h,u)}}function _c(e,t,s,n){const{ctx:i}=e;if(s)i.arc(e.xCenter,e.yCenter,t,0,Xn);else{let s=e.getPointPosition(0,t);i.moveTo(s.x,s.y);for(let a=1;a<n;a++)s=e.getPointPosition(a,t),i.lineTo(s.x,s.y)}}class Sc extends pc{static id="radialLinear";static defaults=(()=>({display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Bi.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}}))();static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ma(mc(this.options)/2),t=this.width=this.maxWidth-e.width,s=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+s/2+e.top),this.drawingArea=Math.floor(Math.min(t,s)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=jn(e)&&!isNaN(e)?e:0,this.max=jn(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/mc(this.options))}generateTickLabels(e){pc.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map(((e,t)=>{const s=Mn(this.options.pointLabels.callback,[e,t],this);return s||0===s?s:""})).filter(((e,t)=>this.chart.getDataVisibility(t)))}fit(){const e=this.options;e.display&&e.pointLabels.display?bc(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,s,n){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((s-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,s,n))}getIndexAngle(e){return pi(e*(Xn/(this._pointLabels.length||1))+oi(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(kn(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(kn(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const s=t[e];return function(e,t,s){return va(e,{label:s,index:t,type:"pointLabel"})}(this.getContext(),e,s)}}getPointPosition(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.getIndexAngle(e)-Qn+s;return{x:Math.cos(n)*t+this.xCenter,y:Math.sin(n)*t+this.yCenter,angle:n}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:s,right:n,bottom:i}=this._pointLabelItems[e];return{left:t,top:s,right:n,bottom:i}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const s=this.ctx;s.save(),s.beginPath(),_c(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),s.closePath(),s.fillStyle=e,s.fill(),s.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:s,grid:n,border:i}=t,a=this._pointLabels.length;let r,o,l;if(t.pointLabels.display&&function(e,t){const{ctx:s,options:{pointLabels:n}}=e;for(let i=t-1;i>=0;i--){const t=e._pointLabelItems[i];if(!t.visible)continue;const a=n.setContext(e.getPointLabelContext(i));wc(s,a,t);const r=ga(a.font),{x:o,y:l,textAlign:c}=t;oa(s,e._pointLabels[i],o,l+r.lineHeight/2,r,{color:a.color,textAlign:c,textBaseline:"middle"})}}(this,a),n.display&&this.ticks.forEach(((e,t)=>{if(0!==t||0===t&&this.min<0){o=this.getDistanceFromCenterForValue(e.value);const s=this.getContext(t),r=n.setContext(s),l=i.setContext(s);!function(e,t,s,n,i){const a=e.ctx,r=t.circular,{color:o,lineWidth:l}=t;!r&&!n||!o||!l||s<0||(a.save(),a.strokeStyle=o,a.lineWidth=l,a.setLineDash(i.dash||[]),a.lineDashOffset=i.dashOffset,a.beginPath(),_c(e,s,r,n),a.closePath(),a.stroke(),a.restore())}(this,r,o,a,l)}})),s.display){for(e.save(),r=a-1;r>=0;r--){const n=s.setContext(this.getPointLabelContext(r)),{color:i,lineWidth:a}=n;a&&i&&(e.lineWidth=a,e.strokeStyle=i,e.setLineDash(n.borderDash),e.lineDashOffset=n.borderDashOffset,o=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),l=this.getPointPosition(r,o),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,s=t.ticks;if(!s.display)return;const n=this.getIndexAngle(0);let i,a;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(n),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach(((n,r)=>{if(0===r&&this.min>=0&&!t.reverse)return;const o=s.setContext(this.getContext(r)),l=ga(o.font);if(i=this.getDistanceFromCenterForValue(this.ticks[r].value),o.showLabelBackdrop){e.font=l.string,a=e.measureText(n.label).width,e.fillStyle=o.backdropColor;const t=ma(o.backdropPadding);e.fillRect(-a/2-t.left,-i-l.size/2-t.top,a+t.width,l.size+t.height)}oa(e,n.label,0,-i,l,{color:o.color,strokeColor:o.textStrokeColor,strokeWidth:o.textStrokeWidth})})),e.restore()}drawTitle(){}}const Ac={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},kc=Object.keys(Ac);function Ec(e,t){return e-t}function Cc(e,t){if(kn(t))return null;const s=e._adapter,{parser:n,round:i,isoWeekday:a}=e._parseOpts;let r=t;return"function"===typeof n&&n(r),jn(r)||("string"===typeof n?s.parse(r,n):s.parse(r)),null===r?null:(i&&("week"!==i||!ai(a)&&!0!==a?s.startOf(r,i):s.startOf(r,"isoWeek",a)),+r)}function jc(e,t,s,n){const i=kc.length;for(let a=kc.indexOf(e);a<i-1;++a){const e=Ac[kc[a]],i=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((s-t)/(i*e.size))<=n)return kc[a]}return kc[i-1]}function Nc(e,t,s){if(s){if(s.length){const{lo:n,hi:i}=bi(s,t);e[s[n]>=t?s[n]:s[i]]=!0}}else e[t]=!0}function Tc(e,t,s){const n=[],i={},a=t.length;let r,o;for(0;r<a;++r)t[r],i[o]=r,n.push({value:o,major:!1});return 0!==a&&s?function(e,t,s,n){const i=e._adapter,a=+i.startOf(t[0].value,n),r=t[t.length-1].value;let o,l;for(a;o<=r;+i.add(o,1,n))s[o],l>=0&&(t[l].major=!0);return t}(e,n,i,s):n}class Pc extends zo{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=e.time||(e.time={}),n=this._adapter=new Vr(e.adapters.date);n.init(t),zn(s.displayFormats,n.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:Cc(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,s=e.time.unit||"day";let{min:n,max:i,minDefined:a,maxDefined:r}=this.getUserBounds();function o(e){a||isNaN(e.min)||Math.min(n,e.min),r||isNaN(e.max)||Math.max(i,e.max)}a&&r||(o(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||o(this.getMinMax(!1))),jn(n)&&!isNaN(n)?n:+t.startOf(Date.now(),s),jn(i)&&!isNaN(i)?i:+t.endOf(Date.now(),s)+1,this.min=Math.min(n,i-1),this.max=Math.max(n+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(e[0],e[e.length-1]),{min:t,max:s}}buildTicks(){const e=this.options,t=e.time,s=e.ticks,n="labels"===s.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const i=this.min,a=function(e,t,s){let n=0,i=e.length;for(;n<i&&e[n]<t;)0;for(;i>n&&e[i-1]>s;)0;return n>0||i<e.length?e.slice(n,i):e}(n,i,this.max);return this._unit=t.unit||(s.autoSkip?jc(t.minUnit,this.min,this.max,this._getLabelCapacity(i)):function(e,t,s,n,i){for(let a=kc.length-1;a>=kc.indexOf(s);a--){const s=kc[a];if(Ac[s].common&&e._adapter.diff(i,n,s)>=t-1)return s}return kc[s?kc.indexOf(s):0]}(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=s.major.enabled&&"year"!==this._unit?function(e){for(let t=kc.indexOf(e)+1,s=kc.length;t<s;++t)if(Ac[kc[t]].common)return kc[t]}(this._unit):void 0,this.initOffsets(n),e.reverse&&a.reverse(),Tc(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((e=>+e.value)))}initOffsets(){let e,t,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=0,i=0;this.options.offset&&s.length&&(this.getDecimalForValue(s[0]),1===s.length?1-e:(this.getDecimalForValue(s[1])-e)/2,this.getDecimalForValue(s[s.length-1]),1===s.length?t:(t-this.getDecimalForValue(s[s.length-2]))/2);const a=s.length<3?.5:.25;mi(n,0,a),mi(i,0,a),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const e=this._adapter,t=this.min,s=this.max,n=this.options,i=n.time,a=i.unit||jc(i.minUnit,t,s,this._getLabelCapacity(t)),r=Tn(n.ticks.stepSize,1),o="week"===a&&i.isoWeekday,l=ai(o)||!0===o,c={};let d,h,u=t;if(l&&+e.startOf(u,"isoWeek",o),+e.startOf(u,l?"day":a),e.diff(s,t,a)>1e5*r)throw new Error(t+" and "+s+" are too far apart with stepSize of "+r+" "+a);const p="data"===n.ticks.source&&this.getDataTimestamps();for(0;d<s;+e.add(d,r,a),h++)Nc(c,d,p);return d!==s&&"ticks"!==n.bounds&&1!==h||Nc(c,d,p),Object.keys(c).sort(Ec).map((e=>+e))}getLabelForValue(e){const t=this._adapter,s=this.options.time;return s.tooltipFormat?t.format(e,s.tooltipFormat):t.format(e,s.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,n=this._unit,i=t||s[n];return this._adapter.format(e,i)}_tickFormatFunction(e,t,s,n){const i=this.options,a=i.ticks.callback;if(a)return Mn(a,[e,t,s],this);const r=i.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&r[o],d=l&&r[l],h=s[t],u=l&&d&&h&&h.major;return this._adapter.format(e,n||(u?d:c))}generateTickLabels(e){let t,s,n;for(e.length;t<s;++t)e[t],n.label=this._tickFormatFunction(n.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+s)*t.factor)}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,s=this.ctx.measureText(e).width,n=oi(this.isHorizontal()?t.maxRotation:t.minRotation),i=Math.cos(n),a=Math.sin(n),r=this._resolveTickFontOptions(0).size;return{w:s*i+r*a,h:s*a+r*i}}_getLabelCapacity(e){const t=this.options.time,s=t.displayFormats,n=s[t.unit]||s.millisecond,i=this._tickFormatFunction(e,0,Tc(this,[e],this._majorUnit),n),a=this._getLabelSize(i),r=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return r>0?r:1}getDataTimestamps(){let e,t,s=this._cache.data||[];if(s.length)return s;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(n.length;e<t;++e)s.concat(n[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(s)}getLabelTimestamps(){const e=this._cache.labels||[];let t,s;if(e.length)return e;const n=this.getLabels();for(n.length;t<s;++t)e.push(Cc(this,n[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return _i(e.sort(Ec))}}gl.register(dc,fc,Rl,Pl,_l,ql,oc,Vl);const Mc=()=>{var e;const s=ee(),{user:n}=Ie(),[i,a]=(0,t.useState)(null),[r,o]=(0,t.useState)(!0),[l,c]=(0,t.useState)({vitals:[],medications:[],appointments:[],conditions:[],alerts:[],profile:null}),[d,h]=(0,t.useState)(null);(0,t.useEffect)((()=>{(async()=>{try{const{data:{user:e},error:t}=await Et.auth.getUser();if(t||!e)return void s("/");const{data:n,error:i}=await Et.from("detailed_profiles").select("*").eq("id",e.id).single();if(i){if("PGRST116"!==i.code)throw i;{const{data:t,error:s}=await Et.from("detailed_profiles").insert([{id:e.id}]).select().single();if(s)throw s;c((e=>({...e,profile:t})))}}else c((e=>({...e,profile:n})))}catch(d){console.error("Error fetching data:",d),h("Failed to load dashboard data")}finally{o(!1)}})()}),[s]);return r?(0,Me.jsx)(Hs,{}):d?(0,Me.jsx)("div",{className:"alert alert-danger",children:d}):(0,Me.jsxs)("div",{className:"dashboard container-fluid py-4",children:[(0,Me.jsx)("div",{className:"row mb-4",children:(0,Me.jsxs)("div",{className:"col",children:[(0,Me.jsxs)("h1",{className:"h3",children:["Welcome, ",(null===(e=l.profile)||void 0===e?void 0:e.first_name)||"User","!"]}),(0,Me.jsx)("p",{className:"text-muted",children:"Here's an overview of your health information"})]})}),(0,Me.jsx)("div",{className:"row mb-4"}),(0,Me.jsx)("h4",{className:"mb-3",children:"Main Features"}),(0,Me.jsx)("div",{className:"row g-4 mb-5",children:[{title:"Profile",icon:"fa-user",description:"View and manage your profile information",link:"/profile",color:"primary"},{title:"Health Records",icon:"fa-file-medical",description:"Access your health records and history",link:"/health-records",color:"info"},{title:"Appointments",icon:"fa-calendar-check",description:"Schedule and manage appointments",link:"/appointments",color:"success"},{title:"Medications",icon:"fa-pills",description:"Track your medications and prescriptions",link:"/medications",color:"warning"}].map(((e,t)=>(0,Me.jsx)("div",{className:"col-12 col-md-6 col-lg-3",children:(0,Me.jsx)(Ce,{to:e.link,className:"text-decoration-none",children:(0,Me.jsx)("div",{className:`card h-100 border-${e.color} shadow-sm hover-card`,children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,Me.jsx)("div",{className:`icon-circle bg-${e.color} text-white`,children:(0,Me.jsx)("i",{className:`fas ${e.icon}`})}),(0,Me.jsx)("h5",{className:"card-title mb-0 ms-3",children:e.title})]}),(0,Me.jsx)("p",{className:"card-text text-muted",children:e.description})]})})})},t)))}),(0,Me.jsx)("h4",{className:"mb-3",children:"AI-Powered Features"}),(0,Me.jsx)("div",{className:"row g-4 mb-5",children:[{title:"Health Recommendations",icon:"fa-chart-line",description:"AI-powered health recommendations based on your profile",link:"/ai/health-recommendations",color:"primary"},{title:"Medical Image Analysis",icon:"fa-microscope",description:"AI analysis of medical images",link:"/ai/image-analysis",color:"info"},{title:"Health Assistant",icon:"fa-robot",description:"Chat with our AI health assistant",link:"/ai/health-assistant",color:"success"},{title:"Symptom Checker",icon:"fa-stethoscope",description:"AI-powered symptom analysis",link:"/ai/symptom-checker",color:"danger"}].map(((e,t)=>(0,Me.jsx)("div",{className:"col-12 col-md-6 col-lg-3",children:(0,Me.jsx)(Ce,{to:e.link,className:"text-decoration-none",children:(0,Me.jsx)("div",{className:`card h-100 border-${e.color} shadow-sm hover-card`,children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,Me.jsx)("div",{className:`icon-circle bg-${e.color} text-white`,children:(0,Me.jsx)("i",{className:`fas ${e.icon}`})}),(0,Me.jsx)("h5",{className:"card-title mb-0 ms-3",children:e.title})]}),(0,Me.jsx)("p",{className:"card-text text-muted",children:e.description})]})})})},t)))}),(0,Me.jsx)("div",{className:"row mt-4",children:(0,Me.jsx)("div",{className:"col-12",children:(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h5",{className:"card-title",children:"Quick Actions"}),(0,Me.jsxs)("div",{className:"row g-2",children:[(0,Me.jsx)("div",{className:"col-6 col-md-3",children:(0,Me.jsxs)(Ce,{to:"/appointments/new",className:"btn btn-outline-primary w-100",children:[(0,Me.jsx)("i",{className:"fas fa-plus-circle me-2"}),"New Appointment"]})}),(0,Me.jsx)("div",{className:"col-6 col-md-3",children:(0,Me.jsxs)(Ce,{to:"/medications/add",className:"btn btn-outline-success w-100",children:[(0,Me.jsx)("i",{className:"fas fa-pills me-2"}),"Add Medication"]})}),(0,Me.jsx)("div",{className:"col-6 col-md-3",children:(0,Me.jsxs)(Ce,{to:"/reports/upload",className:"btn btn-outline-info w-100",children:[(0,Me.jsx)("i",{className:"fas fa-upload me-2"}),"Upload Report"]})}),(0,Me.jsx)("div",{className:"col-6 col-md-3",children:(0,Me.jsxs)(Ce,{to:"/ai/health-assistant",className:"btn btn-outline-danger w-100",children:[(0,Me.jsx)("i",{className:"fas fa-robot me-2"}),"AI Assistant"]})})]})]})})})})]})};var Rc=s(139),Ic=s.n(Rc);const Dc=["xxl","xl","lg","md","sm","xs"],Lc="xs",Oc=t.createContext({prefixes:{},breakpoints:Dc,minBreakpoint:Lc}),{Consumer:Fc,Provider:zc}=Oc;function $c(e,s){const{prefixes:n}=(0,t.useContext)(Oc);return e||n[s]||s}function Bc(){const{breakpoints:e}=(0,t.useContext)(Oc);return e}function Hc(){const{minBreakpoint:e}=(0,t.useContext)(Oc);return e}const Uc=t.forwardRef(((e,t)=>{let{bsPrefix:s,fluid:n=!1,as:i="div",className:a,...r}=e;const o=$c(s,"container"),l="string"===typeof n?`-${n}`:"-fluid";return(0,Me.jsx)(i,{ref:t,...r,className:Ic()(a,n?`${o}${l}`:o)})}));Uc.displayName="Container";const Vc=Uc,Wc=["as","disabled"];function qc(e){let{tagName:t,disabled:s,href:n,target:i,rel:a,role:r,onClick:o,tabIndex:l=0,type:c}=e;t||(t=null!=n||null!=i||null!=a?"a":"button");const d={tagName:t};if("button"===t)return[{type:c||"button",disabled:s},d];const h=e=>{(s||"a"===t&&function(e){return!e||"#"===e.trim()}(n))&&e.preventDefault(),s?e.stopPropagation():null==o||o(e)};return"a"===t&&(n||(n="#"),s&&(n=void 0)),[{role:null!=r?r:"button",disabled:void 0,tabIndex:s?void 0:l,href:n,target:"a"===t?i:void 0,"aria-disabled":s||void 0,rel:"a"===t?a:void 0,onClick:h,onKeyDown:e=>{" "===e.key&&(e.preventDefault(),h(e))}},d]}const Gc=t.forwardRef(((e,t)=>{let{as:s,disabled:n}=e,i=function(e,t){if(null==e)return{};var s={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;s[n]=e[n]}return s}(e,Wc);const[a,{tagName:r}]=qc(Object.assign({tagName:s,disabled:n},i));return(0,Me.jsx)(r,Object.assign({},i,a,{ref:t}))}));Gc.displayName="Button";const Xc=t.forwardRef(((e,t)=>{let{as:s,bsPrefix:n,variant:i="primary",size:a,active:r=!1,disabled:o=!1,className:l,...c}=e;const d=$c(n,"btn"),[h,{tagName:u}]=qc({tagName:s,disabled:o,...c}),p=u;return(0,Me.jsx)(p,{...h,...c,ref:t,disabled:o,className:Ic()(l,d,r&&"active",i&&`${d}-${i}`,a&&`${d}-${a}`,c.href&&o&&"disabled")})}));Xc.displayName="Button";const Yc=Xc,Kc=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:n,as:i="div",...a}=e;const r=$c(s,"row"),o=Bc(),l=Hc(),c=`${r}-cols`,d=[];return o.forEach((e=>{const t=a[e];let s;delete a[e],null!=t&&"object"===typeof t?({cols:s}=t):s=t;const n=e!==l?`-${e}`:"";null!=s&&d.push(`${c}${n}-${s}`)})),(0,Me.jsx)(i,{ref:t,...a,className:Ic()(n,r,...d)})}));Kc.displayName="Row";const Jc=Kc;const Qc=t.forwardRef(((e,t)=>{const[{className:s,...n},{as:i="div",bsPrefix:a,spans:r}]=function(e){let{as:t,bsPrefix:s,className:n,...i}=e;s=$c(s,"col");const a=Bc(),r=Hc(),o=[],l=[];return a.forEach((e=>{const t=i[e];let n,a,c;delete i[e],"object"===typeof t&&null!=t?({span:n,offset:a,order:c}=t):n=t;const d=e!==r?`-${e}`:"";n&&o.push(!0===n?`${s}${d}`:`${s}${d}-${n}`),null!=c&&l.push(`order${d}-${c}`),null!=a&&l.push(`offset${d}-${a}`)})),[{...i,className:Ic()(n,...o,...l)},{as:t,bsPrefix:s,spans:o}]}(e);return(0,Me.jsx)(i,{...n,ref:t,className:Ic()(s,!r.length&&a)})}));Qc.displayName="Col";const Zc=Qc,ed=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i="div",...a}=e;return n=$c(n,"card-body"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));ed.displayName="CardBody";const td=ed,sd=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i="div",...a}=e;return n=$c(n,"card-footer"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));sd.displayName="CardFooter";const nd=sd,id=t.createContext(null);id.displayName="CardHeaderContext";const ad=id,rd=t.forwardRef(((e,s)=>{let{bsPrefix:n,className:i,as:a="div",...r}=e;const o=$c(n,"card-header"),l=(0,t.useMemo)((()=>({cardHeaderBsPrefix:o})),[o]);return(0,Me.jsx)(ad.Provider,{value:l,children:(0,Me.jsx)(a,{ref:s,...r,className:Ic()(i,o)})})}));rd.displayName="CardHeader";const od=rd,ld=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:n,variant:i,as:a="img",...r}=e;const o=$c(s,"card-img");return(0,Me.jsx)(a,{ref:t,className:Ic()(i?`${o}-${i}`:o,n),...r})}));ld.displayName="CardImg";const cd=ld,dd=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i="div",...a}=e;return n=$c(n,"card-img-overlay"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));dd.displayName="CardImgOverlay";const hd=dd,ud=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i="a",...a}=e;return n=$c(n,"card-link"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));ud.displayName="CardLink";const pd=ud,fd=e=>t.forwardRef(((t,s)=>(0,Me.jsx)("div",{...t,ref:s,className:Ic()(t.className,e)}))),md=fd("h6"),gd=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i=md,...a}=e;return n=$c(n,"card-subtitle"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));gd.displayName="CardSubtitle";const bd=gd,vd=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i="p",...a}=e;return n=$c(n,"card-text"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));vd.displayName="CardText";const yd=vd,xd=fd("h5"),wd=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i=xd,...a}=e;return n=$c(n,"card-title"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));wd.displayName="CardTitle";const _d=wd,Sd=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:n,bg:i,text:a,border:r,body:o=!1,children:l,as:c="div",...d}=e;const h=$c(s,"card");return(0,Me.jsx)(c,{ref:t,...d,className:Ic()(n,h,i&&`bg-${i}`,a&&`text-${a}`,r&&`border-${r}`),children:o?(0,Me.jsx)(td,{children:l}):l})}));Sd.displayName="Card";const Ad=Object.assign(Sd,{Img:cd,Title:_d,Subtitle:bd,Body:td,Link:pd,Text:yd,Header:od,Footer:nd,ImgOverlay:hd}),kd=!("undefined"===typeof window||!window.document||!window.document.createElement);var Ed=!1,Cd=!1;try{var jd={get passive(){return Ed=!0},get once(){return Cd=Ed=!0}};kd&&(window.addEventListener("test",jd,jd),window.removeEventListener("test",jd,!0))}catch(zS){}const Nd=function(e,t,s,n){if(n&&"boolean"!==typeof n&&!Cd){var i=n.once,a=n.capture,r=s;!Cd&&i&&(r=s.__once||function e(n){this.removeEventListener(t,e,a),s.call(this,n)},s.__once=r),e.addEventListener(t,r,Ed?n:a)}e.addEventListener(t,s,n)};function Td(e){return e&&e.ownerDocument||document}const Pd=function(e,t,s,n){var i=n&&"boolean"!==typeof n?n.capture:n;e.removeEventListener(t,s,i),s.__once&&e.removeEventListener(t,s.__once,i)};var Md;function Rd(e){if((!Md&&0!==Md||e)&&kd){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),Md=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return Md}const Id=function(e){const s=(0,t.useRef)(e);return(0,t.useEffect)((()=>{s.current=e}),[e]),s};function Dd(e){const s=Id(e);return(0,t.useCallback)((function(){return s.current&&s.current(...arguments)}),[s])}const Ld=e=>e&&"function"!==typeof e?t=>{e.current=t}:e;const Od=function(e,s){return(0,t.useMemo)((()=>function(e,t){const s=Ld(e),n=Ld(t);return e=>{s&&s(e),n&&n(e)}}(e,s)),[e,s])};function Fd(e){const s=function(e){const s=(0,t.useRef)(e);return s.current=e,s}(e);(0,t.useEffect)((()=>()=>s.current()),[])}function zd(e,t){return function(e){var t=Td(e);return t&&t.defaultView||window}(e).getComputedStyle(e,t)}var $d=/([A-Z])/g;var Bd=/^ms-/;function Hd(e){return function(e){return e.replace($d,"-$1").toLowerCase()}(e).replace(Bd,"-ms-")}var Ud=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;const Vd=function(e,t){var s="",n="";if("string"===typeof t)return e.style.getPropertyValue(Hd(t))||zd(e).getPropertyValue(Hd(t));Object.keys(t).forEach((function(i){var a=t[i];a||0===a?!function(e){return!(!e||!Ud.test(e))}(i)?s+=Hd(i)+": "+a+";":n+=i+"("+a+") ":e.style.removeProperty(Hd(i))})),n&&(s+="transform: "+n+";"),e.style.cssText+=";"+s};const Wd=function(e,t,s,n){return Nd(e,t,s,n),function(){Pd(e,t,s,n)}};function qd(e,t,s){void 0===s&&(s=5);var n=!1,i=setTimeout((function(){n||function(e,t,s,n){if(void 0===s&&(s=!1),void 0===n&&(n=!0),e){var i=document.createEvent("HTMLEvents");i.initEvent(t,s,n),e.dispatchEvent(i)}}(e,"transitionend",!0)}),t+s),a=Wd(e,"transitionend",(function(){n=!0}),{once:!0});return function(){clearTimeout(i),a()}}function Gd(e,t,s,n){null==s&&(s=function(e){var t=Vd(e,"transitionDuration")||"",s=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*s}(e)||0);var i=qd(e,s,n),a=Wd(e,"transitionend",t);return function(){i(),a()}}function Xd(e){void 0===e&&(e=Td());try{var t=e.activeElement;return t&&t.nodeName?t:null}catch(zS){return e.body}}function Yd(e,t){return e.contains?e.contains(t):e.compareDocumentPosition?e===t||!!(16&e.compareDocumentPosition(t)):void 0}function Kd(e){const s=function(e){const s=(0,t.useRef)(e);return s.current=e,s}(e);(0,t.useEffect)((()=>()=>s.current()),[])}const Jd=function(e){const s=(0,t.useRef)(e);return(0,t.useEffect)((()=>{s.current=e}),[e]),s};function Qd(e){const s=Jd(e);return(0,t.useCallback)((function(){return s.current&&s.current(...arguments)}),[s])}const Zd=`data-rr-ui-${"modal-open"}`;const eh=class{constructor(){let{ownerDocument:e,handleContainerOverflow:t=!0,isRTL:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.handleContainerOverflow=t,this.isRTL=s,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const t={overflow:"hidden"},s=this.isRTL?"paddingLeft":"paddingRight",n=this.getElement();e.style={overflow:n.style.overflow,[s]:n.style[s]},e.scrollBarWidth&&(t[s]=`${parseInt(Vd(n,s)||"0",10)+e.scrollBarWidth}px`),n.setAttribute(Zd,""),Vd(n,t)}reset(){[...this.modals].forEach((e=>this.remove(e)))}removeContainerStyle(e){const t=this.getElement();t.removeAttribute(Zd),Object.assign(t.style,e.style)}add(e){let t=this.modals.indexOf(e);return-1!==t?t:(t=this.modals.length,this.modals.push(e),this.setModalAttributes(e),0!==t||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),t)}remove(e){const t=this.modals.indexOf(e);-1!==t&&(this.modals.splice(t,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}},th=(0,t.createContext)(kd?window:void 0);th.Provider;function sh(){return(0,t.useContext)(th)}const nh=(e,t)=>kd?null==e?(t||Td()).body:("function"===typeof e&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;const ih=e=>e&&"function"!==typeof e?t=>{e.current=t}:e;const ah=function(e,s){return(0,t.useMemo)((()=>function(e,t){const s=ih(e),n=ih(t);return e=>{s&&s(e),n&&n(e)}}(e,s)),[e,s])},rh="undefined"!==typeof s.g&&s.g.navigator&&"ReactNative"===s.g.navigator.product,oh="undefined"!==typeof document||rh?t.useLayoutEffect:t.useEffect;function lh(e){if(!e||"function"===typeof e)return null;const{major:s}=function(){const e=t.version.split(".");return{major:+e[0],minor:+e[1],patch:+e[2]}}();return s>=19?e.props.ref:e.ref}const ch=function(e){let{children:s,in:n,onExited:i,mountOnEnter:a,unmountOnExit:r}=e;const o=(0,t.useRef)(null),l=(0,t.useRef)(n),c=Qd(i);(0,t.useEffect)((()=>{n?l.current=!0:c(o.current)}),[n,c]);const d=ah(o,lh(s)),h=(0,t.cloneElement)(s,{ref:d});return n?h:r||!l.current&&a?null:h},dh=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];const hh=["component"];const uh=t.forwardRef(((e,s)=>{let{component:n}=e,i=function(e,t){if(null==e)return{};var s={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;s[n]=e[n]}return s}(e,hh);const a=function(e){let{onEnter:s,onEntering:n,onEntered:i,onExit:a,onExiting:r,onExited:o,addEndListener:l,children:c}=e,d=function(e,t){if(null==e)return{};var s={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;s[n]=e[n]}return s}(e,dh);const h=(0,t.useRef)(null),u=ah(h,lh(c)),p=e=>t=>{e&&h.current&&e(h.current,t)},f=(0,t.useCallback)(p(s),[s]),m=(0,t.useCallback)(p(n),[n]),g=(0,t.useCallback)(p(i),[i]),b=(0,t.useCallback)(p(a),[a]),v=(0,t.useCallback)(p(r),[r]),y=(0,t.useCallback)(p(o),[o]),x=(0,t.useCallback)(p(l),[l]);return Object.assign({},d,{nodeRef:h},s&&{onEnter:f},n&&{onEntering:m},i&&{onEntered:g},a&&{onExit:b},r&&{onExiting:v},o&&{onExited:y},l&&{addEndListener:x},{children:"function"===typeof c?(e,t)=>c(e,Object.assign({},t,{ref:u})):(0,t.cloneElement)(c,{ref:u})})}(i);return(0,Me.jsx)(n,Object.assign({ref:s},a))})),ph=uh;function fh(e){let{children:s,in:n,onExited:i,onEntered:a,transition:r}=e;const[o,l]=(0,t.useState)(!n);n&&o&&l(!1);const c=function(e){let{in:s,onTransition:n}=e;const i=(0,t.useRef)(null),a=(0,t.useRef)(!0),r=Qd(n);return oh((()=>{if(!i.current)return;let e=!1;return r({in:s,element:i.current,initial:a.current,isStale:()=>e}),()=>{e=!0}}),[s,r]),oh((()=>(a.current=!1,()=>{a.current=!0})),[]),i}({in:!!n,onTransition:e=>{Promise.resolve(r(e)).then((()=>{e.isStale()||(e.in?null==a||a(e.element,e.initial):(l(!0),null==i||i(e.element)))}),(t=>{throw e.in||l(!0),t}))}}),d=ah(c,lh(s));return o&&!n?null:(0,t.cloneElement)(s,{ref:d})}function mh(e,t,s){return e?(0,Me.jsx)(ph,Object.assign({},s,{component:e})):t?(0,Me.jsx)(fh,Object.assign({},s,{transition:t})):(0,Me.jsx)(ch,Object.assign({},s))}const gh=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];let bh;function vh(e){const s=sh(),n=e||function(e){return bh||(bh=new eh({ownerDocument:null==e?void 0:e.document})),bh}(s),i=(0,t.useRef)({dialog:null,backdrop:null});return Object.assign(i.current,{add:()=>n.add(i.current),remove:()=>n.remove(i.current),isTopModal:()=>n.isTopModal(i.current),setDialogRef:(0,t.useCallback)((e=>{i.current.dialog=e}),[]),setBackdropRef:(0,t.useCallback)((e=>{i.current.backdrop=e}),[])})}const yh=(0,t.forwardRef)(((e,s)=>{let{show:n=!1,role:i="dialog",className:r,style:o,children:l,backdrop:c=!0,keyboard:d=!0,onBackdropClick:h,onEscapeKeyDown:u,transition:p,runTransition:f,backdropTransition:m,runBackdropTransition:g,autoFocus:b=!0,enforceFocus:v=!0,restoreFocus:y=!0,restoreFocusOptions:x,renderDialog:w,renderBackdrop:_=e=>(0,Me.jsx)("div",Object.assign({},e)),manager:S,container:A,onShow:k,onHide:E=()=>{},onExit:C,onExited:j,onExiting:N,onEnter:T,onEntering:P,onEntered:M}=e,R=function(e,t){if(null==e)return{};var s={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;s[n]=e[n]}return s}(e,gh);const I=sh(),D=function(e,s){const n=sh(),[i,a]=(0,t.useState)((()=>nh(e,null==n?void 0:n.document)));if(!i){const t=nh(e);t&&a(t)}return(0,t.useEffect)((()=>{s&&i&&s(i)}),[s,i]),(0,t.useEffect)((()=>{const t=nh(e);t!==i&&a(t)}),[e,i]),i}(A),L=vh(S),O=function(){const e=(0,t.useRef)(!0),s=(0,t.useRef)((()=>e.current));return(0,t.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),s.current}(),F=function(e){const s=(0,t.useRef)(null);return(0,t.useEffect)((()=>{s.current=e})),s.current}(n),[z,$]=(0,t.useState)(!n),B=(0,t.useRef)(null);(0,t.useImperativeHandle)(s,(()=>L),[L]),kd&&!F&&n&&(B.current=Xd(null==I?void 0:I.document)),n&&z&&$(!1);const H=Qd((()=>{if(L.add(),X.current=Wd(document,"keydown",q),G.current=Wd(document,"focus",(()=>setTimeout(V)),!0),k&&k(),b){var e,t;const s=Xd(null!=(e=null==(t=L.dialog)?void 0:t.ownerDocument)?e:null==I?void 0:I.document);L.dialog&&s&&!Yd(L.dialog,s)&&(B.current=s,L.dialog.focus())}})),U=Qd((()=>{var e;(L.remove(),null==X.current||X.current(),null==G.current||G.current(),y)&&(null==(e=B.current)||null==e.focus||e.focus(x),B.current=null)}));(0,t.useEffect)((()=>{n&&D&&H()}),[n,D,H]),(0,t.useEffect)((()=>{z&&U()}),[z,U]),Kd((()=>{U()}));const V=Qd((()=>{if(!v||!O()||!L.isTopModal())return;const e=Xd(null==I?void 0:I.document);L.dialog&&e&&!Yd(L.dialog,e)&&L.dialog.focus()})),W=Qd((e=>{e.target===e.currentTarget&&(null==h||h(e),!0===c&&E())})),q=Qd((e=>{d&&function(e){return"Escape"===e.code||27===e.keyCode}(e)&&L.isTopModal()&&(null==u||u(e),e.defaultPrevented||E())})),G=(0,t.useRef)(),X=(0,t.useRef)();if(!D)return null;const Y=Object.assign({role:i,ref:L.setDialogRef,"aria-modal":"dialog"===i||void 0},R,{style:o,className:r,tabIndex:-1});let K=w?w(Y):(0,Me.jsx)("div",Object.assign({},Y,{children:t.cloneElement(l,{role:"document"})}));K=mh(p,f,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!n,onExit:C,onExiting:N,onExited:function(){$(!0),null==j||j(...arguments)},onEnter:T,onEntering:P,onEntered:M,children:K});let J=null;return c&&(J=_({ref:L.setBackdropRef,onClick:W}),J=mh(m,g,{in:!!n,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:J})),(0,Me.jsx)(Me.Fragment,{children:a.createPortal((0,Me.jsxs)(Me.Fragment,{children:[J,K]}),D)})}));yh.displayName="Modal";const xh=Object.assign(yh,{Manager:eh});var wh=Function.prototype.bind.call(Function.prototype.call,[].slice);function _h(e,t){return wh(e.querySelectorAll(t))}function Sh(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const Ah=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",kh=".sticky-top",Eh=".navbar-toggler";class Ch extends eh{adjustAndStore(e,t,s){const n=t.style[e];t.dataset[e]=n,Vd(t,{[e]:`${parseFloat(Vd(t,e))+s}px`})}restore(e,t){const s=t.dataset[e];void 0!==s&&(delete t.dataset[e],Vd(t,{[e]:s}))}setContainerStyle(e){super.setContainerStyle(e);const t=this.getElement();var s,n;if(n="modal-open",(s=t).classList?s.classList.add(n):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(s,n)||("string"===typeof s.className?s.className=s.className+" "+n:s.setAttribute("class",(s.className&&s.className.baseVal||"")+" "+n)),!e.scrollBarWidth)return;const i=this.isRTL?"paddingLeft":"paddingRight",a=this.isRTL?"marginLeft":"marginRight";_h(t,Ah).forEach((t=>this.adjustAndStore(i,t,e.scrollBarWidth))),_h(t,kh).forEach((t=>this.adjustAndStore(a,t,-e.scrollBarWidth))),_h(t,Eh).forEach((t=>this.adjustAndStore(a,t,e.scrollBarWidth)))}removeContainerStyle(e){super.removeContainerStyle(e);const t=this.getElement();var s,n;n="modal-open",(s=t).classList?s.classList.remove(n):"string"===typeof s.className?s.className=Sh(s.className,n):s.setAttribute("class",Sh(s.className&&s.className.baseVal||"",n));const i=this.isRTL?"paddingLeft":"paddingRight",a=this.isRTL?"marginLeft":"marginRight";_h(t,Ah).forEach((e=>this.restore(i,e))),_h(t,kh).forEach((e=>this.restore(a,e))),_h(t,Eh).forEach((e=>this.restore(a,e)))}}let jh;function Nh(e,t){return Nh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Nh(e,t)}const Th=!1,Ph=t.createContext(null);var Mh="unmounted",Rh="exited",Ih="entering",Dh="entered",Lh="exiting",Oh=function(e){var s,n;function i(t,s){var n;n=e.call(this,t,s)||this;var i,a=s&&!s.isMounting?t.enter:t.appear;return n.appearStatus=null,t.in?a?(i=Rh,n.appearStatus=Ih):i=Dh:i=t.unmountOnExit||t.mountOnEnter?Mh:Rh,n.state={status:i},n.nextCallback=null,n}n=e,(s=i).prototype=Object.create(n.prototype),s.prototype.constructor=s,Nh(s,n),i.getDerivedStateFromProps=function(e,t){return e.in&&t.status===Mh?{status:Rh}:null};var r=i.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var s=this.state.status;this.props.in?s!==Ih&&s!==Dh&&(t=Ih):s!==Ih&&s!==Dh||(t=Lh)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,s,n=this.props.timeout;return e=t=s=n,null!=n&&"number"!==typeof n&&(e=n.exit,t=n.enter,s=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:s}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===Ih){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:a.findDOMNode(this);s&&function(e){e.scrollTop}(s)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Rh&&this.setState({status:Mh})},r.performEnter=function(e){var t=this,s=this.props.enter,n=this.context?this.context.isMounting:e,i=this.props.nodeRef?[n]:[a.findDOMNode(this),n],r=i[0],o=i[1],l=this.getTimeouts(),c=n?l.appear:l.enter;!e&&!s||Th?this.safeSetState({status:Dh},(function(){t.props.onEntered(r)})):(this.props.onEnter(r,o),this.safeSetState({status:Ih},(function(){t.props.onEntering(r,o),t.onTransitionEnd(c,(function(){t.safeSetState({status:Dh},(function(){t.props.onEntered(r,o)}))}))})))},r.performExit=function(){var e=this,t=this.props.exit,s=this.getTimeouts(),n=this.props.nodeRef?void 0:a.findDOMNode(this);t&&!Th?(this.props.onExit(n),this.safeSetState({status:Lh},(function(){e.props.onExiting(n),e.onTransitionEnd(s.exit,(function(){e.safeSetState({status:Rh},(function(){e.props.onExited(n)}))}))}))):this.safeSetState({status:Rh},(function(){e.props.onExited(n)}))},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,s=!0;return this.nextCallback=function(n){s&&(s=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var s=this.props.nodeRef?this.props.nodeRef.current:a.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(s&&!n){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],r=i[0],o=i[1];this.props.addEndListener(r,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},r.render=function(){var e=this.state.status;if(e===Mh)return null;var s=this.props,n=s.children,i=(s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef,function(e,t){if(null==e)return{};var s={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;s[n]=e[n]}return s}(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return t.createElement(Ph.Provider,{value:null},"function"===typeof n?n(e,i):t.cloneElement(t.Children.only(n),i))},i}(t.Component);function Fh(){}Oh.contextType=Ph,Oh.propTypes={},Oh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Fh,onEntering:Fh,onEntered:Fh,onExit:Fh,onExiting:Fh,onExited:Fh},Oh.UNMOUNTED=Mh,Oh.EXITED=Rh,Oh.ENTERING=Ih,Oh.ENTERED=Dh,Oh.EXITING=Lh;const zh=Oh;function $h(e,t){const s=Vd(e,t)||"",n=-1===s.indexOf("ms")?1e3:1;return parseFloat(s)*n}function Bh(e,t){const s=$h(e,"transitionDuration"),n=$h(e,"transitionDelay"),i=Gd(e,(s=>{s.target===e&&(i(),t(s))}),s+n)}const Hh=t.forwardRef(((e,s)=>{let{onEnter:n,onEntering:i,onEntered:r,onExit:o,onExiting:l,onExited:c,addEndListener:d,children:h,childRef:u,...p}=e;const f=(0,t.useRef)(null),m=Od(f,u),g=e=>{var t;m((t=e)&&"setState"in t?a.findDOMNode(t):null!=t?t:null)},b=e=>t=>{e&&f.current&&e(f.current,t)},v=(0,t.useCallback)(b(n),[n]),y=(0,t.useCallback)(b(i),[i]),x=(0,t.useCallback)(b(r),[r]),w=(0,t.useCallback)(b(o),[o]),_=(0,t.useCallback)(b(l),[l]),S=(0,t.useCallback)(b(c),[c]),A=(0,t.useCallback)(b(d),[d]);return(0,Me.jsx)(zh,{ref:s,...p,onEnter:v,onEntered:x,onEntering:y,onExit:w,onExited:S,onExiting:_,addEndListener:A,nodeRef:f,children:"function"===typeof h?(e,t)=>h(e,{...t,ref:g}):t.cloneElement(h,{ref:g})})})),Uh=Hh,Vh={[Ih]:"show",[Dh]:"show"},Wh=t.forwardRef(((e,s)=>{let{className:n,children:i,transitionClasses:a={},onEnter:r,...o}=e;const l={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...o},c=(0,t.useCallback)(((e,t)=>{!function(e){e.offsetHeight}(e),null==r||r(e,t)}),[r]);return(0,Me.jsx)(Uh,{ref:s,addEndListener:Bh,...l,onEnter:c,childRef:lh(i),children:(e,s)=>t.cloneElement(i,{...s,className:Ic()("fade",n,i.props.className,Vh[e],a[e])})})}));Wh.displayName="Fade";const qh=Wh,Gh=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i="div",...a}=e;return n=$c(n,"modal-body"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));Gh.displayName="ModalBody";const Xh=Gh,Yh=t.createContext({onHide(){}}),Kh=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:n,contentClassName:i,centered:a,size:r,fullscreen:o,children:l,scrollable:c,...d}=e;s=$c(s,"modal");const h=`${s}-dialog`,u="string"===typeof o?`${s}-fullscreen-${o}`:`${s}-fullscreen`;return(0,Me.jsx)("div",{...d,ref:t,className:Ic()(h,n,r&&`${s}-${r}`,a&&`${h}-centered`,c&&`${h}-scrollable`,o&&u),children:(0,Me.jsx)("div",{className:Ic()(`${s}-content`,i),children:l})})}));Kh.displayName="ModalDialog";const Jh=Kh,Qh=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i="div",...a}=e;return n=$c(n,"modal-footer"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));Qh.displayName="ModalFooter";const Zh=Qh;var eu=s(173),tu=s.n(eu);const su={"aria-label":tu().string,onClick:tu().func,variant:tu().oneOf(["white"])},nu=t.forwardRef(((e,t)=>{let{className:s,variant:n,"aria-label":i="Close",...a}=e;return(0,Me.jsx)("button",{ref:t,type:"button",className:Ic()("btn-close",n&&`btn-close-${n}`,s),"aria-label":i,...a})}));nu.displayName="CloseButton",nu.propTypes=su;const iu=nu,au=t.forwardRef(((e,s)=>{let{closeLabel:n="Close",closeVariant:i,closeButton:a=!1,onHide:r,children:o,...l}=e;const c=(0,t.useContext)(Yh),d=Dd((()=>{null==c||c.onHide(),null==r||r()}));return(0,Me.jsxs)("div",{ref:s,...l,children:[o,a&&(0,Me.jsx)(iu,{"aria-label":n,variant:i,onClick:d})]})})),ru=au,ou=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:n,closeLabel:i="Close",closeButton:a=!1,...r}=e;return s=$c(s,"modal-header"),(0,Me.jsx)(ru,{ref:t,...r,className:Ic()(n,s),closeLabel:i,closeButton:a})}));ou.displayName="ModalHeader";const lu=ou,cu=fd("h4"),du=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i=cu,...a}=e;return n=$c(n,"modal-title"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));du.displayName="ModalTitle";const hu=du;function uu(e){return(0,Me.jsx)(qh,{...e,timeout:null})}function pu(e){return(0,Me.jsx)(qh,{...e,timeout:null})}const fu=t.forwardRef(((e,s)=>{let{bsPrefix:n,className:i,style:a,dialogClassName:r,contentClassName:o,children:l,dialogAs:c=Jh,"data-bs-theme":d,"aria-labelledby":h,"aria-describedby":u,"aria-label":p,show:f=!1,animation:m=!0,backdrop:g=!0,keyboard:b=!0,onEscapeKeyDown:v,onShow:y,onHide:x,container:w,autoFocus:_=!0,enforceFocus:S=!0,restoreFocus:A=!0,restoreFocusOptions:k,onEntered:E,onExit:C,onExiting:j,onEnter:N,onEntering:T,onExited:P,backdropClassName:M,manager:R,...I}=e;const[D,L]=(0,t.useState)({}),[O,F]=(0,t.useState)(!1),z=(0,t.useRef)(!1),$=(0,t.useRef)(!1),B=(0,t.useRef)(null),[H,U]=(0,t.useState)(null),V=Od(s,U),W=Dd(x),q=function(){const{dir:e}=(0,t.useContext)(Oc);return"rtl"===e}();n=$c(n,"modal");const G=(0,t.useMemo)((()=>({onHide:W})),[W]);function X(){return R||function(e){return jh||(jh=new Ch(e)),jh}({isRTL:q})}function Y(e){if(!kd)return;const t=X().getScrollbarWidth()>0,s=e.scrollHeight>Td(e).documentElement.clientHeight;L({paddingRight:t&&!s?Rd():void 0,paddingLeft:!t&&s?Rd():void 0})}const K=Dd((()=>{H&&Y(H.dialog)}));Fd((()=>{Pd(window,"resize",K),null==B.current||B.current()}));const J=()=>{z.current=!0},Q=e=>{z.current&&H&&e.target===H.dialog&&($.current=!0),z.current=!1},Z=()=>{F(!0),B.current=Gd(H.dialog,(()=>{F(!1)}))},ee=e=>{"static"!==g?$.current||e.target!==e.currentTarget?$.current=!1:null==x||x():(e=>{e.target===e.currentTarget&&Z()})(e)},te=(0,t.useCallback)((e=>(0,Me.jsx)("div",{...e,className:Ic()(`${n}-backdrop`,M,!m&&"show")})),[m,M,n]),se={...a,...D};se.display="block";return(0,Me.jsx)(Yh.Provider,{value:G,children:(0,Me.jsx)(xh,{show:f,ref:V,backdrop:g,container:w,keyboard:!0,autoFocus:_,enforceFocus:S,restoreFocus:A,restoreFocusOptions:k,onEscapeKeyDown:e=>{b?null==v||v(e):(e.preventDefault(),"static"===g&&Z())},onShow:y,onHide:x,onEnter:(e,t)=>{e&&Y(e),null==N||N(e,t)},onEntering:(e,t)=>{null==T||T(e,t),Nd(window,"resize",K)},onEntered:E,onExit:e=>{null==B.current||B.current(),null==C||C(e)},onExiting:j,onExited:e=>{e&&(e.style.display=""),null==P||P(e),Pd(window,"resize",K)},manager:X(),transition:m?uu:void 0,backdropTransition:m?pu:void 0,renderBackdrop:te,renderDialog:e=>(0,Me.jsx)("div",{role:"dialog",...e,style:se,className:Ic()(i,n,O&&`${n}-static`,!m&&"show"),onClick:g?ee:void 0,onMouseUp:Q,"data-bs-theme":d,"aria-label":p,"aria-labelledby":h,"aria-describedby":u,children:(0,Me.jsx)(c,{...I,onMouseDown:J,className:r,contentClassName:o,children:l})})})})}));fu.displayName="Modal";const mu=Object.assign(fu,{Body:Xh,Header:lu,Title:hu,Footer:Zh,Dialog:Jh,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),gu={type:tu().string,tooltip:tu().bool,as:tu().elementType},bu=t.forwardRef(((e,t)=>{let{as:s="div",className:n,type:i="valid",tooltip:a=!1,...r}=e;return(0,Me.jsx)(s,{...r,ref:t,className:Ic()(n,`${i}-${a?"tooltip":"feedback"}`)})}));bu.displayName="Feedback",bu.propTypes=gu;const vu=bu,yu=t.createContext({}),xu=t.forwardRef(((e,s)=>{let{id:n,bsPrefix:i,className:a,type:r="checkbox",isValid:o=!1,isInvalid:l=!1,as:c="input",...d}=e;const{controlId:h}=(0,t.useContext)(yu);return i=$c(i,"form-check-input"),(0,Me.jsx)(c,{...d,ref:s,type:r,id:n||h,className:Ic()(a,i,o&&"is-valid",l&&"is-invalid")})}));xu.displayName="FormCheckInput";const wu=xu,_u=t.forwardRef(((e,s)=>{let{bsPrefix:n,className:i,htmlFor:a,...r}=e;const{controlId:o}=(0,t.useContext)(yu);return n=$c(n,"form-check-label"),(0,Me.jsx)("label",{...r,ref:s,htmlFor:a||o,className:Ic()(i,n)})}));_u.displayName="FormCheckLabel";const Su=_u;const Au=t.forwardRef(((e,s)=>{let{id:n,bsPrefix:i,bsSwitchPrefix:a,inline:r=!1,reverse:o=!1,disabled:l=!1,isValid:c=!1,isInvalid:d=!1,feedbackTooltip:h=!1,feedback:u,feedbackType:p,className:f,style:m,title:g="",type:b="checkbox",label:v,children:y,as:x="input",...w}=e;i=$c(i,"form-check"),a=$c(a,"form-switch");const{controlId:_}=(0,t.useContext)(yu),S=(0,t.useMemo)((()=>({controlId:n||_})),[_,n]),A=!y&&null!=v&&!1!==v||function(e,s){return t.Children.toArray(e).some((e=>t.isValidElement(e)&&e.type===s))}(y,Su),k=(0,Me.jsx)(wu,{...w,type:"switch"===b?"checkbox":b,ref:s,isValid:c,isInvalid:d,disabled:l,as:x});return(0,Me.jsx)(yu.Provider,{value:S,children:(0,Me.jsx)("div",{style:m,className:Ic()(f,A&&i,r&&`${i}-inline`,o&&`${i}-reverse`,"switch"===b&&a),children:y||(0,Me.jsxs)(Me.Fragment,{children:[k,A&&(0,Me.jsx)(Su,{title:g,children:v}),u&&(0,Me.jsx)(vu,{type:p,tooltip:h,children:u})]})})})}));Au.displayName="FormCheck";const ku=Object.assign(Au,{Input:wu,Label:Su});s(440);const Eu=t.forwardRef(((e,s)=>{let{bsPrefix:n,type:i,size:a,htmlSize:r,id:o,className:l,isValid:c=!1,isInvalid:d=!1,plaintext:h,readOnly:u,as:p="input",...f}=e;const{controlId:m}=(0,t.useContext)(yu);return n=$c(n,"form-control"),(0,Me.jsx)(p,{...f,type:i,size:r,ref:s,readOnly:u,id:o||m,className:Ic()(l,h?`${n}-plaintext`:n,a&&`${n}-${a}`,"color"===i&&`${n}-color`,c&&"is-valid",d&&"is-invalid")})}));Eu.displayName="FormControl";const Cu=Object.assign(Eu,{Feedback:vu}),ju=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:n,as:i="div",...a}=e;return n=$c(n,"form-floating"),(0,Me.jsx)(i,{ref:t,className:Ic()(s,n),...a})}));ju.displayName="FormFloating";const Nu=ju,Tu=t.forwardRef(((e,s)=>{let{controlId:n,as:i="div",...a}=e;const r=(0,t.useMemo)((()=>({controlId:n})),[n]);return(0,Me.jsx)(yu.Provider,{value:r,children:(0,Me.jsx)(i,{...a,ref:s})})}));Tu.displayName="FormGroup";const Pu=Tu,Mu=t.forwardRef(((e,s)=>{let{as:n="label",bsPrefix:i,column:a=!1,visuallyHidden:r=!1,className:o,htmlFor:l,...c}=e;const{controlId:d}=(0,t.useContext)(yu);i=$c(i,"form-label");let h="col-form-label";"string"===typeof a&&(h=`${h} ${h}-${a}`);const u=Ic()(o,i,r&&"visually-hidden",a&&h);return l=l||d,a?(0,Me.jsx)(Zc,{ref:s,as:"label",className:u,htmlFor:l,...c}):(0,Me.jsx)(n,{ref:s,className:u,htmlFor:l,...c})}));Mu.displayName="FormLabel";const Ru=Mu,Iu=t.forwardRef(((e,s)=>{let{bsPrefix:n,className:i,id:a,...r}=e;const{controlId:o}=(0,t.useContext)(yu);return n=$c(n,"form-range"),(0,Me.jsx)("input",{...r,type:"range",ref:s,className:Ic()(i,n),id:a||o})}));Iu.displayName="FormRange";const Du=Iu,Lu=t.forwardRef(((e,s)=>{let{bsPrefix:n,size:i,htmlSize:a,className:r,isValid:o=!1,isInvalid:l=!1,id:c,...d}=e;const{controlId:h}=(0,t.useContext)(yu);return n=$c(n,"form-select"),(0,Me.jsx)("select",{...d,size:a,ref:s,className:Ic()(r,n,i&&`${n}-${i}`,o&&"is-valid",l&&"is-invalid"),id:c||h})}));Lu.displayName="FormSelect";const Ou=Lu,Fu=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:n,as:i="small",muted:a,...r}=e;return s=$c(s,"form-text"),(0,Me.jsx)(i,{...r,ref:t,className:Ic()(n,s,a&&"text-muted")})}));Fu.displayName="FormText";const zu=Fu,$u=t.forwardRef(((e,t)=>(0,Me.jsx)(ku,{...e,ref:t,type:"switch"})));$u.displayName="Switch";const Bu=Object.assign($u,{Input:ku.Input,Label:ku.Label}),Hu=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:n,children:i,controlId:a,label:r,...o}=e;return s=$c(s,"form-floating"),(0,Me.jsxs)(Pu,{ref:t,className:Ic()(n,s),controlId:a,...o,children:[i,(0,Me.jsx)("label",{htmlFor:a,children:r})]})}));Hu.displayName="FloatingLabel";const Uu=Hu,Vu={_ref:tu().any,validated:tu().bool,as:tu().elementType},Wu=t.forwardRef(((e,t)=>{let{className:s,validated:n,as:i="form",...a}=e;return(0,Me.jsx)(i,{...a,ref:t,className:Ic()(s,n&&"was-validated")})}));Wu.displayName="Form",Wu.propTypes=Vu;const qu=Object.assign(Wu,{Group:Pu,Control:Cu,Floating:Nu,Check:ku,Switch:Bu,Label:Ru,Text:zu,Range:Du,Select:Ou,FloatingLabel:Uu});var Gu={d:(e,t)=>{for(var s in t)Gu.o(t,s)&&!Gu.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},Xu=globalThis.pdfjsLib={};Gu.d(Xu,{AbortException:()=>of,AnnotationEditorLayer:()=>Jb,AnnotationEditorParamsType:()=>cp,AnnotationEditorType:()=>lp,AnnotationEditorUIManager:()=>qf,AnnotationLayer:()=>Mb,AnnotationMode:()=>op,ColorPicker:()=>Hb,DOMSVGFactory:()=>eb,DrawLayer:()=>Qb,FeatureTest:()=>hf,GlobalWorkerOptions:()=>eg,ImageKind:()=>bp,InvalidPDFException:()=>sf,MissingPDFException:()=>nf,OPS:()=>Hp,OutputScale:()=>Of,PDFDataRangeTransport:()=>Fg,PDFDateString:()=>Pf,PDFWorker:()=>Hg,PasswordResponses:()=>Up,PermissionFlag:()=>dp,PixelsPerInch:()=>yf,RenderingCancelledException:()=>_f,TextLayer:()=>jg,TouchManager:()=>Xf,UnexpectedResponseException:()=>af,Util:()=>pf,VerbosityLevel:()=>Bp,XfaLayer:()=>tb,build:()=>Yg,createValidAbsoluteUrl:()=>Jp,fetchData:()=>xf,getDocument:()=>Dg,getFilenameFromUrl:()=>kf,getPdfFilenameFromUrl:()=>Ef,getXfaPageViewport:()=>Mf,isDataScheme:()=>Sf,isPdfFile:()=>Af,noContextMenu:()=>Nf,normalizeUnicode:()=>gf,setLayerDimensions:()=>Lf,shadow:()=>Qp,stopEvent:()=>Tf,version:()=>Xg});const Yu="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type),Ku=[1,0,0,1,0,0],Ju=[.001,0,0,.001,0,0],Qu=1.35,Zu=1,ep=2,tp=4,sp=16,np=32,ip=64,ap=128,rp=256,op={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},lp={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},cp={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},dp={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},hp=0,up=1,pp=2,fp=3,mp=3,gp=4,bp={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},vp=1,yp=2,xp=3,wp=4,_p=5,Sp=6,Ap=7,kp=8,Ep=9,Cp=10,jp=11,Np=12,Tp=13,Pp=14,Mp=15,Rp=16,Ip=17,Dp=20,Lp=1,Op=2,Fp=3,zp=4,$p=5,Bp={ERRORS:0,WARNINGS:1,INFOS:5},Hp={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Up={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Vp=Bp.WARNINGS;function Wp(e){Number.isInteger(e)&&(Vp=e)}function qp(){return Vp}function Gp(e){Vp>=Bp.INFOS&&console.log(`Info: ${e}`)}function Xp(e){Vp>=Bp.WARNINGS&&console.log(`Warning: ${e}`)}function Yp(e){throw new Error(e)}function Kp(e,t){e||Yp(t)}function Jp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;try{if(s&&"string"===typeof e){if(s.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);t?.length>=2&&(e=`http://${e}`)}if(s.tryConvertEncoding)try{e=function(e){return decodeURIComponent(escape(e))}(e)}catch{}}const n=t?new URL(e,t):new URL(e);if(function(e){switch(e?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n))return n}catch{}return null}function Qp(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.defineProperty(e,t,{value:s,enumerable:!n,configurable:!0,writable:!1}),s}const Zp=function(){function e(e,t){this.message=e,this.name=t}return e.prototype=new Error,e.constructor=e,e}();class ef extends Zp{constructor(e,t){super(e,"PasswordException"),this.code=t}}class tf extends Zp{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class sf extends Zp{constructor(e){super(e,"InvalidPDFException")}}class nf extends Zp{constructor(e){super(e,"MissingPDFException")}}class af extends Zp{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class rf extends Zp{constructor(e){super(e,"FormatError")}}class of extends Zp{constructor(e){super(e,"AbortException")}}function lf(e){"object"===typeof e&&void 0!==e?.length||Yp("Invalid argument for bytesToString");const t=e.length,s=8192;if(t<s)return String.fromCharCode.apply(null,e);const n=[];for(let i=0;i<t;i+=s){const a=Math.min(i+s,t),r=e.subarray(i,a);n.push(String.fromCharCode.apply(null,r))}return n.join("")}function cf(e){"string"!==typeof e&&Yp("Invalid argument for stringToBytes");const t=e.length,s=new Uint8Array(t);for(let n=0;n<t;++n)s[n]=255&e.charCodeAt(n);return s}function df(e){const t=Object.create(null);for(const[s,n]of e)t[s]=n;return t}class hf{static get isLittleEndian(){return Qp(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return Qp(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return Qp(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get isImageDecoderSupported(){return Qp(this,"isImageDecoderSupported","undefined"!==typeof ImageDecoder)}static get platform(){return"undefined"!==typeof navigator&&"string"===typeof navigator?.platform?Qp(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:"string"===typeof navigator?.userAgent&&navigator.userAgent.includes("Firefox")}):Qp(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Qp(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const uf=Array.from(Array(256).keys(),(e=>e.toString(16).padStart(2,"0")));class pf{static makeHexColor(e,t,s){return`#${uf[e]}${uf[t]}${uf[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),n=this.applyTransform(e.slice(2,4),t),i=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],n[0],i[0],a[0]),Math.min(s[1],n[1],i[1],a[1]),Math.max(s[0],n[0],i[0],a[0]),Math.max(s[1],n[1],i[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],n=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],r=(s+a)/2,o=Math.sqrt((s+a)**2-4*(s*a-i*n))/2,l=r+o||1,c=r-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),n=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>n)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>a?null:[s,i,n,a]}static#e(e,t,s,n,i,a,r,o,l,c){if(l<=0||l>=1)return;const d=1-l,h=l*l,u=h*l,p=d*(d*(d*e+3*l*t)+3*h*s)+u*n,f=d*(d*(d*i+3*l*a)+3*h*r)+u*o;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],f),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],f)}static#t(e,t,s,n,i,a,r,o,l,c,d,h){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&this.#e(e,t,s,n,i,a,r,o,-d/c,h));const u=c**2-4*d*l;if(u<0)return;const p=Math.sqrt(u),f=2*l;this.#e(e,t,s,n,i,a,r,o,(-c+p)/f,h),this.#e(e,t,s,n,i,a,r,o,(-c-p)/f,h)}static bezierBoundingBox(e,t,s,n,i,a,r,o,l){return l?(l[0]=Math.min(l[0],e,r),l[1]=Math.min(l[1],t,o),l[2]=Math.max(l[2],e,r),l[3]=Math.max(l[3],t,o)):l=[Math.min(e,r),Math.min(t,o),Math.max(e,r),Math.max(t,o)],this.#t(e,s,i,r,t,n,a,o,3*(3*(s-i)-e+r),6*(e-2*s+i),3*(s-e),l),this.#t(e,s,i,r,t,n,a,o,3*(3*(n-a)-t+o),6*(t-2*n+a),3*(n-t),l),l}}let ff=null,mf=null;function gf(e){return ff||(ff=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,mf=new Map([["\ufb05","\u017ft"]])),e.replaceAll(ff,((e,t,s)=>t?t.normalize("NFKC"):mf.get(s)))}const bf="pdfjs_internal_id_";"function"!==typeof Promise.try&&(Promise.try=function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return new Promise((t=>{t(e(...s))}))});const vf="http://www.w3.org/2000/svg";class yf{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=(()=>this.CSS/this.PDF)()}async function xf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(jf(e,document.baseURI)){const s=await fetch(e);if(!s.ok)throw new Error(s.statusText);switch(t){case"arraybuffer":return s.arrayBuffer();case"blob":return s.blob();case"json":return s.json()}return s.text()}return new Promise(((s,n)=>{const i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE)if(200!==i.status&&0!==i.status)n(new Error(i.statusText));else{switch(t){case"arraybuffer":case"blob":case"json":return void s(i.response)}s(i.responseText)}},i.send(null)}))}class wf{constructor(e){let{viewBox:t,userUnit:s,scale:n,rotation:i,offsetX:a=0,offsetY:r=0,dontFlip:o=!1}=e;this.viewBox=t,this.userUnit=s,this.scale=n,this.rotation=i,this.offsetX=a,this.offsetY=r,n*=s;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let d,h,u,p,f,m,g,b;switch(i%=360,i<0&&(i+=360),i){case 180:d=-1,h=0,u=0,p=1;break;case 90:d=0,h=1,u=1,p=0;break;case 270:d=0,h=-1,u=-1,p=0;break;case 0:d=1,h=0,u=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(u=-u,p=-p),0===d?(f=Math.abs(c-t[1])*n+a,m=Math.abs(l-t[0])*n+r,g=(t[3]-t[1])*n,b=(t[2]-t[0])*n):(f=Math.abs(l-t[0])*n+a,m=Math.abs(c-t[1])*n+r,g=(t[2]-t[0])*n,b=(t[3]-t[1])*n),this.transform=[d*n,h*n,u*n,p*n,f-d*n*l-u*n*c,m-h*n*l-p*n*c],this.width=g,this.height=b}get rawDims(){const{userUnit:e,viewBox:t}=this,s=t.map((t=>t*e));return Qp(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone(){let{scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:n=this.offsetY,dontFlip:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new wf({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:i})}convertToViewportPoint(e,t){return pf.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=pf.applyTransform([e[0],e[1]],this.transform),s=pf.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return pf.applyInverseTransform([e,t],this.transform)}}class _f extends Zp{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(e,"RenderingCancelledException"),this.extraDelay=t}}function Sf(e){const t=e.length;let s=0;for(;s<t&&""===e[s].trim();)s++;return"data:"===e.substring(s,s+5).toLowerCase()}function Af(e){return"string"===typeof e&&/\.pdf$/i.test(e)}function kf(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)}function Ef(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof e)return t;if(Sf(e))return Xp('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,n=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e);let i=s.exec(n[1])||s.exec(n[2])||s.exec(n[3]);if(i&&(i=i[0],i.includes("%")))try{i=s.exec(decodeURIComponent(i))[0]}catch{}return i||t}class Cf{started=(()=>Object.create(null))();times=[];time(e){e in this.started&&Xp(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Xp(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:n,end:i}of this.times)e.push(`${s.padEnd(t)} ${i-n}ms\n`);return e.join("")}}function jf(e,t){try{const{protocol:s}=t?new URL(e,t):new URL(e);return"http:"===s||"https:"===s}catch{return!1}}function Nf(e){e.preventDefault()}function Tf(e){e.preventDefault(),e.stopPropagation()}class Pf{static#s;static toDateObject(e){if(!e||"string"!==typeof e)return null;this.#s||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#s.exec(e);if(!t)return null;const s=parseInt(t[1],10);let n=parseInt(t[2],10);n=n>=1&&n<=12?n-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let r=parseInt(t[5],10);r=r>=0&&r<=59?r:0;let o=parseInt(t[6],10);o=o>=0&&o<=59?o:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(a+=c,r+=d):"+"===l&&(a-=c,r-=d),new Date(Date.UTC(s,n,i,a,r,o))}}function Mf(e,t){let{scale:s=1,rotation:n=0}=t;const{width:i,height:a}=e.attributes.style,r=[0,0,parseInt(i),parseInt(a)];return new wf({viewBox:r,userUnit:1,scale:s,rotation:n})}function Rf(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map((e=>parseInt(e))):e.startsWith("rgba(")?e.slice(5,-1).split(",").map((e=>parseInt(e))).slice(0,3):(Xp(`Not a valid color format: "${e}"`),[0,0,0])}function If(e){const{a:t,b:s,c:n,d:i,e:a,f:r}=e.getTransform();return[t,s,n,i,a,r]}function Df(e){const{a:t,b:s,c:n,d:i,e:a,f:r}=e.getTransform().invertSelf();return[t,s,n,i,a,r]}function Lf(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t instanceof wf){const{pageWidth:n,pageHeight:i}=t.rawDims,{style:a}=e,r=hf.isCSSRoundSupported,o=`var(--scale-factor) * ${n}px`,l=`var(--scale-factor) * ${i}px`,c=r?`round(down, ${o}, var(--scale-round-x, 1px))`:`calc(${o})`,d=r?`round(down, ${l}, var(--scale-round-y, 1px))`:`calc(${l})`;s&&t.rotation%180!==0?(a.width=d,a.height=c):(a.width=c,a.height=d)}n&&e.setAttribute("data-main-rotation",t.rotation)}class Of{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}}class Ff{#n=null;#i=null;#a;#r=null;#o=null;static#l=null;constructor(e){this.#a=e,Ff.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#n=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#a._uiManager._signal;e.addEventListener("contextmenu",Nf,{signal:t}),e.addEventListener("pointerdown",Ff.#c,{signal:t});const s=this.#r=document.createElement("div");s.className="buttons",e.append(s);const n=this.#a.toolbarPosition;if(n){const{style:t}=e,s="ltr"===this.#a._uiManager.direction?1-n[0]:n[0];t.insetInlineEnd=100*s+"%",t.top=`calc(${100*n[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),e}get div(){return this.#n}static#c(e){e.stopPropagation()}#h(e){this.#a._focusEventsAllowed=!1,Tf(e)}#u(e){this.#a._focusEventsAllowed=!0,Tf(e)}#p(e){const t=this.#a._uiManager._signal;e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Nf,{signal:t})}hide(){this.#n.classList.add("hidden"),this.#i?.hideDropdown()}show(){this.#n.classList.remove("hidden"),this.#o?.shown()}#d(){const{editorType:e,_uiManager:t}=this.#a,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",Ff.#l[e]),this.#p(s),s.addEventListener("click",(e=>{t.delete()}),{signal:t._signal}),this.#r.append(s)}get#f(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#p(t),this.#r.prepend(t,this.#f),this.#o=e}addColorPicker(e){this.#i=e;const t=e.renderButton();this.#p(t),this.#r.prepend(t,this.#f)}remove(){this.#n.remove(),this.#i?.destroy(),this.#i=null}}class zf{#r=null;#n=null;#m;constructor(e){this.#m=e}#g(){const e=this.#n=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Nf,{signal:this.#m._signal});const t=this.#r=document.createElement("div");return t.className="buttons",e.append(t),this.#b(),e}#v(e,t){let s=0,n=0;for(const i of e){const e=i.y+i.height;if(e<s)continue;const a=i.x+(t?i.width:0);e>s?(n=a,s=e):t?a>n&&(n=a):a<n&&(n=a)}return[t?1-n:n,s]}show(e,t,s){const[n,i]=this.#v(t,s),{style:a}=this.#n||=this.#g();e.append(this.#n),a.insetInlineEnd=100*n+"%",a.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){this.#n.remove()}#b(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#m._signal;e.addEventListener("contextmenu",Nf,{signal:s}),e.addEventListener("click",(()=>{this.#m.highlightSelection("floating_button")}),{signal:s}),this.#r.append(e)}}function $f(e,t,s){for(const n of s)t.addEventListener(n,e[n].bind(e))}class Bf{#y=0;get id(){return"pdfjs_internal_editor_"+this.#y++}}class Hf{#x=(()=>function(){if("function"===typeof crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);return crypto.getRandomValues(e),lf(e)}())();#y=0;#w=null;static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';return Qp(this,"_isSVGFittingCanvas",t.decode().then((()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]))))}async#_(e,t){this.#w||=new Map;let s=this.#w.get(e);if(null===s)return null;if(s?.bitmap)return s.refCounter+=1,s;try{let e;if(s||={bitmap:null,id:`image_${this.#x}_${this.#y++}`,refCounter:0,isSvg:!1},"string"===typeof t?(s.url=t,e=await xf(t,"blob")):t instanceof File?e=s.file=t:t instanceof Blob&&(e=t),"image/svg+xml"===e.type){const t=Hf._isSVGFittingCanvas,n=new FileReader,i=new Image,a=new Promise(((e,a)=>{i.onload=()=>{s.bitmap=i,s.isSvg=!0,e()},n.onload=async()=>{const e=s.svgUrl=n.result;i.src=await t?`${e}#svgView(preserveAspectRatio(none))`:e},i.onerror=n.onerror=a}));n.readAsDataURL(e),await a}else s.bitmap=await createImageBitmap(e);s.refCounter=1}catch(zS){Xp(zS),s=null}return this.#w.set(e,s),s&&this.#w.set(s.id,s),s}async getFromFile(e){const{lastModified:t,name:s,size:n,type:i}=e;return this.#_(`${t}_${s}_${n}_${i}`,e)}async getFromUrl(e){return this.#_(e,e)}async getFromBlob(e,t){const s=await t;return this.#_(e,s)}async getFromId(e){this.#w||=new Map;const t=this.#w.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:e}=t;return delete t.blobPromise,this.getFromBlob(t.id,e)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#w||=new Map;let s=this.#w.get(e);if(s?.bitmap)return s.refCounter+=1,s;const n=new OffscreenCanvas(t.width,t.height);return n.getContext("2d").drawImage(t,0,0),s={bitmap:n.transferToImageBitmap(),id:`image_${this.#x}_${this.#y++}`,refCounter:1,isSvg:!1},this.#w.set(e,s),this.#w.set(s.id,s),s}getSvgUrl(e){const t=this.#w.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#w||=new Map;const t=this.#w.get(e);if(!t)return;if(t.refCounter-=1,0!==t.refCounter)return;const{bitmap:s}=t;if(!t.url&&!t.file){const e=new OffscreenCanvas(s.width,s.height);e.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=e.convertToBlob()}s.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#x}_`)}}class Uf{#S=[];#A=!1;#k;#E=-1;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;this.#k=e}add(e){let{cmd:t,undo:s,post:n,mustExec:i,type:a=NaN,overwriteIfSameType:r=!1,keepUndo:o=!1}=e;if(i&&t(),this.#A)return;const l={cmd:t,undo:s,post:n,type:a};if(-1===this.#E)return this.#S.length>0&&(this.#S.length=0),this.#E=0,void this.#S.push(l);if(r&&this.#S[this.#E].type===a)return o&&(l.undo=this.#S[this.#E].undo),void(this.#S[this.#E]=l);const c=this.#E+1;c===this.#k?this.#S.splice(0,1):(this.#E=c,c<this.#S.length&&this.#S.splice(c)),this.#S.push(l)}undo(){if(-1===this.#E)return;this.#A=!0;const{undo:e,post:t}=this.#S[this.#E];e(),t?.(),this.#A=!1,this.#E-=1}redo(){if(this.#E<this.#S.length-1){this.#E+=1,this.#A=!0;const{cmd:e,post:t}=this.#S[this.#E];e(),t?.(),this.#A=!1}}hasSomethingToUndo(){return-1!==this.#E}hasSomethingToRedo(){return this.#E<this.#S.length-1}cleanType(e){if(-1!==this.#E){for(let t=this.#E;t>=0;t--)if(this.#S[t].type!==e)return this.#S.splice(t+1,this.#E-t),void(this.#E=t);this.#S.length=0,this.#E=-1}}destroy(){this.#S=null}}class Vf{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=hf.platform;for(const[s,n,i={}]of e)for(const e of s){const s=e.startsWith("mac+");t&&s?(this.callbacks.set(e.slice(4),{callback:n,options:i}),this.allKeys.add(e.split("+").at(-1))):t||s||(this.callbacks.set(e,{callback:n,options:i}),this.allKeys.add(e.split("+").at(-1)))}}#C(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(this.#C(t));if(!s)return;const{callback:n,options:{bubbles:i=!1,args:a=[],checker:r=null}}=s;r&&!r(e,t)||(n.bind(e,...a,t)(),i||Tf(t))}}class Wf{static _colorsMapping=(()=>new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]))();get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return function(e){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const s of e.keys()){t.style.color=s;const n=window.getComputedStyle(t).color;e.set(s,Rf(n))}t.remove()}(e),Qp(this,"_colors",e)}convert(e){const t=Rf(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,n]of this._colors)if(n.every(((e,s)=>e===t[s])))return Wf._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?pf.makeHexColor(...t):e}}class qf{#j=(()=>new AbortController)();#N=null;#T=(()=>new Map)();#P=(()=>new Map)();#M=null;#R=null;#I=null;#D=(()=>new Uf)();#L=null;#O=null;#F=0;#z=(()=>new Set)();#$=null;#B=null;#H=(()=>new Set)();_editorUndoBar=null;#U=!1;#V=!1;#W=!1;#q=null;#G=null;#X=null;#Y=null;#K=!1;#J=null;#Q=(()=>new Bf)();#Z=!1;#ee=!1;#te=null;#se=null;#ne=null;#ie=null;#ae=(()=>lp.NONE)();#re=(()=>new Set)();#oe=null;#le=null;#ce=null;#de={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#he=[0,0];#ue=null;#pe=null;#fe=null;#me=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=qf.prototype,t=e=>e.#pe.contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&e.hasSomethingToControl(),s=(e,t)=>{let{target:s}=t;if(s instanceof HTMLInputElement){const{type:e}=s;return"text"!==e&&"number"!==e}return!0},n=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return Qp(this,"_keyboardManager",new Vf([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:s}=t;return!(s instanceof HTMLButtonElement)&&e.#pe.contains(s)&&!e.isEnterHandled}}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:s}=t;return!(s instanceof HTMLButtonElement)&&e.#pe.contains(document.activeElement)}}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}constructor(e,t,s,n,i,a,r,o,l,c,d,h,u){const p=this._signal=this.#j.signal;this.#pe=e,this.#fe=t,this.#M=s,this._eventBus=n,n._on("editingaction",this.onEditingAction.bind(this),{signal:p}),n._on("pagechanging",this.onPageChanging.bind(this),{signal:p}),n._on("scalechanging",this.onScaleChanging.bind(this),{signal:p}),n._on("rotationchanging",this.onRotationChanging.bind(this),{signal:p}),n._on("setpreference",this.onSetPreference.bind(this),{signal:p}),n._on("switchannotationeditorparams",(e=>this.updateParams(e.type,e.value)),{signal:p}),this.#ge(),this.#be(),this.#ve(),this.#R=i.annotationStorage,this.#q=i.filterFactory,this.#le=a,this.#Y=r||null,this.#U=o,this.#V=l,this.#W=c,this.#ie=d||null,this.viewParameters={realScale:yf.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=h||null,this._supportsPinchToZoom=!1!==u}destroy(){this.#me?.resolve(),this.#me=null,this.#j?.abort(),this.#j=null,this._signal=null;for(const e of this.#P.values())e.destroy();this.#P.clear(),this.#T.clear(),this.#H.clear(),this.#N=null,this.#re.clear(),this.#D.destroy(),this.#M?.destroy(),this.#J?.hide(),this.#J=null,this.#G&&(clearTimeout(this.#G),this.#G=null),this.#ue&&(clearTimeout(this.#ue),this.#ue=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#ie}get useNewAltTextFlow(){return this.#V}get useNewAltTextWhenAddingImage(){return this.#W}get hcmFilter(){return Qp(this,"hcmFilter",this.#le?this.#q.addHCMFilter(this.#le.foreground,this.#le.background):"none")}get direction(){return Qp(this,"direction",getComputedStyle(this.#pe).direction)}get highlightColors(){return Qp(this,"highlightColors",this.#Y?new Map(this.#Y.split(",").map((e=>e.split("=").map((e=>e.trim()))))):null)}get highlightColorNames(){return Qp(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,(e=>e.reverse()))):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#O=e}setMainHighlightColorPicker(e){this.#ne=e}editAltText(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.#M?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference(e){let{name:t,value:s}=e;if("enableNewAltTextWhenAddingImage"===t)this.#W=s}onPageChanging(e){let{pageNumber:t}=e;this.#F=t-1}focusMainContainer(){this.#pe.focus()}findParent(e,t){for(const s of this.#P.values()){const{x:n,y:i,width:a,height:r}=s.div.getBoundingClientRect();if(e>=n&&e<=n+a&&t>=i&&t<=i+r)return s}return null}disableUserSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.#fe.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#H.add(e)}removeShouldRescale(e){this.#H.delete(e)}onScaleChanging(e){let{scale:t}=e;this.commitOrRemove(),this.viewParameters.realScale=t*yf.PDF_TO_CSS_UNITS;for(const s of this.#H)s.onScaleChanging();this.#O?.onScaleChanging()}onRotationChanging(e){let{pagesRotation:t}=e;this.commitOrRemove(),this.viewParameters.rotation=t}#ye(e){let{anchorNode:t}=e;return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#xe(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of this.#P.values())if(s.hasTextLayer(e))return s;return null}highlightSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:n,focusNode:i,focusOffset:a}=t,r=t.toString(),o=this.#ye(t).closest(".textLayer"),l=this.getSelectionBoxes(o);if(!l)return;t.empty();const c=this.#xe(o),d=this.#ae===lp.NONE,h=()=>{c?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:l,anchorNode:s,anchorOffset:n,focusNode:i,focusOffset:a,text:r}),d&&this.showAllEditors("highlight",!0,!0)};d?this.switchToMode(lp.HIGHLIGHT,h):h()}#we(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=this.#ye(e).closest(".textLayer"),s=this.getSelectionBoxes(t);s&&(this.#J||=new zf(this),this.#J.show(t,s,"ltr"===this.direction))}addToAnnotationStorage(e){e.isEmpty()||!this.#R||this.#R.has(e.id)||this.#R.setValue(e.id,e)}#_e(){const e=document.getSelection();if(!e||e.isCollapsed)return void(this.#oe&&(this.#J?.hide(),this.#oe=null,this.#Se({hasSelectedText:!1})));const{anchorNode:t}=e;if(t===this.#oe)return;const s=this.#ye(e).closest(".textLayer");if(s){if(this.#J?.hide(),this.#oe=t,this.#Se({hasSelectedText:!0}),(this.#ae===lp.HIGHLIGHT||this.#ae===lp.NONE)&&(this.#ae===lp.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#K=this.isShiftKeyDown,!this.isShiftKeyDown)){const e=this.#ae===lp.HIGHLIGHT?this.#xe(s):null;e?.toggleDrawing();const t=new AbortController,n=this.combinedSignal(t),i=s=>{"pointerup"===s.type&&0!==s.button||(t.abort(),e?.toggleDrawing(!0),"pointerup"===s.type&&this.#Ae("main_toolbar"))};window.addEventListener("pointerup",i,{signal:n}),window.addEventListener("blur",i,{signal:n})}}else this.#oe&&(this.#J?.hide(),this.#oe=null,this.#Se({hasSelectedText:!1}))}#Ae(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.#ae===lp.HIGHLIGHT?this.highlightSelection(e):this.#U&&this.#we()}#ge(){document.addEventListener("selectionchange",this.#_e.bind(this),{signal:this._signal})}#ke(){if(this.#X)return;this.#X=new AbortController;const e=this.combinedSignal(this.#X);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#Ee(){this.#X?.abort(),this.#X=null}blur(){if(this.isShiftKeyDown=!1,this.#K&&(this.#K=!1,this.#Ae("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#re)if(t.div.contains(e)){this.#se=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#se)return;const[e,t]=this.#se;this.#se=null,t.addEventListener("focusin",(()=>{e._focusEventsAllowed=!0}),{once:!0,signal:this._signal}),t.focus()}#ve(){if(this.#te)return;this.#te=new AbortController;const e=this.combinedSignal(this.#te);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#Ce(){this.#te?.abort(),this.#te=null}#je(){if(this.#L)return;this.#L=new AbortController;const e=this.combinedSignal(this.#L);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#Ne(){this.#L?.abort(),this.#L=null}#be(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#ve(),this.#je()}removeEditListeners(){this.#Ce(),this.#Ne()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of this.#B)if(s.isHandlingMimeForPasting(t))return e.dataTransfer.dropEffect="copy",void e.preventDefault()}drop(e){for(const t of e.dataTransfer.items)for(const s of this.#B)if(s.isHandlingMimeForPasting(t.type))return s.paste(t,this.currentLayer),void e.preventDefault()}copy(e){if(e.preventDefault(),this.#N?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of this.#re){const e=s.serialize(!0);e&&t.push(e)}0!==t.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const a of t.items)for(const e of this.#B)if(e.isHandlingMimeForPasting(a.type))return void e.paste(a,this.currentLayer);let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){return void Xp(`paste: "${i.message}".`)}if(!Array.isArray(s))return;this.unselectAll();const n=this.currentLayer;try{const e=[];for(const a of s){const t=await n.deserialize(a);if(!t)return;e.push(t)}const t=()=>{for(const t of e)this.#Te(t);this.#Pe(e)},i=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:i,mustExec:!0})}catch(i){Xp(`paste: "${i.message}".`)}}keydown(e){this.isShiftKeyDown||"Shift"!==e.key||(this.isShiftKeyDown=!0),this.#ae===lp.NONE||this.isEditorHandlingKeyboard||qf._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&"Shift"===e.key&&(this.isShiftKeyDown=!1,this.#K&&(this.#K=!1,this.#Ae("main_toolbar")))}onEditingAction(e){let{name:t}=e;switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu")}}#Se(e){Object.entries(e).some((e=>{let[t,s]=e;return this.#de[t]!==s}))&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#de,e)}),this.#ae===lp.HIGHLIGHT&&!1===e.hasSelectedEditor&&this.#Me([[cp.HIGHLIGHT_FREE,!0]]))}#Me(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ke(),this.#je(),this.#Se({isEditing:this.#ae!==lp.NONE,isEmpty:this.#Re(),hasSomethingToUndo:this.#D.hasSomethingToUndo(),hasSomethingToRedo:this.#D.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#Ee(),this.#Ne(),this.#Se({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#B){this.#B=e;for(const e of this.#B)this.#Me(e.defaultPropertiesToUpdate)}}getId(){return this.#Q.id}get currentLayer(){return this.#P.get(this.#F)}getLayer(e){return this.#P.get(e)}get currentPageIndex(){return this.#F}addLayer(e){this.#P.set(e.pageIndex,e),this.#Z?e.enable():e.disable()}removeLayer(e){this.#P.delete(e.pageIndex)}async updateMode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.#ae!==e&&(!this.#me||(await this.#me.promise,this.#me))){if(this.#me=Promise.withResolvers(),this.#ae=e,e===lp.NONE)return this.setEditingState(!1),this.#Ie(),this._editorUndoBar?.hide(),void this.#me.resolve();this.setEditingState(!0),await this.#De(),this.unselectAll();for(const t of this.#P.values())t.updateMode(e);if(!t)return s&&this.addNewEditorFromKeyboard(),void this.#me.resolve();for(const e of this.#T.values())e.annotationElementId===t?(this.setSelected(e),e.enterInEditMode()):e.unselect();this.#me.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#ae&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#B){switch(e){case cp.CREATE:return void this.currentLayer.addNewEditor();case cp.HIGHLIGHT_DEFAULT_COLOR:this.#ne?.updateColor(t);break;case cp.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#ce||=new Map).set(e,t),this.showAllEditors("highlight",t)}for(const s of this.#re)s.updateParams(e,t);for(const s of this.#B)s.updateDefaultParams(e,t)}}showAllEditors(e,t){for(const s of this.#T.values())s.editorType===e&&s.show(t);(this.#ce?.get(cp.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#Me([[cp.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.#ee!==e){this.#ee=e;for(const t of this.#P.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#De(){if(!this.#Z){this.#Z=!0;const e=[];for(const t of this.#P.values())e.push(t.enable());await Promise.all(e);for(const t of this.#T.values())t.enable()}}#Ie(){if(this.unselectAll(),this.#Z){this.#Z=!1;for(const e of this.#P.values())e.disable();for(const e of this.#T.values())e.disable()}}getEditors(e){const t=[];for(const s of this.#T.values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return this.#T.get(e)}addEditor(e){this.#T.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#G&&clearTimeout(this.#G),this.#G=setTimeout((()=>{this.focusMainContainer(),this.#G=null}),0)),this.#T.delete(e.id),this.unselect(e),e.annotationElementId&&this.#z.has(e.annotationElementId)||this.#R?.remove(e.id)}addDeletedAnnotationElement(e){this.#z.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#z.has(e)}removeDeletedAnnotationElement(e){this.#z.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#Te(e){const t=this.#P.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#N!==e&&(this.#N=e,e&&this.#Me(e.propertiesToUpdate))}get#Le(){let e=null;for(e of this.#re);return e}updateUI(e){this.#Le===e&&this.#Me(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#Me(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#re.has(e))return this.#re.delete(e),e.unselect(),void this.#Se({hasSelectedEditor:this.hasSelection});this.#re.add(e),e.select(),this.#Me(e.propertiesToUpdate),this.#Se({hasSelectedEditor:!0})}setSelected(e){this.#O?.commitOrRemove();for(const t of this.#re)t!==e&&t.unselect();this.#re.clear(),this.#re.add(e),e.select(),this.#Me(e.propertiesToUpdate),this.#Se({hasSelectedEditor:!0})}isSelected(e){return this.#re.has(e)}get firstSelectedEditor(){return this.#re.values().next().value}unselect(e){e.unselect(),this.#re.delete(e),this.#Se({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#re.size}get isEnterHandled(){return 1===this.#re.size&&this.firstSelectedEditor.isEnterHandled}undo(){this.#D.undo(),this.#Se({hasSomethingToUndo:this.#D.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Re()}),this._editorUndoBar?.hide()}redo(){this.#D.redo(),this.#Se({hasSomethingToUndo:!0,hasSomethingToRedo:this.#D.hasSomethingToRedo(),isEmpty:this.#Re()})}addCommands(e){this.#D.add(e),this.#Se({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Re()})}cleanUndoStack(e){this.#D.cleanType(e)}#Re(){if(0===this.#T.size)return!0;if(1===this.#T.size)for(const e of this.#T.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#re],s=()=>{for(const e of t)this.#Te(e)};this.addCommands({cmd:()=>{this._editorUndoBar?.show(s,1===t.length?t[0].editorType:t.length);for(const e of t)e.remove()},undo:s,mustExec:!0})}commitOrRemove(){this.#N?.commitOrRemove()}hasSomethingToControl(){return this.#N||this.hasSelection}#Pe(e){for(const t of this.#re)t.unselect();this.#re.clear();for(const t of e)t.isEmpty()||(this.#re.add(t),t.select());this.#Se({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#re)e.commit();this.#Pe(this.#T.values())}unselectAll(){if((!this.#N||(this.#N.commitOrRemove(),this.#ae===lp.NONE))&&!this.#O?.commitOrRemove()&&this.hasSelection){for(const e of this.#re)e.unselect();this.#re.clear(),this.#Se({hasSelectedEditor:!1})}}translateSelectedEditors(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.commitOrRemove(),!this.hasSelection)return;this.#he[0]+=e,this.#he[1]+=t;const[s,n]=this.#he,i=[...this.#re];this.#ue&&clearTimeout(this.#ue),this.#ue=setTimeout((()=>{this.#ue=null,this.#he[0]=this.#he[1]=0,this.addCommands({cmd:()=>{for(const e of i)this.#T.has(e.id)&&e.translateInPage(s,n)},undo:()=>{for(const e of i)this.#T.has(e.id)&&e.translateInPage(-s,-n)},mustExec:!1})}),1e3);for(const a of i)a.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#$=new Map;for(const e of this.#re)this.#$.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#$)return!1;this.disableUserSelect(!1);const e=this.#$;this.#$=null;let t=!1;for(const[{x:n,y:i,pageIndex:a},r]of e)r.newX=n,r.newY=i,r.newPageIndex=a,t||=n!==r.savedX||i!==r.savedY||a!==r.savedPageIndex;if(!t)return!1;const s=(e,t,s,n)=>{if(this.#T.has(e.id)){const i=this.#P.get(n);i?e._setParentAndPosition(i,t,s):(e.pageIndex=n,e.x=t,e.y=s)}};return this.addCommands({cmd:()=>{for(const[t,{newX:n,newY:i,newPageIndex:a}]of e)s(t,n,i,a)},undo:()=>{for(const[t,{savedX:n,savedY:i,savedPageIndex:a}]of e)s(t,n,i,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#$)for(const s of this.#$.keys())s.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===this.#re.size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#N===e}getActive(){return this.#N}getMode(){return this.#ae}get imageManager(){return Qp(this,"imageManager",new Hf)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let l=0,c=t.rangeCount;l<c;l++)if(!e.contains(t.getRangeAt(l).commonAncestorContainer))return null;const{x:s,y:n,width:i,height:a}=e.getBoundingClientRect();let r;switch(e.getAttribute("data-main-rotation")){case"90":r=(e,t,r,o)=>({x:(t-n)/a,y:1-(e+r-s)/i,width:o/a,height:r/i});break;case"180":r=(e,t,r,o)=>({x:1-(e+r-s)/i,y:1-(t+o-n)/a,width:r/i,height:o/a});break;case"270":r=(e,t,r,o)=>({x:1-(t+o-n)/a,y:(e-s)/i,width:o/a,height:r/i});break;default:r=(e,t,r,o)=>({x:(e-s)/i,y:(t-n)/a,width:r/i,height:o/a})}const o=[];for(let l=0,c=t.rangeCount;l<c;l++){const e=t.getRangeAt(l);if(!e.collapsed)for(const{x:t,y:s,width:n,height:i}of e.getClientRects())0!==n&&0!==i&&o.push(r(t,s,n,i))}return 0===o.length?null:o}addChangedExistingAnnotation(e){let{annotationElementId:t,id:s}=e;(this.#I||=new Map).set(t,s)}removeChangedExistingAnnotation(e){let{annotationElementId:t}=e;this.#I?.delete(t)}renderAnnotationElement(e){const t=this.#I?.get(e.data.id);if(!t)return;const s=this.#R.getRawValue(t);s&&(this.#ae!==lp.NONE||s.hasBeenModified)&&s.renderAnnotationElement(e)}}class Gf{#o=null;#Oe=!1;#Fe=null;#ze=null;#$e=null;#Be=null;#He=!1;#Ue=null;#a=null;#Ve=null;#We=null;#qe=!1;static#Ge=null;static _l10n=null;constructor(e){this.#a=e,this.#qe=e._uiManager.useNewAltTextFlow,Gf.#Ge||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Gf._l10n??=e}async render(){const e=this.#Fe=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#ze=document.createElement("span");e.append(t),this.#qe?(e.classList.add("new"),e.setAttribute("data-l10n-id",Gf.#Ge.missing),t.setAttribute("data-l10n-id",Gf.#Ge["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#a._uiManager._signal;e.addEventListener("contextmenu",Nf,{signal:s}),e.addEventListener("pointerdown",(e=>e.stopPropagation()),{signal:s});const n=e=>{e.preventDefault(),this.#a._uiManager.editAltText(this.#a),this.#qe&&this.#a._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#Xe}})};return e.addEventListener("click",n,{capture:!0,signal:s}),e.addEventListener("keydown",(t=>{t.target===e&&"Enter"===t.key&&(this.#He=!0,n(t))}),{signal:s}),await this.#Ye(),e}get#Xe(){return(this.#o?"added":null===this.#o&&this.guessedText&&"review")||"missing"}finish(){this.#Fe&&(this.#Fe.focus({focusVisible:this.#He}),this.#He=!1)}isEmpty(){return this.#qe?null===this.#o:!this.#o&&!this.#Oe}hasData(){return this.#qe?null!==this.#o||!!this.#Ve:this.isEmpty()}get guessedText(){return this.#Ve}async setGuessedText(e){null===this.#o&&(this.#Ve=e,this.#We=await Gf._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#Ye())}toggleAltTextBadge(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.#qe||this.#o)return this.#Ue?.remove(),void(this.#Ue=null);if(!this.#Ue){const e=this.#Ue=document.createElement("div");e.className="noAltTextBadge",this.#a.div.append(e)}this.#Ue.classList.toggle("hidden",!e)}serialize(e){let t=this.#o;return e||this.#Ve!==t||(t=this.#We),{altText:t,decorative:this.#Oe,guessedText:this.#Ve,textWithDisclaimer:this.#We}}get data(){return{altText:this.#o,decorative:this.#Oe}}set data(e){let{altText:t,decorative:s,guessedText:n,textWithDisclaimer:i,cancel:a=!1}=e;n&&(this.#Ve=n,this.#We=i),this.#o===t&&this.#Oe===s||(a||(this.#o=t,this.#Oe=s),this.#Ye())}toggle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.#Fe&&(!e&&this.#Be&&(clearTimeout(this.#Be),this.#Be=null),this.#Fe.disabled=!e)}shown(){this.#a._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#Xe}})}destroy(){this.#Fe?.remove(),this.#Fe=null,this.#ze=null,this.#$e=null,this.#Ue?.remove(),this.#Ue=null}async#Ye(){const e=this.#Fe;if(!e)return;if(this.#qe){if(e.classList.toggle("done",!!this.#o),e.setAttribute("data-l10n-id",Gf.#Ge[this.#Xe]),this.#ze?.setAttribute("data-l10n-id",Gf.#Ge[`${this.#Xe}-label`]),!this.#o)return void this.#$e?.remove()}else{if(!this.#o&&!this.#Oe)return e.classList.remove("done"),void this.#$e?.remove();e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#$e;if(!t){this.#$e=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#a.id}`;const s=100,n=this.#a._uiManager._signal;n.addEventListener("abort",(()=>{clearTimeout(this.#Be),this.#Be=null}),{once:!0}),e.addEventListener("mouseenter",(()=>{this.#Be=setTimeout((()=>{this.#Be=null,this.#$e.classList.add("show"),this.#a._reportTelemetry({action:"alt_text_tooltip"})}),s)}),{signal:n}),e.addEventListener("mouseleave",(()=>{this.#Be&&(clearTimeout(this.#Be),this.#Be=null),this.#$e?.classList.remove("show")}),{signal:n})}this.#Oe?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#o),t.parentNode||e.append(t);const s=this.#a.getImageForAltText();s?.setAttribute("aria-describedby",t.id)}}class Xf{#pe;#Ke=!1;#Je=null;#Qe;#Ze;#et;#tt;#st;#nt=null;#it;#at=null;constructor(e){let{container:t,isPinchingDisabled:s=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:a=null,onPinchEnd:r=null,signal:o}=e;this.#pe=t,this.#Je=n,this.#Qe=s,this.#Ze=i,this.#et=a,this.#tt=r,this.#it=new AbortController,this.#st=AbortSignal.any([o,this.#it.signal]),t.addEventListener("touchstart",this.#rt.bind(this),{passive:!1,signal:this.#st})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Qp(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#rt(e){if(this.#Qe?.()||e.touches.length<2)return;if(!this.#at){this.#at=new AbortController;const e=AbortSignal.any([this.#st,this.#at.signal]),t=this.#pe,s={signal:e,passive:!1};t.addEventListener("touchmove",this.#ot.bind(this),s),t.addEventListener("touchend",this.#lt.bind(this),s),t.addEventListener("touchcancel",this.#lt.bind(this),s),this.#Ze?.()}if(Tf(e),2!==e.touches.length||this.#Je?.())return void(this.#nt=null);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),this.#nt={touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#ot(e){if(!this.#nt||2!==e.touches.length)return;let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:n,screenY:i}=t,{screenX:a,screenY:r}=s,o=this.#nt,{touch0X:l,touch0Y:c,touch1X:d,touch1Y:h}=o,u=d-l,p=h-c,f=a-n,m=r-i,g=Math.hypot(f,m)||1,b=Math.hypot(u,p)||1;if(!this.#Ke&&Math.abs(b-g)<=Xf.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(o.touch0X=n,o.touch0Y=i,o.touch1X=a,o.touch1Y=r,e.preventDefault(),!this.#Ke)return void(this.#Ke=!0);const v=[(n+a)/2,(i+r)/2];this.#et?.(v,b,g)}#lt(e){this.#at.abort(),this.#at=null,this.#tt?.(),this.#nt&&(e.preventDefault(),this.#nt=null,this.#Ke=!1)}destroy(){this.#it?.abort(),this.#it=null}}class Yf{#ct=null;#dt=null;#o=null;#ht=!1;#ut=null;#pt="";#ft=!1;#mt=null;#gt=null;#bt=null;#vt=null;#yt="";#xt=!1;#wt=null;#_t=!1;#St=!1;#At=!1;#kt=null;#Et=0;#Ct=0;#jt=null;#Nt=null;_editToolbar=null;_initialOptions=(()=>Object.create(null))();_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#Tt=!1;#Pt=(()=>Yf._zIndex++)();static _borderLineWidth=-1;static _colorManager=(()=>new Wf)();static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Yf.prototype._resizeWithKeyboard,t=qf.TRANSLATE_SMALL,s=qf.TRANSLATE_BIG;return Qp(this,"_resizerKeyboardManager",new Vf([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],Yf.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:n,pageX:i,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,n],this.pageTranslation=[i,a];const[r,o]=this.parentDimensions;this.x=e.x/r,this.y=e.y/o,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Qp(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Kf({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Yf._l10n??=e,Yf._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),-1!==Yf._borderLineWidth)return;const s=getComputedStyle(document.documentElement);Yf._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Yp("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#Tt}set _isDraggable(e){this.#Tt=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#Pt}setParent(e){null!==e?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#Mt(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#xt?this.#xt=!1:this.parent.setSelected(this))}focusout(e){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const t=e.relatedTarget;t?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,n){const[i,a]=this.parentDimensions;[s,n]=this.screenToPageTranslation(s,n),this.x=(e+s)/i,this.y=(t+n)/a,this.fixAndSetPosition()}#Rt(e,t,s){let[n,i]=e;[t,s]=this.screenToPageTranslation(t,s),this.x+=t/n,this.y+=s/i,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#Rt(this.parentDimensions,e,t)}translateInPage(e,t){this.#wt||=[this.x,this.y,this.width,this.height],this.#Rt(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#wt||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[n,i]}=this;if(this.x+=e/n,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:r}=this;const[o,l]=this.getBaseTranslation();a+=o,r+=l;const{style:c}=s;c.left=`${(100*a).toFixed(2)}%`,c.top=`${(100*r).toFixed(2)}%`,this._onTranslating(a,r),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#wt&&(this.#wt[0]!==this.x||this.#wt[1]!==this.y)}get _hasBeenResized(){return!!this.#wt&&(this.#wt[2]!==this.width||this.#wt[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=Yf,n=s/e,i=s/t;switch(this.rotation){case 90:return[-n,i];case 180:return[n,i];case 270:return[n,-i];default:return[-n,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rotation;const{div:{style:t},pageDimensions:[s,n]}=this;let{x:i,y:a,width:r,height:o}=this;if(r*=s,o*=n,i*=s,a*=n,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(s-r,i)),a=Math.max(0,Math.min(n-o,a));break;case 90:i=Math.max(0,Math.min(s-o,i)),a=Math.min(n,Math.max(r,a));break;case 180:i=Math.min(s,Math.max(r,i)),a=Math.min(n,Math.max(o,a));break;case 270:i=Math.min(s,Math.max(o,i)),a=Math.max(0,Math.min(n-r,a))}this.x=i/=s,this.y=a/=n;const[l,c]=this.getBaseTranslation();i+=l,a+=c,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#It(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Yf.#It(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Yf.#It(e,t,360-this.parentRotation)}#Dt(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,n]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/s).toFixed(2)}%`,this.#ft||(i.height=`${(100*t/n).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,n=s.endsWith("%"),i=!this.#ft&&t.endsWith("%");if(n&&i)return;const[a,r]=this.parentDimensions;n||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),this.#ft||i||(e.height=`${(100*parseFloat(t)/r).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#Lt(){if(this.#mt)return;this.#mt=document.createElement("div"),this.#mt.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const e=document.createElement("div");this.#mt.append(e),e.classList.add("resizer",s),e.setAttribute("data-resizer-name",s),e.addEventListener("pointerdown",this.#Ot.bind(this,s),{signal:t}),e.addEventListener("contextmenu",Nf,{signal:t}),e.tabIndex=-1}this.div.prepend(this.#mt)}#Ot(e,t){t.preventDefault();const{isMac:s}=hf.platform;if(0!==t.button||t.ctrlKey&&s)return;this.#o?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,this.#gt=[t.screenX,t.screenY];const i=new AbortController,a=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#Ft.bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Tf,{passive:!1,signal:a}),window.addEventListener("contextmenu",Nf,{signal:a}),this.#bt={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const r=this.parent.div.style.cursor,o=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const l=()=>{i.abort(),this.parent.togglePointerEvents(!0),this.#o?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=r,this.div.style.cursor=o,this.#zt()};window.addEventListener("pointerup",l,{signal:a}),window.addEventListener("blur",l,{signal:a})}#$t(e,t,s,n){this.width=s,this.height=n,this.x=e,this.y=t;const[i,a]=this.parentDimensions;this.setDims(i*s,a*n),this.fixAndSetPosition(),this._onResized()}_onResized(){}#zt(){if(!this.#bt)return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:n}=this.#bt;this.#bt=null;const i=this.x,a=this.y,r=this.width,o=this.height;i===e&&a===t&&r===s&&o===n||this.addCommands({cmd:this.#$t.bind(this,i,a,r,o),undo:this.#$t.bind(this,e,t,s,n),mustExec:!0})}static _round(e){return Math.round(1e4*e)/1e4}#Ft(e,t){const[s,n]=this.parentDimensions,i=this.x,a=this.y,r=this.width,o=this.height,l=Yf.MIN_SIZE/s,c=Yf.MIN_SIZE/n,d=this.#Dt(this.rotation),h=(e,t)=>[d[0]*e+d[2]*t,d[1]*e+d[3]*t],u=this.#Dt(360-this.rotation);let p,f,m=!1,g=!1;switch(e){case"topLeft":m=!0,p=(e,t)=>[0,0],f=(e,t)=>[e,t];break;case"topMiddle":p=(e,t)=>[e/2,0],f=(e,t)=>[e/2,t];break;case"topRight":m=!0,p=(e,t)=>[e,0],f=(e,t)=>[0,t];break;case"middleRight":g=!0,p=(e,t)=>[e,t/2],f=(e,t)=>[0,t/2];break;case"bottomRight":m=!0,p=(e,t)=>[e,t],f=(e,t)=>[0,0];break;case"bottomMiddle":p=(e,t)=>[e/2,t],f=(e,t)=>[e/2,0];break;case"bottomLeft":m=!0,p=(e,t)=>[0,t],f=(e,t)=>[e,0];break;case"middleLeft":g=!0,p=(e,t)=>[0,t/2],f=(e,t)=>[e,t/2]}const b=p(r,o),v=f(r,o);let y=h(...v);const x=Yf._round(i+y[0]),w=Yf._round(a+y[1]);let _,S,A=1,k=1;if(t.fromKeyboard)({deltaX:_,deltaY:S}=t);else{const{screenX:e,screenY:s}=t,[n,i]=this.#gt;[_,S]=this.screenToPageTranslation(e-n,s-i),this.#gt[0]=e,this.#gt[1]=s}if([_,S]=((e,t)=>[u[0]*e+u[2]*t,u[1]*e+u[3]*t])(_/s,S/n),m){const e=Math.hypot(r,o);A=k=Math.max(Math.min(Math.hypot(v[0]-b[0]-_,v[1]-b[1]-S)/e,1/r,1/o),l/r,c/o)}else g?A=Math.max(l,Math.min(1,Math.abs(v[0]-b[0]-_)))/r:k=Math.max(c,Math.min(1,Math.abs(v[1]-b[1]-S)))/o;const E=Yf._round(r*A),C=Yf._round(o*k);y=h(...f(E,C));const j=x-y[0],N=w-y[1];this.#wt||=[this.x,this.y,this.width,this.height],this.width=E,this.height=C,this.x=j,this.y=N,this.setDims(s*E,n*C),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#o?.finish()}async addEditToolbar(){return this._editToolbar||this.#St||(this._editToolbar=new Ff(this),this.div.append(this._editToolbar.render()),this.#o&&await this._editToolbar.addAltText(this.#o)),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#o?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#o||(Gf.initialize(Yf._l10n),this.#o=new Gf(this),this.#ct&&(this.#o.data=this.#ct,this.#ct=null),await this.addEditToolbar())}get altTextData(){return this.#o?.data}set altTextData(e){this.#o&&(this.#o.data=e)}get guessedAltText(){return this.#o?.guessedText}async setGuessedAltText(e){await(this.#o?.setGuessedText(e))}serializeAltText(e){return this.#o?.serialize(e)}hasAltText(){return!!this.#o&&!this.#o.isEmpty()}hasAltTextData(){return this.#o?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#ht?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#Bt();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,n]=this.getInitialTranslation();return this.translate(s,n),$f(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#Nt||=new Xf({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#Ht.bind(this),onPinching:this.#Ut.bind(this),onPinchEnd:this.#Vt.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#Ht(){this.#bt={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#o?.toggle(!1),this.parent.togglePointerEvents(!1)}#Ut(e,t,s){let n=s/t*.7+1-.7;if(1===n)return;const i=this.#Dt(this.rotation),a=(e,t)=>[i[0]*e+i[2]*t,i[1]*e+i[3]*t],[r,o]=this.parentDimensions,l=this.x,c=this.y,d=this.width,h=this.height,u=Yf.MIN_SIZE/r,p=Yf.MIN_SIZE/o;n=Math.max(Math.min(n,1/d,1/h),u/d,p/h);const f=Yf._round(d*n),m=Yf._round(h*n);if(f===d&&m===h)return;this.#wt||=[l,c,d,h];const g=a(d/2,h/2),b=Yf._round(l+g[0]),v=Yf._round(c+g[1]),y=a(f/2,m/2);this.x=b-y[0],this.y=v-y[1],this.width=f,this.height=m,this.setDims(r*f,o*m),this.fixAndSetPosition(),this._onResizing()}#Vt(){this.#o?.toggle(!0),this.parent.togglePointerEvents(!0),this.#zt()}pointerdown(e){const{isMac:t}=hf.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(this.#xt=!0,this._isDraggable?this.#Wt(e):this.#qt(e))}get isSelected(){return this._uiManager.isSelected(this)}#qt(e){const{isMac:t}=hf.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#Wt(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const n=new AbortController,i=this._uiManager.combinedSignal(n),a={capture:!0,passive:!1,signal:i},r=e=>{n.abort(),this.#ut=null,this.#xt=!1,this._uiManager.endDragSession()||this.#qt(e),s&&this._onStopDragging()};t&&(this.#Et=e.clientX,this.#Ct=e.clientY,this.#ut=e.pointerId,this.#pt=e.pointerType,window.addEventListener("pointermove",(e=>{s||(s=!0,this._onStartDragging());const{clientX:t,clientY:n,pointerId:i}=e;if(i!==this.#ut)return void Tf(e);const[a,r]=this.screenToPageTranslation(t-this.#Et,n-this.#Ct);this.#Et=t,this.#Ct=n,this._uiManager.dragSelectedEditors(a,r)}),a),window.addEventListener("touchmove",Tf,a),window.addEventListener("pointerdown",(e=>{e.pointerType===this.#pt&&(this.#Nt||e.isPrimary)&&r(e),Tf(e)}),a));const o=e=>{this.#ut&&this.#ut!==e.pointerId?Tf(e):r(e)};window.addEventListener("pointerup",o,{signal:i}),window.addEventListener("blur",o,{signal:i})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#kt&&clearTimeout(this.#kt),this.#kt=setTimeout((()=>{this.#kt=null,this.parent?.moveEditorInDOM(this)}),0)}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotation;const n=this.parentScale,[i,a]=this.pageDimensions,[r,o]=this.pageTranslation,l=e/n,c=t/n,d=this.x*i,h=this.y*a,u=this.width*i,p=this.height*a;switch(s){case 0:return[d+l+r,a-h-c-p+o,d+l+u+r,a-h-c+o];case 90:return[d+c+r,a-h+l+o,d+c+p+r,a-h+l+u+o];case 180:return[d-l-u+r,a-h+c+o,d-l+r,a-h+c+p+o];case 270:return[d-c-p+r,a-h-l-u+o,d-c+r,a-h-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,n,i,a]=e,r=i-s,o=a-n;switch(this.rotation){case 0:return[s,t-a,r,o];case 90:return[s,t-n,o,r];case 180:return[i,t-n,r,o];case 270:return[i,t-a,o,r];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){this.#St=!0}disableEditMode(){this.#St=!1}isInEditMode(){return this.#St}shouldGetKeyboardEvents(){return this.#At}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:n}=this.getClientDimensions(),{innerHeight:i,innerWidth:a}=window;return t<a&&n>0&&e<i&&s>0}#Bt(){if(this.#vt||!this.div)return;this.#vt=new AbortController;const e=this._uiManager.combinedSignal(this.#vt);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#Bt()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(){Yp("An editor must be serializable")}static async deserialize(e,t,s){const n=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});n.rotation=e.rotation,n.#ct=e.accessibilityData;const[i,a]=n.pageDimensions,[r,o,l,c]=n.getRectInCurrentCoords(e.rect,a);return n.x=r/i,n.y=o/a,n.width=l/i,n.height=c/a,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){if(this.#vt?.abort(),this.#vt=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#kt&&(clearTimeout(this.#kt),this.#kt=null),this.#Mt(),this.removeEditToolbar(),this.#jt){for(const e of this.#jt.values())clearTimeout(e);this.#jt=null}this.parent=null,this.#Nt?.destroy(),this.#Nt=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#Lt(),this.#mt.classList.remove("hidden"),$f(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||"Enter"!==e.key)return;this._uiManager.setSelected(this),this.#bt={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#mt.children;if(!this.#dt){this.#dt=Array.from(t);const e=this.#Gt.bind(this),s=this.#Xt.bind(this),n=this._uiManager._signal;for(const t of this.#dt){const i=t.getAttribute("data-resizer-name");t.setAttribute("role","spinbutton"),t.addEventListener("keydown",e,{signal:n}),t.addEventListener("blur",s,{signal:n}),t.addEventListener("focus",this.#Yt.bind(this,i),{signal:n}),t.setAttribute("data-l10n-id",Yf._l10nResizer[i])}}const s=this.#dt[0];let n=0;for(const a of t){if(a===s)break;n++}const i=(360-this.rotation+this.parentRotation)%360/90*(this.#dt.length/4);if(i!==n){if(i<n)for(let t=0;t<n-i;t++)this.#mt.append(this.#mt.firstChild);else if(i>n)for(let t=0;t<i-n;t++)this.#mt.firstChild.before(this.#mt.lastChild);let e=0;for(const s of t){const t=this.#dt[e++].getAttribute("data-resizer-name");s.setAttribute("data-l10n-id",Yf._l10nResizer[t])}}this.#Kt(0),this.#At=!0,this.#mt.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#Gt(e){Yf._resizerKeyboardManager.exec(this,e)}#Xt(e){this.#At&&e.relatedTarget?.parentNode!==this.#mt&&this.#Mt()}#Yt(e){this.#yt=this.#At?e:""}#Kt(e){if(this.#dt)for(const t of this.#dt)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#At&&this.#Ft(this.#yt,{deltaX:e,deltaY:t,fromKeyboard:!0})}#Mt(){this.#At=!1,this.#Kt(-1),this.#zt()}_stopResizingWithKeyboard(){this.#Mt(),this.div.focus()}select(){this.makeResizable(),this.div?.classList.add("selectedEditor"),this._editToolbar?(this._editToolbar?.show(),this.#o?.toggleAltTextBadge(!1)):this.addEditToolbar().then((()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()}))}unselect(){this.#mt?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#o?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#_t}set isEditing(e){this.#_t=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#ft=!0;const s=e/t,{style:n}=this.div;n.aspectRatio=s,n.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){this.#jt||=new Map;const{action:t}=e;let s=this.#jt.get(t);return s&&clearTimeout(s),s=setTimeout((()=>{this._reportTelemetry(e),this.#jt.delete(t),0===this.#jt.size&&(this.#jt=null)}),Yf._telemetryTimeout),void this.#jt.set(t,s)}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#ht=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#ht=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(t){if("CANVAS"===t.nodeName){const e=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.before(t)}}else t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);return t}resetAnnotationElement(e){const{firstChild:t}=e.container;"DIV"===t?.nodeName&&t.classList.contains("annotationContent")&&t.remove()}}class Kf extends Yf{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Jf=3285377520,Qf=4294901760,Zf=65535;class em{constructor(e){this.h1=e?4294967295&e:Jf,this.h2=e?4294967295&e:Jf}update(e){let t,s;if("string"===typeof e){t=new Uint8Array(2*e.length),s=0;for(let n=0,i=e.length;n<i;n++){const i=e.charCodeAt(n);i<=255?t[s++]=i:(t[s++]=i>>>8,t[s++]=255&i)}}else{if(!ArrayBuffer.isView(e))throw new Error("Invalid data format, must be a string or TypedArray.");t=e.slice(),s=t.byteLength}const n=s>>2,i=s-4*n,a=new Uint32Array(t.buffer,0,n);let r=0,o=0,l=this.h1,c=this.h2;const d=3432918353,h=461845907,u=11601,p=13715;for(let f=0;f<n;f++)1&f?(r=a[f],r=r*d&Qf|r*u&Zf,r=r<<15|r>>>17,r=r*h&Qf|r*p&Zf,l^=r,l=l<<13|l>>>19,l=5*l+3864292196):(o=a[f],o=o*d&Qf|o*u&Zf,o=o<<15|o>>>17,o=o*h&Qf|o*p&Zf,c^=o,c=c<<13|c>>>19,c=5*c+3864292196);switch(r=0,i){case 3:r^=t[4*n+2]<<16;case 2:r^=t[4*n+1]<<8;case 1:r^=t[4*n],r=r*d&Qf|r*u&Zf,r=r<<15|r>>>17,r=r*h&Qf|r*p&Zf,1&n?l^=r:c^=r}this.h1=l,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&Qf|36045*e&Zf,t=4283543511*t&Qf|(2950163797*(t<<16|e>>>16)&Qf)>>>16,e^=t>>>1,e=444984403*e&Qf|60499*e&Zf,t=3301882366*t&Qf|(3120437893*(t<<16|e>>>16)&Qf)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const tm=Object.freeze({map:null,hash:"",transfer:void 0});class sm{#Jt=!1;#Qt=null;#Zt=(()=>new Map)();constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this.#Zt.get(e);return void 0===s?t:Object.assign(t,s)}getRawValue(e){return this.#Zt.get(e)}remove(e){if(this.#Zt.delete(e),0===this.#Zt.size&&this.resetModified(),"function"===typeof this.onAnnotationEditor){for(const e of this.#Zt.values())if(e instanceof Yf)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this.#Zt.get(e);let n=!1;if(void 0!==s)for(const[i,a]of Object.entries(t))s[i]!==a&&(n=!0,s[i]=a);else n=!0,this.#Zt.set(e,t);n&&this.#es(),t instanceof Yf&&"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#Zt.has(e)}getAll(){return this.#Zt.size>0?df(this.#Zt):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return this.#Zt.size}#es(){this.#Jt||(this.#Jt=!0,"function"===typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#Jt&&(this.#Jt=!1,"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new nm(this)}get serializable(){if(0===this.#Zt.size)return tm;const e=new Map,t=new em,s=[],n=Object.create(null);let i=!1;for(const[a,r]of this.#Zt){const s=r instanceof Yf?r.serialize(!1,n):r;s&&(e.set(a,s),t.update(`${a}:${JSON.stringify(s)}`),i||=!!s.bitmap)}if(i)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:tm}get editorStats(){let e=null;const t=new Map;for(const s of this.#Zt.values()){if(!(s instanceof Yf))continue;const n=s.telemetryFinalData;if(!n)continue;const{type:i}=n;t.has(i)||t.set(i,Object.getPrototypeOf(s).constructor),e||=Object.create(null);const a=e[i]||=new Map;for(const[e,t]of Object.entries(n)){if("type"===e)continue;let s=a.get(e);s||(s=new Map,a.set(e,s));const n=s.get(t)??0;s.set(t,n+1)}}for(const[s,n]of t)e[s]=n.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){this.#Qt=null}get modifiedIds(){if(this.#Qt)return this.#Qt;const e=[];for(const t of this.#Zt.values())t instanceof Yf&&t.annotationElementId&&t.serialize()&&e.push(t.annotationElementId);return this.#Qt={ids:new Set(e),hash:e.join(",")}}}class nm extends sm{#ts;constructor(e){super();const{map:t,hash:s,transfer:n}=e.serializable,i=structuredClone(t,n?{transfer:n}:null);this.#ts={map:i,hash:s,transfer:n}}get print(){Yp("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#ts}get modifiedIds(){return Qp(this,"modifiedIds",{ids:new Set,hash:""})}}class im{#ss=(()=>new Set)();constructor(e){let{ownerDocument:t=globalThis.document,styleElement:s=null}=e;this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#ss.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){let{systemFontInfo:t,_inspectFont:s}=e;if(t&&!this.#ss.has(t.loadedName))if(Kp(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:e,src:n,style:i}=t,a=new FontFace(e,n,i);this.addNativeFontFace(a);try{await a.load(),this.#ss.add(e),s?.(t)}catch{Xp(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}}else Yp("Not implemented: loadSystemFont without the Font Loading API.")}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(s){throw Xp(`Failed to load font '${t.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise((t=>{const s=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,s)}))}}get isFontLoadingAPISupported(){return Qp(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){let e=!1;return(Yu||"undefined"!==typeof navigator&&"string"===typeof navigator?.userAgent&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Qp(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const{loadingRequests:t}=this,s={done:!1,complete:function(){for(Kp(!s.done,"completeRequest() cannot be called twice."),s.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(s),s}get _loadTestFont(){return Qp(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t){function s(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function n(e,t,s,n){return e.substring(0,t)+n+e.substring(t+s)}let i,a;const r=this._document.createElement("canvas");r.width=1,r.height=1;const o=r.getContext("2d");let l=0;const c=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=n(d,976,c.length,c);const h=1482184792;let u=s(d,16);for(i=0,a=c.length-3;i<a;i+=4)u=u-h+s(c,i)|0;var p;i<c.length&&(u=u-h+s(c+"XXX",i)|0),d=n(d,16,4,(p=u,String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,255&p)));const f=`@font-face {font-family:"${c}";src:${`url(data:font/opentype;base64,${btoa(d)});`}}`;this.insertRule(f);const m=this._document.createElement("div");m.style.visibility="hidden",m.style.width=m.style.height="10px",m.style.position="absolute",m.style.top=m.style.left="0px";for(const g of[e.loadedName,c]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=g,m.append(e)}this._document.body.append(m),function e(t,s){if(++l>30)return Xp("Load test font never loaded."),void s();o.font="30px "+t,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?s():setTimeout(e.bind(null,t,s))}(c,(()=>{m.remove(),t.complete()}))}}class am{constructor(e,t){let{disableFontFace:s=!1,fontExtraProperties:n=!1,inspectFont:i=null}=t;this.compiledGlyphs=Object.create(null);for(const a in e)this[a]=e[a];this.disableFontFace=!0===s,this.fontExtraProperties=!0===n,this._inspectFont=i}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(this.cssFontInfo){const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}else e=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${t=this.data,Uint8Array.prototype.toBase64?t.toBase64():btoa(lf(t))});`;var t;let s;if(this.cssFontInfo){let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${e}}`}else s=`@font-face {font-family:"${this.loadedName}";src:${e}}`;return this._inspectFont?.(this,e),s}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let n;try{n=e.get(s)}catch(a){Xp(`getPathGenerator - ignoring character: "${a}".`)}const i=new Path2D(n||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=i}}const rm=1,om=2,lm=1,cm=2,dm=3,hm=4,um=5,pm=6,fm=7,mm=8;function gm(){}function bm(e){if(e instanceof of||e instanceof sf||e instanceof nf||e instanceof ef||e instanceof af||e instanceof tf)return e;switch(e instanceof Error||"object"===typeof e&&null!==e||Yp('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new of(e.message);case"InvalidPDFException":return new sf(e.message);case"MissingPDFException":return new nf(e.message);case"PasswordException":return new ef(e.message,e.code);case"UnexpectedResponseException":return new af(e.message,e.status);case"UnknownErrorException":return new tf(e.message,e.details)}return new tf(e.message,e.toString())}class vm{#ns=(()=>new AbortController)();constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#is.bind(this),{signal:this.#ns.signal})}#is(e){let{data:t}=e;if(t.targetName!==this.sourceName)return;if(t.stream)return void this.#as(t);if(t.callback){const e=t.callbackId,s=this.callbackCapabilities[e];if(!s)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],t.callback===rm)s.resolve(t.data);else{if(t.callback!==om)throw new Error("Unexpected callback case");s.reject(bm(t.reason))}return}const s=this.actionHandler[t.action];if(!s)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const e=this.sourceName,n=t.sourceName,i=this.comObj;Promise.try(s,t.data).then((function(s){i.postMessage({sourceName:e,targetName:n,callback:rm,callbackId:t.callbackId,data:s})}),(function(s){i.postMessage({sourceName:e,targetName:n,callback:om,callbackId:t.callbackId,reason:bm(s)})}))}else t.streamId?this.#rs(t):s(t.data)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const n=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[n]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:n,data:t},s)}catch(a){i.reject(a)}return i.promise}sendWithStream(e,t,s,n){const i=this.streamId++,a=this.sourceName,r=this.targetName,o=this.comObj;return new ReadableStream({start:s=>{const l=Promise.withResolvers();return this.streamControllers[i]={controller:s,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:a,targetName:r,action:e,streamId:i,data:t,desiredSize:s.desiredSize},n),l.promise},pull:e=>{const t=Promise.withResolvers();return this.streamControllers[i].pullCall=t,o.postMessage({sourceName:a,targetName:r,stream:pm,streamId:i,desiredSize:e.desiredSize}),t.promise},cancel:e=>{Kp(e instanceof Error,"cancel must have a valid reason");const t=Promise.withResolvers();return this.streamControllers[i].cancelCall=t,this.streamControllers[i].isClosed=!0,o.postMessage({sourceName:a,targetName:r,stream:lm,streamId:i,reason:bm(e)}),t.promise}},s)}#rs(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,i=this.comObj,a=this,r=this.actionHandler[e.action],o={enqueue(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=a,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:n,stream:hm,streamId:t,chunk:e},r)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:n,stream:dm,streamId:t}),delete a.streamSinks[t])},error(e){Kp(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:n,stream:um,streamId:t,reason:bm(e)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[t]=o,Promise.try(r,e.data,o).then((function(){i.postMessage({sourceName:s,targetName:n,stream:mm,streamId:t,success:!0})}),(function(e){i.postMessage({sourceName:s,targetName:n,stream:mm,streamId:t,reason:bm(e)})}))}#as(e){const t=e.streamId,s=this.sourceName,n=e.sourceName,i=this.comObj,a=this.streamControllers[t],r=this.streamSinks[t];switch(e.stream){case mm:e.success?a.startCall.resolve():a.startCall.reject(bm(e.reason));break;case fm:e.success?a.pullCall.resolve():a.pullCall.reject(bm(e.reason));break;case pm:if(!r){i.postMessage({sourceName:s,targetName:n,stream:fm,streamId:t,success:!0});break}r.desiredSize<=0&&e.desiredSize>0&&r.sinkCapability.resolve(),r.desiredSize=e.desiredSize,Promise.try(r.onPull||gm).then((function(){i.postMessage({sourceName:s,targetName:n,stream:fm,streamId:t,success:!0})}),(function(e){i.postMessage({sourceName:s,targetName:n,stream:fm,streamId:t,reason:bm(e)})}));break;case hm:if(Kp(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case dm:if(Kp(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#os(a,t);break;case um:Kp(a,"error should have stream controller"),a.controller.error(bm(e.reason)),this.#os(a,t);break;case cm:e.success?a.cancelCall.resolve():a.cancelCall.reject(bm(e.reason)),this.#os(a,t);break;case lm:if(!r)break;const o=bm(e.reason);Promise.try(r.onCancel||gm,o).then((function(){i.postMessage({sourceName:s,targetName:n,stream:cm,streamId:t,success:!0})}),(function(e){i.postMessage({sourceName:s,targetName:n,stream:cm,streamId:t,reason:bm(e)})})),r.sinkCapability.reject(o),r.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#os(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#ns?.abort(),this.#ns=null}}class ym{#ls=!1;constructor(e){let{enableHWA:t=!1}=e;this.#ls=t}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#ls})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Yp("Abstract method `_createCanvas` called.")}}class xm{constructor(e){let{baseUrl:t=null,isCompressed:s=!0}=e;this.baseUrl=t,this.isCompressed=s}async fetch(e){let{name:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const s=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(s).then((e=>({cMapData:e,isCompressed:this.isCompressed}))).catch((e=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${s}`)}))}async _fetch(e){Yp("Abstract method `_fetch` called.")}}class wm extends xm{async _fetch(e){const t=await xf(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):cf(t)}}class _m{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,n,i){return"none"}destroy(){}}class Sm{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const s=`${this.baseUrl}${t}`;return this._fetch(s).catch((e=>{throw new Error(`Unable to load font data at: ${s}`)}))}async _fetch(e){Yp("Abstract method `_fetch` called.")}}class Am extends Sm{async _fetch(e){const t=await xf(e,"arraybuffer");return new Uint8Array(t)}}async function km(e){const t=process.getBuiltinModule("fs"),s=await t.promises.readFile(e);return new Uint8Array(s)}Yu&&Xp("Please use the `legacy` build in Node.js environments.");const Em="Fill",Cm="Stroke",jm="Shading";function Nm(e,t){if(!t)return;const s=t[2]-t[0],n=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],s,n),e.clip(i)}class Tm{getPattern(){Yp("Abstract method `getPattern` called.")}}class Pm extends Tm{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;"axial"===this._type?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,n){let i;if(n===Cm||n===Em){const a=t.current.getClippedPathBoundingBox(n,If(e))||[0,0,0,0],r=Math.ceil(a[2]-a[0])||1,o=Math.ceil(a[3]-a[1])||1,l=t.cachedCanvases.getCanvas("pattern",r,o),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-a[0],-a[1]),s=pf.transform(s,[1,0,0,1,a[0],a[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),Nm(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),i=e.createPattern(l.canvas,"no-repeat");const d=new DOMMatrix(s);i.setTransform(d)}else Nm(e,this._bbox),i=this._createGradient(e);return i}}function Mm(e,t,s,n,i,a,r,o){const l=t.coords,c=t.colors,d=e.data,h=4*e.width;let u;l[s+1]>l[n+1]&&(u=s,s=n,n=u,u=a,a=r,r=u),l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=r,r=o,o=u),l[s+1]>l[n+1]&&(u=s,s=n,n=u,u=a,a=r,r=u);const p=(l[s]+t.offsetX)*t.scaleX,f=(l[s+1]+t.offsetY)*t.scaleY,m=(l[n]+t.offsetX)*t.scaleX,g=(l[n+1]+t.offsetY)*t.scaleY,b=(l[i]+t.offsetX)*t.scaleX,v=(l[i+1]+t.offsetY)*t.scaleY;if(f>=v)return;const y=c[a],x=c[a+1],w=c[a+2],_=c[r],S=c[r+1],A=c[r+2],k=c[o],E=c[o+1],C=c[o+2],j=Math.round(f),N=Math.round(v);let T,P,M,R,I,D,L,O;for(let F=j;F<=N;F++){if(F<g){const e=F<f?0:(f-F)/(f-g);T=p-(p-m)*e,P=y-(y-_)*e,M=x-(x-S)*e,R=w-(w-A)*e}else{let e;e=F>v?1:g===v?0:(g-F)/(g-v),T=m-(m-b)*e,P=_-(_-k)*e,M=S-(S-E)*e,R=A-(A-C)*e}let e;e=F<f?0:F>v?1:(f-F)/(f-v),I=p-(p-b)*e,D=y-(y-k)*e,L=x-(x-E)*e,O=w-(w-C)*e;const t=Math.round(Math.min(T,I)),s=Math.round(Math.max(T,I));let n=h*F+4*t;for(let i=t;i<=s;i++)e=(T-i)/(T-I),e<0?e=0:e>1&&(e=1),d[n++]=P-(P-D)*e|0,d[n++]=M-(M-L)*e|0,d[n++]=R-(R-O)*e|0,d[n++]=255}}function Rm(e,t,s){const n=t.coords,i=t.colors;let a,r;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(n.length/o)-1,c=o-1;for(a=0;a<l;a++){let t=a*o;for(let a=0;a<c;a++,t++)Mm(e,s,n[t],n[t+1],n[t+o],i[t],i[t+1],i[t+o]),Mm(e,s,n[t+o+1],n[t+1],n[t+o],i[t+o+1],i[t+1],i[t+o])}break;case"triangles":for(a=0,r=n.length;a<r;a+=3)Mm(e,s,n[a],n[a+1],n[a+2],i[a],i[a+1],i[a+2]);break;default:throw new Error("illegal figure")}}class Im extends Tm{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const n=Math.floor(this._bounds[0]),i=Math.floor(this._bounds[1]),a=Math.ceil(this._bounds[2])-n,r=Math.ceil(this._bounds[3])-i,o=Math.min(Math.ceil(Math.abs(a*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(r*e[1]*1.1)),3e3),c=a/o,d=r/l,h={coords:this._coords,colors:this._colors,offsetX:-n,offsetY:-i,scaleX:1/c,scaleY:1/d},u=o+4,p=l+4,f=s.getCanvas("mesh",u,p),m=f.context,g=m.createImageData(o,l);if(t){const e=g.data;for(let s=0,n=e.length;s<n;s+=4)e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=255}for(const b of this._figures)Rm(g,b,h);m.putImageData(g,2,2);return{canvas:f.canvas,offsetX:n-2*c,offsetY:i-2*d,scaleX:c,scaleY:d}}getPattern(e,t,s,n){let i;if(Nm(e,this._bbox),n===jm)i=pf.singularValueDecompose2dScale(If(e));else if(i=pf.singularValueDecompose2dScale(t.baseTransform),this.matrix){const e=pf.singularValueDecompose2dScale(this.matrix);i=[i[0]*e[0],i[1]*e[1]]}const a=this._createMeshCanvas(i,n===jm?null:this._background,t.cachedCanvases);return n!==jm&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class Dm extends Tm{getPattern(){return"hotpink"}}const Lm=1,Om=2;class Fm{static MAX_PATTERN_SIZE=3e3;constructor(e,t,s,n,i){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:n,tilingType:i,color:a,canvasGraphicsFactory:r}=this;let{xstep:o,ystep:l}=this;o=Math.abs(o),l=Math.abs(l),Gp("TilingType: "+i);const c=t[0],d=t[1],h=t[2],u=t[3],p=h-c,f=u-d,m=pf.singularValueDecompose2dScale(this.matrix),g=pf.singularValueDecompose2dScale(this.baseTransform),b=m[0]*g[0],v=m[1]*g[1];let y=p,x=f,w=!1,_=!1;const S=Math.ceil(o*b),A=Math.ceil(l*v);S>=Math.ceil(p*b)?y=o:w=!0,A>=Math.ceil(f*v)?x=l:_=!0;const k=this.getSizeAndScale(y,this.ctx.canvas.width,b),E=this.getSizeAndScale(x,this.ctx.canvas.height,v),C=e.cachedCanvases.getCanvas("pattern",k.size,E.size),j=C.context,N=r.createCanvasGraphics(j);if(N.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(N,n,a),j.translate(-k.scale*c,-E.scale*d),N.transform(k.scale,0,0,E.scale,0,0),j.save(),this.clipBbox(N,c,d,h,u),N.baseTransform=If(N.ctx),N.executeOperatorList(s),N.endDrawing(),j.restore(),w||_){const t=C.canvas;w&&(y=o),_&&(x=l);const s=this.getSizeAndScale(y,this.ctx.canvas.width,b),n=this.getSizeAndScale(x,this.ctx.canvas.height,v),i=s.size,a=n.size,r=e.cachedCanvases.getCanvas("pattern-workaround",i,a),h=r.context,u=w?Math.floor(p/o):0,m=_?Math.floor(f/l):0;for(let e=0;e<=u;e++)for(let s=0;s<=m;s++)h.drawImage(t,i*e,a*s,i,a,0,0,i,a);return{canvas:r.canvas,scaleX:s.scale,scaleY:n.scale,offsetX:c,offsetY:d}}return{canvas:C.canvas,scaleX:k.scale,scaleY:E.scale,offsetX:c,offsetY:d}}getSizeAndScale(e,t,s){const n=Math.max(Fm.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*s);return i>=n?i=n:s=i/e,{scale:s,size:i}}clipBbox(e,t,s,n,i){const a=n-t,r=i-s;e.ctx.rect(t,s,a,r),e.current.updateRectMinMax(If(e.ctx),[t,s,n,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const n=e.ctx,i=e.current;switch(t){case Lm:const e=this.ctx;n.fillStyle=e.fillStyle,n.strokeStyle=e.strokeStyle,i.fillColor=e.fillStyle,i.strokeColor=e.strokeStyle;break;case Om:const a=pf.makeHexColor(s[0],s[1],s[2]);n.fillStyle=a,n.strokeStyle=a,i.fillColor=a,i.strokeColor=a;break;default:throw new rf(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,n){let i=s;n!==jm&&(i=pf.transform(i,t.baseTransform),this.matrix&&(i=pf.transform(i,this.matrix)));const a=this.createPatternCanvas(t);let r=new DOMMatrix(i);r=r.translate(a.offsetX,a.offsetY),r=r.scale(1/a.scaleX,1/a.scaleY);const o=e.createPattern(a.canvas,"repeat");return o.setTransform(r),o}}function zm(e){let{src:t,srcPos:s=0,dest:n,width:i,height:a,nonBlackColor:r=4294967295,inverseDecode:o=!1}=e;const l=hf.isLittleEndian?4278190080:255,[c,d]=o?[r,l]:[l,r],h=i>>3,u=7&i,p=t.length;n=new Uint32Array(n.buffer);let f=0;for(let m=0;m<a;m++){for(const i=s+h;s<i;s++){const e=s<p?t[s]:255;n[f++]=128&e?d:c,n[f++]=64&e?d:c,n[f++]=32&e?d:c,n[f++]=16&e?d:c,n[f++]=8&e?d:c,n[f++]=4&e?d:c,n[f++]=2&e?d:c,n[f++]=1&e?d:c}if(0===u)continue;const e=s<p?t[s++]:255;for(let t=0;t<u;t++)n[f++]=e&1<<7-t?d:c}return{srcPos:s,destPos:f}}const $m=16;class Bm{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let n;return void 0!==this.cache[e]?(n=this.cache[e],this.canvasFactory.reset(n,t,s)):(n=this.canvasFactory.create(t,s),this.cache[e]=n),n}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Hm(e,t,s,n,i,a,r,o,l,c){const[d,h,u,p,f,m]=If(e);if(0===h&&0===u){const g=r*d+f,b=Math.round(g),v=o*p+m,y=Math.round(v),x=(r+l)*d+f,w=Math.abs(Math.round(x)-b)||1,_=(o+c)*p+m,S=Math.abs(Math.round(_)-y)||1;return e.setTransform(Math.sign(d),0,0,Math.sign(p),b,y),e.drawImage(t,s,n,i,a,0,0,w,S),e.setTransform(d,h,u,p,f,m),[w,S]}if(0===d&&0===p){const g=o*u+f,b=Math.round(g),v=r*h+m,y=Math.round(v),x=(o+c)*u+f,w=Math.abs(Math.round(x)-b)||1,_=(r+l)*h+m,S=Math.abs(Math.round(_)-y)||1;return e.setTransform(0,Math.sign(h),Math.sign(u),0,b,y),e.drawImage(t,s,n,i,a,0,0,S,w),e.setTransform(d,h,u,p,f,m),[S,w]}e.drawImage(t,s,n,i,a,r,o,l,c);return[Math.hypot(d,h)*l,Math.hypot(u,p)*c]}class Um{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Ku,this.textMatrixScale=1,this.fontMatrix=Ju,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=hp,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=pf.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=pf.applyTransform(t,e),n=pf.applyTransform(t.slice(2),e),i=pf.applyTransform([t[0],t[3]],e),a=pf.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],n[0],i[0],a[0]),this.minY=Math.min(this.minY,s[1],n[1],i[1],a[1]),this.maxX=Math.max(this.maxX,s[0],n[0],i[0],a[0]),this.maxY=Math.max(this.maxY,s[1],n[1],i[1],a[1])}updateScalingPathMinMax(e,t){pf.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,n,i,a,r,o,l,c){const d=pf.bezierBoundingBox(t,s,n,i,a,r,o,l,c);c||this.updateRectMinMax(e,d)}getPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Em,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Cm){t||Yp("Stroke bounding box must include transform.");const e=pf.singularValueDecompose2dScale(t),n=e[0]*this.lineWidth/2,i=e[1]*this.lineWidth/2;s[0]-=n,s[1]-=i,s[2]+=n,s[3]+=i}return s}updateClipFromPath(){const e=pf.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Em,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return pf.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Vm(e,t){if(t instanceof ImageData)return void e.putImageData(t,0,0);const s=t.height,n=t.width,i=s%$m,a=(s-i)/$m,r=0===i?a:a+1,o=e.createImageData(n,$m);let l,c=0;const d=t.data,h=o.data;let u,p,f,m;if(t.kind===bp.GRAYSCALE_1BPP){const t=d.byteLength,s=new Uint32Array(h.buffer,0,h.byteLength>>2),m=s.length,g=n+7>>3,b=4294967295,v=hf.isLittleEndian?4278190080:255;for(u=0;u<r;u++){for(f=u<a?$m:i,l=0,p=0;p<f;p++){const e=t-c;let i=0;const a=e>g?n:8*e-7,r=-8&a;let o=0,h=0;for(;i<r;i+=8)h=d[c++],s[l++]=128&h?b:v,s[l++]=64&h?b:v,s[l++]=32&h?b:v,s[l++]=16&h?b:v,s[l++]=8&h?b:v,s[l++]=4&h?b:v,s[l++]=2&h?b:v,s[l++]=1&h?b:v;for(;i<a;i++)0===o&&(h=d[c++],o=128),s[l++]=h&o?b:v,o>>=1}for(;l<m;)s[l++]=0;e.putImageData(o,0,u*$m)}}else if(t.kind===bp.RGBA_32BPP){for(p=0,m=n*$m*4,u=0;u<a;u++)h.set(d.subarray(c,c+m)),c+=m,e.putImageData(o,0,p),p+=$m;u<r&&(m=n*i*4,h.set(d.subarray(c,c+m)),e.putImageData(o,0,p))}else{if(t.kind!==bp.RGB_24BPP)throw new Error(`bad image kind: ${t.kind}`);for(f=$m,m=n*f,u=0;u<r;u++){for(u>=a&&(f=i,m=n*f),l=0,p=m;p--;)h[l++]=d[c++],h[l++]=d[c++],h[l++]=d[c++],h[l++]=255;e.putImageData(o,0,u*$m)}}}function Wm(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const s=t.height,n=t.width,i=s%$m,a=(s-i)/$m,r=0===i?a:a+1,o=e.createImageData(n,$m);let l=0;const c=t.data,d=o.data;for(let h=0;h<r;h++){const t=h<a?$m:i;({srcPos:l}=zm({src:c,srcPos:l,dest:d,width:n,height:t,nonBlackColor:0})),e.putImageData(o,0,h*$m)}}function qm(e,t){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of s)void 0!==e[n]&&(t[n]=e[n]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function Gm(e){if(e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0),!Yu){const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}}function Xm(e,t){if(t)return!0;const s=pf.singularValueDecompose2dScale(e);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*yf.PDF_TO_CSS_UNITS);return s[0]<=n&&s[1]<=n}const Ym=["butt","round","square"],Km=["miter","round","bevel"],Jm={},Qm={};class Zm{constructor(e,t,s,n,i,a,r,o){let{optionalContentConfig:l,markedContentStack:c=null}=a;this.ctx=e,this.current=new Um(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=n,this.filterFactory=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new Bm(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=r,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=o,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"===typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing(e){let{transform:t,viewport:s,transparency:n=!1,background:i=null}=e;const a=this.ctx.canvas.width,r=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,a,r),this.ctx.fillStyle=o,n){const e=this.cachedCanvases.getCanvas("transparent",a,r);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...If(this.compositeCtx))}this.ctx.save(),Gm(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...s.transform),this.viewportScale=s.scale,this.baseTransform=If(this.ctx)}executeOperatorList(e,t,s,n){const i=e.argsArray,a=e.fnArray;let r=t||0;const o=i.length;if(o===r)return r;const l=o-r>10&&"function"===typeof s,c=l?Date.now()+15:0;let d=0;const h=this.commonObjs,u=this.objs;let p;for(;;){if(void 0!==n&&r===n.nextBreakPoint)return n.breakIt(r,s),r;if(p=a[r],p!==Hp.dependency)this[p].apply(this,i[r]);else for(const e of i[r]){const t=e.startsWith("g_")?h:u;if(!t.has(e))return t.get(e,s),r}if(r++,r===o)return r;if(l&&++d>10){if(Date.now()>c)return s(),r;d=0}}}#cs(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#cs(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#ds()}#ds(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const s=e.width??e.displayWidth,n=e.height??e.displayHeight;let i,a,r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=s,c=n,d="prescale1";for(;r>2&&l>1||o>2&&c>1;){let t=l,s=c;r>2&&l>1&&(t=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),r/=l/t),o>2&&c>1&&(s=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/s),i=this.cachedCanvases.getCanvas(d,t,s),a=i.context,a.clearRect(0,0,t,s),a.drawImage(e,0,0,l,c,0,0,t,s),e=i.canvas,l=t,c=s,d="prescale1"===d?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:n}=e,i=this.current.fillColor,a=this.current.patternFill,r=If(t);let o,l,c,d;if((e.bitmap||e.data)&&e.count>1){const t=e.bitmap||e.data.buffer;l=JSON.stringify(a?r:[r.slice(0,4),i]),o=this._cachedBitmapsMap.get(t),o||(o=new Map,this._cachedBitmapsMap.set(t,o));const s=o.get(l);if(s&&!a){return{canvas:s,offsetX:Math.round(Math.min(r[0],r[2])+r[4]),offsetY:Math.round(Math.min(r[1],r[3])+r[5])}}c=s}c||(d=this.cachedCanvases.getCanvas("maskCanvas",s,n),Wm(d.context,e));let h=pf.transform(r,[1/s,0,0,-1/n,0,0]);h=pf.transform(h,[1,0,0,1,0,-n]);const[u,p,f,m]=pf.getAxialAlignedBoundingBox([0,0,s,n],h),g=Math.round(f-u)||1,b=Math.round(m-p)||1,v=this.cachedCanvases.getCanvas("fillCanvas",g,b),y=v.context,x=u,w=p;y.translate(-x,-w),y.transform(...h),c||(c=this._scaleImage(d.canvas,Df(y)),c=c.img,o&&a&&o.set(l,c)),y.imageSmoothingEnabled=Xm(If(y),e.interpolate),Hm(y,c,0,0,c.width,c.height,0,0,s,n),y.globalCompositeOperation="source-in";const _=pf.transform(Df(y),[1,0,0,1,-x,-w]);return y.fillStyle=a?i.getPattern(t,this,_,Em):i,y.fillRect(0,0,s,n),o&&!a&&(this.cachedCanvases.delete("fillCanvas"),o.set(l,v.canvas)),{canvas:v.canvas,offsetX:Math.round(x),offsetY:Math.round(w)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Ym[e]}setLineJoin(e){this.ctx.lineJoin=Km[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;void 0!==s.setLineDash&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,n=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=n.context;const i=this.ctx;i.setTransform(...If(this.suspendedCtx)),qm(this.suspendedCtx,i),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,s){t.translate(e,s),this.__originalTranslate(e,s)},e.scale=function(e,s){t.scale(e,s),this.__originalScale(e,s)},e.transform=function(e,s,n,i,a,r){t.transform(e,s,n,i,a,r),this.__originalTransform(e,s,n,i,a,r)},e.setTransform=function(e,s,n,i,a,r){t.setTransform(e,s,n,i,a,r),this.__originalSetTransform(e,s,n,i,a,r)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},e.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},e.bezierCurveTo=function(e,s,n,i,a,r){t.bezierCurveTo(e,s,n,i,a,r),this.__originalBezierCurveTo(e,s,n,i,a,r)},e.rect=function(e,s,n,i){t.rect(e,s,n,i),this.__originalRect(e,s,n,i)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),qm(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,n){const i=n[0],a=n[1],r=n[2]-i,o=n[3]-a;0!==r&&0!==o&&(this.genericComposeSMask(t.context,s,r,o,t.subtype,t.backdrop,t.transferMap,i,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,n,i,a,r,o,l,c,d){let h=e.canvas,u=o-c,p=l-d;if(a){const t=pf.makeHexColor(...a);if(u<0||p<0||u+s>h.width||p+n>h.height){const e=this.cachedCanvases.getCanvas("maskExtension",s,n),i=e.context;i.drawImage(h,-u,-p),i.globalCompositeOperation="destination-atop",i.fillStyle=t,i.fillRect(0,0,s,n),i.globalCompositeOperation="source-over",h=e.canvas,u=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const i=new Path2D;i.rect(u,p,s,n),e.clip(i),e.globalCompositeOperation="destination-atop",e.fillStyle=t,e.fillRect(u,p,s,n),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),"Alpha"===i&&r?t.filter=this.filterFactory.addAlphaFilter(r):"Luminosity"===i&&(t.filter=this.filterFactory.addLuminosityFilter(r));const f=new Path2D;f.rect(o,l,s,n),t.clip(f),t.globalCompositeOperation="destination-in",t.drawImage(h,u,p,s,n,o,l,s,n),t.restore()}save(){this.inSMaskMode?(qm(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),qm(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,n,i,a){this.ctx.transform(e,t,s,n,i,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const n=this.ctx,i=this.current;let a,r,o=i.x,l=i.y;const c=If(n),d=0===c[0]&&0===c[3]||0===c[1]&&0===c[2],h=d?s.slice(0):null;for(let u=0,p=0,f=e.length;u<f;u++)switch(0|e[u]){case Hp.rectangle:o=t[p++],l=t[p++];const e=t[p++],s=t[p++],u=o+e,f=l+s;n.moveTo(o,l),0===e||0===s?n.lineTo(u,f):(n.lineTo(u,l),n.lineTo(u,f),n.lineTo(o,f)),d||i.updateRectMinMax(c,[o,l,u,f]),n.closePath();break;case Hp.moveTo:o=t[p++],l=t[p++],n.moveTo(o,l),d||i.updatePathMinMax(c,o,l);break;case Hp.lineTo:o=t[p++],l=t[p++],n.lineTo(o,l),d||i.updatePathMinMax(c,o,l);break;case Hp.curveTo:a=o,r=l,o=t[p+4],l=t[p+5],n.bezierCurveTo(t[p],t[p+1],t[p+2],t[p+3],o,l),i.updateCurvePathMinMax(c,a,r,t[p],t[p+1],t[p+2],t[p+3],o,l,h),p+=6;break;case Hp.curveTo2:a=o,r=l,n.bezierCurveTo(o,l,t[p],t[p+1],t[p+2],t[p+3]),i.updateCurvePathMinMax(c,a,r,o,l,t[p],t[p+1],t[p+2],t[p+3],h),o=t[p+2],l=t[p+3],p+=4;break;case Hp.curveTo3:a=o,r=l,o=t[p+2],l=t[p+3],n.bezierCurveTo(t[p],t[p+1],o,l,o,l),i.updateCurvePathMinMax(c,a,r,t[p],t[p+1],o,l,o,l,h),p+=4;break;case Hp.closePath:n.closePath()}d&&i.updateScalingPathMinMax(c,h),i.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"===typeof s&&s?.getPattern?(t.save(),t.strokeStyle=s.getPattern(t,this,Df(t),Cm),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.ctx,s=this.current.fillColor;let n=!1;this.current.patternFill&&(t.save(),t.fillStyle=s.getPattern(t,this,Df(t),Em),n=!0);const i=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==i&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),n&&t.restore(),e&&this.consumePath(i)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Jm}eoClip(){this.pendingClip=Qm}beginText(){this.current.textMatrix=Ku,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(void 0===e)return void t.beginPath();const s=new Path2D,n=t.getTransform().invertSelf();for(const{transform:i,x:a,y:r,fontSize:o,path:l}of e)s.addPath(l,new DOMMatrix(i).preMultiplySelf(n).translate(a,r).scale(o,-o));t.clip(s),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const s=this.commonObjs.get(e),n=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(n.fontMatrix=s.fontMatrix||Ju,0!==n.fontMatrix[0]&&0!==n.fontMatrix[3]||Xp("Invalid font matrix for font "+e),t<0?(t=-t,n.fontDirection=-1):n.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const i=s.loadedName||"sans-serif",a=s.systemFontInfo?.css||`"${i}", ${s.fallbackName}`;let r="normal";s.black?r="900":s.bold&&(r="bold");const o=s.italic?"italic":"normal";let l=t;t<16?l=16:t>100&&(l=100),this.current.fontSizeScale=t/l,this.ctx.font=`${o} ${r} ${l}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,n,i,a){this.current.textMatrix=[e,t,s,n,i,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#hs(e,t,s){const n=new Path2D;return n.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),n}paintChar(e,t,s,n,i){const a=this.ctx,r=this.current,o=r.font,l=r.textRenderingMode,c=r.fontSize/r.fontSizeScale,d=l&mp,h=!!(l&gp),u=r.patternFill&&!o.missingFile,p=r.patternStroke&&!o.missingFile;let f;if((o.disableFontFace||h||u||p)&&(f=o.getPathGenerator(this.commonObjs,e)),o.disableFontFace||u||p){if(a.save(),a.translate(t,s),a.scale(c,-c),d===hp||d===pp)if(n){const e=a.getTransform();a.setTransform(...n),a.fill(this.#hs(f,e,n))}else a.fill(f);if(d===up||d===pp)if(i){const e=a.getTransform();a.setTransform(...i),a.stroke(this.#hs(f,e,i))}else a.lineWidth/=c,a.stroke(f);a.restore()}else d!==hp&&d!==pp||a.fillText(e,t,s),d!==up&&d!==pp||a.strokeText(e,t,s);if(h){(this.pendingTextPaths||=[]).push({transform:If(a),x:t,y:s,fontSize:c,path:f})}}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let n=3;n<t.length;n+=4)if(t[n]>0&&t[n]<255){s=!0;break}return Qp(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const n=t.fontSize;if(0===n)return;const i=this.ctx,a=t.fontSizeScale,r=t.charSpacing,o=t.wordSpacing,l=t.fontDirection,c=t.textHScale*l,d=e.length,h=s.vertical,u=h?1:-1,p=s.defaultVMetrics,f=n*t.fontMatrix[0],m=t.textRenderingMode===hp&&!s.disableFontFace&&!t.patternFill;let g,b;if(i.save(),i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),l>0?i.scale(c,-1):i.scale(c,1),t.patternFill){i.save();const e=t.fillColor.getPattern(i,this,Df(i),Em);g=If(i),i.restore(),i.fillStyle=e}if(t.patternStroke){i.save();const e=t.strokeColor.getPattern(i,this,Df(i),Cm);b=If(i),i.restore(),i.strokeStyle=e}let v=t.lineWidth;const y=t.textMatrixScale;if(0===y||0===v){const e=t.textRenderingMode&mp;e!==up&&e!==pp||(v=this.getSinglePixelWidth())}else v/=y;if(1!==a&&(i.scale(a,a),v/=a),i.lineWidth=v,s.isInvalidPDFjsFont){const s=[];let n=0;for(const t of e)s.push(t.unicode),n+=t.width;return i.fillText(s.join(""),0,0),t.x+=n*f*c,i.restore(),void this.compose()}let x,w=0;for(x=0;x<d;++x){const t=e[x];if("number"===typeof t){w+=u*t*n/1e3;continue}let c=!1;const d=(t.isSpace?o:0)+r,v=t.fontChar,y=t.accent;let _,S,A=t.width;if(h){const e=t.vmetric||p,s=-(t.vmetric?e[1]:.5*A)*f,n=e[2]*f;A=e?-e[0]:A,_=s/a,S=(w+n)/a}else _=w/a,S=0;if(s.remeasure&&A>0){const e=1e3*i.measureText(v).width/n*a;if(A<e&&this.isFontSubpixelAAEnabled){const t=A/e;c=!0,i.save(),i.scale(t,1),_/=t}else A!==e&&(_+=(A-e)/2e3*n/a)}if(this.contentVisible&&(t.isInFont||s.missingFile))if(m&&!y)i.fillText(v,_,S);else if(this.paintChar(v,_,S,g,b),y){const e=_+n*y.offset.x/a,t=S-n*y.offset.y/a;this.paintChar(y.fontChar,e,t,g,b)}w+=h?A*f-d*l:A*f+d*l,c&&i.restore()}h?t.y-=w:t.x+=w*c,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,n=s.font,i=s.fontSize,a=s.fontDirection,r=n.vertical?1:-1,o=s.charSpacing,l=s.wordSpacing,c=s.textHScale*a,d=s.fontMatrix||Ju,h=e.length;let u,p,f,m;if(!(s.textRenderingMode===fp)&&0!==i){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(c,a),u=0;u<h;++u){if(p=e[u],"number"===typeof p){m=r*p*i/1e3,this.ctx.translate(m,0),s.x+=m*c;continue}const a=(p.isSpace?l:0)+o,h=n.charProcOperatorList[p.operatorListId];if(!h){Xp(`Type3 character "${p.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=p,this.save(),t.scale(i,i),t.transform(...d),this.executeOperatorList(h),this.restore());f=pf.applyTransform([p.width,0],d)[0]*i+a,t.translate(f,0),s.x+=f*c}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,n,i,a){this.ctx.rect(s,n,i-s,a-n),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if("TilingPattern"===e[0]){const s=e[1],n=this.baseTransform||If(this.ctx),i={createCanvasGraphics:e=>new Zm(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Fm(e,s,this.ctx,i,n)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=pf.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=pf.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cachedPatterns.has(e)?t=this.cachedPatterns.get(e):(t=function(e){switch(e[0]){case"RadialAxial":return new Pm(e);case"Mesh":return new Im(e);case"Dummy":return new Dm}throw new Error(`Unknown IR type: ${e[0]}`)}(this.getObject(e)),this.cachedPatterns.set(e,t)),s&&(t.matrix=s),t}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Df(t),jm);const n=Df(t);if(n){const{width:e,height:s}=t.canvas,[i,a,r,o]=pf.getAxialAlignedBoundingBox([0,0,e,s],n);this.ctx.fillRect(i,a,r-i,o-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Yp("Should not call beginInlineImage")}beginImageData(){Yp("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=If(this.ctx),t)){const e=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],e,s),this.current.updateRectMinMax(If(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Gp("TODO: Support non-isolated groups."),e.knockout&&Xp("Knockout groups not supported.");const s=If(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let n=pf.getAxialAlignedBoundingBox(e.bbox,If(t));const i=[0,0,t.canvas.width,t.canvas.height];n=pf.intersect(n,i)||[0,0,0,0];const a=Math.floor(n[0]),r=Math.floor(n[1]),o=Math.max(Math.ceil(n[2])-a,1),l=Math.max(Math.ceil(n[3])-r,1);this.current.startNewPathAndClipBox([0,0,o,l]);let c="groupAt"+this.groupLevel;e.smask&&(c+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(c,o,l),h=d.context;h.translate(-a,-r),h.transform(...s),e.smask?this.smaskStack.push({canvas:d.canvas,context:h,offsetX:a,offsetY:r,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,r),t.save()),qm(t,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=If(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...e);const s=pf.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],e);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,s,n,i){if(this.#cs(),Gm(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const n=t[2]-t[0],a=t[3]-t[1];if(i&&this.annotationCanvasMap){(s=s.slice())[4]-=t[0],s[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=n,t[3]=a;const[i,r]=pf.singularValueDecompose2dScale(If(this.ctx)),{viewportScale:o}=this,l=Math.ceil(n*this.outputScaleX*o),c=Math.ceil(a*this.outputScaleY*o);this.annotationCanvas=this.canvasFactory.create(l,c);const{canvas:d,context:h}=this.annotationCanvas;this.annotationCanvasMap.set(e,d),this.annotationCanvas.savedCtx=this.ctx,this.ctx=h,this.ctx.save(),this.ctx.setTransform(i,0,0,-r,0,a*r),Gm(this.ctx)}else Gm(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],n,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new Um(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...n)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#ds(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const s=this.ctx,n=this.processingType3;if(n&&(void 0===n.compiled&&(n.compiled=function(e){const{width:t,height:s}=e;if(t>1e3||s>1e3)return null;const n=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=t+1;let a,r,o,l=new Uint8Array(i*(s+1));const c=t+7&-8;let d=new Uint8Array(c*s),h=0;for(const m of e.data){let e=128;for(;e>0;)d[h++]=m&e?0:255,e>>=1}let u=0;for(h=0,0!==d[h]&&(l[0]=1,++u),r=1;r<t;r++)d[h]!==d[h+1]&&(l[r]=d[h]?2:1,++u),h++;for(0!==d[h]&&(l[r]=2,++u),a=1;a<s;a++){h=a*c,o=a*i,d[h-c]!==d[h]&&(l[o]=d[h]?1:8,++u);let e=(d[h]?4:0)+(d[h-c]?8:0);for(r=1;r<t;r++)e=(e>>2)+(d[h+1]?4:0)+(d[h-c+1]?8:0),n[e]&&(l[o+r]=n[e],++u),h++;if(d[h-c]!==d[h]&&(l[o+r]=d[h]?2:4,++u),u>1e3)return null}for(h=c*(s-1),o=a*i,0!==d[h]&&(l[o]=8,++u),r=1;r<t;r++)d[h]!==d[h+1]&&(l[o+r]=d[h]?4:8,++u),h++;if(0!==d[h]&&(l[o+r]=4,++u),u>1e3)return null;const p=new Int32Array([0,i,-1,0,-i,0,0,0,1]),f=new Path2D;for(a=0;u&&a<=s;a++){let e=a*i;const s=e+t;for(;e<s&&!l[e];)e++;if(e===s)continue;f.moveTo(e%i,a);const n=e;let r=l[e];do{const t=p[r];do{e+=t}while(!l[e]);const s=l[e];5!==s&&10!==s?(r=s,l[e]=0):(r=s&51*r>>4,l[e]&=r>>2|r<<2),f.lineTo(e%i,e/i|0),l[e]||--u}while(n!==e);--a}return d=null,l=null,function(e){e.save(),e.scale(1/t,-1/s),e.translate(0,-s),e.fill(f),e.beginPath(),e.restore()}}(e)),n.compiled))return void n.compiled(s);const i=this._createMaskCanvas(e),a=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,i.offsetX,i.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;e=this.getObject(e.data,e);const r=this.ctx;r.save();const o=If(r);r.transform(t,s,n,i,0,0);const l=this._createMaskCanvas(e);r.setTransform(1,0,0,1,l.offsetX-o[4],l.offsetY-o[5]);for(let c=0,d=a.length;c<d;c+=2){const e=pf.transform(o,[t,s,n,i,a[c],a[c+1]]),[d,h]=pf.applyTransform([0,0],e);r.drawImage(l.canvas,d,h)}r.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,n=this.current.patternFill;for(const i of e){const{data:e,width:a,height:r,transform:o}=i,l=this.cachedCanvases.getCanvas("maskCanvas",a,r),c=l.context;c.save();Wm(c,this.getObject(e,i)),c.globalCompositeOperation="source-in",c.fillStyle=n?s.getPattern(c,this,Df(t),Em):s,c.fillRect(0,0,a,r),c.restore(),t.save(),t.transform(...o),t.scale(1,-1),Hm(t,l.canvas,0,0,a,r,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t?this.paintInlineImageXObject(t):Xp("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,s,n){if(!this.contentVisible)return;const i=this.getObject(e);if(!i)return void Xp("Dependent image isn't ready yet");const a=i.width,r=i.height,o=[];for(let l=0,c=n.length;l<c;l+=2)o.push({transform:[t,0,0,s,n[l],n[l+1]],x:0,y:0,w:a,h:r});this.paintInlineImageXObjectGroup(i,o)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:s,height:n}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,n),a=i.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,n=this.ctx;if(this.save(),!Yu){const{filter:e}=n;"none"!==e&&""!==e&&(n.filter="none")}let i;if(n.scale(1/t,-1/s),e.bitmap)i=this.applyTransferMapsToBitmap(e);else if("function"===typeof HTMLElement&&e instanceof HTMLElement||!e.data)i=e;else{const n=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Vm(n,e),i=this.applyTransferMapsToCanvas(n)}const a=this._scaleImage(i,Df(n));n.imageSmoothingEnabled=Xm(If(n),e.interpolate),Hm(n,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let n;if(e.bitmap)n=e.bitmap;else{const t=e.width,s=e.height,i=this.cachedCanvases.getCanvas("inlineImage",t,s).context;Vm(i,e),n=this.applyTransferMapsToCanvas(i)}for(const i of t)s.save(),s.transform(...i.transform),s.scale(1,-1),Hm(s,n,i.x,i.y,i.w,i.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===Qm?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=If(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),n=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,n)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:s,c:n,d:i}=this.ctx.getTransform();let a,r;if(0===s&&0===n){const s=Math.abs(t),n=Math.abs(i);if(s===n)if(0===e)a=r=1/s;else{const t=s*e;a=r=t<1?1/t:1}else if(0===e)a=1/s,r=1/n;else{const t=s*e,i=n*e;a=t<1?1/t:1,r=i<1?1/i:1}}else{const o=Math.abs(t*i-s*n),l=Math.hypot(t,s),c=Math.hypot(n,i);if(0===e)a=c/o,r=l/o;else{const t=e*o;a=c>t?c/t:1,r=l>t?l/t:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=r}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[n,i]=this.getScaleForStroking();if(t.lineWidth=s||1,1===n&&1===i)return void t.stroke();const a=t.getLineDash();if(e&&t.save(),t.scale(n,i),a.length>0){const e=Math.max(n,i);t.setLineDash(a.map((t=>t/e))),t.lineDashOffset/=e}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const s in Hp)void 0!==Zm.prototype[s]&&(Zm.prototype[Hp[s]]=Zm.prototype[s]);class eg{static#us=null;static#ps="";static get workerPort(){return this.#us}static set workerPort(e){if(!("undefined"!==typeof Worker&&e instanceof Worker)&&null!==e)throw new Error("Invalid `workerPort` type.");this.#us=e}static get workerSrc(){return this.#ps}static set workerSrc(e){if("string"!==typeof e)throw new Error("Invalid `workerSrc` type.");this.#ps=e}}class tg{#fs;#ms;constructor(e){let{parsedData:t,rawData:s}=e;this.#fs=t,this.#ms=s}getRaw(){return this.#ms}get(e){return this.#fs.get(e)??null}getAll(){return df(this.#fs)}has(e){return this.#fs.has(e)}}const sg=Symbol("INTERNAL");class ng{#gs=!1;#bs=!1;#vs=!1;#ys=!0;constructor(e,t){let{name:s,intent:n,usage:i,rbGroups:a}=t;this.#gs=!!(e&ep),this.#bs=!!(e&tp),this.name=s,this.intent=n,this.usage=i,this.rbGroups=a}get visible(){if(this.#vs)return this.#ys;if(!this.#ys)return!1;const{print:e,view:t}=this.usage;return this.#gs?"OFF"!==t?.viewState:!this.#bs||"OFF"!==e?.printState}_setVisible(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==sg&&Yp("Internal method `_setVisible` called."),this.#vs=s,this.#ys=t}}class ig{#xs=null;#ws=(()=>new Map)();#_s=null;#Ss=null;constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ep;if(this.renderingIntent=t,this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,this.#Ss=e.order;for(const s of e.groups)this.#ws.set(s.id,new ng(t,s));if("OFF"===e.baseState)for(const e of this.#ws.values())e._setVisible(sg,!1);for(const t of e.on)this.#ws.get(t)._setVisible(sg,!0);for(const t of e.off)this.#ws.get(t)._setVisible(sg,!1);this.#_s=this.getHash()}}#As(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let n=1;n<t;n++){const t=e[n];let i;if(Array.isArray(t))i=this.#As(t);else{if(!this.#ws.has(t))return Xp(`Optional content group not found: ${t}`),!0;i=this.#ws.get(t).visible}switch(s){case"And":if(!i)return!1;break;case"Or":if(i)return!0;break;case"Not":return!i;default:return!0}}return"And"===s}isVisible(e){if(0===this.#ws.size)return!0;if(!e)return Gp("Optional content group not defined."),!0;if("OCG"===e.type)return this.#ws.has(e.id)?this.#ws.get(e.id).visible:(Xp(`Optional content group not found: ${e.id}`),!0);if("OCMD"===e.type){if(e.expression)return this.#As(e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!this.#ws.has(t))return Xp(`Optional content group not found: ${t}`),!0;if(this.#ws.get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!this.#ws.has(t))return Xp(`Optional content group not found: ${t}`),!0;if(!this.#ws.get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!this.#ws.has(t))return Xp(`Optional content group not found: ${t}`),!0;if(!this.#ws.get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!this.#ws.has(t))return Xp(`Optional content group not found: ${t}`),!0;if(this.#ws.get(t).visible)return!1}return!0}return Xp(`Unknown optional content policy ${e.policy}.`),!0}return Xp(`Unknown group type ${e.type}.`),!0}setVisibility(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=this.#ws.get(e);if(n){if(s&&t&&n.rbGroups.length)for(const t of n.rbGroups)for(const s of t)s!==e&&this.#ws.get(s)?._setVisible(sg,!1,!0);n._setVisible(sg,!!t,!0),this.#xs=null}else Xp(`Optional content group not found: ${e}`)}setOCGState(e){let t,{state:s,preserveRB:n}=e;for(const i of s){switch(i){case"ON":case"OFF":case"Toggle":t=i;continue}const e=this.#ws.get(i);if(e)switch(t){case"ON":this.setVisibility(i,!0,n);break;case"OFF":this.setVisibility(i,!1,n);break;case"Toggle":this.setVisibility(i,!e.visible,n)}}this.#xs=null}get hasInitialVisibility(){return null===this.#_s||this.getHash()===this.#_s}getOrder(){return this.#ws.size?this.#Ss?this.#Ss.slice():[...this.#ws.keys()]:null}getGroups(){return this.#ws.size>0?df(this.#ws):null}getGroup(e){return this.#ws.get(e)||null}getHash(){if(null!==this.#xs)return this.#xs;const e=new em;for(const[t,s]of this.#ws)e.update(`${t}:${s.visible}`);return this.#xs=e.hexdigest()}}class ag{constructor(e,t){let{disableRange:s=!1,disableStream:n=!1}=t;Kp(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:a,progressiveDone:r,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=o,a?.length>0){const e=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!s,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener(((e,t)=>{this._onReceiveData({begin:e,chunk:t})})),e.addProgressListener(((e,t)=>{this._onProgress({loaded:e,total:t})})),e.addProgressiveReadListener((e=>{this._onReceiveData({chunk:e})})),e.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),e.transportReady()}_onReceiveData(e){let{begin:t,chunk:s}=e;const n=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{Kp(this._rangeReaders.some((function(e){return e._begin===t&&(e._enqueue(n),!0)})),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){void 0===e.total?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Kp(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new rg(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new og(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class rg{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._stream=e,this._done=s||!1,this._filename=Af(n)?n:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunks.push(e);this._loaded+=e.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class og{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function lg(e,t){const s=new Headers;if(!e||!t||"object"!==typeof t)return s;for(const n in t){const e=t[n];void 0!==e&&s.append(n,e)}return s}function cg(e){try{return new URL(e).origin}catch{}return null}function dg(e){let{responseHeaders:t,isHttp:s,rangeChunkSize:n,disableRange:i}=e;const a={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(t.get("Content-Length"),10);if(!Number.isInteger(r))return a;if(a.suggestedLength=r,r<=2*n)return a;if(i||!s)return a;if("bytes"!==t.get("Accept-Ranges"))return a;return"identity"!==(t.get("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a}function hg(e){const t=e.get("Content-Disposition");if(t){let e=function(e){let t=!0,s=n("filename\\*","i").exec(e);if(s){s=s[1];let e=r(s);return e=unescape(e),e=o(e),e=l(e),a(e)}if(s=function(e){const t=[];let s;const i=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(s=i.exec(e));){let[,e,n,i]=s;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[n,i]}const a=[];for(let n=0;n<t.length&&n in t;++n){let[e,s]=t[n];s=r(s),e&&(s=unescape(s),0===n&&(s=o(s))),a.push(s)}return a.join("")}(e),s)return a(l(s));if(s=n("filename","i").exec(e),s){s=s[1];let e=r(s);return e=l(e),a(e)}function n(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function i(e,s){if(e){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const n=new TextDecoder(e,{fatal:!0}),i=cf(s);s=n.decode(i),t=!1}catch{}}return s}function a(e){return t&&/[\x80-\xff]/.test(e)&&(e=i("utf-8",e),t&&(e=i("iso-8859-1",e))),e}function r(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const s=t[e].indexOf('"');-1!==s&&(t[e]=t[e].slice(0,s),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function o(e){const t=e.indexOf("'");return-1===t?e:i(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function l(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(e,t,s,n){if("q"===s||"Q"===s)return n=(n=n.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})),i(t,n);try{n=atob(n)}catch{}return i(t,n)}))}return""}(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Af(e))return e}return null}function ug(e,t){return 404===e||0===e&&t.startsWith("file:")?new nf('Missing PDF "'+t+'".'):new af(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e)}function pg(e){return 200===e||206===e}function fg(e,t,s){return{method:"GET",headers:e,signal:s.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function mg(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(Xp(`getArrayBuffer - unexpected data format: ${e}`),new Uint8Array(e).buffer)}class gg{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=lg(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Kp(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new bg(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new vg(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class bg{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),n=t.url;fetch(n,fg(s,this._withCredentials,this._abortController)).then((t=>{if(e._responseOrigin=cg(t.url),!pg(t.status))throw ug(t.status,n);this._reader=t.body.getReader(),this._headersCapability.resolve();const s=t.headers,{allowRangeRequests:i,suggestedLength:a}=dg({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=a||this._contentLength,this._filename=hg(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new of("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:mg(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class vg{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const n=e.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${s-1}`);const a=n.url;fetch(a,fg(i,this._withCredentials,this._abortController)).then((t=>{const s=cg(t.url);if(s!==e._responseOrigin)throw new Error(`Expected range response-origin "${s}" to match "${e._responseOrigin}".`);if(!pg(t.status))throw ug(t.status,a);this._readCapability.resolve(),this._reader=t.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:mg(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class yg{_responseOrigin=null;constructor(e){let{url:t,httpHeaders:s,withCredentials:n}=e;this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=lg(this.isHttp,s),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,n=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,a]of this.headers)t.setRequestHeader(i,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.expectedStatus=206):n.expectedStatus=200,t.responseType="arraybuffer",Kp(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),n.onHeadersReceived=e.onHeadersReceived,n.onDone=e.onDone,n.onError=e.onError,n.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const n=s.xhr;if(n.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),4!==n.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===n.status&&this.isHttp)return void s.onError(n.status);const i=n.status||200;if(!(200===i&&206===s.expectedStatus)&&i!==s.expectedStatus)return void s.onError(n.status);const a=function(e){const t=e.response;return"string"!==typeof t?t:cf(t).buffer}(n);if(206===i){const e=n.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);t?s.onDone({begin:parseInt(t[1],10),chunk:a}):(Xp('Missing or invalid "Content-Range" header.'),s.onError(0))}else a?s.onDone({begin:0,chunk:a}):s.onError(n.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class xg{constructor(e){this._source=e,this._manager=new yg(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Kp(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new wg(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new _g(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class wg{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=cg(t.responseURL);const s=t.getAllResponseHeaders(),n=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map((e=>{const[t,...s]=e.split(": ");return[t,s.join(": ")]})):[]),{allowRangeRequests:i,suggestedLength:a}=dg({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=hg(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e)if(this._requests.length>0){this._requests.shift().resolve({value:e.chunk,done:!1})}else this._cachedChunks.push(e.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=ug(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _g{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=cg(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunk=t;this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=ug(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const Sg=/^[a-z][a-z0-9\-+.]+:/i;class Ag{constructor(e){this.source=e,this.url=function(e){if(Sg.test(e))return new URL(e);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(e))}(e.url),Kp("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Kp(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new kg(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new Eg(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class kg{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then((e=>{this._contentLength=e.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()}),(e=>{"ENOENT"===e.code&&(e=new nf(`Missing PDF "${this._url}".`)),this._storedError=e,this._headersCapability.reject(e)}))}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();if(null===e)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(e).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",(()=>{this._readCapability.resolve()})),e.on("end",(()=>{e.destroy(),this._done=!0,this._readCapability.resolve()})),e.on("error",(e=>{this._error(e)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new of("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Eg{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=e.source;this._isStreamingSupported=!n.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();if(null===e)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=e.length,this.onProgress?.({loaded:this._loaded});return{value:new Uint8Array(e).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",(()=>{this._readCapability.resolve()})),e.on("end",(()=>{e.destroy(),this._done=!0,this._readCapability.resolve()})),e.on("error",(e=>{this._error(e)})),this._storedError&&this._readableStream.destroy(this._storedError)}}const Cg=30;class jg{#ks=(()=>Promise.withResolvers())();#pe=null;#Es=!1;#Cs=(()=>!!globalThis.FontInspector?.enabled)();#js=null;#Ns=null;#Ts=0;#Ps=0;#Ms=null;#Rs=null;#Is=0;#Ds=0;#Ls=(()=>Object.create(null))();#Os=[];#Fs=null;#zs=[];#$s=(()=>new WeakMap)();#Bs=null;static#Hs=(()=>new Map)();static#Us=(()=>new Map)();static#Vs=(()=>new WeakMap)();static#Ws=null;static#qs=(()=>new Set)();constructor(e){let{textContentSource:t,container:s,viewport:n}=e;if(t instanceof ReadableStream)this.#Fs=t;else{if("object"!==typeof t)throw new Error('No "textContentSource" parameter specified.');this.#Fs=new ReadableStream({start(e){e.enqueue(t),e.close()}})}this.#pe=this.#Rs=s,this.#Ds=n.scale*(globalThis.devicePixelRatio||1),this.#Is=n.rotation,this.#Ns={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:a,pageX:r,pageY:o}=n.rawDims;this.#Bs=[1,0,0,-1,-r,o+a],this.#Ps=i,this.#Ts=a,jg.#Gs(),Lf(s,n),this.#ks.promise.finally((()=>{jg.#qs.delete(this),this.#Ns=null,this.#Ls=null})).catch((()=>{}))}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=hf.platform;return Qp(this,"fontFamilyMap",new Map([["sans-serif",(e&&t?"Calibri, ":"")+"sans-serif"],["monospace",(e&&t?"Lucida Console, ":"")+"monospace"]]))}render(){const e=()=>{this.#Ms.read().then((t=>{let{value:s,done:n}=t;n?this.#ks.resolve():(this.#js??=s.lang,Object.assign(this.#Ls,s.styles),this.#Xs(s.items),e())}),this.#ks.reject)};return this.#Ms=this.#Fs.getReader(),jg.#qs.add(this),e(),this.#ks.promise}update(e){let{viewport:t,onBefore:s=null}=e;const n=t.scale*(globalThis.devicePixelRatio||1),i=t.rotation;if(i!==this.#Is&&(s?.(),this.#Is=i,Lf(this.#Rs,{rotation:i})),n!==this.#Ds){s?.(),this.#Ds=n;const e={div:null,properties:null,ctx:jg.#Ys(this.#js)};for(const t of this.#zs)e.properties=this.#$s.get(t),e.div=t,this.#Ks(e)}}cancel(){const e=new of("TextLayer task cancelled.");this.#Ms?.cancel(e).catch((()=>{})),this.#Ms=null,this.#ks.reject(e)}get textDivs(){return this.#zs}get textContentItemsStr(){return this.#Os}#Xs(e){if(this.#Es)return;this.#Ns.ctx??=jg.#Ys(this.#js);const t=this.#zs,s=this.#Os;for(const n of e){if(t.length>1e5)return Xp("Ignoring additional textDivs for performance reasons."),void(this.#Es=!0);if(void 0!==n.str)s.push(n.str),this.#Js(n);else if("beginMarkedContentProps"===n.type||"beginMarkedContent"===n.type){const e=this.#pe;this.#pe=document.createElement("span"),this.#pe.classList.add("markedContent"),null!==n.id&&this.#pe.setAttribute("id",`${n.id}`),e.append(this.#pe)}else"endMarkedContent"===n.type&&(this.#pe=this.#pe.parentNode)}}#Js(e){const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};this.#zs.push(t);const n=pf.transform(this.#Bs,e.transform);let i=Math.atan2(n[1],n[0]);const a=this.#Ls[e.fontName];a.vertical&&(i+=Math.PI/2);let r=this.#Cs&&a.fontSubstitution||a.fontFamily;r=jg.fontFamilyMap.get(r)||r;const o=Math.hypot(n[2],n[3]),l=o*jg.#Qs(r,this.#js);let c,d;0===i?(c=n[4],d=n[5]-l):(c=n[4]+l*Math.sin(i),d=n[5]-l*Math.cos(i));const h="calc(var(--scale-factor)*",u=t.style;this.#pe===this.#Rs?(u.left=`${(100*c/this.#Ps).toFixed(2)}%`,u.top=`${(100*d/this.#Ts).toFixed(2)}%`):(u.left=`${h}${c.toFixed(2)}px)`,u.top=`${h}${d.toFixed(2)}px)`),u.fontSize=`${h}${(jg.#Ws*o).toFixed(2)}px)`,u.fontFamily=r,s.fontSize=o,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#Cs&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),0!==i&&(s.angle=i*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),s=Math.abs(e.transform[3]);t!==s&&Math.max(t,s)/Math.min(t,s)>1.5&&(p=!0)}if(p&&(s.canvasWidth=a.vertical?e.height:e.width),this.#$s.set(t,s),this.#Ns.div=t,this.#Ns.properties=s,this.#Ks(this.#Ns),s.hasText&&this.#pe.append(t),s.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),this.#pe.append(e)}}#Ks(e){const{div:t,properties:s,ctx:n}=e,{style:i}=t;let a="";if(jg.#Ws>1&&(a=`scale(${1/jg.#Ws})`),0!==s.canvasWidth&&s.hasText){const{fontFamily:e}=i,{canvasWidth:r,fontSize:o}=s;jg.#Zs(n,o*this.#Ds,e);const{width:l}=n.measureText(t.textContent);l>0&&(a=`scaleX(${r*this.#Ds/l}) ${a}`)}0!==s.angle&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(i.transform=a)}static cleanup(){if(!(this.#qs.size>0)){this.#Hs.clear();for(const{canvas:e}of this.#Us.values())e.remove();this.#Us.clear()}}static#Ys(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.#Us.get(e||="");if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#Us.set(e,t),this.#Vs.set(t,{size:0,family:""})}return t}static#Zs(e,t,s){const n=this.#Vs.get(e);t===n.size&&s===n.family||(e.font=`${t}px ${s}`,n.size=t,n.family=s)}static#Gs(){if(null!==this.#Ws)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#Ws=e.getBoundingClientRect().height,e.remove()}static#Qs(e,t){const s=this.#Hs.get(e);if(s)return s;const n=this.#Ys(t);n.canvas.width=n.canvas.height=Cg,this.#Zs(n,Cg,e);const i=n.measureText("");let a=i.fontBoundingBoxAscent,r=Math.abs(i.fontBoundingBoxDescent);if(a){const t=a/(a+r);return this.#Hs.set(e,t),n.canvas.width=n.canvas.height=0,t}n.strokeStyle="red",n.clearRect(0,0,Cg,Cg),n.strokeText("g",0,0);let o=n.getImageData(0,0,Cg,Cg).data;r=0;for(let c=o.length-1-3;c>=0;c-=4)if(o[c]>0){r=Math.ceil(c/4/Cg);break}n.clearRect(0,0,Cg,Cg),n.strokeText("A",0,Cg),o=n.getImageData(0,0,Cg,Cg).data,a=0;for(let c=0,d=o.length;c<d;c+=4)if(o[c]>0){a=Cg-Math.floor(c/4/Cg);break}n.canvas.width=n.canvas.height=0;const l=a?a/(a+r):.8;return this.#Hs.set(e,l),l}}class Ng{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};return function e(s){if(!s)return;let n=null;const i=s.name;if("#text"===i)n=s.value;else{if(!Ng.shouldBuildText(i))return;s?.attributes?.textContent?n=s.attributes.textContent:s.value&&(n=s.value)}if(null!==n&&t.push({str:n}),s.children)for(const t of s.children)e(t)}(e),s}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}const Tg=65536,Pg=Yu?class extends ym{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire("file:///C:/Users/shrut/OneDrive/Desktop/DigiHealth(React)/digihealth/node_modules/pdfjs-dist/build/pdf.mjs")("@napi-rs/canvas").createCanvas(e,t)}}:class extends ym{constructor(e){let{ownerDocument:t=globalThis.document,enableHWA:s=!1}=e;super({enableHWA:s}),this._document=t}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}},Mg=Yu?class extends xm{async _fetch(e){return km(e)}}:wm,Rg=Yu?class extends _m{}:class extends _m{#en;#tn;#sn;#nn;#in;#an;#y=0;constructor(e){let{docId:t,ownerDocument:s=globalThis.document}=e;super(),this.#nn=t,this.#in=s}get#w(){return this.#tn||=new Map}get#rn(){return this.#an||=new Map}get#on(){if(!this.#sn){const e=this.#in.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=this.#in.createElementNS(vf,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#sn=this.#in.createElementNS(vf,"defs"),e.append(s),s.append(this.#sn),this.#in.body.append(e)}return this.#sn}#ln(e){if(1===e.length){const t=e[0],s=new Array(256);for(let e=0;e<256;e++)s[e]=t[e]/255;const n=s.join(",");return[n,n,n]}const[t,s,n]=e,i=new Array(256),a=new Array(256),r=new Array(256);for(let o=0;o<256;o++)i[o]=t[o]/255,a[o]=s[o]/255,r[o]=n[o]/255;return[i.join(","),a.join(","),r.join(",")]}#cn(e){if(void 0===this.#en){this.#en="";const e=this.#in.URL;e!==this.#in.baseURI&&(Sf(e)?Xp('#createUrl: ignore "data:"-URL for performance reasons.'):this.#en=e.split("#",1)[0])}return`url(${this.#en}#${e})`}addFilter(e){if(!e)return"none";let t=this.#w.get(e);if(t)return t;const[s,n,i]=this.#ln(e),a=1===e.length?s:`${s}${n}${i}`;if(t=this.#w.get(a),t)return this.#w.set(e,t),t;const r=`g_${this.#nn}_transfer_map_${this.#y++}`,o=this.#cn(r);this.#w.set(e,o),this.#w.set(a,o);const l=this.#dn(r);return this.#hn(s,n,i,l),o}addHCMFilter(e,t){const s=`${e}-${t}`,n="base";let i=this.#rn.get(n);if(i?.key===s)return i.url;if(i?(i.filter?.remove(),i.key=s,i.url="none",i.filter=null):(i={key:s,url:"none",filter:null},this.#rn.set(n,i)),!e||!t)return i.url;const a=this.#un(e);e=pf.makeHexColor(...a);const r=this.#un(t);if(t=pf.makeHexColor(...r),this.#on.style.color="","#000000"===e&&"#ffffff"===t||e===t)return i.url;const o=new Array(256);for(let u=0;u<=255;u++){const e=u/255;o[u]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const l=o.join(","),c=`g_${this.#nn}_hcm_filter`,d=i.filter=this.#dn(c);this.#hn(l,l,l,d),this.#pn(d);const h=(e,t)=>{const s=a[e]/255,n=r[e]/255,i=new Array(t+1);for(let a=0;a<=t;a++)i[a]=s+a/t*(n-s);return i.join(",")};return this.#hn(h(0,5),h(1,5),h(2,5),d),i.url=this.#cn(c),i.url}addAlphaFilter(e){let t=this.#w.get(e);if(t)return t;const[s]=this.#ln([e]),n=`alpha_${s}`;if(t=this.#w.get(n),t)return this.#w.set(e,t),t;const i=`g_${this.#nn}_alpha_map_${this.#y++}`,a=this.#cn(i);this.#w.set(e,a),this.#w.set(n,a);const r=this.#dn(i);return this.#fn(s,r),a}addLuminosityFilter(e){let t,s,n=this.#w.get(e||"luminosity");if(n)return n;if(e?([t]=this.#ln([e]),s=`luminosity_${t}`):s="luminosity",n=this.#w.get(s),n)return this.#w.set(e,n),n;const i=`g_${this.#nn}_luminosity_map_${this.#y++}`,a=this.#cn(i);this.#w.set(e,a),this.#w.set(s,a);const r=this.#dn(i);return this.#mn(r),e&&this.#fn(t,r),a}addHighlightHCMFilter(e,t,s,n,i){const a=`${t}-${s}-${n}-${i}`;let r=this.#rn.get(e);if(r?.key===a)return r.url;if(r?(r.filter?.remove(),r.key=a,r.url="none",r.filter=null):(r={key:a,url:"none",filter:null},this.#rn.set(e,r)),!t||!s)return r.url;const[o,l]=[t,s].map(this.#un.bind(this));let c=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),d=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[h,u]=[n,i].map(this.#un.bind(this));d<c&&([c,d,h,u]=[d,c,u,h]),this.#on.style.color="";const p=(e,t,s)=>{const n=new Array(256),i=(d-c)/s,a=e/255,r=(t-e)/(255*s);let o=0;for(let l=0;l<=s;l++){const e=Math.round(c+l*i),t=a+l*r;for(let s=o;s<=e;s++)n[s]=t;o=e+1}for(let l=o;l<256;l++)n[l]=n[o-1];return n.join(",")},f=`g_${this.#nn}_hcm_${e}_filter`,m=r.filter=this.#dn(f);return this.#pn(m),this.#hn(p(h[0],u[0],5),p(h[1],u[1],5),p(h[2],u[2],5),m),r.url=this.#cn(f),r.url}destroy(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.#an?.size||(this.#sn?.parentNode.parentNode.remove(),this.#sn=null,this.#tn?.clear(),this.#tn=null,this.#an?.clear(),this.#an=null,this.#y=0)}#mn(e){const t=this.#in.createElementNS(vf,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#pn(e){const t=this.#in.createElementNS(vf,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#dn(e){const t=this.#in.createElementNS(vf,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#on.append(t),t}#gn(e,t,s){const n=this.#in.createElementNS(vf,t);n.setAttribute("type","discrete"),n.setAttribute("tableValues",s),e.append(n)}#hn(e,t,s,n){const i=this.#in.createElementNS(vf,"feComponentTransfer");n.append(i),this.#gn(i,"feFuncR",e),this.#gn(i,"feFuncG",t),this.#gn(i,"feFuncB",s)}#fn(e,t){const s=this.#in.createElementNS(vf,"feComponentTransfer");t.append(s),this.#gn(s,"feFuncA",e)}#un(e){return this.#on.style.color=e,Rf(getComputedStyle(this.#on).getPropertyValue("color"))}},Ig=Yu?class extends Sm{async _fetch(e){return km(e)}}:Am;function Dg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"string"===typeof e||e instanceof URL?e={url:e}:(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t=new Og,{docId:s}=t,n=e.url?function(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(Yu&&"string"===typeof e)return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(e.url):null,i=e.data?function(e){if(Yu&&"undefined"!==typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"===typeof e)return cf(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||"object"===typeof e&&!isNaN(e?.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(e.data):null,a=e.httpHeaders||null,r=!0===e.withCredentials,o=e.password??null,l=e.range instanceof Fg?e.range:null,c=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:Tg;let d=e.worker instanceof Hg?e.worker:null;const h=e.verbosity,u="string"!==typeof e.docBaseUrl||Sf(e.docBaseUrl)?null:e.docBaseUrl,p="string"===typeof e.cMapUrl?e.cMapUrl:null,f=!1!==e.cMapPacked,m=e.CMapReaderFactory||Mg,g="string"===typeof e.standardFontDataUrl?e.standardFontDataUrl:null,b=e.StandardFontDataFactory||Ig,v=!0!==e.stopAtErrors,y=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,x=!1!==e.isEvalSupported,w="boolean"===typeof e.isOffscreenCanvasSupported?e.isOffscreenCanvasSupported:!Yu,_="boolean"===typeof e.isImageDecoderSupported?e.isImageDecoderSupported:!Yu&&(hf.platform.isFirefox||!globalThis.chrome),S=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,A="boolean"===typeof e.disableFontFace?e.disableFontFace:Yu,k=!0===e.fontExtraProperties,E=!0===e.enableXfa,C=e.ownerDocument||globalThis.document,j=!0===e.disableRange,N=!0===e.disableStream,T=!0===e.disableAutoFetch,P=!0===e.pdfBug,M=e.CanvasFactory||Pg,R=e.FilterFactory||Rg,I=!0===e.enableHWA,D=l?l.length:e.length??NaN,L="boolean"===typeof e.useSystemFonts?e.useSystemFonts:!Yu&&!A,O="boolean"===typeof e.useWorkerFetch?e.useWorkerFetch:m===wm&&b===Am&&p&&g&&jf(p,document.baseURI)&&jf(g,document.baseURI);Wp(h);const F={canvasFactory:new M({ownerDocument:C,enableHWA:I}),filterFactory:new R({docId:s,ownerDocument:C}),cMapReaderFactory:O?null:new m({baseUrl:p,isCompressed:f}),standardFontDataFactory:O?null:new b({baseUrl:g})};if(!d){const e={verbosity:h,port:eg.workerPort};d=e.port?Hg.fromPort(e):new Hg(e),t._worker=d}const z={docId:s,apiVersion:"4.10.38",data:i,password:o,disableAutoFetch:T,rangeChunkSize:c,length:D,docBaseUrl:u,enableXfa:E,evaluatorOptions:{maxImageSize:y,disableFontFace:A,ignoreErrors:v,isEvalSupported:x,isOffscreenCanvasSupported:w,isImageDecoderSupported:_,canvasMaxAreaInBytes:S,fontExtraProperties:k,useSystemFonts:L,cMapUrl:O?p:null,standardFontDataUrl:O?g:null}},$={disableFontFace:A,fontExtraProperties:k,ownerDocument:C,pdfBug:P,styleElement:null,loadingParams:{disableAutoFetch:T,enableXfa:E}};return d.promise.then((function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const e=d.messageHandler.sendWithPromise("GetDocRequest",z,i?[i.buffer]:null);let o;if(l)o=new ag(l,{disableRange:j,disableStream:N});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");let e;if(Yu)if(jf(n)){if("undefined"===typeof fetch||"undefined"===typeof Response||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");e=gg}else e=Ag;else e=jf(n)?gg:xg;o=new e({url:n,length:D,httpHeaders:a,withCredentials:r,rangeChunkSize:c,disableRange:j,disableStream:N})}return e.then((e=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const n=new vm(s,e,d.port),i=new Ug(n,t,o,$,F);t._transport=i,n.send("Ready",null)}))})).catch(t._capability.reject),t}function Lg(e){return"object"===typeof e&&Number.isInteger(e?.num)&&e.num>=0&&Number.isInteger(e?.gen)&&e.gen>=0}class Og{static#nn=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId="d"+Og.#nn++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}}class Fg{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then((()=>{for(const s of this._progressListeners)s(e,t)}))}onDataProgressiveRead(e){this._readyCapability.promise.then((()=>{for(const t of this._progressiveReadListeners)t(e)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const e of this._progressiveDoneListeners)e()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Yp("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class zg{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Qp(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class $g{#bn=null;#vn=!1;constructor(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=n?new Cf:null,this._pdfBug=n,this.commonObjs=s.commonObjs,this.objs=new Wg,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:n=0,dontFlip:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new wf({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:n,dontFlip:i})}getAnnotations(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Qp(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render(e){let{canvasContext:t,viewport:s,intent:n="display",annotationMode:i=op.ENABLE,transform:a=null,background:r=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:d=null,isEditing:h=!1}=e;this._stats?.time("Overall");const u=this._transport.getRenderingIntent(n,i,d,h),{renderingIntent:p,cacheKey:f}=u;this.#vn=!1,this.#yn(),o||=this._transport.getOptionalContentConfig(p);let m=this._intentStates.get(f);m||(m=Object.create(null),this._intentStates.set(f,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const g=!!(p&tp);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(u));const b=e=>{m.renderTasks.delete(v),(this._maybeCleanupAfterRender||g)&&(this.#vn=!0),this.#xn(!g),e?(v.capability.reject(e),this._abortOperatorList({intentState:m,reason:e instanceof Error?e:new Error(e)})):v.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},v=new Gg({callback:b,params:{canvasContext:t,viewport:s,transform:a,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!g,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||=new Set).add(v);const y=v.task;return Promise.all([m.displayReadyCapability.promise,o]).then((e=>{let[t,s]=e;if(this.destroyed)b();else{if(this._stats?.time("Rendering"),!(s.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");v.initializeGraphics({transparency:t,optionalContentConfig:s}),v.operatorListChanged()}})).catch(b),y}getOperatorList(){let{intent:e="display",annotationMode:t=op.ENABLE,printAnnotationStorage:s=null,isEditing:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=this._transport.getRenderingIntent(e,t,s,n,!0);let a,r=this._intentStates.get(i.cacheKey);return r||(r=Object.create(null),this._intentStates.set(i.cacheKey,r)),r.opListReadCapability||(a=Object.create(null),a.operatorListChanged=function(){r.operatorList.lastChunk&&(r.opListReadCapability.resolve(r.operatorList),r.renderTasks.delete(a))},r.opListReadCapability=Promise.withResolvers(),(r.renderTasks||=new Set).add(a),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(i)),r.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:e=!1,disableNormalization:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then((e=>Ng.textContent(e)));const t=this.streamTextContent(e);return new Promise((function(e,s){const n=t.getReader(),i={items:[],styles:Object.create(null),lang:null};!function t(){n.read().then((function(s){let{value:n,done:a}=s;a?e(i):(i.lang??=n.lang,Object.assign(i.styles,n.styles),i.items.push(...n.items),t())}),s)}()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),this.#vn=!1,this.#yn(),Promise.all(e)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.#vn=!0;const t=this.#xn(!1);return e&&t&&(this._stats&&=new Cf),t}#xn(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.#yn(),!this.#vn||this.destroyed)return!1;if(e)return this.#bn=setTimeout((()=>{this.#bn=null,this.#xn(!1)}),5e3),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#vn=!1,!0}#yn(){this.#bn&&(clearTimeout(this.#bn),this.#bn=null)}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let s=0,n=e.length;s<n;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&this.#xn(!0)}_pumpOperatorList(e){let{renderingIntent:t,cacheKey:s,annotationStorageSerializable:n,modifiedIds:i}=e;const{map:a,transfer:r}=n,o=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:s,annotationStorage:a,modifiedIds:i},r).getReader(),l=this._intentStates.get(s);l.streamReader=o;const c=()=>{o.read().then((e=>{let{value:t,done:s}=e;s?l.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,l),c())}),(e=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const e of l.renderTasks)e.operatorListChanged();this.#xn(!0)}if(l.displayReadyCapability)l.displayReadyCapability.reject(e);else{if(!l.opListReadCapability)throw e;l.opListReadCapability.reject(e)}}}))};c()}_abortOperatorList(e){let{intentState:t,reason:s,force:n=!1}=e;if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(s instanceof _f){let e=100;return s.extraDelay>0&&s.extraDelay<1e3&&(e+=s.extraDelay),void(t.streamReaderCancelTimeout=setTimeout((()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:s,force:!0})}),e))}}if(t.streamReader.cancel(new of(s.message)).catch((()=>{})),t.streamReader=null,!this._transport.destroyed){for(const[e,s]of this._intentStates)if(s===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}class Bg{#wn=(()=>new Map)();#_n=(()=>Promise.resolve())();postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};this.#_n.then((()=>{for(const[e]of this.#wn)e.call(this,s)}))}addEventListener(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=null;if(s?.signal instanceof AbortSignal){const{signal:i}=s;if(i.aborted)return void Xp("LoopbackPort - cannot use an `aborted` signal.");const a=()=>this.removeEventListener(e,t);n=()=>i.removeEventListener("abort",a),i.addEventListener("abort",a)}this.#wn.set(t,n)}removeEventListener(e,t){const s=this.#wn.get(t);s?.(),this.#wn.delete(t)}terminate(){for(const[,e]of this.#wn)e?.();this.#wn.clear()}}class Hg{static#Sn=0;static#An=!1;static#kn;static#En=(()=>{Yu&&(this.#An=!0,eg.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||"null"===s.origin)return!1}catch{return!1}const n=new URL(t,s);return s.origin===n.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}})();constructor(){let{name:e=null,port:t=null,verbosity:s=qp()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(Hg.#kn?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");return(Hg.#kn||=new WeakMap).set(t,this),void this._initializeFromPort(t)}this._initialize()}get promise(){return this._readyCapability.promise}#Cn(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new vm("main","worker",e),this._messageHandler.on("ready",(function(){})),this.#Cn()}_initialize(){if(Hg.#An||Hg.#jn)return void this._setupFakeWorker();let{workerSrc:e}=Hg;try{Hg._isSameOrigin(window.location.href,e)||(e=Hg._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new vm("main","worker",t),n=()=>{i.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=new AbortController;t.addEventListener("error",(()=>{this._webWorker||n()}),{signal:i.signal}),s.on("test",(e=>{i.abort(),!this.destroyed&&e?(this._messageHandler=s,this._port=t,this._webWorker=t,this.#Cn()):n()})),s.on("ready",(e=>{if(i.abort(),this.destroyed)n();else try{a()}catch{this._setupFakeWorker()}}));const a=()=>{const e=new Uint8Array;s.send("test",e,[e.buffer])};return void a()}catch{Gp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Hg.#An||(Xp("Setting up fake worker."),Hg.#An=!0),Hg._setupFakeWorkerGlobal.then((e=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const t=new Bg;this._port=t;const s="fake"+Hg.#Sn++,n=new vm(s+"_worker",s,t);e.setup(n,t),this._messageHandler=new vm(s,s+"_worker",t),this.#Cn()})).catch((e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,Hg.#kn?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#kn?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Hg(e)}static get workerSrc(){if(eg.workerSrc)return eg.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#jn(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return Qp(this,"_setupFakeWorkerGlobal",(async()=>{if(this.#jn)return this.#jn;return(await import(this.workerSrc)).WorkerMessageHandler})())}}class Ug{#Nn=(()=>new Map)();#Tn=(()=>new Map)();#Pn=(()=>new Map)();#Mn=(()=>new Map)();#Rn=null;constructor(e,t,s,n,i){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Wg,this.fontLoader=new im({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#In(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.#Nn.get(e);if(s)return s;const n=this.messageHandler.sendWithPromise(e,t);return this.#Nn.set(e,n),n}get annotationStorage(){return Qp(this,"annotationStorage",new sm)}getRenderingIntent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:op.ENABLE,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=ep,r=tm;switch(e){case"any":a=Zu;break;case"display":break;case"print":a=tp;break;default:Xp(`getRenderingIntent - invalid intent: ${e}`)}const o=a&tp&&s instanceof nm?s:this.annotationStorage;switch(t){case op.DISABLE:a+=ip;break;case op.ENABLE:break;case op.ENABLE_FORMS:a+=sp;break;case op.ENABLE_STORAGE:a+=np,r=o.serializable;break;default:Xp(`getRenderingIntent - invalid annotationMode: ${t}`)}n&&(a+=ap),i&&(a+=rp);const{ids:l,hash:c}=o.modifiedIds;return{renderingIntent:a,cacheKey:[a,r.hash,c].join("_"),annotationStorageSerializable:r,modifiedIds:l}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#Rn?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of this.#Tn.values())e.push(s._destroy());this.#Tn.clear(),this.#Pn.clear(),this.#Mn.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#Nn.clear(),this.filterFactory.destroy(),jg.cleanup(),this._networkStream?.cancelAllRequests(new of("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",((e,t)=>{Kp(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then((function(e){let{value:s,done:n}=e;n?t.close():(Kp(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(s),1,[s]))})).catch((e=>{t.error(e)}))},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch((e=>{if(!this.destroyed)throw e}))}})),e.on("ReaderHeadersReady",(async e=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:n,contentLength:i}=this._fullReader;return s&&n||(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=e=>{t.onProgress?.({loaded:e.loaded,total:e.total})}),{isStreamingSupported:s,isRangeSupported:n,contentLength:i}})),e.on("GetRangeReader",((e,t)=>{Kp(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(e.begin,e.end);s?(t.onPull=()=>{s.read().then((function(e){let{value:s,done:n}=e;n?t.close():(Kp(s instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(s),1,[s]))})).catch((e=>{t.error(e)}))},t.onCancel=e=>{s.cancel(e),t.ready.catch((e=>{if(!this.destroyed)throw e}))}):t.close()})),e.on("GetDoc",(e=>{let{pdfInfo:s}=e;this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new zg(s,this))})),e.on("DocException",(e=>{t._capability.reject(bm(e))})),e.on("PasswordRequest",(e=>{this.#Rn=Promise.withResolvers();try{if(!t.onPassword)throw bm(e);const s=e=>{e instanceof Error?this.#Rn.reject(e):this.#Rn.resolve({password:e})};t.onPassword(s,e.code)}catch(s){this.#Rn.reject(s)}return this.#Rn.promise})),e.on("DataLoaded",(e=>{t.onProgress?.({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)})),e.on("StartRenderPage",(e=>{if(this.destroyed)return;this.#Tn.get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)})),e.on("commonobj",(t=>{let[s,n,i]=t;if(this.destroyed)return null;if(this.commonObjs.has(s))return null;switch(n){case"Font":const{disableFontFace:t,fontExtraProperties:a,pdfBug:r}=this._params;if("error"in i){const e=i.error;Xp(`Error during font loading: ${e}`),this.commonObjs.resolve(s,e);break}const o=r&&globalThis.FontInspector?.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,l=new am(i,{disableFontFace:t,fontExtraProperties:a,inspectFont:o});this.fontLoader.bind(l).catch((()=>e.sendWithPromise("FontFallback",{id:s}))).finally((()=>{!a&&l.data&&(l.data=null),this.commonObjs.resolve(s,l)}));break;case"CopyLocalImage":const{imageRef:c}=i;Kp(c,"The imageRef must be defined.");for(const e of this.#Tn.values())for(const[,t]of e.objs)if(t?.ref===c)return t.dataLen?(this.commonObjs.resolve(s,structuredClone(t)),t.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,i);break;default:throw new Error(`Got unknown common object type ${n}`)}return null})),e.on("obj",(e=>{let[t,s,n,i]=e;if(this.destroyed)return;const a=this.#Tn.get(s);if(!a.objs.has(t))if(0!==a._intentStates.size)switch(n){case"Image":a.objs.resolve(t,i),i?.dataLen>1e7&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(t,i);break;default:throw new Error(`Got unknown object type ${n}`)}else i?.bitmap?.close()})),e.on("DocProgress",(e=>{this.destroyed||t.onProgress?.({loaded:e.loaded,total:e.total})})),e.on("FetchBuiltInCMap",(async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(e)})),e.on("FetchStandardFontData",(async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(e)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Xp("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally((()=>{this.annotationStorage.resetModified()}))}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#Pn.get(t);if(s)return s;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then((s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#Mn.set(s.refStr,e);const n=new $g(t,s,this,this._params.pdfBug);return this.#Tn.set(t,n),n}));return this.#Pn.set(t,n),n}getPageIndex(e){return Lg(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#In("GetFieldObjects")}hasJSActions(){return this.#In("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!==typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#In("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#In("GetOptionalContentConfig").then((t=>new ig(t,e)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#Nn.get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then((e=>({info:e[0],metadata:e[1]?new tg(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})));return this.#Nn.set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#Tn.values()){if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`)}this.commonObjs.clear(),e||this.fontLoader.clear(),this.#Nn.clear(),this.filterFactory.destroy(!0),jg.cleanup()}}cachedPageNumber(e){if(!Lg(e))return null;const t=0===e.gen?`${e.num}R`:`${e.num}R${e.gen}`;return this.#Mn.get(t)??null}}const Vg=Symbol("INITIAL_DATA");class Wg{#Dn=(()=>Object.create(null))();#Ln(e){return this.#Dn[e]||={...Promise.withResolvers(),data:Vg}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){const s=this.#Ln(e);return s.promise.then((()=>t(s.data))),null}const s=this.#Dn[e];if(!s||s.data===Vg)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=this.#Dn[e];return!!t&&t.data!==Vg}delete(e){const t=this.#Dn[e];return!(!t||t.data===Vg)&&(delete this.#Dn[e],!0)}resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.#Ln(e);s.data=t,s.resolve()}clear(){for(const e in this.#Dn){const{data:t}=this.#Dn[e];t?.bitmap?.close()}this.#Dn=Object.create(null)}*[Symbol.iterator](){for(const e in this.#Dn){const{data:t}=this.#Dn[e];t!==Vg&&(yield[e,t])}}}class qg{#On=null;constructor(e){this.#On=e,this.onContinue=null}get promise(){return this.#On.capability.promise}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.#On.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#On.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#On;return e.form||e.canvas&&t?.size>0}}class Gg{#Fn=null;static#zn=(()=>new WeakSet)();constructor(e){let{callback:t,params:s,objs:n,commonObjs:i,annotationCanvasMap:a,operatorList:r,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:u=null}=e;this.callback=t,this.params=s,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===d&&"undefined"!==typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new qg(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=s.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics(e){let{transparency:t=!1,optionalContentConfig:s}=e;if(this.cancelled)return;if(this._canvas){if(Gg.#zn.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Gg.#zn.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:a,background:r}=this.params;this.gfx=new Zm(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:s},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:i,transparency:t,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#Fn&&(window.cancelAnimationFrame(this.#Fn),this.#Fn=null),Gg.#zn.delete(this._canvas),this.callback(e||new _f(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#Fn=window.requestAnimationFrame((()=>{this.#Fn=null,this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Gg.#zn.delete(this._canvas),this.callback())))}}const Xg="4.10.38",Yg="f9bea397f";function Kg(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function Jg(e){return Math.max(0,Math.min(255,255*e))}class Qg{static CMYK_G(e){let[t,s,n,i]=e;return["G",1-Math.min(1,.3*t+.59*n+.11*s+i)]}static G_CMYK(e){let[t]=e;return["CMYK",0,0,0,1-t]}static G_RGB(e){let[t]=e;return["RGB",t,t,t]}static G_rgb(e){let[t]=e;return t=Jg(t),[t,t,t]}static G_HTML(e){let[t]=e;const s=Kg(t);return`#${s}${s}${s}`}static RGB_G(e){let[t,s,n]=e;return["G",.3*t+.59*s+.11*n]}static RGB_rgb(e){return e.map(Jg)}static RGB_HTML(e){return`#${e.map(Kg).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(e){let[t,s,n,i]=e;return["RGB",1-Math.min(1,t+i),1-Math.min(1,n+i),1-Math.min(1,s+i)]}static CMYK_rgb(e){let[t,s,n,i]=e;return[Jg(1-Math.min(1,t+i)),Jg(1-Math.min(1,n+i)),Jg(1-Math.min(1,s+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK(e){let[t,s,n]=e;const i=1-t,a=1-s,r=1-n;return["CMYK",i,a,r,Math.min(i,a,r)]}}class Zg{create(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),s||(n.setAttribute("width",`${e}px`),n.setAttribute("height",`${t}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${e} ${t}`),n}createElement(e){if("string"!==typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Yp("Abstract method `_createSVG` called.")}}class eb extends Zg{_createSVG(e){return document.createElementNS(vf,e)}}class tb{static setupStorage(e,t,s,n,i){const a=n.getValue(t,{value:null});switch(s.name){case"textarea":if(null!==a.value&&(e.textContent=a.value),"print"===i)break;e.addEventListener("input",(e=>{n.setValue(t,{value:e.target.value})}));break;case"input":if("radio"===s.attributes.type||"checkbox"===s.attributes.type){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),"print"===i)break;e.addEventListener("change",(e=>{n.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})}))}else{if(null!==a.value&&e.setAttribute("value",a.value),"print"===i)break;e.addEventListener("input",(e=>{n.setValue(t,{value:e.target.value})}))}break;case"select":if(null!==a.value){e.setAttribute("value",a.value);for(const e of s.children)e.attributes.value===a.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",(e=>{const s=e.target.options,i=-1===s.selectedIndex?"":s[s.selectedIndex].value;n.setValue(t,{value:i})}))}}static setAttributes(e){let{html:t,element:s,storage:n=null,intent:i,linkService:a}=e;const{attributes:r}=s,o=t instanceof HTMLAnchorElement;"radio"===r.type&&(r.name=`${r.name}-${i}`);for(const[l,c]of Object.entries(r))if(null!==c&&void 0!==c)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||"href"!==l&&"newWindow"!==l)&&t.setAttribute(l,c)}o&&a.addLinkAttributes(t,r.href,r.newWindow),n&&r.dataId&&this.setupStorage(t,r.dataId,s,n)}static render(e){const t=e.annotationStorage,s=e.linkService,n=e.xfaHtml,i=e.intent||"display",a=document.createElement(n.name);n.attributes&&this.setAttributes({html:a,element:n,intent:i,linkService:s});const r="richText"!==i,o=e.div;if(o.append(a),e.viewport){const t=`matrix(${e.viewport.transform.join(",")})`;o.style.transform=t}r&&o.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===n.children.length){if(n.value){const e=document.createTextNode(n.value);a.append(e),r&&Ng.shouldBuildText(n.name)&&l.push(e)}return{textDivs:l}}const c=[[n,-1,a]];for(;c.length>0;){const[e,n,a]=c.at(-1);if(n+1===e.children.length){c.pop();continue}const o=e.children[++c.at(-1)[1]];if(null===o)continue;const{name:d}=o;if("#text"===d){const e=document.createTextNode(o.value);l.push(e),a.append(e);continue}const h=o?.attributes?.xmlns?document.createElementNS(o.attributes.xmlns,d):document.createElement(d);if(a.append(h),o.attributes&&this.setAttributes({html:h,element:o,storage:t,intent:i,linkService:s}),o.children?.length>0)c.push([o,-1,h]);else if(o.value){const e=document.createTextNode(o.value);r&&Ng.shouldBuildText(d)&&l.push(e),h.append(e)}}for(const d of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:l}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const sb=1e3,nb=new WeakSet;function ib(e){return{width:e[2]-e[0],height:e[3]-e[1]}}class ab{static create(e){switch(e.data.annotationType){case yp:return new ob(e);case vp:return new lb(e);case Dp:switch(e.data.fieldType){case"Tx":return new db(e);case"Btn":return e.data.radioButton?new pb(e):e.data.checkBox?new ub(e):new fb(e);case"Ch":return new mb(e);case"Sig":return new hb(e)}return new cb(e);case Rp:return new gb(e);case xp:return new vb(e);case wp:return new yb(e);case _p:return new xb(e);case Sp:return new wb(e);case kp:return new _b(e);case Pp:return new Ab(e);case Mp:return new kb(e);case Ap:return new Sb(e);case Ep:return new Eb(e);case Cp:return new Cb(e);case jp:return new jb(e);case Np:return new Nb(e);case Tp:return new Tb(e);case Ip:return new Pb(e);default:return new rb(e)}}}class rb{#$n=null;#Bn=!1;#Hn=null;constructor(e){let{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),n&&this._createQuadrilaterals()}static _hasPopupData(e){let{titleObj:t,contentsObj:s,richText:n}=e;return!!(t?.str||s?.str||n?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return rb._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#$n||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#Un(t),this.#Hn?.popup.updateEdited(e)}resetEdited(){this.#$n&&(this.#Un(this.#$n.rect),this.#Hn?.popup.resetEdited(),this.#$n=null)}#Un(e){const{container:{style:t},data:{rect:s,rotation:n},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:r,pageY:o}}}}=this;s?.splice(0,4,...e);const{width:l,height:c}=ib(e);t.left=100*(e[0]-r)/i+"%",t.top=100*(a-e[3]+o)/a+"%",0===n?(t.width=100*l/i+"%",t.height=100*c/a+"%"):this.setRotation(n)}_createContainer(e){const{data:t,parent:{page:s,viewport:n}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof cb||(i.tabIndex=sb);const{style:a}=i;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof gb){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,i),i}const{width:r,height:o}=ib(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const e=t.borderStyle.horizontalCornerRadius,s=t.borderStyle.verticalCornerRadius;if(e>0||s>0){const t=`calc(${e}px * var(--scale-factor)) / calc(${s}px * var(--scale-factor))`;a.borderRadius=t}else if(this instanceof pb){const e=`calc(${r}px * var(--scale-factor)) / calc(${o}px * var(--scale-factor))`;a.borderRadius=e}switch(t.borderStyle.style){case Lp:a.borderStyle="solid";break;case Op:a.borderStyle="dashed";break;case Fp:Xp("Unimplemented border style: beveled");break;case zp:Xp("Unimplemented border style: inset");break;case $p:a.borderBottomStyle="solid"}const n=t.borderColor||null;n?(this.#Bn=!0,a.borderColor=pf.makeHexColor(0|n[0],0|n[1],0|n[2])):a.borderWidth=0}const l=pf.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:c,pageHeight:d,pageX:h,pageY:u}=n.rawDims;a.left=100*(l[0]-h)/c+"%",a.top=100*(l[1]-u)/d+"%";const{rotation:p}=t;return t.hasOwnCanvas||0===p?(a.width=100*r/c+"%",a.height=100*o/d+"%"):this.setRotation(p,i),i}setRotation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:s,pageHeight:n}=this.parent.viewport.rawDims,{width:i,height:a}=ib(this.data.rect);let r,o;e%180===0?(r=100*i/s,o=100*a/n):(r=100*a/s,o=100*i/n),t.style.width=`${r}%`,t.style.height=`${o}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,s)=>{const n=s.detail[e],i=n[0],a=n.slice(1);s.target.style[t]=Qg[`${i}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[t]:Qg[`${i}_rgb`](a)})};return Qp(this,"_commonActions",{display:e=>{const{display:t}=e.detail,s=t%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout((()=>e.target.focus({preventScroll:!1})),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const n of Object.keys(t.detail)){const i=e[n]||s[n];i?.(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[n,i]of Object.entries(t)){const a=s[n];if(a){a({detail:{[n]:i},target:e}),delete t[n]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,n,i]=this.data.rect.map((e=>Math.fround(e)));if(8===e.length){const[a,r,o,l]=e.subarray(2,6);if(n===a&&i===r&&t===o&&s===l)return}const{style:a}=this.container;let r;if(this.#Bn){const{borderColor:e,borderWidth:t}=a;a.borderWidth=0,r=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${e}" stroke-width="${t}">`],this.container.classList.add("hasBorder")}const o=n-t,l=i-s,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const h=c.createElement("defs");d.append(h);const u=c.createElement("clipPath"),p=`clippath_${this.data.id}`;u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),h.append(u);for(let f=2,m=e.length;f<m;f+=8){const s=e[f],n=e[f+1],a=e[f+2],d=e[f+3],h=c.createElement("rect"),p=(a-t)/o,m=(i-n)/l,g=(s-a)/o,b=(n-d)/l;h.setAttribute("x",p),h.setAttribute("y",m),h.setAttribute("width",g),h.setAttribute("height",b),u.append(h),r?.push(`<rect vector-effect="non-scaling-stroke" x="${p}" y="${m}" width="${g}" height="${b}"/>`)}this.#Bn&&(r.push("</g></svg>')"),a.backgroundImage=r.join("")),this.container.append(d),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{data:e}=this,t=this.#Hn=new gb({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){Yp("Abstract method `AnnotationElement.render` called")}_getElementsByName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=[];if(this._fieldObjects){const n=this._fieldObjects[e];if(n)for(const{page:e,id:i,exportValues:a}of n){if(-1===e)continue;if(i===t)continue;const n="string"===typeof a?a:null,r=document.querySelector(`[data-element-id="${i}"]`);!r||nb.has(r)?s.push({id:i,exportValue:n,domElement:r}):Xp(`_getElementsByName - element not allowed: ${i}`)}return s}for(const n of document.getElementsByName(e)){const{exportValue:e}=n,i=n.getAttribute("data-element-id");i!==t&&(nb.has(n)&&s.push({id:i,exportValue:e,domElement:n}))}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",(()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})}))}}class ob extends rb{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let n=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),n=!0):e.action?(this._bindNamedAction(s,e.action),n=!0):e.attachment?(this.#Vn(s,e.attachment,e.attachmentDest),n=!0):e.setOCGState?(this.#Wn(s,e.setOCGState),n=!0):e.dest?(this._bindLink(s,e.dest),n=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),n=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(s,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(s),this.container}#qn(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&this.#qn()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#qn()}#Vn(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#qn()}#Wn(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#qn()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(t.actions)){const i=s.get(n);i&&(e[i]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:n}}),!1))}e.onclick||(e.onclick=()=>!1),this.#qn()}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),this.#qn(),!this._fieldObjects)return Xp('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(s||(e.onclick=()=>!1));e.onclick=()=>{s?.();const{fields:e,refs:n,include:i}=t,a=[];if(0!==e.length||0!==n.length){const t=new Set(n);for(const s of e){const e=this._fieldObjects[s]||[];for(const{id:s}of e)t.add(s)}for(const e of Object.values(this._fieldObjects))for(const s of e)t.has(s.id)===i&&a.push(s)}else for(const t of Object.values(this._fieldObjects))a.push(...t);const r=this.annotationStorage,o=[];for(const t of a){const{id:e}=t;switch(o.push(e),t.type){case"text":{const s=t.defaultValue||"";r.setValue(e,{value:s});break}case"checkbox":case"radiobutton":{const s=t.defaultValue===t.exportValues;r.setValue(e,{value:s});break}case"combobox":case"listbox":{const s=t.defaultValue||"";r.setValue(e,{value:s});break}default:continue}const s=document.querySelector(`[data-element-id="${e}"]`);s&&(nb.has(s)?s.dispatchEvent(new Event("resetform")):Xp(`_bindResetFormAction - element not allowed: ${e}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}),!1}}}class lb extends rb{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class cb extends rb{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&("CANVAS"===e.previousSibling?.nodeName&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return hf.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,n,i){s.includes("mouse")?e.addEventListener(s,(e=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})})):e.addEventListener(s,(e=>{if("blur"===s){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===s){if(t.focused)return;t.focused=!0}i&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:i(e)}})}))}_setEventListeners(e,t,s,n){for(const[i,a]of s)("Action"===a||this.data.actions?.[a])&&("Focus"!==a&&"Blur"!==a||(t||={focused:!1}),this._setEventListener(e,t,i,a,n),"Focus"!==a||this.data.actions?.Blur?"Blur"!==a||this.data.actions?.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":pf.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,n=this.data.defaultAppearanceData.fontSize||9,i=e.style;let a;const r=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(Qu*n))||1);a=Math.min(n,r(t/Qu))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);a=Math.min(n,r(e/Qu))}i.fontSize=`calc(${a}px * var(--scale-factor))`,i.color=pf.makeHexColor(s[0],s[1],s[2]),null!==this.data.textAlignment&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class db extends cb{constructor(e){super(e,{isRenderable:e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,s,n){const i=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),i.setValue(a.id,{[n]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const n=e.getValue(t,{value:this.data.fieldValue});let i=n.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&i.length>a&&(i=i.slice(0,a));let r=n.formattedValue||this.data.textContent?.join("\n")||null;r&&this.data.comb&&(r=r.replaceAll(/\s+/g,""));const o={userValue:i,formattedValue:r,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=r??i,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",r??i),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),nb.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=sb,this._setRequired(s,this.data.required),a&&(s.maxLength=a),s.addEventListener("input",(n=>{e.setValue(t,{value:n.target.value}),this.setPropertyOnSiblings(s,"value",n.target.value,"value"),o.formattedValue=null})),s.addEventListener("resetform",(e=>{const t=this.data.defaultFieldValue??"";s.value=o.userValue=t,o.formattedValue=null}));let l=e=>{const{formattedValue:t}=o;null!==t&&void 0!==t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",(e=>{if(o.focused)return;const{target:t}=e;o.userValue&&(t.value=o.userValue),o.lastCommittedValue=t.value,o.commitKey=1,this.data.actions?.Focus||(o.focused=!0)})),s.addEventListener("updatefromsandbox",(s=>{this.showElementAndHideCanvas(s.target);const n={value(s){o.userValue=s.detail.value??"",e.setValue(t,{value:o.userValue.toString()}),s.target.value=o.userValue},formattedValue(s){const{formattedValue:n}=s.detail;o.formattedValue=n,null!==n&&void 0!==n&&s.target!==document.activeElement&&(s.target.value=n),e.setValue(t,{formattedValue:n})},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:s=>{const{charLimit:n}=s.detail,{target:i}=s;if(0===n)return void i.removeAttribute("maxLength");i.setAttribute("maxLength",n);let a=o.userValue;!a||a.length<=n||(a=a.slice(0,n),i.value=o.userValue=a,e.setValue(t,{value:a}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,willCommit:!0,commitKey:1,selStart:i.selectionStart,selEnd:i.selectionEnd}}))}};this._dispatchEventFromSandbox(n,s)})),s.addEventListener("keydown",(e=>{o.commitKey=1;let s=-1;if("Escape"===e.key?s=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(o.commitKey=3):s=2,-1===s)return;const{value:n}=e.target;o.lastCommittedValue!==n&&(o.lastCommittedValue=n,o.userValue=n,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:n,willCommit:!0,commitKey:s,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))}));const n=l;l=null,s.addEventListener("blur",(e=>{if(!o.focused||!e.relatedTarget)return;this.data.actions?.Blur||(o.focused=!1);const{value:s}=e.target;o.userValue=s,o.lastCommittedValue!==s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,willCommit:!0,commitKey:o.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}),n(e)})),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",(e=>{o.lastCommittedValue=null;const{data:s,target:n}=e,{value:i,selectionStart:a,selectionEnd:r}=n;let l=a,c=r;switch(e.inputType){case"deleteWordBackward":{const e=i.substring(0,a).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=i.substring(a).match(/^[^\w]*\w*/);e&&(c+=e[0].length);break}case"deleteContentBackward":a===r&&(l-=1);break;case"deleteContentForward":a===r&&(c+=1)}e.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:i,change:s||"",willCommit:!1,selStart:l,selEnd:c}})})),this._setEventListeners(s,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.value))}if(l&&s.addEventListener("blur",l),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/a;s.classList.add("comb"),s.style.letterSpacing=`calc(${e}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class hb extends cb{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class ub extends cb{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;"string"===typeof n&&(n="Off"!==n,e.setValue(s,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return nb.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=sb,i.addEventListener("change",(n=>{const{name:i,checked:a}=n.target;for(const r of this._getElementsByName(i,s)){const s=a&&r.exportValue===t.exportValue;r.domElement&&(r.domElement.checked=s),e.setValue(r.id,{value:s})}e.setValue(s,{value:a})})),i.addEventListener("resetform",(e=>{const s=t.defaultFieldValue||"Off";e.target.checked=s===t.exportValue})),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",(t=>{const n={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(s,{value:t.target.checked})}};this._dispatchEventFromSandbox(n,t)})),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.checked))),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class pb extends cb{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let n=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if("string"===typeof n&&(n=n!==t.buttonValue,e.setValue(s,{value:n})),n)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const i=document.createElement("input");if(nb.add(i),i.setAttribute("data-element-id",s),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.tabIndex=sb,i.addEventListener("change",(t=>{const{name:n,checked:i}=t.target;for(const a of this._getElementsByName(n,s))e.setValue(a.id,{value:!1});e.setValue(s,{value:i})})),i.addEventListener("resetform",(e=>{const s=t.defaultFieldValue;e.target.checked=null!==s&&void 0!==s&&s===t.buttonValue})),this.enableScripting&&this.hasJSActions){const n=t.buttonValue;i.addEventListener("updatefromsandbox",(t=>{const i={value:t=>{const i=n===t.detail.value;for(const n of this._getElementsByName(t.target.name)){const t=i&&n.id===s;n.domElement&&(n.domElement.checked=t),e.setValue(n.id,{value:t})}}};this._dispatchEventFromSandbox(i,t)})),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.checked))}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class fb extends ob{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",(e=>{this._dispatchEventFromSandbox({},e)}))),e}}class mb extends cb{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),n=document.createElement("select");nb.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=sb;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",(e=>{const t=this.data.defaultFieldValue;for(const s of n.options)s.selected=s.value===t}));for(const c of this.data.options){const e=document.createElement("option");e.textContent=c.displayValue,e.value=c.exportValue,s.value.includes(c.exportValue)&&(e.setAttribute("selected",!0),i=!1),n.append(e)}let a=null;if(i){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),n.prepend(e),a=()=>{e.remove(),n.removeEventListener("input",a),a=null},n.addEventListener("input",a)}const r=e=>{const t=e?"value":"textContent",{options:s,multiple:i}=n;return i?Array.prototype.filter.call(s,(e=>e.selected)).map((e=>e[t])):-1===s.selectedIndex?null:s[s.selectedIndex][t]};let o=r(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,(e=>({displayValue:e.textContent,exportValue:e.value})))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",(s=>{const i={value(s){a?.();const i=s.detail.value,l=new Set(Array.isArray(i)?i:[i]);for(const e of n.options)e.selected=l.has(e.value);e.setValue(t,{value:r(!0)}),o=r(!1)},multipleSelection(e){n.multiple=!0},remove(s){const i=n.options,a=s.detail.remove;if(i[a].selected=!1,n.remove(a),i.length>0){-1===Array.prototype.findIndex.call(i,(e=>e.selected))&&(i[0].selected=!0)}e.setValue(t,{value:r(!0),items:l(s)}),o=r(!1)},clear(s){for(;0!==n.length;)n.remove(0);e.setValue(t,{value:null,items:[]}),o=r(!1)},insert(s){const{index:i,displayValue:a,exportValue:c}=s.detail.insert,d=n.children[i],h=document.createElement("option");h.textContent=a,h.value=c,d?d.before(h):n.append(h),e.setValue(t,{value:r(!0),items:l(s)}),o=r(!1)},items(s){const{items:i}=s.detail;for(;0!==n.length;)n.remove(0);for(const e of i){const{displayValue:t,exportValue:s}=e,i=document.createElement("option");i.textContent=t,i.value=s,n.append(i)}n.options.length>0&&(n.options[0].selected=!0),e.setValue(t,{value:r(!0),items:l(s)}),o=r(!1)},indices(s){const n=new Set(s.detail.indices);for(const e of s.target.options)e.selected=n.has(e.index);e.setValue(t,{value:r(!0)}),o=r(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(i,s)})),n.addEventListener("input",(s=>{const n=r(!0),i=r(!1);e.setValue(t,{value:n}),s.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,change:i,changeEx:n,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(e=>e.target.value))):n.addEventListener("input",(function(s){e.setValue(t,{value:r(!0)})})),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class gb extends rb{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:rb._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new bb({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map((e=>`${bf}${e}`)).join(",")),this.container}}class bb{#Gn=this.#Xn.bind(this);#Yn=this.#Kn.bind(this);#Jn=this.#Qn.bind(this);#Zn=this.#ei.bind(this);#ti=null;#pe=null;#si=null;#ni=null;#ii=null;#ai=null;#ri=null;#oi=!1;#li=null;#E=null;#ci=null;#di=null;#hi=null;#$n=null;#ui=!1;constructor(e){let{container:t,color:s,elements:n,titleObj:i,modificationDate:a,contentsObj:r,richText:o,parent:l,rect:c,parentRect:d,open:h}=e;this.#pe=t,this.#hi=i,this.#si=r,this.#di=o,this.#ai=l,this.#ti=s,this.#ci=c,this.#ri=d,this.#ii=n,this.#ni=Pf.toDateObject(a),this.trigger=n.flatMap((e=>e.getElementsToTriggerPopup()));for(const u of this.trigger)u.addEventListener("click",this.#Zn),u.addEventListener("mouseenter",this.#Jn),u.addEventListener("mouseleave",this.#Yn),u.classList.add("popupTriggerArea");for(const u of n)u.container?.addEventListener("keydown",this.#Gn);this.#pe.hidden=!0,h&&this.#ei()}render(){if(this.#li)return;const e=this.#li=document.createElement("div");if(e.className="popup",this.#ti){const t=e.style.outlineColor=pf.makeHexColor(...this.#ti);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))e.style.backgroundColor=`color-mix(in srgb, ${t} 30%, white)`;else{const t=.7;e.style.backgroundColor=pf.makeHexColor(...this.#ti.map((e=>Math.floor(t*(255-e)+e))))}}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),({dir:s.dir,str:s.textContent}=this.#hi),e.append(t),this.#ni){const e=document.createElement("span");e.classList.add("popupDate"),e.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),e.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#ni.valueOf()})),t.append(e)}const n=this.#pi;if(n)tb.render({xfaHtml:n,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const t=this._formatContents(this.#si);e.append(t)}this.#pe.append(e)}get#pi(){const e=this.#di,t=this.#si;return!e?.str||t?.str&&t.str!==e.str?null:this.#di.html||null}get#fi(){return this.#pi?.attributes?.style?.fontSize||0}get#mi(){return this.#pi?.attributes?.style?.color||null}#gi(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},n={style:{color:this.#mi,fontSize:this.#fi?`calc(${this.#fi}px * var(--scale-factor))`:""}};for(const i of e.split("\n"))t.push({name:"span",value:i,attributes:n});return s}_formatContents(e){let{str:t,dir:s}=e;const n=document.createElement("p");n.classList.add("popupContent"),n.dir=s;const i=t.split(/(?:\r\n?|\n)/);for(let a=0,r=i.length;a<r;++a){const e=i[a];n.append(document.createTextNode(e)),a<r-1&&n.append(document.createElement("br"))}return n}#Xn(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&this.#oi)&&this.#ei()}updateEdited(e){let{rect:t,popupContent:s}=e;this.#$n||={contentsObj:this.#si,richText:this.#di},t&&(this.#E=null),s&&(this.#di=this.#gi(s),this.#si=null),this.#li?.remove(),this.#li=null}resetEdited(){this.#$n&&(({contentsObj:this.#si,richText:this.#di}=this.#$n),this.#$n=null,this.#li?.remove(),this.#li=null,this.#E=null)}#bi(){if(null!==this.#E)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:n,pageY:i}}}=this.#ai;let a=!!this.#ri,r=a?this.#ri:this.#ci;for(const u of this.#ii)if(!r||null!==pf.intersect(u.data.rect,r)){r=u.data.rect,a=!0;break}const o=pf.normalizeRect([r[0],e[3]-r[1]+e[1],r[2],e[3]-r[3]+e[1]]),l=a?r[2]-r[0]+5:0,c=o[0]+l,d=o[1];this.#E=[100*(c-n)/t,100*(d-i)/s];const{style:h}=this.#pe;h.left=`${this.#E[0]}%`,h.top=`${this.#E[1]}%`}#ei(){this.#oi=!this.#oi,this.#oi?(this.#Qn(),this.#pe.addEventListener("click",this.#Zn),this.#pe.addEventListener("keydown",this.#Gn)):(this.#Kn(),this.#pe.removeEventListener("click",this.#Zn),this.#pe.removeEventListener("keydown",this.#Gn))}#Qn(){this.#li||this.render(),this.isVisible?this.#oi&&this.#pe.classList.add("focused"):(this.#bi(),this.#pe.hidden=!1,this.#pe.style.zIndex=parseInt(this.#pe.style.zIndex)+1e3)}#Kn(){this.#pe.classList.remove("focused"),!this.#oi&&this.isVisible&&(this.#pe.hidden=!0,this.#pe.style.zIndex=parseInt(this.#pe.style.zIndex)-1e3)}forceHide(){this.#ui=this.isVisible,this.#ui&&(this.#pe.hidden=!0)}maybeShow(){this.#ui&&(this.#li||this.#Qn(),this.#ui=!1,this.#pe.hidden=!1)}get isVisible(){return!1===this.#pe.hidden}}class vb extends rb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=lp.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class yb extends rb{#vi=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:s}=ib(e.rect),n=this.svgFactory.create(t,s,!0),i=this.#vi=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),n.append(i),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#vi}addHighlightArea(){this.container.classList.add("highlightArea")}}class xb extends rb{#yi=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:s}=ib(e.rect),n=this.svgFactory.create(t,s,!0),i=e.borderStyle.width,a=this.#yi=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",i/2),a.setAttribute("y",i/2),a.setAttribute("width",t-i),a.setAttribute("height",s-i),a.setAttribute("stroke-width",i||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#yi}addHighlightArea(){this.container.classList.add("highlightArea")}}class wb extends rb{#xi=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:s}=ib(e.rect),n=this.svgFactory.create(t,s,!0),i=e.borderStyle.width,a=this.#xi=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",t/2),a.setAttribute("cy",s/2),a.setAttribute("rx",t/2-i/2),a.setAttribute("ry",s/2-i/2),a.setAttribute("stroke-width",i||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),n.append(a),this.container.append(n),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#xi}addHighlightArea(){this.container.classList.add("highlightArea")}}class _b extends rb{#wi=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:s,popupRef:n}}=this;if(!t)return this.container;const{width:i,height:a}=ib(e),r=this.svgFactory.create(i,a,!0);let o=[];for(let c=0,d=t.length;c<d;c+=2){const s=t[c]-e[0],n=e[3]-t[c+1];o.push(`${s},${n}`)}o=o.join(" ");const l=this.#wi=this.svgFactory.createElement(this.svgElementName);return l.setAttribute("points",o),l.setAttribute("stroke-width",s.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#wi}addHighlightArea(){this.container.classList.add("highlightArea")}}class Sb extends _b{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Ab extends rb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class kb extends rb{#_i=null;#Si=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?lp.HIGHLIGHT:lp.INK}#Ai(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:s,borderStyle:n,popupRef:i}}=this,{transform:a,width:r,height:o}=this.#Ai(t,e),l=this.svgFactory.create(r,o,!0),c=this.#_i=this.svgFactory.createElement("svg:g");l.append(c),c.setAttribute("stroke-width",n.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",a);for(let d=0,h=s.length;d<h;d++){const e=this.svgFactory.createElement(this.svgElementName);this.#Si.push(e),e.setAttribute("points",s[d].join(",")),c.append(e)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:s,rect:n}=e,i=this.#_i;if(t>=0&&i.setAttribute("stroke-width",t||1),s)for(let a=0,r=this.#Si.length;a<r;a++)this.#Si[a].setAttribute("points",s[a].join(","));if(n){const{transform:e,width:t,height:s}=this.#Ai(this.data.rotation,n);i.parentElement.setAttribute("viewBox",`0 0 ${t} ${s}`),i.setAttribute("transform",e)}}getElementsToTriggerPopup(){return this.#Si}addHighlightArea(){this.container.classList.add("highlightArea")}}class Eb extends rb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=lp.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Cb extends rb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class jb extends rb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Nb extends rb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Tb extends rb{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=lp.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Pb extends rb{#ki=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let s;t.hasAppearance||0===t.fillAlpha?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(100*t.fillAlpha)}%);`)),s.addEventListener("dblclick",this.#Ei.bind(this)),this.#ki=s;const{isMac:n}=hf.platform;return e.addEventListener("keydown",(e=>{"Enter"===e.key&&(n?e.metaKey:e.ctrlKey)&&this.#Ei()})),!t.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return this.#ki}addHighlightArea(){this.container.classList.add("highlightArea")}#Ei(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Mb{#Ci=null;#ji=null;#Ni=(()=>new Map)();#Ti=null;constructor(e){let{div:t,accessibilityManager:s,annotationCanvasMap:n,annotationEditorUIManager:i,page:a,viewport:r,structTreeLayer:o}=e;this.div=t,this.#Ci=s,this.#ji=n,this.#Ti=o||null,this.page=a,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return this.#Ni.size>0}async#Pi(e,t){const s=e.firstChild||e,n=s.id=`${bf}${t}`,i=await(this.#Ti?.getAriaAttributes(n));if(i)for(const[a,r]of i)s.setAttribute(a,r);this.div.append(e),this.#Ci?.moveElementInDOM(this.div,e,s,!1)}async render(e){const{annotations:t}=e,s=this.div;Lf(s,this.viewport);const n=new Map,i={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new eb,annotationStorage:e.annotationStorage||new sm,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const e=a.annotationType===Rp;if(e){const e=n.get(a.id);if(!e)continue;i.elements=e}else{const{width:e,height:t}=ib(a.rect);if(e<=0||t<=0)continue}i.data=a;const t=ab.create(i);if(!t.isRenderable)continue;if(!e&&a.popupRef){const e=n.get(a.popupRef);e?e.push(t):n.set(a.popupRef,[t])}const s=t.render();a.hidden&&(s.style.visibility="hidden"),await this.#Pi(s,a.id),t._isEditable&&(this.#Ni.set(t.data.id,t),this._annotationEditorUIManager?.renderAnnotationElement(t))}this.#Mi()}update(e){let{viewport:t}=e;const s=this.div;this.viewport=t,Lf(s,{rotation:t.rotation}),this.#Mi(),s.hidden=!1}#Mi(){if(!this.#ji)return;const e=this.div;for(const[t,s]of this.#ji){const n=e.querySelector(`[data-annotation-id="${t}"]`);if(!n)continue;s.className="annotationContent";const{firstChild:i}=n;i?"CANVAS"===i.nodeName?i.replaceWith(s):i.classList.contains("annotationContent")?i.after(s):i.before(s):n.append(s)}this.#ji.clear()}getEditableAnnotations(){return Array.from(this.#Ni.values())}getEditableAnnotation(e){return this.#Ni.get(e)}}const Rb=/\r\n?|\n/g;class Ib extends Yf{#ti;#Ri="";#Ii=`${this.id}-editor`;#Di=null;#fi;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=Ib.prototype,t=e=>e.isEmpty(),s=qf.TRANSLATE_SMALL,n=qf.TRANSLATE_BIG;return Qp(this,"_keyboardManager",new Vf([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}]]))}static _type="freetext";static _editorType=(()=>lp.FREETEXT)();constructor(e){super({...e,name:"freeTextEditor"}),this.#ti=e.color||Ib._defaultColor||Yf._defaultLineColor,this.#fi=e.fontSize||Ib._defaultFontSize}static initialize(e,t){Yf.initialize(e,t);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case cp.FREETEXT_SIZE:Ib._defaultFontSize=t;break;case cp.FREETEXT_COLOR:Ib._defaultColor=t}}updateParams(e,t){switch(e){case cp.FREETEXT_SIZE:this.#Li(t);break;case cp.FREETEXT_COLOR:this.#Oi(t)}}static get defaultPropertiesToUpdate(){return[[cp.FREETEXT_SIZE,Ib._defaultFontSize],[cp.FREETEXT_COLOR,Ib._defaultColor||Yf._defaultLineColor]]}get propertiesToUpdate(){return[[cp.FREETEXT_SIZE,this.#fi],[cp.FREETEXT_COLOR,this.#ti]]}#Li(e){const t=e=>{this.editorDiv.style.fontSize=`calc(${e}px * var(--scale-factor))`,this.translate(0,-(e-this.#fi)*this.parentScale),this.#fi=e,this.#Fi()},s=this.#fi;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:cp.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#Oi(e){const t=e=>{this.#ti=this.editorDiv.style.color=e},s=this.#ti;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:cp.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-Ib._internalPadding*e,-(Ib._internalPadding+this.#fi)*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(lp.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#Di=new AbortController;const e=this._uiManager.combinedSignal(this.#Di);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#Ii),this._isDraggable=!0,this.#Di?.abort(),this.#Di=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#zi(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&"BR"===s.nodeName||(e.push(Ib.#$i(s)),t=s);return e.join("\n")}#Fi(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,n=t.style.display,i=t.classList.contains("hidden");t.classList.remove("hidden"),t.style.display="hidden",e.div.append(this.div),s=t.getBoundingClientRect(),t.remove(),t.style.display=n,t.classList.toggle("hidden",i)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#Ri,t=this.#Ri=this.#zi().trimEnd();if(e===t)return;const s=e=>{this.#Ri=e,e?(this.#Bi(),this._uiManager.rebuild(this),this.#Fi()):this.remove()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(e)},mustExec:!1}),this.#Fi()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Ib._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#Ii),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#fi}px * var(--scale-factor))`,s.color=this.#ti,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),$f(this,this.div,["dblclick","keydown"]),this.width){const[s,n]=this.parentDimensions;if(this.annotationElementId){const{position:i}=this._initialData;let[a,r]=this.getInitialTranslation();[a,r]=this.pageTranslationToScreen(a,r);const[o,l]=this.pageDimensions,[c,d]=this.pageTranslation;let h,u;switch(this.rotation){case 0:h=e+(i[0]-c)/o,u=t+this.height-(i[1]-d)/l;break;case 90:h=e+(i[0]-c)/o,u=t-(i[1]-d)/l,[a,r]=[r,-a];break;case 180:h=e-this.width+(i[0]-c)/o,u=t-(i[1]-d)/l,[a,r]=[-a,-r];break;case 270:h=e+(i[0]-c-this.height*l)/o,u=t+(i[1]-d-this.width*o)/l,[a,r]=[-r,a]}this.setAt(h*s,u*n,a,r)}else this.setAt(e*s,t*n,this.width*s,this.height*n);this.#Bi(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#$i(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Rb,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:s}=t;if(1===s.length&&"text/plain"===s[0])return;e.preventDefault();const n=Ib.#Hi(t.getData("text")||"").replaceAll(Rb,"\n");if(!n)return;const i=window.getSelection();if(!i.rangeCount)return;this.editorDiv.normalize(),i.deleteFromDocument();const a=i.getRangeAt(0);if(!n.includes("\n"))return a.insertNode(document.createTextNode(n)),this.editorDiv.normalize(),void i.collapseToStart();const{startContainer:r,startOffset:o}=a,l=[],c=[];if(r.nodeType===Node.TEXT_NODE){const e=r.parentElement;if(c.push(r.nodeValue.slice(o).replaceAll(Rb,"")),e!==this.editorDiv){let t=l;for(const s of this.editorDiv.childNodes)s!==e?t.push(Ib.#$i(s)):t=c}l.push(r.nodeValue.slice(0,o).replaceAll(Rb,""))}else if(r===this.editorDiv){let e=l,t=0;for(const s of this.editorDiv.childNodes)t++===o&&(e=c),e.push(Ib.#$i(s))}this.#Ri=`${l.join("\n")}${n}${c.join("\n")}`,this.#Bi();const d=new Range;let h=l.reduce(((e,t)=>e+t.length),0);for(const{firstChild:u}of this.editorDiv.childNodes)if(u.nodeType===Node.TEXT_NODE){const e=u.nodeValue.length;if(h<=e){d.setStart(u,h),d.setEnd(u,h);break}h-=e}i.removeAllRanges(),i.addRange(d)}#Bi(){if(this.editorDiv.replaceChildren(),this.#Ri)for(const e of this.#Ri.split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#Ui(){return this.#Ri.replaceAll("\xa0"," ")}static#Hi(e){return e.replaceAll(" ","\xa0")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,s){let n=null;if(e instanceof vb){const{data:{defaultAppearanceData:{fontSize:t,fontColor:s},rect:i,rotation:a,id:r,popupRef:o},textContent:l,textPosition:c,parent:{page:{pageNumber:d}}}=e;if(!l||0===l.length)return null;n=e={annotationType:lp.FREETEXT,color:Array.from(s),fontSize:t,value:l.join("\n"),position:c,pageIndex:d-1,rect:i.slice(0),rotation:a,id:r,deleted:!1,popupRef:o}}const i=await super.deserialize(e,t,s);return i.#fi=e.fontSize,i.#ti=pf.makeHexColor(...e.color),i.#Ri=Ib.#Hi(e.value),i.annotationElementId=e.id||null,i._initialData=n,i}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=Ib._internalPadding*this.parentScale,s=this.getRect(t,t),n=Yf._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#ti),i={annotationType:lp.FREETEXT,color:n,fontSize:this.#fi,value:this.#Ui(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?i:this.annotationElementId&&!this.#Vi(i)?null:(i.id=this.annotationElementId,i)}#Vi(e){const{value:t,fontSize:s,color:n,pageIndex:i}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some(((e,t)=>e!==n[t]))||e.pageIndex!==i}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:s}=t;s.fontSize=`calc(${this.#fi}px * var(--scale-factor))`,s.color=this.#ti,t.replaceChildren();for(const i of this.#Ri.split("\n")){const e=document.createElement("div");e.append(i?document.createTextNode(i):document.createElement("br")),t.append(e)}const n=Ib._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(n,n),popupContent:this.#Ri}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class Db{static PRECISION=1e-4;toSVGPath(){Yp("Abstract method `toSVGPath` must be implemented.")}get box(){Yp("Abstract getter `box` must be implemented.")}serialize(e,t){Yp("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,n,i,a){a||=new Float32Array(e.length);for(let r=0,o=e.length;r<o;r+=2)a[r]=t+e[r]*n,a[r+1]=s+e[r+1]*i;return a}static _rescaleAndSwap(e,t,s,n,i,a){a||=new Float32Array(e.length);for(let r=0,o=e.length;r<o;r+=2)a[r]=t+e[r+1]*n,a[r+1]=s+e[r]*i;return a}static _translate(e,t,s,n){n||=new Float32Array(e.length);for(let i=0,a=e.length;i<a;i+=2)n[i]=t+e[i],n[i+1]=s+e[i+1];return n}static svgRound(e){return Math.round(1e4*e)}static _normalizePoint(e,t,s,n,i){switch(i){case 90:return[1-t/s,e/n];case 180:return[1-e/s,1-t/n];case 270:return[t/s,1-e/n];default:return[e/s,t/n]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,n,i,a){return[(e+5*s)/6,(t+5*n)/6,(5*s+i)/6,(5*n+a)/6,(s+i)/2,(n+a)/2]}}class Lb{#Wi;#qi=[];#Gi;#Xi;#Yi=[];#Ki=(()=>new Float32Array(18))();#Ji;#Qi;#Zi;#ea;#ta;#sa;#na=[];static#ia=8;static#aa=2;static#ra=(()=>Lb.#ia+Lb.#aa)();constructor(e,t,s,n,i){let{x:a,y:r}=e,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.#Wi=t,this.#sa=n*s,this.#Xi=i,this.#Ki.set([NaN,NaN,NaN,NaN,a,r],6),this.#Gi=o,this.#ea=Lb.#ia*s,this.#Zi=Lb.#ra*s,this.#ta=s,this.#na.push(a,r)}isEmpty(){return isNaN(this.#Ki[8])}#oa(){const e=this.#Ki.subarray(4,6),t=this.#Ki.subarray(16,18),[s,n,i,a]=this.#Wi;return[(this.#Ji+(e[0]-t[0])/2-s)/i,(this.#Qi+(e[1]-t[1])/2-n)/a,(this.#Ji+(t[0]-e[0])/2-s)/i,(this.#Qi+(t[1]-e[1])/2-n)/a]}add(e){let{x:t,y:s}=e;this.#Ji=t,this.#Qi=s;const[n,i,a,r]=this.#Wi;let[o,l,c,d]=this.#Ki.subarray(8,12);const h=t-c,u=s-d,p=Math.hypot(h,u);if(p<this.#Zi)return!1;const f=p-this.#ea,m=f/p,g=m*h,b=m*u;let v=o,y=l;o=c,l=d,c+=g,d+=b,this.#na?.push(t,s);const x=g/f,w=-b/f*this.#sa,_=x*this.#sa;if(this.#Ki.set(this.#Ki.subarray(2,8),0),this.#Ki.set([c+w,d+_],4),this.#Ki.set(this.#Ki.subarray(14,18),12),this.#Ki.set([c-w,d-_],16),isNaN(this.#Ki[6]))return 0===this.#Yi.length&&(this.#Ki.set([o+w,l+_],2),this.#Yi.push(NaN,NaN,NaN,NaN,(o+w-n)/a,(l+_-i)/r),this.#Ki.set([o-w,l-_],14),this.#qi.push(NaN,NaN,NaN,NaN,(o-w-n)/a,(l-_-i)/r)),this.#Ki.set([v,y,o,l,c,d],6),!this.isEmpty();this.#Ki.set([v,y,o,l,c,d],6);return Math.abs(Math.atan2(y-l,v-o)-Math.atan2(b,g))<Math.PI/2?([o,l,c,d]=this.#Ki.subarray(2,6),this.#Yi.push(NaN,NaN,NaN,NaN,((o+c)/2-n)/a,((l+d)/2-i)/r),[o,l,v,y]=this.#Ki.subarray(14,18),this.#qi.push(NaN,NaN,NaN,NaN,((v+o)/2-n)/a,((y+l)/2-i)/r),!0):([v,y,o,l,c,d]=this.#Ki.subarray(0,6),this.#Yi.push(((v+5*o)/6-n)/a,((y+5*l)/6-i)/r,((5*o+c)/6-n)/a,((5*l+d)/6-i)/r,((o+c)/2-n)/a,((l+d)/2-i)/r),[c,d,o,l,v,y]=this.#Ki.subarray(12,18),this.#qi.push(((v+5*o)/6-n)/a,((y+5*l)/6-i)/r,((5*o+c)/6-n)/a,((5*l+d)/6-i)/r,((o+c)/2-n)/a,((l+d)/2-i)/r),!0)}toSVGPath(){if(this.isEmpty())return"";const e=this.#Yi,t=this.#qi;if(isNaN(this.#Ki[6])&&!this.isEmpty())return this.#la();const s=[];s.push(`M${e[4]} ${e[5]}`);for(let n=6;n<e.length;n+=6)isNaN(e[n])?s.push(`L${e[n+4]} ${e[n+5]}`):s.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);this.#ca(s);for(let n=t.length-6;n>=6;n-=6)isNaN(t[n])?s.push(`L${t[n+4]} ${t[n+5]}`):s.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);return this.#da(s),s.join(" ")}#la(){const[e,t,s,n]=this.#Wi,[i,a,r,o]=this.#oa();return`M${(this.#Ki[2]-e)/s} ${(this.#Ki[3]-t)/n} L${(this.#Ki[4]-e)/s} ${(this.#Ki[5]-t)/n} L${i} ${a} L${r} ${o} L${(this.#Ki[16]-e)/s} ${(this.#Ki[17]-t)/n} L${(this.#Ki[14]-e)/s} ${(this.#Ki[15]-t)/n} Z`}#da(e){const t=this.#qi;e.push(`L${t[4]} ${t[5]} Z`)}#ca(e){const[t,s,n,i]=this.#Wi,a=this.#Ki.subarray(4,6),r=this.#Ki.subarray(16,18),[o,l,c,d]=this.#oa();e.push(`L${(a[0]-t)/n} ${(a[1]-s)/i} L${o} ${l} L${c} ${d} L${(r[0]-t)/n} ${(r[1]-s)/i}`)}newFreeDrawOutline(e,t,s,n,i,a){return new Ob(e,t,s,n,i,a)}getOutlines(){const e=this.#Yi,t=this.#qi,s=this.#Ki,[n,i,a,r]=this.#Wi,o=new Float32Array((this.#na?.length??0)+2);for(let d=0,h=o.length-2;d<h;d+=2)o[d]=(this.#na[d]-n)/a,o[d+1]=(this.#na[d+1]-i)/r;if(o[o.length-2]=(this.#Ji-n)/a,o[o.length-1]=(this.#Qi-i)/r,isNaN(s[6])&&!this.isEmpty())return this.#ha(o);const l=new Float32Array(this.#Yi.length+24+this.#qi.length);let c=e.length;for(let d=0;d<c;d+=2)isNaN(e[d])?l[d]=l[d+1]=NaN:(l[d]=e[d],l[d+1]=e[d+1]);c=this.#ua(l,c);for(let d=t.length-6;d>=6;d-=6)for(let e=0;e<6;e+=2)isNaN(t[d+e])?(l[c]=l[c+1]=NaN,c+=2):(l[c]=t[d+e],l[c+1]=t[d+e+1],c+=2);return this.#pa(l,c),this.newFreeDrawOutline(l,o,this.#Wi,this.#ta,this.#Gi,this.#Xi)}#ha(e){const t=this.#Ki,[s,n,i,a]=this.#Wi,[r,o,l,c]=this.#oa(),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-n)/a,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-n)/a,NaN,NaN,NaN,NaN,r,o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-n)/a,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-n)/a],0),this.newFreeDrawOutline(d,e,this.#Wi,this.#ta,this.#Gi,this.#Xi)}#pa(e,t){const s=this.#qi;return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+6}#ua(e,t){const s=this.#Ki.subarray(4,6),n=this.#Ki.subarray(16,18),[i,a,r,o]=this.#Wi,[l,c,d,h]=this.#oa();return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/r,(s[1]-a)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(n[0]-i)/r,(n[1]-a)/o],t),t+24}}class Ob extends Db{#Wi;#fa=(()=>new Float32Array(4))();#Gi;#Xi;#na;#ta;#ma;constructor(e,t,s,n,i,a){super(),this.#ma=e,this.#na=t,this.#Wi=s,this.#ta=n,this.#Gi=i,this.#Xi=a,this.lastPoint=[NaN,NaN],this.#ga(a);const[r,o,l,c]=this.#fa;for(let d=0,h=e.length;d<h;d+=2)e[d]=(e[d]-r)/l,e[d+1]=(e[d+1]-o)/c;for(let d=0,h=t.length;d<h;d+=2)t[d]=(t[d]-r)/l,t[d+1]=(t[d+1]-o)/c}toSVGPath(){const e=[`M${this.#ma[4]} ${this.#ma[5]}`];for(let t=6,s=this.#ma.length;t<s;t+=6)isNaN(this.#ma[t])?e.push(`L${this.#ma[t+4]} ${this.#ma[t+5]}`):e.push(`C${this.#ma[t]} ${this.#ma[t+1]} ${this.#ma[t+2]} ${this.#ma[t+3]} ${this.#ma[t+4]} ${this.#ma[t+5]}`);return e.push("Z"),e.join(" ")}serialize(e,t){let[s,n,i,a]=e;const r=i-s,o=a-n;let l,c;switch(t){case 0:l=Db._rescale(this.#ma,s,a,r,-o),c=Db._rescale(this.#na,s,a,r,-o);break;case 90:l=Db._rescaleAndSwap(this.#ma,s,n,r,o),c=Db._rescaleAndSwap(this.#na,s,n,r,o);break;case 180:l=Db._rescale(this.#ma,i,n,-r,o),c=Db._rescale(this.#na,i,n,-r,o);break;case 270:l=Db._rescaleAndSwap(this.#ma,i,a,-r,-o),c=Db._rescaleAndSwap(this.#na,i,a,-r,-o)}return{outline:Array.from(l),points:[Array.from(c)]}}#ga(e){const t=this.#ma;let s=t[4],n=t[5],i=s,a=n,r=s,o=n,l=s,c=n;const d=e?Math.max:Math.min;for(let u=6,p=t.length;u<p;u+=6){if(isNaN(t[u]))i=Math.min(i,t[u+4]),a=Math.min(a,t[u+5]),r=Math.max(r,t[u+4]),o=Math.max(o,t[u+5]),c<t[u+5]?(l=t[u+4],c=t[u+5]):c===t[u+5]&&(l=d(l,t[u+4]));else{const e=pf.bezierBoundingBox(s,n,...t.slice(u,u+6));i=Math.min(i,e[0]),a=Math.min(a,e[1]),r=Math.max(r,e[2]),o=Math.max(o,e[3]),c<e[3]?(l=e[2],c=e[3]):c===e[3]&&(l=d(l,e[2]))}s=t[u+4],n=t[u+5]}const h=this.#fa;h[0]=i-this.#Gi,h[1]=a-this.#Gi,h[2]=r-i+2*this.#Gi,h[3]=o-a+2*this.#Gi,this.lastPoint=[l,c]}get box(){return this.#fa}newOutliner(e,t,s,n,i){return new Lb(e,t,s,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}getNewOutline(e,t){const[s,n,i,a]=this.#fa,[r,o,l,c]=this.#Wi,d=i*l,h=a*c,u=s*l+r,p=n*c+o,f=this.newOutliner({x:this.#na[0]*d+u,y:this.#na[1]*h+p},this.#Wi,this.#ta,e,this.#Xi,t??this.#Gi);for(let m=2;m<this.#na.length;m+=2)f.add({x:this.#na[m]*d+u,y:this.#na[m+1]*h+p});return f.getOutlines()}}class Fb{#Wi;#ba;#va=[];#ya=[];constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=1/0,a=-1/0,r=1/0,o=-1/0;const l=10**-4;for(const{x:m,y:g,width:b,height:v}of e){const e=Math.floor((m-t)/l)*l,s=Math.ceil((m+b+t)/l)*l,n=Math.floor((g-t)/l)*l,c=Math.ceil((g+v+t)/l)*l,d=[e,n,c,!0],h=[s,n,c,!1];this.#va.push(d,h),i=Math.min(i,e),a=Math.max(a,s),r=Math.min(r,n),o=Math.max(o,c)}const c=a-i+2*s,d=o-r+2*s,h=i-s,u=r-s,p=this.#va.at(n?-1:-2),f=[p[0],p[2]];for(const m of this.#va){const[e,t,s]=m;m[0]=(e-h)/c,m[1]=(t-u)/d,m[2]=(s-u)/d}this.#Wi=new Float32Array([h,u,c,d]),this.#ba=f}getOutlines(){this.#va.sort(((e,t)=>e[0]-t[0]||e[1]-t[1]||e[2]-t[2]));const e=[];for(const t of this.#va)t[3]?(e.push(...this.#xa(t)),this.#wa(t)):(this.#_a(t),e.push(...this.#xa(t)));return this.#Sa(e)}#Sa(e){const t=[],s=new Set;for(const a of e){const[e,s,n]=a;t.push([e,s,a],[e,n,a])}t.sort(((e,t)=>e[1]-t[1]||e[0]-t[0]));for(let a=0,r=t.length;a<r;a+=2){const e=t[a][2],n=t[a+1][2];e.push(n),n.push(e),s.add(e),s.add(n)}const n=[];let i;for(;s.size>0;){const e=s.values().next().value;let[t,a,r,o,l]=e;s.delete(e);let c=t,d=a;for(i=[t,r],n.push(i);;){let e;if(s.has(o))e=o;else{if(!s.has(l))break;e=l}s.delete(e),[t,a,r,o,l]=e,c!==t&&(i.push(c,d,t,d===a?a:r),c=t),d=d===a?r:a}i.push(c,d)}return new zb(n,this.#Wi,this.#ba)}#Aa(e){const t=this.#ya;let s=0,n=t.length-1;for(;s<=n;){const i=s+n>>1,a=t[i][0];if(a===e)return i;a<e?s=i+1:n=i-1}return n+1}#wa(e){let[,t,s]=e;const n=this.#Aa(t);this.#ya.splice(n,0,[t,s])}#_a(e){let[,t,s]=e;const n=this.#Aa(t);for(let i=n;i<this.#ya.length;i++){const[e,n]=this.#ya[i];if(e!==t)break;if(e===t&&n===s)return void this.#ya.splice(i,1)}for(let i=n-1;i>=0;i--){const[e,n]=this.#ya[i];if(e!==t)break;if(e===t&&n===s)return void this.#ya.splice(i,1)}}#xa(e){const[t,s,n]=e,i=[[t,s,n]],a=this.#Aa(n);for(let r=0;r<a;r++){const[e,s]=this.#ya[r];for(let n=0,a=i.length;n<a;n++){const[,r,o]=i[n];if(!(s<=r||o<=e))if(r>=e)if(o>s)i[n][1]=s;else{if(1===a)return[];i.splice(n,1),n--,a--}else i[n][2]=e,o>s&&i.push([t,s,o])}}return i}}class zb extends Db{#Wi;#ka;constructor(e,t,s){super(),this.#ka=e,this.#Wi=t,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#ka){let[s,n]=t;e.push(`M${s} ${n}`);for(let i=2;i<t.length;i+=2){const a=t[i],r=t[i+1];a===s?(e.push(`V${r}`),n=r):r===n&&(e.push(`H${a}`),s=a)}e.push("Z")}return e.join(" ")}serialize(e,t){let[s,n,i,a]=e;const r=[],o=i-s,l=a-n;for(const c of this.#ka){const e=new Array(c.length);for(let t=0;t<c.length;t+=2)e[t]=s+c[t]*o,e[t+1]=a-c[t+1]*l;r.push(e)}return r}get box(){return this.#Wi}get classNamesForOutlining(){return["highlightOutline"]}}class $b extends Lb{newFreeDrawOutline(e,t,s,n,i,a){return new Bb(e,t,s,n,i,a)}}class Bb extends Ob{newOutliner(e,t,s,n,i){return new $b(e,t,s,n,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}}class Hb{#Ea=null;#Ca=null;#ja;#Na=null;#Ta=!1;#Pa=!1;#a=null;#Ma;#Ra=null;#m=null;#Ia;static#Da=null;static get _keyboardManager(){return Qp(this,"_keyboardManager",new Vf([[["Escape","mac+Escape"],Hb.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Hb.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Hb.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Hb.prototype._moveToPrevious],[["Home","mac+Home"],Hb.prototype._moveToBeginning],[["End","mac+End"],Hb.prototype._moveToEnd]]))}constructor(e){let{editor:t=null,uiManager:s=null}=e;t?(this.#Pa=!1,this.#Ia=cp.HIGHLIGHT_COLOR,this.#a=t):(this.#Pa=!0,this.#Ia=cp.HIGHLIGHT_DEFAULT_COLOR),this.#m=t?._uiManager||s,this.#Ma=this.#m._eventBus,this.#ja=t?.color||this.#m?.highlightColors.values().next().value||"#FFFF98",Hb.#Da||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#Ea=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#m._signal;e.addEventListener("click",this.#La.bind(this),{signal:t}),e.addEventListener("keydown",this.#Xn.bind(this),{signal:t});const s=this.#Ca=document.createElement("span");return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=this.#ja,e.append(s),e}renderMainDropdown(){const e=this.#Na=this.#Oa();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#Oa(){const e=document.createElement("div"),t=this.#m._signal;e.addEventListener("contextmenu",Nf,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,n]of this.#m.highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",n),i.title=s,i.setAttribute("data-l10n-id",Hb.#Da[s]);const a=document.createElement("span");i.append(a),a.className="swatch",a.style.backgroundColor=n,i.setAttribute("aria-selected",n===this.#ja),i.addEventListener("click",this.#Fa.bind(this,n),{signal:t}),e.append(i)}return e.addEventListener("keydown",this.#Xn.bind(this),{signal:t}),e}#Fa(e,t){t.stopPropagation(),this.#Ma.dispatch("switchannotationeditorparams",{source:this,type:this.#Ia,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#Ea)return void this.#La(e);const t=e.target.getAttribute("data-color");t&&this.#Fa(t,e)}_moveToNext(e){this.#za?e.target!==this.#Ea?e.target.nextSibling?.focus():this.#Na.firstChild?.focus():this.#La(e)}_moveToPrevious(e){e.target!==this.#Na?.firstChild&&e.target!==this.#Ea?(this.#za||this.#La(e),e.target.previousSibling?.focus()):this.#za&&this._hideDropdownFromKeyboard()}_moveToBeginning(e){this.#za?this.#Na.firstChild?.focus():this.#La(e)}_moveToEnd(e){this.#za?this.#Na.lastChild?.focus():this.#La(e)}#Xn(e){Hb._keyboardManager.exec(this,e)}#La(e){if(this.#za)return void this.hideDropdown();if(this.#Ta=0===e.detail,this.#Ra||(this.#Ra=new AbortController,window.addEventListener("pointerdown",this.#c.bind(this),{signal:this.#m.combinedSignal(this.#Ra)})),this.#Na)return void this.#Na.classList.remove("hidden");const t=this.#Na=this.#Oa();this.#Ea.append(t)}#c(e){this.#Na?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#Na?.classList.add("hidden"),this.#Ra?.abort(),this.#Ra=null}get#za(){return this.#Na&&!this.#Na.classList.contains("hidden")}_hideDropdownFromKeyboard(){this.#Pa||(this.#za?(this.hideDropdown(),this.#Ea.focus({preventScroll:!0,focusVisible:this.#Ta})):this.#a?.unselect())}updateColor(e){if(this.#Ca&&(this.#Ca.style.backgroundColor=e),!this.#Na)return;const t=this.#m.highlightColors.values();for(const s of this.#Na.children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#Ea?.remove(),this.#Ea=null,this.#Ca=null,this.#Na?.remove(),this.#Na=null}}class Ub extends Yf{#$a=null;#Ba=0;#Ha;#Ua=null;#i=null;#Va=null;#Wa=null;#qa=0;#Ga=null;#Xa=null;#y=null;#Ya=!1;#ba=null;#Ka;#Ja=null;#Qa="";#sa;#Za="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=(()=>lp.HIGHLIGHT)();static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Ub.prototype;return Qp(this,"_keyboardManager",new Vf([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Ub._defaultColor,this.#sa=e.thickness||Ub._defaultThickness,this.#Ka=e.opacity||Ub._defaultOpacity,this.#Ha=e.boxes||null,this.#Za=e.methodOfCreation||"",this.#Qa=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#Ya=!0,this.#er(e),this.#tr()):this.#Ha&&(this.#$a=e.anchorNode,this.#Ba=e.anchorOffset,this.#Wa=e.focusNode,this.#qa=e.focusOffset,this.#sr(),this.#tr(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#Ya?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#sa,methodOfCreation:this.#Za}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#sr(){const e=new Fb(this.#Ha,.001);this.#Xa=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#Xa.box;const t=new Fb(this.#Ha,.0025,.001,"ltr"===this._uiManager.direction);this.#Va=t.getOutlines();const{lastPoint:s}=this.#Va;this.#ba=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#er(e){let{highlightOutlines:t,highlightId:s,clipPathId:n}=e;this.#Xa=t;if(this.#Va=t.getNewOutline(this.#sa/2+1.5,.0025),s>=0)this.#y=s,this.#Ua=n,this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#Ja=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#Va.box,path:{d:this.#Va.toSVGPath()}},!0);else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#y,{bbox:Ub.#nr(this.#Xa.box,(e-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#Ja,{bbox:Ub.#nr(this.#Va.box,e),path:{d:this.#Va.toSVGPath()}})}const[i,a,r,o]=t.box;switch(this.rotation){case 0:this.x=i,this.y=a,this.width=r,this.height=o;break;case 90:{const[e,t]=this.parentDimensions;this.x=a,this.y=1-i,this.width=r*t/e,this.height=o*e/t;break}case 180:this.x=1-i,this.y=1-a,this.width=r,this.height=o;break;case 270:{const[e,t]=this.parentDimensions;this.x=1-a,this.y=i,this.width=r*t/e,this.height=o*e/t;break}}const{lastPoint:l}=this.#Va;this.#ba=[(l[0]-i)/r,(l[1]-a)/o]}static initialize(e,t){Yf.initialize(e,t),Ub._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case cp.HIGHLIGHT_DEFAULT_COLOR:Ub._defaultColor=t;break;case cp.HIGHLIGHT_THICKNESS:Ub._defaultThickness=t}}translateInPage(e,t){}get toolbarPosition(){return this.#ba}updateParams(e,t){switch(e){case cp.HIGHLIGHT_COLOR:this.#Oi(t);break;case cp.HIGHLIGHT_THICKNESS:this.#ir(t)}}static get defaultPropertiesToUpdate(){return[[cp.HIGHLIGHT_DEFAULT_COLOR,Ub._defaultColor],[cp.HIGHLIGHT_THICKNESS,Ub._defaultThickness]]}get propertiesToUpdate(){return[[cp.HIGHLIGHT_COLOR,this.color||Ub._defaultColor],[cp.HIGHLIGHT_THICKNESS,this.#sa||Ub._defaultThickness],[cp.HIGHLIGHT_FREE,this.#Ya]]}#Oi(e){const t=(e,t)=>{this.color=e,this.#Ka=t,this.parent?.drawLayer.updateProperties(this.#y,{root:{fill:e,"fill-opacity":t}}),this.#i?.updateColor(e)},s=this.color,n=this.#Ka;this.addCommands({cmd:t.bind(this,e,Ub._defaultOpacity),undo:t.bind(this,s,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:cp.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#ir(e){const t=this.#sa,s=e=>{this.#sa=e,this.#ar(e)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:cp.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#i=new Hb({editor:this}),e.addColorPicker(this.#i)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#rr())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#rr())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#or(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#tr(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#or():e&&(this.#tr(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#ar(e){if(!this.#Ya)return;this.#er({highlightOutlines:this.#Xa.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}#or(){null!==this.#y&&this.parent&&(this.parent.drawLayer.remove(this.#y),this.#y=null,this.parent.drawLayer.remove(this.#Ja),this.#Ja=null)}#tr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null===this.#y&&(({id:this.#y,clipPathId:this.#Ua}=e.drawLayer.draw({bbox:this.#Xa.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#Ka},rootClass:{highlight:!0,free:this.#Ya},path:{d:this.#Xa.toSVGPath()}},!1,!0)),this.#Ja=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#Ya},bbox:this.#Va.box,path:{d:this.#Va.toSVGPath()}},this.#Ya),this.#Ga&&(this.#Ga.style.clipPath=this.#Ua))}static#nr(e,t){let[s,n,i,a]=e;switch(t){case 90:return[1-n-a,s,a,i];case 180:return[1-s-i,1-n-a,i,a];case 270:return[n,1-s-i,a,i]}return[s,n,i,a]}rotate(e){const{drawLayer:t}=this.parent;let s;this.#Ya?(e=(e-this.rotation+360)%360,s=Ub.#nr(this.#Xa.box,e)):s=Ub.#nr([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#y,{bbox:s,root:{"data-main-rotation":e}}),t.updateProperties(this.#Ja,{bbox:Ub.#nr(this.#Va.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#Qa&&(e.setAttribute("aria-label",this.#Qa),e.setAttribute("role","mark")),this.#Ya?e.classList.add("free"):this.div.addEventListener("keydown",this.#lr.bind(this),{signal:this._uiManager._signal});const t=this.#Ga=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#Ua;const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),$f(this,this.#Ga,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#Ja,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#Ja,{rootClass:{hovered:!1}})}#lr(e){Ub._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#cr(!0);break;case 1:case 3:this.#cr(!1)}}#cr(e){if(!this.#$a)return;const t=window.getSelection();e?t.setPosition(this.#$a,this.#Ba):t.setPosition(this.#Wa,this.#qa)}select(){super.select(),this.#Ja&&this.parent?.drawLayer.updateProperties(this.#Ja,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#Ja&&(this.parent?.drawLayer.updateProperties(this.#Ja,{rootClass:{selected:!1}}),this.#Ya||this.#cr(!1))}get _mustFixPosition(){return!this.#Ya}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#y,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#Ja,{rootClass:{hidden:!e}}))}#rr(){return this.#Ya?this.rotation:0}#dr(){if(this.#Ya)return null;const[e,t]=this.pageDimensions,[s,n]=this.pageTranslation,i=this.#Ha,a=new Float32Array(8*i.length);let r=0;for(const{x:o,y:l,width:c,height:d}of i){const i=o*e+s,h=(1-l)*t+n;a[r]=a[r+4]=i,a[r+1]=a[r+3]=h,a[r+2]=a[r+6]=i+c*e,a[r+5]=a[r+7]=h-d*t,r+=8}return a}#hr(e){return this.#Xa.serialize(e,this.#rr())}static startHighlighting(e,t,s){let{target:n,x:i,y:a}=s;const{x:r,y:o,width:l,height:c}=n.getBoundingClientRect(),d=new AbortController,h=e.combinedSignal(d),u=t=>{d.abort(),this.#ur(e,t)};window.addEventListener("blur",u,{signal:h}),window.addEventListener("pointerup",u,{signal:h}),window.addEventListener("pointerdown",Tf,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",Nf,{signal:h}),n.addEventListener("pointermove",this.#pr.bind(this,e),{signal:h}),this._freeHighlight=new $b({x:i,y:a},[r,o,l,c],e.scale,this._defaultThickness/2,t,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static#pr(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#ur(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,s){let n=null;if(e instanceof Eb){const{data:{quadPoints:t,rect:s,rotation:i,id:a,color:r,opacity:o,popupRef:l},parent:{page:{pageNumber:c}}}=e;n=e={annotationType:lp.HIGHLIGHT,color:Array.from(r),opacity:o,quadPoints:t,boxes:null,pageIndex:c-1,rect:s.slice(0),rotation:i,id:a,deleted:!1,popupRef:l}}else if(e instanceof kb){const{data:{inkLists:t,rect:s,rotation:i,id:a,color:r,borderStyle:{rawWidth:o},popupRef:l},parent:{page:{pageNumber:c}}}=e;n=e={annotationType:lp.HIGHLIGHT,color:Array.from(r),thickness:o,inkLists:t,boxes:null,pageIndex:c-1,rect:s.slice(0),rotation:i,id:a,deleted:!1,popupRef:l}}const{color:i,quadPoints:a,inkLists:r,opacity:o}=e,l=await super.deserialize(e,t,s);l.color=pf.makeHexColor(...i),l.#Ka=o||1,r&&(l.#sa=e.thickness),l.annotationElementId=e.id||null,l._initialData=n;const[c,d]=l.pageDimensions,[h,u]=l.pageTranslation;if(a){const e=l.#Ha=[];for(let t=0;t<a.length;t+=8)e.push({x:(a[t]-h)/c,y:1-(a[t+1]-u)/d,width:(a[t+2]-a[t])/c,height:(a[t+1]-a[t+5])/d});l.#sr(),l.#tr(),l.rotate(l.rotation)}else if(r){l.#Ya=!0;const e=r[0],s={x:e[0]-h,y:d-(e[1]-u)},n=new $b(s,[0,0,c,d],1,l.#sa/2,!0,.001);for(let t=0,r=e.length;t<r;t+=2)s.x=e[t]-h,s.y=d-(e[t+1]-u),n.add(s);const{id:i,clipPathId:a}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:l.color,"fill-opacity":l._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:n.toSVGPath()}},!0,!0);l.#er({highlightOutlines:n.getOutlines(),highlightId:i,clipPathId:a}),l.#tr()}return l}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),s=Yf._colorManager.convert(this.color),n={annotationType:lp.HIGHLIGHT,color:s,opacity:this.#Ka,thickness:this.#sa,quadPoints:this.#dr(),outlines:this.#hr(t),pageIndex:this.pageIndex,rect:t,rotation:this.#rr(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#Vi(n)?null:(n.id=this.annotationElementId,n)}#Vi(e){const{color:t}=this._initialData;return e.color.some(((e,s)=>e!==t[s]))}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Vb{#fr=(()=>Object.create(null))();updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){this.#fr[e]=t}toSVGProperties(){const e=this.#fr;return this.#fr=Object.create(null),{root:e}}reset(){this.#fr=Object.create(null)}updateAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;this.updateProperties(e)}clone(){Yp("Not implemented")}}class Wb extends Yf{#mr=null;#gr;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#br=null;static#vr=null;static#yr=null;static#xr=NaN;static#wr=null;static#_r=null;static#Sr=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#gr=e.mustBeCommitted||!1,e.drawOutlines&&(this.#Ar(e),this.#tr())}#Ar(e){let{drawOutlines:t,drawId:s,drawingOptions:n}=e;this.#mr=t,this._drawingOptions||=n,s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=this.#kr(t,this.parent),this.#Er(t.box)}#kr(e,t){const{id:s}=t.drawLayer.draw(Wb._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(e,t){const s=new Set(Object.keys(e));for(const[n,i]of Object.entries(t))s.has(n)?Object.assign(e[n],i):e[n]=i;return e}static getDefaultDrawingOptions(e){Yp("Not implemented")}static get typesMap(){Yp("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,t),this._currentParent&&(Wb.#br.updateProperty(s,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[s,n]of this.typesMap)e.push([s,t[n]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[s,n]of this.constructor.typesMap)e.push([s,t[n]]);return e}_updateProperty(e,t,s){const n=this._drawingOptions,i=n[t],a=e=>{n.updateProperty(t,e);const s=this.#mr.updateProperty(t,e);s&&this.#Er(s),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties())};this.addCommands({cmd:a.bind(this,s),undo:a.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Wb._mergeSVGProperties(this.#mr.getPathResizingSVGProperties(this.#Cr()),{bbox:this.#jr()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Wb._mergeSVGProperties(this.#mr.getPathResizedSVGProperties(this.#Cr()),{bbox:this.#jr()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#jr(e,t)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Wb._mergeSVGProperties(this.#mr.getPathTranslatedSVGProperties(this.#Cr(),this.parentDimensions),{bbox:this.#jr()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#gr&&(this.#gr=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#or(),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#tr(),this.#Er(this.#mr.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#or()):e&&(this._uiManager.addShouldRescale(this),this.#tr(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#or(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#tr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null!==this._drawId&&this.parent===e||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=this.#kr(this.#mr,e)):this.parent.drawLayer.updateParent(this._drawId,e.drawLayer))}#Nr(e){let[t,s,n,i]=e;const{parentDimensions:[a,r],rotation:o}=this;switch(o){case 90:return[s,1-t,n*(r/a),i*(a/r)];case 180:return[1-t,1-s,n,i];case 270:return[1-s,t,n*(r/a),i*(a/r)];default:return[t,s,n,i]}}#Cr(){const{x:e,y:t,width:s,height:n,parentDimensions:[i,a],rotation:r}=this;switch(r){case 90:return[1-t,e,s*(i/a),n*(a/i)];case 180:return[1-e,1-t,s,n];case 270:return[t,1-e,s*(i/a),n*(a/i)];default:return[e,t,s,n]}}#Er(e){if([this.x,this.y,this.width,this.height]=this.#Nr(e),this.div){this.fixAndSetPosition();const[e,t]=this.parentDimensions;this.setDims(this.width*e,this.height*t)}this._onResized()}#jr(){const{x:e,y:t,width:s,height:n,rotation:i,parentRotation:a,parentDimensions:[r,o]}=this;switch((4*i+a)/90){case 1:return[1-t-n,e,n,s];case 2:return[1-e-s,1-t-n,s,n];case 3:return[t,1-e-s,n,s];case 4:return[e,t-s*(r/o),n*(o/r),s*(r/o)];case 5:return[1-t,e,s*(r/o),n*(o/r)];case 6:return[1-e-n*(o/r),1-t,n*(o/r),s*(r/o)];case 7:return[t-s*(r/o),1-e-n*(o/r),s*(r/o),n*(o/r)];case 8:return[e-s,t-n,s,n];case 9:return[1-t,e-s,n,s];case 10:return[1-e,1-t,s,n];case 11:return[t-n,1-e,n,s];case 12:return[e-n*(o/r),t,n*(o/r),s*(r/o)];case 13:return[1-t-s*(r/o),e-n*(o/r),s*(r/o),n*(o/r)];case 14:return[1-e,1-t-s*(r/o),n*(o/r),s*(r/o)];case 15:return[t,1-e,s*(r/o),n*(o/r)];default:return[e,t,s,n]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Wb._mergeSVGProperties({bbox:this.#jr()},this.#mr.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#Er(this.#mr.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const t=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal";const[s,n]=this.parentDimensions;return this.setDims(this.width*s,this.height*n),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,t,s,n,i){Yp("Not implemented")}static startDrawing(e,t,s,n){const{target:i,offsetX:a,offsetY:r,pointerId:o,pointerType:l}=n;if(Wb.#wr&&Wb.#wr!==l)return;const{viewport:{rotation:c}}=e,{width:d,height:h}=i.getBoundingClientRect(),u=Wb.#vr=new AbortController,p=e.combinedSignal(u);Wb.#xr||=o,Wb.#wr??=l,window.addEventListener("pointerup",(e=>{Wb.#xr===e.pointerId?this._endDraw(e):Wb.#_r?.delete(e.pointerId)}),{signal:p}),window.addEventListener("pointercancel",(e=>{Wb.#xr===e.pointerId?this._currentParent.endDrawingSession():Wb.#_r?.delete(e.pointerId)}),{signal:p}),window.addEventListener("pointerdown",(e=>{Wb.#wr===e.pointerType&&((Wb.#_r||=new Set).add(e.pointerId),Wb.#br.isCancellable()&&(Wb.#br.removeLastElement(),Wb.#br.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))}),{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Nf,{signal:p}),i.addEventListener("pointermove",this._drawMove.bind(this),{signal:p}),i.addEventListener("touchmove",(e=>{e.timeStamp===Wb.#Sr&&Tf(e)}),{signal:p}),e.toggleDrawing(),t._editorUndoBar?.hide(),Wb.#br?e.drawLayer.updateProperties(this._currentDrawId,Wb.#br.startNew(a,r,d,h,c)):(t.updateUIForDefaultProperties(this),Wb.#br=this.createDrawerInstance(a,r,d,h,c),Wb.#yr=this.getDefaultDrawingOptions(),this._currentParent=e,({id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(Wb.#yr.toSVGProperties(),Wb.#br.defaultSVGProperties),!0,!1)))}static _drawMove(e){if(Wb.#Sr=-1,!Wb.#br)return;const{offsetX:t,offsetY:s,pointerId:n}=e;Wb.#xr===n&&(Wb.#_r?.size>=1?this._endDraw(e):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,Wb.#br.add(t,s)),Wb.#Sr=e.timeStamp,Tf(e)))}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Wb.#br=null,Wb.#yr=null,Wb.#wr=null,Wb.#Sr=NaN),Wb.#vr&&(Wb.#vr.abort(),Wb.#vr=null,Wb.#xr=NaN,Wb.#_r=null)}static _endDraw(e){const t=this._currentParent;if(t)if(t.toggleDrawing(!0),this._cleanup(!1),e&&t.drawLayer.updateProperties(this._currentDrawId,Wb.#br.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const e=Wb.#br,s=this._currentDrawId,n=e.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,e.setLastElement(n))},undo:()=>{t.drawLayer.updateProperties(s,e.removeLastElement())},mustExec:!1,type:cp.DRAW_STEP})}else this.endDrawing(!1)}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(cp.DRAW_STEP),!Wb.#br.isEmpty()){const{pageDimensions:[s,n],scale:i}=t,a=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Wb.#br.getOutlines(s*i,n*i,i,this._INNER_MARGIN),drawingOptions:Wb.#yr,mustBeCommitted:!e});return this._cleanup(!0),a}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,s,n,i,a){Yp("Not implemented")}static async deserialize(e,t,s){const{rawDims:{pageWidth:n,pageHeight:i,pageX:a,pageY:r}}=t.viewport,o=this.deserializeDraw(a,r,n,i,this._INNER_MARGIN,e),l=await super.deserialize(e,t,s);return l.createDrawingOptions(e),l.#Ar({drawOutlines:o}),l.#tr(),l.onScaleChanging(),l.rotate(),l}serializeDraw(e){const[t,s]=this.pageTranslation,[n,i]=this.pageDimensions;return this.#mr.serialize([t,s,n,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class qb{#Ki=(()=>new Float64Array(6))();#vi;#Tr;#Is;#sa;#na;#Pr="";#Mr=0;#ka=(()=>new Gb)();#Rr;#Ir;constructor(e,t,s,n,i,a){this.#Rr=s,this.#Ir=n,this.#Is=i,this.#sa=a,[e,t]=this.#Dr(e,t);const r=this.#vi=[NaN,NaN,NaN,NaN,e,t];this.#na=[e,t],this.#Tr=[{line:r,points:this.#na}],this.#Ki.set(r,0)}updateProperty(e,t){"stroke-width"===e&&(this.#sa=t)}#Dr(e,t){return Db._normalizePoint(e,t,this.#Rr,this.#Ir,this.#Is)}isEmpty(){return!this.#Tr||0===this.#Tr.length}isCancellable(){return this.#na.length<=10}add(e,t){[e,t]=this.#Dr(e,t);const[s,n,i,a]=this.#Ki.subarray(2,6),r=e-i,o=t-a;return Math.hypot(this.#Rr*r,this.#Ir*o)<=2?null:(this.#na.push(e,t),isNaN(s)?(this.#Ki.set([i,a,e,t],2),this.#vi.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#Ki[0])&&this.#vi.splice(6,6),this.#Ki.set([s,n,i,a,e,t],0),this.#vi.push(...Db.createBezierPoints(s,n,i,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(2===this.#na.length?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,n,i){this.#Rr=s,this.#Ir=n,this.#Is=i,[e,t]=this.#Dr(e,t);const a=this.#vi=[NaN,NaN,NaN,NaN,e,t];this.#na=[e,t];const r=this.#Tr.at(-1);return r&&(r.line=new Float32Array(r.line),r.points=new Float32Array(r.points)),this.#Tr.push({line:a,points:this.#na}),this.#Ki.set(a,0),this.#Mr=0,this.toSVGPath(),null}getLastElement(){return this.#Tr.at(-1)}setLastElement(e){return this.#Tr?(this.#Tr.push(e),this.#vi=e.line,this.#na=e.points,this.#Mr=0,{path:{d:this.toSVGPath()}}):this.#ka.setLastElement(e)}removeLastElement(){if(!this.#Tr)return this.#ka.removeLastElement();this.#Tr.pop(),this.#Pr="";for(let e=0,t=this.#Tr.length;e<t;e++){const{line:t,points:s}=this.#Tr[e];this.#vi=t,this.#na=s,this.#Mr=0,this.toSVGPath()}return{path:{d:this.#Pr}}}toSVGPath(){const e=Db.svgRound(this.#vi[4]),t=Db.svgRound(this.#vi[5]);if(2===this.#na.length)return this.#Pr=`${this.#Pr} M ${e} ${t} Z`,this.#Pr;if(this.#na.length<=6){const s=this.#Pr.lastIndexOf("M");this.#Pr=`${this.#Pr.slice(0,s)} M ${e} ${t}`,this.#Mr=6}if(4===this.#na.length){const e=Db.svgRound(this.#vi[10]),t=Db.svgRound(this.#vi[11]);return this.#Pr=`${this.#Pr} L ${e} ${t}`,this.#Mr=12,this.#Pr}const s=[];0===this.#Mr&&(s.push(`M ${e} ${t}`),this.#Mr=6);for(let n=this.#Mr,i=this.#vi.length;n<i;n+=6){const[e,t,i,a,r,o]=this.#vi.slice(n,n+6).map(Db.svgRound);s.push(`C${e} ${t} ${i} ${a} ${r} ${o}`)}return this.#Pr+=s.join(" "),this.#Mr=this.#vi.length,this.#Pr}getOutlines(e,t,s,n){const i=this.#Tr.at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),this.#ka.build(this.#Tr,e,t,s,this.#Is,this.#sa,n),this.#Ki=null,this.#vi=null,this.#Tr=null,this.#Pr=null,this.#ka}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Gb extends Db{#fa;#Lr=0;#Gi;#Tr;#Rr;#Ir;#Or;#Is;#sa;build(e,t,s,n,i,a,r){this.#Rr=t,this.#Ir=s,this.#Or=n,this.#Is=i,this.#sa=a,this.#Gi=r??0,this.#Tr=e,this.#Fr()}setLastElement(e){return this.#Tr.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#Tr.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#Tr)if(e.push(`M${Db.svgRound(t[4])} ${Db.svgRound(t[5])}`),6!==t.length)if(12!==t.length)for(let s=6,n=t.length;s<n;s+=6){const[n,i,a,r,o,l]=t.subarray(s,s+6).map(Db.svgRound);e.push(`C${n} ${i} ${a} ${r} ${o} ${l}`)}else e.push(`L${Db.svgRound(t[10])} ${Db.svgRound(t[11])}`);else e.push("Z");return e.join("")}serialize(e,t){let[s,n,i,a]=e;const r=[],o=[],[l,c,d,h]=this.#zr();let u,p,f,m,g,b,v,y,x;switch(this.#Is){case 0:x=Db._rescale,u=s,p=n+a,f=i,m=-a,g=s+l*i,b=n+(1-c-h)*a,v=s+(l+d)*i,y=n+(1-c)*a;break;case 90:x=Db._rescaleAndSwap,u=s,p=n,f=i,m=a,g=s+c*i,b=n+l*a,v=s+(c+h)*i,y=n+(l+d)*a;break;case 180:x=Db._rescale,u=s+i,p=n,f=-i,m=a,g=s+(1-l-d)*i,b=n+c*a,v=s+(1-l)*i,y=n+(c+h)*a;break;case 270:x=Db._rescaleAndSwap,u=s+i,p=n+a,f=-i,m=-a,g=s+(1-c-h)*i,b=n+(1-l-d)*a,v=s+(1-c)*i,y=n+(1-l)*a}for(const{line:w,points:_}of this.#Tr)r.push(x(w,u,p,f,m,t?new Array(w.length):null)),o.push(x(_,u,p,f,m,t?new Array(_.length):null));return{lines:r,points:o,rect:[g,b,v,y]}}static deserialize(e,t,s,n,i,a){let{paths:{lines:r,points:o},rotation:l,thickness:c}=a;const d=[];let h,u,p,f,m;switch(l){case 0:m=Db._rescale,h=-e/s,u=t/n+1,p=1/s,f=-1/n;break;case 90:m=Db._rescaleAndSwap,h=-t/n,u=-e/s,p=1/n,f=1/s;break;case 180:m=Db._rescale,h=e/s+1,u=-t/n,p=-1/s,f=1/n;break;case 270:m=Db._rescaleAndSwap,h=t/n+1,u=e/s+1,p=-1/n,f=-1/s}if(!r){r=[];for(const e of o){const t=e.length;if(2===t){r.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1]]));continue}if(4===t){r.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1],NaN,NaN,NaN,NaN,e[2],e[3]]));continue}const s=new Float32Array(3*(t-2));r.push(s);let[n,i,a,o]=e.subarray(0,4);s.set([NaN,NaN,NaN,NaN,n,i],0);for(let r=4;r<t;r+=2){const t=e[r],l=e[r+1];s.set(Db.createBezierPoints(n,i,a,o,t,l),3*(r-2)),[n,i,a,o]=[a,o,t,l]}}}for(let b=0,v=r.length;b<v;b++)d.push({line:m(r[b].map((e=>e??NaN)),h,u,p,f),points:m(o[b].map((e=>e??NaN)),h,u,p,f)});const g=new Gb;return g.build(d,s,n,1,l,c,i),g}#$r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.#sa;const t=this.#Gi+e/2*this.#Or;return this.#Is%180===0?[t/this.#Rr,t/this.#Ir]:[t/this.#Ir,t/this.#Rr]}#zr(){const[e,t,s,n]=this.#fa,[i,a]=this.#$r(0);return[e+i,t+a,s-2*i,n-2*a]}#Fr(){const e=this.#fa=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:n}of this.#Tr){if(n.length<=12){for(let t=4,s=n.length;t<s;t+=6){const[s,i]=n.subarray(t,t+2);e[0]=Math.min(e[0],s),e[1]=Math.min(e[1],i),e[2]=Math.max(e[2],s),e[3]=Math.max(e[3],i)}continue}let t=n[4],s=n[5];for(let i=6,a=n.length;i<a;i+=6){const[a,r,o,l,c,d]=n.subarray(i,i+6);pf.bezierBoundingBox(t,s,a,r,o,l,c,d,e),t=c,s=d}}const[t,s]=this.#$r();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-s)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+s)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#fa}updateProperty(e,t){return"stroke-width"===e?this.#ir(t):null}#ir(e){const[t,s]=this.#$r();this.#sa=e;const[n,i]=this.#$r(),[a,r]=[n-t,i-s],o=this.#fa;return o[0]-=a,o[1]-=r,o[2]+=2*a,o[3]+=2*r,o}updateParentDimensions(e,t){let[s,n]=e;const[i,a]=this.#$r();this.#Rr=s,this.#Ir=n,this.#Or=t;const[r,o]=this.#$r(),l=r-i,c=o-a,d=this.#fa;return d[0]-=l,d[1]-=c,d[2]+=2*l,d[3]+=2*c,d}updateRotation(e){return this.#Lr=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#fa.map(Db.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#fa;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Db.svgRound(e)} ${Db.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#fa;let s=0,n=0,i=0,a=0,r=0,o=0;switch(this.#Lr){case 90:n=t/e,i=-e/t,r=e;break;case 180:s=-1,a=-1,r=e,o=t;break;case 270:n=-t/e,i=e/t,o=t;break;default:return""}return`matrix(${s} ${n} ${i} ${a} ${Db.svgRound(r)} ${Db.svgRound(o)})`}getPathResizingSVGProperties(e){let[t,s,n,i]=e;const[a,r]=this.#$r(),[o,l,c,d]=this.#fa;if(Math.abs(c-a)<=Db.PRECISION||Math.abs(d-r)<=Db.PRECISION){const e=t+n/2-(o+c/2),a=s+i/2-(l+d/2);return{path:{"transform-origin":`${Db.svgRound(t)} ${Db.svgRound(s)}`,transform:`${this.rotationTransform} translate(${e} ${a})`}}}const h=(n-2*a)/(c-2*a),u=(i-2*r)/(d-2*r),p=c/n,f=d/i;return{path:{"transform-origin":`${Db.svgRound(o)} ${Db.svgRound(l)}`,transform:`${this.rotationTransform} scale(${p} ${f}) translate(${Db.svgRound(a)} ${Db.svgRound(r)}) scale(${h} ${u}) translate(${Db.svgRound(-a)} ${Db.svgRound(-r)})`}}}getPathResizedSVGProperties(e){let[t,s,n,i]=e;const[a,r]=this.#$r(),o=this.#fa,[l,c,d,h]=o;if(o[0]=t,o[1]=s,o[2]=n,o[3]=i,Math.abs(d-a)<=Db.PRECISION||Math.abs(h-r)<=Db.PRECISION){const e=t+n/2-(l+d/2),a=s+i/2-(c+h/2);for(const{line:t,points:s}of this.#Tr)Db._translate(t,e,a,t),Db._translate(s,e,a,s);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Db.svgRound(t)} ${Db.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const u=(n-2*a)/(d-2*a),p=(i-2*r)/(h-2*r),f=-u*(l+a)+t+a,m=-p*(c+r)+s+r;if(1!==u||1!==p||0!==f||0!==m)for(const{line:g,points:b}of this.#Tr)Db._rescale(g,f,m,u,p,g),Db._rescale(b,f,m,u,p,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Db.svgRound(t)} ${Db.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties(e,t){let[s,n]=e;const[i,a]=t,r=this.#fa,o=s-r[0],l=n-r[1];if(this.#Rr===i&&this.#Ir===a)for(const{line:c,points:d}of this.#Tr)Db._translate(c,o,l,c),Db._translate(d,o,l,d);else{const e=this.#Rr/i,t=this.#Ir/a;this.#Rr=i,this.#Ir=a;for(const{line:s,points:n}of this.#Tr)Db._rescale(s,o,l,e,t,s),Db._rescale(n,o,l,e,t,n);r[2]*=e,r[3]*=t}return r[0]=s,r[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Db.svgRound(s)} ${Db.svgRound(n)}`}}}get defaultSVGProperties(){const e=this.#fa;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Db.svgRound(e[0])} ${Db.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Xb extends Vb{#Br;constructor(e){super(),this.#Br=e,super.updateProperties({fill:"none",stroke:Yf._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){"stroke-width"===e&&(t??=this["stroke-width"],t*=this.#Br.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Xb(this.#Br);return e.updateAll(this),e}}class Yb extends Wb{static _type="ink";static _editorType=(()=>lp.INK)();static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){Yf.initialize(e,t),this._defaultDrawingOptions=new Xb(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Qp(this,"typesMap",new Map([[cp.INK_THICKNESS,"stroke-width"],[cp.INK_COLOR,"stroke"],[cp.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,s,n,i){return new qb(e,t,s,n,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,s,n,i,a){return Gb.deserialize(e,t,s,n,i,a)}static async deserialize(e,t,s){let n=null;if(e instanceof kb){const{data:{inkLists:t,rect:s,rotation:i,id:a,color:r,opacity:o,borderStyle:{rawWidth:l},popupRef:c},parent:{page:{pageNumber:d}}}=e;n=e={annotationType:lp.INK,color:Array.from(r),thickness:l,opacity:o,paths:{points:t},boxes:null,pageIndex:d-1,rect:s.slice(0),rotation:i,id:a,deleted:!1,popupRef:c}}const i=await super.deserialize(e,t,s);return i.annotationElementId=e.id||null,i._initialData=n,i}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:s}=this;t.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions(e){let{color:t,thickness:s,opacity:n}=e;this._drawingOptions=Yb.getDefaultDrawingOptions({stroke:pf.makeHexColor(...t),"stroke-width":s,"stroke-opacity":n})}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:s,rect:n}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":a,"stroke-width":r}}=this,o={annotationType:lp.INK,color:Yf._colorManager.convert(i),opacity:a,thickness:r,paths:{lines:t,points:s},pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!this.#Vi(o)?null:(o.id=this.annotationElementId,o)}#Vi(e){const{color:t,thickness:s,opacity:n,pageIndex:i}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some(((e,s)=>e!==t[s]))||e.thickness!==s||e.opacity!==n||e.pageIndex!==i}renderAnnotationElement(e){const{points:t,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class Kb extends Yf{#Hr=null;#Ur=null;#Vr=null;#Wr=null;#qr=null;#Gr="";#Xr=null;#Yr=null;#Kr=!1;#Jr=!1;static _type="stamp";static _editorType=(()=>lp.STAMP)();constructor(e){super({...e,name:"stampEditor"}),this.#Wr=e.bitmapUrl,this.#qr=e.bitmapFile}static initialize(e,t){Yf.initialize(e,t)}static get supportedTypes(){return Qp(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map((e=>`image/${e}`)))}static get supportedTypesStr(){return Qp(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(lp.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#Qr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?(this.#Hr=e.bitmap,t||(this.#Ur=e.id,this.#Kr=e.isSvg),e.file&&(this.#Gr=e.file.name),this.#Zr()):this.remove()}#eo(){if(this.#Vr=null,this._uiManager.enableWaiting(!1),this.#Xr){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Hr)return this._editToolbar.hide(),void this._uiManager.editAltText(this,!0);if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Hr){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:n,width:i,height:a}=e||this.copyCanvas(null,null,!0).imageData,r=await s.guess({name:"altText",request:{data:n,width:i,height:a,channels:n.length/(i*a)}});if(!r)throw new Error("No response from the AI service.");if(r.error)throw new Error("Error from the AI service.");if(r.cancel)return null;if(!r.output)throw new Error("No valid response from the AI service.");const o=r.output;return await this.setGuessedAltText(o),t&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}#to(){if(this.#Ur)return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(this.#Ur).then((e=>this.#Qr(e,!0))).finally((()=>this.#eo()));if(this.#Wr){const e=this.#Wr;return this.#Wr=null,this._uiManager.enableWaiting(!0),void(this.#Vr=this._uiManager.imageManager.getFromUrl(e).then((e=>this.#Qr(e))).finally((()=>this.#eo())))}if(this.#qr){const e=this.#qr;return this.#qr=null,this._uiManager.enableWaiting(!0),void(this.#Vr=this._uiManager.imageManager.getFromFile(e).then((e=>this.#Qr(e))).finally((()=>this.#eo())))}const e=document.createElement("input");e.type="file",e.accept=Kb.supportedTypesStr;const t=this._uiManager._signal;this.#Vr=new Promise((s=>{e.addEventListener("change",(async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#Qr(t)}else this.remove();s()}),{signal:t}),e.addEventListener("cancel",(()=>{this.remove(),s()}),{signal:t})})).finally((()=>this.#eo())),e.click()}remove(){this.#Ur&&(this.#Hr=null,this._uiManager.imageManager.deleteId(this.#Ur),this.#Xr?.remove(),this.#Xr=null,this.#Yr&&(clearTimeout(this.#Yr),this.#Yr=null)),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(this.#Ur&&null===this.#Xr&&this.#to(),this.isAttachedToDOM||this.parent.add(this))):this.#Ur&&this.#to()}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#Vr||this.#Hr||this.#Wr||this.#qr||this.#Ur)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#Hr?this.#Zr():this.#to(),this.width&&!this.annotationElementId){const[s,n]=this.parentDimensions;this.setAt(e*s,t*n,this.width*s,this.height*n)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;null!==this.#Yr&&clearTimeout(this.#Yr);this.#Yr=setTimeout((()=>{this.#Yr=null,this.#so()}),200)}#Zr(){const{div:e}=this;let{width:t,height:s}=this.#Hr;const[n,i]=this.pageDimensions,a=.75;if(this.width)t=this.width*n,s=this.height*i;else if(t>a*n||s>a*i){const e=Math.min(a*n/t,a*i/s);t*=e,s*=e}const[r,o]=this.parentDimensions;this.setDims(t*r/n,s*o/i),this._uiManager.enableWaiting(!1);const l=this.#Xr=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),this.width=t/n,this.height=s/i,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(e.hidden=!1),this.#so(),this.#Jr||(this.parent.addUndoableEditor(this),this.#Jr=!0),this._reportTelemetry({action:"inserted_image"}),this.#Gr&&l.setAttribute("aria-label",this.#Gr)}copyCanvas(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e||(e=224);const{width:n,height:i}=this.#Hr,a=new Of;let r=this.#Hr,o=n,l=i,c=null;if(t){if(n>t||i>t){const e=Math.min(t/n,t/i);o=Math.floor(n*e),l=Math.floor(i*e)}c=document.createElement("canvas");const e=c.width=Math.ceil(o*a.sx),s=c.height=Math.ceil(l*a.sy);this.#Kr||(r=this.#no(e,s));const d=c.getContext("2d");d.filter=this._uiManager.hcmFilter;let h="white",u="#cfcfd8";"none"!==this._uiManager.hcmFilter?u="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(h="#8f8f9d",u="#42414d");const p=15,f=p*a.sx,m=p*a.sy,g=new OffscreenCanvas(2*f,2*m),b=g.getContext("2d");b.fillStyle=h,b.fillRect(0,0,2*f,2*m),b.fillStyle=u,b.fillRect(0,0,f,m),b.fillRect(f,m,f,m),d.fillStyle=d.createPattern(g,"repeat"),d.fillRect(0,0,e,s),d.drawImage(r,0,0,r.width,r.height,0,0,e,s)}let d=null;if(s){let t,s;if(a.symmetric&&r.width<e&&r.height<e)t=r.width,s=r.height;else if(r=this.#Hr,n>e||i>e){const a=Math.min(e/n,e/i);t=Math.floor(n*a),s=Math.floor(i*a),this.#Kr||(r=this.#no(t,s))}const o=new OffscreenCanvas(t,s).getContext("2d",{willReadFrequently:!0});o.drawImage(r,0,0,r.width,r.height,0,0,t,s),d={width:t,height:s,data:o.getImageData(0,0,t,s).data}}return{canvas:c,width:o,height:l,imageData:d}}#no(e,t){const{width:s,height:n}=this.#Hr;let i=s,a=n,r=this.#Hr;for(;i>2*e||a>2*t;){const s=i,n=a;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const o=new OffscreenCanvas(i,a);o.getContext("2d").drawImage(r,0,0,s,n,0,0,i,a),r=o.transferToImageBitmap()}return r}#so(){const[e,t]=this.parentDimensions,{width:s,height:n}=this,i=new Of,a=Math.ceil(s*e*i.sx),r=Math.ceil(n*t*i.sy),o=this.#Xr;if(!o||o.width===a&&o.height===r)return;o.width=a,o.height=r;const l=this.#Kr?this.#Hr:this.#no(a,r),c=o.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,a,r)}getImageForAltText(){return this.#Xr}#io(e){if(e){if(this.#Kr){const e=this._uiManager.imageManager.getSvgUrl(this.#Ur);if(e)return e}const e=document.createElement("canvas");({width:e.width,height:e.height}=this.#Hr);return e.getContext("2d").drawImage(this.#Hr,0,0),e.toDataURL()}if(this.#Kr){const[e,t]=this.pageDimensions,s=Math.round(this.width*e*yf.PDF_TO_CSS_UNITS),n=Math.round(this.height*t*yf.PDF_TO_CSS_UNITS),i=new OffscreenCanvas(s,n);return i.getContext("2d").drawImage(this.#Hr,0,0,this.#Hr.width,this.#Hr.height,0,0,s,n),i.transferToImageBitmap()}return structuredClone(this.#Hr)}static async deserialize(e,t,s){let n=null;if(e instanceof Tb){const{data:{rect:i,rotation:a,id:r,structParent:o,popupRef:l},container:c,parent:{page:{pageNumber:d}}}=e,h=c.querySelector("canvas"),u=s.imageManager.getFromCanvas(c.id,h);h.remove();const p=(await t._structTree.getAriaAttributes(`${bf}${r}`))?.get("aria-label")||"";n=e={annotationType:lp.STAMP,bitmapId:u.id,bitmap:u.bitmap,pageIndex:d-1,rect:i.slice(0),rotation:a,id:r,deleted:!1,accessibilityData:{decorative:!1,altText:p},isSvg:!1,structParent:o,popupRef:l}}const i=await super.deserialize(e,t,s),{rect:a,bitmap:r,bitmapUrl:o,bitmapId:l,isSvg:c,accessibilityData:d}=e;l&&s.imageManager.isValidId(l)?(i.#Ur=l,r&&(i.#Hr=r)):i.#Wr=o,i.#Kr=c;const[h,u]=i.pageDimensions;return i.width=(a[2]-a[0])/h,i.height=(a[3]-a[1])/u,i.annotationElementId=e.id||null,d&&(i.altTextData=d),i._initialData=n,i.#Jr=!!n,i}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:lp.STAMP,bitmapId:this.#Ur,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#Kr,structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=this.#io(!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:n,altText:i}=this.serializeAltText(!1);if(!n&&i&&(s.accessibilityData={type:"Figure",alt:i}),this.annotationElementId){const e=this.#Vi(s);if(e.isSame)return null;e.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,null===t)return s;t.stamps||=new Map;const a=this.#Kr?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(t.stamps.has(this.#Ur)){if(this.#Kr){const e=t.stamps.get(this.#Ur);a>e.area&&(e.area=a,e.serialized.bitmap.close(),e.serialized.bitmap=this.#io(!1))}}else t.stamps.set(this.#Ur,{area:a,serialized:s}),s.bitmap=this.#io(!1);return s}#Vi(e){const{pageIndex:t,accessibilityData:{altText:s}}=this._initialData,n=e.pageIndex===t,i=(e.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&n&&i,isSameAltText:i}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class Jb{#Ci;#ao=!1;#ro=null;#oo=null;#lo=null;#co=(()=>new Map)();#do=!1;#ho=!1;#uo=!1;#po=null;#fo=null;#mo=null;#go=null;#m;static _initialized=!1;static#B=(()=>new Map([Ib,Yb,Kb,Ub].map((e=>[e._editorType,e]))))();constructor(e){let{uiManager:t,pageIndex:s,div:n,structTreeLayer:i,accessibilityManager:a,annotationLayer:r,drawLayer:o,textLayer:l,viewport:c,l10n:d}=e;const h=[...Jb.#B.values()];if(!Jb._initialized){Jb._initialized=!0;for(const e of h)e.initialize(d,t)}t.registerEditorTypes(h),this.#m=t,this.pageIndex=s,this.div=n,this.#Ci=a,this.#ro=r,this.viewport=c,this.#mo=l,this.drawLayer=o,this._structTree=i,this.#m.addLayer(this)}get isEmpty(){return 0===this.#co.size}get isInvisible(){return this.isEmpty&&this.#m.getMode()===lp.NONE}updateToolbar(e){this.#m.updateToolbar(e)}updateMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.#m.getMode();switch(this.#bo(),e){case lp.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case lp.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case lp.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of Jb.#B.values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#mo?.div}setEditingState(e){this.#m.setEditingState(e)}addCommands(e){this.#m.addCommands(e)}cleanUndoStack(e){this.#m.cleanUndoStack(e)}toggleDrawing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("drawing",!e)}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.#ro?.div.classList.toggle("disabled",!e)}async enable(){this.#uo=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of this.#co.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#m.removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!this.#ro)return void(this.#uo=!1);const t=this.#ro.getEditableAnnotations();for(const s of t){if(s.hide(),this.#m.isDeletedAnnotationElement(s.data.id))continue;if(e.has(s.data.id))continue;const t=await this.deserialize(s);t&&(this.addOrRebuild(t),t.enableEditing())}this.#uo=!1}disable(){this.#ho=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const n of this.#co.values())n.disableEditing(),n.annotationElementId&&(null===n.serialize()?(t.set(n.annotationElementId,n),this.getEditableAnnotation(n.annotationElementId)?.show(),n.remove()):e.set(n.annotationElementId,n));if(this.#ro){const s=this.#ro.getEditableAnnotations();for(const n of s){const{id:s}=n.data;if(this.#m.isDeletedAnnotationElement(s))continue;let i=t.get(s);i?(i.resetAnnotationElement(n),i.show(!1),n.show()):(i=e.get(s),i&&(this.#m.addChangedExistingAnnotation(i),i.renderAnnotationElement(n)&&i.show(!1)),n.show())}}this.#bo(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const n of Jb.#B.values())s.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#ho=!1}getEditableAnnotation(e){return this.#ro?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#m.getActive()!==e&&this.#m.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#mo?.div&&!this.#go){this.#go=new AbortController;const e=this.#m.combinedSignal(this.#go);this.#mo.div.addEventListener("pointerdown",this.#vo.bind(this),{signal:e}),this.#mo.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#mo?.div&&this.#go&&(this.#go.abort(),this.#go=null,this.#mo.div.classList.remove("highlighting"))}#vo(e){this.#m.unselectAll();const{target:t}=e;if(t===this.#mo.div||("img"===t.getAttribute("role")||t.classList.contains("endOfContent"))&&this.#mo.div.contains(t)){const{isMac:t}=hf.platform;if(0!==e.button||e.ctrlKey&&t)return;this.#m.showAllEditors("highlight",!0,!0),this.#mo.div.classList.add("free"),this.toggleDrawing(),Ub.startHighlighting(this,"ltr"===this.#m.direction,{target:this.#mo.div,x:e.x,y:e.y}),this.#mo.div.addEventListener("pointerup",(()=>{this.#mo.div.classList.remove("free"),this.toggleDrawing(!0)}),{once:!0,signal:this.#m._signal}),e.preventDefault()}}enableClick(){if(this.#oo)return;this.#oo=new AbortController;const e=this.#m.combinedSignal(this.#oo);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#oo?.abort(),this.#oo=null}attach(e){this.#co.set(e.id,e);const{annotationElementId:t}=e;t&&this.#m.isDeletedAnnotationElement(t)&&this.#m.removeDeletedAnnotationElement(e)}detach(e){this.#co.delete(e.id),this.#Ci?.removePointerInTextLayer(e.contentDiv),!this.#ho&&e.annotationElementId&&this.#m.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#m.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#m.addDeletedAnnotationElement(e.annotationElementId),Yf.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(e.parent!==this||!e.isAttachedToDOM){if(this.changeParent(e),this.#m.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#uo),this.#m.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#lo&&(e._focusEventsAllowed=!1,this.#lo=setTimeout((()=>{this.#lo=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",(()=>{e._focusEventsAllowed=!0}),{once:!0,signal:this.#m._signal}),t.focus())}),0)),e._structTreeParentId=this.#Ci?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getNextId(){return this.#m.getId()}get#yo(){return Jb.#B.get(this.#m.getMode())}combinedSignal(e){return this.#m.combinedSignal(e)}#xo(e){const t=this.#yo;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#yo?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#m.updateToolbar(e),this.#m.updateMode(e);const{offsetX:s,offsetY:n}=this.#wo(),i=this.getNextId(),a=this.#xo({parent:this,id:i,x:s,y:n,uiManager:this.#m,isCentered:!0,...t});a&&this.add(a)}async deserialize(e){return await(Jb.#B.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#m))||null}createAndAddNewEditor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.getNextId(),i=this.#xo({parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:this.#m,isCentered:t,...s});return i&&this.add(i),i}#wo(){const{x:e,y:t,width:s,height:n}=this.div.getBoundingClientRect(),i=Math.max(0,e),a=Math.max(0,t),r=(i+Math.min(window.innerWidth,e+s))/2-e,o=(a+Math.min(window.innerHeight,t+n))/2-t,[l,c]=this.viewport.rotation%180===0?[r,o]:[o,r];return{offsetX:l,offsetY:c}}addNewEditor(){this.createAndAddNewEditor(this.#wo(),!0)}setSelected(e){this.#m.setSelected(e)}toggleSelected(e){this.#m.toggleSelected(e)}unselect(e){this.#m.unselect(e)}pointerup(e){const{isMac:t}=hf.platform;0!==e.button||e.ctrlKey&&t||e.target===this.div&&this.#do&&(this.#do=!1,this.#yo?.isDrawer&&this.#yo.supportMultipleDrawings||(this.#ao?this.#m.getMode()!==lp.STAMP?this.createAndAddNewEditor(e,!1):this.#m.unselectAll():this.#ao=!0))}pointerdown(e){if(this.#m.getMode()===lp.HIGHLIGHT&&this.enableTextSelection(),this.#do)return void(this.#do=!1);const{isMac:t}=hf.platform;if(0!==e.button||e.ctrlKey&&t)return;if(e.target!==this.div)return;if(this.#do=!0,this.#yo?.isDrawer)return void this.startDrawingSession(e);const s=this.#m.getActive();this.#ao=!s||s.isEmpty()}startDrawingSession(e){if(this.div.focus(),this.#po)return void this.#yo.startDrawing(this,this.#m,!1,e);this.#m.setCurrentDrawingSession(this),this.#po=new AbortController;const t=this.#m.combinedSignal(this.#po);this.div.addEventListener("blur",(e=>{let{relatedTarget:t}=e;t&&!this.div.contains(t)&&(this.#fo=null,this.commitOrRemove())}),{signal:t}),this.#yo.startDrawing(this,this.#m,!1,e)}pause(e){if(e){const{activeElement:e}=document;this.div.contains(e)&&(this.#fo=e)}else this.#fo&&setTimeout((()=>{this.#fo?.focus(),this.#fo=null}),0)}endDrawingSession(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.#po?(this.#m.setCurrentDrawingSession(null),this.#po.abort(),this.#po=null,this.#fo=null,this.#yo.endDrawing(e)):null}findNewParent(e,t,s){const n=this.#m.findParent(t,s);return null!==n&&n!==this&&(n.changeParent(e),!0)}commitOrRemove(){return!!this.#po&&(this.endDrawingSession(),!0)}onScaleChanging(){this.#po&&this.#yo.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#m.getActive()?.parent===this&&(this.#m.commitOrRemove(),this.#m.setActiveEditor(null)),this.#lo&&(clearTimeout(this.#lo),this.#lo=null);for(const e of this.#co.values())this.#Ci?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#co.clear(),this.#m.removeLayer(this)}#bo(){for(const e of this.#co.values())e.isEmpty()&&e.remove()}render(e){let{viewport:t}=e;this.viewport=t,Lf(this.div,t);for(const s of this.#m.getEditors(this.pageIndex))this.add(s),s.rebuild();this.updateMode()}update(e){let{viewport:t}=e;this.#m.commitOrRemove(),this.#bo();const s=this.viewport.rotation,n=t.rotation;if(this.viewport=t,Lf(this.div,{rotation:n}),s!==n)for(const i of this.#co.values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#m.viewParameters.realScale}}class Qb{#ai=null;#y=0;#_o=(()=>new Map)();#So=(()=>new Map)();constructor(e){let{pageIndex:t}=e;this.pageIndex=t}setParent(e){if(this.#ai){if(this.#ai!==e){if(this.#_o.size>0)for(const t of this.#_o.values())t.remove(),e.append(t);this.#ai=e}}else this.#ai=e}static get _svgFactory(){return Qp(this,"_svgFactory",new eb)}static#Ao(e,t){let[s,n,i,a]=t;const{style:r}=e;r.top=100*n+"%",r.left=100*s+"%",r.width=100*i+"%",r.height=100*a+"%"}#ko(){const e=Qb._svgFactory.create(1,1,!0);return this.#ai.append(e),e.setAttribute("aria-hidden",!0),e}#Eo(e,t){const s=Qb._svgFactory.createElement("clipPath");e.append(s);const n=`clip_${t}`;s.setAttribute("id",n),s.setAttribute("clipPathUnits","objectBoundingBox");const i=Qb._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),n}#Co(e,t){for(const[s,n]of Object.entries(t))null===n?e.removeAttribute(s):e.setAttribute(s,n)}draw(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.#y++,i=this.#ko(),a=Qb._svgFactory.createElement("defs");i.append(a);const r=Qb._svgFactory.createElement("path");a.append(r);const o=`path_p${this.pageIndex}_${n}`;r.setAttribute("id",o),r.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#So.set(n,r);const l=s?this.#Eo(a,o):null,c=Qb._svgFactory.createElement("use");return i.append(c),c.setAttribute("href",`#${o}`),this.updateProperties(i,e),this.#_o.set(n,i),{id:n,clipPathId:`url(#${l})`}}drawOutline(e,t){const s=this.#y++,n=this.#ko(),i=Qb._svgFactory.createElement("defs");n.append(i);const a=Qb._svgFactory.createElement("path");i.append(a);const r=`path_p${this.pageIndex}_${s}`;let o;if(a.setAttribute("id",r),a.setAttribute("vector-effect","non-scaling-stroke"),t){const e=Qb._svgFactory.createElement("mask");i.append(e),o=`mask_p${this.pageIndex}_${s}`,e.setAttribute("id",o),e.setAttribute("maskUnits","objectBoundingBox");const t=Qb._svgFactory.createElement("rect");e.append(t),t.setAttribute("width","1"),t.setAttribute("height","1"),t.setAttribute("fill","white");const n=Qb._svgFactory.createElement("use");e.append(n),n.setAttribute("href",`#${r}`),n.setAttribute("stroke","none"),n.setAttribute("fill","black"),n.setAttribute("fill-rule","nonzero"),n.classList.add("mask")}const l=Qb._svgFactory.createElement("use");n.append(l),l.setAttribute("href",`#${r}`),o&&l.setAttribute("mask",`url(#${o})`);const c=l.cloneNode();return n.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(n,e),this.#_o.set(s,n),s}finalizeDraw(e,t){this.#So.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:s,bbox:n,rootClass:i,path:a}=t,r="number"===typeof e?this.#_o.get(e):e;if(r){if(s&&this.#Co(r,s),n&&Qb.#Ao(r,n),i){const{classList:e}=r;for(const[t,s]of Object.entries(i))e.toggle(t,s)}if(a){const e=r.firstChild.firstChild;this.#Co(e,a)}}}updateParent(e,t){if(t===this)return;const s=this.#_o.get(e);s&&(t.#ai.append(s),this.#_o.delete(e),t.#_o.set(e,s))}remove(e){this.#So.delete(e),null!==this.#ai&&(this.#_o.get(e).remove(),this.#_o.delete(e))}destroy(){this.#ai=null;for(const e of this.#_o.values())e.remove();this.#_o.clear(),this.#So.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Fb};var Zb=Xu.GlobalWorkerOptions,ev=Xu.getDocument,tv=Xu.version,sv=s(938),nv=s.n(sv);const iv="RFC3986",av={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},rv=(Object.prototype.hasOwnProperty,Array.isArray),ov=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();const lv=1024;function cv(e,t){if(rv(e)){const s=[];for(let n=0;n<e.length;n+=1)s.push(t(e[n]));return s}return t(e)}const dv=Object.prototype.hasOwnProperty,hv={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},uv=Array.isArray,pv=Array.prototype.push,fv=function(e,t){pv.apply(e,uv(t)?t:[t])},mv=Date.prototype.toISOString,gv={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,s,n,i)=>{if(0===e.length)return e;let a=e;if("symbol"===typeof e?a=Symbol.prototype.toString.call(e):"string"!==typeof e&&(a=String(e)),"iso-8859-1"===s)return escape(a).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));let r="";for(let o=0;o<a.length;o+=lv){const e=a.length>=lv?a.slice(o,o+lv):a,t=[];for(let s=0;s<e.length;++s){let n=e.charCodeAt(s);45===n||46===n||95===n||126===n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||"RFC1738"===i&&(40===n||41===n)?t[t.length]=e.charAt(s):n<128?t[t.length]=ov[n]:n<2048?t[t.length]=ov[192|n>>6]+ov[128|63&n]:n<55296||n>=57344?t[t.length]=ov[224|n>>12]+ov[128|n>>6&63]+ov[128|63&n]:(s+=1,n=65536+((1023&n)<<10|1023&e.charCodeAt(s)),t[t.length]=ov[240|n>>18]+ov[128|n>>12&63]+ov[128|n>>6&63]+ov[128|63&n])}r+=t.join("")}return r},encodeValuesOnly:!1,format:iv,formatter:av[iv],indices:!1,serializeDate:e=>mv.call(e),skipNulls:!1,strictNullHandling:!1};const bv={};function vv(e,t,s,n,i,a,r,o,l,c,d,h,u,p,f,m,g,b){let v=e,y=b,x=0,w=!1;for(;void 0!==(y=y.get(bv))&&!w;){const t=y.get(e);if(x+=1,"undefined"!==typeof t){if(t===x)throw new RangeError("Cyclic object value");w=!0}"undefined"===typeof y.get(bv)&&(x=0)}if("function"===typeof c?v=c(t,v):v instanceof Date?v=u?.(v):"comma"===s&&uv(v)&&(v=cv(v,(function(e){return e instanceof Date?u?.(e):e}))),null===v){if(a)return l&&!m?l(t,gv.encoder,g,"key",p):t;v=""}if("string"===typeof(_=v)||"number"===typeof _||"boolean"===typeof _||"symbol"===typeof _||"bigint"===typeof _||function(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}(v)){if(l){const e=m?t:l(t,gv.encoder,g,"key",p);return[f?.(e)+"="+f?.(l(v,gv.encoder,g,"value",p))]}return[f?.(t)+"="+f?.(String(v))]}var _;const S=[];if("undefined"===typeof v)return S;let A;if("comma"===s&&uv(v))m&&l&&(v=cv(v,l)),A=[{value:v.length>0?v.join(",")||null:void 0}];else if(uv(c))A=c;else{const e=Object.keys(v);A=d?e.sort(d):e}const k=o?String(t).replace(/\./g,"%2E"):String(t),E=n&&uv(v)&&1===v.length?k+"[]":k;if(i&&uv(v)&&0===v.length)return E+"[]";for(let C=0;C<A.length;++C){const t=A[C],y="object"===typeof t&&"undefined"!==typeof t.value?t.value:v[t];if(r&&null===y)continue;const w=h&&o?t.replace(/\./g,"%2E"):t,_=uv(v)?"function"===typeof s?s(E,w):E:E+(h?"."+w:"["+w+"]");b.set(e,x);const k=new WeakMap;k.set(bv,b),fv(S,vv(y,_,s,n,i,a,r,o,"comma"===s&&m&&uv(v)?null:l,c,d,h,u,p,f,m,g,k))}return S}function yv(e){let t=e;const s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gv;if("undefined"!==typeof e.allowEmptyArrays&&"boolean"!==typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if("undefined"!==typeof e.encodeDotInKeys&&"boolean"!==typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&"undefined"!==typeof e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");const t=e.charset||gv.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let s=iv;if("undefined"!==typeof e.format){if(!dv.call(av,e.format))throw new TypeError("Unknown format option provided.");s=e.format}const n=av[s];let i,a=gv.filter;if(("function"===typeof e.filter||uv(e.filter))&&(a=e.filter),i=e.arrayFormat&&e.arrayFormat in hv?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":gv.arrayFormat,"commaRoundTrip"in e&&"boolean"!==typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const r="undefined"===typeof e.allowDots?!0===!!e.encodeDotInKeys||gv.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:gv.addQueryPrefix,allowDots:r,allowEmptyArrays:"boolean"===typeof e.allowEmptyArrays?!!e.allowEmptyArrays:gv.allowEmptyArrays,arrayFormat:i,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:gv.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:"undefined"===typeof e.delimiter?gv.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:gv.encode,encodeDotInKeys:"boolean"===typeof e.encodeDotInKeys?e.encodeDotInKeys:gv.encodeDotInKeys,encoder:"function"===typeof e.encoder?e.encoder:gv.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:gv.encodeValuesOnly,filter:a,format:s,formatter:n,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:gv.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:gv.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:gv.strictNullHandling}}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});let n,i;"function"===typeof s.filter?(i=s.filter,t=i("",t)):uv(s.filter)&&(i=s.filter,n=i);const a=[];if("object"!==typeof t||null===t)return"";const r=hv[s.arrayFormat],o="comma"===r&&s.commaRoundTrip;n||(n=Object.keys(t)),s.sort&&n.sort(s.sort);const l=new WeakMap;for(let h=0;h<n.length;++h){const e=n[h];s.skipNulls&&null===t[e]||fv(a,vv(t[e],e,r,o,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,l))}const c=a.join(s.delimiter);let d=!0===s.addQueryPrefix?"?":"";return s.charsetSentinel&&("iso-8859-1"===s.charset?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),c.length>0?d+c:""}const xv="4.87.3";let wv,_v,Sv,Av,kv,Ev,Cv,jv,Nv,Tv=!1,Pv=null,Mv=null,Rv=null,Iv=null;class Dv{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}wv||function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{auto:!1};if(Tv)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(wv)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${wv}'\``);Tv=t.auto,wv=e.kind,_v=e.fetch,Pv=e.Request,Mv=e.Response,Rv=e.Headers,Sv=e.FormData,Iv=e.Blob,Av=e.File,kv=e.ReadableStream,Ev=e.getMultipartRequestOptions,Cv=e.getDefaultAgent,jv=e.fileFromPath,Nv=e.isFsReadStream}(function(){let{manuallyImported:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let s,n,i,a;try{s=fetch,n=Request,i=Response,a=Headers}catch(r){throw new Error(`this environment is missing the following Web Fetch API type: ${r.message}. ${t}`)}return{kind:"web",fetch:s,Request:n,Response:i,Headers:a,FormData:"undefined"!==typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!==typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!==typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:"undefined"!==typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new Dv(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0});class Lv extends Error{}class Ov extends Lv{constructor(e,t,s,n){super(`${Ov.makeMessage(e,t,s)}`),this.status=e,this.headers=n,this.request_id=n?.["x-request-id"],this.error=t;const i=t;this.code=i?.code,this.param=i?.param,this.type=i?.type}static makeMessage(e,t,s){const n=t?.message?"string"===typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,s,n){if(!e||!n)return new zv({message:s,cause:zy(t)});const i=t?.error;return 400===e?new Bv(e,i,s,n):401===e?new Hv(e,i,s,n):403===e?new Uv(e,i,s,n):404===e?new Vv(e,i,s,n):409===e?new Wv(e,i,s,n):422===e?new qv(e,i,s,n):429===e?new Gv(e,i,s,n):e>=500?new Xv(e,i,s,n):new Ov(e,i,s,n)}}class Fv extends Ov{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(void 0,void 0,e||"Request was aborted.",void 0)}}class zv extends Ov{constructor(e){let{message:t,cause:s}=e;super(void 0,void 0,t||"Connection error.",void 0),s&&(this.cause=s)}}class $v extends zv{constructor(){let{message:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super({message:e??"Request timed out."})}}class Bv extends Ov{}class Hv extends Ov{}class Uv extends Ov{}class Vv extends Ov{}class Wv extends Ov{}class qv extends Ov{}class Gv extends Ov{}class Xv extends Ov{}class Yv extends Lv{constructor(){super("Could not parse response content as the length limit was reached")}}class Kv extends Lv{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Jv,Qv=function(e,t,s,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,s):i?i.value=s:t.set(e,s),s},Zv=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};class ey{constructor(){Jv.set(this,void 0),this.buffer=new Uint8Array,Qv(this,Jv,null,"f")}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"===typeof e?(new TextEncoder).encode(e):e;let s=new Uint8Array(this.buffer.length+t.length);s.set(this.buffer),s.set(t,this.buffer.length),this.buffer=s;const n=[];let i;for(;null!=(i=ty(this.buffer,Zv(this,Jv,"f")));){if(i.carriage&&null==Zv(this,Jv,"f")){Qv(this,Jv,i.index,"f");continue}if(null!=Zv(this,Jv,"f")&&(i.index!==Zv(this,Jv,"f")+1||i.carriage)){n.push(this.decodeText(this.buffer.slice(0,Zv(this,Jv,"f")-1))),this.buffer=this.buffer.slice(Zv(this,Jv,"f")),Qv(this,Jv,null,"f");continue}const e=null!==Zv(this,Jv,"f")?i.preceding-1:i.preceding,t=this.decodeText(this.buffer.slice(0,e));n.push(t),this.buffer=this.buffer.slice(i.index),Qv(this,Jv,null,"f")}return n}decodeText(e){if(null==e)return"";if("string"===typeof e)return e;if("undefined"!==typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Lv(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!==typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Lv(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Lv("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function ty(e,t){for(let s=t??0;s<e.length;s++){if(10===e[s])return{preceding:s,index:s+1,carriage:!1};if(13===e[s])return{preceding:s,index:s+1,carriage:!0}}return null}function sy(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}function ny(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch(zS){throw t.releaseLock(),zS}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}Jv=new WeakMap,ey.NEWLINE_CHARS=new Set(["\n","\r"]),ey.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class iy{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let s=!1;return new iy((async function*(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let n=!1;try{for await(const s of async function*(e,t){if(!e.body)throw t.abort(),new Lv("Attempted to iterate over a response with no body");const s=new ay,n=new ey,i=ny(e.body);for await(const a of async function*(e){let t=new Uint8Array;for await(const s of e){if(null==s)continue;const e=s instanceof ArrayBuffer?new Uint8Array(s):"string"===typeof s?(new TextEncoder).encode(s):s;let n,i=new Uint8Array(t.length+e.length);for(i.set(t),i.set(e,t.length),t=i;-1!==(n=sy(t));)yield t.slice(0,n),t=t.slice(n)}t.length>0&&(yield t)}(i))for(const e of n.decode(a)){const t=s.decode(e);t&&(yield t)}for(const a of n.flush()){const e=s.decode(a);e&&(yield e)}}(e,t))if(!n)if(s.data.startsWith("[DONE]"))n=!0;else if(null===s.event||s.event.startsWith("response.")){let e;try{e=JSON.parse(s.data)}catch(zS){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),zS}if(e&&e.error)throw new Ov(void 0,e.error,void 0,void 0);yield e}else{let e;try{e=JSON.parse(s.data)}catch(zS){throw console.error("Could not parse message into JSON:",s.data),console.error("From chunk:",s.raw),zS}if("error"==s.event)throw new Ov(void 0,e.error,e.message,void 0);yield{event:s.event,data:e}}n=!0}catch(zS){if(zS instanceof Error&&"AbortError"===zS.name)return;throw zS}finally{n||t.abort()}}),t)}static fromReadableStream(e,t){let s=!1;return new iy((async function*(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let n=!1;try{for await(const t of async function*(){const t=new ey,s=ny(e);for await(const e of s)for(const s of t.decode(e))yield s;for(const e of t.flush())yield e}())n||t&&(yield JSON.parse(t));n=!0}catch(zS){if(zS instanceof Error&&"AbortError"===zS.name)return;throw zS}finally{n||t.abort()}}),t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],s=this.iterator(),n=n=>({next:()=>{if(0===n.length){const n=s.next();e.push(n),t.push(n)}return n.shift()}});return[new iy((()=>n(e)),this.controller),new iy((()=>n(t)),this.controller)]}toReadableStream(){const e=this;let t;const s=new TextEncoder;return new kv({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:n,done:i}=await t.next();if(i)return e.close();const a=s.encode(JSON.stringify(n)+"\n");e.enqueue(a)}catch(n){e.error(n)}},async cancel(){await(t.return?.())}})}}class ay{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,s,n]=function(e,t){const s=e.indexOf(t);if(-1!==s)return[e.substring(0,s),t,e.substring(s+t.length)];return[e,"",""]}(e,":");return n.startsWith(" ")&&(n=n.substring(1)),"event"===t?this.event=n:"data"===t&&this.data.push(n),null}}const ry=e=>null!=e&&"object"===typeof e&&"string"===typeof e.url&&"function"===typeof e.blob,oy=e=>null!=e&&"object"===typeof e&&"string"===typeof e.name&&"number"===typeof e.lastModified&&ly(e),ly=e=>null!=e&&"object"===typeof e&&"number"===typeof e.size&&"string"===typeof e.type&&"function"===typeof e.text&&"function"===typeof e.slice&&"function"===typeof e.arrayBuffer,cy=e=>oy(e)||ry(e)||Nv(e);async function dy(e,t,s){if(e=await e,oy(e))return e;if(ry(e)){const n=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=ly(n)?[await n.arrayBuffer()]:[n];return new Av(i,t,s)}const n=await async function(e){let t=[];if("string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(ly(e))t.push(await e.arrayBuffer());else{if(!uy(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}(e)}`);for await(const s of e)t.push(s)}return t}(e);if(t||(t=function(e){return hy(e.name)||hy(e.filename)||hy(e.path)?.split(/[\\/]/).pop()}(e)??"unknown_file"),!s?.type){const e=n[0]?.type;"string"===typeof e&&(s={...s,type:e})}return new Av(n,t,s)}const hy=e=>"string"===typeof e?e:"undefined"!==typeof Buffer&&e instanceof Buffer?String(e):void 0,uy=e=>null!=e&&"object"===typeof e&&"function"===typeof e[Symbol.asyncIterator],py=e=>e&&"object"===typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],fy=async e=>{const t=await my(e.body);return Ev(t,e)},my=async e=>{const t=new Sv;return await Promise.all(Object.entries(e||{}).map((e=>{let[s,n]=e;return gy(t,s,n)}))),t},gy=async(e,t,s)=>{if(void 0!==s){if(null==s)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"===typeof s||"number"===typeof s||"boolean"===typeof s)e.append(t,String(s));else if(cy(s)){const n=await dy(s);e.append(t,n)}else if(Array.isArray(s))await Promise.all(s.map((s=>gy(e,t+"[]",s))));else{if("object"!==typeof s)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`);await Promise.all(Object.entries(s).map((s=>{let[n,i]=s;return gy(e,`${t}[${n}]`,i)})))}}};var by,vy=function(e,t,s,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,s):i?i.value=s:t.set(e,s),s},yy=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};async function xy(e){const{response:t}=e;if(e.options.stream)return Wy("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):iy.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const s=t.headers.get("content-type"),n=s?.split(";")[0]?.trim();if(n?.includes("application/json")||n?.endsWith("+json")){const e=await t.json();return Wy("response",t.status,t.url,t.headers,e),wy(e,t)}const i=await t.text();return Wy("response",t.status,t.url,t.headers,i),i}function wy(e,t){return!e||"object"!==typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class _y extends Promise{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:xy;super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new _y(this.responsePromise,(async t=>wy(e(await this.parseResponse(t),t),t.response)))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Sy{constructor(e){let{baseURL:t,maxRetries:s=2,timeout:n=6e5,httpAgent:i,fetch:a}=e;this.baseURL=t,this.maxRetries=Fy("maxRetries",s),this.timeout=Fy("timeout",n),this.httpAgent=i,this.fetch=a??_v}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Ry(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${qy()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then((async s=>{const n=s&&ly(s?.body)?new DataView(await s.body.arrayBuffer()):s?.body instanceof DataView?s.body:s?.body instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s?.body)?new DataView(s.body.buffer):s?.body;return{method:e,path:t,...s,body:n}})))}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}calculateContentLength(e){if("string"===typeof e){if("undefined"!==typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!==typeof TextEncoder){return(new TextEncoder).encode(e).length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){let{retryCount:t=0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e={...e};const{method:s,path:n,query:i,headers:a={}}=e,r=ArrayBuffer.isView(e.body)||e.__binaryRequest&&"string"===typeof e.body?e.body:py(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(r),l=this.buildURL(n,i);"timeout"in e&&Fy("timeout",e.timeout),e.timeout=e.timeout??this.timeout;const c=e.httpAgent??this.httpAgent??Cv(l),d=e.timeout+1e3;"number"===typeof c?.options?.timeout&&d>(c.options.timeout??0)&&(c.options.timeout=d),this.idempotencyHeader&&"get"!==s&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);return{req:{method:s,...r&&{body:r},headers:this.buildHeaders({options:e,headers:a,contentLength:o,retryCount:t}),...c&&{agent:c},signal:e.signal??null},url:l,timeout:e.timeout}}buildHeaders(e){let{options:t,headers:s,contentLength:n,retryCount:i}=e;const a={};n&&(a["content-length"]=n);const r=this.defaultHeaders(t);return Uy(a,r),Uy(a,s),py(t.body)&&"node"!==wv&&delete a["content-type"],void 0===Gy(r,"x-stainless-retry-count")&&void 0===Gy(s,"x-stainless-retry-count")&&(a["x-stainless-retry-count"]=String(i)),void 0===Gy(r,"x-stainless-timeout")&&void 0===Gy(s,"x-stainless-timeout")&&t.timeout&&(a["x-stainless-timeout"]=String(t.timeout)),this.validateHeaders(a,s),a}async prepareOptions(e){}async prepareRequest(e,t){let{url:s,options:n}=t}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,s,n){return Ov.generate(e,t,s,n)}request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new _y(this.makeRequest(e,t))}async makeRequest(e,t){const s=await e,n=s.maxRetries??this.maxRetries;null==t&&(t=n),await this.prepareOptions(s);const{req:i,url:a,timeout:r}=this.buildRequest(s,{retryCount:n-t});if(await this.prepareRequest(i,{url:a,options:s}),Wy("request",a,s,i.headers),s.signal?.aborted)throw new Fv;const o=new AbortController,l=await this.fetchWithTimeout(a,i,r,o).catch(zy);if(l instanceof Error){if(s.signal?.aborted)throw new Fv;if(t)return this.retryRequest(s,t);if("AbortError"===l.name)throw new $v;throw new zv({cause:l})}const c=Ey(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){return Wy(`response (error; ${`retrying, ${t} attempts remaining`})`,l.status,a,c),this.retryRequest(s,t,c)}const e=await l.text().catch((e=>zy(e).message)),n=Iy(e),i=n?void 0:e;Wy(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,a,c,i);throw this.makeStatusError(l.status,n,i,c)}return{response:l,options:s,controller:o}}requestAPIList(e,t){const s=this.makeRequest(t,null);return new ky(this,s,e)}buildURL(e,t){const s=Ly(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),n=this.defaultQuery();return By(n)||(t={...n,...t}),"object"===typeof t&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}stringifyQuery(e){return Object.entries(e).filter((e=>{let[t,s]=e;return"undefined"!==typeof s})).map((e=>{let[t,s]=e;if("string"===typeof s||"number"===typeof s||"boolean"===typeof s)return`${encodeURIComponent(t)}=${encodeURIComponent(s)}`;if(null===s)return`${encodeURIComponent(t)}=`;throw new Lv(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,s,n){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",(()=>n.abort()));const r=setTimeout((()=>n.abort()),s),o={signal:n.signal,...a};return o.method&&(o.method=o.method.toUpperCase()),this.fetch.call(void 0,e,o).finally((()=>{clearTimeout(r)}))}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,s){let n;const i=s?.["retry-after-ms"];if(i){const e=parseFloat(i);Number.isNaN(e)||(n=e)}const a=s?.["retry-after"];if(a&&!n){const e=parseFloat(a);n=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}if(!(n&&0<=n&&n<6e4)){const s=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,s)}return await Oy(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e;return Math.min(.5*Math.pow(2,s),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${xv}`}}class Ay{constructor(e,t,s,n){by.set(this,void 0),vy(this,by,e,"f"),this.options=n,this.response=t,this.body=s}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Lv("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&"object"===typeof t.query)t.query={...t.query,...e.params};else if("url"in e){const s=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,n]of s)e.url.searchParams.set(t,n);t.query=void 0,t.path=e.url.toString()}return await yy(this,by,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(by=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class ky extends _y{constructor(e,t,s){super(t,(async t=>new s(e,t.response,await xy(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const Ey=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const s=t.toString();return e[s.toLowerCase()]||e[s]}}),Cy={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},jy=e=>"object"===typeof e&&null!==e&&!By(e)&&Object.keys(e).every((e=>Hy(Cy,e))),Ny=()=>{if("undefined"!==typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xv,"X-Stainless-OS":Py(Deno.build.os),"X-Stainless-Arch":Ty(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"===typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!==typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xv,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xv,"X-Stainless-OS":Py(process.platform),"X-Stainless-Arch":Ty(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=function(){if("undefined"===typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:s}of e){const e=s.exec(navigator.userAgent);if(e){return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xv,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xv,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const Ty=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",Py=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let My;const Ry=()=>My??(My=Ny()),Iy=e=>{try{return JSON.parse(e)}catch(t){return}},Dy=/^[a-z][a-z0-9+.-]*:/i,Ly=e=>Dy.test(e),Oy=e=>new Promise((t=>setTimeout(t,e))),Fy=(e,t)=>{if("number"!==typeof t||!Number.isInteger(t))throw new Lv(`${e} must be an integer`);if(t<0)throw new Lv(`${e} must be a positive integer`);return t},zy=e=>{if(e instanceof Error)return e;if("object"===typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},$y=e=>"undefined"!==typeof process?{NODE_ENV:"production",PUBLIC_URL:"/DiGiHealthAdv",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_OPENAI_API_KEY:"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",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ",REACT_APP_SUPABASE_URL:"https://aqdzmfhakqdwquszaqle.supabase.co"}?.[e]?.trim()??void 0:"undefined"!==typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function By(e){if(!e)return!0;for(const t in e)return!1;return!0}function Hy(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Uy(e,t){for(const s in t){if(!Hy(t,s))continue;const n=s.toLowerCase();if(!n)continue;const i=t[s];null===i?delete e[n]:void 0!==i&&(e[n]=i)}}const Vy=new Set(["authorization","api-key"]);function Wy(e){if("undefined"!==typeof process&&"true"==={NODE_ENV:"production",PUBLIC_URL:"/DiGiHealthAdv",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_OPENAI_API_KEY:"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",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ",REACT_APP_SUPABASE_URL:"https://aqdzmfhakqdwquszaqle.supabase.co"}?.DEBUG){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];const i=s.map((e=>{if(!e)return e;if(e.headers){const t={...e,headers:{...e.headers}};for(const s in e.headers)Vy.has(s.toLowerCase())&&(t.headers[s]="REDACTED");return t}let t=null;for(const s in e)Vy.has(s.toLowerCase())&&(t??(t={...e}),t[s]="REDACTED");return t??e}));console.log(`OpenAI:DEBUG:${e}`,...i)}}const qy=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),Gy=(e,t)=>{const s=t.toLowerCase();if((e=>"function"===typeof e?.get)(e)){const n=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,((e,t,s)=>t+s.toUpperCase()));for(const i of[t,s,t.toUpperCase(),n]){const t=e.get(i);if(t)return t}}for(const[n,i]of Object.entries(e))if(n.toLowerCase()===s)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${t} header, using the first entry.`),i[0]):i};function Xy(e){return null!=e&&"object"===typeof e&&!Array.isArray(e)}class Yy{constructor(e){this._client=e}}class Ky extends Yy{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Jy extends Yy{list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jy(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,sx,{query:t,...s})}}class Qy extends Ay{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Zy extends Ay{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class ex extends Yy{constructor(){super(...arguments),this.messages=new Jy(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,s){return this._client.post(`/chat/completions/${e}`,{body:t,...s})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return jy(e)?this.list({},e):this._client.getAPIList("/chat/completions",tx,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}}class tx extends Zy{}class sx extends Zy{}ex.ChatCompletionsPage=tx,ex.Messages=Jy;class nx extends Yy{constructor(){super(...arguments),this.completions=new ex(this._client)}}nx.Completions=ex,nx.ChatCompletionsPage=tx;class ix extends Yy{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class ax extends Yy{create(e,t){return this._client.post("/files",fy({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return jy(e)?this.list({},e):this._client.getAPIList("/files",rx,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e){let{pollInterval:t=5e3,maxWait:s=18e5}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!n.has(a.status);)if(await Oy(t),a=await this.retrieve(e),Date.now()-i>s)throw new $v({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return a}}class rx extends Zy{}ax.FileObjectsPage=rx;class ox extends Yy{createVariation(e,t){return this._client.post("/images/variations",fy({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",fy({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class lx extends Yy{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}class cx extends Yy{create(e,t){return this._client.post("/audio/transcriptions",fy({body:e,...t,__metadata:{model:e.model}}))}}class dx extends Yy{create(e,t){return this._client.post("/audio/translations",fy({body:e,...t,__metadata:{model:e.model}}))}}class hx extends Yy{constructor(){super(...arguments),this.transcriptions=new cx(this._client),this.translations=new dx(this._client),this.speech=new lx(this._client)}}hx.Transcriptions=cx,hx.Translations=dx,hx.Speech=lx;class ux extends Yy{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class px extends Yy{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",fx,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class fx extends Qy{}px.ModelsPage=fx;class mx extends Yy{list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jy(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,gx,{query:t,...s})}}class gx extends Zy{}mx.FineTuningJobCheckpointsPage=gx;class bx extends Yy{constructor(){super(...arguments),this.checkpoints=new mx(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return jy(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",vx,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jy(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,yx,{query:t,...s})}}class vx extends Zy{}class yx extends Zy{}bx.FineTuningJobsPage=vx,bx.FineTuningJobEventsPage=yx,bx.Checkpoints=mx,bx.FineTuningJobCheckpointsPage=gx;class xx extends Yy{constructor(){super(...arguments),this.jobs=new bx(this._client)}}xx.Jobs=bx,xx.FineTuningJobsPage=vx,xx.FineTuningJobEventsPage=yx;class wx extends Yy{create(e,t,s){return this._client.post(`/vector_stores/${e}/files`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jy(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,_x,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t,s){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,{...s,headers:n}).withResponse(),a=i.data;switch(a.status){case"in_progress":let e=5e3;if(s?.pollIntervalMs)e=s.pollIntervalMs;else{const t=i.response.headers.get("openai-poll-after-ms");if(t){const s=parseInt(t);isNaN(s)||(e=s)}}await Oy(e);break;case"failed":case"completed":return a}}}async upload(e,t,s){const n=await this._client.files.create({file:t,purpose:"assistants"},s);return this.create(e,{file_id:n.id},s)}async uploadAndPoll(e,t,s){const n=await this.upload(e,t,s);return await this.poll(e,n.id,s)}content(e,t,s){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,Sx,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}}class _x extends Zy{}class Sx extends Qy{}wx.VectorStoreFilesPage=_x,wx.FileContentResponsesPage=Sx;class Ax extends Yy{create(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}cancel(e,t,s){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t);return await this.poll(e,n.id,s)}listFiles(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;return jy(s)?this.listFiles(e,t,{},s):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,_x,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...s,headers:n}).withResponse();switch(i.status){case"in_progress":let e=5e3;if(s?.pollIntervalMs)e=s.pollIntervalMs;else{const t=a.headers.get("openai-poll-after-ms");if(t){const s=parseInt(t);isNaN(s)||(e=s)}}await Oy(e);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,t,s){let{files:n,fileIds:i=[]}=t;if(null==n||0==n.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=s?.maxConcurrency??5,r=Math.min(a,n.length),o=this._client,l=n.values(),c=[...i];const d=Array(r).fill(l).map((async function(e){for(let t of e){const e=await o.files.create({file:t,purpose:"assistants"},s);c.push(e.id)}}));return await(async e=>{const t=await Promise.allSettled(e),s=t.filter((e=>"rejected"===e.status));if(s.length){for(const e of s)console.error(e.reason);throw new Error(`${s.length} promise(s) failed - see the above errors`)}const n=[];for(const i of t)"fulfilled"===i.status&&n.push(i.value);return n})(d),await this.createAndPoll(e,{file_ids:c})}}class kx extends Yy{constructor(){super(...arguments),this.files=new wx(this._client),this.fileBatches=new Ax(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/vector_stores/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return jy(e)?this.list({},e):this._client.getAPIList("/vector_stores",Ex,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,s){return this._client.getAPIList(`/vector_stores/${e}/search`,Cx,{body:t,method:"post",...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}}class Ex extends Zy{}class Cx extends Qy{}kx.VectorStoresPage=Ex,kx.VectorStoreSearchResponsesPage=Cx,kx.Files=wx,kx.VectorStoreFilesPage=_x,kx.FileContentResponsesPage=Sx,kx.FileBatches=Ax;class jx extends Yy{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/assistants/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return jy(e)?this.list({},e):this._client.getAPIList("/assistants",Nx,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class Nx extends Zy{}function Tx(e){return"function"===typeof e.parse}jx.AssistantsPage=Nx;const Px=e=>"assistant"===e?.role,Mx=e=>"function"===e?.role,Rx=e=>"tool"===e?.role;var Ix,Dx,Lx,Ox,Fx,zx,$x,Bx,Hx,Ux,Vx,Wx,qx,Gx=function(e,t,s,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,s):i?i.value=s:t.set(e,s),s},Xx=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};class Yx{constructor(){Ix.add(this),this.controller=new AbortController,Dx.set(this,void 0),Lx.set(this,(()=>{})),Ox.set(this,(()=>{})),Fx.set(this,void 0),zx.set(this,(()=>{})),$x.set(this,(()=>{})),Bx.set(this,{}),Hx.set(this,!1),Ux.set(this,!1),Vx.set(this,!1),Wx.set(this,!1),Gx(this,Dx,new Promise(((e,t)=>{Gx(this,Lx,e,"f"),Gx(this,Ox,t,"f")})),"f"),Gx(this,Fx,new Promise(((e,t)=>{Gx(this,zx,e,"f"),Gx(this,$x,t,"f")})),"f"),Xx(this,Dx,"f").catch((()=>{})),Xx(this,Fx,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal(),this._emit("end")}),Xx(this,Ix,"m",qx).bind(this))}),0)}_connected(){this.ended||(Xx(this,Lx,"f").call(this),this._emit("connect"))}get ended(){return Xx(this,Hx,"f")}get errored(){return Xx(this,Ux,"f")}get aborted(){return Xx(this,Vx,"f")}abort(){this.controller.abort()}on(e,t){return(Xx(this,Bx,"f")[e]||(Xx(this,Bx,"f")[e]=[])).push({listener:t}),this}off(e,t){const s=Xx(this,Bx,"f")[e];if(!s)return this;const n=s.findIndex((e=>e.listener===t));return n>=0&&s.splice(n,1),this}once(e,t){return(Xx(this,Bx,"f")[e]||(Xx(this,Bx,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,s)=>{Gx(this,Wx,!0,"f"),"error"!==e&&this.once("error",s),this.once(e,t)}))}async done(){Gx(this,Wx,!0,"f"),await Xx(this,Fx,"f")}_emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];if(Xx(this,Hx,"f"))return;"end"===e&&(Gx(this,Hx,!0,"f"),Xx(this,zx,"f").call(this));const i=Xx(this,Bx,"f")[e];if(i&&(Xx(this,Bx,"f")[e]=i.filter((e=>!e.once)),i.forEach((e=>{let{listener:t}=e;return t(...s)}))),"abort"===e){const e=s[0];return Xx(this,Wx,"f")||i?.length||Promise.reject(e),Xx(this,Ox,"f").call(this,e),Xx(this,$x,"f").call(this,e),void this._emit("end")}if("error"===e){const e=s[0];Xx(this,Wx,"f")||i?.length||Promise.reject(e),Xx(this,Ox,"f").call(this,e),Xx(this,$x,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function Kx(e){return"auto-parseable-response-format"===e?.$brand}function Jx(e){return"auto-parseable-tool"===e?.$brand}function Qx(e,t){const s=e.choices.map((e=>{if("length"===e.finish_reason)throw new Yv;if("content_filter"===e.finish_reason)throw new Kv;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map((e=>function(e,t){const s=e.tools?.find((e=>e.function?.name===t.function.name));return{...t,function:{...t.function,parsed_arguments:Jx(s)?s.$parseRaw(t.function.arguments):s?.function.strict?JSON.parse(t.function.arguments):null}}}(t,e)))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?Zx(t,e.message.content):null}}}));return{...e,choices:s}}function Zx(e,t){if("json_schema"!==e.response_format?.type)return null;if("json_schema"===e.response_format?.type){if("$parseRaw"in e.response_format){return e.response_format.$parseRaw(t)}return JSON.parse(t)}return null}function ew(e,t){if(!e)return!1;const s=e.tools?.find((e=>e.function?.name===t.function.name));return Jx(s)||s?.function.strict||!1}function tw(e){return!!Kx(e.response_format)||(e.tools?.some((e=>Jx(e)||"function"===e.type&&!0===e.function.strict))??!1)}Dx=new WeakMap,Lx=new WeakMap,Ox=new WeakMap,Fx=new WeakMap,zx=new WeakMap,$x=new WeakMap,Bx=new WeakMap,Hx=new WeakMap,Ux=new WeakMap,Vx=new WeakMap,Wx=new WeakMap,Ix=new WeakSet,qx=function(e){if(Gx(this,Ux,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new Fv),e instanceof Fv)return Gx(this,Vx,!0,"f"),this._emit("abort",e);if(e instanceof Lv)return this._emit("error",e);if(e instanceof Error){const t=new Lv(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new Lv(String(e)))};var sw,nw,iw,aw,rw,ow,lw,cw,dw=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};const hw=10;class uw extends Yx{constructor(){super(...arguments),sw.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(Mx(e)||Rx(e))&&e.content)this._emit("functionCallResult",e.content);else if(Px(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Px(e)&&e.tool_calls)for(const s of e.tool_calls)"function"===s.type&&this._emit("functionCall",s.function)}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Lv("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),dw(this,sw,"m",nw).call(this)}async finalMessage(){return await this.done(),dw(this,sw,"m",iw).call(this)}async finalFunctionCall(){return await this.done(),dw(this,sw,"m",aw).call(this)}async finalFunctionCallResult(){return await this.done(),dw(this,sw,"m",rw).call(this)}async totalUsage(){return await this.done(),dw(this,sw,"m",ow).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=dw(this,sw,"m",iw).call(this);t&&this._emit("finalMessage",t);const s=dw(this,sw,"m",nw).call(this);s&&this._emit("finalContent",s);const n=dw(this,sw,"m",aw).call(this);n&&this._emit("finalFunctionCall",n);const i=dw(this,sw,"m",rw).call(this);null!=i&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some((e=>e.usage))&&this._emit("totalUsage",dw(this,sw,"m",ow).call(this))}async _createChatCompletion(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),dw(this,sw,"m",lw).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Qx(i,t))}async _runChatCompletion(e,t,s){for(const n of t.messages)this._addMessage(n,!1);return await this._createChatCompletion(e,t,s)}async _runFunctions(e,t,s){const n="function",{function_call:i="auto",stream:a,...r}=t,o="string"!==typeof i&&i?.name,{maxChatCompletions:l=hw}=s||{},c={};for(const u of t.functions)c[u.name||u.function.name]=u;const d=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const u of t.messages)this._addMessage(u,!1);for(let u=0;u<l;++u){const t=await this._createChatCompletion(e,{...r,function_call:i,functions:d,messages:[...this.messages]},s),a=t.choices[0]?.message;if(!a)throw new Lv("missing message in ChatCompletion response");if(!a.function_call)return;const{name:l,arguments:u}=a.function_call,p=c[l];if(!p){const e=`Invalid function_call: ${JSON.stringify(l)}. Available options are: ${d.map((e=>JSON.stringify(e.name))).join(", ")}. Please try again`;this._addMessage({role:n,name:l,content:e});continue}if(o&&o!==l){const e=`Invalid function_call: ${JSON.stringify(l)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:n,name:l,content:e});continue}let f;try{f=Tx(p)?await p.parse(u):u}catch(h){this._addMessage({role:n,name:l,content:h instanceof Error?h.message:String(h)});continue}const m=await p.function(f,this),g=dw(this,sw,"m",cw).call(this,m);if(this._addMessage({role:n,name:l,content:g}),o)return}}async _runTools(e,t,s){const n="tool",{tool_choice:i="auto",stream:a,...r}=t,o="string"!==typeof i&&i?.function?.name,{maxChatCompletions:l=hw}=s||{},c=t.tools.map((e=>{if(Jx(e)){if(!e.$callback)throw new Lv("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e})),d={};for(const p of c)"function"===p.type&&(d[p.function.name||p.function.function.name]=p.function);const h="tools"in t?c.map((e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e)):void 0;for(const p of t.messages)this._addMessage(p,!1);for(let p=0;p<l;++p){const t=await this._createChatCompletion(e,{...r,tool_choice:i,tools:h,messages:[...this.messages]},s),a=t.choices[0]?.message;if(!a)throw new Lv("missing message in ChatCompletion response");if(!a.tool_calls?.length)return;for(const e of a.tool_calls){if("function"!==e.type)continue;const t=e.id,{name:s,arguments:i}=e.function,a=d[s];if(!a){const e=`Invalid tool_call: ${JSON.stringify(s)}. Available options are: ${Object.keys(d).map((e=>JSON.stringify(e))).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:t,content:e});continue}if(o&&o!==s){const e=`Invalid tool_call: ${JSON.stringify(s)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:n,tool_call_id:t,content:e});continue}let r;try{r=Tx(a)?await a.parse(i):i}catch(u){const e=u instanceof Error?u.message:String(u);this._addMessage({role:n,tool_call_id:t,content:e});continue}const l=await a.function(r,this),c=dw(this,sw,"m",cw).call(this,l);if(this._addMessage({role:n,tool_call_id:t,content:c}),o)return}}}}sw=new WeakSet,nw=function(){return dw(this,sw,"m",iw).call(this).content??null},iw=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Px(t)){const{function_call:e,...s}=t,n={...s,content:t.content??null,refusal:t.refusal??null};return e&&(n.function_call=e),n}}throw new Lv("stream ended without producing a ChatCompletionMessage with role=assistant")},aw=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Px(t)&&t?.function_call)return t.function_call;if(Px(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},rw=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Mx(t)&&null!=t.content)return t.content;if(Rx(t)&&null!=t.content&&"string"===typeof t.content&&this.messages.some((e=>"assistant"===e.role&&e.tool_calls?.some((e=>"function"===e.type&&e.id===t.tool_call_id)))))return t.content}},ow=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},lw=function(e){if(null!=e.n&&e.n>1)throw new Lv("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},cw=function(e){return"string"===typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class pw extends uw{static runFunctions(e,t,s){const n=new pw,i={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run((()=>n._runFunctions(e,t,i))),n}static runTools(e,t,s){const n=new pw,i={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run((()=>n._runTools(e,t,i))),n}_addMessage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super._addMessage(e,t),Px(e)&&e.content&&this._emit("content",e.content)}}const fw={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,SPECIAL:496,ATOM:499,COLLECTION:12,ALL:511};class mw extends Error{}class gw extends Error{}const bw=(e,t)=>{const s=e.length;let n=0;const i=e=>{throw new mw(`${e} at position ${n}`)},a=e=>{throw new gw(`${e} at position ${n}`)},r=()=>(h(),n>=s&&i("Unexpected end of input"),'"'===e[n]?o():"{"===e[n]?l():"["===e[n]?c():"null"===e.substring(n,n+4)||fw.NULL&t&&s-n<4&&"null".startsWith(e.substring(n))?(n+=4,null):"true"===e.substring(n,n+4)||fw.BOOL&t&&s-n<4&&"true".startsWith(e.substring(n))?(n+=4,!0):"false"===e.substring(n,n+5)||fw.BOOL&t&&s-n<5&&"false".startsWith(e.substring(n))?(n+=5,!1):"Infinity"===e.substring(n,n+8)||fw.INFINITY&t&&s-n<8&&"Infinity".startsWith(e.substring(n))?(n+=8,1/0):"-Infinity"===e.substring(n,n+9)||fw.MINUS_INFINITY&t&&1<s-n&&s-n<9&&"-Infinity".startsWith(e.substring(n))?(n+=9,-1/0):"NaN"===e.substring(n,n+3)||fw.NAN&t&&s-n<3&&"NaN".startsWith(e.substring(n))?(n+=3,NaN):d()),o=()=>{const r=n;let o=!1;for(n++;n<s&&('"'!==e[n]||o&&"\\"===e[n-1]);)o="\\"===e[n]&&!o,n++;if('"'==e.charAt(n))try{return JSON.parse(e.substring(r,++n-Number(o)))}catch(zS){a(String(zS))}else if(fw.STR&t)try{return JSON.parse(e.substring(r,n-Number(o))+'"')}catch(zS){return JSON.parse(e.substring(r,e.lastIndexOf("\\"))+'"')}i("Unterminated string literal")},l=()=>{n++,h();const a={};try{for(;"}"!==e[n];){if(h(),n>=s&&fw.OBJ&t)return a;const i=o();h(),n++;try{const e=r();Object.defineProperty(a,i,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(zS){if(fw.OBJ&t)return a;throw zS}h(),","===e[n]&&n++}}catch(zS){if(fw.OBJ&t)return a;i("Expected '}' at end of object")}return n++,a},c=()=>{n++;const s=[];try{for(;"]"!==e[n];)s.push(r()),h(),","===e[n]&&n++}catch(zS){if(fw.ARR&t)return s;i("Expected ']' at end of array")}return n++,s},d=()=>{if(0===n){"-"===e&&fw.NUM&t&&i("Not sure what '-' is");try{return JSON.parse(e)}catch(zS){if(fw.NUM&t)try{return"."===e[e.length-1]?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(zS){}a(String(zS))}}const r=n;for("-"===e[n]&&n++;e[n]&&!",]}".includes(e[n]);)n++;n!=s||fw.NUM&t||i("Unterminated number literal");try{return JSON.parse(e.substring(r,n))}catch(zS){"-"===e.substring(r,n)&&fw.NUM&t&&i("Not sure what '-' is");try{return JSON.parse(e.substring(r,e.lastIndexOf("e")))}catch(zS){a(String(zS))}}},h=()=>{for(;n<s&&" \n\r\t".includes(e[n]);)n++};return r()},vw=e=>function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fw.ALL;if("string"!==typeof e)throw new TypeError("expecting str, got "+typeof e);if(!e.trim())throw new Error(`${e} is empty`);return bw(e.trim(),t)}(e,fw.ALL^fw.NUM);var yw,xw,ww,_w,Sw,Aw,kw,Ew,Cw,jw,Nw,Tw,Pw=function(e,t,s,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,s):i?i.value=s:t.set(e,s),s},Mw=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};class Rw extends uw{constructor(e){super(),yw.add(this),xw.set(this,void 0),ww.set(this,void 0),_w.set(this,void 0),Pw(this,xw,e,"f"),Pw(this,ww,[],"f")}get currentChatCompletionSnapshot(){return Mw(this,_w,"f")}static fromReadableStream(e){const t=new Rw(null);return t._run((()=>t._fromReadableStream(e))),t}static createChatCompletion(e,t,s){const n=new Rw(t);return n._run((()=>n._runChatCompletion(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}}))),n}async _createChatCompletion(e,t,s){super._createChatCompletion;const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),Mw(this,yw,"m",Sw).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const a of i)Mw(this,yw,"m",kw).call(this,a);if(i.controller.signal?.aborted)throw new Fv;return this._addChatCompletion(Mw(this,yw,"m",jw).call(this))}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),Mw(this,yw,"m",Sw).call(this),this._connected();const n=iy.fromReadableStream(e,this.controller);let i;for await(const a of n)i&&i!==a.id&&this._addChatCompletion(Mw(this,yw,"m",jw).call(this)),Mw(this,yw,"m",kw).call(this,a),i=a.id;if(n.controller.signal?.aborted)throw new Fv;return this._addChatCompletion(Mw(this,yw,"m",jw).call(this))}[(xw=new WeakMap,ww=new WeakMap,_w=new WeakMap,yw=new WeakSet,Sw=function(){this.ended||Pw(this,_w,void 0,"f")},Aw=function(e){let t=Mw(this,ww,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Mw(this,ww,"f")[e.index]=t,t)},kw=function(e){if(this.ended)return;const t=Mw(this,yw,"m",Tw).call(this,e);this._emit("chunk",e,t);for(const s of e.choices){const e=t.choices[s.index];null!=s.delta.content&&"assistant"===e.message?.role&&e.message?.content&&(this._emit("content",s.delta.content,e.message.content),this._emit("content.delta",{delta:s.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=s.delta.refusal&&"assistant"===e.message?.role&&e.message?.refusal&&this._emit("refusal.delta",{delta:s.delta.refusal,snapshot:e.message.refusal}),null!=s.logprobs?.content&&"assistant"===e.message?.role&&this._emit("logprobs.content.delta",{content:s.logprobs?.content,snapshot:e.logprobs?.content??[]}),null!=s.logprobs?.refusal&&"assistant"===e.message?.role&&this._emit("logprobs.refusal.delta",{refusal:s.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});const n=Mw(this,yw,"m",Aw).call(this,e);e.finish_reason&&(Mw(this,yw,"m",Cw).call(this,e),null!=n.current_tool_call_index&&Mw(this,yw,"m",Ew).call(this,e,n.current_tool_call_index));for(const t of s.delta.tool_calls??[])n.current_tool_call_index!==t.index&&(Mw(this,yw,"m",Cw).call(this,e),null!=n.current_tool_call_index&&Mw(this,yw,"m",Ew).call(this,e,n.current_tool_call_index)),n.current_tool_call_index=t.index;for(const t of s.delta.tool_calls??[]){const s=e.message.tool_calls?.[t.index];s?.type&&("function"===s?.type&&this._emit("tool_calls.function.arguments.delta",{name:s.function?.name,index:t.index,arguments:s.function.arguments,parsed_arguments:s.function.parsed_arguments,arguments_delta:t.function?.arguments??""}))}}},Ew=function(e,t){if(Mw(this,yw,"m",Aw).call(this,e).done_tool_calls.has(t))return;const s=e.message.tool_calls?.[t];if(!s)throw new Error("no tool call snapshot");if(!s.type)throw new Error("tool call snapshot missing `type`");if("function"===s.type){const e=Mw(this,xw,"f")?.tools?.find((e=>"function"===e.type&&e.function.name===s.function.name));this._emit("tool_calls.function.arguments.done",{name:s.function.name,index:t,arguments:s.function.arguments,parsed_arguments:Jx(e)?e.$parseRaw(s.function.arguments):e?.function.strict?JSON.parse(s.function.arguments):null})}else s.type},Cw=function(e){const t=Mw(this,yw,"m",Aw).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;const s=Mw(this,yw,"m",Nw).call(this);this._emit("content.done",{content:e.message.content,parsed:s?s.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},jw=function(){if(this.ended)throw new Lv("stream has ended, this shouldn't happen");const e=Mw(this,_w,"f");if(!e)throw new Lv("request ended without sending any chunks");return Pw(this,_w,void 0,"f"),Pw(this,ww,[],"f"),function(e,t){const{id:s,choices:n,created:i,model:a,system_fingerprint:r,...o}=e,l={...o,id:s,choices:n.map((t=>{let{message:s,finish_reason:n,index:i,logprobs:a,...r}=t;if(!n)throw new Lv(`missing finish_reason for choice ${i}`);const{content:o=null,function_call:l,tool_calls:c,...d}=s,h=s.role;if(!h)throw new Lv(`missing role for choice ${i}`);if(l){const{arguments:e,name:t}=l;if(null==e)throw new Lv(`missing function_call.arguments for choice ${i}`);if(!t)throw new Lv(`missing function_call.name for choice ${i}`);return{...r,message:{content:o,function_call:{arguments:e,name:t},role:h,refusal:s.refusal??null},finish_reason:n,index:i,logprobs:a}}return c?{...r,index:i,finish_reason:n,logprobs:a,message:{...d,role:h,content:o,refusal:s.refusal??null,tool_calls:c.map(((t,s)=>{const{function:n,type:a,id:r,...o}=t,{arguments:l,name:c,...d}=n||{};if(null==r)throw new Lv(`missing choices[${i}].tool_calls[${s}].id\n${Iw(e)}`);if(null==a)throw new Lv(`missing choices[${i}].tool_calls[${s}].type\n${Iw(e)}`);if(null==c)throw new Lv(`missing choices[${i}].tool_calls[${s}].function.name\n${Iw(e)}`);if(null==l)throw new Lv(`missing choices[${i}].tool_calls[${s}].function.arguments\n${Iw(e)}`);return{...o,id:r,type:a,function:{...d,name:c,arguments:l}}}))}}:{...r,message:{...d,content:o,role:h,refusal:s.refusal??null},finish_reason:n,index:i,logprobs:a}})),created:i,model:a,object:"chat.completion",...r?{system_fingerprint:r}:{}};return function(e,t){return t&&tw(t)?Qx(e,t):{...e,choices:e.choices.map((e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}})))}}(l,t)}(e,Mw(this,xw,"f"))},Nw=function(){const e=Mw(this,xw,"f")?.response_format;return Kx(e)?e:null},Tw=function(e){var t,s,n,i;let a=Mw(this,_w,"f");const{choices:r,...o}=e;a?Object.assign(a,o):a=Pw(this,_w,{...o,choices:[]},"f");for(const{delta:l,finish_reason:c,index:d,logprobs:h=null,...u}of e.choices){let e=a.choices[d];if(e||(e=a.choices[d]={finish_reason:c,index:d,message:{},logprobs:h,...u}),h)if(e.logprobs){const{content:n,refusal:i,...a}=h;Object.assign(e.logprobs,a),n&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...n)),i&&((s=e.logprobs).refusal??(s.refusal=[]),e.logprobs.refusal.push(...i))}else e.logprobs=Object.assign({},h);if(c&&(e.finish_reason=c,Mw(this,xw,"f")&&tw(Mw(this,xw,"f")))){if("length"===c)throw new Yv;if("content_filter"===c)throw new Kv}if(Object.assign(e,u),!l)continue;const{content:r,refusal:o,function_call:p,role:f,tool_calls:m,...g}=l;if(Object.assign(e.message,g),o&&(e.message.refusal=(e.message.refusal||"")+o),f&&(e.message.role=f),p&&(e.message.function_call?(p.name&&(e.message.function_call.name=p.name),p.arguments&&((n=e.message.function_call).arguments??(n.arguments=""),e.message.function_call.arguments+=p.arguments)):e.message.function_call=p),r&&(e.message.content=(e.message.content||"")+r,!e.message.refusal&&Mw(this,yw,"m",Nw).call(this)&&(e.message.parsed=vw(e.message.content))),m){e.message.tool_calls||(e.message.tool_calls=[]);for(const{index:t,id:s,type:n,function:a,...r}of m){const o=(i=e.message.tool_calls)[t]??(i[t]={});Object.assign(o,r),s&&(o.id=s),n&&(o.type=n),a&&(o.function??(o.function={name:a.name??"",arguments:""})),a?.name&&(o.function.name=a.name),a?.arguments&&(o.function.arguments+=a.arguments,ew(Mw(this,xw,"f"),o)&&(o.function.parsed_arguments=vw(o.function.arguments)))}}}return a},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("chunk",(s=>{const n=t.shift();n?n.resolve(s):e.push(s)})),this.on("end",(()=>{s=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),this.on("error",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),{next:async()=>{if(!e.length)return s?{value:void 0,done:!0}:new Promise(((e,s)=>t.push({resolve:e,reject:s}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new iy(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Iw(e){return JSON.stringify(e)}class Dw extends Rw{static fromReadableStream(e){const t=new Dw(null);return t._run((()=>t._fromReadableStream(e))),t}static runFunctions(e,t,s){const n=new Dw(null),i={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run((()=>n._runFunctions(e,t,i))),n}static runTools(e,t,s){const n=new Dw(t),i={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run((()=>n._runTools(e,t,i))),n}}class Lw extends Yy{parse(e,t){return function(e){for(const t of e??[]){if("function"!==t.type)throw new Lv(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new Lv(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((t=>Qx(t,e)))}runFunctions(e,t){return e.stream?Dw.runFunctions(this._client,e,t):pw.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Dw.runTools(this._client,e,t):pw.runTools(this._client,e,t)}stream(e,t){return Rw.createChatCompletion(this._client,e,t)}}class Ow extends Yy{constructor(){super(...arguments),this.completions=new Lw(this._client)}}!function(e){e.Completions=Lw}(Ow||(Ow={}));class Fw extends Yy{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class zw extends Yy{constructor(){super(...arguments),this.sessions=new Fw(this._client)}}zw.Sessions=Fw;var $w,Bw,Hw,Uw,Vw,Ww,qw,Gw,Xw,Yw,Kw,Jw,Qw,Zw,e_,t_,s_,n_,i_,a_,r_,o_,l_=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)},c_=function(e,t,s,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,s):i?i.value=s:t.set(e,s),s};class d_ extends Yx{constructor(){super(...arguments),$w.add(this),Bw.set(this,[]),Hw.set(this,{}),Uw.set(this,{}),Vw.set(this,void 0),Ww.set(this,void 0),qw.set(this,void 0),Gw.set(this,void 0),Xw.set(this,void 0),Yw.set(this,void 0),Kw.set(this,void 0),Jw.set(this,void 0),Qw.set(this,void 0)}[(Bw=new WeakMap,Hw=new WeakMap,Uw=new WeakMap,Vw=new WeakMap,Ww=new WeakMap,qw=new WeakMap,Gw=new WeakMap,Xw=new WeakMap,Yw=new WeakMap,Kw=new WeakMap,Jw=new WeakMap,Qw=new WeakMap,$w=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",(s=>{const n=t.shift();n?n.resolve(s):e.push(s)})),this.on("end",(()=>{s=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),this.on("error",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),{next:async()=>{if(!e.length)return s?{value:void 0,done:!0}:new Promise(((e,s)=>t.push({resolve:e,reject:s}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new d_;return t._run((()=>t._fromReadableStream(e))),t}async _fromReadableStream(e,t){const s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const n=iy.fromReadableStream(e,this.controller);for await(const i of n)l_(this,$w,"m",Zw).call(this,i);if(n.controller.signal?.aborted)throw new Fv;return this._addRun(l_(this,$w,"m",e_).call(this))}toReadableStream(){return new iy(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,s,n,i){const a=new d_;return a._run((()=>a._runToolAssistantStream(e,t,s,n,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}}))),a}async _createToolAssistantStream(e,t,s,n,i){const a=i?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",(()=>this.controller.abort())));const r={...n,stream:!0},o=await e.submitToolOutputs(t,s,r,{...i,signal:this.controller.signal});this._connected();for await(const l of o)l_(this,$w,"m",Zw).call(this,l);if(o.controller.signal?.aborted)throw new Fv;return this._addRun(l_(this,$w,"m",e_).call(this))}static createThreadAssistantStream(e,t,s){const n=new d_;return n._run((()=>n._threadAssistantStream(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}}))),n}static createAssistantStream(e,t,s,n){const i=new d_;return i._run((()=>i._runAssistantStream(e,t,s,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),i}currentEvent(){return l_(this,Kw,"f")}currentRun(){return l_(this,Jw,"f")}currentMessageSnapshot(){return l_(this,Vw,"f")}currentRunStepSnapshot(){return l_(this,Qw,"f")}async finalRunSteps(){return await this.done(),Object.values(l_(this,Hw,"f"))}async finalMessages(){return await this.done(),Object.values(l_(this,Uw,"f"))}async finalRun(){if(await this.done(),!l_(this,Ww,"f"))throw Error("Final run was not received.");return l_(this,Ww,"f")}async _createThreadAssistantStream(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort())));const i={...t,stream:!0},a=await e.createAndRun(i,{...s,signal:this.controller.signal});this._connected();for await(const r of a)l_(this,$w,"m",Zw).call(this,r);if(a.controller.signal?.aborted)throw new Fv;return this._addRun(l_(this,$w,"m",e_).call(this))}async _createAssistantStream(e,t,s,n){const i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const a={...s,stream:!0},r=await e.create(t,a,{...n,signal:this.controller.signal});this._connected();for await(const o of r)l_(this,$w,"m",Zw).call(this,o);if(r.controller.signal?.aborted)throw new Fv;return this._addRun(l_(this,$w,"m",e_).call(this))}static accumulateDelta(e,t){for(const[s,n]of Object.entries(t)){if(!e.hasOwnProperty(s)){e[s]=n;continue}let t=e[s];if(null!==t&&void 0!==t)if("index"!==s&&"type"!==s){if("string"===typeof t&&"string"===typeof n)t+=n;else if("number"===typeof t&&"number"===typeof n)t+=n;else{if(!Xy(t)||!Xy(n)){if(Array.isArray(t)&&Array.isArray(n)){if(t.every((e=>"string"===typeof e||"number"===typeof e))){t.push(...n);continue}for(const e of n){if(!Xy(e))throw new Error(`Expected array delta entry to be an object but got: ${e}`);const s=e.index;if(null==s)throw console.error(e),new Error("Expected array delta entry to have an `index` property");if("number"!==typeof s)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${s}`);const n=t[s];null==n?t.push(e):t[s]=this.accumulateDelta(n,e)}continue}throw Error(`Unhandled record type: ${s}, deltaValue: ${n}, accValue: ${t}`)}t=this.accumulateDelta(t,n)}e[s]=t}else e[s]=n;else e[s]=n}return e}_addRun(e){return e}async _threadAssistantStream(e,t,s){return await this._createThreadAssistantStream(t,e,s)}async _runAssistantStream(e,t,s,n){return await this._createAssistantStream(t,e,s,n)}async _runToolAssistantStream(e,t,s,n,i){return await this._createToolAssistantStream(s,e,t,n,i)}}Zw=function(e){if(!this.ended)switch(c_(this,Kw,e,"f"),l_(this,$w,"m",n_).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":l_(this,$w,"m",o_).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":l_(this,$w,"m",s_).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":l_(this,$w,"m",t_).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},e_=function(){if(this.ended)throw new Lv("stream has ended, this shouldn't happen");if(!l_(this,Ww,"f"))throw Error("Final run has not been received");return l_(this,Ww,"f")},t_=function(e){const[t,s]=l_(this,$w,"m",a_).call(this,e,l_(this,Vw,"f"));c_(this,Vw,t,"f"),l_(this,Uw,"f")[t.id]=t;for(const n of s){const e=t.content[n.index];"text"==e?.type&&this._emit("textCreated",e.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if("text"==s.type&&s.text){let e=s.text,n=t.content[s.index];if(!n||"text"!=n.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",e,n.text)}if(s.index!=l_(this,qw,"f")){if(l_(this,Gw,"f"))switch(l_(this,Gw,"f").type){case"text":this._emit("textDone",l_(this,Gw,"f").text,l_(this,Vw,"f"));break;case"image_file":this._emit("imageFileDone",l_(this,Gw,"f").image_file,l_(this,Vw,"f"))}c_(this,qw,s.index,"f")}c_(this,Gw,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==l_(this,qw,"f")){const t=e.data.content[l_(this,qw,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,l_(this,Vw,"f"));break;case"text":this._emit("textDone",t.text,l_(this,Vw,"f"))}}l_(this,Vw,"f")&&this._emit("messageDone",e.data),c_(this,Vw,void 0,"f")}},s_=function(e){const t=l_(this,$w,"m",i_).call(this,e);switch(c_(this,Qw,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&"tool_calls"==s.step_details.type&&s.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(const e of s.step_details.tool_calls)e.index==l_(this,Xw,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(l_(this,Yw,"f")&&this._emit("toolCallDone",l_(this,Yw,"f")),c_(this,Xw,e.index,"f"),c_(this,Yw,t.step_details.tool_calls[e.index],"f"),l_(this,Yw,"f")&&this._emit("toolCallCreated",l_(this,Yw,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":c_(this,Qw,void 0,"f");"tool_calls"==e.data.step_details.type&&l_(this,Yw,"f")&&(this._emit("toolCallDone",l_(this,Yw,"f")),c_(this,Yw,void 0,"f")),this._emit("runStepDone",e.data,t)}},n_=function(e){l_(this,Bw,"f").push(e),this._emit("event",e)},i_=function(e){switch(e.event){case"thread.run.step.created":return l_(this,Hw,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=l_(this,Hw,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const n=d_.accumulateDelta(t,s.delta);l_(this,Hw,"f")[e.data.id]=n}return l_(this,Hw,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":l_(this,Hw,"f")[e.data.id]=e.data}if(l_(this,Hw,"f")[e.data.id])return l_(this,Hw,"f")[e.data.id];throw new Error("No snapshot available")},a_=function(e,t){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=e.data;if(n.delta.content)for(const e of n.delta.content)if(e.index in t.content){let s=t.content[e.index];t.content[e.index]=l_(this,$w,"m",r_).call(this,e,s)}else t.content[e.index]=e,s.push(e);return[t,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},r_=function(e,t){return d_.accumulateDelta(t,e)},o_=function(e){switch(c_(this,Jw,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":c_(this,Ww,e.data,"f"),l_(this,Yw,"f")&&(this._emit("toolCallDone",l_(this,Yw,"f")),c_(this,Yw,void 0,"f"))}};class h_ extends Yy{create(e,t,s){return this._client.post(`/threads/${e}/messages`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/messages/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jy(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,u_,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t,s){return this._client.delete(`/threads/${e}/messages/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}}class u_ extends Zy{}h_.MessagesPage=u_;class p_ extends Yy{retrieve(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0;return jy(n)?this.retrieve(e,t,s,{},n):this._client.get(`/threads/${e}/runs/${t}/steps/${s}`,{query:n,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}list(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;return jy(s)?this.list(e,t,{},s):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,f_,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class f_ extends Zy{}p_.RunStepsPage=f_;class m_ extends Yy{constructor(){super(...arguments),this.steps=new p_(this._client)}create(e,t,s){const{include:n,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:n},body:i,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers},stream:t.stream??!1})}retrieve(e,t,s){return this._client.get(`/threads/${e}/runs/${t}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jy(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,g_,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}cancel(e,t,s){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async createAndPoll(e,t,s){const n=await this.create(e,t,s);return await this.poll(e,n.id,s)}createAndStream(e,t,s){return d_.createAssistantStream(e,this._client.beta.threads.runs,t,s)}async poll(e,t,s){const n={...s?.headers,"X-Stainless-Poll-Helper":"true"};for(s?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=s.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...s,headers:{...s?.headers,...n}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let e=5e3;if(s?.pollIntervalMs)e=s.pollIntervalMs;else{const t=a.headers.get("openai-poll-after-ms");if(t){const s=parseInt(t);isNaN(s)||(e=s)}}await Oy(e);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,s){return d_.createAssistantStream(e,this._client.beta.threads.runs,t,s)}submitToolOutputs(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:s.stream??!1})}async submitToolOutputsAndPoll(e,t,s,n){const i=await this.submitToolOutputs(e,t,s,n);return await this.poll(e,i.id,n)}submitToolOutputsStream(e,t,s,n){return d_.createToolAssistantStream(e,t,this._client.beta.threads.runs,s,n)}}class g_ extends Zy{}m_.RunsPage=g_,m_.Steps=p_,m_.RunStepsPage=f_;class b_ extends Yy{constructor(){super(...arguments),this.runs=new m_(this._client),this.messages=new h_(this._client)}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return jy(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,s){return this._client.post(`/threads/${e}`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const s=await this.createAndRun(e,t);return await this.runs.poll(s.thread_id,s.id,t)}createAndRunStream(e,t){return d_.createThreadAssistantStream(e,this._client.beta.threads,t)}}b_.Runs=m_,b_.RunsPage=g_,b_.Messages=h_,b_.MessagesPage=u_;class v_ extends Yy{constructor(){super(...arguments),this.realtime=new zw(this._client),this.chat=new Ow(this._client),this.assistants=new jx(this._client),this.threads=new b_(this._client)}}v_.Realtime=zw,v_.Assistants=jx,v_.AssistantsPage=Nx,v_.Threads=b_;class y_ extends Yy{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return jy(e)?this.list({},e):this._client.getAPIList("/batches",x_,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class x_ extends Zy{}y_.BatchesPage=x_;class w_ extends Yy{create(e,t,s){return this._client.post(`/uploads/${e}/parts`,fy({body:t,...s}))}}class __ extends Yy{constructor(){super(...arguments),this.parts=new w_(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,s){return this._client.post(`/uploads/${e}/complete`,{body:t,...s})}}function S_(e,t){return t&&function(e){if(Kx(e.text?.format))return!0;return!1}(t)?A_(e,t):{...e,output_parsed:null,output:e.output.map((e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map((e=>({...e,parsed:null})))}:e))}}function A_(e,t){const s=e.output.map((e=>{if("function_call"===e.type)return{...e,parsed_arguments:j_(t,e)};if("message"===e.type){const s=e.content.map((e=>"output_text"===e.type?{...e,parsed:k_(t,e.text)}:e));return{...e,content:s}}return e})),n=Object.assign({},e,{output:s});return Object.getOwnPropertyDescriptor(e,"output_text")||N_(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const e of n.output)if("message"===e.type)for(const t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed;return null}}),n}function k_(e,t){if("json_schema"!==e.text?.format?.type)return null;if("$parseRaw"in e.text?.format){const s=e.text?.format;return s.$parseRaw(t)}return JSON.parse(t)}function E_(e){return"auto-parseable-tool"===e?.$brand}function C_(e,t){return e.find((e=>"function"===e.type&&e.name===t))}function j_(e,t){const s=C_(e.tools??[],t.name);return{...t,...t,parsed_arguments:E_(s)?s.$parseRaw(t.arguments):s?.strict?JSON.parse(t.arguments):null}}function N_(e){const t=[];for(const s of e.output)if("message"===s.type)for(const e of s.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}__.Parts=w_;class T_ extends Yy{list(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jy(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,P_,{query:t,...s})}}class P_ extends Zy{}T_.ResponseItemListDataPage=P_;var M_,R_,I_,D_,L_,O_,F_,z_,$_,B_=function(e,t,s,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,s):i?i.value=s:t.set(e,s),s},H_=function(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e)};class U_ extends Yx{constructor(e){super(),M_.add(this),R_.set(this,void 0),I_.set(this,void 0),D_.set(this,void 0),B_(this,R_,e,"f")}static createResponse(e,t,s){const n=new U_(t);return n._run((()=>n._createResponse(e,t,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}}))),n}async _createResponse(e,t,s){const n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),H_(this,M_,"m",L_).call(this);const i=await e.responses.create({...t,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const a of i)H_(this,M_,"m",O_).call(this,a);if(i.controller.signal?.aborted)throw new Fv;return H_(this,M_,"m",F_).call(this)}[(R_=new WeakMap,I_=new WeakMap,D_=new WeakMap,M_=new WeakSet,L_=function(){this.ended||B_(this,I_,void 0,"f")},O_=function(e){if(this.ended)return;const t=H_(this,M_,"m",z_).call(this,e);switch(this._emit("event",e),e.type){case"response.output_text.delta":{const s=t.output[e.output_index];if(!s)throw new Lv(`missing output at index ${e.output_index}`);if("message"===s.type){const t=s.content[e.content_index];if(!t)throw new Lv(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new Lv(`expected content to be 'output_text', got ${t.type}`);this._emit("response.output_text.delta",{...e,snapshot:t.text})}break}case"response.function_call_arguments.delta":{const s=t.output[e.output_index];if(!s)throw new Lv(`missing output at index ${e.output_index}`);"function_call"===s.type&&this._emit("response.function_call_arguments.delta",{...e,snapshot:s.arguments});break}default:this._emit(e.type,e)}},F_=function(){if(this.ended)throw new Lv("stream has ended, this shouldn't happen");const e=H_(this,I_,"f");if(!e)throw new Lv("request ended without sending any events");B_(this,I_,void 0,"f");const t=function(e,t){return S_(e,t)}(e,H_(this,R_,"f"));return B_(this,D_,t,"f"),t},z_=function(e){let t=H_(this,I_,"f");if(!t){if("response.created"!==e.type)throw new Lv(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return t=B_(this,I_,e.response,"f"),t}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{const s=t.output[e.output_index];if(!s)throw new Lv(`missing output at index ${e.output_index}`);"message"===s.type&&s.content.push(e.part);break}case"response.output_text.delta":{const s=t.output[e.output_index];if(!s)throw new Lv(`missing output at index ${e.output_index}`);if("message"===s.type){const t=s.content[e.content_index];if(!t)throw new Lv(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new Lv(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{const s=t.output[e.output_index];if(!s)throw new Lv(`missing output at index ${e.output_index}`);"function_call"===s.type&&(s.arguments+=e.delta);break}case"response.completed":B_(this,I_,e.response,"f")}return t},Symbol.asyncIterator)](){const e=[],t=[];let s=!1;return this.on("event",(s=>{const n=t.shift();n?n.resolve(s):e.push(s)})),this.on("end",(()=>{s=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),this.on("error",(e=>{s=!0;for(const s of t)s.reject(e);t.length=0})),{next:async()=>{if(!e.length)return s?{value:void 0,done:!0}:new Promise(((e,s)=>t.push({resolve:e,reject:s}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=H_(this,D_,"f");if(!e)throw new Lv("stream ended without producing a ChatCompletion");return e}}class V_ extends Yy{constructor(){super(...arguments),this.inputItems=new T_(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap((e=>("object"in e&&"response"===e.object&&N_(e),e)))}retrieve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return jy(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...s})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap((t=>A_(t,e)))}stream(e,t){return U_.createResponse(this._client,e,t)}}V_.InputItems=T_,V_.ResponseItemListDataPage=P_;class W_ extends Sy{constructor(){let{baseURL:e=$y("OPENAI_BASE_URL"),apiKey:t=$y("OPENAI_API_KEY"),organization:s=$y("OPENAI_ORG_ID")??null,project:n=$y("OPENAI_PROJECT_ID")??null,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(void 0===t)throw new Lv("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:s,project:n,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&"undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof navigator)throw new Lv("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new Ky(this),this.chat=new nx(this),this.embeddings=new ix(this),this.files=new ax(this),this.images=new ox(this),this.audio=new hx(this),this.moderations=new ux(this),this.models=new px(this),this.fineTuning=new xx(this),this.vectorStores=new kx(this),this.beta=new v_(this),this.batches=new y_(this),this.uploads=new __(this),this.responses=new V_(this),this._options=a,this.apiKey=t,this.organization=s,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return yv(e,{arrayFormat:"brackets"})}}$_=W_,W_.OpenAI=$_,W_.DEFAULT_TIMEOUT=6e5,W_.OpenAIError=Lv,W_.APIError=Ov,W_.APIConnectionError=zv,W_.APIConnectionTimeoutError=$v,W_.APIUserAbortError=Fv,W_.NotFoundError=Vv,W_.ConflictError=Wv,W_.RateLimitError=Gv,W_.BadRequestError=Bv,W_.AuthenticationError=Hv,W_.InternalServerError=Xv,W_.PermissionDeniedError=Uv,W_.UnprocessableEntityError=qv,W_.toFile=dy,W_.fileFromPath=jv,W_.Completions=Ky,W_.Chat=nx,W_.ChatCompletionsPage=tx,W_.Embeddings=ix,W_.Files=ax,W_.FileObjectsPage=rx,W_.Images=ox,W_.Audio=hx,W_.Moderations=ux,W_.Models=px,W_.ModelsPage=fx,W_.FineTuning=xx,W_.VectorStores=kx,W_.VectorStoresPage=Ex,W_.VectorStoreSearchResponsesPage=Cx,W_.Beta=v_,W_.Batches=y_,W_.BatchesPage=x_,W_.Uploads=__,W_.Responses=V_;new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]);const q_=W_;Zb.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${tv}/pdf.worker.min.js`;const G_=new q_({apiKey:"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",dangerouslyAllowBrowser:!0}),X_=()=>{var e,s;const[n,i]=(0,t.useState)([]),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)({first_name:"",last_name:"",email:""}),[c,d]=(0,t.useState)(!1),[h,u]=(0,t.useState)({disease_id:"",since:"",file:null}),[p,f]=(0,t.useState)(null),[m,g]=(0,t.useState)(null),[b,v]=(0,t.useState)(!1),[y,x]=(0,t.useState)([]),[w,_]=(0,t.useState)([]),[S,A]=(0,t.useState)({});(0,t.useEffect)((()=>{(async()=>{v(!0);const{data:{user:e},error:t}=await Et.auth.getUser();t||(e&&(r(e.id),j(e.id),C(e.id),k(e.id),E(e.id)),v(!1))})()}),[]);const k=async e=>{const{data:t,error:s}=await Et.from("user_diseases").select("*").eq("user_id",e);s||x(t)},E=async e=>{const{data:t,error:s}=await Et.from("user_parameters").select("*").eq("user_id",e);s||_(t)},C=async e=>{const{data:t,error:s}=await Et.from("profiles").select("first_name, last_name, email").eq("id",e).single();s||l(t)},j=async e=>{v(!0);const{data:t,error:s}=await Et.from("healthrecords").select("\n        *,\n        user_diseases(disease_name)\n      ").eq("user_id",e);s||i(t),v(!1)},N=async e=>{try{let t="";if(e.type.startsWith("image/")){const{data:{text:s}}=await nv().recognize(URL.createObjectURL(e),"eng",{logger:e=>console.log(e)});t=s}else if("application/pdf"===e.type){const s=await e.arrayBuffer(),n=await ev({data:s}).promise;for(let e=1;e<=n.numPages;e++){const s=await n.getPage(e),i=(await s.getTextContent()).items.map((e=>e.str)).join(" ");if(i.trim().length<100){const e=s.getViewport({scale:1.5}),n=document.createElement("canvas"),i=n.getContext("2d");n.height=e.height,n.width=e.width,await s.render({canvasContext:i,viewport:e}).promise;const{data:{text:a}}=await nv().recognize(n.toDataURL("image/png"),"eng",{logger:e=>console.log(e)});t+=a+"\n"}else t+=i+"\n"}}else t=await e.text();const s={};if(w.forEach((e=>{const n=new RegExp(`${e.parameter_name}\\s*[:=]\\s*([\\d.]+)`,"i"),i=t.match(n);i&&(s[e.parameter_name]=i[1])})),t.length>50){return await T(t,s)}return{parameters:s}}catch(t){throw console.error("Error extracting parameters:",t),t}},T=async(e,t)=>{try{const s=`\n        You are a medical data extraction assistant. Extract relevant health parameters from the following medical report.\n        If you find any of these parameters, provide their values: blood pressure, heart rate, cholesterol, glucose, BMI, A1C, triglycerides, HDL, LDL.\n        Also identify any mentioned medical conditions, medications, or doctor's recommendations.\n        \n        Document text:\n        ${e}\n        \n        Format your response as a JSON object with these keys:\n        "parameters" (key-value pairs of parameter names and values)\n        "conditions" (array of identified conditions)\n        "medications" (array of medications with dosages if available)\n        "recommendations" (key points from doctor's recommendations)\n        "summary" (2-3 sentence summary of the document)\n      `,n=await G_.chat.completions.create({model:"gpt-4o",messages:[{role:"system",content:"You are a medical data extraction assistant that outputs only valid JSON."},{role:"user",content:s}],response_format:{type:"json_object"},temperature:.2}),i=JSON.parse(n.choices[0].message.content);return{parameters:{...t,...i.parameters},aiAnalysis:{conditions:i.conditions||[],medications:i.medications||[],recommendations:i.recommendations||[],summary:i.summary||""}}}catch(s){return console.error("Error enhancing with OpenAI:",s),{parameters:t,aiAnalysis:null}}};return(0,Me.jsxs)(Vc,{className:"py-4",children:[b&&(0,Me.jsx)(Hs,{}),m&&(0,Me.jsx)("div",{className:`alert alert-${m.type}`,role:"alert",children:m.message}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,Me.jsx)("h2",{className:"text-primary",children:"Health Reports"}),(0,Me.jsx)(Yc,{variant:"primary",onClick:()=>d(!0),children:"+ Upload Report"})]}),(0,Me.jsx)(Jc,{children:n.map((e=>{var t;return(0,Me.jsx)(Zc,{md:3,sm:6,className:"mb-3",children:(0,Me.jsx)(Ad,{className:"shadow-sm border-0",children:(0,Me.jsxs)(Ad.Body,{children:[(0,Me.jsxs)(Ad.Title,{children:["Disease: ",null===(t=e.user_diseases)||void 0===t?void 0:t.disease_name]}),(0,Me.jsxs)(Ad.Text,{children:["Since: ",e.since]}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Me.jsx)(Yc,{variant:"danger",size:"md",className:"m-2",onClick:()=>console.log("Delete",e.id),children:"Delete"}),(0,Me.jsx)(Yc,{variant:"info",size:"md",className:"m-2",onClick:()=>window.open(e.document_url,"_blank"),children:"View"})]})]})})},e.id)}))}),(0,Me.jsxs)(mu,{show:c,onHide:()=>d(!1),centered:!0,children:[(0,Me.jsx)(mu.Header,{closeButton:!0,children:(0,Me.jsx)(mu.Title,{children:"Upload New Report"})}),(0,Me.jsx)(mu.Body,{children:(0,Me.jsxs)(qu,{onSubmit:async e=>{e.preventDefault(),v(!0);try{var t;const e=h.file.name.split(".").pop(),s=`${a}/${Date.now()}.${e}`,{data:n,error:i}=await Et.storage.from("health-reports").upload(s,h.file);if(i)throw i;const{data:{publicUrl:r}}=Et.storage.from("health-reports").getPublicUrl(s),{data:o,error:l}=await Et.from("healthrecords").insert([{user_id:a,disease_id:h.disease_id,since:h.since,document_url:r,created_at:(new Date).toISOString(),ai_summary:(null===(t=S.aiAnalysis)||void 0===t?void 0:t.summary)||null}]).select().single();if(l)throw l;if(S.parameters&&Object.keys(S.parameters).length>0){const e=Object.entries(S.parameters).map((e=>{let[t,s]=e;return{report_id:o.id,parameter_name:t,parameter_value:s}})),{error:t}=await Et.from("report_parameters").insert(e);if(t)throw t}if(S.aiAnalysis){const{error:e}=await Et.from("report_ai_analysis").insert([{report_id:o.id,conditions:S.aiAnalysis.conditions,medications:S.aiAnalysis.medications,recommendations:S.aiAnalysis.recommendations,summary:S.aiAnalysis.summary}]);if(e)throw e}g({message:"Report uploaded successfully!",type:"success"}),d(!1),j(a)}catch(s){console.error("Error uploading report:",s),g({message:"Error uploading report",type:"danger"})}finally{v(!1)}},children:[(0,Me.jsxs)(qu.Group,{className:"mb-3",children:[(0,Me.jsx)(qu.Label,{children:"Select Disease"}),(0,Me.jsxs)(qu.Select,{value:h.disease_id,onChange:e=>u({...h,disease_id:e.target.value}),required:!0,children:[(0,Me.jsx)("option",{value:"",children:"Select a disease"}),y.map((e=>(0,Me.jsx)("option",{value:e.id,children:e.disease_name},e.id)))]})]}),(0,Me.jsxs)(qu.Group,{className:"mb-3",children:[(0,Me.jsx)(qu.Label,{children:"Since"}),(0,Me.jsx)(qu.Control,{type:"date",value:h.since,onChange:e=>u({...h,since:e.target.value}),required:!0})]}),(0,Me.jsxs)(qu.Group,{className:"mb-3",children:[(0,Me.jsx)(qu.Label,{children:"Upload File"}),(0,Me.jsx)(qu.Control,{type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:async e=>{const t=e.target.files[0];if(u({...h,file:t}),t){if(t.type.startsWith("image/")){const e=new FileReader;e.onloadend=()=>f(e.result),e.readAsDataURL(t)}try{const e=await N(t);A(e)}catch(s){console.error("Error extracting parameters:",s),g({message:"Error extracting parameters from file",type:"danger"})}}},required:!0})]}),p&&(0,Me.jsx)("img",{src:p,alt:"Preview",className:"img-fluid rounded mb-3"}),S.parameters&&Object.keys(S.parameters).length>0&&(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("h5",{children:"Extracted Parameters:"}),(0,Me.jsx)("ul",{className:"list-group",children:Object.entries(S.parameters).map((e=>{let[t,s]=e;return(0,Me.jsxs)("li",{className:"list-group-item",children:[t,": ",s]},t)}))})]}),S.aiAnalysis&&(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("h5",{children:"AI Analysis"}),(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h6",{children:"Summary"}),(0,Me.jsx)("p",{children:S.aiAnalysis.summary}),(null===(e=S.aiAnalysis.conditions)||void 0===e?void 0:e.length)>0&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("h6",{children:"Identified Conditions"}),(0,Me.jsx)("ul",{children:S.aiAnalysis.conditions.map(((e,t)=>(0,Me.jsx)("li",{children:e},t)))})]}),(null===(s=S.aiAnalysis.medications)||void 0===s?void 0:s.length)>0&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("h6",{children:"Medications"}),(0,Me.jsx)("ul",{children:S.aiAnalysis.medications.map(((e,t)=>(0,Me.jsx)("li",{children:e},t)))})]}),S.aiAnalysis.recommendations&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("h6",{children:"Recommendations"}),(0,Me.jsx)("p",{children:S.aiAnalysis.recommendations})]})]})})]}),(0,Me.jsx)(Yc,{type:"submit",variant:"primary",disabled:b,children:b?"Uploading...":"Upload Report"})]})})]})]})},Y_=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,condition:"",diagnosis_date:"",doctor:"",treatment:"",notes:""});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await Et.from("medical_history").select("*").eq("user_id",e.id).order("diagnosis_date",{ascending:!1});if(n)throw n;s(t||[])}catch(e){console.error("Error fetching medical records:",e),r({message:"Error fetching medical records.",type:"danger"})}finally{i(!1)}},u=e=>{const{name:t,value:s}=e.target;d((e=>({...e,[t]:s})))},p=()=>{l(!1),d({id:null,condition:"",diagnosis_date:"",doctor:"",treatment:"",notes:""})};return n&&0===e.length?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[a&&(0,Me.jsx)("div",{className:`alert alert-${a.type} text-center`,children:a.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(cs,{className:"me-2"})," Medical History"]}),(0,Me.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Me.jsx)("h3",{children:o?"Edit Medical Record":"Add New Medical Record"}),(0,Me.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await Et.from("medical_history").update({condition:c.condition,diagnosis_date:c.diagnosis_date,doctor:c.doctor,treatment:c.treatment,notes:c.notes}).eq("id",c.id);if(e)throw e;r({message:"Medical record updated successfully!",type:"success"})}else{const{error:t}=await Et.from("medical_history").insert([{condition:c.condition,diagnosis_date:c.diagnosis_date,doctor:c.doctor,treatment:c.treatment,notes:c.notes,user_id:e.id}]);if(t)throw t;r({message:"Medical record added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving medical record:",t),r({message:"Error saving medical record.",type:"danger"})}finally{i(!1)}},children:[(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"condition",className:"form-label",children:"Condition/Diagnosis"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"condition",name:"condition",value:c.condition,onChange:u,required:!0})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"diagnosis_date",className:"form-label",children:"Diagnosis Date"}),(0,Me.jsx)("input",{type:"date",className:"form-control",id:"diagnosis_date",name:"diagnosis_date",value:c.diagnosis_date,onChange:u,required:!0})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"doctor",className:"form-label",children:"Doctor/Healthcare Provider"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"doctor",name:"doctor",value:c.doctor,onChange:u})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"treatment",className:"form-label",children:"Treatment"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"treatment",name:"treatment",value:c.treatment,onChange:u})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Me.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u})]}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Zt,{className:"me-2"})," Update Record"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(ws,{className:"me-2"})," Add Record"]})}),o&&(0,Me.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),(0,Me.jsx)("h2",{className:"text-center mb-3",children:"Your Medical History"}),0===e.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No medical records found. Add your first record above."}):(0,Me.jsx)("div",{className:"table-responsive",children:(0,Me.jsxs)("table",{className:"table table-striped",children:[(0,Me.jsx)("thead",{children:(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("th",{children:"Condition"}),(0,Me.jsx)("th",{children:"Diagnosis Date"}),(0,Me.jsx)("th",{children:"Doctor"}),(0,Me.jsx)("th",{children:"Treatment"}),(0,Me.jsx)("th",{children:"Actions"})]})}),(0,Me.jsx)("tbody",{children:e.map((t=>(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("td",{children:t.condition}),(0,Me.jsx)("td",{children:new Date(t.diagnosis_date).toLocaleDateString()}),(0,Me.jsx)("td",{children:t.doctor}),(0,Me.jsx)("td",{children:t.treatment}),(0,Me.jsxs)("td",{children:[(0,Me.jsx)("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:(0,Me.jsx)(Zt,{})}),(0,Me.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this record?")){i(!0);try{const{error:n}=await Et.from("medical_history").delete().eq("id",t);if(n)throw n;s(e.filter((e=>e.id!==t))),r({message:"Medical record deleted successfully!",type:"success"})}catch(n){console.error("Error deleting medical record:",n),r({message:"Error deleting medical record.",type:"danger"})}finally{i(!1)}}})(t.id),children:(0,Me.jsx)(Rs,{})})]})]},t.id)))})]})})]})},K_=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,disease_name:"",diagnosis_date:"",severity:"Mild",medications:"",symptoms:"",notes:""});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await Et.from("chronic_diseases").select("*").eq("user_id",e.id).order("diagnosis_date",{ascending:!1});if(n)throw n;s(t||[])}catch(e){console.error("Error fetching chronic diseases:",e),r({message:"Error fetching chronic diseases.",type:"danger"})}finally{i(!1)}},u=e=>{const{name:t,value:s}=e.target;d((e=>({...e,[t]:s})))},p=()=>{l(!1),d({id:null,disease_name:"",diagnosis_date:"",severity:"Mild",medications:"",symptoms:"",notes:""})},f=e=>{switch(e){case"Mild":return"bg-success";case"Moderate":return"bg-warning text-dark";case"Severe":return"bg-danger";default:return"bg-secondary"}};return n&&0===e.length?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[a&&(0,Me.jsx)("div",{className:`alert alert-${a.type} text-center`,children:a.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(Jt,{className:"me-2"})," Chronic Disease Management"]}),(0,Me.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Me.jsx)("h3",{children:o?"Edit Chronic Disease":"Add New Chronic Disease"}),(0,Me.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await Et.from("chronic_diseases").update({disease_name:c.disease_name,diagnosis_date:c.diagnosis_date,severity:c.severity,medications:c.medications,symptoms:c.symptoms,notes:c.notes}).eq("id",c.id);if(e)throw e;r({message:"Chronic disease updated successfully!",type:"success"})}else{const{error:t}=await Et.from("chronic_diseases").insert([{disease_name:c.disease_name,diagnosis_date:c.diagnosis_date,severity:c.severity,medications:c.medications,symptoms:c.symptoms,notes:c.notes,user_id:e.id}]);if(t)throw t;r({message:"Chronic disease added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving chronic disease:",t),r({message:"Error saving chronic disease.",type:"danger"})}finally{i(!1)}},children:[(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"disease_name",className:"form-label",children:"Disease Name"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"disease_name",name:"disease_name",value:c.disease_name,onChange:u,required:!0})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"diagnosis_date",className:"form-label",children:"Diagnosis Date"}),(0,Me.jsx)("input",{type:"date",className:"form-control",id:"diagnosis_date",name:"diagnosis_date",value:c.diagnosis_date,onChange:u,required:!0})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"severity",className:"form-label",children:"Severity"}),(0,Me.jsxs)("select",{className:"form-control",id:"severity",name:"severity",value:c.severity,onChange:u,children:[(0,Me.jsx)("option",{value:"Mild",children:"Mild"}),(0,Me.jsx)("option",{value:"Moderate",children:"Moderate"}),(0,Me.jsx)("option",{value:"Severe",children:"Severe"})]})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"medications",className:"form-label",children:"Medications"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"medications",name:"medications",value:c.medications,onChange:u,placeholder:"Separate multiple medications with commas"})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"symptoms",className:"form-label",children:"Symptoms"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"symptoms",name:"symptoms",value:c.symptoms,onChange:u,placeholder:"Separate multiple symptoms with commas"})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Me.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u})]}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Zt,{className:"me-2"})," Update Disease"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(ws,{className:"me-2"})," Add Disease"]})}),o&&(0,Me.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),(0,Me.jsx)("h2",{className:"text-center mb-3",children:"Your Chronic Diseases"}),0===e.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No chronic diseases found. Add your first record above."}):(0,Me.jsx)("div",{className:"row",children:e.map((t=>(0,Me.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Me.jsxs)("div",{className:"card h-100 shadow",children:[(0,Me.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,Me.jsx)("h5",{className:"mb-0",children:t.disease_name}),(0,Me.jsx)("span",{className:`badge ${f(t.severity)}`,children:t.severity})]}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("p",{children:[(0,Me.jsx)("strong",{children:"Diagnosed:"})," ",new Date(t.diagnosis_date).toLocaleDateString()]}),t.medications&&(0,Me.jsxs)("p",{children:[(0,Me.jsx)("strong",{children:"Medications:"}),(0,Me.jsx)("br",{}),t.medications.split(",").map(((e,t)=>(0,Me.jsx)("span",{className:"badge bg-info text-dark me-1 mb-1",children:e.trim()},t)))]}),t.symptoms&&(0,Me.jsxs)("p",{children:[(0,Me.jsx)("strong",{children:"Symptoms:"}),(0,Me.jsx)("br",{}),t.symptoms.split(",").map(((e,t)=>(0,Me.jsx)("span",{className:"badge bg-secondary me-1 mb-1",children:e.trim()},t)))]}),t.notes&&(0,Me.jsxs)("p",{children:[(0,Me.jsx)("strong",{children:"Notes:"}),(0,Me.jsx)("br",{}),t.notes]})]}),(0,Me.jsxs)("div",{className:"card-footer d-flex justify-content-between",children:[(0,Me.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:[(0,Me.jsx)(Zt,{className:"me-1"})," Edit"]}),(0,Me.jsxs)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this chronic disease record?")){i(!0);try{const{error:n}=await Et.from("chronic_diseases").delete().eq("id",t);if(n)throw n;s(e.filter((e=>e.id!==t))),r({message:"Chronic disease deleted successfully!",type:"success"})}catch(n){console.error("Error deleting chronic disease:",n),r({message:"Error deleting chronic disease.",type:"danger"})}finally{i(!1)}}})(t.id),children:[(0,Me.jsx)(Rs,{className:"me-1"})," Delete"]})]})]})},t.id)))})]})},J_=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,vaccine_name:"",date_administered:"",administered_by:"",lot_number:"",next_dose_date:"",notes:""});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await Et.from("vaccinations").select("*").eq("user_id",e.id).order("date_administered",{ascending:!1});if(n)throw n;s(t||[])}catch(e){console.error("Error fetching vaccinations:",e),r({message:"Error fetching vaccinations.",type:"danger"})}finally{i(!1)}},u=e=>{const{name:t,value:s}=e.target;d((e=>({...e,[t]:s})))},p=()=>{l(!1),d({id:null,vaccine_name:"",date_administered:"",administered_by:"",lot_number:"",next_dose_date:"",notes:""})},f=e=>{if(!e)return!1;const t=new Date,s=new Date(e)-t,n=Math.ceil(s/864e5);return n>=0&&n<=30},m=e=>{if(!e)return!1;const t=new Date;return new Date(e)<t};return n&&0===e.length?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[a&&(0,Me.jsx)("div",{className:`alert alert-${a.type} text-center`,children:a.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(Cs,{className:"me-2"})," Vaccination History"]}),(0,Me.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Me.jsx)("h3",{children:o?"Edit Vaccination Record":"Add New Vaccination"}),(0,Me.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await Et.from("vaccinations").update({vaccine_name:c.vaccine_name,date_administered:c.date_administered,administered_by:c.administered_by,lot_number:c.lot_number,next_dose_date:c.next_dose_date,notes:c.notes}).eq("id",c.id);if(e)throw e;r({message:"Vaccination record updated successfully!",type:"success"})}else{const{error:t}=await Et.from("vaccinations").insert([{vaccine_name:c.vaccine_name,date_administered:c.date_administered,administered_by:c.administered_by,lot_number:c.lot_number,next_dose_date:c.next_dose_date,notes:c.notes,user_id:e.id}]);if(t)throw t;r({message:"Vaccination record added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving vaccination record:",t),r({message:"Error saving vaccination record.",type:"danger"})}finally{i(!1)}},children:[(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"vaccine_name",className:"form-label",children:"Vaccine Name"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"vaccine_name",name:"vaccine_name",value:c.vaccine_name,onChange:u,required:!0})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"date_administered",className:"form-label",children:"Date Administered"}),(0,Me.jsx)("input",{type:"date",className:"form-control",id:"date_administered",name:"date_administered",value:c.date_administered,onChange:u,required:!0})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"administered_by",className:"form-label",children:"Administered By"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"administered_by",name:"administered_by",value:c.administered_by,onChange:u})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"lot_number",className:"form-label",children:"Lot Number"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"lot_number",name:"lot_number",value:c.lot_number,onChange:u})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"next_dose_date",className:"form-label",children:"Next Dose Date (if applicable)"}),(0,Me.jsx)("input",{type:"date",className:"form-control",id:"next_dose_date",name:"next_dose_date",value:c.next_dose_date,onChange:u})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Me.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u})]})]}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Zt,{className:"me-2"})," Update Record"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(ws,{className:"me-2"})," Add Record"]})}),o&&(0,Me.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),e.some((e=>f(e.next_dose_date)||m(e.next_dose_date)))&&(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-warning text-dark",children:(0,Me.jsxs)("h3",{className:"mb-0",children:[(0,Me.jsx)(Ut,{className:"me-2"})," Upcoming & Overdue Vaccinations"]})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsx)("div",{className:"table-responsive",children:(0,Me.jsxs)("table",{className:"table",children:[(0,Me.jsx)("thead",{children:(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("th",{children:"Vaccine"}),(0,Me.jsx)("th",{children:"Due Date"}),(0,Me.jsx)("th",{children:"Status"})]})}),(0,Me.jsx)("tbody",{children:e.filter((e=>f(e.next_dose_date)||m(e.next_dose_date))).map((e=>(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("td",{children:e.vaccine_name}),(0,Me.jsx)("td",{children:new Date(e.next_dose_date).toLocaleDateString()}),(0,Me.jsx)("td",{children:m(e.next_dose_date)?(0,Me.jsx)("span",{className:"badge bg-danger",children:"Overdue"}):(0,Me.jsx)("span",{className:"badge bg-warning text-dark",children:"Due Soon"})})]},`upcoming-${e.id}`)))})]})})})]}),(0,Me.jsx)("h2",{className:"text-center mb-3",children:"Your Vaccination History"}),0===e.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No vaccination records found. Add your first record above."}):(0,Me.jsx)("div",{className:"table-responsive",children:(0,Me.jsxs)("table",{className:"table table-striped",children:[(0,Me.jsx)("thead",{children:(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("th",{children:"Vaccine"}),(0,Me.jsx)("th",{children:"Date"}),(0,Me.jsx)("th",{children:"Administered By"}),(0,Me.jsx)("th",{children:"Lot Number"}),(0,Me.jsx)("th",{children:"Next Dose"}),(0,Me.jsx)("th",{children:"Actions"})]})}),(0,Me.jsx)("tbody",{children:e.map((t=>(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("td",{children:t.vaccine_name}),(0,Me.jsx)("td",{children:new Date(t.date_administered).toLocaleDateString()}),(0,Me.jsx)("td",{children:t.administered_by}),(0,Me.jsx)("td",{children:t.lot_number}),(0,Me.jsx)("td",{children:t.next_dose_date?(0,Me.jsxs)(Me.Fragment,{children:[new Date(t.next_dose_date).toLocaleDateString(),m(t.next_dose_date)&&(0,Me.jsx)("span",{className:"badge bg-danger ms-2",children:"Overdue"}),f(t.next_dose_date)&&!m(t.next_dose_date)&&(0,Me.jsx)("span",{className:"badge bg-warning text-dark ms-2",children:"Due Soon"})]}):"N/A"}),(0,Me.jsxs)("td",{children:[(0,Me.jsx)("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:(0,Me.jsx)(Zt,{})}),(0,Me.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this vaccination record?")){i(!0);try{const{error:n}=await Et.from("vaccinations").delete().eq("id",t);if(n)throw n;s(e.filter((e=>e.id!==t))),r({message:"Vaccination record deleted successfully!",type:"success"})}catch(n){console.error("Error deleting vaccination record:",n),r({message:"Error deleting vaccination record.",type:"danger"})}finally{i(!1)}}})(t.id),children:(0,Me.jsx)(Rs,{})})]})]},t.id)))})]})})]})},Q_=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)({name:"",frequency:"",customFrequency:"",quantity:""}),[a,r]=(0,t.useState)(!0),[o,l]=(0,t.useState)(null);(0,t.useEffect)((()=>{(async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await Et.from("medications").select("*").eq("user_id",e.id);if(n)throw n;s(t)}catch(e){console.error("Error fetching medications:",e)}finally{r(!1)}})()}),[]),(0,t.useEffect)((()=>{"granted"!==Notification.permission&&Notification.requestPermission().then((e=>{"granted"!==e&&console.warn("Notification permission not granted")}))}),[]);const c=e=>{const{name:t,value:s}=e.target;i((e=>({...e,[t]:s})))};return a?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[o&&(0,Me.jsx)("div",{className:`alert alert-${o.type} text-center`,children:o.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(xs,{className:"me-2"})," Medication Tracker"]}),(0,Me.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"name",className:"form-label",children:"Medication Name"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"name",name:"name",value:n.name,onChange:c})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"quantity",className:"form-label",children:"Quantity (number of tablets)"}),(0,Me.jsx)("input",{type:"number",className:"form-control",id:"quantity",name:"quantity",value:n.quantity,onChange:c})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"frequency",className:"form-label",children:"Frequency"}),(0,Me.jsxs)("select",{className:"form-control",id:"frequency",name:"frequency",value:n.frequency,onChange:c,children:[(0,Me.jsx)("option",{value:"",children:"Select frequency"}),(0,Me.jsx)("option",{value:"Once a day",children:"Once a day"}),(0,Me.jsx)("option",{value:"Twice a day",children:"Twice a day"}),(0,Me.jsx)("option",{value:"Three times a day",children:"Three times a day"}),(0,Me.jsx)("option",{value:"Every 6 hours",children:"Every 6 hours"}),(0,Me.jsx)("option",{value:"Every 8 hours",children:"Every 8 hours"})]})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"customFrequency",className:"form-label",children:"Custom Frequency"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"customFrequency",name:"customFrequency",placeholder:"e.g., Every 4 hours",value:n.customFrequency,onChange:c})]})]}),(0,Me.jsxs)("button",{className:"btn btn-primary w-100",onClick:async()=>{r(!0);try{const{data:{user:t}}=await Et.auth.getUser();if(!t)return void(window.location.href="/");const a=n.customFrequency||n.frequency,{data:r,error:o}=await Et.from("medications").insert([{name:n.name,frequency:a,quantity:n.quantity,user_id:t.id,last_taken:(new Date).toISOString()}]).select();if(o)throw o;s([...e,...r]),i({name:"",frequency:"",customFrequency:"",quantity:""}),l({message:"Medication added successfully!",type:"success"}),new Notification("Medication added successfully!")}catch(t){console.error("Error adding medication:",t),l({message:"Error adding medication.",type:"danger"}),new Notification("Error adding medication.")}finally{r(!1)}},children:[(0,Me.jsx)(ws,{className:"me-2"})," Add Medication"]})]}),(0,Me.jsx)("h2",{className:"text-center mb-3",children:"Your Medications"}),(0,Me.jsxs)("table",{className:"table table-striped",children:[(0,Me.jsx)("thead",{children:(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("th",{children:"Name"}),(0,Me.jsx)("th",{children:"Frequency"}),(0,Me.jsx)("th",{children:"Quantity"}),(0,Me.jsx)("th",{children:"Action"})]})}),(0,Me.jsx)("tbody",{children:e.map((t=>(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("td",{children:t.name}),(0,Me.jsx)("td",{children:t.frequency}),(0,Me.jsx)("td",{children:t.quantity}),(0,Me.jsx)("td",{children:(0,Me.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>(async t=>{r(!0);try{const{error:n}=await Et.from("medications").delete().eq("id",t);if(n)throw n;s(e.filter((e=>e.id!==t))),l({message:"Medication deleted successfully!",type:"success"}),new Notification("Medication deleted successfully!")}catch(n){console.error("Error deleting medication:",n),l({message:"Error deleting medication.",type:"danger"}),new Notification("Error deleting medication.")}finally{r(!1)}})(t.id),children:(0,Me.jsx)(Rs,{})})})]},t.id)))})]})]})},Z_="label";function eS(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function tS(e,t){e.labels=t}function sS(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Z_;const n=[];e.datasets=t.map((t=>{const i=e.datasets.find((e=>e[s]===t[s]));return i&&t.data&&!n.includes(i)?(n.push(i),Object.assign(i,t),i):{...t}}))}function nS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z_;const s={labels:[],datasets:[]};return tS(s,e.labels),sS(s,e.datasets,t),s}function iS(e,s){const{height:n=150,width:i=300,redraw:a=!1,datasetIdKey:r,type:o,data:l,options:c,plugins:d=[],fallbackContent:h,updateMode:u,...p}=e,f=(0,t.useRef)(null),m=(0,t.useRef)(null),g=()=>{f.current&&(m.current=new gl(f.current,{type:o,data:nS(l,r),options:c&&{...c},plugins:d}),eS(s,m.current))},b=()=>{eS(s,null),m.current&&(m.current.destroy(),m.current=null)};return(0,t.useEffect)((()=>{!a&&m.current&&c&&function(e,t){const s=e.options;s&&t&&Object.assign(s,t)}(m.current,c)}),[a,c]),(0,t.useEffect)((()=>{!a&&m.current&&tS(m.current.config.data,l.labels)}),[a,l.labels]),(0,t.useEffect)((()=>{!a&&m.current&&l.datasets&&sS(m.current.config.data,l.datasets,r)}),[a,l.datasets]),(0,t.useEffect)((()=>{m.current&&(a?(b(),setTimeout(g)):m.current.update(u))}),[a,c,l.labels,l.datasets,u]),(0,t.useEffect)((()=>{m.current&&(b(),setTimeout(g))}),[o]),(0,t.useEffect)((()=>(g(),()=>b())),[]),t.createElement("canvas",{ref:f,role:"img",height:n,width:i,...p},h)}const aS=(0,t.forwardRef)(iS);function rS(e,s){return gl.register(s),(0,t.forwardRef)(((s,n)=>t.createElement(aS,{...s,ref:n,type:e})))}const oS=rS("line",zr),lS=rS("bar",Or),cS=rS("radar",Br),dS=rS("pie",$r);gl.register(dc,fc,Rl,Pl,ql,oc,Vl);const hS=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)("weight"),[c,d]=(0,t.useState)("6months"),[h,u]=(0,t.useState)(null),[p,f]=(0,t.useState)(!1),[m,g]=(0,t.useState)({weight:"",heart_rate:"",blood_pressure_systolic:"",blood_pressure_diastolic:"",blood_sugar:"",oxygen_saturation:"",recorded_at:(new Date).toISOString().split("T")[0]});(0,t.useEffect)((()=>{b()}),[]),(0,t.useEffect)((()=>{e.length>0&&y()}),[e,o,c]);const b=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await Et.from("health_metrics").select("*").eq("user_id",e.id).order("recorded_at",{ascending:!0});if(n)throw n;s(t||[])}catch(e){console.error("Error fetching health data:",e),r({message:"Error fetching health data.",type:"danger"})}finally{i(!1)}},v=e=>{const{name:t,value:s}=e.target;g((e=>({...e,[t]:s})))},y=()=>{const t=new Date;let s=[...e];if("1month"===c){const n=new Date(t.setMonth(t.getMonth()-1));s=e.filter((e=>new Date(e.recorded_at)>=n))}else if("3months"===c){const n=new Date(t.setMonth(t.getMonth()-3));s=e.filter((e=>new Date(e.recorded_at)>=n))}else if("6months"===c){const n=new Date(t.setMonth(t.getMonth()-6));s=e.filter((e=>new Date(e.recorded_at)>=n))}else if("1year"===c){const n=new Date(t.setFullYear(t.getFullYear()-1));s=e.filter((e=>new Date(e.recorded_at)>=n))}const n=s.map((e=>new Date(e.recorded_at).toLocaleDateString())),i=s.map((e=>e[o]||0));let a="#4bc0c0",r="rgba(75, 192, 192, 0.2)";switch(o){case"weight":a="#4bc0c0",r="rgba(75, 192, 192, 0.2)";break;case"heart_rate":a="#ff6384",r="rgba(255, 99, 132, 0.2)";break;case"blood_pressure_systolic":case"blood_pressure_diastolic":a="#ff9f40",r="rgba(255, 159, 64, 0.2)";break;case"blood_sugar":a="#9966ff",r="rgba(153, 102, 255, 0.2)";break;case"oxygen_saturation":a="#36a2eb",r="rgba(54, 162, 235, 0.2)"}u({labels:n,datasets:[{label:x(o),data:i,borderColor:a,backgroundColor:r,tension:.1,fill:!0}]})},x=e=>{switch(e){case"weight":return"Weight (kg)";case"heart_rate":return"Heart Rate (bpm)";case"blood_pressure_systolic":return"Blood Pressure - Systolic (mmHg)";case"blood_pressure_diastolic":return"Blood Pressure - Diastolic (mmHg)";case"blood_sugar":return"Blood Sugar (mg/dL)";case"oxygen_saturation":return"Oxygen Saturation (%)";default:return e}},w=t=>{if(0===e.length)return"N/A";const s=[...e].sort(((e,t)=>new Date(t.recorded_at)-new Date(e.recorded_at))),n=s[0][t];if(void 0===n||null===n)return"N/A";switch(t){case"weight":return`${n} kg`;case"heart_rate":return`${n} bpm`;case"blood_pressure_systolic":return`${n}/${s[0].blood_pressure_diastolic||"N/A"} mmHg`;case"blood_pressure_diastolic":return`${s[0].blood_pressure_systolic||"N/A"}/${n} mmHg`;case"blood_sugar":return`${n} mg/dL`;case"oxygen_saturation":return`${n}%`;default:return n}};return n&&0===e.length?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[a&&(0,Me.jsx)("div",{className:`alert alert-${a.type} text-center`,children:a.message}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,Me.jsxs)("h1",{children:[(0,Me.jsx)(Vt,{className:"me-2"})," Health Analytics"]}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("button",{className:"btn btn-primary me-2",onClick:()=>f(!p),children:p?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Ns,{})," Cancel"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(ws,{})," Add New Metrics"]})}),e.length>0&&(0,Me.jsx)("button",{className:"btn btn-success",onClick:()=>{const t=e.map((e=>[new Date(e.recorded_at).toLocaleDateString(),e.weight||"",e.heart_rate||"",`${e.blood_pressure_systolic||""}/${e.blood_pressure_diastolic||""}`,e.blood_sugar||"",e.oxygen_saturation?`${e.oxygen_saturation}%`:""])),s=[["Date","Weight (kg)","Heart Rate (bpm)","Blood Pressure (mmHg)","Blood Sugar (mg/dL)","Oxygen Saturation (%)"].join(","),...t.map((e=>e.join(",")))].join("\n"),n=new Blob([s],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(n),a=document.createElement("a");a.setAttribute("href",i),a.setAttribute("download",`health_metrics_${(new Date).toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},children:"Export Data"})]})]}),p&&(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Me.jsx)("h3",{className:"mb-0",children:"Add New Health Metrics"})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const t=Object.fromEntries(Object.entries(m).filter((e=>{let[t,s]=e;return""!==s})));t.user_id=e.id;const{error:s}=await Et.from("health_metrics").insert([t]);if(s)throw s;r({message:"Health metrics added successfully!",type:"success"}),f(!1),g({weight:"",heart_rate:"",blood_pressure_systolic:"",blood_pressure_diastolic:"",blood_sugar:"",oxygen_saturation:"",recorded_at:(new Date).toISOString().split("T")[0]}),b()}catch(t){console.error("Error adding health metrics:",t),r({message:"Error adding health metrics.",type:"danger"})}finally{i(!1)}},children:[(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"recorded_at",className:"form-label",children:"Date"}),(0,Me.jsx)("input",{type:"date",className:"form-control",id:"recorded_at",name:"recorded_at",value:m.recorded_at,onChange:v,required:!0})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"weight",className:"form-label",children:"Weight (kg)"}),(0,Me.jsx)("input",{type:"number",step:"0.1",className:"form-control",id:"weight",name:"weight",value:m.weight,onChange:v,placeholder:"e.g. 70.5"})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"heart_rate",className:"form-label",children:"Heart Rate (bpm)"}),(0,Me.jsx)("input",{type:"number",className:"form-control",id:"heart_rate",name:"heart_rate",value:m.heart_rate,onChange:v,placeholder:"e.g. 72"})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"oxygen_saturation",className:"form-label",children:"Oxygen Saturation (%)"}),(0,Me.jsx)("input",{type:"number",min:"0",max:"100",className:"form-control",id:"oxygen_saturation",name:"oxygen_saturation",value:m.oxygen_saturation,onChange:v,placeholder:"e.g. 98"})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"blood_pressure_systolic",className:"form-label",children:"Blood Pressure - Systolic (mmHg)"}),(0,Me.jsx)("input",{type:"number",className:"form-control",id:"blood_pressure_systolic",name:"blood_pressure_systolic",value:m.blood_pressure_systolic,onChange:v,placeholder:"e.g. 120"})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"blood_pressure_diastolic",className:"form-label",children:"Blood Pressure - Diastolic (mmHg)"}),(0,Me.jsx)("input",{type:"number",className:"form-control",id:"blood_pressure_diastolic",name:"blood_pressure_diastolic",value:m.blood_pressure_diastolic,onChange:v,placeholder:"e.g. 80"})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"blood_sugar",className:"form-label",children:"Blood Sugar (mg/dL)"}),(0,Me.jsx)("input",{type:"number",className:"form-control",id:"blood_sugar",name:"blood_sugar",value:m.blood_sugar,onChange:v,placeholder:"e.g. 100"})]}),(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:n,children:n?"Saving...":"Save Metrics"})]})})]}),0===e.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No health data available. Please add health metrics to see analytics."}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsxs)("div",{className:"row mb-4",children:[(0,Me.jsx)("div",{className:"col-md-4 mb-3",children:(0,Me.jsx)("div",{className:"card shadow h-100",children:(0,Me.jsxs)("div",{className:"card-body text-center",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)($s,{className:"me-2"})," Weight"]}),(0,Me.jsx)("h2",{className:"card-text",children:w("weight")})]})})}),(0,Me.jsx)("div",{className:"col-md-4 mb-3",children:(0,Me.jsx)("div",{className:"card shadow h-100",children:(0,Me.jsxs)("div",{className:"card-body text-center",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(ls,{className:"me-2"})," Heart Rate"]}),(0,Me.jsx)("h2",{className:"card-text",children:w("heart_rate")})]})})}),(0,Me.jsx)("div",{className:"col-md-4 mb-3",children:(0,Me.jsx)("div",{className:"card shadow h-100",children:(0,Me.jsxs)("div",{className:"card-body text-center",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(Ts,{className:"me-2"})," Blood Pressure"]}),(0,Me.jsx)("h2",{className:"card-text",children:w("blood_pressure_systolic")})]})})})]}),(0,Me.jsx)("div",{className:"card shadow mb-4",children:(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"metricSelect",className:"form-label",children:"Select Metric"}),(0,Me.jsxs)("select",{id:"metricSelect",className:"form-select",value:o,onChange:e=>l(e.target.value),children:[(0,Me.jsx)("option",{value:"weight",children:"Weight"}),(0,Me.jsx)("option",{value:"heart_rate",children:"Heart Rate"}),(0,Me.jsx)("option",{value:"blood_pressure_systolic",children:"Blood Pressure (Systolic)"}),(0,Me.jsx)("option",{value:"blood_pressure_diastolic",children:"Blood Pressure (Diastolic)"}),(0,Me.jsx)("option",{value:"blood_sugar",children:"Blood Sugar"}),(0,Me.jsx)("option",{value:"oxygen_saturation",children:"Oxygen Saturation"})]})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"timeRangeSelect",className:"form-label",children:"Time Range"}),(0,Me.jsxs)("select",{id:"timeRangeSelect",className:"form-select",value:c,onChange:e=>d(e.target.value),children:[(0,Me.jsx)("option",{value:"1month",children:"Last Month"}),(0,Me.jsx)("option",{value:"3months",children:"Last 3 Months"}),(0,Me.jsx)("option",{value:"6months",children:"Last 6 Months"}),(0,Me.jsx)("option",{value:"1year",children:"Last Year"}),(0,Me.jsx)("option",{value:"all",children:"All Time"})]})]})]})})}),(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsxs)("h3",{className:"mb-0",children:[(e=>{switch(e){case"weight":return(0,Me.jsx)($s,{});case"heart_rate":return(0,Me.jsx)(ls,{});case"blood_pressure_systolic":case"blood_pressure_diastolic":case"blood_sugar":return(0,Me.jsx)(Ts,{});case"oxygen_saturation":return(0,Me.jsx)(gs,{});default:return(0,Me.jsx)(Vt,{})}})(o)," ",x(o)," Trend"]})}),(0,Me.jsx)("div",{className:"card-body",children:h?(0,Me.jsx)(oS,{data:h,options:{responsive:!0,plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1}},scales:{y:{beginAtZero:!1}}}}):(0,Me.jsx)("p",{className:"text-center",children:"No data available for the selected metric and time range."})})]}),(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsx)("h3",{className:"mb-0",children:"Health Insights"})}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("p",{children:"This dashboard provides a visual representation of your health metrics over time. Track your progress and identify trends to better manage your health."}),(0,Me.jsx)("p",{children:"For personalized health advice, please consult with your healthcare provider."})]})]})]})]})},uS=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,doctor_name:"",specialty:"",date:"",time:"",location:"",notes:"",reminder_set:!1});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:i}=await Et.from("appointments").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(i)throw i;s(n||[])}catch(e){console.error("Error fetching appointments:",e),r({message:"Error fetching appointments.",type:"danger"})}finally{i(!1)}},u=e=>{const{name:t,value:s,type:n,checked:i}=e.target;d((e=>({...e,[t]:"checkbox"===n?i:s})))},p=()=>{l(!1),d({id:null,doctor_name:"",specialty:"",date:"",time:"",location:"",notes:"",reminder_set:!1})},f=e=>e===(new Date).toISOString().split("T")[0],m=e=>{const t=new Date,s=new Date(e)-t,n=Math.ceil(s/864e5);return n>0&&n<=3};return n&&0===e.length?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[a&&(0,Me.jsx)("div",{className:`alert alert-${a.type} text-center`,children:a.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(Ut,{className:"me-2"})," Upcoming Appointments"]}),(0,Me.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Me.jsx)("h3",{children:o?"Edit Appointment":"Schedule New Appointment"}),(0,Me.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await Et.from("appointments").update({doctor_name:c.doctor_name,specialty:c.specialty,date:c.date,time:c.time,location:c.location,notes:c.notes,reminder_set:c.reminder_set}).eq("id",c.id);if(e)throw e;r({message:"Appointment updated successfully!",type:"success"})}else{const{error:t}=await Et.from("appointments").insert([{doctor_name:c.doctor_name,specialty:c.specialty,date:c.date,time:c.time,location:c.location,notes:c.notes,reminder_set:c.reminder_set,user_id:e.id}]);if(t)throw t;r({message:"Appointment added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving appointment:",t),r({message:"Error saving appointment.",type:"danger"})}finally{i(!1)}},children:[(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"doctor_name",className:"form-label",children:"Doctor Name"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"doctor_name",name:"doctor_name",value:c.doctor_name,onChange:u,required:!0})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"specialty",className:"form-label",children:"Specialty"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"specialty",name:"specialty",value:c.specialty,onChange:u})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"date",className:"form-label",children:"Date"}),(0,Me.jsx)("input",{type:"date",className:"form-control",id:"date",name:"date",value:c.date,onChange:u,required:!0})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"time",className:"form-label",children:"Time"}),(0,Me.jsx)("input",{type:"time",className:"form-control",id:"time",name:"time",value:c.time,onChange:u,required:!0})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"location",className:"form-label",children:"Location"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"location",name:"location",value:c.location,onChange:u,required:!0})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Me.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u})]}),(0,Me.jsxs)("div",{className:"mb-3 form-check",children:[(0,Me.jsx)("input",{type:"checkbox",className:"form-check-input",id:"reminder_set",name:"reminder_set",checked:c.reminder_set,onChange:u}),(0,Me.jsx)("label",{className:"form-check-label",htmlFor:"reminder_set",children:"Set Reminder"})]}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Zt,{className:"me-2"})," Update Appointment"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(ws,{className:"me-2"})," Schedule Appointment"]})}),o&&(0,Me.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),e.some((e=>f(e.date)))&&(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Me.jsxs)("h3",{className:"mb-0",children:[(0,Me.jsx)(Xt,{className:"me-2"})," Today's Appointments"]})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsx)("div",{className:"row",children:e.filter((e=>f(e.date))).map((e=>(0,Me.jsx)("div",{className:"col-md-6 mb-3",children:(0,Me.jsx)("div",{className:"card h-100 border-primary",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h5",{className:"card-title",children:e.doctor_name}),(0,Me.jsx)("h6",{className:"card-subtitle mb-2 text-muted",children:e.specialty}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(Xt,{className:"me-2"})," ",e.time,(0,Me.jsx)("br",{}),(0,Me.jsx)(bs,{className:"me-2"})," ",e.location]}),e.notes&&(0,Me.jsx)("p",{className:"card-text",children:e.notes})]})})},`today-${e.id}`)))})})]}),(0,Me.jsx)("h2",{className:"text-center mb-3",children:"All Upcoming Appointments"}),0===e.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No upcoming appointments. Schedule your first appointment above."}):(0,Me.jsx)("div",{className:"row",children:e.map((t=>(0,Me.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Me.jsxs)("div",{className:"card h-100 shadow "+(f(t.date)?"border-primary":m(t.date)?"border-warning":""),children:[(0,Me.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,Me.jsxs)("h5",{className:"mb-0",children:[(0,Me.jsx)(Ls,{className:"me-2"})," ",t.doctor_name]}),f(t.date)&&(0,Me.jsx)("span",{className:"badge bg-primary",children:"Today"}),m(t.date)&&!f(t.date)&&(0,Me.jsx)("span",{className:"badge bg-warning text-dark",children:"Soon"})]}),(0,Me.jsxs)("div",{className:"card-body",children:[t.specialty&&(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Specialty:"})," ",t.specialty]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(Ut,{className:"me-2"})," ",new Date(t.date).toLocaleDateString()]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(Xt,{className:"me-2"})," ",t.time]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(bs,{className:"me-2"})," ",t.location]}),t.notes&&(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Notes:"}),(0,Me.jsx)("br",{}),t.notes]}),t.reminder_set&&(0,Me.jsx)("p",{className:"card-text",children:(0,Me.jsx)("span",{className:"badge bg-info text-dark",children:"Reminder Set"})})]}),(0,Me.jsxs)("div",{className:"card-footer d-flex justify-content-between",children:[(0,Me.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:[(0,Me.jsx)(Zt,{className:"me-1"})," Edit"]}),(0,Me.jsxs)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this appointment?")){i(!0);try{const{error:n}=await Et.from("appointments").delete().eq("id",t);if(n)throw n;s(e.filter((e=>e.id!==t))),r({message:"Appointment deleted successfully!",type:"success"})}catch(n){console.error("Error deleting appointment:",n),r({message:"Error deleting appointment.",type:"danger"})}finally{i(!1)}}})(t.id),children:[(0,Me.jsx)(Rs,{className:"me-1"})," Cancel"]})]})]})},t.id)))})]})},pS=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[h,u]=(0,t.useState)(""),[p,f]=(0,t.useState)("desc");(0,t.useEffect)((()=>{m()}),[]);const m=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:i}=await Et.from("appointments").select("*").eq("user_id",e.id).lt("date",t).order("date",{ascending:!1});if(i)throw i;s(n||[])}catch(e){console.error("Error fetching appointment history:",e),r({message:"Error fetching appointment history.",type:"danger"})}finally{i(!1)}},g=e.filter((e=>{const t=""===o||e.doctor_name.toLowerCase().includes(o.toLowerCase())||e.specialty&&e.specialty.toLowerCase().includes(o.toLowerCase())||e.location&&e.location.toLowerCase().includes(o.toLowerCase())||e.notes&&e.notes.toLowerCase().includes(o.toLowerCase()),s=""===c||e.date===c,n=""===h||e.doctor_name.toLowerCase().includes(h.toLowerCase());return t&&s&&n})).sort(((e,t)=>{const s=new Date(e.date),n=new Date(t.date);return"desc"===p?n-s:s-n}));return n&&0===e.length?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[a&&(0,Me.jsx)("div",{className:`alert alert-${a.type} text-center`,children:a.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(cs,{className:"me-2"})," Appointment History"]}),(0,Me.jsx)("div",{className:"card shadow mb-4",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("div",{className:"row mb-3",children:[(0,Me.jsx)("div",{className:"col-md-6 mb-2",children:(0,Me.jsxs)("div",{className:"input-group",children:[(0,Me.jsx)("span",{className:"input-group-text",children:(0,Me.jsx)(As,{})}),(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Search appointments...",value:o,onChange:e=>{l(e.target.value)}})]})}),(0,Me.jsx)("div",{className:"col-md-3 mb-2",children:(0,Me.jsx)("input",{type:"date",className:"form-control",placeholder:"Filter by date",value:c,onChange:e=>{d(e.target.value)}})}),(0,Me.jsx)("div",{className:"col-md-3 mb-2",children:(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Filter by doctor",value:h,onChange:e=>{u(e.target.value)}})})]}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,Me.jsxs)("button",{className:"btn btn-outline-secondary",onClick:()=>{f("desc"===p?"asc":"desc")},children:["Sort by Date: ","desc"===p?"Newest First":"Oldest First"]}),(0,Me.jsxs)("button",{className:"btn btn-success",onClick:()=>{const e=g.map((e=>[e.doctor_name,e.specialty,new Date(e.date).toLocaleDateString(),e.time,e.location,e.notes])),t=[["Doctor","Specialty","Date","Time","Location","Notes"].join(","),...e.map((e=>e.map((e=>`"${e||""}"`)).join(",")))].join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(s),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download",`appointment_history_${(new Date).toISOString().split("T")[0]}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)},disabled:0===g.length,children:[(0,Me.jsx)(ns,{className:"me-2"})," Export to CSV"]})]})]})}),0===e.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No appointment history found."}):0===g.length?(0,Me.jsx)("div",{className:"alert alert-warning text-center",children:"No appointments match your search criteria."}):(0,Me.jsx)("div",{className:"row",children:g.map((e=>(0,Me.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Me.jsxs)("div",{className:"card h-100 shadow",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsxs)("h5",{className:"mb-0",children:[(0,Me.jsx)(Ls,{className:"me-2"})," ",e.doctor_name]})}),(0,Me.jsxs)("div",{className:"card-body",children:[e.specialty&&(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Specialty:"})," ",e.specialty]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(Ht,{className:"me-2"})," ",new Date(e.date).toLocaleDateString()]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(Xt,{className:"me-2"})," ",e.time]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(bs,{className:"me-2"})," ",e.location]}),e.notes&&(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Notes:"}),(0,Me.jsx)("br",{}),e.notes]})]})]})},e.id)))})]})},fS=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)(!0),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,doctor_name:"",specialty:"",date:"",time:"",consultation_type:"video",meeting_link:"",notes:"",reminder_set:!1});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await Et.from("telehealth_consultations").select("*").eq("user_id",e.id).order("date",{ascending:!0});if(n)throw n;s(t||[])}catch(e){console.error("Error fetching consultations:",e),r({message:"Error fetching consultations.",type:"danger"})}finally{i(!1)}},u=e=>{const{name:t,value:s,type:n,checked:i}=e.target;d((e=>({...e,[t]:"checkbox"===n?i:s})))},p=()=>{l(!1),d({id:null,doctor_name:"",specialty:"",date:"",time:"",consultation_type:"video",meeting_link:"",notes:"",reminder_set:!1})},f=e=>e===(new Date).toISOString().split("T")[0],m=e=>e<(new Date).toISOString().split("T")[0],g=e=>{const t=new Date,s=new Date(e)-t,n=Math.ceil(s/864e5);return n>0&&n<=3},b=e.filter((e=>!m(e.date))),v=e.filter((e=>m(e.date)));return n&&0===e.length?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[a&&(0,Me.jsx)("div",{className:`alert alert-${a.type} text-center`,children:a.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(zs,{className:"me-2"})," Telehealth Consultations"]}),(0,Me.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Me.jsx)("h3",{children:o?"Edit Consultation":"Schedule New Consultation"}),(0,Me.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await Et.from("telehealth_consultations").update({doctor_name:c.doctor_name,specialty:c.specialty,date:c.date,time:c.time,consultation_type:c.consultation_type,meeting_link:c.meeting_link,notes:c.notes,reminder_set:c.reminder_set}).eq("id",c.id);if(e)throw e;r({message:"Consultation updated successfully!",type:"success"})}else{const{error:t}=await Et.from("telehealth_consultations").insert([{doctor_name:c.doctor_name,specialty:c.specialty,date:c.date,time:c.time,consultation_type:c.consultation_type,meeting_link:c.meeting_link,notes:c.notes,reminder_set:c.reminder_set,user_id:e.id}]);if(t)throw t;r({message:"Consultation added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving consultation:",t),r({message:"Error saving consultation.",type:"danger"})}finally{i(!1)}},children:[(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"doctor_name",className:"form-label",children:"Doctor Name"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"doctor_name",name:"doctor_name",value:c.doctor_name,onChange:u,required:!0})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"specialty",className:"form-label",children:"Specialty"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"specialty",name:"specialty",value:c.specialty,onChange:u})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"date",className:"form-label",children:"Date"}),(0,Me.jsx)("input",{type:"date",className:"form-control",id:"date",name:"date",value:c.date,onChange:u,required:!0})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"time",className:"form-label",children:"Time"}),(0,Me.jsx)("input",{type:"time",className:"form-control",id:"time",name:"time",value:c.time,onChange:u,required:!0})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"consultation_type",className:"form-label",children:"Consultation Type"}),(0,Me.jsxs)("select",{className:"form-control",id:"consultation_type",name:"consultation_type",value:c.consultation_type,onChange:u,required:!0,children:[(0,Me.jsx)("option",{value:"video",children:"Video Call"}),(0,Me.jsx)("option",{value:"phone",children:"Phone Call"}),(0,Me.jsx)("option",{value:"chat",children:"Chat"})]})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"meeting_link",className:"form-label",children:"Meeting Link/Phone Number"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"meeting_link",name:"meeting_link",value:c.meeting_link,onChange:u,placeholder:"Enter meeting link or phone number"})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Me.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u,placeholder:"Reason for consultation, questions to ask, etc."})]}),(0,Me.jsxs)("div",{className:"mb-3 form-check",children:[(0,Me.jsx)("input",{type:"checkbox",className:"form-check-input",id:"reminder_set",name:"reminder_set",checked:c.reminder_set,onChange:u}),(0,Me.jsx)("label",{className:"form-check-label",htmlFor:"reminder_set",children:"Set Reminder"})]}),(0,Me.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Zt,{className:"me-2"})," Update Consultation"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(ws,{className:"me-2"})," Schedule Consultation"]})}),o&&(0,Me.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),e.some((e=>f(e.date)))&&(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Me.jsxs)("h3",{className:"mb-0",children:[(0,Me.jsx)(Xt,{className:"me-2"})," Today's Consultations"]})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsx)("div",{className:"row",children:e.filter((e=>f(e.date))).map((e=>(0,Me.jsx)("div",{className:"col-md-6 mb-3",children:(0,Me.jsx)("div",{className:"card h-100 border-primary",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h5",{className:"card-title",children:e.doctor_name}),(0,Me.jsx)("h6",{className:"card-subtitle mb-2 text-muted",children:e.specialty}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(Xt,{className:"me-2"})," ",e.time,(0,Me.jsx)("br",{}),"video"===e.consultation_type?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(zs,{className:"me-2"})," Video Call"]}):"phone"===e.consultation_type?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(ys,{className:"me-2"})," Phone Call"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(fs,{className:"me-2"})," Chat"]})]}),e.meeting_link&&(0,Me.jsx)("p",{className:"card-text",children:(0,Me.jsx)("a",{href:"video"===e.consultation_type?e.meeting_link:`tel:${e.meeting_link}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-success",children:"video"===e.consultation_type?"Join Meeting":"Call Now"})}),e.notes&&(0,Me.jsx)("p",{className:"card-text",children:(0,Me.jsx)("small",{children:e.notes})})]})})},`today-${e.id}`)))})})]}),(0,Me.jsx)("h2",{className:"text-center mb-3",children:"Upcoming Consultations"}),0===b.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No upcoming consultations. Schedule your first consultation above."}):(0,Me.jsx)("div",{className:"row",children:b.map((t=>(0,Me.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Me.jsxs)("div",{className:"card h-100 shadow "+(f(t.date)?"border-primary":g(t.date)?"border-warning":""),children:[(0,Me.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,Me.jsxs)("h5",{className:"mb-0",children:[(0,Me.jsx)(Ls,{className:"me-2"})," ",t.doctor_name]}),f(t.date)&&(0,Me.jsx)("span",{className:"badge bg-primary",children:"Today"}),g(t.date)&&!f(t.date)&&(0,Me.jsx)("span",{className:"badge bg-warning text-dark",children:"Soon"})]}),(0,Me.jsxs)("div",{className:"card-body",children:[t.specialty&&(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Specialty:"})," ",t.specialty]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Date:"})," ",new Date(t.date).toLocaleDateString()]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Time:"})," ",t.time]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Type:"})," ","video"===t.consultation_type?"Video Call":"phone"===t.consultation_type?"Phone Call":"Chat"]}),t.meeting_link&&(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Link/Number:"})," ",t.meeting_link]}),t.notes&&(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Notes:"}),(0,Me.jsx)("br",{}),t.notes]}),t.reminder_set&&(0,Me.jsx)("p",{className:"card-text",children:(0,Me.jsx)("span",{className:"badge bg-info text-dark",children:"Reminder Set"})})]}),(0,Me.jsxs)("div",{className:"card-footer d-flex justify-content-between",children:[(0,Me.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:[(0,Me.jsx)(Zt,{className:"me-1"})," Edit"]}),(0,Me.jsxs)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this consultation?")){i(!0);try{const{error:n}=await Et.from("telehealth_consultations").delete().eq("id",t);if(n)throw n;s(e.filter((e=>e.id!==t))),r({message:"Consultation deleted successfully!",type:"success"})}catch(n){console.error("Error deleting consultation:",n),r({message:"Error deleting consultation.",type:"danger"})}finally{i(!1)}}})(t.id),children:[(0,Me.jsx)(Rs,{className:"me-1"})," Cancel"]})]})]})},t.id)))}),v.length>0&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("h2",{className:"text-center mb-3 mt-5",children:"Past Consultations"}),(0,Me.jsx)("div",{className:"table-responsive",children:(0,Me.jsxs)("table",{className:"table table-striped",children:[(0,Me.jsx)("thead",{children:(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("th",{children:"Doctor"}),(0,Me.jsx)("th",{children:"Specialty"}),(0,Me.jsx)("th",{children:"Date"}),(0,Me.jsx)("th",{children:"Time"}),(0,Me.jsx)("th",{children:"Type"}),(0,Me.jsx)("th",{children:"Notes"})]})}),(0,Me.jsx)("tbody",{children:v.map((e=>(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("td",{children:e.doctor_name}),(0,Me.jsx)("td",{children:e.specialty}),(0,Me.jsx)("td",{children:new Date(e.date).toLocaleDateString()}),(0,Me.jsx)("td",{children:e.time}),(0,Me.jsx)("td",{children:"video"===e.consultation_type?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(zs,{className:"me-1"})," Video"]}):"phone"===e.consultation_type?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(ys,{className:"me-1"})," Phone"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(fs,{className:"me-1"})," Chat"]})}),(0,Me.jsx)("td",{children:e.notes})]},`past-${e.id}`)))})]})})]})]})},mS=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)([]),[a,r]=(0,t.useState)(!0),[o,l]=(0,t.useState)(null),[c,d]=(0,t.useState)({email_reminders:!0,sms_reminders:!1,browser_notifications:!0,reminder_time:"24",phone_number:""});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{r(!0);const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:a}=await Et.from("appointments").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(a)throw a;const{data:o,error:l}=await Et.from("telehealth_consultations").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(l)throw l;const c=[...(n||[]).map((e=>({...e,type:"appointment"}))),...(o||[]).map((e=>({...e,type:"telehealth",doctor_name:e.doctor_name})))].sort(((e,t)=>new Date(`${e.date}T${e.time}`)-new Date(`${t.date}T${t.time}`)));s(c);const{data:h,error:u}=await Et.from("reminder_settings").select("*").eq("user_id",e.id).single();if(u&&"PGRST116"!==u.code)throw u;h&&d(h);const{data:p,error:f}=await Et.from("reminders").select("*").eq("user_id",e.id).gte("reminder_time",(new Date).toISOString()).order("reminder_time",{ascending:!0});if(f)throw f;i(p||[])}catch(e){console.error("Error fetching data:",e),l({message:"Error fetching data.",type:"danger"})}finally{r(!1)}},u=e=>{const{name:t,value:s,type:n,checked:i}=e.target;d((e=>({...e,[t]:"checkbox"===n?i:s})))},p=e=>e===(new Date).toISOString().split("T")[0],f=e=>{const t=new Date,s=new Date(e)-t,n=Math.ceil(s/864e5);return n>0&&n<=3};return a&&0===e.length&&0===n.length?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[o&&(0,Me.jsx)("div",{className:`alert alert-${o.type} text-center`,children:o.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(zt,{className:"me-2"})," Appointment Reminders"]}),(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsx)("h3",{className:"mb-0",children:"Reminder Settings"})}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-6 mb-3",children:(0,Me.jsxs)("div",{className:"form-check form-switch",children:[(0,Me.jsx)("input",{className:"form-check-input",type:"checkbox",id:"email_reminders",name:"email_reminders",checked:c.email_reminders,onChange:u}),(0,Me.jsx)("label",{className:"form-check-label",htmlFor:"email_reminders",children:"Email Reminders"})]})}),(0,Me.jsx)("div",{className:"col-md-6 mb-3",children:(0,Me.jsxs)("div",{className:"form-check form-switch",children:[(0,Me.jsx)("input",{className:"form-check-input",type:"checkbox",id:"browser_notifications",name:"browser_notifications",checked:c.browser_notifications,onChange:u}),(0,Me.jsx)("label",{className:"form-check-label",htmlFor:"browser_notifications",children:"Browser Notifications"})]})})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-6 mb-3",children:(0,Me.jsxs)("div",{className:"form-check form-switch",children:[(0,Me.jsx)("input",{className:"form-check-input",type:"checkbox",id:"sms_reminders",name:"sms_reminders",checked:c.sms_reminders,onChange:u}),(0,Me.jsx)("label",{className:"form-check-label",htmlFor:"sms_reminders",children:"SMS Reminders"})]})}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"phone_number",className:"form-label",children:"Phone Number (for SMS)"}),(0,Me.jsx)("input",{type:"tel",className:"form-control",id:"phone_number",name:"phone_number",value:c.phone_number,onChange:u,placeholder:"Enter your phone number",disabled:!c.sms_reminders})]})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"reminder_time",className:"form-label",children:"Send Reminders"}),(0,Me.jsxs)("select",{className:"form-select",id:"reminder_time",name:"reminder_time",value:c.reminder_time,onChange:u,children:[(0,Me.jsx)("option",{value:"1",children:"1 hour before"}),(0,Me.jsx)("option",{value:"2",children:"2 hours before"}),(0,Me.jsx)("option",{value:"6",children:"6 hours before"}),(0,Me.jsx)("option",{value:"12",children:"12 hours before"}),(0,Me.jsx)("option",{value:"24",children:"24 hours before"}),(0,Me.jsx)("option",{value:"48",children:"2 days before"}),(0,Me.jsx)("option",{value:"72",children:"3 days before"})]})]}),(0,Me.jsx)("div",{className:"col-md-6 mb-3 d-flex align-items-end",children:(0,Me.jsx)("button",{className:"btn btn-primary w-100",onClick:async()=>{try{r(!0);const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const{error:t}=await Et.from("reminder_settings").upsert({...c,user_id:e.id});if(t)throw t;l({message:"Reminder settings saved successfully!",type:"success"})}catch(e){console.error("Error saving reminder settings:",e),l({message:"Error saving reminder settings.",type:"danger"})}finally{r(!1)}},disabled:a,children:"Save Settings"})})]})]})]}),(0,Me.jsx)("h2",{className:"text-center mb-3",children:"Active Reminders"}),0===n.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No active reminders. Set reminders for your appointments below."}):(0,Me.jsx)("div",{className:"table-responsive mb-4",children:(0,Me.jsxs)("table",{className:"table table-striped",children:[(0,Me.jsx)("thead",{children:(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("th",{children:"Appointment"}),(0,Me.jsx)("th",{children:"Doctor"}),(0,Me.jsx)("th",{children:"Appointment Time"}),(0,Me.jsx)("th",{children:"Reminder Time"}),(0,Me.jsx)("th",{children:"Actions"})]})}),(0,Me.jsx)("tbody",{children:n.map((e=>(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("td",{children:"telehealth"===e.appointment_type?"Telehealth":"In-person"}),(0,Me.jsx)("td",{children:e.doctor_name}),(0,Me.jsx)("td",{children:new Date(e.appointment_time).toLocaleString()}),(0,Me.jsx)("td",{children:new Date(e.reminder_time).toLocaleString()}),(0,Me.jsx)("td",{children:(0,Me.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this reminder?"))try{r(!0);const{data:t,error:s}=await Et.from("reminders").select("*").eq("id",e).single();if(s)throw s;if("appointment"===t.appointment_type){const{error:e}=await Et.from("appointments").update({reminder_set:!1}).eq("id",t.appointment_id);if(e)throw e}else{const{error:e}=await Et.from("telehealth_consultations").update({reminder_set:!1}).eq("id",t.appointment_id);if(e)throw e}const{error:n}=await Et.from("reminders").delete().eq("id",e);if(n)throw n;l({message:"Reminder deleted successfully!",type:"success"}),h()}catch(t){console.error("Error deleting reminder:",t),l({message:"Error deleting reminder.",type:"danger"})}finally{r(!1)}})(e.id),children:(0,Me.jsx)(Rs,{})})})]},e.id)))})]})}),(0,Me.jsx)("h2",{className:"text-center mb-3",children:"Upcoming Appointments"}),0===e.length?(0,Me.jsx)("div",{className:"alert alert-info text-center",children:"No upcoming appointments found. Schedule appointments to set reminders."}):(0,Me.jsx)("div",{className:"row",children:e.map((e=>(0,Me.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Me.jsxs)("div",{className:"card h-100 shadow "+(p(e.date)?"border-primary":f(e.date)?"border-warning":""),children:[(0,Me.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,Me.jsxs)("h5",{className:"mb-0",children:[(0,Me.jsx)(Ls,{className:"me-2"})," ",e.doctor_name]}),p(e.date)&&(0,Me.jsx)("span",{className:"badge bg-primary",children:"Today"}),f(e.date)&&!p(e.date)&&(0,Me.jsx)("span",{className:"badge bg-warning text-dark",children:"Soon"})]}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(Ht,{className:"me-2"})," ",new Date(e.date).toLocaleDateString()]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)(Xt,{className:"me-2"})," ",e.time]}),(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Type:"})," ","telehealth"===e.type?"Telehealth Consultation":"In-person Appointment"]}),e.location&&(0,Me.jsxs)("p",{className:"card-text",children:[(0,Me.jsx)("strong",{children:"Location:"})," ",e.location]})]}),(0,Me.jsx)("div",{className:"card-footer",children:(0,Me.jsx)("button",{className:"btn btn-block w-100",onClick:()=>(async e=>{try{r(!0);const{data:{user:t}}=await Et.auth.getUser();if(!t)return void(window.location.href="/");if(e.reminder_set){if("appointment"===e.type){const{error:t}=await Et.from("appointments").update({reminder_set:!1}).eq("id",e.id);if(t)throw t}else{const{error:t}=await Et.from("telehealth_consultations").update({reminder_set:!1}).eq("id",e.id);if(t)throw t}const{error:t}=await Et.from("reminders").delete().eq("appointment_id",e.id).eq("appointment_type",e.type);if(t)throw t;l({message:"Reminder removed successfully!",type:"success"})}else{const s=new Date(`${e.date}T${e.time}`),n=parseInt(c.reminder_time,10),i=new Date(s.getTime()-60*n*60*1e3);if("appointment"===e.type){const{error:t}=await Et.from("appointments").update({reminder_set:!0}).eq("id",e.id);if(t)throw t}else{const{error:t}=await Et.from("telehealth_consultations").update({reminder_set:!0}).eq("id",e.id);if(t)throw t}const{error:a}=await Et.from("reminders").insert([{user_id:t.id,appointment_id:e.id,appointment_type:e.type,reminder_time:i.toISOString(),appointment_time:s.toISOString(),doctor_name:e.doctor_name,location:e.location||"",sent:!1}]);if(a)throw a;l({message:"Reminder set successfully!",type:"success"})}h()}catch(t){console.error("Error toggling reminder:",t),l({message:"Error toggling reminder.",type:"danger"})}finally{r(!1)}})(e),disabled:a,children:e.reminder_set?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Ms,{className:"me-2"})," Reminder On"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Ps,{className:"me-2"})," Set Reminder"]})})})]})},e.id)))})]})},gS=()=>{const[e,s]=(0,t.useState)(""),[n,i]=(0,t.useState)("all"),[a,r]=(0,t.useState)({}),[o,l]=(0,t.useState)([]),[c,d]=(0,t.useState)([]),[h,u]=(0,t.useState)(!0),[p,f]=(0,t.useState)(null),[m,g]=(0,t.useState)([]);(0,t.useEffect)((()=>{b()}),[]);const b=async()=>{try{u(!0);const{data:e,error:t}=await Et.from("faqs").select("*").order("id");if(t)throw t;const{data:s,error:n}=await Et.from("tutorials").select("*").order("id");if(n)throw n;l(e||[]),d(s||[]);const i=[...new Set(e.map((e=>e.category)))],a=[...new Set(s.map((e=>e.category)))],r=[...new Set([...i,...a])];g(r)}catch(e){console.error("Error fetching help center data:",e),f({message:"Error loading help center content.",type:"danger"}),l(v),d(y),g([...new Set([...v.map((e=>e.category)),...y.map((e=>e.category))])])}finally{u(!1)}},v=[{id:1,category:"account",question:"How do I create an account?",answer:'To create an account, click on the "Sign Up" button on the login page. Fill in your personal details, including your email address and a secure password. Follow the verification steps sent to your email to complete the registration process.'},{id:2,category:"account",question:"How do I reset my password?",answer:'If you forgot your password, click on the "Forgot Password" link on the login page. Enter your registered email address, and we will send you a password reset link. Follow the instructions in the email to create a new password.'},{id:3,category:"appointments",question:"How do I schedule an appointment?",answer:'To schedule an appointment, navigate to the "Appointments" section in the navigation menu and select "Upcoming Appointments". Click on the "Schedule New Appointment" button and fill in the required details such as doctor name, date, time, and location. Click "Schedule Appointment" to confirm.'},{id:4,category:"appointments",question:"How do I cancel or reschedule an appointment?",answer:'To cancel or reschedule an appointment, go to the "Upcoming Appointments" page. Find the appointment you want to modify, then click the "Edit" button to change the date or time, or click the "Cancel" button to cancel the appointment entirely.'},{id:5,category:"medical",question:"How do I add my medical history?",answer:'To add your medical history, navigate to the "Medical History" page from the "Your Journey" menu. Click on "Add New Medical Record" and fill in the details about your condition, diagnosis date, doctor, and treatment. Click "Add Record" to save the information.'},{id:6,category:"medical",question:"How do I track my medications?",answer:'To track your medications, go to the "Medication Tracker" page from the "Your Journey" menu. Enter the medication name, frequency, and quantity, then click "Add Medication". You can view and manage all your medications from this page.'},{id:7,category:"telehealth",question:"How do I join a telehealth consultation?",answer:'To join a telehealth consultation, go to the "Telehealth Consultations" page. On the day of your appointment, you will see your consultation listed under "Today\'s Consultations". Click the "Join Meeting" button at the scheduled time to enter the virtual consultation room.'},{id:8,category:"telehealth",question:"What equipment do I need for a telehealth consultation?",answer:"For a telehealth consultation, you need a device with a camera and microphone (smartphone, tablet, or computer), a stable internet connection, and a quiet, private space. Make sure your device is charged and your browser allows camera and microphone access."},{id:9,category:"data",question:"Is my health data secure?",answer:"Yes, your health data is secure. We use industry-standard encryption and security measures to protect your personal and medical information. Our platform complies with healthcare privacy regulations, and your data is only accessible to you and the healthcare providers you authorize."},{id:10,category:"data",question:"How do I export my health data?",answer:'To export your health data, go to the "Data Backup & Export" page under the "Account" menu. Select the type of data you want to export and the format (PDF, CSV, etc.). Click "Export Data" and follow the prompts to download your information.'}],y=[{id:1,category:"getting-started",title:"Getting Started with DigiHealth",type:"video",description:"Learn the basics of navigating the DigiHealth platform and setting up your profile.",link:"#"},{id:2,category:"appointments",title:"How to Schedule and Manage Appointments",type:"guide",description:"A step-by-step guide to scheduling, rescheduling, and canceling appointments.",link:"#"},{id:3,category:"medical",title:"Managing Your Medical Records",type:"video",description:"Learn how to add, edit, and organize your medical history and records.",link:"#"},{id:4,category:"telehealth",title:"Preparing for Your First Telehealth Consultation",type:"guide",description:"Tips and instructions for a successful virtual healthcare appointment.",link:"#"},{id:5,category:"data",title:"Understanding Your Health Analytics",type:"video",description:"How to interpret and use the health analytics features to monitor your well-being.",link:"#"},{id:6,category:"account",title:"Account Security Best Practices",type:"guide",description:"Learn how to keep your DigiHealth account secure with strong passwords and two-factor authentication.",link:"#"}],x=o.filter((t=>{const s=""===e||t.question.toLowerCase().includes(e.toLowerCase())||t.answer.toLowerCase().includes(e.toLowerCase()),i="all"===n||t.category===n;return s&&i})),w=c.filter((t=>{const s=""===e||t.title.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase()),i="all"===n||t.category===n;return s&&i}));return h?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"container mt-4",children:[p&&(0,Me.jsx)("div",{className:`alert alert-${p.type} text-center`,children:p.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)($t,{className:"me-2"})," Help Center"]}),(0,Me.jsx)("div",{className:"card shadow mb-4",children:(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-8 mb-3",children:(0,Me.jsxs)("div",{className:"input-group",children:[(0,Me.jsx)("span",{className:"input-group-text",children:(0,Me.jsx)(As,{})}),(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Search for help topics...",value:e,onChange:e=>s(e.target.value)})]})}),(0,Me.jsx)("div",{className:"col-md-4 mb-3",children:(0,Me.jsxs)("select",{className:"form-select",value:n,onChange:e=>i(e.target.value),children:[(0,Me.jsx)("option",{value:"all",children:"All Categories"}),m.map(((e,t)=>(0,Me.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1).replace("-"," ")},t)))]})})]})})}),(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Me.jsxs)("h2",{className:"mb-0",children:[(0,Me.jsx)(_s,{className:"me-2"})," Frequently Asked Questions"]})}),(0,Me.jsx)("div",{className:"card-body",children:0===x.length?(0,Me.jsx)("div",{className:"alert alert-info",children:"No FAQs match your search criteria. Try a different search term or category."}):(0,Me.jsx)("div",{className:"accordion",children:x.map((e=>(0,Me.jsxs)("div",{className:"card mb-2",children:[(0,Me.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",onClick:()=>{var t;t=e.id,r((e=>({...e,[t]:!e[t]}))),(async e=>{try{a[e]||await Et.from("faq_analytics").insert([{faq_id:e,viewed_at:(new Date).toISOString()}])}catch(t){console.error("Error tracking FAQ view:",t)}})(e.id)},style:{cursor:"pointer"},children:[(0,Me.jsx)("h5",{className:"mb-0",children:e.question}),a[e.id]?(0,Me.jsx)(Gt,{}):(0,Me.jsx)(qt,{})]}),a[e.id]&&(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsx)("p",{children:e.answer})})]},e.id)))})})]}),(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-success text-white",children:(0,Me.jsxs)("h2",{className:"mb-0",children:[(0,Me.jsx)(zs,{className:"me-2"})," Tutorials & Guides"]})}),(0,Me.jsx)("div",{className:"card-body",children:0===w.length?(0,Me.jsx)("div",{className:"alert alert-info",children:"No tutorials match your search criteria. Try a different search term or category."}):(0,Me.jsx)("div",{className:"row",children:w.map((e=>(0,Me.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Me.jsxs)("div",{className:"card h-100",children:[(0,Me.jsxs)("div",{className:"card-header",children:["video"===e.type?(0,Me.jsx)(zs,{className:"me-2 text-danger"}):(0,Me.jsx)(ss,{className:"me-2 text-primary"}),(0,Me.jsx)("span",{className:"badge bg-secondary",children:e.category.replace("-"," ")})]}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h5",{className:"card-title",children:e.title}),(0,Me.jsx)("p",{className:"card-text",children:e.description})]}),(0,Me.jsx)("div",{className:"card-footer",children:(0,Me.jsx)("a",{href:e.link,className:"btn btn-primary btn-sm w-100",onClick:()=>(async e=>{try{await Et.from("tutorial_analytics").insert([{tutorial_id:e,clicked_at:(new Date).toISOString()}])}catch(t){console.error("Error tracking tutorial click:",t)}})(e.id),target:"_blank",rel:"noopener noreferrer",children:"video"===e.type?"Watch Video":"Read Guide"})})]})},e.id)))})})]}),(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-info text-white",children:(0,Me.jsx)("h2",{className:"mb-0",children:"Need More Help?"})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-4 mb-3",children:(0,Me.jsx)("div",{className:"card h-100 text-center",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h3",{children:"Contact Support"}),(0,Me.jsx)("p",{children:"Reach out to our support team for personalized assistance."}),(0,Me.jsx)("a",{href:"/contact-support",className:"btn btn-primary",children:"Contact Support"})]})})}),(0,Me.jsx)("div",{className:"col-md-4 mb-3",children:(0,Me.jsx)("div",{className:"card h-100 text-center",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h3",{children:"Live Chat"}),(0,Me.jsx)("p",{children:"Chat with our support agents in real-time for immediate help."}),(0,Me.jsx)("a",{href:"/live-chat",className:"btn btn-primary",children:"Start Chat"})]})})}),(0,Me.jsx)("div",{className:"col-md-4 mb-3",children:(0,Me.jsx)("div",{className:"card h-100 text-center",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h3",{children:"Email Support"}),(0,Me.jsx)("p",{children:"Send us an email and we'll get back to you within 24 hours."}),(0,Me.jsx)("a",{href:"mailto:support@digihealth.com",className:"btn btn-primary",children:"Email Us"})]})})})]})})]})]})},bS=()=>{const[e,s]=(0,t.useState)(!1),[n,i]=(0,t.useState)(null),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)({subject:"",category:"general",priority:"medium",message:"",attachFile:null}),[c,d]=(0,t.useState)([]);(0,t.useEffect)((()=>{h()}),[]),(0,t.useEffect)((()=>{if(o.subject.length>3||o.message.length>10){const e=`${o.subject} ${o.message}`.toLowerCase(),t=[{question:"How do I reset my password?",answer:'Click on "Forgot Password" on the login page and follow the instructions sent to your email.',keywords:["password","reset","forgot","login","sign in","cannot access"]},{question:"How do I schedule an appointment?",answer:'Go to "Upcoming Appointments" and click "Schedule New Appointment".',keywords:["schedule","appointment","book","doctor","visit","consultation"]},{question:"How do I update my profile information?",answer:'Navigate to "Profile Settings" under the Account menu to edit your personal details.',keywords:["profile","update","change","information","details","personal"]},{question:"How do I export my health data?",answer:'Go to "Data Backup & Export" under the Account menu to download your information.',keywords:["export","download","data","backup","information","records"]},{question:"How do I join a telehealth consultation?",answer:'On the day of your appointment, go to "Telehealth Consultations" and click "Join Meeting".',keywords:["telehealth","virtual","video","call","consultation","join","meeting"]}].filter((t=>t.keywords.some((t=>e.includes(t)))));d(t.slice(0,3))}else d([])}),[o.subject,o.message]);const h=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:s}=await Et.from("detailed_profiles").select("*").eq("id",e.id).single();if(s)throw s;r(t)}catch(e){console.error("Error fetching user profile:",e),i({message:"Error fetching user profile.",type:"danger"})}},u=e=>{const{name:t,value:s}=e.target;l((e=>({...e,[t]:s})))};return(0,Me.jsxs)("div",{className:"container mt-4",children:[n&&(0,Me.jsx)("div",{className:`alert alert-${n.type} text-center`,children:n.message}),(0,Me.jsxs)("h1",{className:"text-center mb-4",children:[(0,Me.jsx)(us,{className:"me-2"})," Contact Support"]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-lg-8",children:(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Me.jsx)("h2",{className:"mb-0",children:"Submit a Support Request"})}),(0,Me.jsxs)("div",{className:"card-body",children:[c.length>0&&(0,Me.jsxs)("div",{className:"alert alert-info mb-4",children:[(0,Me.jsxs)("h5",{children:[(0,Me.jsx)(ps,{className:"me-2"})," Did you know?"]}),(0,Me.jsx)("p",{children:"We found some help articles that might answer your question:"}),(0,Me.jsx)("ul",{className:"mb-0",children:c.map(((e,t)=>(0,Me.jsxs)("li",{children:[(0,Me.jsx)("strong",{children:e.question})," - ",e.answer]},t)))})]}),(0,Me.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),s(!0);try{const{data:{user:e}}=await Et.auth.getUser();if(!e)return void(window.location.href="/");let t=null;if(o.attachFile){const s=`${e.id}-${Date.now()}-${o.attachFile.name}`,{data:n,error:i}=await Et.storage.from("support-attachments").upload(s,o.attachFile);if(i)throw i;const{data:a}=Et.storage.from("support-attachments").getPublicUrl(s);t=a.publicUrl}const{error:s}=await Et.from("support_tickets").insert([{user_id:e.id,subject:o.subject,category:o.category,priority:o.priority,message:o.message,attachment_url:t,status:"open",created_at:(new Date).toISOString()}]);if(s)throw s;i({message:"Support ticket submitted successfully! Our team will respond shortly.",type:"success"}),l({subject:"",category:"general",priority:"medium",message:"",attachFile:null}),document.getElementById("attachFile").value=""}catch(t){console.error("Error submitting support ticket:",t),i({message:"Error submitting support ticket. Please try again.",type:"danger"})}finally{s(!1)}},children:[(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"subject",className:"form-label",children:"Subject"}),(0,Me.jsx)("input",{type:"text",className:"form-control",id:"subject",name:"subject",value:o.subject,onChange:u,required:!0,placeholder:"Brief description of your issue"})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"category",className:"form-label",children:"Category"}),(0,Me.jsxs)("select",{className:"form-select",id:"category",name:"category",value:o.category,onChange:u,children:[(0,Me.jsx)("option",{value:"general",children:"General Question"}),(0,Me.jsx)("option",{value:"account",children:"Account Issues"}),(0,Me.jsx)("option",{value:"appointments",children:"Appointments"}),(0,Me.jsx)("option",{value:"medical",children:"Medical Records"}),(0,Me.jsx)("option",{value:"telehealth",children:"Telehealth"}),(0,Me.jsx)("option",{value:"technical",children:"Technical Problem"}),(0,Me.jsx)("option",{value:"billing",children:"Billing & Payments"})]})]}),(0,Me.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Me.jsx)("label",{htmlFor:"priority",className:"form-label",children:"Priority"}),(0,Me.jsxs)("select",{className:"form-select",id:"priority",name:"priority",value:o.priority,onChange:u,children:[(0,Me.jsx)("option",{value:"low",children:"Low - General Question"}),(0,Me.jsx)("option",{value:"medium",children:"Medium - Need Help Soon"}),(0,Me.jsx)("option",{value:"high",children:"High - Urgent Issue"})]})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"message",className:"form-label",children:"Message"}),(0,Me.jsx)("textarea",{className:"form-control",id:"message",name:"message",rows:"6",value:o.message,onChange:u,required:!0,placeholder:"Please describe your issue in detail. Include any error messages or steps to reproduce the problem."})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"attachFile",className:"form-label",children:"Attach File (optional)"}),(0,Me.jsx)("input",{type:"file",className:"form-control",id:"attachFile",onChange:e=>{l((t=>({...t,attachFile:e.target.files[0]})))}}),(0,Me.jsx)("div",{className:"form-text",children:"You can attach screenshots or documents to help explain your issue (max 5MB)."})]}),(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:e,children:e?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):"Submit Support Request"})]})]})]})}),(0,Me.jsxs)("div",{className:"col-lg-4",children:[(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-info text-white",children:(0,Me.jsx)("h3",{className:"mb-0",children:"Contact Information"})}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,Me.jsx)(es,{className:"me-3 fs-4 text-primary"}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h5",{className:"mb-0",children:"Email Support"}),(0,Me.jsx)("p",{className:"mb-0",children:"support@digihealth.com"}),(0,Me.jsx)("small",{className:"text-muted",children:"Response within 24 hours"})]})]}),(0,Me.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,Me.jsx)(ys,{className:"me-3 fs-4 text-primary"}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h5",{className:"mb-0",children:"Phone Support"}),(0,Me.jsx)("p",{className:"mb-0",children:"1-800-DIGI-HEALTH"}),(0,Me.jsx)("small",{className:"text-muted",children:"Mon-Fri, 9am-5pm EST"})]})]}),(0,Me.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Me.jsx)(Yt,{className:"me-3 fs-4 text-primary"}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h5",{className:"mb-0",children:"Live Chat"}),(0,Me.jsx)("p",{className:"mb-0",children:(0,Me.jsx)("a",{href:"/live-chat",className:"btn btn-sm btn-outline-primary mt-1",children:"Start Chat"})}),(0,Me.jsx)("small",{className:"text-muted",children:"Available 24/7"})]})]})]})]}),(0,Me.jsxs)("div",{className:"card shadow mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-success text-white",children:(0,Me.jsx)("h3",{className:"mb-0",children:"Support Resources"})}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,Me.jsx)(_s,{className:"me-3 fs-4 text-success"}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h5",{className:"mb-0",children:"Help Center"}),(0,Me.jsx)("p",{className:"mb-0",children:(0,Me.jsx)("a",{href:"/help-center",className:"btn btn-sm btn-outline-success mt-1",children:"Browse FAQs"})})]})]}),(0,Me.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Me.jsx)(ts,{className:"me-3 fs-4 text-warning"}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h5",{className:"mb-0",children:"System Status"}),(0,Me.jsx)("p",{className:"mb-0",children:(0,Me.jsx)("span",{className:"badge bg-success",children:"All Systems Operational"})})]})]})]})]})]})]})]})},vS=()=>{const{user:e}=Ie(),[s,n]=(0,t.useState)([]),[i,a]=(0,t.useState)(""),[r,o]=(0,t.useState)(!1),[l,c]=(0,t.useState)(!1),[d,h]=(0,t.useState)("connecting"),[u,p]=(0,t.useState)(null),f=(0,t.useRef)(null);(0,t.useEffect)((()=>(m(),()=>{chatSubscription&&chatSubscription.unsubscribe()})),[e]),(0,t.useEffect)((()=>{g()}),[s]);const m=async()=>{try{const{data:t,error:s}=await Et.from("chat_sessions").select("*").eq("user_id",e.id).eq("status","active").single();if(s&&"PGRST116"!==s.code)throw s;let i;if(t)i=t.id;else{const{data:t,error:s}=await Et.from("chat_sessions").insert([{user_id:e.id,status:"active",created_at:(new Date).toISOString()}]).select().single();if(s)throw s;i=t.id}const{data:a,error:r}=await Et.from("chat_messages").select("*").eq("session_id",i).order("created_at",{ascending:!0});if(r)throw r;n(a||[]);Et.channel("chat_messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`session_id=eq.${i}`},(e=>{n((t=>[...t,e.new]))})).subscribe();const{data:o,error:l}=await Et.from("support_agents").select("*").eq("status","online").single();if(l&&"PGRST116"!==l.code)throw l;o?(p(o),h("connected")):h("waiting")}catch(t){console.error("Error initializing chat:",t),h("error")}},g=()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return(0,Me.jsx)("div",{className:"container-fluid h-100",children:(0,Me.jsxs)("div",{className:"row h-100",children:[(0,Me.jsxs)("div",{className:"col-md-3 p-0 border-end",children:[(0,Me.jsxs)("div",{className:"p-3 border-bottom",children:[(0,Me.jsx)("h5",{className:"mb-0",children:"Chat Information"}),(0,Me.jsxs)("small",{className:"text-muted",children:["Status: ",(0,Me.jsx)("span",{className:"text-"+("connected"===d?"success":"warning"),children:d.charAt(0).toUpperCase()+d.slice(1)})]})]}),u&&(0,Me.jsxs)("div",{className:"p-3",children:[(0,Me.jsx)("h6",{className:"mb-2",children:"Support Agent"}),(0,Me.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Me.jsx)("div",{className:"avatar-circle me-2",children:u.name.charAt(0)}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("div",{className:"fw-bold",children:u.name}),(0,Me.jsx)("small",{className:"text-muted",children:u.role})]})]})]})]}),(0,Me.jsxs)("div",{className:"col-md-9 p-0 d-flex flex-column",children:[(0,Me.jsxs)("div",{className:"flex-grow-1 p-3 overflow-auto",style:{height:"calc(100vh - 200px)"},children:[s.map(((t,s)=>(0,Me.jsx)("div",{className:`d-flex ${t.user_id===e.id?"justify-content-end":"justify-content-start"} mb-3`,children:(0,Me.jsx)("div",{className:"chat-message "+(t.user_id===e.id?"bg-primary text-white":"bg-light"),children:"text"===t.type?(0,Me.jsx)("p",{className:"mb-0",children:t.message}):"image"===t.type?(0,Me.jsx)("img",{src:`https://aqdzmfhakqdwquszaqle.supabase.co/storage/v1/object/public/chat-attachments/${t.attachment_url}`,alt:"Shared image",className:"img-fluid rounded",style:{maxWidth:"200px"}}):(0,Me.jsxs)("a",{href:`https://aqdzmfhakqdwquszaqle.supabase.co/storage/v1/object/public/chat-attachments/${t.attachment_url}`,target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none",children:[(0,Me.jsx)(as,{className:"me-2"}),t.message]})})},s))),(0,Me.jsx)("div",{ref:f})]}),(0,Me.jsx)("div",{className:"p-3 border-top",children:(0,Me.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),i.trim())try{const{data:t}=await Et.from("chat_sessions").select("id").eq("user_id",e.id).eq("status","active").single();if(!t)throw new Error("No active chat session");const{error:s}=await Et.from("chat_messages").insert([{session_id:t.id,user_id:e.id,message:i.trim(),type:"text",created_at:(new Date).toISOString()}]);if(s)throw s;a("")}catch(s){console.error("Error sending message:",s)}},className:"d-flex gap-2",children:[(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Type your message...",value:i,onChange:e=>a(e.target.value),onFocus:()=>o(!0),onBlur:()=>o(!1)}),(0,Me.jsxs)("label",{className:"btn btn-outline-primary",children:[(0,Me.jsx)("input",{type:"file",className:"d-none",onChange:async t=>{const s=t.target.files[0];if(s)try{const t=s.name.split(".").pop(),n=`${Math.random()}.${t}`,i=`${e.id}/${n}`,{error:a}=await Et.storage.from("chat-attachments").upload(i,s);if(a)throw a;const{data:r}=await Et.from("chat_sessions").select("id").eq("user_id",e.id).eq("status","active").single();if(!r)throw new Error("No active chat session");const{error:o}=await Et.from("chat_messages").insert([{session_id:r.id,user_id:e.id,message:s.name,type:s.type.startsWith("image/")?"image":"file",attachment_url:i,created_at:(new Date).toISOString()}]);if(o)throw o}catch(n){console.error("Error uploading file:",n)}},accept:"image/*,.pdf,.doc,.docx"}),(0,Me.jsx)(as,{})]}),(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",children:(0,Me.jsx)(vs,{})})]})})]})]})})},yS=()=>{const[e,s]=(0,t.useState)({first_name:null,last_name:null,email:null,date_of_birth:null,gender:null,blood_group:null,height:"",weight:"",allergies:[],medical_conditions:[],emergency_contact_name:null,emergency_contact_phone:null,emergency_contact_relationship:null,phone:null,address:null,bio:"",profile_picture:null}),[n,i]=(0,t.useState)([]),[a,r]=(0,t.useState)(""),[o,l]=(0,t.useState)([]),[c,d]=(0,t.useState)({name:"",value:"",unit:""}),[h,u]=(0,t.useState)(!0),[p,f]=(0,t.useState)(!1),[m,g]=(0,t.useState)("profile"),[b,v]=(0,t.useState)(!1),[y,x]=(0,t.useState)(""),[w,_]=(0,t.useState)([]),[S,A]=(0,t.useState)({name:"",severity:"mild"}),[k,E]=(0,t.useState)([]),[C,j]=(0,t.useState)(!0);(0,t.useEffect)((()=>{N()}),[]),(0,t.useEffect)((()=>{"diseases"===m?(T(),P(),M()):"parameters"===m&&R()}),[m]);const N=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:n}=await Et.from("detailed_profiles").select("*").eq("id",e.id).single();if(n){if("PGRST116"!==n.code)throw n;{const{data:t,error:n}=await Et.from("detailed_profiles").insert([{id:e.id}]).select().single();if(n)throw n;s(t||{})}}else s(t||{})}catch(e){ht.error("Error fetching profile: "+e.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{u(!1)}},T=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:s}=await Et.from("user_diseases").select("*").eq("user_id",e.id);if(s)throw s;i(t||[])}catch(e){console.error("Error fetching diseases:",e)}},P=async()=>{try{const{data:e,error:t}=await Et.from("common_diseases").select("*");if(t)throw t;E(e||[])}catch(e){console.error("Error fetching common diseases:",e)}},M=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:s}=await Et.from("user_allergies").select("*").eq("user_id",e.id);if(s)throw s;_(t||[])}catch(e){console.error("Error fetching allergies:",e)}},R=async()=>{try{const{data:{user:e}}=await Et.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:s}=await Et.from("user_parameters").select("*").eq("user_id",e.id).order("date_recorded",{ascending:!1});if(s)throw s;l(t||[])}catch(e){console.error("Error fetching parameters:",e)}},I=e=>{const{name:t,value:n}=e.target;s((e=>({...e,[t]:n})))};return h?(0,Me.jsx)(Hs,{}):(0,Me.jsxs)("div",{className:"profile-page container-fluid",children:[y&&(0,Me.jsxs)("div",{className:"alert alert-info alert-dismissible fade show",role:"alert",children:[y,(0,Me.jsx)("button",{type:"button",className:"btn-close",onClick:()=>x("")})]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-lg-3 col-md-4",children:(0,Me.jsxs)("div",{className:"profile-sidebar card mb-3",children:[(0,Me.jsx)("div",{className:"d-lg-none",children:(0,Me.jsxs)("button",{className:"btn btn-link w-100 text-start",onClick:()=>j(!C),children:[(0,Me.jsx)("i",{className:"fas fa-bars me-2"}),"Menu"]})}),(0,Me.jsxs)("div",{className:"card-body "+(C?"":"d-none d-lg-block"),children:[(0,Me.jsxs)("div",{className:"profile-picture-container mb-3",children:[(0,Me.jsx)("img",{src:e.profile_picture||"/default-profile.png",alt:"Profile",className:"profile-picture img-fluid rounded-circle mb-2"}),p&&(0,Me.jsx)("div",{className:"mt-2",children:(0,Me.jsx)("input",{type:"file",onChange:async e=>{try{v(!0);const t=e.target.files[0];if(!t)return;const{data:{user:n}}=await Et.auth.getUser();if(!n)throw new Error("No user logged in");const i=t.name.split(".").pop(),a=`${n.id}/${Math.random()}.${i}`,{error:r}=await Et.storage.from("profile-pictures").upload(a,t);if(r)throw r;const{data:{publicUrl:o}}=Et.storage.from("profile-pictures").getPublicUrl(a);s((e=>({...e,profile_picture:o})));const{error:l}=await Et.from("detailed_profiles").update({profile_picture:o}).eq("id",n.id);if(l)throw l;ht.success("Profile picture updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(t){ht.error("Error uploading image: "+t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{v(!1)}},className:"form-control form-control-sm"})}),b&&(0,Me.jsx)(Hs,{})]}),(0,Me.jsxs)("h3",{className:"mb-0",children:[e.first_name," ",e.last_name]}),(0,Me.jsx)("p",{className:"text-muted",children:e.email}),(0,Me.jsx)("button",{onClick:()=>f(!p),className:`btn ${p?"btn-secondary":"btn-primary"} w-100`,children:p?"Cancel Editing":"Edit Profile"})]}),(0,Me.jsxs)("div",{className:"list-group list-group-flush",children:[(0,Me.jsxs)("button",{className:"list-group-item list-group-item-action "+("profile"===m?"active":""),onClick:()=>g("profile"),children:[(0,Me.jsx)("i",{className:"fas fa-user me-2"})," Basic Information"]}),(0,Me.jsxs)("button",{className:"list-group-item list-group-item-action "+("medical"===m?"active":""),onClick:()=>g("medical"),children:[(0,Me.jsx)("i",{className:"fas fa-heartbeat me-2"})," Medical Information"]}),(0,Me.jsxs)("button",{className:"list-group-item list-group-item-action "+("emergency"===m?"active":""),onClick:()=>g("emergency"),children:[(0,Me.jsx)("i",{className:"fas fa-phone-alt me-2"})," Emergency Contacts"]}),(0,Me.jsxs)("button",{className:"list-group-item list-group-item-action "+("diseases"===m?"active":""),onClick:()=>g("diseases"),children:[(0,Me.jsx)("i",{className:"fas fa-notes-medical me-2"})," Diseases & Conditions"]}),(0,Me.jsxs)("button",{className:"list-group-item list-group-item-action "+("parameters"===m?"active":""),onClick:()=>g("parameters"),children:[(0,Me.jsx)("i",{className:"fas fa-chart-line me-2"})," Health Parameters"]})]})]})}),(0,Me.jsx)("div",{className:"col-lg-9 col-md-8",children:(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:["profile"===m&&(0,Me.jsxs)("div",{className:"profile-section",children:[(0,Me.jsx)("h4",{className:"card-title mb-4",children:"Basic Information"}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"First Name:"}),p?(0,Me.jsx)("input",{type:"text",name:"first_name",value:e.first_name,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.first_name})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Last Name:"}),p?(0,Me.jsx)("input",{type:"text",name:"last_name",value:e.last_name,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.last_name})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Email:"}),p?(0,Me.jsx)("input",{type:"email",name:"email",value:e.email,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.email})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Phone:"}),p?(0,Me.jsx)("input",{type:"tel",name:"phone",value:e.phone,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.phone})]})}),(0,Me.jsx)("div",{className:"col-12",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Address:"}),p?(0,Me.jsx)("input",{type:"text",name:"address",value:e.address,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.address})]})}),(0,Me.jsx)("div",{className:"col-12",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Bio:"}),p?(0,Me.jsx)("textarea",{name:"bio",value:e.bio,onChange:I,className:"form-control",rows:"3"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.bio})]})})]})]}),"medical"===m&&(0,Me.jsxs)("div",{className:"medical-section",children:[(0,Me.jsx)("h4",{className:"card-title mb-4",children:"Medical Information"}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Date of Birth:"}),p?(0,Me.jsx)("input",{type:"date",name:"date_of_birth",value:e.date_of_birth,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.date_of_birth})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Gender:"}),p?(0,Me.jsxs)("select",{name:"gender",value:e.gender,onChange:I,className:"form-control",children:[(0,Me.jsx)("option",{value:"",children:"Select Gender"}),(0,Me.jsx)("option",{value:"male",children:"Male"}),(0,Me.jsx)("option",{value:"female",children:"Female"}),(0,Me.jsx)("option",{value:"other",children:"Other"})]}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.gender})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Blood Group:"}),p?(0,Me.jsxs)("select",{name:"blood_group",value:e.blood_group,onChange:I,className:"form-control",children:[(0,Me.jsx)("option",{value:"",children:"Select Blood Group"}),(0,Me.jsx)("option",{value:"A+",children:"A+"}),(0,Me.jsx)("option",{value:"A-",children:"A-"}),(0,Me.jsx)("option",{value:"B+",children:"B+"}),(0,Me.jsx)("option",{value:"B-",children:"B-"}),(0,Me.jsx)("option",{value:"AB+",children:"AB+"}),(0,Me.jsx)("option",{value:"AB-",children:"AB-"}),(0,Me.jsx)("option",{value:"O+",children:"O+"}),(0,Me.jsx)("option",{value:"O-",children:"O-"})]}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.blood_group})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Height (cm):"}),p?(0,Me.jsx)("input",{type:"number",name:"height",value:e.height,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.height})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Weight (kg):"}),p?(0,Me.jsx)("input",{type:"number",name:"weight",value:e.weight,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.weight})]})})]})]}),"emergency"===m&&(0,Me.jsxs)("div",{className:"emergency-section",children:[(0,Me.jsx)("h4",{className:"card-title mb-4",children:"Emergency Contact Information"}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Emergency Contact Name:"}),p?(0,Me.jsx)("input",{type:"text",name:"emergency_contact_name",value:e.emergency_contact_name,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.emergency_contact_name})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Emergency Contact Phone:"}),p?(0,Me.jsx)("input",{type:"tel",name:"emergency_contact_phone",value:e.emergency_contact_phone,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.emergency_contact_phone})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"profile-field",children:[(0,Me.jsx)("label",{children:"Relationship:"}),p?(0,Me.jsx)("input",{type:"text",name:"emergency_contact_relationship",value:e.emergency_contact_relationship,onChange:I,className:"form-control"}):(0,Me.jsx)("p",{className:"form-control-plaintext",children:e.emergency_contact_relationship})]})})]})]}),"diseases"===m&&(0,Me.jsxs)("div",{className:"diseases-section",children:[(0,Me.jsx)("h4",{className:"card-title mb-4",children:"Diseases & Medical Conditions"}),(0,Me.jsx)("div",{className:"row",children:(0,Me.jsxs)("div",{className:"col-12",children:[(0,Me.jsx)("div",{className:"disease-list mb-4",children:n.map((e=>(0,Me.jsx)("span",{className:"badge bg-info me-2 mb-2 p-2",children:e.disease_name},e.id)))}),p&&(0,Me.jsxs)("div",{className:"input-group mb-3",children:[(0,Me.jsxs)("select",{className:"form-select",value:a,onChange:e=>r(e.target.value),children:[(0,Me.jsx)("option",{value:"",children:"Select a disease"}),k.map((e=>(0,Me.jsx)("option",{value:e.name,children:e.name},e.id)))]}),(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Or enter a new disease",value:""===a?"":a,onChange:e=>r(e.target.value)}),(0,Me.jsx)("button",{onClick:async()=>{if(a.trim())try{u(!0);const{data:{user:e}}=await Et.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:s}=await Et.from("user_diseases").select("*").eq("user_id",e.id).eq("disease_name",a).single();if(s&&"PGRST116"!==s.code)throw s;if(t)ht.info("This disease is already in your list",{position:"top-right",autoClose:3e3});else{const{data:t,error:s}=await Et.from("user_diseases").insert([{user_id:e.id,disease_name:a,date_diagnosed:(new Date).toISOString()}]).select();if(s)throw s;i([...n,...t]),ht.success("Disease added successfully!",{position:"top-right",autoClose:3e3})}r("")}catch(e){console.error("Error adding disease:",e),ht.error("Error adding disease: "+e.message,{position:"top-right",autoClose:5e3})}finally{u(!1)}},className:"btn btn-primary",children:"Add"})]})]})}),(0,Me.jsx)("h5",{className:"card-title mb-3 mt-4",children:"Allergies"}),(0,Me.jsx)("div",{className:"row",children:(0,Me.jsxs)("div",{className:"col-12",children:[(0,Me.jsx)("div",{className:"allergy-list mb-4",children:w.map((e=>(0,Me.jsxs)("span",{className:"badge bg-warning text-dark me-2 mb-2 p-2",children:[e.allergy_name," (",e.severity,")"]},e.id)))}),p&&(0,Me.jsxs)("div",{className:"row g-2",children:[(0,Me.jsx)("div",{className:"col-sm-6",children:(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Allergy name",value:S.name,onChange:e=>A({...S,name:e.target.value})})}),(0,Me.jsx)("div",{className:"col-sm-4",children:(0,Me.jsxs)("select",{className:"form-select",value:S.severity,onChange:e=>A({...S,severity:e.target.value}),children:[(0,Me.jsx)("option",{value:"mild",children:"Mild"}),(0,Me.jsx)("option",{value:"moderate",children:"Moderate"}),(0,Me.jsx)("option",{value:"severe",children:"Severe"})]})}),(0,Me.jsx)("div",{className:"col-sm-2",children:(0,Me.jsx)("button",{onClick:async()=>{if(S.name.trim())try{u(!0);const{data:{user:e}}=await Et.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:s}=await Et.from("user_allergies").select("*").eq("user_id",e.id).eq("allergy_name",S.name).single();if(s&&"PGRST116"!==s.code)throw s;if(t)ht.info("This allergy is already in your list",{position:"top-right",autoClose:3e3});else{const{data:t,error:s}=await Et.from("user_allergies").insert([{user_id:e.id,allergy_name:S.name,severity:S.severity}]).select();if(s)throw s;_([...w,...t]),ht.success("Allergy added successfully!",{position:"top-right",autoClose:3e3})}A({name:"",severity:"mild"})}catch(e){console.error("Error adding allergy:",e),ht.error("Error adding allergy: "+e.message,{position:"top-right",autoClose:5e3})}finally{u(!1)}else ht.warning("Please enter an allergy name",{position:"top-right",autoClose:3e3})},className:"btn btn-primary w-100",children:"Add"})})]})]})})]}),"parameters"===m&&(0,Me.jsxs)("div",{className:"parameters-section",children:[(0,Me.jsx)("h4",{className:"card-title mb-4",children:"Health Parameters"}),(0,Me.jsx)("div",{className:"row",children:(0,Me.jsxs)("div",{className:"col-12",children:[(0,Me.jsx)("div",{className:"parameter-list mb-4",children:o.map((e=>(0,Me.jsxs)("div",{className:"badge bg-success me-2 mb-2 p-2",children:[e.parameter_name,": ",e.value," ",e.unit]},e.id)))}),p&&(0,Me.jsxs)("div",{className:"row g-2",children:[(0,Me.jsx)("div",{className:"col-sm-4",children:(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Parameter name",value:c.name,onChange:e=>d({...c,name:e.target.value})})}),(0,Me.jsx)("div",{className:"col-sm-4",children:(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Value",value:c.value,onChange:e=>d({...c,value:e.target.value})})}),(0,Me.jsx)("div",{className:"col-sm-2",children:(0,Me.jsx)("input",{type:"text",className:"form-control",placeholder:"Unit",value:c.unit,onChange:e=>d({...c,unit:e.target.value})})}),(0,Me.jsx)("div",{className:"col-sm-2",children:(0,Me.jsx)("button",{onClick:async()=>{if(c.name.trim()&&c.value.trim())try{u(!0);const{data:{user:e}}=await Et.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:s}=await Et.from("user_parameters").insert([{user_id:e.id,parameter_name:c.name,value:c.value,unit:c.unit||"",date_recorded:(new Date).toISOString()}]).select();if(s)throw s;l([...o,...t]),d({name:"",value:"",unit:""}),ht.success("Parameter added successfully!",{position:"top-right",autoClose:3e3})}catch(e){console.error("Error adding parameter:",e),ht.error("Error adding parameter: "+e.message,{position:"top-right",autoClose:5e3})}finally{u(!1)}else ht.warning("Please enter both parameter name and value",{position:"top-right",autoClose:3e3})},className:"btn btn-primary w-100",children:"Add"})})]})]})})]}),p&&(0,Me.jsx)("div",{className:"mt-4 text-end",children:(0,Me.jsx)("button",{onClick:async()=>{u(!0);try{const{data:{user:t}}=await Et.auth.getUser();if(!t)throw new Error("No user logged in");const s={first_name:e.first_name||null,last_name:e.last_name||null,email:e.email||null,date_of_birth:e.date_of_birth||null,gender:e.gender||null,blood_group:e.blood_group||null,height:e.height||null,weight:e.weight||null,phone:e.phone||null,address:e.address||null,emergency_contact_name:e.emergency_contact_name||null,emergency_contact_phone:e.emergency_contact_phone||null,emergency_contact_relationship:e.emergency_contact_relationship||null,profile_picture:e.profile_picture||null,bio:e.bio||null,updated_at:(new Date).toISOString()},{error:n}=await Et.from("detailed_profiles").update(s).eq("id",t.id);if(n)throw n;ht.success("Profile updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),f(!1)}catch(t){ht.error("Error updating profile: "+t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{u(!1)}},className:"btn btn-success",children:"Save Changes"})})]})})})]})]})},xS=()=>{const[e,s]=(0,t.useState)({twoFactorEnabled:!1,emailNotifications:!0,loginNotifications:!0,passwordExpiry:90,maxLoginAttempts:5}),[n,i]=(0,t.useState)(!1),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(null);(0,t.useEffect)((()=>{c()}),[]);const c=async()=>{try{const{data:{user:e}}=await Pe.auth.getUser();if(!e)return;const{data:t,error:n}=await Pe.from("security_settings").select("*").eq("user_id",e.id).single();if(n)throw n;t&&s(t)}catch(a){r("Failed to load security settings")}},d=e=>{const{name:t,value:n,type:i,checked:a}=e.target;s((e=>({...e,[t]:"checkbox"===i?a:n})))};return(0,Me.jsxs)("div",{className:"container mt-4",children:[(0,Me.jsx)("h2",{className:"mb-4",children:"Security Settings"}),a&&(0,Me.jsx)("div",{className:"alert alert-danger",role:"alert",children:a}),o&&(0,Me.jsx)("div",{className:"alert alert-success",role:"alert",children:o}),(0,Me.jsx)("div",{className:"card",children:(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),i(!0),r(null),l(null);try{const{data:{user:t}}=await Pe.auth.getUser();if(!t)throw new Error("No user found");const{error:s}=await Pe.from("security_settings").upsert({user_id:t.id,...e,updated_at:(new Date).toISOString()});if(s)throw s;l("Security settings updated successfully")}catch(a){r(a.message)}finally{i(!1)}},children:[(0,Me.jsxs)("div",{className:"mb-4",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(ks,{className:"me-2"}),"Two-Factor Authentication"]}),(0,Me.jsxs)("div",{className:"form-check form-switch",children:[(0,Me.jsx)("input",{className:"form-check-input",type:"checkbox",id:"twoFactorEnabled",name:"twoFactorEnabled",checked:e.twoFactorEnabled,onChange:d}),(0,Me.jsx)("label",{className:"form-check-label",htmlFor:"twoFactorEnabled",children:"Enable two-factor authentication"})]})]}),(0,Me.jsxs)("div",{className:"mb-4",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(Ds,{className:"me-2"}),"Login Security"]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{className:"form-label",children:"Maximum Login Attempts"}),(0,Me.jsx)("input",{type:"number",className:"form-control",name:"maxLoginAttempts",value:e.maxLoginAttempts,onChange:d,min:"1",max:"10"})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{className:"form-label",children:"Password Expiry (days)"}),(0,Me.jsx)("input",{type:"number",className:"form-control",name:"passwordExpiry",value:e.passwordExpiry,onChange:d,min:"30",max:"365"})]})]}),(0,Me.jsxs)("div",{className:"mb-4",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(cs,{className:"me-2"}),"Activity Notifications"]}),(0,Me.jsxs)("div",{className:"form-check mb-2",children:[(0,Me.jsx)("input",{className:"form-check-input",type:"checkbox",id:"emailNotifications",name:"emailNotifications",checked:e.emailNotifications,onChange:d}),(0,Me.jsx)("label",{className:"form-check-label",htmlFor:"emailNotifications",children:"Email notifications for security events"})]}),(0,Me.jsxs)("div",{className:"form-check",children:[(0,Me.jsx)("input",{className:"form-check-input",type:"checkbox",id:"loginNotifications",name:"loginNotifications",checked:e.loginNotifications,onChange:d}),(0,Me.jsx)("label",{className:"form-check-label",htmlFor:"loginNotifications",children:"Notify on new device login"})]})]}),(0,Me.jsxs)("div",{className:"mb-4",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(hs,{className:"me-2"}),"Password Management"]}),(0,Me.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>{},children:"Change Password"})]}),(0,Me.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:n,children:n?"Saving...":"Save Security Settings"})]})})})]})},wS=()=>{const[e,s]=(0,t.useState)([]),[n,i]=(0,t.useState)(!1),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(null);(0,t.useEffect)((()=>{c()}),[]);const c=async()=>{try{const{data:{user:e}}=await Pe.auth.getUser();if(!e)return;const{data:t,error:n}=await Pe.from("backup_history").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(n)throw n;s(t||[])}catch(a){r("Failed to load backup history")}};return(0,Me.jsxs)("div",{className:"container mt-4",children:[(0,Me.jsx)("h2",{className:"mb-4",children:"Data Backup & Restore"}),a&&(0,Me.jsx)("div",{className:"alert alert-danger",role:"alert",children:a}),o&&(0,Me.jsx)("div",{className:"alert alert-success",role:"alert",children:o}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-md-6",children:[(0,Me.jsx)("div",{className:"card mb-4",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(Qt,{className:"me-2"}),"Export Data"]}),(0,Me.jsx)("p",{className:"card-text",children:"Download a backup of your health data, including profile information, health records, appointments, and medications."}),(0,Me.jsx)("button",{className:"btn btn-primary",onClick:async()=>{i(!0),r(null),l(null);try{const{data:{user:e}}=await Pe.auth.getUser();if(!e)throw new Error("No user found");const[{data:t},{data:s},{data:n},{data:i},{data:a},{data:r}]=await Promise.all([Pe.from("profiles").select("*").eq("id",e.id).single(),Pe.from("health_metrics").select("*").eq("user_id",e.id),Pe.from("appointments").select("*").eq("user_id",e.id),Pe.from("medications").select("*").eq("user_id",e.id),Pe.from("medical_conditions").select("*").eq("user_id",e.id),Pe.from("health_alerts").select("*").eq("user_id",e.id)]),{data:o,error:d}=await Pe.from("backup_history").insert([{user_id:e.id,type:"export",status:"completed",created_at:(new Date).toISOString(),backup_data:{profile:t,healthMetrics:s,appointments:n,medications:i,medicalConditions:a,healthAlerts:r}}]).select().single();if(d)throw d;const h={profile:t,healthMetrics:s,appointments:n,medications:i,medicalConditions:a,healthAlerts:r,exportDate:(new Date).toISOString()},u=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),p=window.URL.createObjectURL(u),f=document.createElement("a");f.href=p,f.download=`digihealth-backup-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(f),f.click(),window.URL.revokeObjectURL(p),document.body.removeChild(f),l("Data exported successfully"),c()}catch(a){r(a.message)}finally{i(!1)}},disabled:n,children:n?"Exporting...":"Export Data"})]})}),(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(Is,{className:"me-2"}),"Import Data"]}),(0,Me.jsx)("p",{className:"card-text",children:"Restore your health data from a previous backup file."}),(0,Me.jsx)("input",{type:"file",className:"form-control mb-3",accept:".json",onChange:async e=>{const t=e.target.files[0];if(t){i(!0),r(null),l(null);try{const{data:{user:e}}=await Pe.auth.getUser();if(!e)throw new Error("No user found");const s=new FileReader;s.onload=async t=>{try{const s=JSON.parse(t.target.result),{data:n,error:i}=await Pe.from("backup_history").insert([{user_id:e.id,type:"import",status:"completed",created_at:(new Date).toISOString()}]).select().single();if(i)throw i;s.profile&&await Pe.from("profiles").upsert({...s.profile,id:e.id}),s.healthMetrics&&await Pe.from("health_metrics").upsert(s.healthMetrics.map((t=>({...t,user_id:e.id})))),s.appointments&&await Pe.from("appointments").upsert(s.appointments.map((t=>({...t,user_id:e.id})))),s.medications&&await Pe.from("medications").upsert(s.medications.map((t=>({...t,user_id:e.id})))),s.medicalConditions&&await Pe.from("medical_conditions").upsert(s.medicalConditions.map((t=>({...t,user_id:e.id})))),s.healthAlerts&&await Pe.from("health_alerts").upsert(s.healthAlerts.map((t=>({...t,user_id:e.id})))),l("Data imported successfully"),c()}catch(a){r("Invalid backup file format")}},s.readAsText(t)}catch(a){r(a.message)}finally{i(!1)}}},disabled:n})]})})]}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(cs,{className:"me-2"}),"Backup History"]}),(0,Me.jsx)("div",{className:"table-responsive",children:(0,Me.jsxs)("table",{className:"table",children:[(0,Me.jsx)("thead",{children:(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("th",{children:"Date"}),(0,Me.jsx)("th",{children:"Type"}),(0,Me.jsx)("th",{children:"Status"})]})}),(0,Me.jsx)("tbody",{children:e.map((e=>(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("td",{children:new Date(e.created_at).toLocaleString()}),(0,Me.jsxs)("td",{children:["export"===e.type?(0,Me.jsx)(Qt,{className:"me-1"}):(0,Me.jsx)(Is,{className:"me-1"}),e.type.charAt(0).toUpperCase()+e.type.slice(1)]}),(0,Me.jsx)("td",{children:(0,Me.jsx)("span",{className:"badge bg-"+("completed"===e.status?"success":"warning"),children:e.status})})]},e.id)))})]})})]})})})]})]})};var _S=s(985);const SS=()=>{const[e,s]=(0,t.useState)(!1),[n,i]=(0,t.useState)(null),[a,r]=(0,t.useState)([]),o=console.log,l=console.error,c=console.warn;return(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(Kt,{className:"me-2"}),"Database Setup"]}),(0,Me.jsxs)("p",{className:"card-text",children:["This utility will delete all existing tables and buckets in your Supabase project and recreate them with the proper structure.",(0,Me.jsx)("strong",{className:"text-danger",children:" Use with caution as this will delete all existing data!"})]}),n&&(0,Me.jsxs)("div",{className:`alert ${n.success?"alert-success":"alert-danger"} mt-3`,role:"alert",children:[n.success?(0,Me.jsx)(Wt,{className:"me-2"}):(0,Me.jsx)(ts,{className:"me-2"}),n.message]}),(0,Me.jsx)("div",{className:"d-grid gap-2 mt-3",children:(0,Me.jsx)("button",{className:"btn btn-danger",onClick:async()=>{s(!0),i(null),r([]),console.log=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];r((e=>[...e,{type:"info",message:t.join(" ")}])),o(...t)},console.error=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];r((e=>[...e,{type:"error",message:t.join(" ")}])),l(...t)},console.warn=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];r((e=>[...e,{type:"warning",message:t.join(" ")}])),c(...t)};try{const e=await(0,_S.setupSupabaseTables)();i(e)}catch(e){i({success:!1,message:`Unexpected error: ${e.message}`})}finally{console.log=o,console.error=l,console.warn=c,s(!1)}},disabled:e,children:e?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Es,{className:"me-2 fa-spin"}),"Setting up database..."]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Kt,{className:"me-2"}),"Reset and Setup Database"]})})}),a.length>0&&(0,Me.jsxs)("div",{className:"mt-4",children:[(0,Me.jsx)("h6",{children:"Setup Logs:"}),(0,Me.jsx)("div",{className:"border rounded p-3 bg-light",style:{maxHeight:"300px",overflow:"auto"},children:a.map(((e,t)=>(0,Me.jsx)("div",{className:"mb-1 "+("error"===e.type?"text-danger":"warning"===e.type?"text-warning":""),children:e.message},t)))})]})]})})},AS=()=>{var e;const{user:s}=Ie(),[n,i]=(0,t.useState)("");if(!s||"admin"!==(null===(e=s.user_metadata)||void 0===e?void 0:e.role))return(0,Me.jsx)(me,{to:"/dashboard"});return(0,Me.jsxs)("div",{className:"container py-4",children:[(0,Me.jsxs)("h1",{className:"mb-4",children:[(0,Me.jsx)(Kt,{className:"me-2"}),"Database Management"]}),(0,Me.jsxs)("div",{className:"alert alert-warning mb-4",role:"alert",children:[(0,Me.jsx)(ts,{className:"me-2"}),(0,Me.jsx)("strong",{children:"Warning:"})," This page is for administrators only. The actions performed here will affect all users of the application."]}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-8",children:(0,Me.jsx)(SS,{})}),(0,Me.jsx)("div",{className:"col-md-4",children:(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("h5",{className:"card-title",children:[(0,Me.jsx)(ds,{className:"me-2"}),"Database Information"]}),(0,Me.jsx)("p",{className:"card-text",children:"The setup process will create the following resources:"}),(0,Me.jsxs)("h6",{className:"mt-3",children:[(0,Me.jsx)(js,{className:"me-2"}),"Tables"]}),(0,Me.jsxs)("ul",{className:"list-group mb-3",children:[(0,Me.jsx)("li",{className:"list-group-item",children:"detailed_profiles"}),(0,Me.jsx)("li",{className:"list-group-item",children:"profiles"}),(0,Me.jsx)("li",{className:"list-group-item",children:"conditions"}),(0,Me.jsx)("li",{className:"list-group-item",children:"medications"}),(0,Me.jsx)("li",{className:"list-group-item",children:"appointments"}),(0,Me.jsx)("li",{className:"list-group-item",children:"telehealth_consultations"}),(0,Me.jsx)("li",{className:"list-group-item",children:"vitals"}),(0,Me.jsx)("li",{className:"list-group-item",children:"diseases"}),(0,Me.jsx)("li",{className:"list-group-item",children:"medical_reports"}),(0,Me.jsx)("li",{className:"list-group-item",children:"support_tickets"}),(0,Me.jsx)("li",{className:"list-group-item",children:"chat_sessions"}),(0,Me.jsx)("li",{className:"list-group-item",children:"chat_messages"}),(0,Me.jsx)("li",{className:"list-group-item",children:"alerts"}),(0,Me.jsx)("li",{className:"list-group-item",children:"security_settings"}),(0,Me.jsx)("li",{className:"list-group-item",children:"backup_history"})]}),(0,Me.jsxs)("h6",{className:"mt-3",children:[(0,Me.jsx)(os,{className:"me-2"}),"Storage Buckets"]}),(0,Me.jsxs)("ul",{className:"list-group",children:[(0,Me.jsx)("li",{className:"list-group-item",children:"profile-pictures"}),(0,Me.jsx)("li",{className:"list-group-item",children:"medical-reports"}),(0,Me.jsx)("li",{className:"list-group-item",children:"health-reports"}),(0,Me.jsx)("li",{className:"list-group-item",children:"chat-attachments"}),(0,Me.jsx)("li",{className:"list-group-item",children:"support-attachments"})]})]})})})]}),(0,Me.jsxs)("div",{className:"mt-5",children:[(0,Me.jsx)("button",{className:"btn btn-primary",onClick:async()=>{try{i("Setting up database...");const{error:e}=await Et.rpc("setup_profiles_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS profiles (\n            id UUID REFERENCES auth.users ON DELETE CASCADE PRIMARY KEY,\n            first_name VARCHAR(255),\n            last_name VARCHAR(255),\n            date_of_birth DATE,\n            gender VARCHAR(50),\n            blood_group VARCHAR(10),\n            height DECIMAL,\n            weight DECIMAL,\n            allergies TEXT[],\n            medical_conditions TEXT[],\n            emergency_contact_name VARCHAR(255),\n            emergency_contact_phone VARCHAR(20),\n            emergency_contact_relationship VARCHAR(100),\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW()),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          -- Add RLS policies\n          ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own profile"\n            ON profiles FOR SELECT\n            USING (auth.uid() = id);\n\n          CREATE POLICY "Users can update their own profile"\n            ON profiles FOR UPDATE\n            USING (auth.uid() = id);\n\n          CREATE POLICY "Users can insert their own profile"\n            ON profiles FOR INSERT\n            WITH CHECK (auth.uid() = id);\n        '});if(e)throw e;const{error:t}=await Et.rpc("setup_health_metrics_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS health_metrics (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            metric_type VARCHAR(50),\n            value DECIMAL,\n            unit VARCHAR(20),\n            recorded_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW()),\n            notes TEXT\n          );\n\n          ALTER TABLE health_metrics ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own health metrics"\n            ON health_metrics FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own health metrics"\n            ON health_metrics FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(t)throw t;const{error:s}=await Et.rpc("setup_medical_analyses_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS medical_analyses (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            image_type VARCHAR(50),\n            image_url TEXT,\n            result TEXT,\n            confidence DECIMAL,\n            analyzed_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE medical_analyses ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own medical analyses"\n            ON medical_analyses FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own medical analyses"\n            ON medical_analyses FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(s)throw s;const{error:n}=await Et.rpc("setup_chat_history_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS chat_history (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            message TEXT,\n            response TEXT,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE chat_history ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own chat history"\n            ON chat_history FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert into their own chat history"\n            ON chat_history FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(n)throw n;const{error:a}=await Et.rpc("setup_ai_recommendations_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS ai_recommendations (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            category VARCHAR(50),\n            recommendation TEXT,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE ai_recommendations ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own recommendations"\n            ON ai_recommendations FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own recommendations"\n            ON ai_recommendations FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(a)throw a;i("Database setup completed successfully!")}catch(e){console.error("Database setup error:",e),i(`Error setting up database: ${e.message}`)}},children:"Initialize Database"}),(0,Me.jsx)("div",{className:"mt-3",children:(0,Me.jsx)("p",{children:n})})]})]})};gl.register(dc,fc,Rl,Pl,ql,oc,Vl);const kS=e=>{let{timeRange:s="1M"}=e;const{user:n}=Ie(),[i,a]=(0,t.useState)([]),[r,o]=(0,t.useState)(!0),[l,c]=(0,t.useState)("bloodPressure"),d=[{value:"bloodPressure",label:"Blood Pressure"},{value:"bloodSugar",label:"Blood Sugar"},{value:"cholesterol",label:"Cholesterol"},{value:"heartRate",label:"Heart Rate"},{value:"temperature",label:"Temperature"},{value:"weight",label:"Weight"},{value:"oxygenSaturation",label:"Oxygen Saturation"}];(0,t.useEffect)((()=>{h()}),[s,l]);const h=async()=>{try{o(!0);const e={"1W":"7 days","1M":"30 days","3M":"90 days","6M":"180 days","1Y":"365 days"},{data:t,error:i}=await Et.from("health_metrics").select("*").eq("user_id",n.id).gte("recorded_at",new Date(Date.now()-24*parseInt(e[s])*60*60*1e3).toISOString()).order("recorded_at",{ascending:!0});if(i)throw i;a(t||[])}catch(e){console.error("Error fetching metrics:",e)}finally{o(!1)}},u={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:`${d.find((e=>e.value===l)).label} Trend`}},scales:{y:{beginAtZero:!1}}};return(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("div",{className:"d-flex justify-content-between mb-3",children:[(0,Me.jsx)("select",{className:"form-select w-auto",value:l,onChange:e=>c(e.target.value),children:d.map((e=>(0,Me.jsx)("option",{value:e.value,children:e.label},e.value)))}),(0,Me.jsxs)("select",{className:"form-select w-auto",value:s,onChange:e=>setTimeRange(e.target.value),children:[(0,Me.jsx)("option",{value:"1W",children:"1 Week"}),(0,Me.jsx)("option",{value:"1M",children:"1 Month"}),(0,Me.jsx)("option",{value:"3M",children:"3 Months"}),(0,Me.jsx)("option",{value:"6M",children:"6 Months"}),(0,Me.jsx)("option",{value:"1Y",children:"1 Year"})]})]}),r?(0,Me.jsx)("div",{className:"text-center",children:"Loading..."}):i.length>0?(0,Me.jsx)(oS,{data:(()=>{const e=i.map((e=>new Date(e.recorded_at).toLocaleDateString())),t=i.map((e=>{const t=e.metrics[l];if("bloodPressure"===l){const[e]=t.split("/");return parseInt(e)}return parseFloat(t)}));return{labels:e,datasets:[{label:d.find((e=>e.value===l)).label,data:t,fill:!1,borderColor:"rgb(75, 192, 192)",tension:.1}]}})(),options:u}):(0,Me.jsx)("div",{className:"text-center",children:"No data available for the selected period"})]})})},ES=()=>{const{user:e}=Ie(),[s,n]=(0,t.useState)(!1),[i,a]=(0,t.useState)(null),[r,o]=(0,t.useState)(null),[l,c]=(0,t.useState)(null),[d,h]=(0,t.useState)("skin");return(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h3",{className:"card-title mb-4",children:"Medical Image Analysis"}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{className:"form-label",children:"Image Type"}),(0,Me.jsx)("select",{className:"form-select",value:d,onChange:e=>h(e.target.value),children:[{value:"skin",label:"Skin Condition"},{value:"xray",label:"X-Ray"},{value:"wound",label:"Wound/Injury"},{value:"eye",label:"Eye Condition"}].map((e=>(0,Me.jsx)("option",{value:e.value,children:e.label},e.value)))})]}),(0,Me.jsxs)("div",{className:"mb-4",children:[(0,Me.jsx)("label",{className:"form-label",children:"Upload Image"}),(0,Me.jsx)("input",{type:"file",className:"form-control",accept:"image/*",onChange:t=>{const s=t.target.files[0];s&&(async t=>{n(!0),o(null);try{const s=`${e.id}/${Date.now()}-${t.name}`,{data:n,error:i}=await Et.storage.from("medical-images").upload(s,t);if(i)throw i;const{data:{publicUrl:r}}=Et.storage.from("medical-images").getPublicUrl(s);c(r);const o=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:"gpt-4-vision-preview",messages:[{role:"system",content:`You are a medical image analyzer specialized in ${d} conditions. Provide a detailed analysis while being cautious not to make definitive diagnoses.`},{role:"user",content:[{type:"text",text:`Please analyze this ${d} image and provide insights about what you observe. Include potential concerns and recommendations for professional medical consultation if needed.`},{type:"image_url",image_url:r}]}],max_tokens:500})}),l=await o.json(),{error:h}=await Et.from("medical_analyses").insert([{user_id:e.id,image_url:r,analysis_type:d,analysis_result:l.choices[0].message.content,created_at:(new Date).toISOString()}]);if(h)throw h;a(l.choices[0].message.content)}catch(r){console.error("Error analyzing image:",r),o(r.message)}finally{n(!1)}})(s)},disabled:s})]}),s&&(0,Me.jsxs)("div",{className:"text-center mb-4",children:[(0,Me.jsx)(Es,{className:"spinner"}),(0,Me.jsx)("p",{children:"Analyzing image..."})]}),l&&(0,Me.jsx)("div",{className:"mb-4",children:(0,Me.jsx)("img",{src:l,alt:"Uploaded medical image",className:"img-fluid rounded",style:{maxHeight:"300px"}})}),r&&(0,Me.jsx)("div",{className:"alert alert-danger",role:"alert",children:r}),i&&(0,Me.jsxs)("div",{className:"mt-4",children:[(0,Me.jsx)("h5",{children:"Analysis Results:"}),(0,Me.jsx)("div",{className:"card bg-light",children:(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsx)("pre",{className:"mb-0",style:{whiteSpace:"pre-wrap"},children:i})})})]})]})})},CS=()=>{const{user:e}=Ie(),[s,n]=(0,t.useState)([]),[i,a]=(0,t.useState)(""),[r,o]=(0,t.useState)(!1),[l,c]=(0,t.useState)("chat"),d=(0,t.useRef)(null);(0,t.useEffect)((()=>{(()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()}),[s]);const h=()=>{switch(l){case"diet":return"You are a nutritionist AI assistant. Provide personalized diet recommendations based on user's health conditions and goals. Always emphasize the importance of consulting healthcare providers before making significant dietary changes.";case"firstAid":return"You are a first aid instruction AI assistant. Provide clear, step-by-step first aid guidance for non-emergency situations. Always emphasize when professional medical attention is needed and include emergency contact recommendations when appropriate.";default:return"You are a helpful medical assistant. Explain medical terms in simple language and provide general health information. Always remind users to consult healthcare professionals for proper medical advice."}},u=async()=>{if(!i.trim())return;const t=i.trim();a(""),o(!0);const r={role:"user",content:t,timestamp:(new Date).toISOString()};n((e=>[...e,r]));try{const{data:i}=await Et.from("profiles").select("medical_conditions, allergies, current_medications").eq("id",e.id).single(),a=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:h()},{role:"user",content:`User's health context - Medical conditions: ${i.medical_conditions.join(", ")}, Allergies: ${i.allergies.join(", ")}, Current medications: ${i.current_medications.join(", ")}`},...s.map((e=>({role:e.role,content:e.content}))),{role:"user",content:t}],temperature:.7,max_tokens:500})}),r=await a.json();n((e=>[...e,{role:"assistant",content:r.choices[0].message.content,timestamp:(new Date).toISOString()}])),await Et.from("chat_history").insert([{user_id:e.id,mode:l,message:t,response:r.choices[0].message.content,created_at:(new Date).toISOString()}])}catch(c){console.error("Error:",c),n((e=>[...e,{role:"assistant",content:"I apologize, but I encountered an error. Please try again.",timestamp:(new Date).toISOString()}]))}finally{o(!1)}};return(0,Me.jsx)("div",{className:"card",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,Me.jsx)("h3",{className:"card-title mb-0",children:"diet"===l?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Fs,{className:"me-2"})," Diet Assistant"]}):"firstAid"===l?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(rs,{className:"me-2"})," First Aid Guide"]}):(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Ss,{className:"me-2"})," Health Assistant"]})}),(0,Me.jsxs)("div",{className:"btn-group",children:[(0,Me.jsx)("button",{className:"btn btn-"+("chat"===l?"primary":"outline-primary"),onClick:()=>c("chat"),children:"Chat"}),(0,Me.jsx)("button",{className:"btn btn-"+("diet"===l?"primary":"outline-primary"),onClick:()=>c("diet"),children:"Diet"}),(0,Me.jsx)("button",{className:"btn btn-"+("firstAid"===l?"primary":"outline-primary"),onClick:()=>c("firstAid"),children:"First Aid"})]})]}),(0,Me.jsxs)("div",{className:"chat-container bg-light p-3 rounded",style:{height:"400px",overflowY:"auto"},children:[s.map(((e,t)=>(0,Me.jsx)("div",{className:`d-flex ${"user"===e.role?"justify-content-end":"justify-content-start"} mb-3`,children:(0,Me.jsxs)("div",{className:("user"===e.role?"bg-primary text-white":"bg-white")+" p-3 rounded shadow-sm",style:{maxWidth:"75%"},children:[(0,Me.jsxs)("div",{className:"d-flex align-items-center mb-1",children:["user"===e.role?(0,Me.jsx)(Os,{className:"me-2"}):(0,Me.jsx)(Ss,{className:"me-2"}),(0,Me.jsx)("small",{className:"text-muted",children:new Date(e.timestamp).toLocaleTimeString()})]}),(0,Me.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:e.content})]})},t))),(0,Me.jsx)("div",{ref:d})]}),(0,Me.jsxs)("div",{className:"mt-3 d-flex",children:[(0,Me.jsx)("input",{type:"text",className:"form-control me-2",value:i,onChange:e=>a(e.target.value),onKeyPress:e=>"Enter"===e.key&&u(),placeholder:"diet"===l?"Ask about diet recommendations...":"firstAid"===l?"Ask about first aid instructions...":"Ask your health-related question...",disabled:r}),(0,Me.jsx)("button",{className:"btn btn-primary",onClick:u,disabled:r||!i.trim(),children:r?(0,Me.jsx)(Es,{className:"spinner"}):(0,Me.jsx)(vs,{})})]})]})})};gl.register(dc,fc,Rl,Pl,$l,_l,Sc,ql,oc,Vl);const jS=()=>{const{user:e}=Ie(),[s,n]=(0,t.useState)({healthTrends:[],imageAnalyses:[],chatHistory:[],recommendations:[]}),[i,a]=(0,t.useState)("week"),[r,o]=(0,t.useState)("all");(0,t.useEffect)((()=>{l()}),[e,i,r]);const l=async()=>{try{const[t,s,i,a]=await Promise.all([Et.from("health_metrics").select("*").eq("user_id",e.id).order("recorded_at",{ascending:!1}),Et.from("medical_analyses").select("*").eq("user_id",e.id).order("analyzed_at",{ascending:!1}),Et.from("chat_history").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}),Et.from("ai_recommendations").select("*").eq("user_id",e.id).order("created_at",{ascending:!1})]);n({healthTrends:t.data||[],imageAnalyses:s.data||[],chatHistory:i.data||[],recommendations:a.data||[]})}catch(t){console.error("Error fetching AI insights:",t)}};return(0,Me.jsxs)("div",{className:"ai-insights-container",children:[(0,Me.jsx)("h1",{className:"text-center mb-4",children:"AI Health Insights Dashboard"}),(0,Me.jsxs)("div",{className:"controls-section mb-4",children:[(0,Me.jsxs)("select",{value:i,onChange:e=>a(e.target.value),className:"form-select me-2",children:[(0,Me.jsx)("option",{value:"week",children:"Last Week"}),(0,Me.jsx)("option",{value:"month",children:"Last Month"}),(0,Me.jsx)("option",{value:"year",children:"Last Year"})]}),(0,Me.jsxs)("select",{value:r,onChange:e=>o(e.target.value),className:"form-select",children:[(0,Me.jsx)("option",{value:"all",children:"All Metrics"}),(0,Me.jsx)("option",{value:"vitals",children:"Vital Signs"}),(0,Me.jsx)("option",{value:"lab",children:"Lab Results"}),(0,Me.jsx)("option",{value:"lifestyle",children:"Lifestyle"})]})]}),(0,Me.jsxs)("div",{className:"card mb-4",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsxs)("h3",{children:[(0,Me.jsx)(Vt,{})," Health Trends Analysis"]})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsx)(oS,{data:{labels:s.healthTrends.map((e=>new Date(e.recorded_at).toLocaleDateString())),datasets:[{label:"Health Score",data:s.healthTrends.map((e=>e.value)),borderColor:"rgb(75, 192, 192)",tension:.1}]},options:{responsive:!0,plugins:{title:{display:!0,text:"Health Metrics Over Time"}}}})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsx)(cS,{data:{labels:["Blood Pressure","Heart Rate","Blood Sugar","Sleep","Exercise","Diet"],datasets:[{label:"Current Status",data:[65,75,70,80,60,85],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgb(75, 192, 192)"}]}})})]})})]}),(0,Me.jsxs)("div",{className:"card mb-4",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsxs)("h3",{children:[(0,Me.jsx)(is,{})," Medical Image Analysis History"]})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsx)("div",{className:"table-responsive",children:(0,Me.jsxs)("table",{className:"table",children:[(0,Me.jsx)("thead",{children:(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("th",{children:"Date"}),(0,Me.jsx)("th",{children:"Image Type"}),(0,Me.jsx)("th",{children:"Analysis Result"}),(0,Me.jsx)("th",{children:"Confidence"})]})}),(0,Me.jsx)("tbody",{children:s.imageAnalyses.map(((e,t)=>(0,Me.jsxs)("tr",{children:[(0,Me.jsx)("td",{children:new Date(e.analyzed_at).toLocaleDateString()}),(0,Me.jsx)("td",{children:e.image_type}),(0,Me.jsx)("td",{children:e.result}),(0,Me.jsxs)("td",{children:[e.confidence,"%"]})]},t)))})]})})})]}),(0,Me.jsxs)("div",{className:"card mb-4",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsxs)("h3",{children:[(0,Me.jsx)(Bt,{})," AI Health Recommendations"]})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsx)(dS,{data:{labels:["Diet","Exercise","Sleep","Medication","Lifestyle"],datasets:[{data:[30,25,20,15,10],backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF"]}]},options:{plugins:{title:{display:!0,text:"Recommendation Categories"}}}})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsx)("div",{className:"recommendations-list",children:s.recommendations.slice(0,5).map(((e,t)=>(0,Me.jsxs)("div",{className:"recommendation-item",children:[(0,Me.jsx)("h5",{children:e.category}),(0,Me.jsx)("p",{children:e.recommendation})]},t)))})})]})})]}),(0,Me.jsxs)("div",{className:"card",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsxs)("h3",{children:[(0,Me.jsx)(Ss,{})," Health Assistant Interactions"]})}),(0,Me.jsx)("div",{className:"card-body",children:(0,Me.jsx)(lS,{data:{labels:["Diet Queries","Symptom Analysis","Medical Terms","First Aid","General Health"],datasets:[{label:"Interaction Distribution",data:[45,32,28,15,30],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgb(75, 192, 192)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}}}})})]})]})},NS=()=>{const[e,s]=(0,t.useState)(!0),[n,i]=(0,t.useState)(null),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(null);(0,t.useEffect)((()=>{c()}),[]);const c=async()=>{try{const{data:{user:e}}=await Pe.auth.getUser();if(!e)throw new Error("No user logged in");const t={weight:[{date:"2024-01-01",value:70},{date:"2024-02-01",value:69},{date:"2024-03-01",value:68}],bloodPressure:[{date:"2024-01-01",systolic:120,diastolic:80},{date:"2024-02-01",systolic:118,diastolic:78},{date:"2024-03-01",systolic:122,diastolic:82}],heartRate:[{date:"2024-01-01",value:72},{date:"2024-02-01",value:70},{date:"2024-03-01",value:71}]};r(t),d(t)}catch(n){console.error("Error fetching health metrics:",n),i("Failed to load health metrics")}finally{s(!1)}},d=e=>{l({weight:{trend:"decreasing",change:-2,recommendation:"Your weight shows a healthy decreasing trend. Keep up the good work!"},bloodPressure:{trend:"stable",recommendation:"Your blood pressure remains within normal range. Continue monitoring regularly."},heartRate:{trend:"stable",recommendation:"Your heart rate is consistent and within healthy range."},overall:{status:"Good",recommendations:["Maintain current lifestyle habits","Continue regular exercise","Keep monitoring your metrics"]}})};return e?(0,Me.jsx)("div",{className:"text-center py-4",children:(0,Me.jsx)(Hs,{})}):n?(0,Me.jsx)("div",{className:"alert alert-danger m-4",children:n}):(0,Me.jsx)("div",{className:"container py-4",children:(0,Me.jsx)("div",{className:"row",children:(0,Me.jsxs)("div",{className:"col-12",children:[(0,Me.jsx)("h2",{className:"mb-4",children:"AI Health Metrics Analysis"}),a&&o&&(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("div",{className:"card mb-4",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsxs)("h4",{children:["Overall Health Status: ",(0,Me.jsx)("span",{className:"text-success",children:o.overall.status})]}),(0,Me.jsxs)("div",{className:"mt-3",children:[(0,Me.jsx)("h5",{children:"Key Findings:"}),(0,Me.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,Me.jsxs)("li",{className:"list-group-item",children:[(0,Me.jsx)("strong",{children:"Weight:"})," ",o.weight.recommendation]}),(0,Me.jsxs)("li",{className:"list-group-item",children:[(0,Me.jsx)("strong",{children:"Blood Pressure:"})," ",o.bloodPressure.recommendation]}),(0,Me.jsxs)("li",{className:"list-group-item",children:[(0,Me.jsx)("strong",{children:"Heart Rate:"})," ",o.heartRate.recommendation]})]})]})]})}),(0,Me.jsx)("div",{className:"card mb-4",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h4",{children:"Recommendations"}),(0,Me.jsx)("ul",{className:"list-group list-group-flush",children:o.overall.recommendations.map(((e,t)=>(0,Me.jsxs)("li",{className:"list-group-item",children:[(0,Me.jsx)("i",{className:"fas fa-check-circle text-success me-2"}),e]},t)))})]})}),(0,Me.jsxs)("div",{className:"alert alert-info",children:[(0,Me.jsx)("i",{className:"fas fa-info-circle me-2"}),"This analysis is based on your recorded health metrics. For personalized medical advice, please consult with your healthcare provider."]})]})]})})})},TS=new q_({apiKey:"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",dangerouslyAllowBrowser:!0}),PS="gpt-4o",MS="gpt-4-vision-preview",RS=()=>{const[e,s]=(0,t.useState)(null),[n,i]=(0,t.useState)(null),[a,r]=(0,t.useState)(!1),[o,l]=(0,t.useState)(null),[c,d]=(0,t.useState)(null),[h,u]=(0,t.useState)(null),[p,f]=(0,t.useState)("general"),m=(0,t.useRef)(null),g=e=>{const t="You are a medical imaging specialist AI. Analyze this medical image and provide detailed observations. ",s={general:t+"Describe what you see, potential abnormalities, and possible conditions it might indicate. Be thorough but cautious about making definitive diagnoses.",skin:t+"This is a skin-related image. Describe the lesion/condition characteristics, possible differential diagnoses, and any concerning features. Mention if further evaluation is recommended.",xray:t+"This is an X-ray image. Describe the visible structures, any abnormalities, potential fractures, lesions, or other findings. Interpret the image as thoroughly as possible.",scan:t+"This is a CT/MRI scan. Describe the visible anatomical structures, any abnormalities, masses, inflammations, or other noteworthy findings. Provide detailed analysis of tissue characteristics.",pathology:t+"This is a pathology slide. Describe the cellular structures, any abnormal cells, patterns, or markers of disease. Analyze tissue architecture and cellular morphology."};return s[e]||s.general},b=e=>{const t="This AI analysis is not a substitute for professional medical diagnosis. Please consult with a healthcare provider for proper evaluation and diagnosis.";return{skin:t+" Skin conditions particularly require in-person examination as many can appear similar in images.",xray:t+" X-ray interpretation requires board-certified radiologists for official diagnosis.",scan:t+" CT/MRI scans are complex and require specialized medical training to properly diagnose.",pathology:t+" Pathology diagnosis requires microscopic examination by a certified pathologist."}[e]||t},v=async t=>{try{const{data:{user:s}}=await Pe.auth.getUser();if(!s)return;const n=e.name.split(".").pop(),i=`${s.id}/${Date.now()}.${n}`,{error:a}=await Pe.storage.from("medical-images").upload(i,e);if(a)throw a;const{data:{publicUrl:r}}=Pe.storage.from("medical-images").getPublicUrl(i);await Pe.from("image_analyses").insert({user_id:s.id,image_url:r,analysis_type:p,analysis_result:t,created_at:(new Date).toISOString()})}catch(c){console.error("Error saving analysis:",c)}};return(0,Me.jsxs)("div",{className:"container-fluid py-4",children:[h&&(0,Me.jsxs)("div",{className:`alert alert-${h.type} alert-dismissible fade show`,children:[h.message,(0,Me.jsx)("button",{type:"button",className:"btn-close",onClick:()=>u(null)})]}),(0,Me.jsx)("h1",{className:"mb-4",children:"Medical Image Analysis"}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsx)("div",{className:"col-lg-6",children:(0,Me.jsx)("div",{className:"card shadow-sm mb-4",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h5",{className:"card-title",children:"Upload Medical Image"}),(0,Me.jsx)("p",{className:"card-text text-muted",children:"Upload a medical image for AI analysis. Supported types: X-rays, skin conditions, CT/MRI scans, pathology slides."}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"analysisType",className:"form-label",children:"Analysis Type"}),(0,Me.jsxs)("select",{id:"analysisType",className:"form-select",value:p,onChange:e=>f(e.target.value),children:[(0,Me.jsx)("option",{value:"general",children:"General Medical Image Analysis"}),(0,Me.jsx)("option",{value:"skin",children:"Skin Condition/Lesion"}),(0,Me.jsx)("option",{value:"xray",children:"X-Ray"}),(0,Me.jsx)("option",{value:"scan",children:"CT/MRI Scan"}),(0,Me.jsx)("option",{value:"pathology",children:"Pathology Slide"})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"imageUpload",className:"form-label",children:"Upload Image"}),(0,Me.jsx)("input",{type:"file",className:"form-control",id:"imageUpload",accept:"image/*",onChange:e=>{const t=e.target.files[0];t&&(t.type.match("image.*")?(s(t),i(URL.createObjectURL(t)),l(null),d(null)):u({type:"danger",message:"Please upload a valid image file (JPEG, PNG, etc.)"}))},ref:m})]}),n&&(0,Me.jsx)("div",{className:"mb-3 text-center",children:(0,Me.jsx)("img",{src:n,alt:"Preview",className:"img-fluid mb-2 border rounded",style:{maxHeight:"300px"}})}),(0,Me.jsxs)("div",{className:"d-grid gap-2",children:[(0,Me.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(e){r(!0),d(null);try{const t=new FileReader;t.readAsDataURL(e),t.onloadend=async()=>{const e=t.result;try{const t=await TS.chat.completions.create({model:MS,messages:[{role:"system",content:g(p)},{role:"user",content:[{type:"text",text:"Please analyze this medical image."},{type:"image_url",image_url:{url:e}}]}],max_tokens:1e3});l({analysis:t.choices[0].message.content,date:(new Date).toISOString(),disclaimer:b(p),imageType:p}),v(t.choices[0].message.content)}catch(s){console.error("OpenAI API error:",s),d("Error analyzing image. Please try again or use a different image.")}r(!1)},t.onerror=()=>{d("Error reading image file. Please try again with a different image."),r(!1)}}catch(zS){console.error("Error processing image:",zS),d("Error processing image. Please try again."),r(!1)}}},disabled:!e||a,children:a?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Hs,{size:"sm"})," Analyzing..."]}):"Analyze Image"}),(0,Me.jsx)("button",{className:"btn btn-outline-secondary",onClick:()=>{s(null),i(null),l(null),d(null),m.current&&(m.current.value="")},disabled:a,children:"Reset"})]})]})})}),(0,Me.jsx)("div",{className:"col-lg-6",children:a?(0,Me.jsx)("div",{className:"card shadow-sm mb-4",children:(0,Me.jsxs)("div",{className:"card-body text-center py-5",children:[(0,Me.jsx)(Hs,{}),(0,Me.jsx)("p",{className:"mt-3",children:"Analyzing your medical image..."}),(0,Me.jsx)("p",{className:"text-muted small",children:"This may take a moment"})]})}):o?(0,Me.jsxs)("div",{className:"card shadow-sm mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Me.jsx)("h5",{className:"card-title mb-0",children:"Analysis Results"})}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("div",{className:"analysis-content",children:o.analysis.split("\n").map(((e,t)=>e?(0,Me.jsx)("p",{children:e},t):(0,Me.jsx)("br",{},t)))}),(0,Me.jsxs)("div",{className:"alert alert-warning mt-3",children:[(0,Me.jsx)("strong",{children:"Important Disclaimer:"})," ",o.disclaimer]})]}),(0,Me.jsx)("div",{className:"card-footer text-muted",children:(0,Me.jsxs)("small",{children:["Analysis generated on ",new Date(o.date).toLocaleString()]})})]}):c?(0,Me.jsx)("div",{className:"alert alert-danger",children:c}):(0,Me.jsx)("div",{className:"card shadow-sm mb-4",children:(0,Me.jsxs)("div",{className:"card-body p-5 text-center",children:[(0,Me.jsx)("div",{className:"text-muted mb-3",children:(0,Me.jsx)("i",{className:"fas fa-microscope fa-3x"})}),(0,Me.jsx)("h5",{children:"Upload an image to see analysis results"}),(0,Me.jsx)("p",{className:"text-muted",children:"The AI will analyze your medical image and provide insights."})]})})})]}),(0,Me.jsx)("div",{className:"mt-4",children:(0,Me.jsx)("div",{className:"card shadow-sm",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h5",{children:"About Medical Image Analysis"}),(0,Me.jsx)("p",{children:"This feature uses AI to analyze various types of medical images. Please note that this is not a substitute for professional medical diagnosis. Always consult with a healthcare provider for proper evaluation."}),(0,Me.jsxs)("div",{className:"row g-4 mt-2",children:[(0,Me.jsxs)("div",{className:"col-md-6",children:[(0,Me.jsx)("h6",{children:"Common Uses"}),(0,Me.jsxs)("ul",{children:[(0,Me.jsx)("li",{children:"Preliminary analysis of skin conditions"}),(0,Me.jsx)("li",{children:"Identifying potential areas of concern in X-rays"}),(0,Me.jsx)("li",{children:"Understanding CT/MRI scan information"}),(0,Me.jsx)("li",{children:"Analyzing pathology slides"})]})]}),(0,Me.jsxs)("div",{className:"col-md-6",children:[(0,Me.jsx)("h6",{children:"Limitations"}),(0,Me.jsxs)("ul",{children:[(0,Me.jsx)("li",{children:"Not a replacement for professional diagnosis"}),(0,Me.jsx)("li",{children:"Quality of analysis depends on image quality"}),(0,Me.jsx)("li",{children:"May not detect all conditions or abnormalities"}),(0,Me.jsx)("li",{children:"Should be used for educational purposes only"})]})]})]})]})})})]})},IS=()=>{const[e,s]=(0,t.useState)(!1),[n,i]=(0,t.useState)(null),[a,r]=(0,t.useState)(null),[o,l]=(0,t.useState)(null),[c,d]=(0,t.useState)(null),[h,u]=(0,t.useState)([]),[p,f]=(0,t.useState)([]),[m,g]=(0,t.useState)("general"),[b,v]=(0,t.useState)(""),[y,x]=(0,t.useState)(!1),[w,_]=(0,t.useState)([]),S={general:"General health recommendations",nutrition:"Nutrition and diet recommendations",fitness:"Exercise and fitness recommendations",sleep:"Sleep improvement recommendations",stress:"Stress management recommendations",chronic:"Recommendations for managing chronic conditions"};(0,t.useEffect)((()=>{A(),k()}),[]);const A=async()=>{try{s(!0);const{data:{user:e}}=await Et.auth.getUser();if(!e)return;const{data:t,error:n}=await Et.from("detailed_profiles").select("*").eq("id",e.id).single();if(n)throw n;d(t);const{data:i,error:a}=await Et.from("user_diseases").select("*").eq("user_id",e.id);if(a)throw a;u(i||[]);const{data:r,error:o}=await Et.from("user_parameters").select("*").eq("user_id",e.id).order("date_recorded",{ascending:!1});if(o)throw o;const l={};null===r||void 0===r||r.forEach((e=>{(!l[e.parameter_name]||new Date(e.date_recorded)>new Date(l[e.parameter_name].date_recorded))&&(l[e.parameter_name]=e)})),f(Object.values(l))}catch(a){console.error("Error fetching user data:",a),l({message:"Error fetching your health data",type:"danger"})}finally{s(!1)}},k=async()=>{try{x(!0);const{data:{user:e}}=await Et.auth.getUser();if(!e)return;const{data:t,error:s}=await Et.from("health_recommendations").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(5);if(s)throw s;_(t||[])}catch(a){console.error("Error fetching recommendations history:",a)}finally{x(!1)}},E=async e=>{try{const{data:{user:t}}=await Et.auth.getUser();if(!t)return;const{error:s}=await Et.from("health_recommendations").insert([{user_id:t.id,focus_area:e.focusArea,recommendations:e.recommendations,created_at:(new Date).toISOString()}]);if(s)throw s}catch(a){console.error("Error saving recommendations:",a)}};return(0,Me.jsxs)("div",{className:"container py-4",children:[o&&(0,Me.jsxs)("div",{className:`alert alert-${o.type} alert-dismissible fade show`,children:[o.message,(0,Me.jsx)("button",{type:"button",className:"btn-close",onClick:()=>l(null)})]}),(0,Me.jsx)("h1",{className:"mb-4",children:"Personalized Health Recommendations"}),(0,Me.jsxs)("div",{className:"row",children:[(0,Me.jsxs)("div",{className:"col-lg-5",children:[(0,Me.jsx)("div",{className:"card shadow-sm mb-4",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h5",{className:"card-title",children:"Get Personalized Recommendations"}),c?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)("p",{className:"card-text text-muted",children:"Our AI will analyze your health profile and provide personalized recommendations."}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"focusArea",className:"form-label",children:"Focus Area"}),(0,Me.jsxs)("select",{id:"focusArea",className:"form-select",value:m,onChange:e=>g(e.target.value),children:[(0,Me.jsx)("option",{value:"general",children:"General Health"}),(0,Me.jsx)("option",{value:"nutrition",children:"Nutrition & Diet"}),(0,Me.jsx)("option",{value:"fitness",children:"Exercise & Fitness"}),(0,Me.jsx)("option",{value:"sleep",children:"Sleep Improvement"}),(0,Me.jsx)("option",{value:"stress",children:"Stress Management"}),(0,Me.jsx)("option",{value:"chronic",children:"Chronic Condition Management"})]})]}),(0,Me.jsxs)("div",{className:"mb-3",children:[(0,Me.jsx)("label",{htmlFor:"additionalInfo",className:"form-label",children:"Additional Information (optional)"}),(0,Me.jsx)("textarea",{id:"additionalInfo",className:"form-control",rows:"3",value:b,onChange:e=>v(e.target.value),placeholder:"Any specific concerns, goals, or lifestyle factors"})]}),(0,Me.jsx)("div",{className:"d-grid",children:(0,Me.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(c){s(!0),r(null);try{const e=c.date_of_birth?Math.floor((new Date-new Date(c.date_of_birth))/315576e5):"unknown",t=p.map((e=>`${e.parameter_name}: ${e.parameter_value} ${e.unit||""}`)).join(", "),s=h.map((e=>e.disease_name)).join(", "),n=`\n      Please provide personalized health recommendations for a ${e} year old ${c.gender||"person"}.\n      \n      Focus area: ${S[m]}\n      \n      Health profile:\n      - Height: ${c.height||"unknown"} cm\n      - Weight: ${c.weight||"unknown"} kg\n      - BMI: ${c.height&&c.weight?(c.weight/(c.height/100*(c.height/100))).toFixed(1):"unknown"}\n      ${t?`- Health parameters: ${t}`:""}\n      ${s?`- Medical conditions: ${s}`:""}\n      \n      ${b?`Additional information: ${b}`:""}\n      \n      Please provide:\n      1. Personalized recommendations based on the profile\n      2. Specific actionable steps to improve health\n      3. Any relevant warnings or precautions\n      4. Suggested health goals\n      `,a=(await TS.chat.completions.create({model:PS,messages:[{role:"system",content:"You are a health recommendations assistant that provides evidence-based, personalized health advice. Focus on practical, actionable recommendations. Include appropriate disclaimers but be positive and motivational in tone. Present information in well-organized sections with clear headings."},{role:"user",content:n}],temperature:.3})).choices[0].message.content,r={focusArea:m,recommendations:a,disclaimer:"These recommendations are generated by AI based on the information provided and are not a substitute for professional medical advice. Always consult with healthcare professionals before making significant changes to your health regimen.",date:(new Date).toISOString()};i(r),await E(r),k()}catch(e){console.error("Error generating recommendations:",e),r("Error generating health recommendations. Please try again."),l({message:"Error generating recommendations: "+e.message,type:"danger"})}finally{s(!1)}}else l({message:"Please complete your profile first to get personalized recommendations",type:"warning"})},disabled:e,children:e?(0,Me.jsxs)(Me.Fragment,{children:[(0,Me.jsx)(Hs,{size:"sm"})," Generating..."]}):"Generate Recommendations"})})]}):(0,Me.jsx)("div",{className:"alert alert-info",children:"Please complete your health profile to get personalized recommendations."})]})}),(0,Me.jsxs)("div",{className:"card shadow-sm",children:[(0,Me.jsx)("div",{className:"card-header",children:(0,Me.jsx)("h5",{className:"card-title mb-0",children:"Your Recommendation History"})}),(0,Me.jsx)("div",{className:"card-body",children:y?(0,Me.jsx)("div",{className:"text-center py-3",children:(0,Me.jsx)(Hs,{})}):w.length>0?(0,Me.jsx)("div",{className:"list-group",children:w.map((e=>(0,Me.jsx)("button",{className:"list-group-item list-group-item-action",onClick:()=>(async e=>{const t=w.find((t=>t.id===e));t&&(i({focusArea:t.focus_area,recommendations:t.recommendations,disclaimer:"These recommendations are generated by AI based on the information provided and are not a substitute for professional medical advice. Always consult with healthcare professionals before making significant changes to your health regimen.",date:t.created_at}),window.scrollTo({top:0,behavior:"smooth"}))})(e.id),children:(0,Me.jsxs)("div",{className:"d-flex w-100 justify-content-between",children:[(0,Me.jsx)("h6",{className:"mb-1",children:S[e.focus_area]||e.focus_area}),(0,Me.jsx)("small",{children:new Date(e.created_at).toLocaleDateString()})]})},e.id)))}):(0,Me.jsx)("p",{className:"text-muted text-center",children:"No previous recommendations found."})})]})]}),(0,Me.jsxs)("div",{className:"col-lg-7",children:[e?(0,Me.jsx)("div",{className:"card shadow-sm mb-4",children:(0,Me.jsxs)("div",{className:"card-body text-center py-5",children:[(0,Me.jsx)(Hs,{}),(0,Me.jsx)("p",{className:"mt-3",children:"Generating your personalized recommendations..."}),(0,Me.jsx)("p",{className:"text-muted small",children:"This may take a moment as we analyze your health profile"})]})}):n?(0,Me.jsxs)("div",{className:"card shadow-sm mb-4",children:[(0,Me.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Me.jsxs)("h5",{className:"card-title mb-0",children:["Your ",S[n.focusArea]]})}),(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("div",{className:"recommendations-content",children:n.recommendations.split("\n").map(((e,t)=>e?(0,Me.jsx)("p",{children:e},t):(0,Me.jsx)("br",{},t)))}),(0,Me.jsxs)("div",{className:"alert alert-warning mt-3",children:[(0,Me.jsx)("strong",{children:"Important Disclaimer:"})," ",n.disclaimer]})]}),(0,Me.jsx)("div",{className:"card-footer text-muted",children:(0,Me.jsxs)("small",{children:["Recommendations generated on ",new Date(n.date).toLocaleString()]})})]}):a?(0,Me.jsx)("div",{className:"alert alert-danger",children:a}):(0,Me.jsx)("div",{className:"card shadow-sm mb-4",children:(0,Me.jsxs)("div",{className:"card-body p-5 text-center",children:[(0,Me.jsx)("div",{className:"text-muted mb-3",children:(0,Me.jsx)("i",{className:"fas fa-heart fa-3x"})}),(0,Me.jsx)("h5",{children:"Your personalized health recommendations will appear here"}),(0,Me.jsx)("p",{className:"text-muted",children:'Select a focus area and click "Generate Recommendations" to get started.'})]})}),(0,Me.jsx)("div",{className:"card shadow-sm",children:(0,Me.jsxs)("div",{className:"card-body",children:[(0,Me.jsx)("h5",{children:"How We Create Your Recommendations"}),(0,Me.jsx)("p",{children:"Our AI-powered recommendation system uses multiple data points from your health profile to generate personalized health guidance:"}),(0,Me.jsxs)("div",{className:"row g-4",children:[(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"d-flex mb-2",children:[(0,Me.jsx)("div",{className:"me-3 text-primary",children:(0,Me.jsx)("i",{className:"fas fa-user-circle fa-lg"})}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h6",{children:"Your Profile"}),(0,Me.jsx)("p",{className:"text-muted small mb-0",children:"Age, gender, height, weight, and BMI are used to tailor recommendations to your body type and demographics."})]})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"d-flex mb-2",children:[(0,Me.jsx)("div",{className:"me-3 text-primary",children:(0,Me.jsx)("i",{className:"fas fa-notes-medical fa-lg"})}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h6",{children:"Medical Conditions"}),(0,Me.jsx)("p",{className:"text-muted small mb-0",children:"Any conditions listed in your profile are considered to ensure recommendations are appropriate and safe."})]})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"d-flex mb-2",children:[(0,Me.jsx)("div",{className:"me-3 text-primary",children:(0,Me.jsx)("i",{className:"fas fa-chart-line fa-lg"})}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h6",{children:"Health Parameters"}),(0,Me.jsx)("p",{className:"text-muted small mb-0",children:"Your recorded health metrics like blood pressure, cholesterol, and glucose levels inform specific health guidance."})]})]})}),(0,Me.jsx)("div",{className:"col-md-6",children:(0,Me.jsxs)("div",{className:"d-flex",children:[(0,Me.jsx)("div",{className:"me-3 text-primary",children:(0,Me.jsx)("i",{className:"fas fa-brain fa-lg"})}),(0,Me.jsxs)("div",{children:[(0,Me.jsx)("h6",{children:"AI Analysis"}),(0,Me.jsx)("p",{className:"text-muted small mb-0",children:"Advanced AI models analyze your complete health profile to generate evidence-based recommendations specific to your selected focus area."})]})]})})]}),(0,Me.jsx)("div",{className:"alert alert-info mt-3 mb-0",children:(0,Me.jsxs)("small",{children:[(0,Me.jsx)("strong",{children:"Privacy Note:"})," Your health data is processed securely. We use anonymized data when communicating with AI services to ensure your privacy is protected."]})})]})})]})]})]})};const DS=function(){return(0,Me.jsx)(Ae,{basename:"/DiGiHealthAdv",children:(0,Me.jsxs)(De,{children:[(0,Me.jsx)(wt,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored"}),(0,Me.jsxs)(ve,{children:[(0,Me.jsx)(ge,{path:"/",element:(0,Me.jsx)(Ct,{})}),(0,Me.jsx)(ge,{path:"/register",element:(0,Me.jsx)(Bs,{})}),(0,Me.jsx)(ge,{path:"/dashboard",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(Mc,{})})}),(0,Me.jsx)(ge,{path:"/health-overview",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(X_,{})})}),(0,Me.jsx)(ge,{path:"/medical-history",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(Y_,{})})}),(0,Me.jsx)(ge,{path:"/chronic-disease-management",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(K_,{})})}),(0,Me.jsx)(ge,{path:"/vaccination-history",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(J_,{})})}),(0,Me.jsx)(ge,{path:"/medication-tracker",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(Q_,{})})}),(0,Me.jsx)(ge,{path:"/health-analytics",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(hS,{})})}),(0,Me.jsx)(ge,{path:"/appointments/upcoming",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(uS,{})})}),(0,Me.jsx)(ge,{path:"/appointments/history",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(pS,{})})}),(0,Me.jsx)(ge,{path:"/appointments/telehealth",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(fS,{})})}),(0,Me.jsx)(ge,{path:"/appointments/reminders",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(mS,{})})}),(0,Me.jsx)(ge,{path:"/help-center",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(gS,{})})}),(0,Me.jsx)(ge,{path:"/support/contact",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(bS,{})})}),(0,Me.jsx)(ge,{path:"/support/chat",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(vS,{})})}),(0,Me.jsx)(ge,{path:"/profile",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(yS,{})})}),(0,Me.jsx)(ge,{path:"/settings/security",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(xS,{})})}),(0,Me.jsx)(ge,{path:"/settings/backup",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(wS,{})})}),(0,Me.jsx)(ge,{path:"/admin/database-setup",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(AS,{})})}),(0,Me.jsx)(ge,{path:"/health-metrics",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(kS,{})})}),(0,Me.jsx)(ge,{path:"/image-analysis",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(ES,{})})}),(0,Me.jsx)(ge,{path:"/health-assistant",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(CS,{})})}),(0,Me.jsx)(ge,{path:"/ai-insights",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(jS,{})})}),(0,Me.jsx)(ge,{path:"/health-metrics/upload",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(kS,{mode:"upload"})})}),(0,Me.jsx)(ge,{path:"/image-analysis/history",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(ES,{mode:"history"})})}),(0,Me.jsx)(ge,{path:"/health-assistant/recommendations",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(CS,{mode:"recommendations"})})}),(0,Me.jsx)(ge,{path:"/ai/health-metrics",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(NS,{})})}),(0,Me.jsx)(ge,{path:"/ai/image-analysis",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(RS,{})})}),(0,Me.jsx)(ge,{path:"/ai/health-assistant",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(CS,{})})}),(0,Me.jsx)(ge,{path:"/ai/health-recommendations",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(IS,{})})}),(0,Me.jsx)(ge,{path:"/ai/symptom-checker",element:(0,Me.jsx)(kt,{children:(0,Me.jsx)(CS,{mode:"symptoms"})})}),(0,Me.jsx)(ge,{path:"/ai/image-analysis",element:(0,Me.jsx)(RS,{})}),(0,Me.jsx)(ge,{path:"/ai/health-assistant",element:(0,Me.jsx)(CS,{})}),(0,Me.jsx)(ge,{path:"/ai/health-recommendations",element:(0,Me.jsx)(IS,{})})]})]})})},LS=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function OS(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const s=e.installing;null!=s&&(s.onstatechange=()=>{"installed"===s.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}const FS=e=>{e&&e instanceof Function&&s.e(453).then(s.bind(s,453)).then((t=>{let{getCLS:s,getFID:n,getFCP:i,getLCP:a,getTTFB:r}=t;s(e),n(e),i(e),a(e),r(e)}))};i.createRoot(document.getElementById("root")).render((0,Me.jsx)(t.StrictMode,{children:(0,Me.jsx)(DS,{})})),function(e){if("serviceWorker"in navigator){if(new URL("/DiGiHealthAdv",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="/DiGiHealthAdv/service-worker.js";LS?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((s=>{const n=s.headers.get("content-type");404===s.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):OS(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):OS(t,e)}))}}(),FS()})()})();
//# sourceMappingURL=main.f1daa222.js.map