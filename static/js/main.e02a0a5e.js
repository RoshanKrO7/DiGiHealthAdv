/*! For license information please see main.e02a0a5e.js.LICENSE.txt */
(()=>{var e={43:(e,t,s)=>{"use strict";e.exports=s(202)},95:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AuthAdminApi:()=>jt,AuthApiError:()=>We,AuthClient:()=>Tt,AuthError:()=>Ue,AuthImplicitGrantRedirectError:()=>Ze,AuthInvalidCredentialsError:()=>Qe,AuthInvalidTokenResponseError:()=>Je,AuthPKCEGrantCodeExchangeError:()=>tt,AuthRetryableFetchError:()=>st,AuthSessionMissingError:()=>Ke,AuthUnknownError:()=>Ge,AuthWeakPasswordError:()=>nt,CustomAuthError:()=>Ye,FunctionRegion:()=>o,FunctionsError:()=>i,FunctionsFetchError:()=>n,FunctionsHttpError:()=>a,FunctionsRelayError:()=>r,GoTrueAdminApi:()=>bt,GoTrueClient:()=>Nt,NavigatorLockAcquireTimeoutError:()=>St,PostgrestError:()=>g,REALTIME_CHANNEL_STATES:()=>H,REALTIME_LISTEN_TYPES:()=>z,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:()=>F,REALTIME_PRESENCE_LISTEN_EVENTS:()=>O,REALTIME_SUBSCRIBE_STATES:()=>B,RealtimeChannel:()=>U,RealtimeClient:()=>q,RealtimePresence:()=>$,SupabaseClient:()=>Rt,createClient:()=>Dt,isAuthApiError:()=>qe,isAuthError:()=>Ve,isAuthImplicitGrantRedirectError:()=>et,isAuthRetryableFetchError:()=>it,isAuthSessionMissingError:()=>Xe,isAuthWeakPasswordError:()=>rt,lockInternals:()=>wt,navigatorLock:()=>kt});class i extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",s=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=s}}class n extends i{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class r extends i{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class a extends i{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var o;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(o||(o={}));var l=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function o(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class c{constructor(e){let{headers:t={},customFetch:i,region:n=o.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=n,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Promise.resolve().then(s.bind(s,630)).then((e=>{let{default:s}=e;return s(...t)}))}:fetch),function(){return t(...arguments)}})(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s;return l(this,void 0,void 0,(function*(){try{const{headers:i,method:o,body:l}=t;let c,d={},{region:h}=t;h||(h=this.region),h&&"any"!==h&&(d["x-region"]=h),l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&("undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",c=l):"string"===typeof l?(d["Content-Type"]="text/plain",c=l):"undefined"!==typeof FormData&&l instanceof FormData?c=l:(d["Content-Type"]="application/json",c=JSON.stringify(l)));const u=yield this.fetch(`${this.url}/${e}`,{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),i),body:c}).catch((e=>{throw new n(e)})),p=u.headers.get("x-relay-error");if(p&&"true"===p)throw new r(u);if(!u.ok)throw new a(u);let f,m=(null!==(s=u.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return f="application/json"===m?yield u.json():"application/octet-stream"===m?yield u.blob():"text/event-stream"===m?u:"multipart/form-data"===m?yield u.formData():yield u.text(),{data:f,error:null}}catch(i){return{data:null,error:i}}}))}}var d=s(980);const{PostgrestClient:h,PostgrestQueryBuilder:u,PostgrestFilterBuilder:p,PostgrestTransformBuilder:f,PostgrestBuilder:m,PostgrestError:g}=d,v={"X-Client-Info":"realtime-js/2.11.2"};var b,y,x,w,_,S;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(b||(b={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(y||(y={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(x||(x={})),function(e){e.websocket="websocket"}(w||(w={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(_||(_={}));class k{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const i=t.getUint8(1),n=t.getUint8(2);let r=this.HEADER_LENGTH+2;const a=s.decode(e.slice(r,r+i));r+=i;const o=s.decode(e.slice(r,r+n));r+=n;return{ref:null,topic:a,event:o,payload:JSON.parse(s.decode(e.slice(r,e.byteLength)))}}}class A{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(S||(S={}));const C=function(e,t){var s;const i=null!==(s=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==s?s:[];return Object.keys(t).reduce(((s,n)=>(s[n]=E(n,e,t,i),s)),{})},E=(e,t,s,i)=>{const n=t.find((t=>t.name===e)),r=null===n||void 0===n?void 0:n.type,a=s[e];return r&&!i.includes(r)?N(r,a):j(a)},N=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return R(t,s)}switch(e){case S.bool:return T(t);case S.float4:case S.float8:case S.int2:case S.int4:case S.int8:case S.numeric:case S.oid:return M(t);case S.json:case S.jsonb:return P(t);case S.timestamp:return D(t);case S.abstime:case S.date:case S.daterange:case S.int4range:case S.int8range:case S.money:case S.reltime:case S.text:case S.time:case S.timestamptz:case S.timetz:case S.tsrange:case S.tstzrange:default:return j(t)}},j=e=>e,T=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},M=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},P=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},R=(e,t)=>{if("string"!==typeof e)return e;const s=e.length-1,i=e[s];if("{"===e[0]&&"}"===i){let i;const r=e.slice(1,s);try{i=JSON.parse("["+r+"]")}catch(n){i=r?r.split(","):[]}return i.map((e=>N(t,e)))}return e},D=e=>"string"===typeof e?e.replace(" ","T"):e,I=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class L{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:s}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(s)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var O,F,z,B;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(O||(O={}));class ${constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},(e=>{const{onJoin:t,onLeave:s,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=$.syncState(this.state,e,t,s),this.pendingDiffs.forEach((e=>{this.state=$.syncDiff(this.state,e,t,s)})),this.pendingDiffs=[],i()})),this.channel._on(s.diff,{},(e=>{const{onJoin:t,onLeave:s,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=$.syncDiff(this.state,e,t,s),i())})),this.onJoin(((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})})),this.onLeave(((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,s,i){const n=this.cloneDeep(e),r=this.transformState(t),a={},o={};return this.map(n,((e,t)=>{r[e]||(o[e]=t)})),this.map(r,((e,t)=>{const s=n[e];if(s){const i=t.map((e=>e.presence_ref)),n=s.map((e=>e.presence_ref)),r=t.filter((e=>n.indexOf(e.presence_ref)<0)),l=s.filter((e=>i.indexOf(e.presence_ref)<0));r.length>0&&(a[e]=r),l.length>0&&(o[e]=l)}else a[e]=t})),this.syncDiff(n,{joins:a,leaves:o},s,i)}static syncDiff(e,t,s,i){const{joins:n,leaves:r}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(n,((t,i)=>{var n;const r=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(i),r.length>0){const s=e[t].map((e=>e.presence_ref)),i=r.filter((e=>s.indexOf(e.presence_ref)<0));e[t].unshift(...i)}s(t,r,i)})),this.map(r,((t,s)=>{let n=e[t];if(!n)return;const r=s.map((e=>e.presence_ref));n=n.filter((e=>r.indexOf(e.presence_ref)<0)),e[t]=n,i(t,n,s),0===n.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((s=>t(s,e[s])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,s)=>{const i=e[s];return t[s]="metas"in i?i.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):i,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(F||(F={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(z||(z={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(B||(B={}));const H=y;class U{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},s=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=y.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new L(this,x.join,this.params,this.timeout),this.rejoinTimer=new A((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=y.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=y.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=y.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=y.errored,this.rejoinTimer.scheduleTimeout())})),this._on(x.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new $(this),this.broadcastEndpointURL=I(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var s,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:n,presence:r,private:a}}=this.params;this._onError((t=>null===e||void 0===e?void 0:e(B.CHANNEL_ERROR,t))),this._onClose((()=>null===e||void 0===e?void 0:e(B.CLOSED)));const o={},l={broadcast:n,presence:r,postgres_changes:null!==(i=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map((e=>e.filter)))&&void 0!==i?i:[],private:a};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async t=>{let{postgres_changes:s}=t;var i;if(this.socket.setAuth(),void 0!==s){const t=this.bindings.postgres_changes,n=null!==(i=null===t||void 0===t?void 0:t.length)&&void 0!==i?i:0,r=[];for(let i=0;i<n;i++){const n=t[i],{filter:{event:a,schema:o,table:l,filter:c}}=n,d=s&&s[i];if(!d||d.event!==a||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null===e||void 0===e||e(B.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));r.push(Object.assign(Object.assign({},n),{id:d.id}))}return this.bindings.postgres_changes=r,void(e&&e(B.SUBSCRIBED))}null===e||void 0===e||e(B.SUBSCRIBED)})).receive("error",(t=>{null===e||void 0===e||e(B.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null===e||void 0===e||e(B.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i;if(this._canPush()||"broadcast"!==e.type)return new Promise((s=>{var i,n,r;const a=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(r=null===(n=null===(i=this.params)||void 0===i?void 0:i.config)||void 0===n?void 0:n.broadcast)||void 0===r?void 0:r.ack)||s("ok"),a.receive("ok",(()=>s("ok"))),a.receive("error",(()=>s("error"))),a.receive("timeout",(()=>s("timed out")))}));{const{event:r,payload:a}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:a,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(i=e.body)||void 0===i?void 0:i.cancel()),e.ok?"ok":"error"}catch(n){return"AbortError"===n.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=y.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(x.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((s=>{const i=new L(this,x.leave,{},e);i.receive("ok",(()=>{t(),s("ok")})).receive("timeout",(()=>{t(),s("timed out")})).receive("error",(()=>{s("error")})),i.send(),this._canPush()||i.trigger("ok",{})}))}async _fetchWithTimeout(e,t,s){const i=new AbortController,n=setTimeout((()=>i.abort()),s),r=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(n),r}_push(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new L(this,e,t,s);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var i,n;const r=e.toLocaleLowerCase(),{close:a,error:o,leave:l,join:c}=x;if(s&&[a,o,l,c].indexOf(r)>=0&&s!==this._joinRef())return;let d=this._onMessage(r,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(r)?null===(i=this.bindings.postgres_changes)||void 0===i||i.filter((e=>{var t,s,i;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(i=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===i?void 0:i.toLocaleLowerCase())===r})).map((e=>e.callback(d,s))):null===(n=this.bindings[r])||void 0===n||n.filter((e=>{var s,i,n,a,o,l;if(["broadcast","presence","postgres_changes"].includes(r)){if("id"in e){const r=e.id,a=null===(s=e.filter)||void 0===s?void 0:s.event;return r&&(null===(i=t.ids)||void 0===i?void 0:i.includes(r))&&("*"===a||(null===a||void 0===a?void 0:a.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{const s=null===(o=null===(a=null===e||void 0===e?void 0:e.filter)||void 0===a?void 0:a.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===r})).map((e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:i,type:n,errors:r}=e,a={schema:t,table:s,commit_timestamp:i,eventType:n,new:{},old:{},errors:r};d=Object.assign(Object.assign({},a),this._getPayloadRecords(e))}e.callback(d,s)}))}_isClosed(){return this.state===y.closed}_isJoined(){return this.state===y.joined}_isJoining(){return this.state===y.joining}_isLeaving(){return this.state===y.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const i=e.toLocaleLowerCase(),n={type:i,filter:t,callback:s};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter((e=>{var i;return!((null===(i=e.type)||void 0===i?void 0:i.toLocaleLowerCase())===s&&U.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(x.close,{},e)}_onError(e){this._on(x.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=y.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=C(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=C(e.columns,e.old_record)),t}}const V=()=>{},W="undefined"!==typeof WebSocket;class q{constructor(e,t){var i;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=v,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=V,this.conn=null,this.sendBuffer=[],this.serializer=new k,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Promise.resolve().then(s.bind(s,630)).then((e=>{let{default:s}=e;return s(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint=`${e}/${w.websocket}`,this.httpEndpoint=I(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=null===(i=null===t||void 0===t?void 0:t.params)||void 0===i?void 0:i.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new A((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(W)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new G(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),s.e(952).then(s.t.bind(s,952,23)).then((e=>{let{default:t}=e;this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case b.connecting:return _.Connecting;case b.open:return _.Open;case b.closing:return _.Closing;default:return _.Closed}}isConnected(){return this.connectionState()===_.Open}channel(e){const t=new U(`realtime:${e}`,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},this);return this.channels.push(t),t}push(e){const{topic:t,event:s,payload:i,ref:n}=e,r=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${s} (${n})`,i),this.isConnected()?r():this.sendBuffer.push(r)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let s=null;try{s=JSON.parse(atob(e.split(".")[1]))}catch(t){}if(s&&s.exp){if(!(Math.floor(Date.now()/1e3)-s.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`)}this.accessTokenValue=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(x.access_token,{access_token:e})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:s,payload:i,ref:n}=e;n&&n===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${t} ${s} ${n&&"("+n+")"||""}`,i),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(s,i,n))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(x.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class G{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=b.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class Y extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function K(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class X extends Y{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class J extends Y{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Q=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function o(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const Z=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Promise.resolve().then(s.bind(s,630)).then((e=>{let{default:s}=e;return s(...t)}))}:fetch),function(){return t(...arguments)}},ee=e=>{if(Array.isArray(e))return e.map((e=>ee(e)));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((e=>{let[s,i]=e;const n=s.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[n]=ee(i)})),t};var te=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function o(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const se=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ie=(e,t,i)=>te(void 0,void 0,void 0,(function*(){const n=yield Q(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(s.bind(s,630))).Response:Response}));e instanceof n&&!(null===i||void 0===i?void 0:i.noResolveJson)?e.json().then((s=>{t(new X(se(s),e.status||500))})).catch((e=>{t(new J(se(e),e))})):t(new J(se(e),e))}));function ne(e,t,s,i,n,r){return te(this,void 0,void 0,(function*(){return new Promise(((a,o)=>{e(s,((e,t,s,i)=>{const n={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),i&&(n.body=JSON.stringify(i)),Object.assign(Object.assign({},n),s))})(t,i,n,r)).then((e=>{if(!e.ok)throw e;return(null===i||void 0===i?void 0:i.noResolveJson)?e:e.json()})).then((e=>a(e))).catch((e=>ie(e,o,i)))}))}))}function re(e,t,s,i){return te(this,void 0,void 0,(function*(){return ne(e,"GET",t,s,i)}))}function ae(e,t,s,i,n){return te(this,void 0,void 0,(function*(){return ne(e,"POST",t,i,n,s)}))}function oe(e,t,s,i,n){return te(this,void 0,void 0,(function*(){return ne(e,"DELETE",t,i,n,s)}))}var le=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function o(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const ce={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},de={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class he{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=s,this.fetch=Z(i)}uploadOrUpdate(e,t,s,i){return le(this,void 0,void 0,(function*(){try{let n;const r=Object.assign(Object.assign({},de),i);let a=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(r.upsert)});const o=r.metadata;"undefined"!==typeof Blob&&s instanceof Blob?(n=new FormData,n.append("cacheControl",r.cacheControl),o&&n.append("metadata",this.encodeMetadata(o)),n.append("",s)):"undefined"!==typeof FormData&&s instanceof FormData?(n=s,n.append("cacheControl",r.cacheControl),o&&n.append("metadata",this.encodeMetadata(o))):(n=s,a["cache-control"]=`max-age=${r.cacheControl}`,a["content-type"]=r.contentType,o&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null===i||void 0===i?void 0:i.headers)&&(a=Object.assign(Object.assign({},a),i.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:n,headers:a},(null===r||void 0===r?void 0:r.duplex)?{duplex:r.duplex}:{})),h=yield d.json();if(d.ok)return{data:{path:l,id:h.Id,fullPath:h.Key},error:null};return{data:null,error:h}}catch(n){if(K(n))return{data:null,error:n};throw n}}))}upload(e,t,s){return le(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,s)}))}uploadToSignedUrl(e,t,s,i){return le(this,void 0,void 0,(function*(){const n=this._removeEmptyFolders(e),r=this._getFinalPath(n),a=new URL(this.url+`/object/upload/sign/${r}`);a.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:de.upsert},i),r=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!==typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,r["cache-control"]=`max-age=${t.cacheControl}`,r["content-type"]=t.contentType);const o=yield this.fetch(a.toString(),{method:"PUT",body:e,headers:r}),l=yield o.json();if(o.ok)return{data:{path:n,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(K(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return le(this,void 0,void 0,(function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(i["x-upsert"]="true");const n=yield ae(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),r=new URL(this.url+n.url),a=r.searchParams.get("token");if(!a)throw new Y("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:a},error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}}))}update(e,t,s){return le(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,s)}))}move(e,t,s){return le(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===s||void 0===s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(K(i))return{data:null,error:i};throw i}}))}copy(e,t,s){return le(this,void 0,void 0,(function*(){try{return{data:{path:(yield ae(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===s||void 0===s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(K(i))return{data:null,error:i};throw i}}))}createSignedUrl(e,t,s){return le(this,void 0,void 0,(function*(){try{let i=this._getFinalPath(e),n=yield ae(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},(null===s||void 0===s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const r=(null===s||void 0===s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${r}`)},{data:n,error:null}}catch(i){if(K(i))return{data:null,error:i};throw i}}))}createSignedUrls(e,t,s){return le(this,void 0,void 0,(function*(){try{const i=yield ae(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null===s||void 0===s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:i.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null}))),error:null}}catch(i){if(K(i))return{data:null,error:i};throw i}}))}download(e,t){return le(this,void 0,void 0,(function*(){const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),n=i?`?${i}`:"";try{const t=this._getFinalPath(e),i=yield re(this.fetch,`${this.url}/${s}/${t}${n}`,{headers:this.headers,noResolveJson:!0});return{data:yield i.blob(),error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}}))}info(e){return le(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield re(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ee(e),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}}))}exists(e){return le(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,i){return te(this,void 0,void 0,(function*(){return ne(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),i)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(K(s)&&s instanceof J){const e=s.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:s}}throw s}}))}getPublicUrl(e,t){const s=this._getFinalPath(e),i=[],n=(null===t||void 0===t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&i.push(n);const r="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",a=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==a&&i.push(a);let o=i.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${r}/public/${s}${o}`)}}}remove(e){return le(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}))}list(e,t,s){return le(this,void 0,void 0,(function*(){try{const i=Object.assign(Object.assign(Object.assign({},ce),t),{prefix:e||""});return{data:yield ae(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(K(i))return{data:null,error:i};throw i}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ue={"X-Client-Info":"storage-js/2.7.1"};var pe=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function o(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class fe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},ue),t),this.fetch=Z(s)}listBuckets(){return pe(this,void 0,void 0,(function*(){try{return{data:yield re(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(K(e))return{data:null,error:e};throw e}}))}getBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield re(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return pe(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}}))}updateBucket(e,t){return pe(this,void 0,void 0,(function*(){try{const s=yield function(e,t,s,i,n){return te(this,void 0,void 0,(function*(){return ne(e,"PUT",t,i,n,s)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}}))}emptyBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return pe(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}}))}}class me extends fe{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new he(this.url,this.headers,e,this.fetch)}}let ge="";ge="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const ve={headers:{"X-Client-Info":`supabase-js-${ge}/2.48.1`}},be={schema:"public"},ye={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},xe={};var we=s(630),_e=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function o(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const Se=e=>{let t;return t=e||("undefined"===typeof fetch?we.default:fetch),function(){return t(...arguments)}},ke=(e,t,s)=>{const i=Se(s),n="undefined"===typeof Headers?we.Headers:Headers;return(s,r)=>_e(void 0,void 0,void 0,(function*(){var a;const o=null!==(a=yield t())&&void 0!==a?a:e;let l=new n(null===r||void 0===r?void 0:r.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),i(s,Object.assign(Object.assign({},r),{headers:l}))}))};var Ae=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function o(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};const Ce="2.67.3",Ee={"X-Client-Info":`gotrue-js/${Ce}`},Ne="X-Supabase-Api-Version",je={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"};const Te=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Me={tested:!1,writable:!1},Pe=()=>{if(!Te())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(Me.tested)return Me.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Me.tested=!0,Me.writable=!0}catch(t){Me.tested=!0,Me.writable=!1}return Me.writable};const Re=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return Promise.resolve().then(s.bind(s,630)).then((e=>{let{default:s}=e;return s(...t)}))}:fetch),function(){return t(...arguments)}},De=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},Ie=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(i){return s}},Le=async(e,t)=>{await e.removeItem(t)};class Oe{constructor(){this.promise=new Oe.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Fe(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s,i,n,r,a,o,l,c="",d=0;for(e=e.replace("-","+").replace("_","/");d<e.length;)r=t.indexOf(e.charAt(d++)),a=t.indexOf(e.charAt(d++)),o=t.indexOf(e.charAt(d++)),l=t.indexOf(e.charAt(d++)),s=r<<2|a>>4,i=(15&a)<<4|o>>2,n=(3&o)<<6|l,c+=String.fromCharCode(s),64!=o&&0!=i&&(c+=String.fromCharCode(i)),64!=l&&0!=n&&(c+=String.fromCharCode(n));return c}(s))}function ze(e){return("0"+e.toString(16)).substr(-2)}async function Be(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(s);return Array.from(i).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $e(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let i=0;i<56;i++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,ze).join("")}();let n=i;s&&(n+="/PASSWORD_RECOVERY"),await De(e,`${t}-code-verifier`,n);const r=await Be(i);return[r,i===r?"plain":"s256"]}Oe.promiseConstructor=Promise;const He=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class Ue extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Ve(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class We extends Ue{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function qe(e){return Ve(e)&&"AuthApiError"===e.name}class Ge extends Ue{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ye extends Ue{constructor(e,t,s,i){super(e,s,i),this.name=t,this.status=s}}class Ke extends Ye{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Xe(e){return Ve(e)&&"AuthSessionMissingError"===e.name}class Je extends Ye{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qe extends Ye{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ze extends Ye{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function et(e){return Ve(e)&&"AuthImplicitGrantRedirectError"===e.name}class tt extends Ye{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class st extends Ye{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function it(e){return Ve(e)&&"AuthRetryableFetchError"===e.name}class nt extends Ye{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}function rt(e){return Ve(e)&&"AuthWeakPasswordError"===e.name}var at=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s};const ot=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),lt=[502,503,504];async function ct(e){var t,s;if(!("object"===typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"===typeof s.json))throw new st(ot(e),0);if(lt.includes(e.status))throw new st(ot(e),e.status);let i,n;try{i=await e.json()}catch(a){throw new Ge(ot(a),a)}const r=function(e){const t=e.headers.get(Ne);if(!t)return null;if(!t.match(He))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(a){return null}}(e);if(r&&r.getTime()>=je.timestamp&&"object"===typeof i&&i&&"string"===typeof i.code?n=i.code:"object"===typeof i&&i&&"string"===typeof i.error_code&&(n=i.error_code),n){if("weak_password"===n)throw new nt(ot(i),e.status,(null===(t=i.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===n)throw new Ke}else if("object"===typeof i&&i&&"object"===typeof i.weak_password&&i.weak_password&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0))throw new nt(ot(i),e.status,i.weak_password.reasons);throw new We(ot(i),e.status||500,n)}async function dt(e,t,s,i){var n;const r=Object.assign({},null===i||void 0===i?void 0:i.headers);r[Ne]||(r[Ne]=je.name),(null===i||void 0===i?void 0:i.jwt)&&(r.Authorization=`Bearer ${i.jwt}`);const a=null!==(n=null===i||void 0===i?void 0:i.query)&&void 0!==n?n:{};(null===i||void 0===i?void 0:i.redirectTo)&&(a.redirect_to=i.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await async function(e,t,s,i,n,r){const a=((e,t,s,i)=>{const n={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),n.body=JSON.stringify(i),Object.assign(Object.assign({},n),s))})(t,i,n,r);let o;try{o=await e(s,Object.assign({},a))}catch(l){throw console.error(l),new st(ot(l),0)}o.ok||await ct(o);if(null===i||void 0===i?void 0:i.noResolveJson)return o;try{return await o.json()}catch(l){await ct(l)}}(e,t,s+o,{headers:r,noResolveJson:null===i||void 0===i?void 0:i.noResolveJson},{},null===i||void 0===i?void 0:i.body);return(null===i||void 0===i?void 0:i.xform)?null===i||void 0===i?void 0:i.xform(l):{data:Object.assign({},l),error:null}}function ht(e){var t;let s=null;var i;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(i=e.expires_in,Math.round(Date.now()/1e3)+i)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ut(e){const t=ht(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function pt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ft(e){return{data:e,error:null}}function mt(e){const{action_link:t,email_otp:s,hashed_token:i,redirect_to:n,verification_type:r}=e,a=at(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:i,redirect_to:n,verification_type:r},user:Object.assign({},a)},error:null}}function gt(e){return e}var vt=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s};class bt{constructor(e){let{url:t="",headers:s={},fetch:i}=e;this.url=t,this.headers=s,this.fetch=Re(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await dt(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ve(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:pt})}catch(s){if(Ve(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=vt(e,["options"]),i=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(i.new_email=null===s||void 0===s?void 0:s.newEmail,delete i.newEmail),await dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:mt,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Ve(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await dt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:pt})}catch(t){if(Ve(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,i,n,r,a,o;try{const l={nextPage:null,lastPage:0,total:0},c=await dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(n=null===(i=null===e||void 0===e?void 0:e.perPage)||void 0===i?void 0:i.toString())&&void 0!==n?n:""},xform:gt});if(c.error)throw c.error;const d=await c.json(),h=null!==(r=c.headers.get("x-total-count"))&&void 0!==r?r:0,u=null!==(o=null===(a=c.headers.get("link"))||void 0===a?void 0:a.split(","))&&void 0!==o?o:[];return u.length>0&&(u.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t})),l.total=parseInt(h)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ve(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await dt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:pt})}catch(t){if(Ve(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await dt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:pt})}catch(s){if(Ve(s))return{data:{user:null},error:s};throw s}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await dt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:pt})}catch(s){if(Ve(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await dt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await dt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}}}const yt={getItem:e=>Pe()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Pe()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Pe()&&globalThis.localStorage.removeItem(e)}};function xt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const wt={debug:!!(globalThis&&Pe()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class _t extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class St extends _t{}async function kt(e,t,s){wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const i=new globalThis.AbortController;return t>0&&setTimeout((()=>{i.abort(),wt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},(async i=>{if(!i){if(0===t)throw wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new St(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wt.debug)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(n){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",n)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await s()}wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await s()}finally{wt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}))))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const At={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ee,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Ct=3e4;async function Et(e,t,s){return await s()}class Nt{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Nt.nextInstanceID,Nt.nextInstanceID+=1,this.instanceID>0&&Te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},At),e);if(this.logDebugMessages=!!i.debug,"function"===typeof i.debug&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new bt({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Re(i.fetch),this.lock=i.lock||Et,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Te()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=kt:this.lock=Et,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:Pe()?this.storage=yt:(this.memoryStorage={},this.storage=xt(this.memoryStorage)):(this.memoryStorage={},this.storage=xt(this.memoryStorage)),Te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",n)}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.logger(`GoTrueClient@${this.instanceID} (${Ce}) ${(new Date).toISOString()}`,...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach(((e,s)=>{t[s]=e}))}catch(i){}return s.searchParams.forEach(((e,s)=>{t[s]=e})),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Te()&&this.detectSessionInUrl&&"none"!==s){const{data:i,error:n}=await this._getSessionFromURL(t,s);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),et(n)){const t=null===(e=n.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:n}}return await this._removeSession(),{error:n}}const{session:r,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",r,"redirect type",a),await this._saveSession(r),setTimeout((async()=>{"recovery"===a?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ve(t)?{error:t}:{error:new Ge("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,i;try{const n=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(i=null===e||void 0===e?void 0:e.options)||void 0===i?void 0:i.captchaToken}},xform:ht}),{data:r,error:a}=n;if(a||!r)return{data:{user:null,session:null},error:a};const o=r.session,l=r.user;return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(n){if(Ve(n))return{data:{user:null,session:null},error:n};throw n}}async signUp(e){var t,s,i;try{let n;if("email"in e){const{email:s,password:i,options:r}=e;let a=null,o=null;"pkce"===this.flowType&&([a,o]=await $e(this.storage,this.storageKey)),n=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo,body:{email:s,password:i,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:a,code_challenge_method:o},xform:ht})}else{if(!("phone"in e))throw new Qe("You must provide either an email or phone number and a password");{const{phone:t,password:r,options:a}=e;n=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:r,data:null!==(s=null===a||void 0===a?void 0:a.data)&&void 0!==s?s:{},channel:null!==(i=null===a||void 0===a?void 0:a.channel)&&void 0!==i?i:"sms",gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:ht})}}const{data:r,error:a}=n;if(a||!r)return{data:{user:null,session:null},error:a};const o=r.session,l=r.user;return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(n){if(Ve(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:i,options:n}=e;t=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken}},xform:ut})}else{if(!("phone"in e))throw new Qe("You must provide either an email or phone number and a password");{const{phone:s,password:i,options:n}=e;t=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken}},xform:ut})}}const{data:s,error:i}=t;return i?{data:{user:null,session:null},error:i}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i}):{data:{user:null,session:null},error:new Je}}catch(t){if(Ve(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,i,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Ie(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:n}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ht});if(await Le(this.storage,`${this.storageKey}-code-verifier`),n)throw n;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==i&&void 0!==i?i:null}),error:n}):{data:{user:null,session:null,redirectType:null},error:new Je}}catch(n){if(Ve(n))return{data:{user:null,session:null,redirectType:null},error:n};throw n}}async signInWithIdToken(e){try{const{options:t,provider:s,token:i,access_token:n,nonce:r}=e,a=await dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:n,nonce:r,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:ht}),{data:o,error:l}=a;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Je}}catch(t){if(Ve(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,i,n,r;try{if("email"in e){const{email:i,options:n}=e;let r=null,a=null;"pkce"===this.flowType&&([r,a]=await $e(this.storage,this.storageKey));const{error:o}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:null!==(t=null===n||void 0===n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(s=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},code_challenge:r,code_challenge_method:a},redirectTo:null===n||void 0===n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:s}=e,{data:a,error:o}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(i=null===s||void 0===s?void 0:s.data)&&void 0!==i?i:{},create_user:null===(n=null===s||void 0===s?void 0:s.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},channel:null!==(r=null===s||void 0===s?void 0:s.channel)&&void 0!==r?r:"sms"}});return{data:{user:null,session:null,messageId:null===a||void 0===a?void 0:a.message_id},error:o}}throw new Qe("You must provide either an email or phone number.")}catch(a){if(Ve(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,s;try{let i,n;"options"in e&&(i=null===(t=e.options)||void 0===t?void 0:t.redirectTo,n=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:r,error:a}=await dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:i,xform:ht});if(a)throw a;if(!r)throw new Error("An error occurred on token verification.");const o=r.session,l=r.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(i){if(Ve(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,s,i;try{let n=null,r=null;return"pkce"===this.flowType&&([n,r]=await $e(this.storage,this.storageKey)),await dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(i=null===e||void 0===e?void 0:e.options)||void 0===i?void 0:i.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:r}),headers:this.headers,xform:ft})}catch(n){if(Ve(n))return{data:null,error:n};throw n}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Ke;const{error:i}=await dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}}))}catch(e){if(Ve(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:n}=e,{error:r}=await dt(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken}},redirectTo:null===n||void 0===n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:r}}if("phone"in e){const{phone:s,type:i,options:n}=e,{data:r,error:a}=await dt(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null===r||void 0===r?void 0:r.message_id},error:a}}throw new Qe("You must provide either an email or phone number and a type")}catch(t){if(Ve(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Ie(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,i)=>(t||"user"!==s||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,i))})}return{data:{session:e},error:null}}const{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{session:null},error:n}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:pt}):await this._useSession((async e=>{var t,s,i;const{data:n,error:r}=e;if(r)throw r;return(null===(t=n.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(i=null===(s=n.session)||void 0===s?void 0:s.access_token)&&void 0!==i?i:void 0,xform:pt}):{data:{user:null},error:new Ke}}))}catch(t){if(Ve(t))return Xe(t)&&(await this._removeSession(),await Le(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async s=>{const{data:i,error:n}=s;if(n)throw n;if(!i.session)throw new Ke;const r=i.session;let a=null,o=null;"pkce"===this.flowType&&null!=e.email&&([a,o]=await $e(this.storage,this.storageKey));const{data:l,error:c}=await dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:o}),jwt:r.access_token,xform:pt});if(c)throw c;return r.user=l.user,await this._saveSession(r),await this._notifyAllSubscribers("USER_UPDATED",r),{data:{user:r.user},error:null}}))}catch(s){if(Ve(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return Fe(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ke;const t=Date.now()/1e3;let s=t,i=!0,n=null;const r=Fe(e.access_token);if(r.exp&&(s=r.exp,i=s<=t),i){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};n=t}else{const{data:i,error:r}=await this._getUser(e.access_token);if(r)throw r;n={access_token:e.access_token,refresh_token:e.refresh_token,user:i.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(Ve(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var s;if(!e){const{data:i,error:n}=t;if(n)throw n;e=null!==(s=i.session)&&void 0!==s?s:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Ke;const{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Ve(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Te())throw new Ze("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ze(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new tt("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Ze("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new tt("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const i=new URL(window.location.href);return i.searchParams.delete("code"),window.history.replaceState(window.history.state,"",i.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:n,refresh_token:r,expires_in:a,expires_at:o,token_type:l}=e;if(!n||!a||!r||!l)throw new Ze("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(a);let h=c+d;o&&(h=parseInt(o));const u=h-c;1e3*u<=Ct&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${d}s`);const p=h-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,c);const{data:f,error:m}=await this._getUser(n);if(m)throw m;const g={provider_token:s,provider_refresh_token:i,access_token:n,expires_in:d,expires_at:h,refresh_token:r,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(s){if(Ve(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ie(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var s;const{data:i,error:n}=t;if(n)return{error:n};const r=null===(s=i.session)||void 0===s?void 0:s.access_token;if(r){const{error:t}=await this.admin.signOut(r,e);if(t&&(!qe(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Le(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession((async t=>{var s,i;try{const{data:{session:i},error:n}=t;if(n)throw n;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(n){await(null===(i=this.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",n),console.error(n)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=null,i=null;"pkce"===this.flowType&&([s,i]=await $e(this.storage,this.storageKey,!0));try{return await dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(Ve(n))return{data:null,error:n};throw n}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:i}=await this._useSession((async t=>{var s,i,n,r,a;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(i=e.options)||void 0===i?void 0:i.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:!0});return await dt(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(a=null===(r=o.session)||void 0===r?void 0:r.access_token)&&void 0!==a?a:void 0})}));if(i)throw i;return Te()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===s||void 0===s?void 0:s.url),{data:{provider:e.provider,url:null===s||void 0===s?void 0:s.url},error:null}}catch(s){if(Ve(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var s,i;const{data:n,error:r}=t;if(r)throw r;return await dt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(i=null===(s=n.session)||void 0===s?void 0:s.access_token)&&void 0!==i?i:void 0})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ht})),i=(e,t)=>{const s=200*Math.pow(2,e);return t&&it(t)&&Date.now()+s-n<Ct},new Promise(((e,t)=>{(async()=>{for(let r=0;r<1/0;r++)try{const t=await s(r);if(!i(r,null,t))return void e(t)}catch(n){if(!i(r,n))return void t(n)}})()})))}catch(n){if(this._debug(t,"error",n),Ve(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}var s,i}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Te()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Ie(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s))return this._debug(t,"session is not valid"),void(null!==s&&await this._removeSession());const i=Math.round(Date.now()/1e3),n=(null!==(e=s.expires_at)&&void 0!==e?e:1/0)<i+10;if(this._debug(t,`session has${n?"":" not"} expired with margin of 10s`),n){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),it(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return this._debug(t,"error",s),void console.error(s)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Ke;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Oe;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new Ke;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const i={session:t.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(n){if(this._debug(i,"error",n),Ve(n)){const e={session:null,error:n};return it(n)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(n),n}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],n=Array.from(this.stateChangeEmitters.values()).map((async s=>{try{await s.callback(e,t)}catch(n){i.push(n)}}));if(await Promise.all(n),i.length>0){for(let e=0;e<i.length;e+=1)console.error(i[e]);throw i[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await De(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Le(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Te()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Ct);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const i=Math.floor((1e3*s.expires_at-t)/Ct);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),i<=3&&await this._callRefreshToken(s.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof _t))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Te()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const i=[`provider=${encodeURIComponent(t)}`];if((null===s||void 0===s?void 0:s.redirectTo)&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null===s||void 0===s?void 0:s.scopes)&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await $e(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});i.push(s.toString())}if(null===s||void 0===s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);i.push(e.toString())}return(null===s||void 0===s?void 0:s.skipBrowserRedirect)&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var s;const{data:i,error:n}=t;return n?{data:null,error:n}:await dt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null===i||void 0===i?void 0:i.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var s,i;const{data:n,error:r}=t;if(r)return{data:null,error:r};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await dt(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:null===(s=null===n||void 0===n?void 0:n.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(i=null===o||void 0===o?void 0:o.totp)||void 0===i?void 0:i.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:i,error:n}=t;if(n)return{data:null,error:n};const{data:r,error:a}=await dt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null===i||void 0===i?void 0:i.session)||void 0===s?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+r.expires_in},r)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",r),{data:r,error:a})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:i,error:n}=t;return n?{data:null,error:n}:await dt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null===i||void 0===i?void 0:i.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Ve(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null===e||void 0===e?void 0:e.factors)||[],i=s.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),n=s.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:s,totp:i,phone:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,s;const{data:{session:i},error:n}=e;if(n)return{data:null,error:n};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const r=this._decodeJWT(i.access_token);let a=null;r.aal&&(a=r.aal);let o=a;(null!==(s=null===(t=i.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==s?s:[]).length>0&&(o="aal2");return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:r.amr||[]},error:null}}))))}}Nt.nextInstanceID=0;const jt=bt,Tt=Nt;class Mt extends Tt{constructor(e){super(e)}}var Pt=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function o(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,o)}l((i=i.apply(e,t||[])).next())}))};class Rt{constructor(e,t,s){var i,n,r;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=e.replace(/\/$/,"");this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:s,auth:i,realtime:n,global:r}=e,{db:a,auth:o,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},a),s),auth:Object.assign(Object.assign({},o),i),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),r),accessToken:()=>Ae(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!==s&&void 0!==s?s:{},{db:be,realtime:xe,auth:Object.assign(Object.assign({},ye),{storageKey:o}),global:ve});this.storageKey=null!==(i=l.auth.storageKey)&&void 0!==i?i:"",this.headers=null!==(n=l.global.headers)&&void 0!==n?n:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(r=l.auth)&&void 0!==r?r:{},this.headers,l.global.fetch),this.fetch=ke(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new h(`${a}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new me(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,s)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Pt(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,s){let{autoRefreshToken:i,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:o,flowType:l,lock:c,debug:d}=e;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Mt({url:this.authUrl,headers:Object.assign(Object.assign({},h),t),storageKey:o,autoRefreshToken:i,persistSession:n,detectSessionInUrl:r,storage:a,flowType:l,lock:c,debug:d,fetch:s,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new q(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const Dt=(e,t,s)=>new Rt(e,t,s)},139:(e,t)=>{var s;!function(){"use strict";var i={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var s=arguments[t];s&&(e=a(e,r(s)))}return e}function r(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var s in e)i.call(e,s)&&e[s]&&(t=a(t,s));return t}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(s=function(){return n}.apply(t,[]))||(e.exports=s)}()},153:(e,t,s)=>{"use strict";var i=s(43),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,s){var i,r={},c=null,d=null;for(i in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,i)&&!l.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:n,type:e,key:c,ref:d,props:r,_owner:o.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},173:(e,t,s)=>{e.exports=s(497)()},202:(e,t)=>{"use strict";var s=Symbol.for("react.element"),i=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,s){this.props=e,this.context=t,this.refs=g,this.updater=s||f}function b(){}function y(e,t,s){this.props=e,this.context=t,this.refs=g,this.updater=s||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var x=y.prototype=new b;x.constructor=y,m(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,S={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function A(e,t,i){var n,r={},a=null,o=null;if(null!=t)for(n in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)_.call(t,n)&&!k.hasOwnProperty(n)&&(r[n]=t[n]);var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps)void 0===r[n]&&(r[n]=l[n]);return{$$typeof:s,type:e,key:a,ref:o,props:r,_owner:S.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===s}var E=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function j(e,t,n,r,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case s:case i:l=!0}}if(l)return a=a(l=e),e=""===r?"."+N(l,0):r,w(a)?(n="",null!=e&&(n=e.replace(E,"$&/")+"/"),j(a,t,n,"",(function(e){return e}))):null!=a&&(C(a)&&(a=function(e,t){return{$$typeof:s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(E,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=""===r?".":r+":",w(e))for(var c=0;c<e.length;c++){var d=r+N(o=e[c],c);l+=j(o,t,n,d,a)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=j(o=o.value,t,n,d=r+N(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,s){if(null==e)return e;var i=[],n=0;return j(e,i,"","",(function(e){return t.call(s,e,n++)})),i}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},R={transition:null},D={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:R,ReactCurrentOwner:S};function I(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,s){T(e,(function(){t.apply(this,arguments)}),s)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=n,t.Profiler=a,t.PureComponent=y,t.StrictMode=r,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=I,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=m({},e.props),r=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=S.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!k.hasOwnProperty(c)&&(n[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)n.children=i;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:s,type:e.type,key:r,ref:a,props:n,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=A,t.createFactory=function(e){var t=A.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=I,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,s){return P.current.useImperativeHandle(e,t,s)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,s){return P.current.useReducer(e,t,s)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,s){return P.current.useSyncExternalStore(e,t,s)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},210:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(829)),r=i(s(736)),a=s(745);class o{constructor(e){let{headers:t={},schema:s,fetch:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},a.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=i}from(e){const t=new URL(`${this.url}/${e}`);return new n.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:i=!1,get:n=!1,count:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=new URL(`${this.url}/rpc/${e}`);let l;i||n?(t=i?"HEAD":"GET",Object.entries(s).filter((e=>{let[t,s]=e;return void 0!==s})).map((e=>{let[t,s]=e;return[t,Array.isArray(s)?`{${s.join(",")}}`:`${s}`]})).forEach((e=>{let[t,s]=e;o.searchParams.append(t,s)}))):(t="POST",l=s);const c=Object.assign({},this.headers);return a&&(c.Prefer=`count=${a}`),new r.default({method:t,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=o},218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},234:(e,t)=>{"use strict";function s(e,t){var s=e.length;e.push(t);e:for(;0<s;){var i=s-1>>>1,n=e[i];if(!(0<r(n,t)))break e;e[i]=t,e[s]=n,s=i}}function i(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],s=e.pop();if(s!==t){e[0]=s;e:for(var i=0,n=e.length,a=n>>>1;i<a;){var o=2*(i+1)-1,l=e[o],c=o+1,d=e[c];if(0>r(l,s))c<n&&0>r(d,l)?(e[i]=d,e[c]=s,i=c):(e[i]=l,e[o]=s,i=o);else{if(!(c<n&&0>r(d,s)))break e;e[i]=d,e[c]=s,i=c}}}return t}function r(e,t){var s=e.sortIndex-t.sortIndex;return 0!==s?s:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,u=null,p=3,f=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=i(d);null!==t;){if(null===t.callback)n(d);else{if(!(t.startTime<=e))break;n(d),t.sortIndex=t.expirationTime,s(c,t)}t=i(d)}}function w(e){if(g=!1,x(e),!m)if(null!==i(c))m=!0,R(_);else{var t=i(d);null!==t&&D(w,t.startTime-e)}}function _(e,s){m=!1,g&&(g=!1,b(C),C=-1),f=!0;var r=p;try{for(x(s),u=i(c);null!==u&&(!(u.expirationTime>s)||e&&!j());){var a=u.callback;if("function"===typeof a){u.callback=null,p=u.priorityLevel;var o=a(u.expirationTime<=s);s=t.unstable_now(),"function"===typeof o?u.callback=o:u===i(c)&&n(c),x(s)}else n(c);u=i(c)}if(null!==u)var l=!0;else{var h=i(d);null!==h&&D(w,h.startTime-s),l=!1}return l}finally{u=null,p=r,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,k=!1,A=null,C=-1,E=5,N=-1;function j(){return!(t.unstable_now()-N<E)}function T(){if(null!==A){var e=t.unstable_now();N=e;var s=!0;try{s=A(!0,e)}finally{s?S():(k=!1,A=null)}}else k=!1}if("function"===typeof y)S=function(){y(T)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,P=M.port2;M.port1.onmessage=T,S=function(){P.postMessage(null)}}else S=function(){v(T,0)};function R(e){A=e,k||(k=!0,S())}function D(e,s){C=v((function(){e(t.unstable_now())}),s)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,R(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var s=p;p=t;try{return e()}finally{p=s}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var s=p;p=e;try{return t()}finally{p=s}},t.unstable_scheduleCallback=function(e,n,r){var a=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?a+r:a:r=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:n,priorityLevel:e,startTime:r,expirationTime:o=r+o,sortIndex:-1},r>a?(e.sortIndex=r,s(d,e),null===i(c)&&e===i(d)&&(g?(b(C),C=-1):g=!0,D(w,r-a))):(e.sortIndex=o,s(c,e),m||f||(m=!0,R(_))),e},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(e){var t=p;return function(){var s=p;p=t;try{return e.apply(this,arguments)}finally{p=s}}}},286:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(630)),r=i(s(611));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=n.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,s,i;let n=null,a=null,o=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(a="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const i=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),r=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");i&&r&&r.length>1&&(o=parseInt(r[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(a)&&(a.length>1?(n={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,o=null,l=406,c="Not Acceptable"):a=1===a.length?a[0]:null)}else{const t=await e.text();try{n=JSON.parse(t),Array.isArray(n)&&404===e.status&&(a=[],n=null,l=200,c="OK")}catch(d){404===e.status&&""===t?(l=204,c="No Content"):n={message:t}}if(n&&this.isMaybeSingle&&(null===(i=null===n||void 0===n?void 0:n.details)||void 0===i?void 0:i.includes("0 rows"))&&(n=null,l=200,c="OK"),n&&this.shouldThrowOnError)throw new r.default(n)}return{error:n,data:a,count:o,status:l,statusText:c}}));return this.shouldThrowOnError||(s=s.catch((e=>{var t,s,i;return{error:{message:`${null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null===e||void 0===e?void 0:e.message}`,details:`${null!==(s=null===e||void 0===e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(i=null===e||void 0===e?void 0:e.code)&&void 0!==i?i:""}`},data:null,count:null,status:0,statusText:""}}))),s.then(e,t)}}},374:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(286));class r extends n.default{select(e){let t=!1;const s=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:s,foreignTable:i,referencedTable:n=i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n?`${n}.order`:"order",a=this.url.searchParams.get(r);return this.url.searchParams.set(r,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e){let{foreignTable:t,referencedTable:s=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i="undefined"===typeof s?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t){let{foreignTable:s,referencedTable:i=s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n="undefined"===typeof i?"offset":`${i}.offset`,r="undefined"===typeof i?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(r,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:i=!1,wal:n=!1,format:r="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var a;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(a=this.headers.Accept)&&void 0!==a?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${r}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=r},391:(e,t,s)=>{"use strict";var i=s(950);t.createRoot=i.createRoot,t.hydrateRoot=i.hydrateRoot},400:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},440:e=>{"use strict";var t=function(){};e.exports=t},497:(e,t,s)=>{"use strict";var i=s(218);function n(){}function r(){}r.resetWarningCache=n,e.exports=function(){function e(e,t,s,n,r,a){if(a!==i){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var s={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:n};return s.PropTypes=s,s}},579:(e,t,s)=>{"use strict";e.exports=s(153)},611:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class s extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=s},630:(e,t,s)=>{"use strict";s.r(t),s.d(t,{Headers:()=>a,Request:()=>o,Response:()=>l,default:()=>r,fetch:()=>n});var i=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof s.g)return s.g;throw new Error("unable to locate global object")}();const n=i.fetch,r=i.fetch.bind(i),a=i.Headers,o=i.Request,l=i.Response},730:(e,t,s)=>{"use strict";var i=s(43),n=s(853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function m(e,t,s,i,n,r,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,s,i){var n=g.hasOwnProperty(t)?g[t]:null;(null!==n?0!==n.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,s,i){if(null===t||"undefined"===typeof t||function(e,t,s,i){if(null!==s&&0===s.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==s?!s.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,s,i))return!0;if(i)return!1;if(null!==s)switch(s.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,s,n,i)&&(s=null),i||null===n?function(e){return!!h.call(f,e)||!h.call(p,e)&&(u.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===s?e.removeAttribute(t):e.setAttribute(t,""+s)):n.mustUseProperty?e[n.propertyName]=null===s?3!==n.type&&"":s:(t=n.attributeName,i=n.attributeNamespace,null===s?e.removeAttribute(t):(s=3===(n=n.type)||4===n&&!0===s?"":""+s,i?e.setAttributeNS(i,t,s):e.setAttribute(t,s))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,b);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,b);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,b);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),E=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function I(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var L,O=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var z=!1;function B(e,t){if(!e||z)return"";z=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var i=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){i=c}e.call(t.prototype)}else{try{throw Error()}catch(c){i=c}e()}}catch(c){if(c&&i&&"string"===typeof c.stack){for(var n=c.stack.split("\n"),r=i.stack.split("\n"),a=n.length-1,o=r.length-1;1<=a&&0<=o&&n[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==r[o]){if(1!==a||1!==o)do{if(a--,0>--o||n[a]!==r[o]){var l="\n"+n[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{z=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?F(e):""}function $(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case _:return"Portal";case A:return"Profiler";case k:return"StrictMode";case j:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return H(e(t))}catch(s){}}return null}function U(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof s&&"function"===typeof s.get&&"function"===typeof s.set){var n=s.get,r=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){i=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function G(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),i="";return e&&(i=W(e)?e.checked?"true":"false":e.value),(e=i)!==s&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var s=t.checked;return O({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=s?s:e._wrapperState.initialChecked})}function X(e,t){var s=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;s=V(null!=t.value?t.value:s),e._wrapperState={initialChecked:i,initialValue:s,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Q(e,t){J(e,t);var s=V(t.value),i=t.type;if(null!=s)"number"===i?(0===s&&""===e.value||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,s):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}""!==(s=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==s&&(e.name=s)}function ee(e,t,s){"number"===t&&Y(e.ownerDocument)===e||(null==s?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var te=Array.isArray;function se(e,t,s,i){if(e=e.options,t){t={};for(var n=0;n<s.length;n++)t["$"+s[n]]=!0;for(s=0;s<e.length;s++)n=t.hasOwnProperty("$"+e[s].value),e[s].selected!==n&&(e[s].selected=n),n&&i&&(e[s].defaultSelected=!0)}else{for(s=""+V(s),t=null,n=0;n<e.length;n++){if(e[n].value===s)return e[n].selected=!0,void(i&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return O({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var s=t.value;if(null==s){if(s=t.children,t=t.defaultValue,null!=s){if(null!=t)throw Error(r(92));if(te(s)){if(1<s.length)throw Error(r(93));s=s[0]}t=s}null==t&&(t=""),s=t}e._wrapperState={initialValue:V(s)}}function re(e,t){var s=V(t.value),i=V(t.defaultValue);null!=s&&((s=""+s)!==e.value&&(e.value=s),null==t.defaultValue&&e.defaultValue!==s&&(e.defaultValue=s)),null!=i&&(e.defaultValue=""+i)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,he=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function ue(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&3===s.nodeType)return void(s.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function me(e,t,s){return null==t||"boolean"===typeof t||""===t?"":s||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var s in e=e.style,t)if(t.hasOwnProperty(s)){var i=0===s.indexOf("--"),n=me(s,t[s],i);"float"===s&&(s="cssFloat"),i?e.setProperty(s,n):e[s]=n}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=O({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Se=null,ke=null;function Ae(e){if(e=yn(e)){if("function"!==typeof _e)throw Error(r(280));var t=e.stateNode;t&&(t=wn(t),_e(e.stateNode,e.type,t))}}function Ce(e){Se?ke?ke.push(e):ke=[e]:Se=e}function Ee(){if(Se){var e=Se,t=ke;if(ke=Se=null,Ae(e),t)for(e=0;e<t.length;e++)Ae(t[e])}}function Ne(e,t){return e(t)}function je(){}var Te=!1;function Me(e,t,s){if(Te)return e(t,s);Te=!0;try{return Ne(e,t,s)}finally{Te=!1,(null!==Se||null!==ke)&&(je(),Ee())}}function Pe(e,t){var s=e.stateNode;if(null===s)return null;var i=wn(s);if(null===i)return null;s=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(s&&"function"!==typeof s)throw Error(r(231,t,typeof s));return s}var Re=!1;if(d)try{var De={};Object.defineProperty(De,"passive",{get:function(){Re=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(de){Re=!1}function Ie(e,t,s,i,n,r,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(s,c)}catch(d){this.onError(d)}}var Le=!1,Oe=null,Fe=!1,ze=null,Be={onError:function(e){Le=!0,Oe=e}};function $e(e,t,s,i,n,r,a,o,l){Le=!1,Oe=null,Ie.apply(Be,arguments)}function He(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(s=t.return),e=t.return}while(e)}return 3===t.tag?s:null}function Ue(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(He(e)!==e)throw Error(r(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(r(188));return t!==e?null:e}for(var s=e,i=t;;){var n=s.return;if(null===n)break;var a=n.alternate;if(null===a){if(null!==(i=n.return)){s=i;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===s)return Ve(n),e;if(a===i)return Ve(n),t;a=a.sibling}throw Error(r(188))}if(s.return!==i.return)s=n,i=a;else{for(var o=!1,l=n.child;l;){if(l===s){o=!0,s=n,i=a;break}if(l===i){o=!0,i=n,s=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===s){o=!0,s=a,i=n;break}if(l===i){o=!0,i=a,s=n;break}l=l.sibling}if(!o)throw Error(r(189))}}if(s.alternate!==i)throw Error(r(190))}if(3!==s.tag)throw Error(r(188));return s.stateNode.current===s?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ge=n.unstable_scheduleCallback,Ye=n.unstable_cancelCallback,Ke=n.unstable_shouldYield,Xe=n.unstable_requestPaint,Je=n.unstable_now,Qe=n.unstable_getCurrentPriorityLevel,Ze=n.unstable_ImmediatePriority,et=n.unstable_UserBlockingPriority,tt=n.unstable_NormalPriority,st=n.unstable_LowPriority,it=n.unstable_IdlePriority,nt=null,rt=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ut(e,t){var s=e.pendingLanes;if(0===s)return 0;var i=0,n=e.suspendedLanes,r=e.pingedLanes,a=268435455&s;if(0!==a){var o=a&~n;0!==o?i=ht(o):0!==(r&=a)&&(i=ht(r))}else 0!==(a=s&~n)?i=ht(a):0!==r&&(i=ht(r));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&n)&&((n=i&-i)>=(r=t&-t)||16===n&&0!==(4194240&r)))return t;if(0!==(4&i)&&(i|=16&s),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)n=1<<(s=31-at(t)),i|=e[s],t&=~n;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function vt(e,t,s){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=s}function bt(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var i=31-at(s),n=1<<i;n&t|e[i]&t&&(e[i]|=t),s&=~n}}var yt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,St,kt,At,Ct=!1,Et=[],Nt=null,jt=null,Tt=null,Mt=new Map,Pt=new Map,Rt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function It(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":jt=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Lt(e,t,s,i,n,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:s,eventSystemFlags:i,nativeEvent:r,targetContainers:[n]},null!==t&&(null!==(t=yn(t))&&_t(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Ot(e){var t=bn(e.target);if(null!==t){var s=He(t);if(null!==s)if(13===(t=s.tag)){if(null!==(t=Ue(s)))return e.blockedOn=t,void At(e.priority,(function(){St(s)}))}else if(3===t&&s.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===s.tag?s.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var s=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==s)return null!==(t=yn(s))&&_t(t),e.blockedOn=s,!1;var i=new(s=e.nativeEvent).constructor(s.type,s);xe=i,s.target.dispatchEvent(i),xe=null,t.shift()}return!0}function zt(e,t,s){Ft(e)&&s.delete(t)}function Bt(){Ct=!1,null!==Nt&&Ft(Nt)&&(Nt=null),null!==jt&&Ft(jt)&&(jt=null),null!==Tt&&Ft(Tt)&&(Tt=null),Mt.forEach(zt),Pt.forEach(zt)}function $t(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Bt)))}function Ht(e){function t(t){return $t(t,e)}if(0<Et.length){$t(Et[0],e);for(var s=1;s<Et.length;s++){var i=Et[s];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Nt&&$t(Nt,e),null!==jt&&$t(jt,e),null!==Tt&&$t(Tt,e),Mt.forEach(t),Pt.forEach(t),s=0;s<Rt.length;s++)(i=Rt[s]).blockedOn===e&&(i.blockedOn=null);for(;0<Rt.length&&null===(s=Rt[0]).blockedOn;)Ot(s),null===s.blockedOn&&Rt.shift()}var Ut=x.ReactCurrentBatchConfig,Vt=!0;function Wt(e,t,s,i){var n=yt,r=Ut.transition;Ut.transition=null;try{yt=1,Gt(e,t,s,i)}finally{yt=n,Ut.transition=r}}function qt(e,t,s,i){var n=yt,r=Ut.transition;Ut.transition=null;try{yt=4,Gt(e,t,s,i)}finally{yt=n,Ut.transition=r}}function Gt(e,t,s,i){if(Vt){var n=Kt(e,t,s,i);if(null===n)Ui(e,t,i,Yt,s),It(e,i);else if(function(e,t,s,i,n){switch(t){case"focusin":return Nt=Lt(Nt,e,t,s,i,n),!0;case"dragenter":return jt=Lt(jt,e,t,s,i,n),!0;case"mouseover":return Tt=Lt(Tt,e,t,s,i,n),!0;case"pointerover":var r=n.pointerId;return Mt.set(r,Lt(Mt.get(r)||null,e,t,s,i,n)),!0;case"gotpointercapture":return r=n.pointerId,Pt.set(r,Lt(Pt.get(r)||null,e,t,s,i,n)),!0}return!1}(n,e,t,s,i))i.stopPropagation();else if(It(e,i),4&t&&-1<Dt.indexOf(e)){for(;null!==n;){var r=yn(n);if(null!==r&&wt(r),null===(r=Kt(e,t,s,i))&&Ui(e,t,i,Yt,s),r===n)break;n=r}null!==n&&i.stopPropagation()}else Ui(e,t,i,null,s)}}var Yt=null;function Kt(e,t,s,i){if(Yt=null,null!==(e=bn(e=we(i))))if(null===(t=He(e)))e=null;else if(13===(s=t.tag)){if(null!==(e=Ue(t)))return e;e=null}else if(3===s){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Ze:return 1;case et:return 4;case tt:case st:return 16;case it:return 536870912;default:return 16}default:return 16}}var Jt=null,Qt=null,Zt=null;function es(){if(Zt)return Zt;var e,t,s=Qt,i=s.length,n="value"in Jt?Jt.value:Jt.textContent,r=n.length;for(e=0;e<i&&s[e]===n[e];e++);var a=i-e;for(t=1;t<=a&&s[i-t]===n[r-t];t++);return Zt=n.slice(e,1<t?1-t:void 0)}function ts(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ss(){return!0}function is(){return!1}function ns(e){function t(t,s,i,n,r){for(var a in this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=n,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(n):n[a]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?ss:is,this.isPropagationStopped=is,this}return O(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ss)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ss)},persist:function(){},isPersistent:ss}),t}var rs,as,os,ls={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cs=ns(ls),ds=O({},ls,{view:0,detail:0}),hs=ns(ds),us=O({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ks,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==os&&(os&&"mousemove"===e.type?(rs=e.screenX-os.screenX,as=e.screenY-os.screenY):as=rs=0,os=e),rs)},movementY:function(e){return"movementY"in e?e.movementY:as}}),ps=ns(us),fs=ns(O({},us,{dataTransfer:0})),ms=ns(O({},ds,{relatedTarget:0})),gs=ns(O({},ls,{animationName:0,elapsedTime:0,pseudoElement:0})),vs=O({},ls,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bs=ns(vs),ys=ns(O({},ls,{data:0})),xs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ws={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_s={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ss(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_s[e])&&!!t[e]}function ks(){return Ss}var As=O({},ds,{key:function(e){if(e.key){var t=xs[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ts(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ws[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ks,charCode:function(e){return"keypress"===e.type?ts(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ts(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cs=ns(As),Es=ns(O({},us,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ns=ns(O({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ks})),js=ns(O({},ls,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ts=O({},us,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ms=ns(Ts),Ps=[9,13,27,32],Rs=d&&"CompositionEvent"in window,Ds=null;d&&"documentMode"in document&&(Ds=document.documentMode);var Is=d&&"TextEvent"in window&&!Ds,Ls=d&&(!Rs||Ds&&8<Ds&&11>=Ds),Os=String.fromCharCode(32),Fs=!1;function zs(e,t){switch(e){case"keyup":return-1!==Ps.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bs(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var $s=!1;var Hs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Us(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hs[e.type]:"textarea"===t}function Vs(e,t,s,i){Ce(i),0<(t=Wi(t,"onChange")).length&&(s=new cs("onChange","change",null,s,i),e.push({event:s,listeners:t}))}var Ws=null,qs=null;function Gs(e){Oi(e,0)}function Ys(e){if(G(xn(e)))return e}function Ks(e,t){if("change"===e)return t}var Xs=!1;if(d){var Js;if(d){var Qs="oninput"in document;if(!Qs){var Zs=document.createElement("div");Zs.setAttribute("oninput","return;"),Qs="function"===typeof Zs.oninput}Js=Qs}else Js=!1;Xs=Js&&(!document.documentMode||9<document.documentMode)}function ei(){Ws&&(Ws.detachEvent("onpropertychange",ti),qs=Ws=null)}function ti(e){if("value"===e.propertyName&&Ys(qs)){var t=[];Vs(t,qs,e,we(e)),Me(Gs,t)}}function si(e,t,s){"focusin"===e?(ei(),qs=s,(Ws=t).attachEvent("onpropertychange",ti)):"focusout"===e&&ei()}function ii(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ys(qs)}function ni(e,t){if("click"===e)return Ys(t)}function ri(e,t){if("input"===e||"change"===e)return Ys(t)}var ai="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function oi(e,t){if(ai(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(i=0;i<s.length;i++){var n=s[i];if(!h.call(t,n)||!ai(e[n],t[n]))return!1}return!0}function li(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ci(e,t){var s,i=li(e);for(e=0;i;){if(3===i.nodeType){if(s=e+i.textContent.length,e<=t&&s>=t)return{node:i,offset:t-e};e=s}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=li(i)}}function di(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?di(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hi(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var s="string"===typeof t.contentWindow.location.href}catch(i){s=!1}if(!s)break;t=Y((e=t.contentWindow).document)}return t}function ui(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pi(e){var t=hi(),s=e.focusedElem,i=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&di(s.ownerDocument.documentElement,s)){if(null!==i&&ui(s))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if((e=(t=s.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var n=s.textContent.length,r=Math.min(i.start,n);i=void 0===i.end?r:Math.min(i.end,n),!e.extend&&r>i&&(n=i,i=r,r=n),n=ci(s,r);var a=ci(s,i);n&&a&&(1!==e.rangeCount||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(n.node,n.offset),e.removeAllRanges(),r>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=s;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<t.length;s++)(e=t[s]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fi=d&&"documentMode"in document&&11>=document.documentMode,mi=null,gi=null,vi=null,bi=!1;function yi(e,t,s){var i=s.window===s?s.document:9===s.nodeType?s:s.ownerDocument;bi||null==mi||mi!==Y(i)||("selectionStart"in(i=mi)&&ui(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&oi(vi,i)||(vi=i,0<(i=Wi(gi,"onSelect")).length&&(t=new cs("onSelect","select",null,t,s),e.push({event:t,listeners:i}),t.target=mi)))}function xi(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var wi={animationend:xi("Animation","AnimationEnd"),animationiteration:xi("Animation","AnimationIteration"),animationstart:xi("Animation","AnimationStart"),transitionend:xi("Transition","TransitionEnd")},_i={},Si={};function ki(e){if(_i[e])return _i[e];if(!wi[e])return e;var t,s=wi[e];for(t in s)if(s.hasOwnProperty(t)&&t in Si)return _i[e]=s[t];return e}d&&(Si=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Ai=ki("animationend"),Ci=ki("animationiteration"),Ei=ki("animationstart"),Ni=ki("transitionend"),ji=new Map,Ti="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mi(e,t){ji.set(e,t),l(t,[e])}for(var Pi=0;Pi<Ti.length;Pi++){var Ri=Ti[Pi];Mi(Ri.toLowerCase(),"on"+(Ri[0].toUpperCase()+Ri.slice(1)))}Mi(Ai,"onAnimationEnd"),Mi(Ci,"onAnimationIteration"),Mi(Ei,"onAnimationStart"),Mi("dblclick","onDoubleClick"),Mi("focusin","onFocus"),Mi("focusout","onBlur"),Mi(Ni,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Di="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ii=new Set("cancel close invalid load scroll toggle".split(" ").concat(Di));function Li(e,t,s){var i=e.type||"unknown-event";e.currentTarget=s,function(e,t,s,i,n,a,o,l,c){if($e.apply(this,arguments),Le){if(!Le)throw Error(r(198));var d=Oe;Le=!1,Oe=null,Fe||(Fe=!0,ze=d)}}(i,t,void 0,e),e.currentTarget=null}function Oi(e,t){t=0!==(4&t);for(var s=0;s<e.length;s++){var i=e[s],n=i.event;i=i.listeners;e:{var r=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==r&&n.isPropagationStopped())break e;Li(n,o,c),r=l}else for(a=0;a<i.length;a++){if(l=(o=i[a]).instance,c=o.currentTarget,o=o.listener,l!==r&&n.isPropagationStopped())break e;Li(n,o,c),r=l}}}if(Fe)throw e=ze,Fe=!1,ze=null,e}function Fi(e,t){var s=t[mn];void 0===s&&(s=t[mn]=new Set);var i=e+"__bubble";s.has(i)||(Hi(t,e,2,!1),s.add(i))}function zi(e,t,s){var i=0;t&&(i|=4),Hi(s,e,i,t)}var Bi="_reactListening"+Math.random().toString(36).slice(2);function $i(e){if(!e[Bi]){e[Bi]=!0,a.forEach((function(t){"selectionchange"!==t&&(Ii.has(t)||zi(t,!1,e),zi(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bi]||(t[Bi]=!0,zi("selectionchange",!1,t))}}function Hi(e,t,s,i){switch(Xt(t)){case 1:var n=Wt;break;case 4:n=qt;break;default:n=Gt}s=n.bind(null,t,s,e),n=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),i?void 0!==n?e.addEventListener(t,s,{capture:!0,passive:n}):e.addEventListener(t,s,!0):void 0!==n?e.addEventListener(t,s,{passive:n}):e.addEventListener(t,s,!1)}function Ui(e,t,s,i,n){var r=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var o=i.stateNode.containerInfo;if(o===n||8===o.nodeType&&o.parentNode===n)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===n||8===l.nodeType&&l.parentNode===n))return;a=a.return}for(;null!==o;){if(null===(a=bn(o)))return;if(5===(l=a.tag)||6===l){i=r=a;continue e}o=o.parentNode}}i=i.return}Me((function(){var i=r,n=we(s),a=[];e:{var o=ji.get(e);if(void 0!==o){var l=cs,c=e;switch(e){case"keypress":if(0===ts(s))break e;case"keydown":case"keyup":l=Cs;break;case"focusin":c="focus",l=ms;break;case"focusout":c="blur",l=ms;break;case"beforeblur":case"afterblur":l=ms;break;case"click":if(2===s.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=ps;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ns;break;case Ai:case Ci:case Ei:l=gs;break;case Ni:l=js;break;case"scroll":l=hs;break;case"wheel":l=Ms;break;case"copy":case"cut":case"paste":l=bs;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Es}var d=0!==(4&t),h=!d&&"scroll"===e,u=d?null!==o?o+"Capture":null:o;d=[];for(var p,f=i;null!==f;){var m=(p=f).stateNode;if(5===p.tag&&null!==m&&(p=m,null!==u&&(null!=(m=Pe(f,u))&&d.push(Vi(f,m,p)))),h)break;f=f.return}0<d.length&&(o=new l(o,c,null,s,n),a.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||s===xe||!(c=s.relatedTarget||s.fromElement)||!bn(c)&&!c[fn])&&(l||o)&&(o=n.window===n?n:(o=n.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=i,null!==(c=(c=s.relatedTarget||s.toElement)?bn(c):null)&&(c!==(h=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(d=ps,m="onMouseLeave",u="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=Es,m="onPointerLeave",u="onPointerEnter",f="pointer"),h=null==l?o:xn(l),p=null==c?o:xn(c),(o=new d(m,f+"leave",l,s,n)).target=h,o.relatedTarget=p,m=null,bn(n)===i&&((d=new d(u,f+"enter",c,s,n)).target=p,d.relatedTarget=h,m=d),h=m,l&&c)e:{for(u=c,f=0,p=d=l;p;p=qi(p))f++;for(p=0,m=u;m;m=qi(m))p++;for(;0<f-p;)d=qi(d),f--;for(;0<p-f;)u=qi(u),p--;for(;f--;){if(d===u||null!==u&&d===u.alternate)break e;d=qi(d),u=qi(u)}d=null}else d=null;null!==l&&Gi(a,o,l,d,!1),null!==c&&null!==h&&Gi(a,h,c,d,!0)}if("select"===(l=(o=i?xn(i):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Ks;else if(Us(o))if(Xs)g=ri;else{g=ii;var v=si}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ni);switch(g&&(g=g(e,i))?Vs(a,g,s,n):(v&&v(e,o,i),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=i?xn(i):window,e){case"focusin":(Us(v)||"true"===v.contentEditable)&&(mi=v,gi=i,vi=null);break;case"focusout":vi=gi=mi=null;break;case"mousedown":bi=!0;break;case"contextmenu":case"mouseup":case"dragend":bi=!1,yi(a,s,n);break;case"selectionchange":if(fi)break;case"keydown":case"keyup":yi(a,s,n)}var b;if(Rs)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else $s?zs(e,s)&&(y="onCompositionEnd"):"keydown"===e&&229===s.keyCode&&(y="onCompositionStart");y&&(Ls&&"ko"!==s.locale&&($s||"onCompositionStart"!==y?"onCompositionEnd"===y&&$s&&(b=es()):(Qt="value"in(Jt=n)?Jt.value:Jt.textContent,$s=!0)),0<(v=Wi(i,y)).length&&(y=new ys(y,e,null,s,n),a.push({event:y,listeners:v}),b?y.data=b:null!==(b=Bs(s))&&(y.data=b))),(b=Is?function(e,t){switch(e){case"compositionend":return Bs(t);case"keypress":return 32!==t.which?null:(Fs=!0,Os);case"textInput":return(e=t.data)===Os&&Fs?null:e;default:return null}}(e,s):function(e,t){if($s)return"compositionend"===e||!Rs&&zs(e,t)?(e=es(),Zt=Qt=Jt=null,$s=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ls&&"ko"!==t.locale?null:t.data}}(e,s))&&(0<(i=Wi(i,"onBeforeInput")).length&&(n=new ys("onBeforeInput","beforeinput",null,s,n),a.push({event:n,listeners:i}),n.data=b))}Oi(a,t)}))}function Vi(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Wi(e,t){for(var s=t+"Capture",i=[];null!==e;){var n=e,r=n.stateNode;5===n.tag&&null!==r&&(n=r,null!=(r=Pe(e,s))&&i.unshift(Vi(e,r,n)),null!=(r=Pe(e,t))&&i.push(Vi(e,r,n))),e=e.return}return i}function qi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gi(e,t,s,i,n){for(var r=t._reactName,a=[];null!==s&&s!==i;){var o=s,l=o.alternate,c=o.stateNode;if(null!==l&&l===i)break;5===o.tag&&null!==c&&(o=c,n?null!=(l=Pe(s,r))&&a.unshift(Vi(s,l,o)):n||null!=(l=Pe(s,r))&&a.push(Vi(s,l,o))),s=s.return}0!==a.length&&e.push({event:t,listeners:a})}var Yi=/\r\n?/g,Ki=/\u0000|\uFFFD/g;function Xi(e){return("string"===typeof e?e:""+e).replace(Yi,"\n").replace(Ki,"")}function Ji(e,t,s){if(t=Xi(t),Xi(e)!==t&&s)throw Error(r(425))}function Qi(){}var Zi=null,en=null;function tn(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var sn="function"===typeof setTimeout?setTimeout:void 0,nn="function"===typeof clearTimeout?clearTimeout:void 0,rn="function"===typeof Promise?Promise:void 0,an="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rn?function(e){return rn.resolve(null).then(e).catch(on)}:sn;function on(e){setTimeout((function(){throw e}))}function ln(e,t){var s=t,i=0;do{var n=s.nextSibling;if(e.removeChild(s),n&&8===n.nodeType)if("/$"===(s=n.data)){if(0===i)return e.removeChild(n),void Ht(t);i--}else"$"!==s&&"$?"!==s&&"$!"!==s||i++;s=n}while(s);Ht(t)}function cn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var s=e.data;if("$"===s||"$!"===s||"$?"===s){if(0===t)return e;t--}else"/$"===s&&t++}e=e.previousSibling}return null}var hn=Math.random().toString(36).slice(2),un="__reactFiber$"+hn,pn="__reactProps$"+hn,fn="__reactContainer$"+hn,mn="__reactEvents$"+hn,gn="__reactListeners$"+hn,vn="__reactHandles$"+hn;function bn(e){var t=e[un];if(t)return t;for(var s=e.parentNode;s;){if(t=s[fn]||s[un]){if(s=t.alternate,null!==t.child||null!==s&&null!==s.child)for(e=dn(e);null!==e;){if(s=e[un])return s;e=dn(e)}return t}s=(e=s).parentNode}return null}function yn(e){return!(e=e[un]||e[fn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function wn(e){return e[pn]||null}var _n=[],Sn=-1;function kn(e){return{current:e}}function An(e){0>Sn||(e.current=_n[Sn],_n[Sn]=null,Sn--)}function Cn(e,t){Sn++,_n[Sn]=e.current,e.current=t}var En={},Nn=kn(En),jn=kn(!1),Tn=En;function Mn(e,t){var s=e.type.contextTypes;if(!s)return En;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n,r={};for(n in s)r[n]=t[n];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Pn(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Rn(){An(jn),An(Nn)}function Dn(e,t,s){if(Nn.current!==En)throw Error(r(168));Cn(Nn,t),Cn(jn,s)}function In(e,t,s){var i=e.stateNode;if(t=t.childContextTypes,"function"!==typeof i.getChildContext)return s;for(var n in i=i.getChildContext())if(!(n in t))throw Error(r(108,U(e)||"Unknown",n));return O({},s,i)}function Ln(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||En,Tn=Nn.current,Cn(Nn,e),Cn(jn,jn.current),!0}function On(e,t,s){var i=e.stateNode;if(!i)throw Error(r(169));s?(e=In(e,t,Tn),i.__reactInternalMemoizedMergedChildContext=e,An(jn),An(Nn),Cn(Nn,e)):An(jn),Cn(jn,s)}var Fn=null,zn=!1,Bn=!1;function $n(e){null===Fn?Fn=[e]:Fn.push(e)}function Hn(){if(!Bn&&null!==Fn){Bn=!0;var e=0,t=yt;try{var s=Fn;for(yt=1;e<s.length;e++){var i=s[e];do{i=i(!0)}while(null!==i)}Fn=null,zn=!1}catch(n){throw null!==Fn&&(Fn=Fn.slice(e+1)),Ge(Ze,Hn),n}finally{yt=t,Bn=!1}}return null}var Un=[],Vn=0,Wn=null,qn=0,Gn=[],Yn=0,Kn=null,Xn=1,Jn="";function Qn(e,t){Un[Vn++]=qn,Un[Vn++]=Wn,Wn=e,qn=t}function Zn(e,t,s){Gn[Yn++]=Xn,Gn[Yn++]=Jn,Gn[Yn++]=Kn,Kn=e;var i=Xn;e=Jn;var n=32-at(i)-1;i&=~(1<<n),s+=1;var r=32-at(t)+n;if(30<r){var a=n-n%5;r=(i&(1<<a)-1).toString(32),i>>=a,n-=a,Xn=1<<32-at(t)+n|s<<n|i,Jn=r+e}else Xn=1<<r|s<<n|i,Jn=e}function er(e){null!==e.return&&(Qn(e,1),Zn(e,1,0))}function tr(e){for(;e===Wn;)Wn=Un[--Vn],Un[Vn]=null,qn=Un[--Vn],Un[Vn]=null;for(;e===Kn;)Kn=Gn[--Yn],Gn[Yn]=null,Jn=Gn[--Yn],Gn[Yn]=null,Xn=Gn[--Yn],Gn[Yn]=null}var sr=null,ir=null,nr=!1,rr=null;function ar(e,t){var s=Mc(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,null===(t=e.deletions)?(e.deletions=[s],e.flags|=16):t.push(s)}function or(e,t){switch(e.tag){case 5:var s=e.type;return null!==(t=1!==t.nodeType||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,sr=e,ir=cn(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,sr=e,ir=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(s=null!==Kn?{id:Xn,overflow:Jn}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},(s=Mc(18,null,null,0)).stateNode=t,s.return=e,e.child=s,sr=e,ir=null,!0);default:return!1}}function lr(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(nr){var t=ir;if(t){var s=t;if(!or(e,t)){if(lr(e))throw Error(r(418));t=cn(s.nextSibling);var i=sr;t&&or(e,t)?ar(i,s):(e.flags=-4097&e.flags|2,nr=!1,sr=e)}}else{if(lr(e))throw Error(r(418));e.flags=-4097&e.flags|2,nr=!1,sr=e}}}function dr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;sr=e}function hr(e){if(e!==sr)return!1;if(!nr)return dr(e),nr=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!tn(e.type,e.memoizedProps)),t&&(t=ir)){if(lr(e))throw ur(),Error(r(418));for(;t;)ar(e,t),t=cn(t.nextSibling)}if(dr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var s=e.data;if("/$"===s){if(0===t){ir=cn(e.nextSibling);break e}t--}else"$"!==s&&"$!"!==s&&"$?"!==s||t++}e=e.nextSibling}ir=null}}else ir=sr?cn(e.stateNode.nextSibling):null;return!0}function ur(){for(var e=ir;e;)e=cn(e.nextSibling)}function pr(){ir=sr=null,nr=!1}function fr(e){null===rr?rr=[e]:rr.push(e)}var mr=x.ReactCurrentBatchConfig;function gr(e,t,s){if(null!==(e=s.ref)&&"function"!==typeof e&&"object"!==typeof e){if(s._owner){if(s=s._owner){if(1!==s.tag)throw Error(r(309));var i=s.stateNode}if(!i)throw Error(r(147,e));var n=i,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=n.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(r(284));if(!s._owner)throw Error(r(290,e))}return e}function vr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function br(e){return(0,e._init)(e._payload)}function yr(e){function t(t,s){if(e){var i=t.deletions;null===i?(t.deletions=[s],t.flags|=16):i.push(s)}}function s(s,i){if(!e)return null;for(;null!==i;)t(s,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function a(t,s,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<s?(t.flags|=2,s):i:(t.flags|=2,s):(t.flags|=1048576,s)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,s,i){return null===t||6!==t.tag?((t=Oc(s,e.mode,i)).return=e,t):((t=n(t,s)).return=e,t)}function c(e,t,s,i){var r=s.type;return r===S?h(e,t,s.props.children,i,s.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===P&&br(r)===t.type)?((i=n(t,s.props)).ref=gr(e,t,s),i.return=e,i):((i=Dc(s.type,s.key,s.props,null,e.mode,i)).ref=gr(e,t,s),i.return=e,i)}function d(e,t,s,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==s.containerInfo||t.stateNode.implementation!==s.implementation?((t=Fc(s,e.mode,i)).return=e,t):((t=n(t,s.children||[])).return=e,t)}function h(e,t,s,i,r){return null===t||7!==t.tag?((t=Ic(s,e.mode,i,r)).return=e,t):((t=n(t,s)).return=e,t)}function u(e,t,s){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Oc(""+t,e.mode,s)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(s=Dc(t.type,t.key,t.props,null,e.mode,s)).ref=gr(e,null,t),s.return=e,s;case _:return(t=Fc(t,e.mode,s)).return=e,t;case P:return u(e,(0,t._init)(t._payload),s)}if(te(t)||I(t))return(t=Ic(t,e.mode,s,null)).return=e,t;vr(e,t)}return null}function p(e,t,s,i){var n=null!==t?t.key:null;if("string"===typeof s&&""!==s||"number"===typeof s)return null!==n?null:l(e,t,""+s,i);if("object"===typeof s&&null!==s){switch(s.$$typeof){case w:return s.key===n?c(e,t,s,i):null;case _:return s.key===n?d(e,t,s,i):null;case P:return p(e,t,(n=s._init)(s._payload),i)}if(te(s)||I(s))return null!==n?null:h(e,t,s,i,null);vr(e,s)}return null}function f(e,t,s,i,n){if("string"===typeof i&&""!==i||"number"===typeof i)return l(t,e=e.get(s)||null,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return c(t,e=e.get(null===i.key?s:i.key)||null,i,n);case _:return d(t,e=e.get(null===i.key?s:i.key)||null,i,n);case P:return f(e,t,s,(0,i._init)(i._payload),n)}if(te(i)||I(i))return h(t,e=e.get(s)||null,i,n,null);vr(t,i)}return null}function m(n,r,o,l){for(var c=null,d=null,h=r,m=r=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=p(n,h,o[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(n,h),r=a(v,r,m),null===d?c=v:d.sibling=v,d=v,h=g}if(m===o.length)return s(n,h),nr&&Qn(n,m),c;if(null===h){for(;m<o.length;m++)null!==(h=u(n,o[m],l))&&(r=a(h,r,m),null===d?c=h:d.sibling=h,d=h);return nr&&Qn(n,m),c}for(h=i(n,h);m<o.length;m++)null!==(g=f(h,n,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),r=a(g,r,m),null===d?c=g:d.sibling=g,d=g);return e&&h.forEach((function(e){return t(n,e)})),nr&&Qn(n,m),c}function g(n,o,l,c){var d=I(l);if("function"!==typeof d)throw Error(r(150));if(null==(l=d.call(l)))throw Error(r(151));for(var h=d=null,m=o,g=o=0,v=null,b=l.next();null!==m&&!b.done;g++,b=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var y=p(n,m,b.value,c);if(null===y){null===m&&(m=v);break}e&&m&&null===y.alternate&&t(n,m),o=a(y,o,g),null===h?d=y:h.sibling=y,h=y,m=v}if(b.done)return s(n,m),nr&&Qn(n,g),d;if(null===m){for(;!b.done;g++,b=l.next())null!==(b=u(n,b.value,c))&&(o=a(b,o,g),null===h?d=b:h.sibling=b,h=b);return nr&&Qn(n,g),d}for(m=i(n,m);!b.done;g++,b=l.next())null!==(b=f(m,n,g,b.value,c))&&(e&&null!==b.alternate&&m.delete(null===b.key?g:b.key),o=a(b,o,g),null===h?d=b:h.sibling=b,h=b);return e&&m.forEach((function(e){return t(n,e)})),nr&&Qn(n,g),d}return function e(i,r,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,d=r;null!==d;){if(d.key===c){if((c=a.type)===S){if(7===d.tag){s(i,d.sibling),(r=n(d,a.props.children)).return=i,i=r;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&br(c)===d.type){s(i,d.sibling),(r=n(d,a.props)).ref=gr(i,d,a),r.return=i,i=r;break e}s(i,d);break}t(i,d),d=d.sibling}a.type===S?((r=Ic(a.props.children,i.mode,l,a.key)).return=i,i=r):((l=Dc(a.type,a.key,a.props,null,i.mode,l)).ref=gr(i,r,a),l.return=i,i=l)}return o(i);case _:e:{for(d=a.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===a.containerInfo&&r.stateNode.implementation===a.implementation){s(i,r.sibling),(r=n(r,a.children||[])).return=i,i=r;break e}s(i,r);break}t(i,r),r=r.sibling}(r=Fc(a,i.mode,l)).return=i,i=r}return o(i);case P:return e(i,r,(d=a._init)(a._payload),l)}if(te(a))return m(i,r,a,l);if(I(a))return g(i,r,a,l);vr(i,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==r&&6===r.tag?(s(i,r.sibling),(r=n(r,a)).return=i,i=r):(s(i,r),(r=Oc(a,i.mode,l)).return=i,i=r),o(i)):s(i,r)}}var xr=yr(!0),wr=yr(!1),_r=kn(null),Sr=null,kr=null,Ar=null;function Cr(){Ar=kr=Sr=null}function Er(e){var t=_r.current;An(_r),e._currentValue=t}function Nr(e,t,s){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===s)break;e=e.return}}function jr(e,t){Sr=e,Ar=kr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yo=!0),e.firstContext=null)}function Tr(e){var t=e._currentValue;if(Ar!==e)if(e={context:e,memoizedValue:t,next:null},null===kr){if(null===Sr)throw Error(r(308));kr=e,Sr.dependencies={lanes:0,firstContext:e}}else kr=kr.next=e;return t}var Mr=null;function Pr(e){null===Mr?Mr=[e]:Mr.push(e)}function Rr(e,t,s,i){var n=t.interleaved;return null===n?(s.next=s,Pr(t)):(s.next=n.next,n.next=s),t.interleaved=s,Dr(e,i)}function Dr(e,t){e.lanes|=t;var s=e.alternate;for(null!==s&&(s.lanes|=t),s=e,e=e.return;null!==e;)e.childLanes|=t,null!==(s=e.alternate)&&(s.childLanes|=t),s=e,e=e.return;return 3===s.tag?s.stateNode:null}var Ir=!1;function Lr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Or(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zr(e,t,s){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&Nl)){var n=i.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),i.pending=t,Dr(e,s)}return null===(n=i.interleaved)?(t.next=t,Pr(i)):(t.next=n.next,n.next=t),i.interleaved=t,Dr(e,s)}function Br(e,t,s){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&s))){var i=t.lanes;s|=i&=e.pendingLanes,t.lanes=s,bt(e,s)}}function $r(e,t){var s=e.updateQueue,i=e.alternate;if(null!==i&&s===(i=i.updateQueue)){var n=null,r=null;if(null!==(s=s.firstBaseUpdate)){do{var a={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};null===r?n=r=a:r=r.next=a,s=s.next}while(null!==s);null===r?n=r=t:r=r.next=t}else n=r=t;return s={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:i.shared,effects:i.effects},void(e.updateQueue=s)}null===(e=s.lastBaseUpdate)?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Hr(e,t,s,i){var n=e.updateQueue;Ir=!1;var r=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(null!==o){n.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?r=c:a.next=c,a=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==a&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==r){var h=n.baseState;for(a=0,d=c=l=null,o=r;;){var u=o.lane,p=o.eventTime;if((i&u)===u){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,m=o;switch(u=t,p=s,m.tag){case 1:if("function"===typeof(f=m.payload)){h=f.call(p,h,u);break e}h=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(u="function"===typeof(f=m.payload)?f.call(p,h,u):f)||void 0===u)break e;h=O({},h,u);break e;case 2:Ir=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(u=n.effects)?n.effects=[o]:u.push(o))}else p={eventTime:p,lane:u,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=h):d=d.next=p,a|=u;if(null===(o=o.next)){if(null===(o=n.shared.pending))break;o=(u=o).next,u.next=null,n.lastBaseUpdate=u,n.shared.pending=null}}if(null===d&&(l=h),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=d,null!==(t=n.shared.interleaved)){n=t;do{a|=n.lane,n=n.next}while(n!==t)}else null===r&&(n.shared.lanes=0);Ll|=a,e.lanes=a,e.memoizedState=h}}function Ur(e,t,s){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(null!==n){if(i.callback=null,i=s,"function"!==typeof n)throw Error(r(191,n));n.call(i)}}}var Vr={},Wr=kn(Vr),qr=kn(Vr),Gr=kn(Vr);function Yr(e){if(e===Vr)throw Error(r(174));return e}function Kr(e,t){switch(Cn(Gr,t),Cn(qr,e),Cn(Wr,Vr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}An(Wr),Cn(Wr,t)}function Xr(){An(Wr),An(qr),An(Gr)}function Jr(e){Yr(Gr.current);var t=Yr(Wr.current),s=le(t,e.type);t!==s&&(Cn(qr,e),Cn(Wr,s))}function Qr(e){qr.current===e&&(An(Wr),An(qr))}var Zr=kn(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var s=t.memoizedState;if(null!==s&&(null===(s=s.dehydrated)||"$?"===s.data||"$!"===s.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function sa(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ia=x.ReactCurrentDispatcher,na=x.ReactCurrentBatchConfig,ra=0,aa=null,oa=null,la=null,ca=!1,da=!1,ha=0,ua=0;function pa(){throw Error(r(321))}function fa(e,t){if(null===t)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!ai(e[s],t[s]))return!1;return!0}function ma(e,t,s,i,n,a){if(ra=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Qa:Za,e=s(i,n),da){a=0;do{if(da=!1,ha=0,25<=a)throw Error(r(301));a+=1,la=oa=null,t.updateQueue=null,ia.current=eo,e=s(i,n)}while(da)}if(ia.current=Ja,t=null!==oa&&null!==oa.next,ra=0,la=oa=aa=null,ca=!1,t)throw Error(r(300));return e}function ga(){var e=0!==ha;return ha=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function ba(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(r(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function ya(e,t){return"function"===typeof t?t(e):t}function xa(e){var t=ba(),s=t.queue;if(null===s)throw Error(r(311));s.lastRenderedReducer=e;var i=oa,n=i.baseQueue,a=s.pending;if(null!==a){if(null!==n){var o=n.next;n.next=a.next,a.next=o}i.baseQueue=n=a,s.pending=null}if(null!==n){a=n.next,i=i.baseState;var l=o=null,c=null,d=a;do{var h=d.lane;if((ra&h)===h)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:e(i,d.action);else{var u={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=u,o=i):c=c.next=u,aa.lanes|=h,Ll|=h}d=d.next}while(null!==d&&d!==a);null===c?o=i:c.next=l,ai(i,t.memoizedState)||(yo=!0),t.memoizedState=i,t.baseState=o,t.baseQueue=c,s.lastRenderedState=i}if(null!==(e=s.interleaved)){n=e;do{a=n.lane,aa.lanes|=a,Ll|=a,n=n.next}while(n!==e)}else null===n&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function wa(e){var t=ba(),s=t.queue;if(null===s)throw Error(r(311));s.lastRenderedReducer=e;var i=s.dispatch,n=s.pending,a=t.memoizedState;if(null!==n){s.pending=null;var o=n=n.next;do{a=e(a,o.action),o=o.next}while(o!==n);ai(a,t.memoizedState)||(yo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),s.lastRenderedState=a}return[a,i]}function _a(){}function Sa(e,t){var s=aa,i=ba(),n=t(),a=!ai(i.memoizedState,n);if(a&&(i.memoizedState=n,yo=!0),i=i.queue,Ia(Ca.bind(null,s,i,e),[e]),i.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(s.flags|=2048,Ta(9,Aa.bind(null,s,i,n,t),void 0,null),null===jl)throw Error(r(349));0!==(30&ra)||ka(s,t,n)}return n}function ka(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(s=t.stores)?t.stores=[e]:s.push(e)}function Aa(e,t,s,i){t.value=s,t.getSnapshot=i,Ea(t)&&Na(e)}function Ca(e,t,s){return s((function(){Ea(t)&&Na(e)}))}function Ea(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!ai(e,s)}catch(i){return!0}}function Na(e){var t=Dr(e,1);null!==t&&sc(t,e,1,-1)}function ja(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:e},t.queue=e,e=e.dispatch=Ga.bind(null,aa,e),[t.memoizedState,e]}function Ta(e,t,s,i){return e={tag:e,create:t,destroy:s,deps:i,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(s=t.lastEffect)?t.lastEffect=e.next=e:(i=s.next,s.next=e,e.next=i,t.lastEffect=e),e}function Ma(){return ba().memoizedState}function Pa(e,t,s,i){var n=va();aa.flags|=e,n.memoizedState=Ta(1|t,s,void 0,void 0===i?null:i)}function Ra(e,t,s,i){var n=ba();i=void 0===i?null:i;var r=void 0;if(null!==oa){var a=oa.memoizedState;if(r=a.destroy,null!==i&&fa(i,a.deps))return void(n.memoizedState=Ta(t,s,r,i))}aa.flags|=e,n.memoizedState=Ta(1|t,s,r,i)}function Da(e,t){return Pa(8390656,8,e,t)}function Ia(e,t){return Ra(2048,8,e,t)}function La(e,t){return Ra(4,2,e,t)}function Oa(e,t){return Ra(4,4,e,t)}function Fa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function za(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Ra(4,4,Fa.bind(null,t,e),s)}function Ba(){}function $a(e,t){var s=ba();t=void 0===t?null:t;var i=s.memoizedState;return null!==i&&null!==t&&fa(t,i[1])?i[0]:(s.memoizedState=[e,t],e)}function Ha(e,t){var s=ba();t=void 0===t?null:t;var i=s.memoizedState;return null!==i&&null!==t&&fa(t,i[1])?i[0]:(e=e(),s.memoizedState=[e,t],e)}function Ua(e,t,s){return 0===(21&ra)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=s):(ai(s,t)||(s=mt(),aa.lanes|=s,Ll|=s,e.baseState=!0),t)}function Va(e,t){var s=yt;yt=0!==s&&4>s?s:4,e(!0);var i=na.transition;na.transition={};try{e(!1),t()}finally{yt=s,na.transition=i}}function Wa(){return ba().memoizedState}function qa(e,t,s){var i=tc(e);if(s={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null},Ya(e))Ka(t,s);else if(null!==(s=Rr(e,t,s,i))){sc(s,e,i,ec()),Xa(s,t,i)}}function Ga(e,t,s){var i=tc(e),n={lane:i,action:s,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Ka(t,n);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=r(a,s);if(n.hasEagerState=!0,n.eagerState=o,ai(o,a)){var l=t.interleaved;return null===l?(n.next=n,Pr(t)):(n.next=l.next,l.next=n),void(t.interleaved=n)}}catch(c){}null!==(s=Rr(e,t,n,i))&&(sc(s,e,i,n=ec()),Xa(s,t,i))}}function Ya(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Ka(e,t){da=ca=!0;var s=e.pending;null===s?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Xa(e,t,s){if(0!==(4194240&s)){var i=t.lanes;s|=i&=e.pendingLanes,t.lanes=s,bt(e,s)}}var Ja={readContext:Tr,useCallback:pa,useContext:pa,useEffect:pa,useImperativeHandle:pa,useInsertionEffect:pa,useLayoutEffect:pa,useMemo:pa,useReducer:pa,useRef:pa,useState:pa,useDebugValue:pa,useDeferredValue:pa,useTransition:pa,useMutableSource:pa,useSyncExternalStore:pa,useId:pa,unstable_isNewReconciler:!1},Qa={readContext:Tr,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:Tr,useEffect:Da,useImperativeHandle:function(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Pa(4194308,4,Fa.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pa(4,2,e,t)},useMemo:function(e,t){var s=va();return t=void 0===t?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var i=va();return t=void 0!==s?s(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=qa.bind(null,aa,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:ja,useDebugValue:Ba,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=ja(!1),t=e[0];return e=Va.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var i=aa,n=va();if(nr){if(void 0===s)throw Error(r(407));s=s()}else{if(s=t(),null===jl)throw Error(r(349));0!==(30&ra)||ka(i,t,s)}n.memoizedState=s;var a={value:s,getSnapshot:t};return n.queue=a,Da(Ca.bind(null,i,a,e),[e]),i.flags|=2048,Ta(9,Aa.bind(null,i,a,s,t),void 0,null),s},useId:function(){var e=va(),t=jl.identifierPrefix;if(nr){var s=Jn;t=":"+t+"R"+(s=(Xn&~(1<<32-at(Xn)-1)).toString(32)+s),0<(s=ha++)&&(t+="H"+s.toString(32)),t+=":"}else t=":"+t+"r"+(s=ua++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Za={readContext:Tr,useCallback:$a,useContext:Tr,useEffect:Ia,useImperativeHandle:za,useInsertionEffect:La,useLayoutEffect:Oa,useMemo:Ha,useReducer:xa,useRef:Ma,useState:function(){return xa(ya)},useDebugValue:Ba,useDeferredValue:function(e){return Ua(ba(),oa.memoizedState,e)},useTransition:function(){return[xa(ya)[0],ba().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Wa,unstable_isNewReconciler:!1},eo={readContext:Tr,useCallback:$a,useContext:Tr,useEffect:Ia,useImperativeHandle:za,useInsertionEffect:La,useLayoutEffect:Oa,useMemo:Ha,useReducer:wa,useRef:Ma,useState:function(){return wa(ya)},useDebugValue:Ba,useDeferredValue:function(e){var t=ba();return null===oa?t.memoizedState=e:Ua(t,oa.memoizedState,e)},useTransition:function(){return[wa(ya)[0],ba().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Wa,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var s in t=O({},t),e=e.defaultProps)void 0===t[s]&&(t[s]=e[s]);return t}return t}function so(e,t,s,i){s=null===(s=s(i,t=e.memoizedState))||void 0===s?t:O({},t,s),e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,s){e=e._reactInternals;var i=ec(),n=tc(e),r=Fr(i,n);r.payload=t,void 0!==s&&null!==s&&(r.callback=s),null!==(t=zr(e,r,n))&&(sc(t,e,n,i),Br(t,e,n))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var i=ec(),n=tc(e),r=Fr(i,n);r.tag=1,r.payload=t,void 0!==s&&null!==s&&(r.callback=s),null!==(t=zr(e,r,n))&&(sc(t,e,n,i),Br(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=ec(),i=tc(e),n=Fr(s,i);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=zr(e,n,i))&&(sc(t,e,i,s),Br(t,e,i))}};function no(e,t,s,i,n,r,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,r,a):!t.prototype||!t.prototype.isPureReactComponent||(!oi(s,i)||!oi(n,r))}function ro(e,t,s){var i=!1,n=En,r=t.contextType;return"object"===typeof r&&null!==r?r=Tr(r):(n=Pn(t)?Tn:Nn.current,r=(i=null!==(i=t.contextTypes)&&void 0!==i)?Mn(e,n):En),t=new t(s,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=r),t}function ao(e,t,s,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(s,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(s,i),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function oo(e,t,s,i){var n=e.stateNode;n.props=s,n.state=e.memoizedState,n.refs={},Lr(e);var r=t.contextType;"object"===typeof r&&null!==r?n.context=Tr(r):(r=Pn(t)?Tn:Nn.current,n.context=Mn(e,r)),n.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(so(e,t,r,s),n.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(t=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&io.enqueueReplaceState(n,n.state,null),Hr(e,s,n,i),n.state=e.memoizedState),"function"===typeof n.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var s="",i=t;do{s+=$(i),i=i.return}while(i);var n=s}catch(r){n="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:n,digest:null}}function co(e,t,s){return{value:e,source:null,stack:null!=s?s:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(s){setTimeout((function(){throw s}))}}var uo="function"===typeof WeakMap?WeakMap:Map;function po(e,t,s){(s=Fr(-1,s)).tag=3,s.payload={element:null};var i=t.value;return s.callback=function(){Vl||(Vl=!0,Wl=i),ho(0,t)},s}function fo(e,t,s){(s=Fr(-1,s)).tag=3;var i=e.type.getDerivedStateFromError;if("function"===typeof i){var n=t.value;s.payload=function(){return i(n)},s.callback=function(){ho(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(s.callback=function(){ho(0,t),"function"!==typeof i&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),s}function mo(e,t,s){var i=e.pingCache;if(null===i){i=e.pingCache=new uo;var n=new Set;i.set(t,n)}else void 0===(n=i.get(t))&&(n=new Set,i.set(t,n));n.has(s)||(n.add(s),e=Ac.bind(null,e,t,s),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,s,i,n){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,1===s.tag&&(null===s.alternate?s.tag=17:((t=Fr(-1,1)).tag=2,zr(s,t,1))),s.lanes|=1),e):(e.flags|=65536,e.lanes=n,e)}var bo=x.ReactCurrentOwner,yo=!1;function xo(e,t,s,i){t.child=null===e?wr(t,null,s,i):xr(t,e.child,s,i)}function wo(e,t,s,i,n){s=s.render;var r=t.ref;return jr(t,n),i=ma(e,t,s,i,r,n),s=ga(),null===e||yo?(nr&&s&&er(t),t.flags|=1,xo(e,t,i,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Vo(e,t,n))}function _o(e,t,s,i,n){if(null===e){var r=s.type;return"function"!==typeof r||Pc(r)||void 0!==r.defaultProps||null!==s.compare||void 0!==s.defaultProps?((e=Dc(s.type,null,i,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,So(e,t,r,i,n))}if(r=e.child,0===(e.lanes&n)){var a=r.memoizedProps;if((s=null!==(s=s.compare)?s:oi)(a,i)&&e.ref===t.ref)return Vo(e,t,n)}return t.flags|=1,(e=Rc(r,i)).ref=t.ref,e.return=t,t.child=e}function So(e,t,s,i,n){if(null!==e){var r=e.memoizedProps;if(oi(r,i)&&e.ref===t.ref){if(yo=!1,t.pendingProps=i=r,0===(e.lanes&n))return t.lanes=e.lanes,Vo(e,t,n);0!==(131072&e.flags)&&(yo=!0)}}return Co(e,t,s,i,n)}function ko(e,t,s){var i=t.pendingProps,n=i.children,r=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cn(Rl,Pl),Pl|=s;else{if(0===(1073741824&s))return e=null!==r?r.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cn(Rl,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==r?r.baseLanes:s,Cn(Rl,Pl),Pl|=i}else null!==r?(i=r.baseLanes|s,t.memoizedState=null):i=s,Cn(Rl,Pl),Pl|=i;return xo(e,t,n,s),t.child}function Ao(e,t){var s=t.ref;(null===e&&null!==s||null!==e&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function Co(e,t,s,i,n){var r=Pn(s)?Tn:Nn.current;return r=Mn(t,r),jr(t,n),s=ma(e,t,s,i,r,n),i=ga(),null===e||yo?(nr&&i&&er(t),t.flags|=1,xo(e,t,s,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Vo(e,t,n))}function Eo(e,t,s,i,n){if(Pn(s)){var r=!0;Ln(t)}else r=!1;if(jr(t,n),null===t.stateNode)Uo(e,t),ro(t,s,i),oo(t,s,i,n),i=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=s.contextType;"object"===typeof c&&null!==c?c=Tr(c):c=Mn(t,c=Pn(s)?Tn:Nn.current);var d=s.getDerivedStateFromProps,h="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==i||l!==c)&&ao(t,a,i,c),Ir=!1;var u=t.memoizedState;a.state=u,Hr(t,i,a,n),l=t.memoizedState,o!==i||u!==l||jn.current||Ir?("function"===typeof d&&(so(t,s,d,i),l=t.memoizedState),(o=Ir||no(t,s,o,i,u,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,Or(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),a.props=c,h=t.pendingProps,u=a.context,"object"===typeof(l=s.contextType)&&null!==l?l=Tr(l):l=Mn(t,l=Pn(s)?Tn:Nn.current);var p=s.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==h||u!==l)&&ao(t,a,i,l),Ir=!1,u=t.memoizedState,a.state=u,Hr(t,i,a,n);var f=t.memoizedState;o!==h||u!==f||jn.current||Ir?("function"===typeof p&&(so(t,s,p,i),f=t.memoizedState),(c=Ir||no(t,s,c,i,u,f,l)||!1)?(d||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(i,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(i,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=f),a.props=i,a.state=f,a.context=l,i=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),i=!1)}return No(e,t,s,i,r,n)}function No(e,t,s,i,n,r){Ao(e,t);var a=0!==(128&t.flags);if(!i&&!a)return n&&On(t,s,!1),Vo(e,t,r);i=t.stateNode,bo.current=t;var o=a&&"function"!==typeof s.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&a?(t.child=xr(t,e.child,null,r),t.child=xr(t,null,o,r)):xo(e,t,o,r),t.memoizedState=i.state,n&&On(t,s,!0),t.child}function jo(e){var t=e.stateNode;t.pendingContext?Dn(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Dn(0,t.context,!1),Kr(e,t.containerInfo)}function To(e,t,s,i,n){return pr(),fr(n),t.flags|=256,xo(e,t,s,i),t.child}var Mo,Po,Ro,Do,Io={dehydrated:null,treeContext:null,retryLane:0};function Lo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Oo(e,t,s){var i,n=t.pendingProps,a=Zr.current,o=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&a)),i?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Cn(Zr,1&a),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=n.children,e=n.fallback,o?(n=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&n)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Lc(l,n,0,null),e=Ic(e,n,s,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Lo(s),t.memoizedState=Io,e):Fo(t,l));if(null!==(a=e.memoizedState)&&null!==(i=a.dehydrated))return function(e,t,s,i,n,a,o){if(s)return 256&t.flags?(t.flags&=-257,zo(e,t,o,i=co(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=i.fallback,n=t.mode,i=Lc({mode:"visible",children:i.children},n,0,null),(a=Ic(a,n,o,null)).flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,0!==(1&t.mode)&&xr(t,e.child,null,o),t.child.memoizedState=Lo(o),t.memoizedState=Io,a);if(0===(1&t.mode))return zo(e,t,o,null);if("$!"===n.data){if(i=n.nextSibling&&n.nextSibling.dataset)var l=i.dgst;return i=l,zo(e,t,o,i=co(a=Error(r(419)),i,void 0))}if(l=0!==(o&e.childLanes),yo||l){if(null!==(i=jl)){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!==(n&(i.suspendedLanes|o))?0:n)&&n!==a.retryLane&&(a.retryLane=n,Dr(e,n),sc(i,e,n,-1))}return mc(),zo(e,t,o,i=co(Error(r(421))))}return"$?"===n.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),n._reactRetry=t,null):(e=a.treeContext,ir=cn(n.nextSibling),sr=t,nr=!0,rr=null,null!==e&&(Gn[Yn++]=Xn,Gn[Yn++]=Jn,Gn[Yn++]=Kn,Xn=e.id,Jn=e.overflow,Kn=t),t=Fo(t,i.children),t.flags|=4096,t)}(e,t,l,n,i,a,s);if(o){o=n.fallback,l=t.mode,i=(a=e.child).sibling;var c={mode:"hidden",children:n.children};return 0===(1&l)&&t.child!==a?((n=t.child).childLanes=0,n.pendingProps=c,t.deletions=null):(n=Rc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==i?o=Rc(i,o):(o=Ic(o,l,s,null)).flags|=2,o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,l=null===(l=e.child.memoizedState)?Lo(s):{baseLanes:l.baseLanes|s,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~s,t.memoizedState=Io,n}return e=(o=e.child).sibling,n=Rc(o,{mode:"visible",children:n.children}),0===(1&t.mode)&&(n.lanes=s),n.return=t,n.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n}function Fo(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zo(e,t,s,i){return null!==i&&fr(i),xr(t,e.child,null,s),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bo(e,t,s){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Nr(e.return,t,s)}function $o(e,t,s,i,n){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:s,tailMode:n}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=s,r.tailMode=n)}function Ho(e,t,s){var i=t.pendingProps,n=i.revealOrder,r=i.tail;if(xo(e,t,i.children,s),0!==(2&(i=Zr.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bo(e,s,t);else if(19===e.tag)Bo(e,s,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Cn(Zr,i),0===(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(s=t.child,n=null;null!==s;)null!==(e=s.alternate)&&null===ea(e)&&(n=s),s=s.sibling;null===(s=n)?(n=t.child,t.child=null):(n=s.sibling,s.sibling=null),$o(t,!1,n,s,r);break;case"backwards":for(s=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===ea(e)){t.child=n;break}e=n.sibling,n.sibling=s,s=n,n=e}$o(t,!0,s,null,r);break;case"together":$o(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Uo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vo(e,t,s){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(s&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(s=Rc(e=t.child,e.pendingProps),t.child=s,s.return=t;null!==e.sibling;)e=e.sibling,(s=s.sibling=Rc(e,e.pendingProps)).return=t;s.sibling=null}return t.child}function Wo(e,t){if(!nr)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;null!==t;)null!==t.alternate&&(s=t),t=t.sibling;null===s?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var i=null;null!==s;)null!==s.alternate&&(i=s),s=s.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,s=0,i=0;if(t)for(var n=e.child;null!==n;)s|=n.lanes|n.childLanes,i|=14680064&n.subtreeFlags,i|=14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)s|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=i,e.childLanes=s,t}function Go(e,t,s){var i=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Pn(t.type)&&Rn(),qo(t),null;case 3:return i=t.stateNode,Xr(),An(jn),An(Nn),sa(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(hr(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(ac(rr),rr=null))),Po(e,t),qo(t),null;case 5:Qr(t);var n=Yr(Gr.current);if(s=t.type,null!==e&&null!=t.stateNode)Ro(e,t,s,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(r(166));return qo(t),null}if(e=Yr(Wr.current),hr(t)){i=t.stateNode,s=t.type;var a=t.memoizedProps;switch(i[un]=t,i[pn]=a,e=0!==(1&t.mode),s){case"dialog":Fi("cancel",i),Fi("close",i);break;case"iframe":case"object":case"embed":Fi("load",i);break;case"video":case"audio":for(n=0;n<Di.length;n++)Fi(Di[n],i);break;case"source":Fi("error",i);break;case"img":case"image":case"link":Fi("error",i),Fi("load",i);break;case"details":Fi("toggle",i);break;case"input":X(i,a),Fi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Fi("invalid",i);break;case"textarea":ne(i,a),Fi("invalid",i)}for(var l in be(s,a),n=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?i.textContent!==c&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,c,e),n=["children",c]):"number"===typeof c&&i.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Ji(i.textContent,c,e),n=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fi("scroll",i)}switch(s){case"input":q(i),Z(i,a,!0);break;case"textarea":q(i),ae(i);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(i.onclick=Qi)}i=n,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(s)),"http://www.w3.org/1999/xhtml"===e?"script"===s?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof i.is?e=l.createElement(s,{is:i.is}):(e=l.createElement(s),"select"===s&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,s),e[un]=t,e[pn]=i,Mo(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(s,i),s){case"dialog":Fi("cancel",e),Fi("close",e),n=i;break;case"iframe":case"object":case"embed":Fi("load",e),n=i;break;case"video":case"audio":for(n=0;n<Di.length;n++)Fi(Di[n],e);n=i;break;case"source":Fi("error",e),n=i;break;case"img":case"image":case"link":Fi("error",e),Fi("load",e),n=i;break;case"details":Fi("toggle",e),n=i;break;case"input":X(e,i),n=K(e,i),Fi("invalid",e);break;case"option":default:n=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},n=O({},i,{value:void 0}),Fi("invalid",e);break;case"textarea":ne(e,i),n=ie(e,i),Fi("invalid",e)}for(a in be(s,n),c=n)if(c.hasOwnProperty(a)){var d=c[a];"style"===a?ge(e,d):"dangerouslySetInnerHTML"===a?null!=(d=d?d.__html:void 0)&&he(e,d):"children"===a?"string"===typeof d?("textarea"!==s||""!==d)&&ue(e,d):"number"===typeof d&&ue(e,""+d):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=d&&"onScroll"===a&&Fi("scroll",e):null!=d&&y(e,a,d,l))}switch(s){case"input":q(e),Z(e,i,!1);break;case"textarea":q(e),ae(e);break;case"option":null!=i.value&&e.setAttribute("value",""+V(i.value));break;case"select":e.multiple=!!i.multiple,null!=(a=i.value)?se(e,!!i.multiple,a,!1):null!=i.defaultValue&&se(e,!!i.multiple,i.defaultValue,!0);break;default:"function"===typeof n.onClick&&(e.onclick=Qi)}switch(s){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)Do(e,t,e.memoizedProps,i);else{if("string"!==typeof i&&null===t.stateNode)throw Error(r(166));if(s=Yr(Gr.current),Yr(Wr.current),hr(t)){if(i=t.stateNode,s=t.memoizedProps,i[un]=t,(a=i.nodeValue!==s)&&null!==(e=sr))switch(e.tag){case 3:Ji(i.nodeValue,s,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ji(i.nodeValue,s,0!==(1&e.mode))}a&&(t.flags|=4)}else(i=(9===s.nodeType?s:s.ownerDocument).createTextNode(i))[un]=t,t.stateNode=i}return qo(t),null;case 13:if(An(Zr),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(nr&&null!==ir&&0!==(1&t.mode)&&0===(128&t.flags))ur(),pr(),t.flags|=98560,a=!1;else if(a=hr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!a)throw Error(r(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(r(317));a[un]=t}else pr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),a=!1}else null!==rr&&(ac(rr),rr=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=s,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zr.current)?0===Dl&&(Dl=3):mc())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return Xr(),Po(e,t),null===e&&$i(t.stateNode.containerInfo),qo(t),null;case 10:return Er(t.type._context),qo(t),null;case 19:if(An(Zr),null===(a=t.memoizedState))return qo(t),null;if(i=0!==(128&t.flags),null===(l=a.rendering))if(i)Wo(a,!1);else{if(0!==Dl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Wo(a,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=s,s=t.child;null!==s;)e=i,(a=s).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Cn(Zr,1&Zr.current|2),t.child}e=e.sibling}null!==a.tail&&Je()>Hl&&(t.flags|=128,i=!0,Wo(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=ea(l))){if(t.flags|=128,i=!0,null!==(s=e.updateQueue)&&(t.updateQueue=s,t.flags|=4),Wo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!nr)return qo(t),null}else 2*Je()-a.renderingStartTime>Hl&&1073741824!==s&&(t.flags|=128,i=!0,Wo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(s=a.last)?s.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Je(),t.sibling=null,s=Zr.current,Cn(Zr,i?1&s|2:1&s),t):(qo(t),null);case 22:case 23:return hc(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Yo(e,t){switch(tr(t),t.tag){case 1:return Pn(t.type)&&Rn(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xr(),An(jn),An(Nn),sa(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qr(t),null;case 13:if(An(Zr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));pr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return An(Zr),null;case 4:return Xr(),null;case 10:return Er(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Mo=function(e,t){for(var s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},Po=function(){},Ro=function(e,t,s,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,Yr(Wr.current);var r,a=null;switch(s){case"input":n=K(e,n),i=K(e,i),a=[];break;case"select":n=O({},n,{value:void 0}),i=O({},i,{value:void 0}),a=[];break;case"textarea":n=ie(e,n),i=ie(e,i),a=[];break;default:"function"!==typeof n.onClick&&"function"===typeof i.onClick&&(e.onclick=Qi)}for(d in be(s,i),s=null,n)if(!i.hasOwnProperty(d)&&n.hasOwnProperty(d)&&null!=n[d])if("style"===d){var l=n[d];for(r in l)l.hasOwnProperty(r)&&(s||(s={}),s[r]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in i){var c=i[d];if(l=null!=n?n[d]:void 0,i.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(s||(s={}),s[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(s||(s={}),s[r]=c[r])}else s||(a||(a=[]),a.push(d,s)),s=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Fi("scroll",e),a||l===c||(a=[])):(a=a||[]).push(d,c))}s&&(a=a||[]).push("style",s);var d=a;(t.updateQueue=d)&&(t.flags|=4)}},Do=function(e,t,s,i){s!==i&&(t.flags|=4)};var Ko=!1,Xo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Qo=null;function Zo(e,t){var s=e.ref;if(null!==s)if("function"===typeof s)try{s(null)}catch(i){kc(e,t,i)}else s.current=null}function el(e,t,s){try{s()}catch(i){kc(e,t,i)}}var tl=!1;function sl(e,t,s){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var n=i=i.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&el(t,s,r)}n=n.next}while(n!==i)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var s=t=t.next;do{if((s.tag&e)===e){var i=s.create;s.destroy=i()}s=s.next}while(s!==t)}}function nl(e){var t=e.ref;if(null!==t){var s=e.stateNode;e.tag,e=s,"function"===typeof t?t(e):t.current=e}}function rl(e){var t=e.alternate;null!==t&&(e.alternate=null,rl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[un],delete t[pn],delete t[mn],delete t[gn],delete t[vn])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,s){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===s.nodeType?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(8===s.nodeType?(t=s.parentNode).insertBefore(e,s):(t=s).appendChild(e),null!==(s=s._reactRootContainer)&&void 0!==s||null!==t.onclick||(t.onclick=Qi));else if(4!==i&&null!==(e=e.child))for(ll(e,t,s),e=e.sibling;null!==e;)ll(e,t,s),e=e.sibling}function cl(e,t,s){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(4!==i&&null!==(e=e.child))for(cl(e,t,s),e=e.sibling;null!==e;)cl(e,t,s),e=e.sibling}var dl=null,hl=!1;function ul(e,t,s){for(s=s.child;null!==s;)pl(e,t,s),s=s.sibling}function pl(e,t,s){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(nt,s)}catch(o){}switch(s.tag){case 5:Xo||Zo(s,t);case 6:var i=dl,n=hl;dl=null,ul(e,t,s),hl=n,null!==(dl=i)&&(hl?(e=dl,s=s.stateNode,8===e.nodeType?e.parentNode.removeChild(s):e.removeChild(s)):dl.removeChild(s.stateNode));break;case 18:null!==dl&&(hl?(e=dl,s=s.stateNode,8===e.nodeType?ln(e.parentNode,s):1===e.nodeType&&ln(e,s),Ht(e)):ln(dl,s.stateNode));break;case 4:i=dl,n=hl,dl=s.stateNode.containerInfo,hl=!0,ul(e,t,s),dl=i,hl=n;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(i=s.updateQueue)&&null!==(i=i.lastEffect))){n=i=i.next;do{var r=n,a=r.destroy;r=r.tag,void 0!==a&&(0!==(2&r)||0!==(4&r))&&el(s,t,a),n=n.next}while(n!==i)}ul(e,t,s);break;case 1:if(!Xo&&(Zo(s,t),"function"===typeof(i=s.stateNode).componentWillUnmount))try{i.props=s.memoizedProps,i.state=s.memoizedState,i.componentWillUnmount()}catch(o){kc(s,t,o)}ul(e,t,s);break;case 21:ul(e,t,s);break;case 22:1&s.mode?(Xo=(i=Xo)||null!==s.memoizedState,ul(e,t,s),Xo=i):ul(e,t,s);break;default:ul(e,t,s)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new Jo),t.forEach((function(t){var i=Nc.bind(null,e,t);s.has(t)||(s.add(t),t.then(i,i))}))}}function ml(e,t){var s=t.deletions;if(null!==s)for(var i=0;i<s.length;i++){var n=s[i];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(r(160));pl(a,o,n),dl=null,hl=!1;var c=n.alternate;null!==c&&(c.return=null),n.return=null}catch(d){kc(n,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var s=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&i){try{sl(3,e,e.return),il(3,e)}catch(g){kc(e,e.return,g)}try{sl(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:ml(t,e),vl(e),512&i&&null!==s&&Zo(s,s.return);break;case 5:if(ml(t,e),vl(e),512&i&&null!==s&&Zo(s,s.return),32&e.flags){var n=e.stateNode;try{ue(n,"")}catch(g){kc(e,e.return,g)}}if(4&i&&null!=(n=e.stateNode)){var a=e.memoizedProps,o=null!==s?s.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(n,a),ye(l,o);var d=ye(l,a);for(o=0;o<c.length;o+=2){var h=c[o],u=c[o+1];"style"===h?ge(n,u):"dangerouslySetInnerHTML"===h?he(n,u):"children"===h?ue(n,u):y(n,h,u,d)}switch(l){case"input":Q(n,a);break;case"textarea":re(n,a);break;case"select":var p=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?se(n,!!a.multiple,f,!1):p!==!!a.multiple&&(null!=a.defaultValue?se(n,!!a.multiple,a.defaultValue,!0):se(n,!!a.multiple,a.multiple?[]:"",!1))}n[pn]=a}catch(g){kc(e,e.return,g)}}break;case 6:if(ml(t,e),vl(e),4&i){if(null===e.stateNode)throw Error(r(162));n=e.stateNode,a=e.memoizedProps;try{n.nodeValue=a}catch(g){kc(e,e.return,g)}}break;case 3:if(ml(t,e),vl(e),4&i&&null!==s&&s.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(n=e.child).flags&&(a=null!==n.memoizedState,n.stateNode.isHidden=a,!a||null!==n.alternate&&null!==n.alternate.memoizedState||($l=Je())),4&i&&fl(e);break;case 22:if(h=null!==s&&null!==s.memoizedState,1&e.mode?(Xo=(d=Xo)||h,ml(t,e),Xo=d):ml(t,e),vl(e),8192&i){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!h&&0!==(1&e.mode))for(Qo=e,h=e.child;null!==h;){for(u=Qo=h;null!==Qo;){switch(f=(p=Qo).child,p.tag){case 0:case 11:case 14:case 15:sl(4,p,p.return);break;case 1:Zo(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){i=p,s=p.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){kc(i,s,g)}}break;case 5:Zo(p,p.return);break;case 22:if(null!==p.memoizedState){wl(u);continue}}null!==f?(f.return=p,Qo=f):wl(u)}h=h.sibling}e:for(h=null,u=e;;){if(5===u.tag){if(null===h){h=u;try{n=u.stateNode,d?"function"===typeof(a=n.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=u.stateNode,o=void 0!==(c=u.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){kc(e,e.return,g)}}}else if(6===u.tag){if(null===h)try{u.stateNode.nodeValue=d?"":u.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:ml(t,e),vl(e),4&i&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var s=e.return;null!==s;){if(al(s)){var i=s;break e}s=s.return}throw Error(r(160))}switch(i.tag){case 5:var n=i.stateNode;32&i.flags&&(ue(n,""),i.flags&=-33),cl(e,ol(e),n);break;case 3:case 4:var a=i.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(r(161))}}catch(o){kc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,s){Qo=e,yl(e,t,s)}function yl(e,t,s){for(var i=0!==(1&e.mode);null!==Qo;){var n=Qo,r=n.child;if(22===n.tag&&i){var a=null!==n.memoizedState||Ko;if(!a){var o=n.alternate,l=null!==o&&null!==o.memoizedState||Xo;o=Ko;var c=Xo;if(Ko=a,(Xo=l)&&!c)for(Qo=n;null!==Qo;)l=(a=Qo).child,22===a.tag&&null!==a.memoizedState?_l(n):null!==l?(l.return=a,Qo=l):_l(n);for(;null!==r;)Qo=r,yl(r,t,s),r=r.sibling;Qo=n,Ko=o,Xo=c}xl(e)}else 0!==(8772&n.subtreeFlags)&&null!==r?(r.return=n,Qo=r):xl(e)}}function xl(e){for(;null!==Qo;){var t=Qo;if(0!==(8772&t.flags)){var s=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||il(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Xo)if(null===s)i.componentDidMount();else{var n=t.elementType===t.type?s.memoizedProps:to(t.type,s.memoizedProps);i.componentDidUpdate(n,s.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Ur(t,a,i);break;case 3:var o=t.updateQueue;if(null!==o){if(s=null,null!==t.child)switch(t.child.tag){case 5:case 1:s=t.child.stateNode}Ur(t,o,s)}break;case 5:var l=t.stateNode;if(null===s&&4&t.flags){s=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var h=d.memoizedState;if(null!==h){var u=h.dehydrated;null!==u&&Ht(u)}}}break;default:throw Error(r(163))}Xo||512&t.flags&&nl(t)}catch(p){kc(t,t.return,p)}}if(t===e){Qo=null;break}if(null!==(s=t.sibling)){s.return=t.return,Qo=s;break}Qo=t.return}}function wl(e){for(;null!==Qo;){var t=Qo;if(t===e){Qo=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Qo=s;break}Qo=t.return}}function _l(e){for(;null!==Qo;){var t=Qo;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{il(4,t)}catch(l){kc(t,s,l)}break;case 1:var i=t.stateNode;if("function"===typeof i.componentDidMount){var n=t.return;try{i.componentDidMount()}catch(l){kc(t,n,l)}}var r=t.return;try{nl(t)}catch(l){kc(t,r,l)}break;case 5:var a=t.return;try{nl(t)}catch(l){kc(t,a,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Qo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Qo=o;break}Qo=t.return}}var Sl,kl=Math.ceil,Al=x.ReactCurrentDispatcher,Cl=x.ReactCurrentOwner,El=x.ReactCurrentBatchConfig,Nl=0,jl=null,Tl=null,Ml=0,Pl=0,Rl=kn(0),Dl=0,Il=null,Ll=0,Ol=0,Fl=0,zl=null,Bl=null,$l=0,Hl=1/0,Ul=null,Vl=!1,Wl=null,ql=null,Gl=!1,Yl=null,Kl=0,Xl=0,Jl=null,Ql=-1,Zl=0;function ec(){return 0!==(6&Nl)?Je():-1!==Ql?Ql:Ql=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Ml?Ml&-Ml:null!==mr.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function sc(e,t,s,i){if(50<Xl)throw Xl=0,Jl=null,Error(r(185));vt(e,s,i),0!==(2&Nl)&&e===jl||(e===jl&&(0===(2&Nl)&&(Ol|=s),4===Dl&&oc(e,Ml)),ic(e,i),1===s&&0===Nl&&0===(1&t.mode)&&(Hl=Je()+500,zn&&Hn()))}function ic(e,t){var s=e.callbackNode;!function(e,t){for(var s=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,r=e.pendingLanes;0<r;){var a=31-at(r),o=1<<a,l=n[a];-1===l?0!==(o&s)&&0===(o&i)||(n[a]=pt(o,t)):l<=t&&(e.expiredLanes|=o),r&=~o}}(e,t);var i=ut(e,e===jl?Ml:0);if(0===i)null!==s&&Ye(s),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=s&&Ye(s),1===t)0===e.tag?function(e){zn=!0,$n(e)}(lc.bind(null,e)):$n(lc.bind(null,e)),an((function(){0===(6&Nl)&&Hn()})),s=null;else{switch(xt(i)){case 1:s=Ze;break;case 4:s=et;break;case 16:default:s=tt;break;case 536870912:s=it}s=jc(s,nc.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function nc(e,t){if(Ql=-1,Zl=0,0!==(6&Nl))throw Error(r(327));var s=e.callbackNode;if(_c()&&e.callbackNode!==s)return null;var i=ut(e,e===jl?Ml:0);if(0===i)return null;if(0!==(30&i)||0!==(i&e.expiredLanes)||t)t=gc(e,i);else{t=i;var n=Nl;Nl|=2;var a=fc();for(jl===e&&Ml===t||(Ul=null,Hl=Je()+500,uc(e,t));;)try{bc();break}catch(l){pc(e,l)}Cr(),Al.current=a,Nl=n,null!==Tl?t=0:(jl=null,Ml=0,t=Dl)}if(0!==t){if(2===t&&(0!==(n=ft(e))&&(i=n,t=rc(e,n))),1===t)throw s=Il,uc(e,0),oc(e,i),ic(e,Je()),s;if(6===t)oc(e,i);else{if(n=e.current.alternate,0===(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var s=t.updateQueue;if(null!==s&&null!==(s=s.stores))for(var i=0;i<s.length;i++){var n=s[i],r=n.getSnapshot;n=n.value;try{if(!ai(r(),n))return!1}catch(o){return!1}}}if(s=t.child,16384&t.subtreeFlags&&null!==s)s.return=t,t=s;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(n)&&(2===(t=gc(e,i))&&(0!==(a=ft(e))&&(i=a,t=rc(e,a))),1===t))throw s=Il,uc(e,0),oc(e,i),ic(e,Je()),s;switch(e.finishedWork=n,e.finishedLanes=i,t){case 0:case 1:throw Error(r(345));case 2:case 5:wc(e,Bl,Ul);break;case 3:if(oc(e,i),(130023424&i)===i&&10<(t=$l+500-Je())){if(0!==ut(e,0))break;if(((n=e.suspendedLanes)&i)!==i){ec(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=sn(wc.bind(null,e,Bl,Ul),t);break}wc(e,Bl,Ul);break;case 4:if(oc(e,i),(4194240&i)===i)break;for(t=e.eventTimes,n=-1;0<i;){var o=31-at(i);a=1<<o,(o=t[o])>n&&(n=o),i&=~a}if(i=n,10<(i=(120>(i=Je()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*kl(i/1960))-i)){e.timeoutHandle=sn(wc.bind(null,e,Bl,Ul),i);break}wc(e,Bl,Ul);break;default:throw Error(r(329))}}}return ic(e,Je()),e.callbackNode===s?nc.bind(null,e):null}function rc(e,t){var s=zl;return e.current.memoizedState.isDehydrated&&(uc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Bl,Bl=s,null!==t&&ac(t)),e}function ac(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function oc(e,t){for(t&=~Fl,t&=~Ol,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-at(t),i=1<<s;e[s]=-1,t&=~i}}function lc(e){if(0!==(6&Nl))throw Error(r(327));_c();var t=ut(e,0);if(0===(1&t))return ic(e,Je()),null;var s=gc(e,t);if(0!==e.tag&&2===s){var i=ft(e);0!==i&&(t=i,s=rc(e,i))}if(1===s)throw s=Il,uc(e,0),oc(e,t),ic(e,Je()),s;if(6===s)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Bl,Ul),ic(e,Je()),null}function cc(e,t){var s=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=s)&&(Hl=Je()+500,zn&&Hn())}}function dc(e){null!==Yl&&0===Yl.tag&&0===(6&Nl)&&_c();var t=Nl;Nl|=1;var s=El.transition,i=yt;try{if(El.transition=null,yt=1,e)return e()}finally{yt=i,El.transition=s,0===(6&(Nl=t))&&Hn()}}function hc(){Pl=Rl.current,An(Rl)}function uc(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(-1!==s&&(e.timeoutHandle=-1,nn(s)),null!==Tl)for(s=Tl.return;null!==s;){var i=s;switch(tr(i),i.tag){case 1:null!==(i=i.type.childContextTypes)&&void 0!==i&&Rn();break;case 3:Xr(),An(jn),An(Nn),sa();break;case 5:Qr(i);break;case 4:Xr();break;case 13:case 19:An(Zr);break;case 10:Er(i.type._context);break;case 22:case 23:hc()}s=s.return}if(jl=e,Tl=e=Rc(e.current,null),Ml=Pl=t,Dl=0,Il=null,Fl=Ol=Ll=0,Bl=zl=null,null!==Mr){for(t=0;t<Mr.length;t++)if(null!==(i=(s=Mr[t]).interleaved)){s.interleaved=null;var n=i.next,r=s.pending;if(null!==r){var a=r.next;r.next=n,i.next=a}s.pending=i}Mr=null}return e}function pc(e,t){for(;;){var s=Tl;try{if(Cr(),ia.current=Ja,ca){for(var i=aa.memoizedState;null!==i;){var n=i.queue;null!==n&&(n.pending=null),i=i.next}ca=!1}if(ra=0,la=oa=aa=null,da=!1,ha=0,Cl.current=null,null===s||null===s.return){Dl=1,Il=t,Tl=null;break}e:{var a=e,o=s.return,l=s,c=t;if(t=Ml,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,h=l,u=h.tag;if(0===(1&h.mode)&&(0===u||11===u||15===u)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=go(o);if(null!==f){f.flags&=-257,vo(f,o,l,0,t),1&f.mode&&mo(a,d,t),c=d;var m=(t=f).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mo(a,d,t),mc();break e}c=Error(r(426))}else if(nr&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),fr(lo(c,l));break e}}a=c=lo(c,l),4!==Dl&&(Dl=2),null===zl?zl=[a]:zl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,$r(a,po(0,c,t));break e;case 1:l=c;var b=a.type,y=a.stateNode;if(0===(128&a.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===ql||!ql.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t,$r(a,fo(a,l,t));break e}}a=a.return}while(null!==a)}xc(s)}catch(x){t=x,Tl===s&&null!==s&&(Tl=s=s.return);continue}break}}function fc(){var e=Al.current;return Al.current=Ja,null===e?Ja:e}function mc(){0!==Dl&&3!==Dl&&2!==Dl||(Dl=4),null===jl||0===(268435455&Ll)&&0===(268435455&Ol)||oc(jl,Ml)}function gc(e,t){var s=Nl;Nl|=2;var i=fc();for(jl===e&&Ml===t||(Ul=null,uc(e,t));;)try{vc();break}catch(n){pc(e,n)}if(Cr(),Nl=s,Al.current=i,null!==Tl)throw Error(r(261));return jl=null,Ml=0,Dl}function vc(){for(;null!==Tl;)yc(Tl)}function bc(){for(;null!==Tl&&!Ke();)yc(Tl)}function yc(e){var t=Sl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?xc(e):Tl=t,Cl.current=null}function xc(e){var t=e;do{var s=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(s=Go(s,t,Pl)))return void(Tl=s)}else{if(null!==(s=Yo(s,t)))return s.flags&=32767,void(Tl=s);if(null===e)return Dl=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Dl&&(Dl=5)}function wc(e,t,s){var i=yt,n=El.transition;try{El.transition=null,yt=1,function(e,t,s,i){do{_c()}while(null!==Yl);if(0!==(6&Nl))throw Error(r(327));s=e.finishedWork;var n=e.finishedLanes;if(null===s)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var a=s.lanes|s.childLanes;if(function(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<s;){var n=31-at(s),r=1<<n;t[n]=0,i[n]=-1,e[n]=-1,s&=~r}}(e,a),e===jl&&(Tl=jl=null,Ml=0),0===(2064&s.subtreeFlags)&&0===(2064&s.flags)||Gl||(Gl=!0,jc(tt,(function(){return _c(),null}))),a=0!==(15990&s.flags),0!==(15990&s.subtreeFlags)||a){a=El.transition,El.transition=null;var o=yt;yt=1;var l=Nl;Nl|=4,Cl.current=null,function(e,t){if(Zi=Vt,ui(e=hi())){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(i&&0!==i.rangeCount){s=i.anchorNode;var n=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{s.nodeType,a.nodeType}catch(w){s=null;break e}var o=0,l=-1,c=-1,d=0,h=0,u=e,p=null;t:for(;;){for(var f;u!==s||0!==n&&3!==u.nodeType||(l=o+n),u!==a||0!==i&&3!==u.nodeType||(c=o+i),3===u.nodeType&&(o+=u.nodeValue.length),null!==(f=u.firstChild);)p=u,u=f;for(;;){if(u===e)break t;if(p===s&&++d===n&&(l=o),p===a&&++h===i&&(c=o),null!==(f=u.nextSibling))break;p=(u=p).parentNode}u=f}s=-1===l||-1===c?null:{start:l,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(en={focusedElem:e,selectionRange:s},Vt=!1,Qo=t;null!==Qo;)if(e=(t=Qo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qo=e;else for(;null!==Qo;){t=Qo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),v);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(r(163))}}catch(w){kc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Qo=e;break}Qo=t.return}m=tl,tl=!1}(e,s),gl(s,e),pi(en),Vt=!!Zi,en=Zi=null,e.current=s,bl(s,e,n),Xe(),Nl=l,yt=o,El.transition=a}else e.current=s;if(Gl&&(Gl=!1,Yl=e,Kl=n),a=e.pendingLanes,0===a&&(ql=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(nt,e,void 0,128===(128&e.current.flags))}catch(t){}}(s.stateNode),ic(e,Je()),null!==t)for(i=e.onRecoverableError,s=0;s<t.length;s++)n=t[s],i(n.value,{componentStack:n.stack,digest:n.digest});if(Vl)throw Vl=!1,e=Wl,Wl=null,e;0!==(1&Kl)&&0!==e.tag&&_c(),a=e.pendingLanes,0!==(1&a)?e===Jl?Xl++:(Xl=0,Jl=e):Xl=0,Hn()}(e,t,s,i)}finally{El.transition=n,yt=i}return null}function _c(){if(null!==Yl){var e=xt(Kl),t=El.transition,s=yt;try{if(El.transition=null,yt=16>e?16:e,null===Yl)var i=!1;else{if(e=Yl,Yl=null,Kl=0,0!==(6&Nl))throw Error(r(331));var n=Nl;for(Nl|=4,Qo=e.current;null!==Qo;){var a=Qo,o=a.child;if(0!==(16&Qo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Qo=d;null!==Qo;){var h=Qo;switch(h.tag){case 0:case 11:case 15:sl(8,h,a)}var u=h.child;if(null!==u)u.return=h,Qo=u;else for(;null!==Qo;){var p=(h=Qo).sibling,f=h.return;if(rl(h),h===d){Qo=null;break}if(null!==p){p.return=f,Qo=p;break}Qo=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Qo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Qo=o;else e:for(;null!==Qo;){if(0!==(2048&(a=Qo).flags))switch(a.tag){case 0:case 11:case 15:sl(9,a,a.return)}var b=a.sibling;if(null!==b){b.return=a.return,Qo=b;break e}Qo=a.return}}var y=e.current;for(Qo=y;null!==Qo;){var x=(o=Qo).child;if(0!==(2064&o.subtreeFlags)&&null!==x)x.return=o,Qo=x;else e:for(o=y;null!==Qo;){if(0!==(2048&(l=Qo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(_){kc(l,l.return,_)}if(l===o){Qo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Qo=w;break e}Qo=l.return}}if(Nl=n,Hn(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(nt,e)}catch(_){}i=!0}return i}finally{yt=s,El.transition=t}}return!1}function Sc(e,t,s){e=zr(e,t=po(0,t=lo(s,t),1),1),t=ec(),null!==e&&(vt(e,1,t),ic(e,t))}function kc(e,t,s){if(3===e.tag)Sc(e,e,s);else for(;null!==t;){if(3===t.tag){Sc(t,e,s);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===ql||!ql.has(i))){t=zr(t,e=fo(t,e=lo(s,e),1),1),e=ec(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Ac(e,t,s){var i=e.pingCache;null!==i&&i.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&s,jl===e&&(Ml&s)===s&&(4===Dl||3===Dl&&(130023424&Ml)===Ml&&500>Je()-$l?uc(e,0):Fl|=s),ic(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var s=ec();null!==(e=Dr(e,t))&&(vt(e,t,s),ic(e,s))}function Ec(e){var t=e.memoizedState,s=0;null!==t&&(s=t.retryLane),Cc(e,s)}function Nc(e,t){var s=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;null!==n&&(s=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(r(314))}null!==i&&i.delete(t),Cc(e,s)}function jc(e,t){return Ge(e,t)}function Tc(e,t,s,i){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,s,i){return new Tc(e,t,s,i)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var s=e.alternate;return null===s?((s=Mc(e.tag,t,e.key,e.mode)).elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=14680064&e.flags,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Dc(e,t,s,i,n,a){var o=2;if(i=e,"function"===typeof e)Pc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Ic(s.children,n,a,t);case k:o=8,n|=8;break;case A:return(e=Mc(12,s,t,2|n)).elementType=A,e.lanes=a,e;case j:return(e=Mc(13,s,t,n)).elementType=j,e.lanes=a,e;case T:return(e=Mc(19,s,t,n)).elementType=T,e.lanes=a,e;case R:return Lc(s,n,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case E:o=9;break e;case N:o=11;break e;case M:o=14;break e;case P:o=16,i=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Mc(o,s,t,n)).elementType=e,t.type=i,t.lanes=a,t}function Ic(e,t,s,i){return(e=Mc(7,e,i,t)).lanes=s,e}function Lc(e,t,s,i){return(e=Mc(22,e,i,t)).elementType=R,e.lanes=s,e.stateNode={isHidden:!1},e}function Oc(e,t,s){return(e=Mc(6,e,null,t)).lanes=s,e}function Fc(e,t,s){return(t=Mc(4,null!==e.children?e.children:[],e.key,t)).lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,s,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Bc(e,t,s,i,n,r,a,o,l){return e=new zc(e,t,s,o,l),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Mc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:i,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lr(r),e}function $c(e){if(!e)return En;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var s=e.type;if(Pn(s))return In(e,s,t)}return t}function Hc(e,t,s,i,n,r,a,o,l){return(e=Bc(s,i,!0,e,0,r,0,o,l)).context=$c(null),s=e.current,(r=Fr(i=ec(),n=tc(s))).callback=void 0!==t&&null!==t?t:null,zr(s,r,n),e.current.lanes=n,vt(e,n,i),ic(e,i),e}function Uc(e,t,s,i){var n=t.current,r=ec(),a=tc(n);return s=$c(s),null===t.context?t.context=s:t.pendingContext=s,(t=Fr(r,a)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=zr(n,t,a))&&(sc(e,n,a,r),Br(e,n,a)),a}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var s=e.retryLane;e.retryLane=0!==s&&s<t?s:t}}function qc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}Sl=function(e,t,s){if(null!==e)if(e.memoizedProps!==t.pendingProps||jn.current)yo=!0;else{if(0===(e.lanes&s)&&0===(128&t.flags))return yo=!1,function(e,t,s){switch(t.tag){case 3:jo(t),pr();break;case 5:Jr(t);break;case 1:Pn(t.type)&&Ln(t);break;case 4:Kr(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;Cn(_r,i._currentValue),i._currentValue=n;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Cn(Zr,1&Zr.current),t.flags|=128,null):0!==(s&t.child.childLanes)?Oo(e,t,s):(Cn(Zr,1&Zr.current),null!==(e=Vo(e,t,s))?e.sibling:null);Cn(Zr,1&Zr.current);break;case 19:if(i=0!==(s&t.childLanes),0!==(128&e.flags)){if(i)return Ho(e,t,s);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),Cn(Zr,Zr.current),i)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,s)}return Vo(e,t,s)}(e,t,s);yo=0!==(131072&e.flags)}else yo=!1,nr&&0!==(1048576&t.flags)&&Zn(t,qn,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Uo(e,t),e=t.pendingProps;var n=Mn(t,Nn.current);jr(t,s),n=ma(null,t,i,e,n,s);var a=ga();return t.flags|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pn(i)?(a=!0,Ln(t)):a=!1,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,Lr(t),n.updater=io,t.stateNode=n,n._reactInternals=t,oo(t,i,e,s),t=No(null,t,i,!0,a,s)):(t.tag=0,nr&&a&&er(t),xo(null,t,n,s),t=t.child),t;case 16:i=t.elementType;e:{switch(Uo(e,t),e=t.pendingProps,i=(n=i._init)(i._payload),t.type=i,n=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===M)return 14}return 2}(i),e=to(i,e),n){case 0:t=Co(null,t,i,e,s);break e;case 1:t=Eo(null,t,i,e,s);break e;case 11:t=wo(null,t,i,e,s);break e;case 14:t=_o(null,t,i,to(i.type,e),s);break e}throw Error(r(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,Co(e,t,i,n=t.elementType===i?n:to(i,n),s);case 1:return i=t.type,n=t.pendingProps,Eo(e,t,i,n=t.elementType===i?n:to(i,n),s);case 3:e:{if(jo(t),null===e)throw Error(r(387));i=t.pendingProps,n=(a=t.memoizedState).element,Or(e,t),Hr(t,i,null,s);var o=t.memoizedState;if(i=o.element,a.isDehydrated){if(a={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=To(e,t,i,s,n=lo(Error(r(423)),t));break e}if(i!==n){t=To(e,t,i,s,n=lo(Error(r(424)),t));break e}for(ir=cn(t.stateNode.containerInfo.firstChild),sr=t,nr=!0,rr=null,s=wr(t,null,i,s),t.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(pr(),i===n){t=Vo(e,t,s);break e}xo(e,t,i,s)}t=t.child}return t;case 5:return Jr(t),null===e&&cr(t),i=t.type,n=t.pendingProps,a=null!==e?e.memoizedProps:null,o=n.children,tn(i,n)?o=null:null!==a&&tn(i,a)&&(t.flags|=32),Ao(e,t),xo(e,t,o,s),t.child;case 6:return null===e&&cr(t),null;case 13:return Oo(e,t,s);case 4:return Kr(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=xr(t,null,i,s):xo(e,t,i,s),t.child;case 11:return i=t.type,n=t.pendingProps,wo(e,t,i,n=t.elementType===i?n:to(i,n),s);case 7:return xo(e,t,t.pendingProps,s),t.child;case 8:case 12:return xo(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(i=t.type._context,n=t.pendingProps,a=t.memoizedProps,o=n.value,Cn(_r,i._currentValue),i._currentValue=o,null!==a)if(ai(a.value,o)){if(a.children===n.children&&!jn.current){t=Vo(e,t,s);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===a.tag){(c=Fr(-1,s&-s)).tag=2;var d=a.updateQueue;if(null!==d){var h=(d=d.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}a.lanes|=s,null!==(c=a.alternate)&&(c.lanes|=s),Nr(a.return,s,t),l.lanes|=s;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(r(341));o.lanes|=s,null!==(l=o.alternate)&&(l.lanes|=s),Nr(o,s,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}xo(e,t,n.children,s),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,jr(t,s),i=i(n=Tr(n)),t.flags|=1,xo(e,t,i,s),t.child;case 14:return n=to(i=t.type,t.pendingProps),_o(e,t,i,n=to(i.type,n),s);case 15:return So(e,t,t.type,t.pendingProps,s);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:to(i,n),Uo(e,t),t.tag=1,Pn(i)?(e=!0,Ln(t)):e=!1,jr(t,s),ro(t,i,n),oo(t,i,n,s),No(null,t,i,!0,e,s);case 19:return Ho(e,t,s);case 22:return ko(e,t,s)}throw Error(r(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Qc(){}function Zc(e,t,s,i,n){var r=s._reactRootContainer;if(r){var a=r;if("function"===typeof n){var o=n;n=function(){var e=Vc(a);o.call(e)}}Uc(t,a,e,n)}else a=function(e,t,s,i,n){if(n){if("function"===typeof i){var r=i;i=function(){var e=Vc(a);r.call(e)}}var a=Hc(t,i,e,0,null,!1,0,"",Qc);return e._reactRootContainer=a,e[fn]=a.current,$i(8===e.nodeType?e.parentNode:e),dc(),a}for(;n=e.lastChild;)e.removeChild(n);if("function"===typeof i){var o=i;i=function(){var e=Vc(l);o.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",Qc);return e._reactRootContainer=l,e[fn]=l.current,$i(8===e.nodeType?e.parentNode:e),dc((function(){Uc(t,l,s,i)})),l}(s,t,e,n,i);return Vc(a)}Kc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Uc(e,t,null,null)},Kc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){Uc(null,e,null,null)})),t[fn]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Rt.length&&0!==t&&t<Rt[s].priority;s++);Rt.splice(s,0,e),0===s&&Ot(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=ht(t.pendingLanes);0!==s&&(bt(t,1|s),ic(t,Je()),0===(6&Nl)&&(Hl=Je()+500,Hn()))}break;case 13:dc((function(){var t=Dr(e,1);if(null!==t){var s=ec();sc(t,e,1,s)}})),qc(e,1)}},_t=function(e){if(13===e.tag){var t=Dr(e,134217728);if(null!==t)sc(t,e,134217728,ec());qc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),s=Dr(e,t);if(null!==s)sc(s,e,t,ec());qc(e,t)}},kt=function(){return yt},At=function(e,t){var s=yt;try{return yt=e,t()}finally{yt=s}},_e=function(e,t,s){switch(t){case"input":if(Q(e,s),t=s.name,"radio"===s.type&&null!=t){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var i=s[t];if(i!==e&&i.form===e.form){var n=wn(i);if(!n)throw Error(r(90));G(i),Q(i,n)}}}break;case"textarea":re(e,s);break;case"select":null!=(t=s.value)&&se(e,!!s.multiple,t,!1)}},Ne=cc,je=dc;var ed={usingClientEntryPoint:!1,Events:[yn,xn,wn,Ce,Ee,cc]},td={findFiberByHostInstance:bn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!id.isDisabled&&id.supportsFiber)try{nt=id.inject(sd),rt=id}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(r(200));return function(e,t,s){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==i?null:""+i,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},t.createRoot=function(e,t){if(!Xc(e))throw Error(r(299));var s=!1,i="",n=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(s=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(n=t.onRecoverableError)),t=Bc(e,1,!1,null,0,s,0,i,n),e[fn]=t.current,$i(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,s){if(!Jc(t))throw Error(r(200));return Zc(null,e,t,!0,s)},t.hydrateRoot=function(e,t,s){if(!Xc(e))throw Error(r(405));var i=null!=s&&s.hydratedSources||null,n=!1,a="",o=Gc;if(null!==s&&void 0!==s&&(!0===s.unstable_strictMode&&(n=!0),void 0!==s.identifierPrefix&&(a=s.identifierPrefix),void 0!==s.onRecoverableError&&(o=s.onRecoverableError)),t=Hc(t,null,e,1,null!=s?s:null,n,0,a,o),e[fn]=t.current,$i(e),i)for(e=0;e<i.length;e++)n=(n=(s=i[e])._getVersion)(s._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[s,n]:t.mutableSourceEagerHydrationData.push(s,n);return new Kc(t)},t.render=function(e,t,s){if(!Jc(t))throw Error(r(200));return Zc(null,e,t,!1,s)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(r(40));return!!e._reactRootContainer&&(dc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fn]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,s,i){if(!Jc(s))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Zc(e,t,s,!1,i)},t.version="18.3.1-next-f1338f8080-20240426"},736:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(374));class r extends n.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t){let{config:s,type:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n="";"plain"===i?n="pl":"phrase"===i?n="ph":"websearch"===i&&(n="w");const r=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${n}fts${r}.${t}`),this}match(e){return Object.entries(e).forEach((e=>{let[t,s]=e;this.url.searchParams.append(t,`eq.${s}`)})),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e){let{foreignTable:t,referencedTable:s=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=s?`${s}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}}t.default=r},745:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const i=s(400);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${i.version}`}},829:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(736));t.default=class{constructor(e,t){let{headers:s={},schema:i,fetch:n}=t;this.url=e,this.headers=s,this.schema=i,this.fetch=n}select(e){let{head:t=!1,count:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t?"HEAD":"GET";let r=!1;const a=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!r?"":('"'===e&&(r=!r),e))).join("");return this.url.searchParams.set("select",a),s&&(this.headers.Prefer=`count=${s}`),new n.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:s=!1,count:i,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),r||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new n.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new n.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},853:(e,t,s)=>{"use strict";e.exports=s(234)},950:(e,t,s)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=s(730)},980:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const n=i(s(210));t.PostgrestClient=n.default;const r=i(s(829));t.PostgrestQueryBuilder=r.default;const a=i(s(736));t.PostgrestFilterBuilder=a.default;const o=i(s(374));t.PostgrestTransformBuilder=o.default;const l=i(s(286));t.PostgrestBuilder=l.default;const c=i(s(611));t.PostgrestError=c.default,t.default={PostgrestClient:n.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}},985:(e,t,s)=>{const{createClient:i}=s(95),n="https://aqdzmfhakqdwquszaqle.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ";const a=i(n,r);e.exports={createExecuteSqlFunction:async()=>{try{const e="\n      CREATE OR REPLACE FUNCTION execute_sql(sql text)\n      RETURNS void AS $$\n      BEGIN\n        EXECUTE sql;\n      END;\n      $$ LANGUAGE plpgsql SECURITY DEFINER;\n    ",{error:t}=await a.rpc("execute_sql",{sql:e});t&&console.warn("Warning: Could not create execute_sql function. It might already exist.")}catch(e){console.warn("Warning: Error creating execute_sql function:",e.message)}},insertSampleData:async()=>{try{console.log("Inserting sample data...");const e=[{name:"Hypertension",category:"Cardiovascular",description:"High blood pressure condition"},{name:"Diabetes",category:"Endocrine",description:"Blood sugar regulation disorder"},{name:"Asthma",category:"Respiratory",description:"Chronic respiratory condition"},{name:"Arthritis",category:"Musculoskeletal",description:"Joint inflammation condition"},{name:"Depression",category:"Mental Health",description:"Mood disorder"},{name:"Anxiety",category:"Mental Health",description:"Anxiety disorder"},{name:"Migraine",category:"Neurological",description:"Severe headache condition"},{name:"Allergies",category:"Immunological",description:"Immune system response"},{name:"Hypothyroidism",category:"Endocrine",description:"Underactive thyroid condition"},{name:"Hyperthyroidism",category:"Endocrine",description:"Overactive thyroid condition"}],{error:t}=await a.from("diseases").upsert(e);if(t)throw t;console.log("Sample data inserted successfully")}catch(e){throw console.error("Error inserting sample data:",e),e}},createStorageBuckets:async()=>{try{console.log("Creating storage buckets...");const t="\n      ALTER DATABASE postgres SET \"app.settings.storage.enabled\" TO 'true';\n    ";await a.rpc("execute_sql",{sql:t});const s=["profile-pictures","medical-reports","health-reports","chat-attachments","support-attachments"];for(const n of s)try{const{error:e}=await a.storage.createBucket(n,{public:!0});e&&!e.message.includes("already exists")&&console.warn(`Warning creating bucket ${n}:`,e.message)}catch(e){console.warn(`Error creating bucket ${n}:`,e.message)}const i="\n      DO $$ \n      BEGIN\n        CREATE POLICY \"Allow public access to profile pictures\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'profile-pictures');\n        \n        CREATE POLICY \"Allow public access to medical reports\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'medical-reports');\n        \n        CREATE POLICY \"Allow public access to health reports\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'health-reports');\n        \n        CREATE POLICY \"Allow public access to chat attachments\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'chat-attachments');\n        \n        CREATE POLICY \"Allow public access to support attachments\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'support-attachments');\n      EXCEPTION\n        WHEN others THEN\n          NULL;\n      END $$;\n    ";await a.rpc("execute_sql",{sql:i}),console.log("Storage buckets and policies created successfully")}catch(e){console.warn("Warning: Error setting up storage:",e.message)}}}}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,s),r.exports}s.m=e,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(i,n){if(1&n&&(i=this(i)),8&n)return i;if("object"===typeof i&&i){if(4&n&&i.__esModule)return i;if(16&n&&"function"===typeof i.then)return i}var r=Object.create(null);s.r(r);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&n&&i;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>a[e]=()=>i[e]));return a.default=()=>i,s.d(r,a),r}})(),s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,i)=>(s.f[i](e,t),t)),[])),s.u=e=>"static/js/"+e+"."+{453:"a0b1a081",952:"14612d7a"}[e]+".chunk.js",s.miniCssF=e=>{},s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="digihealth:";s.l=(i,n,r,a)=>{if(e[i])e[i].push(n);else{var o,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var h=c[d];if(h.getAttribute("src")==i||h.getAttribute("data-webpack")==t+r){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.setAttribute("data-webpack",t+r),o.src=i),e[i]=[n];var u=(t,s)=>{o.onerror=o.onload=null,clearTimeout(p);var n=e[i];if(delete e[i],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach((e=>e(s))),t)return t(s)},p=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="/DiGiHealthAdv/",(()=>{var e={792:0};s.f.j=(t,i)=>{var n=s.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var r=new Promise(((s,i)=>n=e[t]=[s,i]));i.push(n[2]=r);var a=s.p+s.u(t),o=new Error;s.l(a,(i=>{if(s.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var r=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+a+")",o.name="ChunkLoadError",o.type=r,o.request=a,n[1](o)}}),"chunk-"+t,t)}};var t=(t,i)=>{var n,r,a=i[0],o=i[1],l=i[2],c=0;if(a.some((t=>0!==e[t]))){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);if(l)l(s)}for(t&&t(i);c<a.length;c++)r=a[c],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0},i=self.webpackChunkdigihealth=self.webpackChunkdigihealth||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e,t=s(43),i=s.t(t,2),n=s(391),r=s(950),a=s.t(r,2);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},o.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function d(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(s){}}}function h(e,t){return{usr:e.state,key:e.key,idx:t}}function u(e,t,s,i){return void 0===s&&(s=null),o({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?f(t):t,{state:s,key:t&&t.key||i||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:s="",hash:i=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function f(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function m(t,s,i,n){void 0===n&&(n={});let{window:r=document.defaultView,v5Compat:a=!1}=n,d=r.history,f=e.Pop,m=null,g=v();function v(){return(d.state||{idx:null}).idx}function b(){f=e.Pop;let t=v(),s=null==t?null:t-g;g=t,m&&m({action:f,location:x.location,delta:s})}function y(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,s="string"===typeof e?e:p(e);return s=s.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,t)}null==g&&(g=0,d.replaceState(o({},d.state,{idx:g}),""));let x={get action(){return f},get location(){return t(r,d)},listen(e){if(m)throw new Error("A history only accepts one active listener");return r.addEventListener(l,b),m=e,()=>{r.removeEventListener(l,b),m=null}},createHref:e=>s(r,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,s){f=e.Push;let n=u(x.location,t,s);i&&i(n,t),g=v()+1;let o=h(n,g),l=x.createHref(n);try{d.pushState(o,"",l)}catch(c){if(c instanceof DOMException&&"DataCloneError"===c.name)throw c;r.location.assign(l)}a&&m&&m({action:f,location:x.location,delta:1})},replace:function(t,s){f=e.Replace;let n=u(x.location,t,s);i&&i(n,t),g=v();let r=h(n,g),o=x.createHref(n);d.replaceState(r,"",o),a&&m&&m({action:f,location:x.location,delta:0})},go:e=>d.go(e)};return x}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,s){return void 0===s&&(s="/"),b(e,t,s,!1)}function b(e,t,s,i){let n=P(("string"===typeof t?f(t):t).pathname||"/",s);if(null==n)return null;let r=y(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every(((e,s)=>e===t[s]));return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(r);let a=null;for(let o=0;null==a&&o<r.length;++o){let e=M(n);a=j(r[o],e,i)}return a}function y(e,t,s,i){void 0===t&&(t=[]),void 0===s&&(s=[]),void 0===i&&(i="");let n=(e,n,r)=>{let a={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};a.relativePath.startsWith("/")&&(c(a.relativePath.startsWith(i),'Absolute route path "'+a.relativePath+'" nested under path "'+i+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(i.length));let o=O([i,a.relativePath]),l=s.concat(a);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),y(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:N(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var s;if(""!==e.path&&null!=(s=e.path)&&s.includes("?"))for(let i of x(e.path))n(e,t,i);else n(e,t)})),t}function x(e){let t=e.split("/");if(0===t.length)return[];let[s,...i]=t,n=s.endsWith("?"),r=s.replace(/\?$/,"");if(0===i.length)return n?[r,""]:[r];let a=x(i.join("/")),o=[];return o.push(...a.map((e=>""===e?r:[r,e].join("/")))),n&&o.push(...a),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const w=/^:[\w-]+$/,_=3,S=2,k=1,A=10,C=-2,E=e=>"*"===e;function N(e,t){let s=e.split("/"),i=s.length;return s.some(E)&&(i+=C),t&&(i+=S),s.filter((e=>!E(e))).reduce(((e,t)=>e+(w.test(t)?_:""===t?k:A)),i)}function j(e,t,s){void 0===s&&(s=!1);let{routesMeta:i}=e,n={},r="/",a=[];for(let o=0;o<i.length;++o){let e=i[o],l=o===i.length-1,c="/"===r?t:t.slice(r.length)||"/",d=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!d&&l&&s&&!i[i.length-1].route.index&&(d=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(n,d.params),a.push({params:n,pathname:O([r,d.pathname]),pathnameBase:F(O([r,d.pathnameBase])),route:h}),"/"!==d.pathnameBase&&(r=O([r,d.pathnameBase]))}return a}function T(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,i]=function(e,t,s){void 0===t&&(t=!1);void 0===s&&(s=!0);d("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let i=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,s)=>(i.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(i.push({paramName:"*"}),n+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?n+="\\/*$":""!==e&&"/"!==e&&(n+="(?:(?=\\/|$))");let r=new RegExp(n,t?void 0:"i");return[r,i]}(e.path,e.caseSensitive,e.end),n=t.match(s);if(!n)return null;let r=n[0],a=r.replace(/(.)\/+$/,"$1"),o=n.slice(1),l=i.reduce(((e,t,s)=>{let{paramName:i,isOptional:n}=t;if("*"===i){let e=o[s]||"";a=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[s];return e[i]=n&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:r,pathnameBase:a,pattern:e}}function M(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return d(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,i=e.charAt(s);return i&&"/"!==i?null:e.slice(s)||"/"}function R(e,t,s,i){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function D(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function I(e,t){let s=D(e);return t?s.map(((e,t)=>t===s.length-1?e.pathname:e.pathnameBase)):s.map((e=>e.pathnameBase))}function L(e,t,s,i){let n;void 0===i&&(i=!1),"string"===typeof e?n=f(e):(n=o({},e),c(!n.pathname||!n.pathname.includes("?"),R("?","pathname","search",n)),c(!n.pathname||!n.pathname.includes("#"),R("#","pathname","hash",n)),c(!n.search||!n.search.includes("#"),R("#","search","hash",n)));let r,a=""===e||""===n.pathname,l=a?"/":n.pathname;if(null==l)r=s;else{let e=t.length-1;if(!i&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}r=e>=0?t[e]:"/"}let d=function(e,t){void 0===t&&(t="/");let{pathname:s,search:i="",hash:n=""}="string"===typeof e?f(e):e,r=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)})),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:r,search:z(i),hash:B(n)}}(n,r),h=l&&"/"!==l&&l.endsWith("/"),u=(a||"."===l)&&s.endsWith("/");return d.pathname.endsWith("/")||!h&&!u||(d.pathname+="/"),d}const O=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),z=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",B=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function $(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const H=["post","put","patch","delete"],U=(new Set(H),["get",...H]);new Set(U),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function V(){return V=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},V.apply(this,arguments)}const W=t.createContext(null);const q=t.createContext(null);const G=t.createContext(null);const Y=t.createContext(null);const K=t.createContext({outlet:null,matches:[],isDataRoute:!1});const X=t.createContext(null);function J(){return null!=t.useContext(Y)}function Q(){return J()||c(!1),t.useContext(Y).location}function Z(e){t.useContext(G).static||t.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=t.useContext(K);return e?function(){let{router:e}=de(le.UseNavigateStable),s=ue(ce.UseNavigateStable),i=t.useRef(!1);Z((()=>{i.current=!0}));let n=t.useCallback((function(t,n){void 0===n&&(n={}),i.current&&("number"===typeof t?e.navigate(t):e.navigate(t,V({fromRouteId:s},n)))}),[e,s]);return n}():function(){J()||c(!1);let e=t.useContext(W),{basename:s,future:i,navigator:n}=t.useContext(G),{matches:r}=t.useContext(K),{pathname:a}=Q(),o=JSON.stringify(I(r,i.v7_relativeSplatPath)),l=t.useRef(!1);Z((()=>{l.current=!0}));let d=t.useCallback((function(t,i){if(void 0===i&&(i={}),!l.current)return;if("number"===typeof t)return void n.go(t);let r=L(t,JSON.parse(o),a,"path"===i.relative);null==e&&"/"!==s&&(r.pathname="/"===r.pathname?s:O([s,r.pathname])),(i.replace?n.replace:n.push)(r,i.state,i)}),[s,n,o,a,e]);return d}()}function te(e,s){let{relative:i}=void 0===s?{}:s,{future:n}=t.useContext(G),{matches:r}=t.useContext(K),{pathname:a}=Q(),o=JSON.stringify(I(r,n.v7_relativeSplatPath));return t.useMemo((()=>L(e,JSON.parse(o),a,"path"===i)),[e,o,a,i])}function se(s,i,n,r){J()||c(!1);let{navigator:a,static:o}=t.useContext(G),{matches:l}=t.useContext(K),d=l[l.length-1],h=d?d.params:{},u=(d&&d.pathname,d?d.pathnameBase:"/");d&&d.route;let p,m=Q();if(i){var g;let e="string"===typeof i?f(i):i;"/"===u||(null==(g=e.pathname)?void 0:g.startsWith(u))||c(!1),p=e}else p=m;let b=p.pathname||"/",y=b;if("/"!==u){let e=u.replace(/^\//,"").split("/");y="/"+b.replace(/^\//,"").split("/").slice(e.length).join("/")}let x=!o&&n&&n.matches&&n.matches.length>0?n.matches:v(s,{pathname:y});let w=oe(x&&x.map((e=>Object.assign({},e,{params:Object.assign({},h,e.params),pathname:O([u,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?u:O([u,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,r);return i&&w?t.createElement(Y.Provider,{value:{location:V({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:e.Pop}},w):w}function ie(){let e=function(){var e;let s=t.useContext(X),i=he(ce.UseRouteError),n=ue(ce.UseRouteError);if(void 0!==s)return s;return null==(e=i.errors)?void 0:e[n]}(),s=$(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:n};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},s),i?t.createElement("pre",{style:r},i):null,null)}const ne=t.createElement(ie,null);class re extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(K.Provider,{value:this.props.routeContext},t.createElement(X.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ae(e){let{routeContext:s,match:i,children:n}=e,r=t.useContext(W);return r&&r.static&&r.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=i.route.id),t.createElement(K.Provider,{value:s},n)}function oe(e,s,i,n){var r;if(void 0===s&&(s=[]),void 0===i&&(i=null),void 0===n&&(n=null),null==e){var a;if(!i)return null;if(i.errors)e=i.matches;else{if(!(null!=(a=n)&&a.v7_partialHydration&&0===s.length&&!i.initialized&&i.matches.length>0))return null;e=i.matches}}let o=e,l=null==(r=i)?void 0:r.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||c(!1),o=o.slice(0,Math.min(o.length,e+1))}let d=!1,h=-1;if(i&&n&&n.v7_partialHydration)for(let t=0;t<o.length;t++){let e=o[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(h=t),e.route.id){let{loaderData:t,errors:s}=i,n=e.route.loader&&void 0===t[e.route.id]&&(!s||void 0===s[e.route.id]);if(e.route.lazy||n){d=!0,o=h>=0?o.slice(0,h+1):[o[0]];break}}}return o.reduceRight(((e,n,r)=>{let a,c=!1,u=null,p=null;var f;i&&(a=l&&n.route.id?l[n.route.id]:void 0,u=n.route.errorElement||ne,d&&(h<0&&0===r?(f="route-fallback",!1||pe[f]||(pe[f]=!0),c=!0,p=null):h===r&&(c=!0,p=n.route.hydrateFallbackElement||null)));let m=s.concat(o.slice(0,r+1)),g=()=>{let s;return s=a?u:c?p:n.route.Component?t.createElement(n.route.Component,null):n.route.element?n.route.element:e,t.createElement(ae,{match:n,routeContext:{outlet:e,matches:m,isDataRoute:null!=i},children:s})};return i&&(n.route.ErrorBoundary||n.route.errorElement||0===r)?t.createElement(re,{location:i.location,revalidation:i.revalidation,component:u,error:a,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var le=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(le||{}),ce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ce||{});function de(e){let s=t.useContext(W);return s||c(!1),s}function he(e){let s=t.useContext(q);return s||c(!1),s}function ue(e){let s=function(){let e=t.useContext(K);return e||c(!1),e}(),i=s.matches[s.matches.length-1];return i.route.id||c(!1),i.route.id}const pe={};function fe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}i.startTransition;function me(e){let{to:s,replace:i,state:n,relative:r}=e;J()||c(!1);let{future:a,static:o}=t.useContext(G),{matches:l}=t.useContext(K),{pathname:d}=Q(),h=ee(),u=L(s,I(l,a.v7_relativeSplatPath),d,"path"===r),p=JSON.stringify(u);return t.useEffect((()=>h(JSON.parse(p),{replace:i,state:n,relative:r})),[h,p,r,i,n]),null}function ge(e){c(!1)}function ve(s){let{basename:i="/",children:n=null,location:r,navigationType:a=e.Pop,navigator:o,static:l=!1,future:d}=s;J()&&c(!1);let h=i.replace(/^\/*/,"/"),u=t.useMemo((()=>({basename:h,navigator:o,static:l,future:V({v7_relativeSplatPath:!1},d)})),[h,d,o,l]);"string"===typeof r&&(r=f(r));let{pathname:p="/",search:m="",hash:g="",state:v=null,key:b="default"}=r,y=t.useMemo((()=>{let e=P(p,h);return null==e?null:{location:{pathname:e,search:m,hash:g,state:v,key:b},navigationType:a}}),[h,p,m,g,v,b,a]);return null==y?null:t.createElement(G.Provider,{value:u},t.createElement(Y.Provider,{children:n,value:y}))}function be(e){let{children:t,location:s}=e;return se(ye(t),s)}new Promise((()=>{}));t.Component;function ye(e,s){void 0===s&&(s=[]);let i=[];return t.Children.forEach(e,((e,n)=>{if(!t.isValidElement(e))return;let r=[...s,n];if(e.type===t.Fragment)return void i.push.apply(i,ye(e.props.children,r));e.type!==ge&&c(!1),e.props.index&&e.props.children&&c(!1);let a={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=ye(e.props.children,r)),i.push(a)})),i}function xe(){return xe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},xe.apply(this,arguments)}function we(e,t){if(null==e)return{};var s,i,n={},r=Object.keys(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||(n[s]=e[s]);return n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const _e=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(yv){}new Map;const Se=i.startTransition;a.flushSync,i.useId;function ke(e){let{basename:s,children:i,future:n,window:r}=e,a=t.useRef();null==a.current&&(a.current=function(e){return void 0===e&&(e={}),m((function(e,t){let{pathname:s,search:i,hash:n}=e.location;return u("",{pathname:s,search:i,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:p(t)}),null,e)}({window:r,v5Compat:!0}));let o=a.current,[l,c]=t.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},h=t.useCallback((e=>{d&&Se?Se((()=>c(e))):c(e)}),[c,d]);return t.useLayoutEffect((()=>o.listen(h)),[o,h]),t.useEffect((()=>fe(n)),[n]),t.createElement(ve,{basename:s,children:i,location:l.location,navigationType:l.action,navigator:o,future:n})}const Ae="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ce=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ee=t.forwardRef((function(e,s){let i,{onClick:n,relative:r,reloadDocument:a,replace:o,state:l,target:d,to:h,preventScrollReset:u,viewTransition:f}=e,m=we(e,_e),{basename:g}=t.useContext(G),v=!1;if("string"===typeof h&&Ce.test(h)&&(i=h,Ae))try{let e=new URL(window.location.href),t=h.startsWith("//")?new URL(e.protocol+h):new URL(h),s=P(t.pathname,g);t.origin===e.origin&&null!=s?h=s+t.search+t.hash:v=!0}catch(yv){}let b=function(e,s){let{relative:i}=void 0===s?{}:s;J()||c(!1);let{basename:n,navigator:r}=t.useContext(G),{hash:a,pathname:o,search:l}=te(e,{relative:i}),d=o;return"/"!==n&&(d="/"===o?n:O([n,o])),r.createHref({pathname:d,search:l,hash:a})}(h,{relative:r}),y=function(e,s){let{target:i,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:l}=void 0===s?{}:s,c=ee(),d=Q(),h=te(e,{relative:o});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,i)){t.preventDefault();let s=void 0!==n?n:p(d)===p(h);c(e,{replace:s,state:r,preventScrollReset:a,relative:o,viewTransition:l})}}),[d,c,h,n,r,i,e,a,o,l])}(h,{replace:o,state:l,target:d,preventScrollReset:u,relative:r,viewTransition:f});return t.createElement("a",xe({},m,{href:i||b,onClick:v||a?n:function(e){n&&n(e),e.defaultPrevented||y(e)},ref:s,target:d}))}));var Ne,je;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ne||(Ne={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(je||(je={}));var Te=s(95);const Me=(0,Te.createClient)("https://aqdzmfhakqdwquszaqle.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ");var Pe=s(579);const Re=(0,t.createContext)();function De(){return(0,t.useContext)(Re)}function Ie(e){let{children:s}=e;const[i,n]=(0,t.useState)(null),[r,a]=(0,t.useState)(!0);(0,t.useEffect)((()=>{Me.auth.getSession().then((e=>{var t;let{data:{session:s}}=e;n(null!==(t=null===s||void 0===s?void 0:s.user)&&void 0!==t?t:null),a(!1)}));const{data:{subscription:e}}=Me.auth.onAuthStateChange(((e,t)=>{var s;n(null!==(s=null===t||void 0===t?void 0:t.user)&&void 0!==s?s:null),a(!1)}));return()=>e.unsubscribe()}),[]);const o={user:i,loading:r,signUp:e=>Me.auth.signUp(e),signIn:e=>Me.auth.signInWithPassword(e),signOut:()=>Me.auth.signOut()};return(0,Pe.jsx)(Re.Provider,{value:o,children:!r&&s})}function Le(){const e=document.querySelectorAll(".menu-item"),t=document.querySelector(".overlay");e.forEach((e=>{e.addEventListener("click",(s=>{s.preventDefault();const i=e.querySelector(".sub-menu");i&&(i.classList.toggle("active"),e.classList.toggle("active"),t&&t.classList.toggle("active"),document.body.style.overflow=i.classList.contains("active")?"hidden":"")}))})),t&&t.addEventListener("click",Oe)}function Oe(){const e=document.querySelectorAll(".menu-item"),t=document.querySelector(".overlay");e.forEach((e=>{e.classList.remove("active");const t=e.querySelector(".sub-menu");t&&t.classList.remove("active")})),t&&t.classList.remove("active"),document.body.style.overflow=""}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("health-overview");e&&e.addEventListener("click",(()=>{window.location.href="view-reports.html"}))}));const Fe=()=>{const e=ee(),[s,i]=(0,t.useState)(!1);(0,t.useEffect)((()=>{Le(),n()}),[]);const n=async()=>{try{var e;const{data:{user:t}}=await Me.auth.getUser();t&&"admin"===(null===(e=t.user_metadata)||void 0===e?void 0:e.role)&&i(!0)}catch(t){console.error("Error checking user role:",t)}},r=t=>{t.preventDefault();switch(t.currentTarget.id){case"health-overview":e("/health-overview");break;case"medical-history":e("/medical-history");break;case"chronic-disease-management":e("/chronic-disease-management");break;case"vaccination-history":e("/vaccination-history");break;case"health-analytics":e("/health-analytics");break;case"medication-tracker":e("/medication-tracker");break;case"profile-settings":e("/profile");break;case"upcoming-appointments":e("/appointments/upcoming");break;case"appointment-history":e("/appointments/history");break;case"telehealth-consultations":e("/appointments/telehealth");break;case"appointment-reminders":e("/appointments/reminders");break;case"help-center":e("/help-center");break;case"contact-support":e("/support/contact");break;case"live-chat":e("/support/chat");break;case"security-settings":e("/settings/security");break;case"data-backup":e("/settings/backup");break;case"database-setup":e("/admin/database-setup");break;case"logout-div":a()}},a=async()=>{try{const{error:t}=await Me.auth.signOut();if(t)throw t;e("/")}catch(t){console.error("Error logging out:",t.message)}};return(0,Pe.jsxs)("nav",{id:"menu",children:[(0,Pe.jsx)("div",{className:"logo",children:(0,Pe.jsx)(Ee,{to:"/dashboard",children:(0,Pe.jsx)("img",{src:"/DiGiHealthAdv/favicon_io/android-chrome-512x512-Photoroom.png",alt:"Logo",className:"logo"})})}),(0,Pe.jsxs)("div",{className:"menu-item",children:[(0,Pe.jsx)("div",{className:"menu-text",children:(0,Pe.jsx)("a",{href:"#","data-link":!0,children:"Your Journey"})}),(0,Pe.jsxs)("div",{className:"sub-menu triple",children:[(0,Pe.jsxs)("div",{className:"icon-box",id:"health-overview",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-hospital-user"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Health Overview"}),(0,Pe.jsx)("div",{className:"sub-text",children:"See, add and update your Journey"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"medical-history",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-timeline"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Medical History"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Through your Journey"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"chronic-disease-management",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-diagnoses"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Chronic Disease Management"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Manage your chronic conditions"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"vaccination-history",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-syringe"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Vaccination History"}),(0,Pe.jsx)("div",{className:"sub-text",children:"View and manage vaccinations"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"medication-tracker",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-pills"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Medication Tracker"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Track prescribed medications"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"health-analytics",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-chart-line"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Health Analytics"}),(0,Pe.jsx)("div",{className:"sub-text",children:"View your health trends"})]})]})]})]}),(0,Pe.jsxs)("div",{className:"menu-item",children:[(0,Pe.jsx)("div",{className:"menu-text",children:(0,Pe.jsx)("a",{href:"#","data-link":!0,children:"Appointments"})}),(0,Pe.jsxs)("div",{className:"sub-menu double",children:[(0,Pe.jsxs)("div",{className:"icon-box",id:"upcoming-appointments",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-calendar-check"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Upcoming Appointments"}),(0,Pe.jsx)("div",{className:"sub-text",children:"View and manage appointments"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"appointment-history",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-history"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Appointment History"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Check past appointments"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"telehealth-consultations",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-phone-alt"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Telehealth Consultations"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Book virtual appointments"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"appointment-reminders",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-clock"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Appointment Reminders"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Set and manage reminders"})]})]})]})]}),(0,Pe.jsxs)("div",{className:"menu-item",children:[(0,Pe.jsx)("div",{className:"menu-text",children:(0,Pe.jsx)("a",{href:"#","data-link":!0,children:"Support"})}),(0,Pe.jsxs)("div",{className:"sub-menu double",children:[(0,Pe.jsxs)("div",{className:"icon-box",id:"help-center",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-book"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Help Center"}),(0,Pe.jsx)("div",{className:"sub-text",children:"FAQs and tutorials"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"contact-support",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-life-ring"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Contact Support"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Reach out to our team"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"live-chat",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-comment-dots"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Live Chat"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Chat with support agents"})]})]})]})]}),(0,Pe.jsxs)("div",{className:"menu-item",children:[(0,Pe.jsx)("div",{className:"menu-text",children:(0,Pe.jsx)("a",{href:"#","data-link":!0,children:"Account"})}),(0,Pe.jsxs)("div",{className:"sub-menu double",children:[(0,Pe.jsxs)("div",{className:"icon-box",id:"profile-settings",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-user-cog"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Profile Settings"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Edit your personal details"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"security-settings",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-lock"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Security Settings"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Manage passwords and 2FA"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"data-backup",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-download"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Data Backup & Export"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Backup and download your data"})]})]}),s&&(0,Pe.jsxs)("div",{className:"icon-box",id:"database-setup",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa fa-database"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Database Setup"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Reset and setup database tables"})]})]}),(0,Pe.jsxs)("div",{className:"icon-box",id:"logout-div",onClick:r,children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)("i",{className:"fa-solid fa-arrow-right-from-bracket"})}),(0,Pe.jsxs)("div",{className:"text",children:[(0,Pe.jsx)("div",{className:"title",children:"Logout"}),(0,Pe.jsx)("div",{className:"sub-text",children:"Logout your account"})]})]})]})]})]})},ze=()=>(0,Pe.jsx)("footer",{style:{position:"relative",backgroundImage:"linear-gradient(0deg, #2AF598 0%, #08AEEA 100%)",width:"100%",textAlign:"center",padding:"1rem",marginTop:"auto",color:"#fff"},children:(0,Pe.jsxs)("p",{children:["\xa9 ",(new Date).getFullYear()," DiGiHealth. All rights reserved."]})}),Be=e=>{let{children:t}=e;return(0,Pe.jsxs)("div",{className:"dashboard-layout",children:[(0,Pe.jsx)(Fe,{}),(0,Pe.jsx)("main",{children:t}),(0,Pe.jsx)(ze,{})]})},$e=(0,Te.createClient)("https://aqdzmfhakqdwquszaqle.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ"),He=()=>{const[e,s]=(0,t.useState)(!1),[i,n]=(0,t.useState)(null),[r,a]=(0,t.useState)(""),[o,l]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[h,u]=(0,t.useState)(""),[p,f]=(0,t.useState)(""),[m,g]=(0,t.useState)(""),[v,b]=(0,t.useState)(""),y=ee(),x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";console.log(`Notification: ${e}, Type: ${t}`),n({message:e,type:t}),setTimeout((()=>n(null)),3e3)};return(0,Pe.jsxs)("div",{id:"app",children:[(0,Pe.jsx)("header",{children:(0,Pe.jsx)("img",{src:"/DiGiHealthAdv/favicon_io/android-chrome-512x512-Photoroom.png",alt:"Logo",className:"logo",style:{width:"250px",height:"100%"}})}),i&&(0,Pe.jsx)("div",{className:`alert alert-${i.type} alert-dismissible fade show`,role:"alert",children:i.message}),(0,Pe.jsx)("div",{id:"login-signup",children:e?(0,Pe.jsx)("div",{id:"signup-form",children:(0,Pe.jsxs)("form",{className:"form",onSubmit:async e=>{if(e.preventDefault(),m===v)try{const{data:e,error:t}=await $e.auth.signUp({email:p,password:m,options:{data:{first_name:c,last_name:h}}});if(t)throw t;if(e.user){const{error:t}=await $e.from("profiles").insert([{id:e.user.id,first_name:c,last_name:h,email:p}]);if(t)throw t}x("Account created successfully!","success"),y("/dashboard")}catch(t){console.error("Signup error:",t.message),x(t.message,"danger")}else x("Passwords don't match","error")},children:[(0,Pe.jsx)("p",{className:"message",children:"Signup now"}),(0,Pe.jsxs)("div",{className:"flex",children:[(0,Pe.jsxs)("label",{children:[(0,Pe.jsx)("input",{required:!0,name:"firstname",type:"text",className:"input",placeholder:" ",value:c,onChange:e=>d(e.target.value)}),(0,Pe.jsx)("span",{children:"Firstname"})]}),(0,Pe.jsxs)("label",{children:[(0,Pe.jsx)("input",{required:!0,name:"lastname",type:"text",className:"input",placeholder:" ",value:h,onChange:e=>u(e.target.value)}),(0,Pe.jsx)("span",{children:"Lastname"})]})]}),(0,Pe.jsxs)("label",{children:[(0,Pe.jsx)("input",{required:!0,name:"email",type:"email",className:"input",id:"signup-email",placeholder:" ",value:p,onChange:e=>f(e.target.value)}),(0,Pe.jsx)("span",{children:"Email"})]}),(0,Pe.jsxs)("label",{children:[(0,Pe.jsx)("input",{required:!0,name:"password",type:"password",className:"input",id:"signup-password",placeholder:" ",value:m,onChange:e=>g(e.target.value)}),(0,Pe.jsx)("span",{children:"Password"})]}),(0,Pe.jsxs)("label",{children:[(0,Pe.jsx)("input",{required:!0,name:"confirmPassword",type:"password",className:"input",placeholder:" ",value:v,onChange:e=>b(e.target.value)}),(0,Pe.jsx)("span",{children:"Confirm password"})]}),(0,Pe.jsx)("button",{type:"submit",className:"submit",children:"Submit"}),(0,Pe.jsxs)("p",{className:"signin",children:["Already have an account?"," ",(0,Pe.jsx)("a",{href:"/",onClick:()=>s(!1),children:"Signin"})]})]})}):(0,Pe.jsxs)("div",{id:"login-form",children:[(0,Pe.jsx)("h2",{children:"Login"}),(0,Pe.jsxs)("form",{className:"form1",onSubmit:async e=>{e.preventDefault();try{const{error:e}=await $e.auth.signInWithPassword({email:r,password:o});if(e)throw e;x("Login successful!","success"),setTimeout((()=>{y("/dashboard")}),3e3)}catch(t){console.error("Login error:",t.message),x(t.message,"danger")}},children:[(0,Pe.jsxs)("label",{children:[(0,Pe.jsx)("input",{required:!0,name:"email",type:"email",className:"input",id:"login-email",autoComplete:"new-password",value:r,onChange:e=>a(e.target.value)}),(0,Pe.jsx)("span",{children:"Email"})]}),(0,Pe.jsxs)("label",{children:[(0,Pe.jsx)("input",{required:!0,name:"password",type:"password",className:"input",id:"login-password",autoComplete:"login-password",value:o,onChange:e=>l(e.target.value)}),(0,Pe.jsx)("span",{children:"Password"})]}),(0,Pe.jsxs)("div",{children:[(0,Pe.jsx)("button",{type:"submit",id:"login-button",children:"Login"}),(0,Pe.jsx)("button",{type:"button",onClick:()=>s(!0),children:"Sign Up"})]})]})]})})]})};var Ue={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Ve=t.createContext&&t.createContext(Ue),We=["attr","size","title"];function qe(e,t){if(null==e)return{};var s,i,n=function(e,t){if(null==e)return{};var s={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;s[i]=e[i]}return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)s=r[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function Ge(){return Ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(e[i]=s[i])}return e},Ge.apply(this,arguments)}function Ye(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function Ke(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(s),!0).forEach((function(t){Xe(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ye(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function Xe(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var i=s.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Je(e){return e&&e.map(((e,s)=>t.createElement(e.tag,Ke({key:s},e.attr),Je(e.child))))}function Qe(e){return s=>t.createElement(Ze,Ge({attr:Ke({},e.attr)},s),Je(e.child))}function Ze(e){var s=s=>{var i,{attr:n,size:r,title:a}=e,o=qe(e,We),l=r||s.size||"1em";return s.className&&(i=s.className),e.className&&(i=(i?i+" ":"")+e.className),t.createElement("svg",Ge({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,n,o,{className:i,style:Ke(Ke({color:e.color||s.color},s.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&t.createElement("title",null,a),e.children)};return void 0!==Ve?t.createElement(Ve.Consumer,null,(e=>s(e))):s(Ue)}function et(e){return Qe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 352h-16V243.9c0-12.7-5.1-24.9-14.1-33.9L494 110.1c-9-9-21.2-14.1-33.9-14.1H416V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h16c0 53 43 96 96 96s96-43 96-96h128c0 53 43 96 96 96s96-43 96-96h48c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zM160 464c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm144-248c0 4.4-3.6 8-8 8h-56v56c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-56h-56c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h56v-56c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v56h56c4.4 0 8 3.6 8 8v48zm176 248c-26.5 0-48-21.5-48-48s21.5-48 48-48 48 21.5 48 48-21.5 48-48 48zm80-208H416V144h44.1l99.9 99.9V256z"},child:[]}]})(e)}function tt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(e)}function st(e){return Qe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M598.88 244.56c25.2-12.6 41.12-38.36 41.12-66.53v-7.64C640 129.3 606.7 96 565.61 96c-32.02 0-60.44 20.49-70.57 50.86-7.68 23.03-11.6 45.14-38.11 45.14H183.06c-27.38 0-31.58-25.54-38.11-45.14C134.83 116.49 106.4 96 74.39 96 33.3 96 0 129.3 0 170.39v7.64c0 28.17 15.92 53.93 41.12 66.53 9.43 4.71 9.43 18.17 0 22.88C15.92 280.04 0 305.8 0 333.97v7.64C0 382.7 33.3 416 74.38 416c32.02 0 60.44-20.49 70.57-50.86 7.68-23.03 11.6-45.14 38.11-45.14h273.87c27.38 0 31.58 25.54 38.11 45.14C505.17 395.51 533.6 416 565.61 416c41.08 0 74.38-33.3 74.38-74.39v-7.64c0-28.18-15.92-53.93-41.12-66.53-9.42-4.71-9.42-18.17.01-22.88z"},child:[]}]})(e)}function it(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"},child:[]}]})(e)}function nt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function rt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M436 160H12c-6.627 0-12-5.373-12-12v-36c0-26.51 21.49-48 48-48h48V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h128V12c0-6.627 5.373-12 12-12h40c6.627 0 12 5.373 12 12v52h48c26.51 0 48 21.49 48 48v36c0 6.627-5.373 12-12 12zM12 192h424c6.627 0 12 5.373 12 12v260c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V204c0-6.627 5.373-12 12-12zm333.296 95.947l-28.169-28.398c-4.667-4.705-12.265-4.736-16.97-.068L194.12 364.665l-45.98-46.352c-4.667-4.705-12.266-4.736-16.971-.068l-28.397 28.17c-4.705 4.667-4.736 12.265-.068 16.97l82.601 83.269c4.667 4.705 12.265 4.736 16.97.068l142.953-141.805c4.705-4.667 4.736-12.265.068-16.97z"},child:[]}]})(e)}function at(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"},child:[]}]})(e)}function ot(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function lt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(e)}function ct(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"},child:[]}]})(e)}function dt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(e)}function ht(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"},child:[]}]})(e)}function ut(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"},child:[]}]})(e)}function pt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M496 256c8.8 0 16-7.2 16-16s-7.2-16-16-16-16 7.2-16 16 7.2 16 16 16zm-176-80c48.5 0 88-39.5 88-88S368.5 0 320 0s-88 39.5-88 88 39.5 88 88 88zM59.8 364c10.2 15.3 29.3 17.8 42.9 9.8 16.2-9.6 56.2-31.7 105.3-48.6V416h224v-90.7c49.1 16.8 89.1 39 105.3 48.6 13.6 8 32.7 5.3 42.9-9.8l17.8-26.7c8.8-13.2 7.6-34.6-10-45.1-11.9-7.1-29.7-17-51.1-27.4-28.1 46.1-99.4 17.8-87.7-35.1C409.3 217.2 365.1 208 320 208c-57 0-112.9 14.5-160 32.2-.2 40.2-47.6 63.3-79.2 36-11.2 6-21.3 11.6-28.7 16-17.6 10.5-18.8 31.8-10 45.1L59.8 364zM368 344c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm-96-96c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm-160 8c8.8 0 16-7.2 16-16s-7.2-16-16-16-16 7.2-16 16 7.2 16 16 16zm512 192H16c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h608c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16z"},child:[]}]})(e)}function ft(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function mt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function gt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function vt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function bt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function yt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm76.45 211.36l-96.42 95.7c-6.65 6.61-17.39 6.61-24.04 0l-96.42-95.7C73.42 337.29 80.54 320 94.82 320H160v-80c0-8.84 7.16-16 16-16h32c8.84 0 16 7.16 16 16v80h65.18c14.28 0 21.4 17.29 11.27 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"},child:[]}]})(e)}function xt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 160v48c0 4.4-3.6 8-8 8h-56v56c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8v-56h-56c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h56v-56c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v56h56c4.4 0 8 3.6 8 8z"},child:[]}]})(e)}function wt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function _t(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z"},child:[]}]})(e)}function St(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M320.2 243.8l-49.7 99.4c-6 12.1-23.4 11.7-28.9-.6l-56.9-126.3-30 71.7H60.6l182.5 186.5c7.1 7.3 18.6 7.3 25.7 0L451.4 288H342.3l-22.1-44.2zM473.7 73.9l-2.4-2.5c-51.5-52.6-135.8-52.6-187.4 0L256 100l-27.9-28.5c-51.5-52.7-135.9-52.7-187.4 0l-2.4 2.4C-10.4 123.7-12.5 203 31 256h102.4l35.9-86.2c5.4-12.9 23.6-13.2 29.4-.4l58.2 129.3 49-97.9c5.9-11.8 22.7-11.8 28.6 0l27.6 55.2H481c43.5-53 41.4-132.3-7.3-182.1z"},child:[]}]})(e)}function kt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(e)}function At(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function Ct(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 176.001C512 273.203 433.202 352 336 352c-11.22 0-22.19-1.062-32.827-3.069l-24.012 27.014A23.999 23.999 0 0 1 261.223 384H224v40c0 13.255-10.745 24-24 24h-40v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24v-78.059c0-6.365 2.529-12.47 7.029-16.971l161.802-161.802C163.108 213.814 160 195.271 160 176 160 78.798 238.797.001 335.999 0 433.488-.001 512 78.511 512 176.001zM336 128c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z"},child:[]}]})(e)}function Et(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm173.696 119.559l-63.399 63.399c-10.987-18.559-26.67-34.252-45.255-45.255l63.399-63.399a218.396 218.396 0 0 1 45.255 45.255zM256 352c-53.019 0-96-42.981-96-96s42.981-96 96-96 96 42.981 96 96-42.981 96-96 96zM127.559 82.304l63.399 63.399c-18.559 10.987-34.252 26.67-45.255 45.255l-63.399-63.399a218.372 218.372 0 0 1 45.255-45.255zM82.304 384.441l63.399-63.399c10.987 18.559 26.67 34.252 45.255 45.255l-63.399 63.399a218.396 218.396 0 0 1-45.255-45.255zm302.137 45.255l-63.399-63.399c18.559-10.987 34.252-26.67 45.255-45.255l63.399 63.399a218.403 218.403 0 0 1-45.255 45.255z"},child:[]}]})(e)}function Nt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"},child:[]}]})(e)}function jt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"},child:[]}]})(e)}function Tt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(e)}function Mt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M636.11 390.15C614.44 308.85 580.07 231 534.1 159.13 511.98 124.56 498.03 96 454.05 96 415.36 96 384 125.42 384 161.71v60.11l-32.88-21.92a15.996 15.996 0 0 1-7.12-13.31V16c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v170.59c0 5.35-2.67 10.34-7.12 13.31L256 221.82v-60.11C256 125.42 224.64 96 185.95 96c-43.98 0-57.93 28.56-80.05 63.13C59.93 231 25.56 308.85 3.89 390.15 1.3 399.84 0 409.79 0 419.78c0 61.23 62.48 105.44 125.24 88.62l59.5-15.95c42.18-11.3 71.26-47.47 71.26-88.62v-87.49l-85.84 57.23a7.992 7.992 0 0 1-11.09-2.22l-8.88-13.31a7.992 7.992 0 0 1 2.22-11.09L320 235.23l167.59 111.72a7.994 7.994 0 0 1 2.22 11.09l-8.88 13.31a7.994 7.994 0 0 1-11.09 2.22L384 316.34v87.49c0 41.15 29.08 77.31 71.26 88.62l59.5 15.95C577.52 525.22 640 481.01 640 419.78c0-9.99-1.3-19.94-3.89-29.63z"},child:[]}]})(e)}function Pt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(e)}function Rt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(e)}function Dt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(e)}function It(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M112 32C50.1 32 0 82.1 0 144v224c0 61.9 50.1 112 112 112s112-50.1 112-112V144c0-61.9-50.1-112-112-112zm48 224H64V144c0-26.5 21.5-48 48-48s48 21.5 48 48v112zm139.7-29.7c-3.5-3.5-9.4-3.1-12.3.8-45.3 62.5-40.4 150.1 15.9 206.4 56.3 56.3 143.9 61.2 206.4 15.9 4-2.9 4.3-8.8.8-12.3L299.7 226.3zm229.8-19c-56.3-56.3-143.9-61.2-206.4-15.9-4 2.9-4.3 8.8-.8 12.3l210.8 210.8c3.5 3.5 9.4 3.1 12.3-.8 45.3-62.6 40.5-150.1-15.9-206.4z"},child:[]}]})(e)}function Lt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Ot(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 224h192V32H0v192zM64 96h64v64H64V96zm192-64v192h192V32H256zm128 128h-64V96h64v64zM0 480h192V288H0v192zm64-128h64v64H64v-64zm352-64h32v128h-96v-32h-32v96h-64V288h96v32h64v-32zm0 160h32v32h-32v-32zm-64 0h32v32h-32v-32z"},child:[]}]})(e)}function Ft(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zM262.655 90c-54.497 0-89.255 22.957-116.549 63.758-3.536 5.286-2.353 12.415 2.715 16.258l34.699 26.31c5.205 3.947 12.621 3.008 16.665-2.122 17.864-22.658 30.113-35.797 57.303-35.797 20.429 0 45.698 13.148 45.698 32.958 0 14.976-12.363 22.667-32.534 33.976C247.128 238.528 216 254.941 216 296v4c0 6.627 5.373 12 12 12h56c6.627 0 12-5.373 12-12v-1.333c0-28.462 83.186-29.647 83.186-106.667 0-58.002-60.165-102-116.531-102zM256 338c-25.365 0-46 20.635-46 46 0 25.364 20.635 46 46 46s46-20.636 46-46c0-25.365-20.635-46-46-46z"},child:[]}]})(e)}function zt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(e)}function Bt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z"},child:[]}]})(e)}function $t(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(e)}function Ht(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M447.1 112c-34.2.5-62.3 28.4-63 62.6-.5 24.3 12.5 45.6 32 56.8V344c0 57.3-50.2 104-112 104-60 0-109.2-44.1-111.9-99.2C265 333.8 320 269.2 320 192V36.6c0-11.4-8.1-21.3-19.3-23.5L237.8.5c-13-2.6-25.6 5.8-28.2 18.8L206.4 35c-2.6 13 5.8 25.6 18.8 28.2l30.7 6.1v121.4c0 52.9-42.2 96.7-95.1 97.2-53.4.5-96.9-42.7-96.9-96V69.4l30.7-6.1c13-2.6 21.4-15.2 18.8-28.2l-3.1-15.7C107.7 6.4 95.1-2 82.1.6L19.3 13C8.1 15.3 0 25.1 0 36.6V192c0 77.3 55.1 142 128.1 156.8C130.7 439.2 208.6 512 304 512c97 0 176-75.4 176-168V231.4c19.1-11.1 32-31.7 32-55.4 0-35.7-29.2-64.5-64.9-64zm.9 80c-8.8 0-16-7.2-16-16s7.2-16 16-16 16 7.2 16 16-7.2 16-16 16z"},child:[]}]})(e)}function Ut(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M201.5 174.8l55.7 55.8c3.1 3.1 3.1 8.2 0 11.3l-11.3 11.3c-3.1 3.1-8.2 3.1-11.3 0l-55.7-55.8-45.3 45.3 55.8 55.8c3.1 3.1 3.1 8.2 0 11.3l-11.3 11.3c-3.1 3.1-8.2 3.1-11.3 0L111 265.2l-26.4 26.4c-17.3 17.3-25.6 41.1-23 65.4l7.1 63.6L2.3 487c-3.1 3.1-3.1 8.2 0 11.3l11.3 11.3c3.1 3.1 8.2 3.1 11.3 0l66.3-66.3 63.6 7.1c23.9 2.6 47.9-5.4 65.4-23l181.9-181.9-135.7-135.7-64.9 65zm308.2-93.3L430.5 2.3c-3.1-3.1-8.2-3.1-11.3 0l-11.3 11.3c-3.1 3.1-3.1 8.2 0 11.3l28.3 28.3-45.3 45.3-56.6-56.6-17-17c-3.1-3.1-8.2-3.1-11.3 0l-33.9 33.9c-3.1 3.1-3.1 8.2 0 11.3l17 17L424.8 223l17 17c3.1 3.1 8.2 3.1 11.3 0l33.9-34c3.1-3.1 3.1-8.2 0-11.3l-73.5-73.5 45.3-45.3 28.3 28.3c3.1 3.1 8.2 3.1 11.3 0l11.3-11.3c3.1-3.2 3.1-8.2 0-11.4z"},child:[]}]})(e)}function Vt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64v-96h160v96zm0-160H64v-96h160v96zm224 160H288v-96h160v96zm0-160H288v-96h160v96z"},child:[]}]})(e)}function Wt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function qt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M205.22 22.09c-7.94-28.78-49.44-30.12-58.44 0C100.01 179.85 0 222.72 0 333.91 0 432.35 78.72 512 176 512s176-79.65 176-178.09c0-111.75-99.79-153.34-146.78-311.82zM176 448c-61.75 0-112-50.25-112-112 0-8.84 7.16-16 16-16s16 7.16 16 16c0 44.11 35.89 80 80 80 8.84 0 16 7.16 16 16s-7.16 16-16 16z"},child:[]}]})(e)}function Gt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 64H192C85.961 64 0 149.961 0 256s85.961 192 192 192h192c106.039 0 192-85.961 192-192S490.039 64 384 64zM64 256c0-70.741 57.249-128 128-128 70.741 0 128 57.249 128 128 0 70.741-57.249 128-128 128-70.741 0-128-57.249-128-128zm320 128h-48.905c65.217-72.858 65.236-183.12 0-256H384c70.741 0 128 57.249 128 128 0 70.74-57.249 128-128 128z"},child:[]}]})(e)}function Yt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M384 64H192C86 64 0 150 0 256s86 192 192 192h192c106 0 192-86 192-192S490 64 384 64zm0 320c-70.8 0-128-57.3-128-128 0-70.8 57.3-128 128-128 70.8 0 128 57.3 128 128 0 70.8-57.3 128-128 128z"},child:[]}]})(e)}function Kt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function Xt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 384h-80c-13.3 0-24-10.7-24-24V192h-87.7c-17.8 0-26.7-21.5-14.1-34.1L242.3 5.7c7.5-7.5 19.8-7.5 27.3 0l152.2 152.2c12.6 12.6 3.7 34.1-14.1 34.1H320v168c0 13.3-10.7 24-24 24zm216-8v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h136v8c0 30.9 25.1 56 56 56h80c30.9 0 56-25.1 56-56v-8h136c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function Jt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M224 256A128 128 0 1 0 96 128a128 128 0 0 0 128 128zm96 64a63.08 63.08 0 0 1 8.1-30.5c-4.8-.5-9.5-1.5-14.5-1.5h-16.7a174.08 174.08 0 0 1-145.8 0h-16.7A134.43 134.43 0 0 0 0 422.4V464a48 48 0 0 0 48 48h280.9a63.54 63.54 0 0 1-8.9-32zm288-32h-32v-80a80 80 0 0 0-160 0v80h-32a32 32 0 0 0-32 32v160a32 32 0 0 0 32 32h224a32 32 0 0 0 32-32V320a32 32 0 0 0-32-32zM496 432a32 32 0 1 1 32-32 32 32 0 0 1-32 32zm32-144h-64v-80a32 32 0 0 1 64 0z"},child:[]}]})(e)}function Qt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zM104 424c0 13.3 10.7 24 24 24s24-10.7 24-24-10.7-24-24-24-24 10.7-24 24zm216-135.4v49c36.5 7.4 64 39.8 64 78.4v41.7c0 7.6-5.4 14.2-12.9 15.7l-32.2 6.4c-4.3.9-8.5-1.9-9.4-6.3l-3.1-15.7c-.9-4.3 1.9-8.6 6.3-9.4l19.3-3.9V416c0-62.8-96-65.1-96 1.9v26.7l19.3 3.9c4.3.9 7.1 5.1 6.3 9.4l-3.1 15.7c-.9 4.3-5.1 7.1-9.4 6.3l-31.2-4.2c-7.9-1.1-13.8-7.8-13.8-15.9V416c0-38.6 27.5-70.9 64-78.4v-45.2c-2.2.7-4.4 1.1-6.6 1.9-18 6.3-37.3 9.8-57.4 9.8s-39.4-3.5-57.4-9.8c-7.4-2.6-14.9-4.2-22.6-5.2v81.6c23.1 6.9 40 28.1 40 53.4 0 30.9-25.1 56-56 56s-56-25.1-56-56c0-25.3 16.9-46.5 40-53.4v-80.4C48.5 301 0 355.8 0 422.4v44.8C0 491.9 20.1 512 44.8 512h358.4c24.7 0 44.8-20.1 44.8-44.8v-44.8c0-72-56.8-130.3-128-133.8z"},child:[]}]})(e)}function Zt(e){return Qe({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function es(e){return Qe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z"},child:[]}]})(e)}function ts(e){return Qe({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M448 64h-25.98C438.44 92.28 448 125.01 448 160c0 105.87-86.13 192-192 192S64 265.87 64 160c0-34.99 9.56-67.72 25.98-96H64C28.71 64 0 92.71 0 128v320c0 35.29 28.71 64 64 64h384c35.29 0 64-28.71 64-64V128c0-35.29-28.71-64-64-64zM256 320c88.37 0 160-71.63 160-160S344.37 0 256 0 96 71.63 96 160s71.63 160 160 160zm-.3-151.94l33.58-78.36c3.5-8.17 12.94-11.92 21.03-8.41 8.12 3.48 11.88 12.89 8.41 21l-33.67 78.55C291.73 188 296 197.45 296 208c0 22.09-17.91 40-40 40s-40-17.91-40-40c0-21.98 17.76-39.77 39.7-39.94z"},child:[]}]})(e)}const ss=()=>{const e=ee(),[s,i]=(0,t.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",role:"patient"}),[n,r]=(0,t.useState)(null),[a,o]=(0,t.useState)(!1),l=e=>{i({...s,[e.target.name]:e.target.value})};return(0,Pe.jsx)("div",{className:"container mt-5",children:(0,Pe.jsx)("div",{className:"row justify-content-center",children:(0,Pe.jsx)("div",{className:"col-md-6",children:(0,Pe.jsx)("div",{className:"card shadow",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsx)("h2",{className:"text-center mb-4",children:"Register"}),n&&(0,Pe.jsx)("div",{className:"alert alert-danger",role:"alert",children:n}),(0,Pe.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),r(null),o(!0),s.password!==s.confirmPassword)return r("Passwords do not match"),void o(!1);try{const{data:t,error:i}=await Me.auth.signUp({email:s.email,password:s.password,options:{data:{first_name:s.firstName,last_name:s.lastName,role:s.role}}});if(i)throw i;if(t.user){const{error:e}=await Me.from("detailed_profiles").insert([{id:t.user.id,first_name:s.firstName,last_name:s.lastName,email:s.email,created_at:(new Date).toISOString()}]);if(e)throw e;const{error:i}=await Me.from("profiles").insert([{id:t.user.id,full_name:`${s.firstName} ${s.lastName}`,email:s.email,role:s.role,created_at:(new Date).toISOString()}]);if(i)throw i}e("/dashboard")}catch(n){r(n.message)}finally{o(!1)}},children:[(0,Pe.jsxs)("div",{className:"row mb-3",children:[(0,Pe.jsxs)("div",{className:"col-md-6",children:[(0,Pe.jsx)("label",{className:"form-label",children:"First Name"}),(0,Pe.jsxs)("div",{className:"input-group",children:[(0,Pe.jsx)("span",{className:"input-group-text",children:(0,Pe.jsx)(Zt,{})}),(0,Pe.jsx)("input",{type:"text",className:"form-control",name:"firstName",value:s.firstName,onChange:l,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"col-md-6",children:[(0,Pe.jsx)("label",{className:"form-label",children:"Last Name"}),(0,Pe.jsxs)("div",{className:"input-group",children:[(0,Pe.jsx)("span",{className:"input-group-text",children:(0,Pe.jsx)(Zt,{})}),(0,Pe.jsx)("input",{type:"text",className:"form-control",name:"lastName",value:s.lastName,onChange:l,required:!0})]})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{className:"form-label",children:"Email"}),(0,Pe.jsxs)("div",{className:"input-group",children:[(0,Pe.jsx)("span",{className:"input-group-text",children:(0,Pe.jsx)(gt,{})}),(0,Pe.jsx)("input",{type:"email",className:"form-control",name:"email",value:s.email,onChange:l,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{className:"form-label",children:"Password"}),(0,Pe.jsxs)("div",{className:"input-group",children:[(0,Pe.jsx)("span",{className:"input-group-text",children:(0,Pe.jsx)(Tt,{})}),(0,Pe.jsx)("input",{type:"password",className:"form-control",name:"password",value:s.password,onChange:l,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{className:"form-label",children:"Confirm Password"}),(0,Pe.jsxs)("div",{className:"input-group",children:[(0,Pe.jsx)("span",{className:"input-group-text",children:(0,Pe.jsx)(Tt,{})}),(0,Pe.jsx)("input",{type:"password",className:"form-control",name:"confirmPassword",value:s.confirmPassword,onChange:l,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{className:"form-label",children:"Role"}),(0,Pe.jsxs)("div",{className:"input-group",children:[(0,Pe.jsx)("span",{className:"input-group-text",children:(0,Pe.jsx)(Qt,{})}),(0,Pe.jsxs)("select",{className:"form-select",name:"role",value:s.role,onChange:l,children:[(0,Pe.jsx)("option",{value:"patient",children:"Patient"}),(0,Pe.jsx)("option",{value:"doctor",children:"Doctor"}),(0,Pe.jsx)("option",{value:"admin",children:"Admin"})]})]})]}),(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary w-100",disabled:a,children:a?"Registering...":"Register"})]}),(0,Pe.jsxs)("div",{className:"text-center mt-3",children:["Already have an account?"," ",(0,Pe.jsx)("a",{href:"/",className:"text-decoration-none",children:"Login"})]})]})})})})})},is=()=>(0,Pe.jsx)("div",{className:"spinner-overlay",children:(0,Pe.jsx)("div",{className:"loader"})});function ns(e){return e+.5|0}const rs=(e,t,s)=>Math.max(Math.min(e,s),t);function as(e){return rs(ns(2.55*e),0,255)}function os(e){return rs(ns(255*e),0,255)}function ls(e){return rs(ns(e/2.55)/100,0,1)}function cs(e){return rs(ns(100*e),0,100)}const ds={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},hs=[..."0123456789ABCDEF"],us=e=>hs[15&e],ps=e=>hs[(240&e)>>4]+hs[15&e],fs=e=>(240&e)>>4===(15&e);function ms(e){var t=(e=>fs(e.r)&&fs(e.g)&&fs(e.b)&&fs(e.a))(e)?us:ps;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const gs=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function vs(e,t,s){const i=t*Math.min(s,1-s),n=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return s-i*Math.max(Math.min(n-3,9-n,1),-1)};return[n(0),n(8),n(4)]}function bs(e,t,s){const i=function(i){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(i+e/60)%6;return s-s*t*Math.max(Math.min(n,4-n,1),0)};return[i(5),i(3),i(1)]}function ys(e,t,s){const i=vs(e,1,.5);let n;for(t+s>1&&(n=1/(t+s),t*=n,s*=n),n=0;n<3;n++)i[n]*=1-t-s,i[n]+=t;return i}function xs(e){const t=e.r/255,s=e.g/255,i=e.b/255,n=Math.max(t,s,i),r=Math.min(t,s,i),a=(n+r)/2;let o,l,c;return n!==r&&(c=n-r,l=a>.5?c/(2-n-r):c/(n+r),o=function(e,t,s,i,n){return e===n?(t-s)/i+(t<s?6:0):t===n?(s-e)/i+2:(e-t)/i+4}(t,s,i,c,n),o=60*o+.5),[0|o,l||0,a]}function ws(e,t,s,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,s,i)).map(os)}function _s(e,t,s){return ws(vs,e,t,s)}function Ss(e){return(e%360+360)%360}function ks(e){const t=gs.exec(e);let s,i=255;if(!t)return;t[5]!==s&&(i=t[6]?as(+t[5]):os(+t[5]));const n=Ss(+t[2]),r=+t[3]/100,a=+t[4]/100;return s="hwb"===t[1]?function(e,t,s){return ws(ys,e,t,s)}(n,r,a):"hsv"===t[1]?function(e,t,s){return ws(bs,e,t,s)}(n,r,a):_s(n,r,a),{r:s[0],g:s[1],b:s[2],a:i}}const As={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Cs={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Es;function Ns(e){Es||(Es=function(){const e={},t=Object.keys(Cs),s=Object.keys(As);let i,n,r,a,o;for(i=0;i<t.length;i++){for(a=o=t[i],n=0;n<s.length;n++)r=s[n],o=o.replace(r,As[r]);r=parseInt(Cs[a],16),e[o]=[r>>16&255,r>>8&255,255&r]}return e}(),Es.transparent=[0,0,0,0]);const t=Es[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const js=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const Ts=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,Ms=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Ps(e,t,s){if(e){let i=xs(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*s,0===t?360:1)),i=_s(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function Rs(e,t){return e?Object.assign(t||{},e):e}function Ds(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=os(e[3]))):(t=Rs(e,{r:0,g:0,b:0,a:1})).a=os(t.a),t}function Is(e){return"r"===e.charAt(0)?function(e){const t=js.exec(e);let s,i,n,r=255;if(t){if(t[7]!==s){const e=+t[7];r=t[8]?as(e):rs(255*e,0,255)}return s=+t[1],i=+t[3],n=+t[5],s=255&(t[2]?as(s):rs(s,0,255)),i=255&(t[4]?as(i):rs(i,0,255)),n=255&(t[6]?as(n):rs(n,0,255)),{r:s,g:i,b:n,a:r}}}(e):ks(e)}class Ls{constructor(e){if(e instanceof Ls)return e;const t=typeof e;let s;"object"===t?s=Ds(e):"string"===t&&(s=function(e){var t,s=e.length;return"#"===e[0]&&(4===s||5===s?t={r:255&17*ds[e[1]],g:255&17*ds[e[2]],b:255&17*ds[e[3]],a:5===s?17*ds[e[4]]:255}:7!==s&&9!==s||(t={r:ds[e[1]]<<4|ds[e[2]],g:ds[e[3]]<<4|ds[e[4]],b:ds[e[5]]<<4|ds[e[6]],a:9===s?ds[e[7]]<<4|ds[e[8]]:255})),t}(e)||Ns(e)||Is(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=Rs(this._rgb);return e&&(e.a=ls(e.a)),e}set rgb(e){this._rgb=Ds(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${ls(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`):void 0;var e}hexString(){return this._valid?ms(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=xs(e),s=t[0],i=cs(t[1]),n=cs(t[2]);return e.a<255?`hsla(${s}, ${i}%, ${n}%, ${ls(e.a)})`:`hsl(${s}, ${i}%, ${n}%)`}(this._rgb):void 0}mix(e,t){if(e){const s=this.rgb,i=e.rgb;let n;const r=t===n?.5:t,a=2*r-1,o=s.a-i.a,l=((a*o===-1?a:(a+o)/(1+a*o))+1)/2;n=1-l,s.r=255&l*s.r+n*i.r+.5,s.g=255&l*s.g+n*i.g+.5,s.b=255&l*s.b+n*i.b+.5,s.a=r*s.a+(1-r)*i.a,this.rgb=s}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,s){const i=Ms(ls(e.r)),n=Ms(ls(e.g)),r=Ms(ls(e.b));return{r:os(Ts(i+s*(Ms(ls(t.r))-i))),g:os(Ts(n+s*(Ms(ls(t.g))-n))),b:os(Ts(r+s*(Ms(ls(t.b))-r))),a:e.a+s*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new Ls(this.rgb)}alpha(e){return this._rgb.a=os(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=ns(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ps(this._rgb,2,e),this}darken(e){return Ps(this._rgb,2,-e),this}saturate(e){return Ps(this._rgb,1,e),this}desaturate(e){return Ps(this._rgb,1,-e),this}rotate(e){return function(e,t){var s=xs(e);s[0]=Ss(s[0]+t),s=_s(s),e.r=s[0],e.g=s[1],e.b=s[2]}(this._rgb,e),this}}function Os(){}const Fs=(()=>{let e=0;return()=>e++})();function zs(e){return null===e||void 0===e}function Bs(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function $s(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function Hs(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function Us(e,t){return Hs(e)?e:t}function Vs(e,t){return"undefined"===typeof e?t:e}const Ws=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function qs(e,t,s){if(e&&"function"===typeof e.call)return e.apply(s,t)}function Gs(e,t,s,i){let n,r,a;if(Bs(e))if(r=e.length,i)for(n=r-1;n>=0;n--)t.call(s,e[n],n);else for(n=0;n<r;n++)t.call(s,e[n],n);else if($s(e))for(a=Object.keys(e),r=a.length,n=0;n<r;n++)t.call(s,e[a[n]],a[n])}function Ys(e,t){let s,i,n,r;if(!e||!t||e.length!==t.length)return!1;for(s=0,i=e.length;s<i;++s)if(n=e[s],r=t[s],n.datasetIndex!==r.datasetIndex||n.index!==r.index)return!1;return!0}function Ks(e){if(Bs(e))return e.map(Ks);if($s(e)){const t=Object.create(null),s=Object.keys(e),i=s.length;let n=0;for(;n<i;++n)t[s[n]]=Ks(e[s[n]]);return t}return e}function Xs(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function Js(e,t,s,i){if(!Xs(e))return;const n=t[e],r=s[e];$s(n)&&$s(r)?Qs(n,r,i):t[e]=Ks(r)}function Qs(e,t,s){const i=Bs(t)?t:[t],n=i.length;if(!$s(e))return e;const r=(s=s||{}).merger||Js;let a;for(let o=0;o<n;++o){if(a=i[o],!$s(a))continue;const t=Object.keys(a);for(let i=0,n=t.length;i<n;++i)r(t[i],e,a,s)}return e}function Zs(e,t){return Qs(e,t,{merger:ei})}function ei(e,t,s){if(!Xs(e))return;const i=t[e],n=s[e];$s(i)&&$s(n)?Zs(i,n):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Ks(n))}const ti={"":e=>e,x:e=>e.x,y:e=>e.y};function si(e,t){const s=ti[t]||(ti[t]=function(e){const t=function(e){const t=e.split("."),s=[];let i="";for(const n of t)i+=n,i.endsWith("\\")?i=i.slice(0,-1)+".":(s.push(i),i="");return s}(e);return e=>{for(const s of t){if(""===s)break;e=e&&e[s]}return e}}(t));return s(e)}function ii(e){return e.charAt(0).toUpperCase()+e.slice(1)}const ni=e=>"undefined"!==typeof e,ri=e=>"function"===typeof e,ai=(e,t)=>{if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0};const oi=Math.PI,li=2*oi,ci=li+oi,di=Number.POSITIVE_INFINITY,hi=oi/180,ui=oi/2,pi=oi/4,fi=2*oi/3,mi=Math.log10,gi=Math.sign;function vi(e,t,s){return Math.abs(e-t)<s}function bi(e){const t=Math.round(e);e=vi(e,t,e/1e3)?t:e;const s=Math.pow(10,Math.floor(mi(e))),i=e/s;return(i<=1?1:i<=2?2:i<=5?5:10)*s}function yi(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function xi(e,t,s){let i,n,r;for(i=0,n=e.length;i<n;i++)r=e[i][s],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function wi(e){return e*(oi/180)}function _i(e){return e*(180/oi)}function Si(e){if(!Hs(e))return;let t=1,s=0;for(;Math.round(e*t)/t!==e;)t*=10,s++;return s}function ki(e,t){const s=t.x-e.x,i=t.y-e.y,n=Math.sqrt(s*s+i*i);let r=Math.atan2(i,s);return r<-.5*oi&&(r+=li),{angle:r,distance:n}}function Ai(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Ci(e,t){return(e-t+ci)%li-oi}function Ei(e){return(e%li+li)%li}function Ni(e,t,s,i){const n=Ei(e),r=Ei(t),a=Ei(s),o=Ei(r-n),l=Ei(a-n),c=Ei(n-r),d=Ei(n-a);return n===r||n===a||i&&r===a||o>l&&c<d}function ji(e,t,s){return Math.max(t,Math.min(s,e))}function Ti(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,s)-i&&e<=Math.max(t,s)+i}function Mi(e,t,s){s=s||(s=>e[s]<t);let i,n=e.length-1,r=0;for(;n-r>1;)i=r+n>>1,s(i)?r=i:n=i;return{lo:r,hi:n}}const Pi=(e,t,s,i)=>Mi(e,s,i?i=>{const n=e[i][t];return n<s||n===s&&e[i+1][t]===s}:i=>e[i][t]<s),Ri=(e,t,s)=>Mi(e,s,(i=>e[i][t]>=s));const Di=["push","pop","shift","splice","unshift"];function Ii(e,t){const s=e._chartjs;if(!s)return;const i=s.listeners,n=i.indexOf(t);-1!==n&&i.splice(n,1),i.length>0||(Di.forEach((t=>{delete e[t]})),delete e._chartjs)}function Li(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const Oi="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function Fi(e,t){let s=[],i=!1;return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];s=r,i||(i=!0,Oi.call(window,(()=>{i=!1,e.apply(t,s)})))}}const zi=e=>"start"===e?"left":"end"===e?"right":"center",Bi=(e,t,s)=>"start"===e?t:"end"===e?s:(t+s)/2;function $i(e,t,s){const i=t.length;let n=0,r=i;if(e._sorted){const{iScale:a,vScale:o,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=a.axis,{min:h,max:u,minDefined:p,maxDefined:f}=a.getUserBounds();if(p){if(n=Math.min(Pi(l,d,h).lo,s?i:Pi(t,d,a.getPixelForValue(h)).lo),c){const e=l.slice(0,n+1).reverse().findIndex((e=>!zs(e[o.axis])));n-=Math.max(0,e)}n=ji(n,0,i-1)}if(f){let e=Math.max(Pi(l,a.axis,u,!0).hi+1,s?0:Pi(t,d,a.getPixelForValue(u),!0).hi+1);if(c){const t=l.slice(e-1).findIndex((e=>!zs(e[o.axis])));e+=Math.max(0,t)}r=ji(e,n,i)-n}else r=i-n}return{start:n,count:r}}function Hi(e){const{xScale:t,yScale:s,_scaleRanges:i}=e,n={xmin:t.min,xmax:t.max,ymin:s.min,ymax:s.max};if(!i)return e._scaleRanges=n,!0;const r=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==s.min||i.ymax!==s.max;return Object.assign(i,n),r}const Ui=e=>0===e||1===e,Vi=(e,t,s)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*li/s),Wi=(e,t,s)=>Math.pow(2,-10*e)*Math.sin((e-t)*li/s)+1,qi={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*ui),easeOutSine:e=>Math.sin(e*ui),easeInOutSine:e=>-.5*(Math.cos(oi*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>Ui(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Ui(e)?e:Vi(e,.075,.3),easeOutElastic:e=>Ui(e)?e:Wi(e,.075,.3),easeInOutElastic(e){const t=.1125;return Ui(e)?e:e<.5?.5*Vi(2*e,t,.45):.5+.5*Wi(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-qi.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,s=2.75;return e<1/s?t*e*e:e<2/s?t*(e-=1.5/s)*e+.75:e<2.5/s?t*(e-=2.25/s)*e+.9375:t*(e-=2.625/s)*e+.984375},easeInOutBounce:e=>e<.5?.5*qi.easeInBounce(2*e):.5*qi.easeOutBounce(2*e-1)+.5};function Gi(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function Yi(e){return Gi(e)?e:new Ls(e)}function Ki(e){return Gi(e)?e:new Ls(e).saturate(.5).darken(.1).hexString()}const Xi=["x","y","borderWidth","radius","tension"],Ji=["color","borderColor","backgroundColor"];const Qi=new Map;function Zi(e,t,s){return function(e,t){t=t||{};const s=e+JSON.stringify(t);let i=Qi.get(s);return i||(i=new Intl.NumberFormat(e,t),Qi.set(s,i)),i}(t,s).format(e)}const en={values:e=>Bs(e)?e:""+e,numeric(e,t,s){if(0===e)return"0";const i=this.chart.options.locale;let n,r=e;if(s.length>1){const t=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(t<1e-4||t>1e15)&&(n="scientific"),r=function(e,t){let s=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(s)>=1&&e!==Math.floor(e)&&(s=e-Math.floor(e));return s}(e,s)}const a=mi(Math.abs(r)),o=isNaN(a)?1:Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:n,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),Zi(e,i,l)},logarithmic(e,t,s){if(0===e)return"0";const i=s[t].significand||e/Math.pow(10,Math.floor(mi(e)));return[1,2,3,5,10,15].includes(i)||t>.8*s.length?en.numeric.call(this,e,t,s):""}};var tn={formatters:en};const sn=Object.create(null),nn=Object.create(null);function rn(e,t){if(!t)return e;const s=t.split(".");for(let i=0,n=s.length;i<n;++i){const t=s[i];e=e[t]||(e[t]=Object.create(null))}return e}function an(e,t,s){return"string"===typeof t?Qs(rn(e,t),s):Qs(rn(e,""),t)}class on{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>Ki(t.backgroundColor),this.hoverBorderColor=(e,t)=>Ki(t.borderColor),this.hoverColor=(e,t)=>Ki(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return an(this,e,t)}get(e){return rn(this,e)}describe(e,t){return an(nn,e,t)}override(e,t){return an(sn,e,t)}route(e,t,s,i){const n=rn(this,e),r=rn(this,s),a="_"+t;Object.defineProperties(n,{[a]:{value:n[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[a],t=r[i];return $s(e)?Object.assign({},t,e):Vs(e,t)},set(e){this[a]=e}}})}apply(e){e.forEach((e=>e(this)))}}var ln=new on({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:Ji},numbers:{type:"number",properties:Xi}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:tn.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function cn(e,t,s,i,n){let r=t[n];return r||(r=t[n]=e.measureText(n).width,s.push(n)),r>i&&(i=r),i}function dn(e,t,s){const i=e.currentDevicePixelRatio,n=0!==s?Math.max(s/2,.5):0;return Math.round((t-n)*i)/i+n}function hn(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function un(e,t,s,i){pn(e,t,s,i,null)}function pn(e,t,s,i,n){let r,a,o,l,c,d,h,u;const p=t.pointStyle,f=t.rotation,m=t.radius;let g=(f||0)*hi;if(p&&"object"===typeof p&&(r=p.toString(),"[object HTMLImageElement]"===r||"[object HTMLCanvasElement]"===r))return e.save(),e.translate(s,i),e.rotate(g),e.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void e.restore();if(!(isNaN(m)||m<=0)){switch(e.beginPath(),p){default:n?e.ellipse(s,i,n/2,m,0,0,li):e.arc(s,i,m,0,li),e.closePath();break;case"triangle":d=n?n/2:m,e.moveTo(s+Math.sin(g)*d,i-Math.cos(g)*m),g+=fi,e.lineTo(s+Math.sin(g)*d,i-Math.cos(g)*m),g+=fi,e.lineTo(s+Math.sin(g)*d,i-Math.cos(g)*m),e.closePath();break;case"rectRounded":c=.516*m,l=m-c,a=Math.cos(g+pi)*l,h=Math.cos(g+pi)*(n?n/2-c:l),o=Math.sin(g+pi)*l,u=Math.sin(g+pi)*(n?n/2-c:l),e.arc(s-h,i-o,c,g-oi,g-ui),e.arc(s+u,i-a,c,g-ui,g),e.arc(s+h,i+o,c,g,g+ui),e.arc(s-u,i+a,c,g+ui,g+oi),e.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,d=n?n/2:l,e.rect(s-d,i-l,2*d,2*l);break}g+=pi;case"rectRot":h=Math.cos(g)*(n?n/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,u=Math.sin(g)*(n?n/2:m),e.moveTo(s-h,i-o),e.lineTo(s+u,i-a),e.lineTo(s+h,i+o),e.lineTo(s-u,i+a),e.closePath();break;case"crossRot":g+=pi;case"cross":h=Math.cos(g)*(n?n/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,u=Math.sin(g)*(n?n/2:m),e.moveTo(s-h,i-o),e.lineTo(s+h,i+o),e.moveTo(s+u,i-a),e.lineTo(s-u,i+a);break;case"star":h=Math.cos(g)*(n?n/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,u=Math.sin(g)*(n?n/2:m),e.moveTo(s-h,i-o),e.lineTo(s+h,i+o),e.moveTo(s+u,i-a),e.lineTo(s-u,i+a),g+=pi,h=Math.cos(g)*(n?n/2:m),a=Math.cos(g)*m,o=Math.sin(g)*m,u=Math.sin(g)*(n?n/2:m),e.moveTo(s-h,i-o),e.lineTo(s+h,i+o),e.moveTo(s+u,i-a),e.lineTo(s-u,i+a);break;case"line":a=n?n/2:Math.cos(g)*m,o=Math.sin(g)*m,e.moveTo(s-a,i-o),e.lineTo(s+a,i+o);break;case"dash":e.moveTo(s,i),e.lineTo(s+Math.cos(g)*(n?n/2:m),i+Math.sin(g)*m);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function fn(e,t,s){return s=s||.5,!t||e&&e.x>t.left-s&&e.x<t.right+s&&e.y>t.top-s&&e.y<t.bottom+s}function mn(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function gn(e){e.restore()}function vn(e,t,s,i,n){if(!t)return e.lineTo(s.x,s.y);if("middle"===n){const i=(t.x+s.x)/2;e.lineTo(i,t.y),e.lineTo(i,s.y)}else"after"===n!==!!i?e.lineTo(t.x,s.y):e.lineTo(s.x,t.y);e.lineTo(s.x,s.y)}function bn(e,t,s,i){if(!t)return e.lineTo(s.x,s.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?s.cp2x:s.cp1x,i?s.cp2y:s.cp1y,s.x,s.y)}function yn(e,t,s,i,n){if(n.strikethrough||n.underline){const r=e.measureText(i),a=t-r.actualBoundingBoxLeft,o=t+r.actualBoundingBoxRight,l=s-r.actualBoundingBoxAscent,c=s+r.actualBoundingBoxDescent,d=n.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=n.decorationWidth||2,e.moveTo(a,d),e.lineTo(o,d),e.stroke()}}function xn(e,t){const s=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=s}function wn(e,t,s,i,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=Bs(t)?t:[t],o=r.strokeWidth>0&&""!==r.strokeColor;let l,c;for(e.save(),e.font=n.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),zs(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,r),l=0;l<a.length;++l)c=a[l],r.backdrop&&xn(e,r.backdrop),o&&(r.strokeColor&&(e.strokeStyle=r.strokeColor),zs(r.strokeWidth)||(e.lineWidth=r.strokeWidth),e.strokeText(c,s,i,r.maxWidth)),e.fillText(c,s,i,r.maxWidth),yn(e,s,i,c,r),i+=Number(n.lineHeight);e.restore()}function _n(e,t){const{x:s,y:i,w:n,h:r,radius:a}=t;e.arc(s+a.topLeft,i+a.topLeft,a.topLeft,1.5*oi,oi,!0),e.lineTo(s,i+r-a.bottomLeft),e.arc(s+a.bottomLeft,i+r-a.bottomLeft,a.bottomLeft,oi,ui,!0),e.lineTo(s+n-a.bottomRight,i+r),e.arc(s+n-a.bottomRight,i+r-a.bottomRight,a.bottomRight,ui,0,!0),e.lineTo(s+n,i+a.topRight),e.arc(s+n-a.topRight,i+a.topRight,a.topRight,0,-ui,!0),e.lineTo(s+a.topLeft,i)}const Sn=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,kn=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function An(e,t){const s=(""+e).match(Sn);if(!s||"normal"===s[1])return 1.2*t;switch(e=+s[2],s[3]){case"px":return e;case"%":e/=100}return t*e}function Cn(e,t){const s={},i=$s(t),n=i?Object.keys(t):t,r=$s(e)?i?s=>Vs(e[s],e[t[s]]):t=>e[t]:()=>e;for(const a of n)s[a]=+r(a)||0;return s}function En(e){return Cn(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Nn(e){return Cn(e,["topLeft","topRight","bottomLeft","bottomRight"])}function jn(e){const t=En(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Tn(e,t){e=e||{},t=t||ln.font;let s=Vs(e.size,t.size);"string"===typeof s&&(s=parseInt(s,10));let i=Vs(e.style,t.style);i&&!(""+i).match(kn)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const n={family:Vs(e.family,t.family),lineHeight:An(Vs(e.lineHeight,t.lineHeight),s),size:s,style:i,weight:Vs(e.weight,t.weight),string:""};return n.string=function(e){return!e||zs(e.size)||zs(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(n),n}function Mn(e,t,s,i){let n,r,a,o=!0;for(n=0,r=e.length;n<r;++n)if(a=e[n],void 0!==a&&(void 0!==t&&"function"===typeof a&&(a=a(t),o=!1),void 0!==s&&Bs(a)&&(a=a[s%a.length],o=!1),void 0!==a))return i&&!o&&(i.cacheable=!1),a}function Pn(e,t){return Object.assign(Object.create(e),t)}function Rn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const n=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof s&&(s=Vn("_fallback",e));const r={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:n,_fallback:s,_getTarget:i,override:i=>Rn([i,...e],t,n,s)};return new Proxy(r,{deleteProperty:(t,s)=>(delete t[s],delete t._keys,delete e[0][s],!0),get:(s,i)=>Fn(s,i,(()=>function(e,t,s,i){let n;for(const r of t)if(n=Vn(Ln(r,e),s),"undefined"!==typeof n)return On(e,n)?Hn(s,i,e,n):n}(i,t,e,s))),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>Wn(e).includes(t),ownKeys:e=>Wn(e),set(e,t,s){const n=e._storage||(e._storage=i());return e[t]=n[t]=s,delete e._keys,!0}})}function Dn(e,t,s,i){const n={_cacheable:!1,_proxy:e,_context:t,_subProxy:s,_stack:new Set,_descriptors:In(e,i),setContext:t=>Dn(e,t,s,i),override:n=>Dn(e.override(n),t,s,i)};return new Proxy(n,{deleteProperty:(t,s)=>(delete t[s],delete e[s],!0),get:(e,t,s)=>Fn(e,t,(()=>function(e,t,s){const{_proxy:i,_context:n,_subProxy:r,_descriptors:a}=e;let o=i[t];ri(o)&&a.isScriptable(t)&&(o=function(e,t,s,i){const{_proxy:n,_context:r,_subProxy:a,_stack:o}=s;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(r,a||i);o.delete(e),On(e,l)&&(l=Hn(n._scopes,n,e,l));return l}(t,o,e,s));Bs(o)&&o.length&&(o=function(e,t,s,i){const{_proxy:n,_context:r,_subProxy:a,_descriptors:o}=s;if("undefined"!==typeof r.index&&i(e))return t[r.index%t.length];if($s(t[0])){const s=t,i=n._scopes.filter((e=>e!==s));t=[];for(const l of s){const s=Hn(i,n,e,l);t.push(Dn(s,r,a&&a[e],o))}}return t}(t,o,e,a.isIndexable));On(t,o)&&(o=Dn(o,n,r&&r[t],a));return o}(e,t,s))),getOwnPropertyDescriptor:(t,s)=>t._descriptors.allKeys?Reflect.has(e,s)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,s),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,s)=>Reflect.has(e,s),ownKeys:()=>Reflect.ownKeys(e),set:(t,s,i)=>(e[s]=i,delete t[s],!0)})}function In(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:s=t.scriptable,_indexable:i=t.indexable,_allKeys:n=t.allKeys}=e;return{allKeys:n,scriptable:s,indexable:i,isScriptable:ri(s)?s:()=>s,isIndexable:ri(i)?i:()=>i}}const Ln=(e,t)=>e?e+ii(t):t,On=(e,t)=>$s(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function Fn(e,t,s){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const i=s();return e[t]=i,i}function zn(e,t,s){return ri(e)?e(t,s):e}const Bn=(e,t)=>!0===e?t:"string"===typeof e?si(t,e):void 0;function $n(e,t,s,i,n){for(const r of t){const t=Bn(s,r);if(t){e.add(t);const r=zn(t._fallback,s,n);if("undefined"!==typeof r&&r!==s&&r!==i)return r}else if(!1===t&&"undefined"!==typeof i&&s!==i)return null}return!1}function Hn(e,t,s,i){const n=t._rootScopes,r=zn(t._fallback,s,i),a=[...e,...n],o=new Set;o.add(i);let l=Un(o,a,s,r||s,i);return null!==l&&(("undefined"===typeof r||r===s||(l=Un(o,a,r,l,i),null!==l))&&Rn(Array.from(o),[""],n,r,(()=>function(e,t,s){const i=e._getTarget();t in i||(i[t]={});const n=i[t];if(Bs(n)&&$s(s))return s;return n||{}}(t,s,i))))}function Un(e,t,s,i,n){for(;s;)s=$n(e,t,s,i,n);return s}function Vn(e,t){for(const s of t){if(!s)continue;const t=s[e];if("undefined"!==typeof t)return t}}function Wn(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const s of e)for(const e of Object.keys(s).filter((e=>!e.startsWith("_"))))t.add(e);return Array.from(t)}(e._scopes)),t}const qn=Number.EPSILON||1e-14,Gn=(e,t)=>t<e.length&&!e[t].skip&&e[t],Yn=e=>"x"===e?"y":"x";function Kn(e,t,s,i){const n=e.skip?t:e,r=t,a=s.skip?t:s,o=Ai(r,n),l=Ai(a,r);let c=o/(o+l),d=l/(o+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const h=i*c,u=i*d;return{previous:{x:r.x-h*(a.x-n.x),y:r.y-h*(a.y-n.y)},next:{x:r.x+u*(a.x-n.x),y:r.y+u*(a.y-n.y)}}}function Xn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const s=Yn(t),i=e.length,n=Array(i).fill(0),r=Array(i);let a,o,l,c=Gn(e,0);for(a=0;a<i;++a)if(o=l,l=c,c=Gn(e,a+1),l){if(c){const e=c[t]-l[t];n[a]=0!==e?(c[s]-l[s])/e:0}r[a]=o?c?gi(n[a-1])!==gi(n[a])?0:(n[a-1]+n[a])/2:n[a-1]:n[a]}!function(e,t,s){const i=e.length;let n,r,a,o,l,c=Gn(e,0);for(let d=0;d<i-1;++d)l=c,c=Gn(e,d+1),l&&c&&(vi(t[d],0,qn)?s[d]=s[d+1]=0:(n=s[d]/t[d],r=s[d+1]/t[d],o=Math.pow(n,2)+Math.pow(r,2),o<=9||(a=3/Math.sqrt(o),s[d]=n*a*t[d],s[d+1]=r*a*t[d])))}(e,n,r),function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const i=Yn(s),n=e.length;let r,a,o,l=Gn(e,0);for(let c=0;c<n;++c){if(a=o,o=l,l=Gn(e,c+1),!o)continue;const n=o[s],d=o[i];a&&(r=(n-a[s])/3,o[`cp1${s}`]=n-r,o[`cp1${i}`]=d-r*t[c]),l&&(r=(l[s]-n)/3,o[`cp2${s}`]=n+r,o[`cp2${i}`]=d+r*t[c])}}(e,r,t)}function Jn(e,t,s){return Math.max(Math.min(e,s),t)}function Qn(e,t,s,i,n){let r,a,o,l;if(t.spanGaps&&(e=e.filter((e=>!e.skip))),"monotone"===t.cubicInterpolationMode)Xn(e,n);else{let s=i?e[e.length-1]:e[0];for(r=0,a=e.length;r<a;++r)o=e[r],l=Kn(s,o,e[Math.min(r+1,a-(i?0:1))%a],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,s=o}t.capBezierPoints&&function(e,t){let s,i,n,r,a,o=fn(e[0],t);for(s=0,i=e.length;s<i;++s)a=r,r=o,o=s<i-1&&fn(e[s+1],t),r&&(n=e[s],a&&(n.cp1x=Jn(n.cp1x,t.left,t.right),n.cp1y=Jn(n.cp1y,t.top,t.bottom)),o&&(n.cp2x=Jn(n.cp2x,t.left,t.right),n.cp2y=Jn(n.cp2y,t.top,t.bottom)))}(e,s)}function Zn(){return"undefined"!==typeof window&&"undefined"!==typeof document}function er(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function tr(e,t,s){let i;return"string"===typeof e?(i=parseInt(e,10),-1!==e.indexOf("%")&&(i=i/100*t.parentNode[s])):i=e,i}const sr=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const ir=["top","right","bottom","left"];function nr(e,t,s){const i={};s=s?"-"+s:"";for(let n=0;n<4;n++){const r=ir[n];i[r]=parseFloat(e[t+"-"+r+s])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function rr(e,t){if("native"in e)return e;const{canvas:s,currentDevicePixelRatio:i}=t,n=sr(s),r="border-box"===n.boxSizing,a=nr(n,"padding"),o=nr(n,"border","width"),{x:l,y:c,box:d}=function(e,t){const s=e.touches,i=s&&s.length?s[0]:e,{offsetX:n,offsetY:r}=i;let a,o,l=!1;if(((e,t,s)=>(e>0||t>0)&&(!s||!s.shadowRoot))(n,r,e.target))a=n,o=r;else{const e=t.getBoundingClientRect();a=i.clientX-e.left,o=i.clientY-e.top,l=!0}return{x:a,y:o,box:l}}(e,s),h=a.left+(d&&o.left),u=a.top+(d&&o.top);let{width:p,height:f}=t;return r&&(p-=a.width+o.width,f-=a.height+o.height),{x:Math.round((l-h)/p*s.width/i),y:Math.round((c-u)/f*s.height/i)}}const ar=e=>Math.round(10*e)/10;function or(e,t,s,i){const n=sr(e),r=nr(n,"margin"),a=tr(n.maxWidth,e,"clientWidth")||di,o=tr(n.maxHeight,e,"clientHeight")||di,l=function(e,t,s){let i,n;if(void 0===t||void 0===s){const r=e&&er(e);if(r){const e=r.getBoundingClientRect(),a=sr(r),o=nr(a,"border","width"),l=nr(a,"padding");t=e.width-l.width-o.width,s=e.height-l.height-o.height,i=tr(a.maxWidth,r,"clientWidth"),n=tr(a.maxHeight,r,"clientHeight")}else t=e.clientWidth,s=e.clientHeight}return{width:t,height:s,maxWidth:i||di,maxHeight:n||di}}(e,t,s);let{width:c,height:d}=l;if("content-box"===n.boxSizing){const e=nr(n,"border","width"),t=nr(n,"padding");c-=t.width+e.width,d-=t.height+e.height}c=Math.max(0,c-r.width),d=Math.max(0,i?c/i:d-r.height),c=ar(Math.min(c,a,l.maxWidth)),d=ar(Math.min(d,o,l.maxHeight)),c&&!d&&(d=ar(c/2));return(void 0!==t||void 0!==s)&&i&&l.height&&d>l.height&&(d=l.height,c=ar(Math.floor(d*i))),{width:c,height:d}}function lr(e,t,s){const i=t||1,n=Math.floor(e.height*i),r=Math.floor(e.width*i);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const a=e.canvas;return a.style&&(s||!a.style.height&&!a.style.width)&&(a.style.height=`${e.height}px`,a.style.width=`${e.width}px`),(e.currentDevicePixelRatio!==i||a.height!==n||a.width!==r)&&(e.currentDevicePixelRatio=i,a.height=n,a.width=r,e.ctx.setTransform(i,0,0,i,0,0),!0)}const cr=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Zn()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(yv){}return e}();function dr(e,t){const s=function(e,t){return sr(e).getPropertyValue(t)}(e,t),i=s&&s.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function hr(e,t,s,i){return{x:e.x+s*(t.x-e.x),y:e.y+s*(t.y-e.y)}}function ur(e,t,s,i){return{x:e.x+s*(t.x-e.x),y:"middle"===i?s<.5?e.y:t.y:"after"===i?s<1?e.y:t.y:s>0?t.y:e.y}}function pr(e,t,s,i){const n={x:e.cp2x,y:e.cp2y},r={x:t.cp1x,y:t.cp1y},a=hr(e,n,s),o=hr(n,r,s),l=hr(r,t,s),c=hr(a,o,s),d=hr(o,l,s);return hr(c,d,s)}function fr(e,t,s){return e?function(e,t){return{x:s=>e+e+t-s,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,s):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function mr(e,t){let s,i;"ltr"!==t&&"rtl"!==t||(s=e.canvas.style,i=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",t,"important"),e.prevTextDirection=i)}function gr(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function vr(e){return"angle"===e?{between:Ni,compare:Ci,normalize:Ei}:{between:Ti,compare:(e,t)=>e-t,normalize:e=>e}}function br(e){let{start:t,end:s,count:i,loop:n,style:r}=e;return{start:t%i,end:s%i,loop:n&&(s-t+1)%i===0,style:r}}function yr(e,t,s){if(!s)return[e];const{property:i,start:n,end:r}=s,a=t.length,{compare:o,between:l,normalize:c}=vr(i),{start:d,end:h,loop:u,style:p}=function(e,t,s){const{property:i,start:n,end:r}=s,{between:a,normalize:o}=vr(i),l=t.length;let c,d,{start:h,end:u,loop:p}=e;if(p){for(h+=l,u+=l,c=0,d=l;c<d&&a(o(t[h%l][i]),n,r);++c)h--,u--;h%=l,u%=l}return u<h&&(u+=l),{start:h,end:u,loop:p,style:e.style}}(e,t,s),f=[];let m,g,v,b=!1,y=null;const x=()=>b||l(n,v,m)&&0!==o(n,v),w=()=>!b||0===o(r,m)||l(r,v,m);for(let _=d,S=d;_<=h;++_)g=t[_%a],g.skip||(m=c(g[i]),m!==v&&(b=l(m,n,r),null===y&&x()&&(y=0===o(m,n)?_:S),null!==y&&w()&&(f.push(br({start:y,end:_,loop:u,count:a,style:p})),y=null),S=_,v=m));return null!==y&&f.push(br({start:y,end:h,loop:u,count:a,style:p})),f}function xr(e,t){const s=[],i=e.segments;for(let n=0;n<i.length;n++){const r=yr(i[n],e.points,t);r.length&&s.push(...r)}return s}function wr(e,t,s,i){return i&&i.setContext&&s?function(e,t,s,i){const n=e._chart.getContext(),r=_r(e.options),{_datasetIndex:a,options:{spanGaps:o}}=e,l=s.length,c=[];let d=r,h=t[0].start,u=h;function p(e,t,i,n){const r=o?-1:1;if(e!==t){for(e+=l;s[e%l].skip;)e-=r;for(;s[t%l].skip;)t+=r;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:i,style:n}),d=n,h=t%l)}}for(const f of t){h=o?h:f.start;let e,t=s[h%l];for(u=h+1;u<=f.end;u++){const r=s[u%l];e=_r(i.setContext(Pn(n,{type:"segment",p0:t,p1:r,p0DataIndex:(u-1)%l,p1DataIndex:u%l,datasetIndex:a}))),Sr(e,d)&&p(h,u-1,f.loop,d),t=r,d=e}h<u-1&&p(h,u-1,f.loop,d)}return c}(e,t,s,i):t}function _r(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Sr(e,t){if(!t)return!1;const s=[],i=function(e,t){return Gi(t)?(s.includes(t)||s.push(t),s.indexOf(t)):t};return JSON.stringify(e,i)!==JSON.stringify(t,i)}class kr{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,s,i){const n=t.listeners[i],r=t.duration;n.forEach((i=>i({chart:e,initial:t.initial,numSteps:r,currentStep:Math.min(s-t.start,r)})))}_refresh(){this._request||(this._running=!0,this._request=Oi.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach(((s,i)=>{if(!s.running||!s.items.length)return;const n=s.items;let r,a=n.length-1,o=!1;for(;a>=0;--a)r=n[a],r._active?(r._total>s.duration&&(s.duration=r._total),r.tick(e),o=!0):(n[a]=n[n.length-1],n.pop());o&&(i.draw(),this._notify(i,s,e,"progress")),n.length||(s.running=!1,this._notify(i,s,e,"complete"),s.initial=!1),t+=n.length})),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let s=t.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,s)),s}listen(e,t,s){this._getAnims(e).listeners[t].push(s)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(((e,t)=>Math.max(e,t._duration)),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const s=t.items;let i=s.length-1;for(;i>=0;--i)s[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Ar=new kr;const Cr="transparent",Er={boolean:(e,t,s)=>s>.5?t:e,color(e,t,s){const i=Yi(e||Cr),n=i.valid&&Yi(t||Cr);return n&&n.valid?n.mix(i,s).hexString():t},number:(e,t,s)=>e+(t-e)*s};class Nr{constructor(e,t,s,i){const n=t[s];i=Mn([e.to,i,n,e.from]);const r=Mn([e.from,n,i]);this._active=!0,this._fn=e.fn||Er[e.type||typeof r],this._easing=qi[e.easing]||qi.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=s,this._from=r,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,s){if(this._active){this._notify(!1);const i=this._target[this._prop],n=s-this._start,r=this._duration-n;this._start=s,this._duration=Math.floor(Math.max(r,e.duration)),this._total+=n,this._loop=!!e.loop,this._to=Mn([e.to,t,i,e.from]),this._from=Mn([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,s=this._duration,i=this._prop,n=this._from,r=this._loop,a=this._to;let o;if(this._active=n!==a&&(r||t<s),!this._active)return this._target[i]=a,void this._notify(!0);t<0?this._target[i]=n:(o=t/s%2,o=r&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[i]=this._fn(n,a,o))}wait(){const e=this._promises||(this._promises=[]);return new Promise(((t,s)=>{e.push({res:t,rej:s})}))}_notify(e){const t=e?"res":"rej",s=this._promises||[];for(let i=0;i<s.length;i++)s[i][t]()}}class jr{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!$s(e))return;const t=Object.keys(ln.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach((i=>{const n=e[i];if(!$s(n))return;const r={};for(const e of t)r[e]=n[e];(Bs(n.properties)&&n.properties||[i]).forEach((e=>{e!==i&&s.has(e)||s.set(e,r)}))}))}_animateOptions(e,t){const s=t.options,i=function(e,t){if(!t)return;let s=e.options;if(!s)return void(e.options=t);s.$shared&&(e.options=s=Object.assign({},s,{$shared:!1,$animations:{}}));return s}(e,s);if(!i)return[];const n=this._createAnimations(i,s);return s.$shared&&function(e,t){const s=[],i=Object.keys(t);for(let n=0;n<i.length;n++){const t=e[i[n]];t&&t.active()&&s.push(t.wait())}return Promise.all(s)}(e.options.$animations,s).then((()=>{e.options=s}),(()=>{})),n}_createAnimations(e,t){const s=this._properties,i=[],n=e.$animations||(e.$animations={}),r=Object.keys(t),a=Date.now();let o;for(o=r.length-1;o>=0;--o){const l=r[o];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(e,t));continue}const c=t[l];let d=n[l];const h=s.get(l);if(d){if(h&&d.active()){d.update(h,c,a);continue}d.cancel()}h&&h.duration?(n[l]=d=new Nr(h,e,l,c),i.push(d)):e[l]=c}return i}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const s=this._createAnimations(e,t);return s.length?(Ar.add(this._chart,s),!0):void 0}}function Tr(e,t){const s=e&&e.options||{},i=s.reverse,n=void 0===s.min?t:0,r=void 0===s.max?t:0;return{start:i?r:n,end:i?n:r}}function Mr(e,t){const s=[],i=e._getSortedDatasetMetas(t);let n,r;for(n=0,r=i.length;n<r;++n)s.push(i[n].index);return s}function Pr(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const n=e.keys,r="single"===i.mode;let a,o,l,c;if(null===t)return;let d=!1;for(a=0,o=n.length;a<o;++a){if(l=+n[a],l===s){if(d=!0,i.all)continue;break}c=e.values[l],Hs(c)&&(r||0===t||gi(t)===gi(c))&&(t+=c)}return d||i.all?t:0}function Rr(e,t){const s=e&&e.options.stacked;return s||void 0===s&&void 0!==t.stack}function Dr(e,t,s){const i=e[t]||(e[t]={});return i[s]||(i[s]={})}function Ir(e,t,s,i){for(const n of t.getMatchingVisibleMetas(i).reverse()){const t=e[n.index];if(s&&t>0||!s&&t<0)return n.index}return null}function Lr(e,t){const{chart:s,_cachedMeta:i}=e,n=s._stacks||(s._stacks={}),{iScale:r,vScale:a,index:o}=i,l=r.axis,c=a.axis,d=function(e,t,s){return`${e.id}.${t.id}.${s.stack||s.type}`}(r,a,i),h=t.length;let u;for(let p=0;p<h;++p){const e=t[p],{[l]:s,[c]:r}=e;u=(e._stacks||(e._stacks={}))[c]=Dr(n,d,s),u[o]=r,u._top=Ir(u,a,!0,i.type),u._bottom=Ir(u,a,!1,i.type);(u._visualValues||(u._visualValues={}))[o]=r}}function Or(e,t){const s=e.scales;return Object.keys(s).filter((e=>s[e].axis===t)).shift()}function Fr(e,t){const s=e.controller.index,i=e.vScale&&e.vScale.axis;if(i){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[i]||void 0===t[i][s])return;delete t[i][s],void 0!==t[i]._visualValues&&void 0!==t[i]._visualValues[s]&&delete t[i]._visualValues[s]}}}const zr=e=>"reset"===e||"none"===e,Br=(e,t)=>t?e:Object.assign({},e);class $r{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Rr(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Fr(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,s=this.getDataset(),i=(e,t,s,i)=>"x"===e?t:"r"===e?i:s,n=t.xAxisID=Vs(s.xAxisID,Or(e,"x")),r=t.yAxisID=Vs(s.yAxisID,Or(e,"y")),a=t.rAxisID=Vs(s.rAxisID,Or(e,"r")),o=t.indexAxis,l=t.iAxisID=i(o,n,r,a),c=t.vAxisID=i(o,r,n,a);t.xScale=this.getScaleForId(n),t.yScale=this.getScaleForId(r),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Ii(this._data,this),e._stacked&&Fr(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),s=this._data;if($s(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:s,vScale:i}=t,n="x"===s.axis?"x":"y",r="x"===i.axis?"x":"y",a=Object.keys(e),o=new Array(a.length);let l,c,d;for(l=0,c=a.length;l<c;++l)d=a[l],o[l]={[n]:d,[r]:e[d]};return o}(t,e)}else if(s!==t){if(s){Ii(s,this);const e=this._cachedMeta;Fr(e),e._parsed=[]}t&&Object.isExtensible(t)&&(n=this,(i=t)._chartjs?i._chartjs.listeners.push(n):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[n]}}),Di.forEach((e=>{const t="_onData"+ii(e),s=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const a=s.apply(this,n);return i._chartjs.listeners.forEach((e=>{"function"===typeof e[t]&&e[t](...n)})),a}})})))),this._syncList=[],this._data=t}var i,n}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,s=this.getDataset();let i=!1;this._dataCheck();const n=t._stacked;t._stacked=Rr(t.vScale,t),t.stack!==s.stack&&(i=!0,Fr(t),t.stack=s.stack),this._resyncElements(e),(i||n!==t._stacked)&&(Lr(this,t._parsed),t._stacked=Rr(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:s,_data:i}=this,{iScale:n,_stacked:r}=s,a=n.axis;let o,l,c,d=0===e&&t===i.length||s._sorted,h=e>0&&s._parsed[e-1];if(!1===this._parsing)s._parsed=i,s._sorted=!0,c=i;else{c=Bs(i[e])?this.parseArrayData(s,i,e,t):$s(i[e])?this.parseObjectData(s,i,e,t):this.parsePrimitiveData(s,i,e,t);const n=()=>null===l[a]||h&&l[a]<h[a];for(o=0;o<t;++o)s._parsed[o+e]=l=c[o],d&&(n()&&(d=!1),h=l);s._sorted=d}r&&Lr(this,c)}parsePrimitiveData(e,t,s,i){const{iScale:n,vScale:r}=e,a=n.axis,o=r.axis,l=n.getLabels(),c=n===r,d=new Array(i);let h,u,p;for(h=0,u=i;h<u;++h)p=h+s,d[h]={[a]:c||n.parse(l[p],p),[o]:r.parse(t[p],p)};return d}parseArrayData(e,t,s,i){const{xScale:n,yScale:r}=e,a=new Array(i);let o,l,c,d;for(o=0,l=i;o<l;++o)c=o+s,d=t[c],a[o]={x:n.parse(d[0],c),y:r.parse(d[1],c)};return a}parseObjectData(e,t,s,i){const{xScale:n,yScale:r}=e,{xAxisKey:a="x",yAxisKey:o="y"}=this._parsing,l=new Array(i);let c,d,h,u;for(c=0,d=i;c<d;++c)h=c+s,u=t[h],l[c]={x:n.parse(si(u,a),h),y:r.parse(si(u,o),h)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,s){const i=this.chart,n=this._cachedMeta,r=t[e.axis];return Pr({keys:Mr(i,!0),values:t._stacks[e.axis]._visualValues},r,n.index,{mode:s})}updateRangeFromParsed(e,t,s,i){const n=s[t.axis];let r=null===n?NaN:n;const a=i&&s._stacks[t.axis];i&&a&&(i.values=a,r=Pr(i,n,this._cachedMeta.index)),e.min=Math.min(e.min,r),e.max=Math.max(e.max,r)}getMinMax(e,t){const s=this._cachedMeta,i=s._parsed,n=s._sorted&&e===s.iScale,r=i.length,a=this._getOtherScale(e),o=((e,t,s)=>e&&!t.hidden&&t._stacked&&{keys:Mr(s,!0),values:null})(t,s,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(e){const{min:t,max:s,minDefined:i,maxDefined:n}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:n?s:Number.POSITIVE_INFINITY}}(a);let h,u;function p(){u=i[h];const t=u[a.axis];return!Hs(u[e.axis])||c>t||d<t}for(h=0;h<r&&(p()||(this.updateRangeFromParsed(l,e,u,o),!n));++h);if(n)for(h=r-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(l,e,u,o);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,s=[];let i,n,r;for(i=0,n=t.length;i<n;++i)r=t[i][e.axis],Hs(r)&&s.push(r);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,s=t.iScale,i=t.vScale,n=this.getParsed(e);return{label:s?""+s.getLabelForValue(n[s.axis]):"",value:i?""+i.getLabelForValue(n[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,s,i,n;return $s(e)?(t=e.top,s=e.right,i=e.bottom,n=e.left):t=s=i=n=e,{top:t,right:s,bottom:i,left:n,disabled:!1===e}}(Vs(this.options.clip,function(e,t,s){if(!1===s)return!1;const i=Tr(e,s),n=Tr(t,s);return{top:n.end,right:i.end,bottom:n.start,left:i.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,s=this._cachedMeta,i=s.data||[],n=t.chartArea,r=[],a=this._drawStart||0,o=this._drawCount||i.length-a,l=this.options.drawActiveElementsOnTop;let c;for(s.dataset&&s.dataset.draw(e,n,a,o),c=a;c<a+o;++c){const t=i[c];t.hidden||(t.active&&l?r.push(t):t.draw(e,n))}for(c=0;c<r.length;++c)r[c].draw(e,n)}getStyle(e,t){const s=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,t,s){const i=this.getDataset();let n;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];n=t.$context||(t.$context=function(e,t,s){return Pn(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:s,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),n.parsed=this.getParsed(e),n.raw=i.data[e],n.index=n.dataIndex=e}else n=this.$context||(this.$context=function(e,t){return Pn(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),n.dataset=i,n.index=n.datasetIndex=this.index;return n.active=!!t,n.mode=s,n}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",s=arguments.length>2?arguments[2]:void 0;const i="active"===t,n=this._cachedDataOpts,r=e+"-"+t,a=n[r],o=this.enableOptionSharing&&ni(s);if(a)return Br(a,o);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),d=i?[`${e}Hover`,"hover",e,""]:[e,""],h=l.getOptionScopes(this.getDataset(),c),u=Object.keys(ln.elements[e]),p=l.resolveNamedOptions(h,u,(()=>this.getContext(s,i,t)),d);return p.$shared&&(p.$shared=o,n[r]=Object.freeze(Br(p,o))),p}_resolveAnimations(e,t,s){const i=this.chart,n=this._cachedDataOpts,r=`animation-${t}`,a=n[r];if(a)return a;let o;if(!1!==i.options.animation){const i=this.chart.config,n=i.datasetAnimationScopeKeys(this._type,t),r=i.getOptionScopes(this.getDataset(),n);o=i.createResolver(r,this.getContext(e,s,t))}const l=new jr(i,o&&o.animations);return o&&o._cacheable&&(n[r]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||zr(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const s=this.resolveDataElementOptions(e,t),i=this._sharedOptions,n=this.getSharedOptions(s),r=this.includeOptions(t,n)||n!==i;return this.updateSharedOptions(n,t,s),{sharedOptions:n,includeOptions:r}}updateElement(e,t,s,i){zr(i)?Object.assign(e,s):this._resolveAnimations(t,i).update(e,s)}updateSharedOptions(e,t,s){e&&!zr(t)&&this._resolveAnimations(void 0,t).update(e,s)}_setStyle(e,t,s,i){e.active=i;const n=this.getStyle(t,i);this._resolveAnimations(t,s,i).update(e,{options:!i&&this.getSharedOptions(n)||n})}removeHoverStyle(e,t,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,t,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,s=this._cachedMeta.data;for(const[a,o,l]of this._syncList)this[a](o,l);this._syncList=[];const i=s.length,n=t.length,r=Math.min(n,i);r&&this.parse(0,r),n>i?this._insertElements(i,n-i,e):n<i&&this._removeElements(n,i-n)}_insertElements(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this._cachedMeta,n=i.data,r=e+t;let a;const o=e=>{for(e.length+=t,a=e.length-1;a>=r;a--)e[a]=e[a-t]};for(o(n),a=e;a<r;++a)n[a]=new this.dataElementType;this._parsing&&o(i._parsed),this.parse(e,t),s&&this.updateElements(n,e,t,"reset")}updateElements(e,t,s,i){}_removeElements(e,t){const s=this._cachedMeta;if(this._parsing){const i=s._parsed.splice(e,t);s._stacked&&Fr(s,i)}s.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,s,i]=e;this[t](s,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}class Hr extends $r{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:s,data:i=[],_dataset:n}=t,r=this.chart._animationsDisabled;let{start:a,count:o}=$i(t,i,r);this._drawStart=a,this._drawCount=o,Hi(t)&&(a=0,o=i.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!n._decimated,s.points=i;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(s,void 0,{animated:!r,options:l},e),this.updateElements(i,a,o,e)}updateElements(e,t,s,i){const n="reset"===i,{iScale:r,vScale:a,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(t,i),h=r.axis,u=a.axis,{spanGaps:p,segment:f}=this.options,m=yi(p)?p:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||n||"none"===i,v=t+s,b=e.length;let y=t>0&&this.getParsed(t-1);for(let x=0;x<b;++x){const s=e[x],p=g?s:{};if(x<t||x>=v){p.skip=!0;continue}const b=this.getParsed(x),w=zs(b[u]),_=p[h]=r.getPixelForValue(b[h],x),S=p[u]=n||w?a.getBasePixel():a.getPixelForValue(o?this.applyStack(a,b,o):b[u],x);p.skip=isNaN(_)||isNaN(S)||w,p.stop=x>0&&Math.abs(b[h]-y[h])>m,f&&(p.parsed=b,p.raw=l.data[x]),d&&(p.options=c||this.resolveDataElementOptions(x,s.active?"active":i)),g||this.updateElement(s,x,p,i),y=b}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,s=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return s;const n=i[0].size(this.resolveDataElementOptions(0)),r=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,n,r)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function Ur(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Vr{static override(e){Object.assign(Vr.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Ur()}parse(){return Ur()}format(){return Ur()}add(){return Ur()}diff(){return Ur()}startOf(){return Ur()}endOf(){return Ur()}}var Wr=Vr;function qr(e,t,s,i){const{controller:n,data:r,_sorted:a}=e,o=n._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&"r"!==t&&a&&r.length){const a=o._reversePixels?Ri:Pi;if(!i){const i=a(r,t,s);if(l){const{vScale:t}=n._cachedMeta,{_parsed:s}=e,r=s.slice(0,i.lo+1).reverse().findIndex((e=>!zs(e[t.axis])));i.lo-=Math.max(0,r);const a=s.slice(i.hi).findIndex((e=>!zs(e[t.axis])));i.hi+=Math.max(0,a)}return i}if(n._sharedOptions){const e=r[0],i="function"===typeof e.getRange&&e.getRange(t);if(i){const e=a(r,t,s-i),n=a(r,t,s+i);return{lo:e.lo,hi:n.hi}}}}return{lo:0,hi:r.length-1}}function Gr(e,t,s,i,n){const r=e.getSortedVisibleDatasetMetas(),a=s[t];for(let o=0,l=r.length;o<l;++o){const{index:e,data:s}=r[o],{lo:l,hi:c}=qr(r[o],t,a,n);for(let t=l;t<=c;++t){const n=s[t];n.skip||i(n,e,t)}}}function Yr(e,t,s,i,n){const r=[];if(!n&&!e.isPointInArea(t))return r;return Gr(e,s,t,(function(s,a,o){(n||fn(s,e.chartArea,0))&&s.inRange(t.x,t.y,i)&&r.push({element:s,datasetIndex:a,index:o})}),!0),r}function Kr(e,t,s,i,n,r){let a=[];const o=function(e){const t=-1!==e.indexOf("x"),s=-1!==e.indexOf("y");return function(e,i){const n=t?Math.abs(e.x-i.x):0,r=s?Math.abs(e.y-i.y):0;return Math.sqrt(Math.pow(n,2)+Math.pow(r,2))}}(s);let l=Number.POSITIVE_INFINITY;return Gr(e,s,t,(function(s,c,d){const h=s.inRange(t.x,t.y,n);if(i&&!h)return;const u=s.getCenterPoint(n);if(!(!!r||e.isPointInArea(u))&&!h)return;const p=o(t,u);p<l?(a=[{element:s,datasetIndex:c,index:d}],l=p):p===l&&a.push({element:s,datasetIndex:c,index:d})})),a}function Xr(e,t,s,i,n,r){return r||e.isPointInArea(t)?"r"!==s||i?Kr(e,t,s,i,n,r):function(e,t,s,i){let n=[];return Gr(e,s,t,(function(e,s,r){const{startAngle:a,endAngle:o}=e.getProps(["startAngle","endAngle"],i),{angle:l}=ki(e,{x:t.x,y:t.y});Ni(l,a,o)&&n.push({element:e,datasetIndex:s,index:r})})),n}(e,t,s,n):[]}function Jr(e,t,s,i,n){const r=[],a="x"===s?"inXRange":"inYRange";let o=!1;return Gr(e,s,t,((e,i,l)=>{e[a]&&e[a](t[s],n)&&(r.push({element:e,datasetIndex:i,index:l}),o=o||e.inRange(t.x,t.y,n))})),i&&!o?[]:r}var Qr={evaluateInteractionItems:Gr,modes:{index(e,t,s,i){const n=rr(t,e),r=s.axis||"x",a=s.includeInvisible||!1,o=s.intersect?Yr(e,n,r,i,a):Xr(e,n,r,!1,i,a),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach((e=>{const t=o[0].index,s=e.data[t];s&&!s.skip&&l.push({element:s,datasetIndex:e.index,index:t})})),l):[]},dataset(e,t,s,i){const n=rr(t,e),r=s.axis||"xy",a=s.includeInvisible||!1;let o=s.intersect?Yr(e,n,r,i,a):Xr(e,n,r,!1,i,a);if(o.length>0){const t=o[0].datasetIndex,s=e.getDatasetMeta(t).data;o=[];for(let e=0;e<s.length;++e)o.push({element:s[e],datasetIndex:t,index:e})}return o},point:(e,t,s,i)=>Yr(e,rr(t,e),s.axis||"xy",i,s.includeInvisible||!1),nearest(e,t,s,i){const n=rr(t,e),r=s.axis||"xy",a=s.includeInvisible||!1;return Xr(e,n,r,s.intersect,i,a)},x:(e,t,s,i)=>Jr(e,rr(t,e),"x",s.intersect,i),y:(e,t,s,i)=>Jr(e,rr(t,e),"y",s.intersect,i)}};const Zr=["left","top","right","bottom"];function ea(e,t){return e.filter((e=>e.pos===t))}function ta(e,t){return e.filter((e=>-1===Zr.indexOf(e.pos)&&e.box.axis===t))}function sa(e,t){return e.sort(((e,s)=>{const i=t?s:e,n=t?e:s;return i.weight===n.weight?i.index-n.index:i.weight-n.weight}))}function ia(e,t){const s=function(e){const t={};for(const s of e){const{stack:e,pos:i,stackWeight:n}=s;if(!e||!Zr.includes(i))continue;const r=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});r.count++,r.weight+=n}return t}(e),{vBoxMaxWidth:i,hBoxMaxHeight:n}=t;let r,a,o;for(r=0,a=e.length;r<a;++r){o=e[r];const{fullSize:a}=o.box,l=s[o.stack],c=l&&o.stackWeight/l.weight;o.horizontal?(o.width=c?c*i:a&&t.availableWidth,o.height=n):(o.width=i,o.height=c?c*n:a&&t.availableHeight)}return s}function na(e,t,s,i){return Math.max(e[s],t[s])+Math.max(e[i],t[i])}function ra(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function aa(e,t,s,i){const{pos:n,box:r}=s,a=e.maxPadding;if(!$s(n)){s.size&&(e[n]-=s.size);const t=i[s.stack]||{size:0,count:1};t.size=Math.max(t.size,s.horizontal?r.height:r.width),s.size=t.size/t.count,e[n]+=s.size}r.getPadding&&ra(a,r.getPadding());const o=Math.max(0,t.outerWidth-na(a,e,"left","right")),l=Math.max(0,t.outerHeight-na(a,e,"top","bottom")),c=o!==e.w,d=l!==e.h;return e.w=o,e.h=l,s.horizontal?{same:c,other:d}:{same:d,other:c}}function oa(e,t){const s=t.maxPadding;function i(e){const i={left:0,top:0,right:0,bottom:0};return e.forEach((e=>{i[e]=Math.max(t[e],s[e])})),i}return i(e?["left","right"]:["top","bottom"])}function la(e,t,s,i){const n=[];let r,a,o,l,c,d;for(r=0,a=e.length,c=0;r<a;++r){o=e[r],l=o.box,l.update(o.width||t.w,o.height||t.h,oa(o.horizontal,t));const{same:a,other:h}=aa(t,s,o,i);c|=a&&n.length,d=d||h,l.fullSize||n.push(o)}return c&&la(n,t,s,i)||d}function ca(e,t,s,i,n){e.top=s,e.left=t,e.right=t+i,e.bottom=s+n,e.width=i,e.height=n}function da(e,t,s,i){const n=s.padding;let{x:r,y:a}=t;for(const o of e){const e=o.box,l=i[o.stack]||{count:1,placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){const i=t.w*c,r=l.size||e.height;ni(l.start)&&(a=l.start),e.fullSize?ca(e,n.left,a,s.outerWidth-n.right-n.left,r):ca(e,t.left+l.placed,a,i,r),l.start=a,l.placed+=i,a=e.bottom}else{const i=t.h*c,a=l.size||e.width;ni(l.start)&&(r=l.start),e.fullSize?ca(e,r,n.top,a,s.outerHeight-n.bottom-n.top):ca(e,r,t.top+l.placed,a,i),l.start=r,l.placed+=i,r=e.right}}t.x=r,t.y=a}var ha={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const s=e.boxes?e.boxes.indexOf(t):-1;-1!==s&&e.boxes.splice(s,1)},configure(e,t,s){t.fullSize=s.fullSize,t.position=s.position,t.weight=s.weight},update(e,t,s,i){if(!e)return;const n=jn(e.options.layout.padding),r=Math.max(t-n.width,0),a=Math.max(s-n.height,0),o=function(e){const t=function(e){const t=[];let s,i,n,r,a,o;for(s=0,i=(e||[]).length;s<i;++s)n=e[s],({position:r,options:{stack:a,stackWeight:o=1}}=n),t.push({index:s,box:n,pos:r,horizontal:n.isHorizontal(),weight:n.weight,stack:a&&r+a,stackWeight:o});return t}(e),s=sa(t.filter((e=>e.box.fullSize)),!0),i=sa(ea(t,"left"),!0),n=sa(ea(t,"right")),r=sa(ea(t,"top"),!0),a=sa(ea(t,"bottom")),o=ta(t,"x"),l=ta(t,"y");return{fullSize:s,leftAndTop:i.concat(r),rightAndBottom:n.concat(l).concat(a).concat(o),chartArea:ea(t,"chartArea"),vertical:i.concat(n).concat(l),horizontal:r.concat(a).concat(o)}}(e.boxes),l=o.vertical,c=o.horizontal;Gs(e.boxes,(e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()}));const d=l.reduce(((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1),0)||1,h=Object.freeze({outerWidth:t,outerHeight:s,padding:n,availableWidth:r,availableHeight:a,vBoxMaxWidth:r/2/d,hBoxMaxHeight:a/2}),u=Object.assign({},n);ra(u,jn(i));const p=Object.assign({maxPadding:u,w:r,h:a,x:n.left,y:n.top},n),f=ia(l.concat(c),h);la(o.fullSize,p,h,f),la(l,p,h,f),la(c,p,h,f)&&la(l,p,h,f),function(e){const t=e.maxPadding;function s(s){const i=Math.max(t[s]-e[s],0);return e[s]+=i,i}e.y+=s("top"),e.x+=s("left"),s("right"),s("bottom")}(p),da(o.leftAndTop,p,h,f),p.x+=p.w,p.y+=p.h,da(o.rightAndBottom,p,h,f),e.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Gs(o.chartArea,(t=>{const s=t.box;Object.assign(s,e.chartArea),s.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})}))}};class ua{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,s){}removeEventListener(e,t,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,s,i){return t=Math.max(0,t||e.width),s=s||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):s)}}isAttached(e){return!0}updateConfig(e){}}class pa extends ua{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const fa="$chartjs",ma={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ga=e=>null===e||""===e;const va=!!cr&&{passive:!0};function ba(e,t,s){e&&e.canvas&&e.canvas.removeEventListener(t,s,va)}function ya(e,t){for(const s of e)if(s===t||s.contains(t))return!0}function xa(e,t,s){const i=e.canvas,n=new MutationObserver((e=>{let t=!1;for(const s of e)t=t||ya(s.addedNodes,i),t=t&&!ya(s.removedNodes,i);t&&s()}));return n.observe(document,{childList:!0,subtree:!0}),n}function wa(e,t,s){const i=e.canvas,n=new MutationObserver((e=>{let t=!1;for(const s of e)t=t||ya(s.removedNodes,i),t=t&&!ya(s.addedNodes,i);t&&s()}));return n.observe(document,{childList:!0,subtree:!0}),n}const _a=new Map;let Sa=0;function ka(){const e=window.devicePixelRatio;e!==Sa&&(Sa=e,_a.forEach(((t,s)=>{s.currentDevicePixelRatio!==e&&t()})))}function Aa(e,t,s){const i=e.canvas,n=i&&er(i);if(!n)return;const r=Fi(((e,t)=>{const i=n.clientWidth;s(e,t),i<n.clientWidth&&s()}),window),a=new ResizeObserver((e=>{const t=e[0],s=t.contentRect.width,i=t.contentRect.height;0===s&&0===i||r(s,i)}));return a.observe(n),function(e,t){_a.size||window.addEventListener("resize",ka),_a.set(e,t)}(e,r),a}function Ca(e,t,s){s&&s.disconnect(),"resize"===t&&function(e){_a.delete(e),_a.size||window.removeEventListener("resize",ka)}(e)}function Ea(e,t,s){const i=e.canvas,n=Fi((t=>{null!==e.ctx&&s(function(e,t){const s=ma[e.type]||e.type,{x:i,y:n}=rr(e,t);return{type:s,chart:t,native:e,x:void 0!==i?i:null,y:void 0!==n?n:null}}(t,e))}),e);return function(e,t,s){e&&e.addEventListener(t,s,va)}(i,t,n),n}class Na extends ua{acquireContext(e,t){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(function(e,t){const s=e.style,i=e.getAttribute("height"),n=e.getAttribute("width");if(e[fa]={initial:{height:i,width:n,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",ga(n)){const t=dr(e,"width");void 0!==t&&(e.width=t)}if(ga(i))if(""===e.style.height)e.height=e.width/(t||2);else{const t=dr(e,"height");void 0!==t&&(e.height=t)}}(e,t),s):null}releaseContext(e){const t=e.canvas;if(!t[fa])return!1;const s=t[fa].initial;["height","width"].forEach((e=>{const i=s[e];zs(i)?t.removeAttribute(e):t.setAttribute(e,i)}));const i=s.style||{};return Object.keys(i).forEach((e=>{t.style[e]=i[e]})),t.width=t.width,delete t[fa],!0}addEventListener(e,t,s){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),n={attach:xa,detach:wa,resize:Aa}[t]||Ea;i[t]=n(e,t,s)}removeEventListener(e,t){const s=e.$proxies||(e.$proxies={}),i=s[t];if(!i)return;({attach:Ca,detach:Ca,resize:Ca}[t]||ba)(e,t,i),s[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,s,i){return or(e,t,s,i)}isAttached(e){const t=e&&er(e);return!(!t||!t.isConnected)}}class ja{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}hasValue(){return yi(this.x)&&yi(this.y)}getProps(e,t){const s=this.$animations;if(!t||!s)return this;const i={};return e.forEach((e=>{i[e]=s[e]&&s[e].active()?s[e]._to:this[e]})),i}}function Ta(e,t){const s=e.options.ticks,i=function(e){const t=e.options.offset,s=e._tickSize(),i=e._length/s+(t?0:1),n=e._maxLength/s;return Math.floor(Math.min(i,n))}(e),n=Math.min(s.maxTicksLimit||i,i),r=s.major.enabled?function(e){const t=[];let s,i;for(s=0,i=e.length;s<i;s++)e[s].major&&t.push(s);return t}(t):[],a=r.length,o=r[0],l=r[a-1],c=[];if(a>n)return function(e,t,s,i){let n,r=0,a=s[0];for(i=Math.ceil(i),n=0;n<e.length;n++)n===a&&(t.push(e[n]),r++,a=s[r*i])}(t,c,r,a/n),c;const d=function(e,t,s){const i=function(e){const t=e.length;let s,i;if(t<2)return!1;for(i=e[0],s=1;s<t;++s)if(e[s]-e[s-1]!==i)return!1;return i}(e),n=t.length/s;if(!i)return Math.max(n,1);const r=function(e){const t=[],s=Math.sqrt(e);let i;for(i=1;i<s;i++)e%i===0&&(t.push(i),t.push(e/i));return s===(0|s)&&t.push(s),t.sort(((e,t)=>e-t)).pop(),t}(i);for(let a=0,o=r.length-1;a<o;a++){const e=r[a];if(e>n)return e}return Math.max(n,1)}(r,t,n);if(a>0){let e,s;const i=a>1?Math.round((l-o)/(a-1)):null;for(Ma(t,c,d,zs(i)?0:o-i,o),e=0,s=a-1;e<s;e++)Ma(t,c,d,r[e],r[e+1]);return Ma(t,c,d,l,zs(i)?t.length:l+i),c}return Ma(t,c,d),c}function Ma(e,t,s,i,n){const r=Vs(i,0),a=Math.min(Vs(n,e.length),e.length);let o,l,c,d=0;for(s=Math.ceil(s),n&&(o=n-i,s=o/Math.floor(o/s)),c=r;c<0;)d++,c=Math.round(r+d*s);for(l=Math.max(r,0);l<a;l++)l===c&&(t.push(e[l]),d++,c=Math.round(r+d*s))}const Pa=(e,t,s)=>"top"===t||"left"===t?e[t]+s:e[t]-s,Ra=(e,t)=>Math.min(t||e,e);function Da(e,t){const s=[],i=e.length/t,n=e.length;let r=0;for(;r<n;r+=i)s.push(e[Math.floor(r)]);return s}function Ia(e,t,s){const i=e.ticks.length,n=Math.min(t,i-1),r=e._startPixel,a=e._endPixel,o=1e-6;let l,c=e.getPixelForTick(n);if(!(s&&(l=1===i?Math.max(c-r,a-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(n-1))/2,c+=n<t?l:-l,c<r-o||c>a+o)))return c}function La(e){return e.drawTicks?e.tickLength:0}function Oa(e,t){if(!e.display)return 0;const s=Tn(e.font,t),i=jn(e.padding);return(Bs(e.text)?e.text.length:1)*s.lineHeight+i.height}function Fa(e,t,s){let i=zi(e);return(s&&"right"!==t||!s&&"right"===t)&&(i=(e=>"left"===e?"right":"right"===e?"left":e)(i)),i}class za extends ja{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:s,_suggestedMax:i}=this;return e=Us(e,Number.POSITIVE_INFINITY),t=Us(t,Number.NEGATIVE_INFINITY),s=Us(s,Number.POSITIVE_INFINITY),i=Us(i,Number.NEGATIVE_INFINITY),{min:Us(e,s),max:Us(t,i),minDefined:Hs(e),maxDefined:Hs(t)}}getMinMax(e){let t,{min:s,max:i,minDefined:n,maxDefined:r}=this.getUserBounds();if(n&&r)return{min:s,max:i};const a=this.getMatchingVisibleMetas();for(let o=0,l=a.length;o<l;++o)t=a[o].controller.getMinMax(this,e),n||(s=Math.min(s,t.min)),r||(i=Math.max(i,t.max));return s=r&&s>i?i:s,i=n&&s>i?s:i,{min:Us(s,Us(i,s)),max:Us(i,Us(s,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){qs(this.options.beforeUpdate,[this])}update(e,t,s){const{beginAtZero:i,grace:n,ticks:r}=this.options,a=r.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,s){const{min:i,max:n}=e,r=Ws(t,(n-i)/2),a=(e,t)=>s&&0===e?0:e+t;return{min:a(i,-Math.abs(r)),max:a(n,r)}}(this,n,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=a<this.ticks.length;this._convertTicksToLabels(o?Da(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),r.display&&(r.autoSkip||"auto"===r.source)&&(this.ticks=Ta(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,s=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,s=!s),this._startPixel=e,this._endPixel=t,this._reversePixels=s,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){qs(this.options.afterUpdate,[this])}beforeSetDimensions(){qs(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){qs(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),qs(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){qs(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let s,i,n;for(s=0,i=e.length;s<i;s++)n=e[s],n.label=qs(t.callback,[n.value,s,e],this)}afterTickToLabelConversion(){qs(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){qs(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,s=Ra(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,n=t.maxRotation;let r,a,o,l=i;if(!this._isVisible()||!t.display||i>=n||s<=1||!this.isHorizontal())return void(this.labelRotation=i);const c=this._getLabelSizes(),d=c.widest.width,h=c.highest.height,u=ji(this.chart.width-d,0,this.maxWidth);r=e.offset?this.maxWidth/s:u/(s-1),d+6>r&&(r=u/(s-(e.offset?.5:1)),a=this.maxHeight-La(e.grid)-t.padding-Oa(e.title,this.chart.options.font),o=Math.sqrt(d*d+h*h),l=_i(Math.min(Math.asin(ji((c.highest.height+6)/r,-1,1)),Math.asin(ji(a/o,-1,1))-Math.asin(ji(h/o,-1,1)))),l=Math.max(i,Math.min(n,l))),this.labelRotation=l}afterCalculateLabelRotation(){qs(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){qs(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:s,title:i,grid:n}}=this,r=this._isVisible(),a=this.isHorizontal();if(r){const r=Oa(i,t.options.font);if(a?(e.width=this.maxWidth,e.height=La(n)+r):(e.height=this.maxHeight,e.width=La(n)+r),s.display&&this.ticks.length){const{first:t,last:i,widest:n,highest:r}=this._getLabelSizes(),o=2*s.padding,l=wi(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(a){const t=s.mirror?0:d*n.width+c*r.height;e.height=Math.min(this.maxHeight,e.height+t+o)}else{const t=s.mirror?0:c*n.width+d*r.height;e.width=Math.min(this.maxWidth,e.width+t+o)}this._calculatePadding(t,i,d,c)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,s,i){const{ticks:{align:n,padding:r},position:a}=this.options,o=0!==this.labelRotation,l="top"!==a&&"x"===this.axis;if(this.isHorizontal()){const a=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,h=0;o?l?(d=i*e.width,h=s*t.height):(d=s*e.height,h=i*t.width):"start"===n?h=t.width:"end"===n?d=e.width:"inner"!==n&&(d=e.width/2,h=t.width/2),this.paddingLeft=Math.max((d-a+r)*this.width/(this.width-a),0),this.paddingRight=Math.max((h-c+r)*this.width/(this.width-c),0)}else{let s=t.height/2,i=e.height/2;"start"===n?(s=0,i=e.height):"end"===n&&(s=t.height,i=0),this.paddingTop=s+r,this.paddingBottom=i+r}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){qs(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,s;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,s=e.length;t<s;t++)zs(e[t].label)&&(e.splice(t,1),s--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let s=this.ticks;t<s.length&&(s=Da(s,t)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,s){const{ctx:i,_longestTextCache:n}=this,r=[],a=[],o=Math.floor(t/Ra(t,s));let l,c,d,h,u,p,f,m,g,v,b,y=0,x=0;for(l=0;l<t;l+=o){if(h=e[l].label,u=this._resolveTickFontOptions(l),i.font=p=u.string,f=n[p]=n[p]||{data:{},gc:[]},m=u.lineHeight,g=v=0,zs(h)||Bs(h)){if(Bs(h))for(c=0,d=h.length;c<d;++c)b=h[c],zs(b)||Bs(b)||(g=cn(i,f.data,f.gc,g,b),v+=m)}else g=cn(i,f.data,f.gc,g,h),v=m;r.push(g),a.push(v),y=Math.max(g,y),x=Math.max(v,x)}!function(e,t){Gs(e,(e=>{const s=e.gc,i=s.length/2;let n;if(i>t){for(n=0;n<i;++n)delete e.data[s[n]];s.splice(0,i)}}))}(n,t);const w=r.indexOf(y),_=a.indexOf(x),S=e=>({width:r[e]||0,height:a[e]||0});return{first:S(0),last:S(t-1),widest:S(w),highest:S(_),widths:r,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return ji(this._alignToPixels?dn(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const s=t[e];return s.$context||(s.$context=function(e,t,s){return Pn(e,{tick:s,index:t,type:"tick"})}(this.getContext(),e,s))}return this.$context||(this.$context=Pn(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=wi(this.labelRotation),s=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),n=this._getLabelSizes(),r=e.autoSkipPadding||0,a=n?n.widest.width+r:0,o=n?n.highest.height+r:0;return this.isHorizontal()?o*s>a*i?a/s:o/i:o*i<a*s?o/s:a/i}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,s=this.chart,i=this.options,{grid:n,position:r,border:a}=i,o=n.offset,l=this.isHorizontal(),c=this.ticks.length+(o?1:0),d=La(n),h=[],u=a.setContext(this.getContext()),p=u.display?u.width:0,f=p/2,m=function(e){return dn(s,e,p)};let g,v,b,y,x,w,_,S,k,A,C,E;if("top"===r)g=m(this.bottom),w=this.bottom-d,S=g-f,A=m(e.top)+f,E=e.bottom;else if("bottom"===r)g=m(this.top),A=e.top,E=m(e.bottom)-f,w=g+f,S=this.top+d;else if("left"===r)g=m(this.right),x=this.right-d,_=g-f,k=m(e.left)+f,C=e.right;else if("right"===r)g=m(this.left),k=e.left,C=m(e.right)-f,x=g+f,_=this.left+d;else if("x"===t){if("center"===r)g=m((e.top+e.bottom)/2+.5);else if($s(r)){const e=Object.keys(r)[0],t=r[e];g=m(this.chart.scales[e].getPixelForValue(t))}A=e.top,E=e.bottom,w=g+f,S=w+d}else if("y"===t){if("center"===r)g=m((e.left+e.right)/2);else if($s(r)){const e=Object.keys(r)[0],t=r[e];g=m(this.chart.scales[e].getPixelForValue(t))}x=g-f,_=x-d,k=e.left,C=e.right}const N=Vs(i.ticks.maxTicksLimit,c),j=Math.max(1,Math.ceil(c/N));for(v=0;v<c;v+=j){const e=this.getContext(v),t=n.setContext(e),i=a.setContext(e),r=t.lineWidth,c=t.color,d=i.dash||[],u=i.dashOffset,p=t.tickWidth,f=t.tickColor,m=t.tickBorderDash||[],g=t.tickBorderDashOffset;b=Ia(this,v,o),void 0!==b&&(y=dn(s,b,r),l?x=_=k=C=y:w=S=A=E=y,h.push({tx1:x,ty1:w,tx2:_,ty2:S,x1:k,y1:A,x2:C,y2:E,width:r,color:c,borderDash:d,borderDashOffset:u,tickWidth:p,tickColor:f,tickBorderDash:m,tickBorderDashOffset:g}))}return this._ticksLength=c,this._borderValue=g,h}_computeLabelItems(e){const t=this.axis,s=this.options,{position:i,ticks:n}=s,r=this.isHorizontal(),a=this.ticks,{align:o,crossAlign:l,padding:c,mirror:d}=n,h=La(s.grid),u=h+c,p=d?-c:u,f=-wi(this.labelRotation),m=[];let g,v,b,y,x,w,_,S,k,A,C,E,N="middle";if("top"===i)w=this.bottom-p,_=this._getXAxisLabelAlignment();else if("bottom"===i)w=this.top+p,_=this._getXAxisLabelAlignment();else if("left"===i){const e=this._getYAxisLabelAlignment(h);_=e.textAlign,x=e.x}else if("right"===i){const e=this._getYAxisLabelAlignment(h);_=e.textAlign,x=e.x}else if("x"===t){if("center"===i)w=(e.top+e.bottom)/2+u;else if($s(i)){const e=Object.keys(i)[0],t=i[e];w=this.chart.scales[e].getPixelForValue(t)+u}_=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===i)x=(e.left+e.right)/2-u;else if($s(i)){const e=Object.keys(i)[0],t=i[e];x=this.chart.scales[e].getPixelForValue(t)}_=this._getYAxisLabelAlignment(h).textAlign}"y"===t&&("start"===o?N="top":"end"===o&&(N="bottom"));const j=this._getLabelSizes();for(g=0,v=a.length;g<v;++g){b=a[g],y=b.label;const e=n.setContext(this.getContext(g));S=this.getPixelForTick(g)+n.labelOffset,k=this._resolveTickFontOptions(g),A=k.lineHeight,C=Bs(y)?y.length:1;const t=C/2,s=e.color,o=e.textStrokeColor,c=e.textStrokeWidth;let h,u=_;if(r?(x=S,"inner"===_&&(u=g===v-1?this.options.reverse?"left":"right":0===g?this.options.reverse?"right":"left":"center"),E="top"===i?"near"===l||0!==f?-C*A+A/2:"center"===l?-j.highest.height/2-t*A+A:-j.highest.height+A/2:"near"===l||0!==f?A/2:"center"===l?j.highest.height/2-t*A:j.highest.height-C*A,d&&(E*=-1),0===f||e.showLabelBackdrop||(x+=A/2*Math.sin(f))):(w=S,E=(1-C)*A/2),e.showLabelBackdrop){const t=jn(e.backdropPadding),s=j.heights[g],i=j.widths[g];let n=E-t.top,r=0-t.left;switch(N){case"middle":n-=s/2;break;case"bottom":n-=s}switch(_){case"center":r-=i/2;break;case"right":r-=i;break;case"inner":g===v-1?r-=i:g>0&&(r-=i/2)}h={left:r,top:n,width:i+t.width,height:s+t.height,color:e.backdropColor}}m.push({label:y,font:k,textOffset:E,options:{rotation:f,color:s,strokeColor:o,strokeWidth:c,textAlign:u,textBaseline:N,translation:[x,w],backdrop:h}})}return m}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-wi(this.labelRotation))return"top"===e?"left":"right";let s="center";return"start"===t.align?s="left":"end"===t.align?s="right":"inner"===t.align&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:s,mirror:i,padding:n}}=this.options,r=e+n,a=this._getLabelSizes().widest.width;let o,l;return"left"===t?i?(l=this.right+n,"near"===s?o="left":"center"===s?(o="center",l+=a/2):(o="right",l+=a)):(l=this.right-r,"near"===s?o="right":"center"===s?(o="center",l-=a/2):(o="left",l=this.left)):"right"===t?i?(l=this.left+n,"near"===s?o="right":"center"===s?(o="center",l-=a/2):(o="left",l-=a)):(l=this.left+r,"near"===s?o="left":"center"===s?(o="center",l+=a/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:s,top:i,width:n,height:r}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(s,i,n,r),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex((t=>t.value===e));if(s>=0){return t.setContext(this.getContext(s)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,s=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let n,r;const a=(e,t,i)=>{i.width&&i.color&&(s.save(),s.lineWidth=i.width,s.strokeStyle=i.color,s.setLineDash(i.borderDash||[]),s.lineDashOffset=i.borderDashOffset,s.beginPath(),s.moveTo(e.x,e.y),s.lineTo(t.x,t.y),s.stroke(),s.restore())};if(t.display)for(n=0,r=i.length;n<r;++n){const e=i[n];t.drawOnChartArea&&a({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&a({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:s,grid:i}}=this,n=s.setContext(this.getContext()),r=s.display?n.width:0;if(!r)return;const a=i.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,d,h;this.isHorizontal()?(l=dn(e,this.left,r)-r/2,c=dn(e,this.right,a)+a/2,d=h=o):(d=dn(e,this.top,r)-r/2,h=dn(e,this.bottom,a)+a/2,l=c=o),t.save(),t.lineWidth=n.width,t.strokeStyle=n.color,t.beginPath(),t.moveTo(l,d),t.lineTo(c,h),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,s=this._computeLabelArea();s&&mn(t,s);const i=this.getLabelItems(e);for(const n of i){const e=n.options,s=n.font;wn(t,n.label,0,n.textOffset,s,e)}s&&gn(t)}drawTitle(){const{ctx:e,options:{position:t,title:s,reverse:i}}=this;if(!s.display)return;const n=Tn(s.font),r=jn(s.padding),a=s.align;let o=n.lineHeight/2;"bottom"===t||"center"===t||$s(t)?(o+=r.bottom,Bs(s.text)&&(o+=n.lineHeight*(s.text.length-1))):o+=r.top;const{titleX:l,titleY:c,maxWidth:d,rotation:h}=function(e,t,s,i){const{top:n,left:r,bottom:a,right:o,chart:l}=e,{chartArea:c,scales:d}=l;let h,u,p,f=0;const m=a-n,g=o-r;if(e.isHorizontal()){if(u=Bi(i,r,o),$s(s)){const e=Object.keys(s)[0],i=s[e];p=d[e].getPixelForValue(i)+m-t}else p="center"===s?(c.bottom+c.top)/2+m-t:Pa(e,s,t);h=o-r}else{if($s(s)){const e=Object.keys(s)[0],i=s[e];u=d[e].getPixelForValue(i)-g+t}else u="center"===s?(c.left+c.right)/2-g+t:Pa(e,s,t);p=Bi(i,a,n),f="left"===s?-ui:ui}return{titleX:u,titleY:p,maxWidth:h,rotation:f}}(this,o,t,a);wn(e,s.text,0,0,n,{color:s.color,maxWidth:d,rotation:h,textAlign:Fa(a,t,i),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,s=Vs(e.grid&&e.grid.z,-1),i=Vs(e.border&&e.border.z,0);return this._isVisible()&&this.draw===za.prototype.draw?[{z:s,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",i=[];let n,r;for(n=0,r=t.length;n<r;++n){const r=t[n];r[s]!==this.id||e&&r.type!==e||i.push(r)}return i}_resolveTickFontOptions(e){return Tn(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Ba{constructor(e,t,s){this.type=e,this.scope=t,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let s;(function(e){return"id"in e&&"defaults"in e})(t)&&(s=this.register(t));const i=this.items,n=e.id,r=this.scope+"."+n;if(!n)throw new Error("class does not have id: "+e);return n in i||(i[n]=e,function(e,t,s){const i=Qs(Object.create(null),[s?ln.get(s):{},ln.get(t),e.defaults]);ln.set(t,i),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((s=>{const i=s.split("."),n=i.pop(),r=[e].concat(i).join("."),a=t[s].split("."),o=a.pop(),l=a.join(".");ln.route(r,n,l,o)}))}(t,e.defaultRoutes);e.descriptors&&ln.describe(t,e.descriptors)}(e,r,s),this.override&&ln.override(e.id,e.overrides)),r}get(e){return this.items[e]}unregister(e){const t=this.items,s=e.id,i=this.scope;s in t&&delete t[s],i&&s in ln[i]&&(delete ln[i][s],this.override&&delete sn[s])}}class $a{constructor(){this.controllers=new Ba($r,"datasets",!0),this.elements=new Ba(ja,"elements"),this.plugins=new Ba(Object,"plugins"),this.scales=new Ba(za,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this._each("unregister",t,this.scales)}_each(e,t,s){[...t].forEach((t=>{const i=s||this._getRegistryForType(t);s||i.isForType(t)||i===this.plugins&&t.id?this._exec(e,i,t):Gs(t,(t=>{const i=s||this._getRegistryForType(t);this._exec(e,i,t)}))}))}_exec(e,t,s){const i=ii(e);qs(s["before"+i],[],s),t[e](s),qs(s["after"+i],[],s)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const s=this._typedRegistries[t];if(s.isForType(e))return s}return this.plugins}_get(e,t,s){const i=t.get(e);if(void 0===i)throw new Error('"'+e+'" is not a registered '+s+".");return i}}var Ha=new $a;class Ua{constructor(){this._init=[]}notify(e,t,s,i){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const n=i?this._descriptors(e).filter(i):this._descriptors(e),r=this._notify(n,e,t,s);return"afterDestroy"===t&&(this._notify(n,e,"stop"),this._notify(this._init,e,"uninstall")),r}_notify(e,t,s,i){i=i||{};for(const n of e){const e=n.plugin;if(!1===qs(e[s],[t,i,n.options],e)&&i.cancelable)return!1}return!0}invalidate(){zs(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const s=e&&e.config,i=Vs(s.options&&s.options.plugins,{}),n=function(e){const t={},s=[],i=Object.keys(Ha.plugins.items);for(let r=0;r<i.length;r++)s.push(Ha.getPlugin(i[r]));const n=e.plugins||[];for(let r=0;r<n.length;r++){const e=n[r];-1===s.indexOf(e)&&(s.push(e),t[e.id]=!0)}return{plugins:s,localIds:t}}(s);return!1!==i||t?function(e,t,s,i){let{plugins:n,localIds:r}=t;const a=[],o=e.getContext();for(const l of n){const t=l.id,n=Va(s[t],i);null!==n&&a.push({plugin:l,options:Wa(e.config,{plugin:l,local:r[t]},n,o)})}return a}(e,n,i,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],s=this._cache,i=(e,t)=>e.filter((e=>!t.some((t=>e.plugin.id===t.plugin.id))));this._notify(i(t,s),e,"stop"),this._notify(i(s,t),e,"start")}}function Va(e,t){return t||!1!==e?!0===e?{}:e:null}function Wa(e,t,s,i){let{plugin:n,local:r}=t;const a=e.pluginScopeKeys(n),o=e.getOptionScopes(s,a);return r&&n.defaults&&o.push(n.defaults),e.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function qa(e,t){const s=ln.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||s.indexAxis||"x"}function Ga(e){if("x"===e||"y"===e||"r"===e)return e}function Ya(e){if(Ga(e))return e;for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];for(const r of s){const t=r.axis||("top"===(n=r.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||e.length>1&&Ga(e[0].toLowerCase());if(t)return t}var n;throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function Ka(e,t,s){if(s[t+"AxisID"]===e)return{axis:t}}function Xa(e,t){const s=sn[e.type]||{scales:{}},i=t.scales||{},n=qa(e.type,t),r=Object.create(null);return Object.keys(i).forEach((t=>{const a=i[t];if(!$s(a))return console.error(`Invalid scale configuration for scale: ${t}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const o=Ya(t,a,function(e,t){if(t.data&&t.data.datasets){const s=t.data.datasets.filter((t=>t.xAxisID===e||t.yAxisID===e));if(s.length)return Ka(e,"x",s[0])||Ka(e,"y",s[0])}return{}}(t,e),ln.scales[a.type]),l=function(e,t){return e===t?"_index_":"_value_"}(o,n),c=s.scales||{};r[t]=Zs(Object.create(null),[{axis:o},a,c[o],c[l]])})),e.data.datasets.forEach((s=>{const n=s.type||e.type,a=s.indexAxis||qa(n,t),o=(sn[n]||{}).scales||{};Object.keys(o).forEach((e=>{const t=function(e,t){let s=e;return"_index_"===e?s=t:"_value_"===e&&(s="x"===t?"y":"x"),s}(e,a),n=s[t+"AxisID"]||t;r[n]=r[n]||Object.create(null),Zs(r[n],[{axis:t},i[n],o[e]])}))})),Object.keys(r).forEach((e=>{const t=r[e];Zs(t,[ln.scales[t.type],ln.scale])})),r}function Ja(e){const t=e.options||(e.options={});t.plugins=Vs(t.plugins,{}),t.scales=Xa(e,t)}function Qa(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Za=new Map,eo=new Set;function to(e,t){let s=Za.get(e);return s||(s=t(),Za.set(e,s),eo.add(s)),s}const so=(e,t,s)=>{const i=si(t,s);void 0!==i&&e.add(i)};class io{constructor(e){this._config=function(e){return(e=e||{}).data=Qa(e.data),Ja(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Qa(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Ja(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return to(e,(()=>[[`datasets.${e}`,""]]))}datasetAnimationScopeKeys(e,t){return to(`${e}.transition.${t}`,(()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]]))}datasetElementScopeKeys(e,t){return to(`${e}-${t}`,(()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]]))}pluginScopeKeys(e){const t=e.id;return to(`${this.type}-plugin-${t}`,(()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]]))}_cachedScopes(e,t){const s=this._scopeCache;let i=s.get(e);return i&&!t||(i=new Map,s.set(e,i)),i}getOptionScopes(e,t,s){const{options:i,type:n}=this,r=this._cachedScopes(e,s),a=r.get(t);if(a)return a;const o=new Set;t.forEach((t=>{e&&(o.add(e),t.forEach((t=>so(o,e,t)))),t.forEach((e=>so(o,i,e))),t.forEach((e=>so(o,sn[n]||{},e))),t.forEach((e=>so(o,ln,e))),t.forEach((e=>so(o,nn,e)))}));const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),eo.has(t)&&r.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,sn[t]||{},ln.datasets[t]||{},{type:t},ln,nn]}resolveNamedOptions(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const n={$shared:!0},{resolver:r,subPrefixes:a}=no(this._resolverCache,e,i);let o=r;if(function(e,t){const{isScriptable:s,isIndexable:i}=In(e);for(const n of t){const t=s(n),r=i(n),a=(r||t)&&e[n];if(t&&(ri(a)||ro(a))||r&&Bs(a))return!0}return!1}(r,t)){n.$shared=!1;o=Dn(r,s=ri(s)?s():s,this.createResolver(e,s,a))}for(const l of t)n[l]=o[l];return n}createResolver(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],i=arguments.length>3?arguments[3]:void 0;const{resolver:n}=no(this._resolverCache,e,s);return $s(t)?Dn(n,t,void 0,i):n}}function no(e,t,s){let i=e.get(t);i||(i=new Map,e.set(t,i));const n=s.join();let r=i.get(n);if(!r){r={resolver:Rn(t,s),subPrefixes:s.filter((e=>!e.toLowerCase().includes("hover")))},i.set(n,r)}return r}const ro=e=>$s(e)&&Object.getOwnPropertyNames(e).some((t=>ri(e[t])));const ao=["top","bottom","left","right","chartArea"];function oo(e,t){return"top"===e||"bottom"===e||-1===ao.indexOf(e)&&"x"===t}function lo(e,t){return function(s,i){return s[e]===i[e]?s[t]-i[t]:s[e]-i[e]}}function co(e){const t=e.chart,s=t.options.animation;t.notifyPlugins("afterRender"),qs(s&&s.onComplete,[e],t)}function ho(e){const t=e.chart,s=t.options.animation;qs(s&&s.onProgress,[e],t)}function uo(e){return Zn()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const po={},fo=e=>{const t=uo(e);return Object.values(po).filter((e=>e.canvas===t)).pop()};function mo(e,t,s){const i=Object.keys(e);for(const n of i){const i=+n;if(i>=t){const r=e[n];delete e[n],(s>0||i>t)&&(e[i+s]=r)}}}function go(e,t,s){return e.options.clip?e[s]:t[s]}class vo{static defaults=(()=>ln)();static instances=(()=>po)();static overrides=(()=>sn)();static registry=(()=>Ha)();static version="4.4.8";static getChart=(()=>fo)();static register(){Ha.add(...arguments),bo()}static unregister(){Ha.remove(...arguments),bo()}constructor(e,t){const s=this.config=new io(t),i=uo(e),n=fo(i);if(n)throw new Error("Canvas is already in use. Chart with ID '"+n.id+"' must be destroyed before the canvas with ID '"+n.canvas.id+"' can be reused.");const r=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||function(e){return!Zn()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?pa:Na}(i)),this.platform.updateConfig(s);const a=this.platform.acquireContext(i,r.aspectRatio),o=a&&a.canvas,l=o&&o.height,c=o&&o.width;this.id=Fs(),this.ctx=a,this.canvas=o,this.width=c,this.height=l,this._options=r,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Ua,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let s;return function(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return t?(clearTimeout(s),s=setTimeout(e,t,n)):e.apply(this,n),t}}((e=>this.update(e)),r.resizeDelay||0),this._dataChanges=[],po[this.id]=this,a&&o?(Ar.listen(this,"complete",co),Ar.listen(this,"progress",ho),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:s,height:i,_aspectRatio:n}=this;return zs(e)?t&&n?n:i?s/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Ha}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():lr(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return hn(this.canvas,this.ctx),this}stop(){return Ar.stop(this),this}resize(e,t){Ar.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const s=this.options,i=this.canvas,n=s.maintainAspectRatio&&this.aspectRatio,r=this.platform.getMaximumSize(i,e,t,n),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=r.width,this.height=r.height,this._aspectRatio=this.aspectRatio,lr(this,a,!0)&&(this.notifyPlugins("resize",{size:r}),qs(s.onResize,[this,r],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){Gs(this.options.scales||{},((e,t)=>{e.id=t}))}buildOrUpdateScales(){const e=this.options,t=e.scales,s=this.scales,i=Object.keys(s).reduce(((e,t)=>(e[t]=!1,e)),{});let n=[];t&&(n=n.concat(Object.keys(t).map((e=>{const s=t[e],i=Ya(e,s),n="r"===i,r="x"===i;return{options:s,dposition:n?"chartArea":r?"bottom":"left",dtype:n?"radialLinear":r?"category":"linear"}})))),Gs(n,(t=>{const n=t.options,r=n.id,a=Ya(r,n),o=Vs(n.type,t.dtype);void 0!==n.position&&oo(n.position,a)===oo(t.dposition)||(n.position=t.dposition),i[r]=!0;let l=null;if(r in s&&s[r].type===o)l=s[r];else{l=new(Ha.getScale(o))({id:r,type:o,ctx:this.ctx,chart:this}),s[l.id]=l}l.init(n,e)})),Gs(i,((e,t)=>{e||delete s[t]})),Gs(s,(e=>{ha.configure(this,e,e.options),ha.addBox(this,e)}))}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,s=e.length;if(e.sort(((e,t)=>e.index-t.index)),s>t){for(let e=t;e<s;++e)this._destroyDatasetMeta(e);e.splice(t,s-t)}this._sortedMetasets=e.slice(0).sort(lo("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach(((e,s)=>{0===t.filter((t=>t===e._dataset)).length&&this._destroyDatasetMeta(s)}))}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let s,i;for(this._removeUnreferencedMetasets(),s=0,i=t.length;s<i;s++){const i=t[s];let n=this.getDatasetMeta(s);const r=i.type||this.config.type;if(n.type&&n.type!==r&&(this._destroyDatasetMeta(s),n=this.getDatasetMeta(s)),n.type=r,n.indexAxis=i.indexAxis||qa(r,this.options),n.order=i.order||0,n.index=s,n.label=""+i.label,n.visible=this.isDatasetVisible(s),n.controller)n.controller.updateIndex(s),n.controller.linkScales();else{const t=Ha.getController(r),{datasetElementType:i,dataElementType:a}=ln.datasets[r];Object.assign(t,{dataElementType:Ha.getElement(a),datasetElementType:i&&Ha.getElement(i)}),n.controller=new t(this,s),e.push(n.controller)}}return this._updateMetasets(),e}_resetElements(){Gs(this.data.datasets,((e,t)=>{this.getDatasetMeta(t).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const s=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const n=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let r=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!i&&-1===n.indexOf(e);e.buildOrUpdateElements(t),r=Math.max(+e.getMaxOverflow(),r)}r=this._minPadding=s.layout.autoPadding?r:0,this._updateLayout(r),i||Gs(n,(e=>{e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(lo("z","_idx"));const{_active:a,_lastEvent:o}=this;o?this._eventHandler(o,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Gs(this.scales,(e=>{ha.removeBox(this,e)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),s=new Set(e.events);ai(t,s)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:s,start:i,count:n}of t){mo(e,i,"_removeElements"===s?-n:n)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,s=t=>new Set(e.filter((e=>e[0]===t)).map(((e,t)=>t+","+e.splice(1).join(",")))),i=s(0);for(let n=1;n<t;n++)if(!ai(i,s(n)))return;return Array.from(i).map((e=>e.split(","))).map((e=>({method:e[1],start:+e[2],count:+e[3]})))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;ha.update(this,this.width,this.height,e);const t=this.chartArea,s=t.width<=0||t.height<=0;this._layers=[],Gs(this.boxes,(e=>{s&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))}),this),this._layers.forEach(((e,t)=>{e._idx=t})),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,s=this.data.datasets.length;t<s;++t)this._updateDataset(t,ri(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const s=this.getDatasetMeta(e),i={meta:s,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(s.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Ar.has(this)?this.attached&&!Ar.running(this)&&Ar.start(this):(this.draw(),co({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,s=[];let i,n;for(i=0,n=t.length;i<n;++i){const n=t[i];e&&!n.visible||s.push(n)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,s=e._clip,i=!s.disabled,n=function(e,t){const{xScale:s,yScale:i}=e;return s&&i?{left:go(s,t,"left"),right:go(s,t,"right"),top:go(i,t,"top"),bottom:go(i,t,"bottom")}:t}(e,this.chartArea),r={meta:e,index:e.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",r)&&(i&&mn(t,{left:!1===s.left?0:n.left-s.left,right:!1===s.right?this.width:n.right+s.right,top:!1===s.top?0:n.top-s.top,bottom:!1===s.bottom?this.height:n.bottom+s.bottom}),e.controller.draw(),i&&gn(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return fn(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,s,i){const n=Qr.modes[t];return"function"===typeof n?n(this,e,s,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],s=this._metasets;let i=s.filter((e=>e&&e._dataset===t)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},s.push(i)),i}getContext(){return this.$context||(this.$context=Pn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const s=this.getDatasetMeta(e);return"boolean"===typeof s.hidden?!s.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,s){const i=s?"show":"hide",n=this.getDatasetMeta(e),r=n.controller._resolveAnimations(void 0,i);ni(t)?(n.data[t].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),r.update(n,{visible:s}),this.update((t=>t.datasetIndex===e?i:void 0)))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Ar.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),hn(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete po[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,s=(s,i)=>{t.addEventListener(this,s,i),e[s]=i},i=(e,t,s)=>{e.offsetX=t,e.offsetY=s,this._eventHandler(e)};Gs(this.options.events,(e=>s(e,i)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,s=(s,i)=>{t.addEventListener(this,s,i),e[s]=i},i=(s,i)=>{e[s]&&(t.removeEventListener(this,s,i),delete e[s])},n=(e,t)=>{this.canvas&&this.resize(e,t)};let r;const a=()=>{i("attach",a),this.attached=!0,this.resize(),s("resize",n),s("detach",r)};r=()=>{this.attached=!1,i("resize",n),this._stop(),this._resize(0,0),s("attach",a)},t.isAttached(this.canvas)?a():r()}unbindEvents(){Gs(this._listeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._listeners={},Gs(this._responsiveListeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._responsiveListeners=void 0}updateHoverStyle(e,t,s){const i=s?"set":"remove";let n,r,a,o;for("dataset"===t&&(n=this.getDatasetMeta(e[0].datasetIndex),n.controller["_"+i+"DatasetHoverStyle"]()),a=0,o=e.length;a<o;++a){r=e[a];const t=r&&this.getDatasetMeta(r.datasetIndex).controller;t&&t[i+"HoverStyle"](r.element,r.datasetIndex,r.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],s=e.map((e=>{let{datasetIndex:t,index:s}=e;const i=this.getDatasetMeta(t);if(!i)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:i.data[s],index:s}}));!Ys(s,t)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,t))}notifyPlugins(e,t,s){return this._plugins.notify(this,e,t,s)}isPluginEnabled(e){return 1===this._plugins._cache.filter((t=>t.plugin.id===e)).length}_updateHoverStyles(e,t,s){const i=this.options.hover,n=(e,t)=>e.filter((e=>!t.some((t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)))),r=n(t,e),a=s?e:n(e,t);r.length&&this.updateHoverStyle(r,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(e,t){const s={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",s,i))return;const n=this._handleEvent(e,t,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,i),(n||s.changed)&&this.render(),this}_handleEvent(e,t,s){const{_active:i=[],options:n}=this,r=t,a=this._getActiveElements(e,i,s,r),o=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,s,i){return s&&"mouseout"!==e.type?i?t:e:null}(e,this._lastEvent,s,o);s&&(this._lastEvent=null,qs(n.onHover,[e,a,this],this),o&&qs(n.onClick,[e,a,this],this));const c=!Ys(a,i);return(c||t)&&(this._active=a,this._updateHoverStyles(a,i,t)),this._lastEvent=l,c}_getActiveElements(e,t,s,i){if("mouseout"===e.type)return[];if(!s)return t;const n=this.options.hover;return this.getElementsAtEventForMode(e,n.mode,n,i)}}function bo(){return Gs(vo.instances,(e=>e._plugins.invalidate()))}function yo(e,t,s,i){const n=Cn(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const r=(s-t)/2,a=Math.min(r,i*t/2),o=e=>{const t=(s-Math.min(r,e))*i/2;return ji(e,0,Math.min(r,t))};return{outerStart:o(n.outerStart),outerEnd:o(n.outerEnd),innerStart:ji(n.innerStart,0,a),innerEnd:ji(n.innerEnd,0,a)}}function xo(e,t,s,i){return{x:s+e*Math.cos(t),y:i+e*Math.sin(t)}}function wo(e,t,s,i,n,r){const{x:a,y:o,startAngle:l,pixelMargin:c,innerRadius:d}=t,h=Math.max(t.outerRadius+i+s-c,0),u=d>0?d+i+s+c:0;let p=0;const f=n-l;if(i){const e=((d>0?d-i:0)+(h>0?h-i:0))/2;p=(f-(0!==e?f*e/(e+i):f))/2}const m=(f-Math.max(.001,f*h-s/oi)/h)/2,g=l+m+p,v=n-m-p,{outerStart:b,outerEnd:y,innerStart:x,innerEnd:w}=yo(t,u,h,v-g),_=h-b,S=h-y,k=g+b/_,A=v-y/S,C=u+x,E=u+w,N=g+x/C,j=v-w/E;if(e.beginPath(),r){const t=(k+A)/2;if(e.arc(a,o,h,k,t),e.arc(a,o,h,t,A),y>0){const t=xo(S,A,a,o);e.arc(t.x,t.y,y,A,v+ui)}const s=xo(E,v,a,o);if(e.lineTo(s.x,s.y),w>0){const t=xo(E,j,a,o);e.arc(t.x,t.y,w,v+ui,j+Math.PI)}const i=(v-w/u+(g+x/u))/2;if(e.arc(a,o,u,v-w/u,i,!0),e.arc(a,o,u,i,g+x/u,!0),x>0){const t=xo(C,N,a,o);e.arc(t.x,t.y,x,N+Math.PI,g-ui)}const n=xo(_,g,a,o);if(e.lineTo(n.x,n.y),b>0){const t=xo(_,k,a,o);e.arc(t.x,t.y,b,g-ui,k)}}else{e.moveTo(a,o);const t=Math.cos(k)*h+a,s=Math.sin(k)*h+o;e.lineTo(t,s);const i=Math.cos(A)*h+a,n=Math.sin(A)*h+o;e.lineTo(i,n)}e.closePath()}function _o(e,t,s,i,n){const{fullCircles:r,startAngle:a,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:d,borderDash:h,borderDashOffset:u}=l,p="inner"===l.borderAlign;if(!c)return;e.setLineDash(h||[]),e.lineDashOffset=u,p?(e.lineWidth=2*c,e.lineJoin=d||"round"):(e.lineWidth=c,e.lineJoin=d||"bevel");let f=t.endAngle;if(r){wo(e,t,s,i,f,n);for(let t=0;t<r;++t)e.stroke();isNaN(o)||(f=a+(o%li||li))}p&&function(e,t,s){const{startAngle:i,pixelMargin:n,x:r,y:a,outerRadius:o,innerRadius:l}=t;let c=n/o;e.beginPath(),e.arc(r,a,o,i-c,s+c),l>n?(c=n/l,e.arc(r,a,l,s+c,i-c,!0)):e.arc(r,a,n,s+ui,i-ui),e.closePath(),e.clip()}(e,t,f),r||(wo(e,t,s,i,f,n),e.stroke())}class So extends ja{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,s){const i=this.getProps(["x","y"],s),{angle:n,distance:r}=ki(i,{x:e,y:t}),{startAngle:a,endAngle:o,innerRadius:l,outerRadius:c,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),h=(this.options.spacing+this.options.borderWidth)/2,u=Vs(d,o-a),p=Ni(n,a,o)&&a!==o,f=u>=li||p,m=Ti(r,l+h,c+h);return f&&m}getCenterPoint(e){const{x:t,y:s,startAngle:i,endAngle:n,innerRadius:r,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:o,spacing:l}=this.options,c=(i+n)/2,d=(r+a+l+o)/2;return{x:t+Math.cos(c)*d,y:s+Math.sin(c)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:s}=this,i=(t.offset||0)/4,n=(t.spacing||0)/2,r=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=s>li?Math.floor(s/li):0,0===s||this.innerRadius<0||this.outerRadius<0)return;e.save();const a=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(a)*i,Math.sin(a)*i);const o=i*(1-Math.sin(Math.min(oi,s||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,s,i,n){const{fullCircles:r,startAngle:a,circumference:o}=t;let l=t.endAngle;if(r){wo(e,t,s,i,l,n);for(let t=0;t<r;++t)e.fill();isNaN(o)||(l=a+(o%li||li))}wo(e,t,s,i,l,n),e.fill()}(e,this,o,n,r),_o(e,this,o,n,r),e.restore()}}function ko(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=Vs(s.borderCapStyle,t.borderCapStyle),e.setLineDash(Vs(s.borderDash,t.borderDash)),e.lineDashOffset=Vs(s.borderDashOffset,t.borderDashOffset),e.lineJoin=Vs(s.borderJoinStyle,t.borderJoinStyle),e.lineWidth=Vs(s.borderWidth,t.borderWidth),e.strokeStyle=Vs(s.borderColor,t.borderColor)}function Ao(e,t,s){e.lineTo(s.x,s.y)}function Co(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=e.length,{start:n=0,end:r=i-1}=s,{start:a,end:o}=t,l=Math.max(n,a),c=Math.min(r,o),d=n<a&&r<a||n>o&&r>o;return{count:i,start:l,loop:t.loop,ilen:c<l&&!d?i+c-l:c-l}}function Eo(e,t,s,i){const{points:n,options:r}=t,{count:a,start:o,loop:l,ilen:c}=Co(n,s,i),d=function(e){return e.stepped?vn:e.tension||"monotone"===e.cubicInterpolationMode?bn:Ao}(r);let h,u,p,{move:f=!0,reverse:m}=i||{};for(h=0;h<=c;++h)u=n[(o+(m?c-h:h))%a],u.skip||(f?(e.moveTo(u.x,u.y),f=!1):d(e,p,u,m,r.stepped),p=u);return l&&(u=n[(o+(m?c:0))%a],d(e,p,u,m,r.stepped)),!!l}function No(e,t,s,i){const n=t.points,{count:r,start:a,ilen:o}=Co(n,s,i),{move:l=!0,reverse:c}=i||{};let d,h,u,p,f,m,g=0,v=0;const b=e=>(a+(c?o-e:e))%r,y=()=>{p!==f&&(e.lineTo(g,f),e.lineTo(g,p),e.lineTo(g,m))};for(l&&(h=n[b(0)],e.moveTo(h.x,h.y)),d=0;d<=o;++d){if(h=n[b(d)],h.skip)continue;const t=h.x,s=h.y,i=0|t;i===u?(s<p?p=s:s>f&&(f=s),g=(v*g+t)/++v):(y(),e.lineTo(t,s),u=i,v=0,p=f=s),m=s}y()}function jo(e){const t=e.options,s=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!s?No:Eo}const To="function"===typeof Path2D;function Mo(e,t,s,i){To&&!t.options.segment?function(e,t,s,i){let n=t._path;n||(n=t._path=new Path2D,t.path(n,s,i)&&n.closePath()),ko(e,t.options),e.stroke(n)}(e,t,s,i):function(e,t,s,i){const{segments:n,options:r}=t,a=jo(t);for(const o of n)ko(e,r,o.style),e.beginPath(),a(e,t,o,{start:s,end:s+i-1})&&e.closePath(),e.stroke()}(e,t,s,i)}class Po extends ja{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const s=this.options;if((s.tension||"monotone"===s.cubicInterpolationMode)&&!s.stepped&&!this._pointsUpdated){const i=s.spanGaps?this._loop:this._fullLoop;Qn(this._points,s,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const s=e.points,i=e.options.spanGaps,n=s.length;if(!n)return[];const r=!!e._loop,{start:a,end:o}=function(e,t,s,i){let n=0,r=t-1;if(s&&!i)for(;n<t&&!e[n].skip;)n++;for(;n<t&&e[n].skip;)n++;for(n%=t,s&&(r+=n);r>n&&e[r%t].skip;)r--;return r%=t,{start:n,end:r}}(s,n,r,i);return wr(e,!0===i?[{start:a,end:o,loop:r}]:function(e,t,s,i){const n=e.length,r=[];let a,o=t,l=e[t];for(a=t+1;a<=s;++a){const s=e[a%n];s.skip||s.stop?l.skip||(i=!1,r.push({start:t%n,end:(a-1)%n,loop:i}),t=o=s.stop?a:null):(o=a,l.skip&&(t=a)),l=s}return null!==o&&r.push({start:t%n,end:o%n,loop:i}),r}(s,a,o<a?o+n:o,!!e._fullLoop&&0===a&&o===n-1),s,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,s=e.length;return s&&t[e[s-1].end]}interpolate(e,t){const s=this.options,i=e[t],n=this.points,r=xr(this,{property:t,start:i,end:i});if(!r.length)return;const a=[],o=function(e){return e.stepped?ur:e.tension||"monotone"===e.cubicInterpolationMode?pr:hr}(s);let l,c;for(l=0,c=r.length;l<c;++l){const{start:c,end:d}=r[l],h=n[c],u=n[d];if(h===u){a.push(h);continue}const p=o(h,u,Math.abs((i-h[t])/(u[t]-h[t])),s.stepped);p[t]=e[t],a.push(p)}return 1===a.length?a[0]:a}pathSegment(e,t,s){return jo(this)(e,this,t,s)}path(e,t,s){const i=this.segments,n=jo(this);let r=this._loop;t=t||0,s=s||this.points.length-t;for(const a of i)r&=n(e,this,a,{start:t,end:t+s-1});return!!r}draw(e,t,s,i){const n=this.options||{};(this.points||[]).length&&n.borderWidth&&(e.save(),Mo(e,this,s,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Ro(e,t,s,i){const n=e.options,{[s]:r}=e.getProps([s],i);return Math.abs(t-r)<n.radius+n.hitRadius}class Do extends ja{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,s){const i=this.options,{x:n,y:r}=this.getProps(["x","y"],s);return Math.pow(e-n,2)+Math.pow(t-r,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(e,t){return Ro(this,e,"x",t)}inYRange(e,t){return Ro(this,e,"y",t)}getCenterPoint(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const s=this.options;this.skip||s.radius<.1||!fn(this,t,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,un(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}const Io=(e,t)=>{let{boxHeight:s=t,boxWidth:i=t}=e;return e.usePointStyle&&(s=Math.min(s,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:s,itemHeight:Math.max(t,s)}};class Lo extends ja{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,s){this.maxWidth=e,this.maxHeight=t,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=qs(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter((t=>e.filter(t,this.chart.data)))),e.sort&&(t=t.sort(((t,s)=>e.sort(t,s,this.chart.data)))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const s=e.labels,i=Tn(s.font),n=i.size,r=this._computeTitleHeight(),{boxWidth:a,itemHeight:o}=Io(s,n);let l,c;t.font=i.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(r,n,a,o)+10):(c=this.maxHeight,l=this._fitCols(r,i,a,o)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,s,i){const{ctx:n,maxWidth:r,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=i+a;let d=e;n.textAlign="left",n.textBaseline="middle";let h=-1,u=-c;return this.legendItems.forEach(((e,p)=>{const f=s+t/2+n.measureText(e.text).width;(0===p||l[l.length-1]+f+2*a>r)&&(d+=c,l[l.length-(p>0?0:1)]=0,u+=c,h++),o[p]={left:0,top:u,row:h,width:f,height:i},l[l.length-1]+=f+a})),d}_fitCols(e,t,s,i){const{ctx:n,maxHeight:r,options:{labels:{padding:a}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=r-e;let d=a,h=0,u=0,p=0,f=0;return this.legendItems.forEach(((e,r)=>{const{itemWidth:m,itemHeight:g}=function(e,t,s,i,n){const r=function(e,t,s,i){let n=e.text;n&&"string"!==typeof n&&(n=n.reduce(((e,t)=>e.length>t.length?e:t)));return t+s.size/2+i.measureText(n).width}(i,e,t,s),a=function(e,t,s){let i=e;"string"!==typeof t.text&&(i=Oo(t,s));return i}(n,i,t.lineHeight);return{itemWidth:r,itemHeight:a}}(s,t,n,e,i);r>0&&u+g+2*a>c&&(d+=h+a,l.push({width:h,height:u}),p+=h+a,f++,h=u=0),o[r]={left:p,top:u,col:f,width:m,height:g},h=Math.max(h,m),u+=g+a})),d+=h,l.push({width:h,height:u}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:s,labels:{padding:i},rtl:n}}=this,r=fr(n,this.left,this.width);if(this.isHorizontal()){let n=0,a=Bi(s,this.left+i,this.right-this.lineWidths[n]);for(const o of t)n!==o.row&&(n=o.row,a=Bi(s,this.left+i,this.right-this.lineWidths[n])),o.top+=this.top+e+i,o.left=r.leftForLtr(r.x(a),o.width),a+=o.width+i}else{let n=0,a=Bi(s,this.top+e+i,this.bottom-this.columnSizes[n].height);for(const o of t)o.col!==n&&(n=o.col,a=Bi(s,this.top+e+i,this.bottom-this.columnSizes[n].height)),o.top=a,o.left+=this.left+i,o.left=r.leftForLtr(r.x(o.left),o.width),a+=o.height+i}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;mn(e,this),this._draw(),gn(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:s,ctx:i}=this,{align:n,labels:r}=e,a=ln.color,o=fr(e.rtl,this.left,this.width),l=Tn(r.font),{padding:c}=r,d=l.size,h=d/2;let u;this.drawTitle(),i.textAlign=o.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;const{boxWidth:p,boxHeight:f,itemHeight:m}=Io(r,d),g=this.isHorizontal(),v=this._computeTitleHeight();u=g?{x:Bi(n,this.left+c,this.right-s[0]),y:this.top+c+v,line:0}:{x:this.left+c,y:Bi(n,this.top+v+c,this.bottom-t[0].height),line:0},mr(this.ctx,e.textDirection);const b=m+c;this.legendItems.forEach(((y,x)=>{i.strokeStyle=y.fontColor,i.fillStyle=y.fontColor;const w=i.measureText(y.text).width,_=o.textAlign(y.textAlign||(y.textAlign=r.textAlign)),S=p+h+w;let k=u.x,A=u.y;o.setWidth(this.width),g?x>0&&k+S+c>this.right&&(A=u.y+=b,u.line++,k=u.x=Bi(n,this.left+c,this.right-s[u.line])):x>0&&A+b>this.bottom&&(k=u.x=k+t[u.line].width+c,u.line++,A=u.y=Bi(n,this.top+v+c,this.bottom-t[u.line].height));if(function(e,t,s){if(isNaN(p)||p<=0||isNaN(f)||f<0)return;i.save();const n=Vs(s.lineWidth,1);if(i.fillStyle=Vs(s.fillStyle,a),i.lineCap=Vs(s.lineCap,"butt"),i.lineDashOffset=Vs(s.lineDashOffset,0),i.lineJoin=Vs(s.lineJoin,"miter"),i.lineWidth=n,i.strokeStyle=Vs(s.strokeStyle,a),i.setLineDash(Vs(s.lineDash,[])),r.usePointStyle){const a={radius:f*Math.SQRT2/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:n},l=o.xPlus(e,p/2);pn(i,a,l,t+h,r.pointStyleWidth&&p)}else{const r=t+Math.max((d-f)/2,0),a=o.leftForLtr(e,p),l=Nn(s.borderRadius);i.beginPath(),Object.values(l).some((e=>0!==e))?_n(i,{x:a,y:r,w:p,h:f,radius:l}):i.rect(a,r,p,f),i.fill(),0!==n&&i.stroke()}i.restore()}(o.x(k),A,y),k=((e,t,s,i)=>e===(i?"left":"right")?s:"center"===e?(t+s)/2:t)(_,k+p+h,g?k+S:this.right,e.rtl),function(e,t,s){wn(i,s.text,e,t+m/2,l,{strikethrough:s.hidden,textAlign:o.textAlign(s.textAlign)})}(o.x(k),A,y),g)u.x+=S+c;else if("string"!==typeof y.text){const e=l.lineHeight;u.y+=Oo(y,e)+c}else u.y+=b})),gr(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,s=Tn(t.font),i=jn(t.padding);if(!t.display)return;const n=fr(e.rtl,this.left,this.width),r=this.ctx,a=t.position,o=s.size/2,l=i.top+o;let c,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),c=this.top+l,d=Bi(e.align,d,this.right-h);else{const t=this.columnSizes.reduce(((e,t)=>Math.max(e,t.height)),0);c=l+Bi(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const u=Bi(a,d,d+h);r.textAlign=n.textAlign(zi(a)),r.textBaseline="middle",r.strokeStyle=t.color,r.fillStyle=t.color,r.font=s.string,wn(r,t.text,u,c,s)}_computeTitleHeight(){const e=this.options.title,t=Tn(e.font),s=jn(e.padding);return e.display?t.lineHeight+s.height:0}_getLegendItemAt(e,t){let s,i,n;if(Ti(e,this.left,this.right)&&Ti(t,this.top,this.bottom))for(n=this.legendHitBoxes,s=0;s<n.length;++s)if(i=n[s],Ti(e,i.left,i.left+i.width)&&Ti(t,i.top,i.top+i.height))return this.legendItems[s];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const s=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const r=this._hoveredItem,a=(n=s,null!==(i=r)&&null!==n&&i.datasetIndex===n.datasetIndex&&i.index===n.index);r&&!a&&qs(t.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!a&&qs(t.onHover,[e,s,this],this)}else s&&qs(t.onClick,[e,s,this],this);var i,n}}function Oo(e,t){return t*(e.text?e.text.length:0)}var Fo={id:"legend",_element:Lo,start(e,t,s){const i=e.legend=new Lo({ctx:e.ctx,options:s,chart:e});ha.configure(e,i,s),ha.addBox(e,i)},stop(e){ha.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,s){const i=e.legend;ha.configure(e,i,s),i.options=s},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,s){const i=t.datasetIndex,n=s.chart;n.isDatasetVisible(i)?(n.hide(i),t.hidden=!0):(n.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:s,pointStyle:i,textAlign:n,color:r,useBorderRadius:a,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map((e=>{const l=e.controller.getStyle(s?0:void 0),c=jn(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:r,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:n||l.textAlign,borderRadius:a&&(o||l.borderRadius),datasetIndex:e.index}}),this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class zo extends ja{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const s=this.options;if(this.left=0,this.top=0,!s.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=e,this.height=this.bottom=t;const i=Bs(s.text)?s.text.length:1;this._padding=jn(s.padding);const n=i*Tn(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=n:this.width=n}isHorizontal(){const e=this.options.position;return"top"===e||"bottom"===e}_drawArgs(e){const{top:t,left:s,bottom:i,right:n,options:r}=this,a=r.align;let o,l,c,d=0;return this.isHorizontal()?(l=Bi(a,s,n),c=t+e,o=n-s):("left"===r.position?(l=s+e,c=Bi(a,i,t),d=-.5*oi):(l=n-e,c=Bi(a,t,i),d=.5*oi),o=i-t),{titleX:l,titleY:c,maxWidth:o,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const s=Tn(t.font),i=s.lineHeight/2+this._padding.top,{titleX:n,titleY:r,maxWidth:a,rotation:o}=this._drawArgs(i);wn(e,t.text,0,0,s,{color:t.color,maxWidth:a,rotation:o,textAlign:zi(t.align),textBaseline:"middle",translation:[n,r]})}}var Bo={id:"title",_element:zo,start(e,t,s){!function(e,t){const s=new zo({ctx:e.ctx,options:t,chart:e});ha.configure(e,s,t),ha.addBox(e,s),e.titleBlock=s}(e,s)},stop(e){const t=e.titleBlock;ha.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,s){const i=e.titleBlock;ha.configure(e,i,s),i.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};new WeakMap;const $o={average(e){if(!e.length)return!1;let t,s,i=new Set,n=0,r=0;for(t=0,s=e.length;t<s;++t){const s=e[t].element;if(s&&s.hasValue()){const e=s.tooltipPosition();i.add(e.x),n+=e.y,++r}}if(0===r||0===i.size)return!1;return{x:[...i].reduce(((e,t)=>e+t))/i.size,y:n/r}},nearest(e,t){if(!e.length)return!1;let s,i,n,r=t.x,a=t.y,o=Number.POSITIVE_INFINITY;for(s=0,i=e.length;s<i;++s){const i=e[s].element;if(i&&i.hasValue()){const e=Ai(t,i.getCenterPoint());e<o&&(o=e,n=i)}}if(n){const e=n.tooltipPosition();r=e.x,a=e.y}return{x:r,y:a}}};function Ho(e,t){return t&&(Bs(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Uo(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Vo(e,t){const{element:s,datasetIndex:i,index:n}=t,r=e.getDatasetMeta(i).controller,{label:a,value:o}=r.getLabelAndValue(n);return{chart:e,label:a,parsed:r.getParsed(n),raw:e.data.datasets[i].data[n],formattedValue:o,dataset:r.getDataset(),dataIndex:n,datasetIndex:i,element:s}}function Wo(e,t){const s=e.chart.ctx,{body:i,footer:n,title:r}=e,{boxWidth:a,boxHeight:o}=t,l=Tn(t.bodyFont),c=Tn(t.titleFont),d=Tn(t.footerFont),h=r.length,u=n.length,p=i.length,f=jn(t.padding);let m=f.height,g=0,v=i.reduce(((e,t)=>e+t.before.length+t.lines.length+t.after.length),0);if(v+=e.beforeBody.length+e.afterBody.length,h&&(m+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),v){m+=p*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(v-p)*l.lineHeight+(v-1)*t.bodySpacing}u&&(m+=t.footerMarginTop+u*d.lineHeight+(u-1)*t.footerSpacing);let b=0;const y=function(e){g=Math.max(g,s.measureText(e).width+b)};return s.save(),s.font=c.string,Gs(e.title,y),s.font=l.string,Gs(e.beforeBody.concat(e.afterBody),y),b=t.displayColors?a+2+t.boxPadding:0,Gs(i,(e=>{Gs(e.before,y),Gs(e.lines,y),Gs(e.after,y)})),b=0,s.font=d.string,Gs(e.footer,y),s.restore(),g+=f.width,{width:g,height:m}}function qo(e,t,s,i){const{x:n,width:r}=s,{width:a,chartArea:{left:o,right:l}}=e;let c="center";return"center"===i?c=n<=(o+l)/2?"left":"right":n<=r/2?c="left":n>=a-r/2&&(c="right"),function(e,t,s,i){const{x:n,width:r}=i,a=s.caretSize+s.caretPadding;return"left"===e&&n+r+a>t.width||"right"===e&&n-r-a<0||void 0}(c,e,t,s)&&(c="center"),c}function Go(e,t,s){const i=s.yAlign||t.yAlign||function(e,t){const{y:s,height:i}=t;return s<i/2?"top":s>e.height-i/2?"bottom":"center"}(e,s);return{xAlign:s.xAlign||t.xAlign||qo(e,t,s,i),yAlign:i}}function Yo(e,t,s,i){const{caretSize:n,caretPadding:r,cornerRadius:a}=e,{xAlign:o,yAlign:l}=s,c=n+r,{topLeft:d,topRight:h,bottomLeft:u,bottomRight:p}=Nn(a);let f=function(e,t){let{x:s,width:i}=e;return"right"===t?s-=i:"center"===t&&(s-=i/2),s}(t,o);const m=function(e,t,s){let{y:i,height:n}=e;return"top"===t?i+=s:i-="bottom"===t?n+s:n/2,i}(t,l,c);return"center"===l?"left"===o?f+=c:"right"===o&&(f-=c):"left"===o?f-=Math.max(d,u)+n:"right"===o&&(f+=Math.max(h,p)+n),{x:ji(f,0,i.width-t.width),y:ji(m,0,i.height-t.height)}}function Ko(e,t,s){const i=jn(s.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-i.right:e.x+i.left}function Xo(e){return Ho([],Uo(e))}function Jo(e,t){const s=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return s?e.override(s):e}const Qo={beforeTitle:Os,title(e){if(e.length>0){const t=e[0],s=t.chart.data.labels,i=s?s.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return s[t.dataIndex]}return""},afterTitle:Os,beforeBody:Os,beforeLabel:Os,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const s=e.formattedValue;return zs(s)||(t+=s),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Os,afterBody:Os,beforeFooter:Os,footer:Os,afterFooter:Os};function Zo(e,t,s,i){const n=e[t].call(s,i);return"undefined"===typeof n?Qo[t].call(s,i):n}class el extends ja{static positioners=(()=>$o)();constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,s=this.options.setContext(this.getContext()),i=s.enabled&&t.options.animation&&s.animations,n=new jr(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(n)),n}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,s=this._tooltipItems,Pn(e,{tooltip:t,tooltipItems:s,type:"tooltip"})));var e,t,s}getTitle(e,t){const{callbacks:s}=t,i=Zo(s,"beforeTitle",this,e),n=Zo(s,"title",this,e),r=Zo(s,"afterTitle",this,e);let a=[];return a=Ho(a,Uo(i)),a=Ho(a,Uo(n)),a=Ho(a,Uo(r)),a}getBeforeBody(e,t){return Xo(Zo(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:s}=t,i=[];return Gs(e,(e=>{const t={before:[],lines:[],after:[]},n=Jo(s,e);Ho(t.before,Uo(Zo(n,"beforeLabel",this,e))),Ho(t.lines,Zo(n,"label",this,e)),Ho(t.after,Uo(Zo(n,"afterLabel",this,e))),i.push(t)})),i}getAfterBody(e,t){return Xo(Zo(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:s}=t,i=Zo(s,"beforeFooter",this,e),n=Zo(s,"footer",this,e),r=Zo(s,"afterFooter",this,e);let a=[];return a=Ho(a,Uo(i)),a=Ho(a,Uo(n)),a=Ho(a,Uo(r)),a}_createItems(e){const t=this._active,s=this.chart.data,i=[],n=[],r=[];let a,o,l=[];for(a=0,o=t.length;a<o;++a)l.push(Vo(this.chart,t[a]));return e.filter&&(l=l.filter(((t,i,n)=>e.filter(t,i,n,s)))),e.itemSort&&(l=l.sort(((t,i)=>e.itemSort(t,i,s)))),Gs(l,(t=>{const s=Jo(e.callbacks,t);i.push(Zo(s,"labelColor",this,t)),n.push(Zo(s,"labelPointStyle",this,t)),r.push(Zo(s,"labelTextColor",this,t))})),this.labelColors=i,this.labelPointStyles=n,this.labelTextColors=r,this.dataPoints=l,l}update(e,t){const s=this.options.setContext(this.getContext()),i=this._active;let n,r=[];if(i.length){const e=$o[s.position].call(this,i,this._eventPosition);r=this._createItems(s),this.title=this.getTitle(r,s),this.beforeBody=this.getBeforeBody(r,s),this.body=this.getBody(r,s),this.afterBody=this.getAfterBody(r,s),this.footer=this.getFooter(r,s);const t=this._size=Wo(this,s),a=Object.assign({},e,t),o=Go(this.chart,s,a),l=Yo(s,a,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,n={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(n={opacity:0});this._tooltipItems=r,this.$context=void 0,n&&this._resolveAnimations().update(this,n),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,s,i){const n=this.getCaretPosition(e,s,i);t.lineTo(n.x1,n.y1),t.lineTo(n.x2,n.y2),t.lineTo(n.x3,n.y3)}getCaretPosition(e,t,s){const{xAlign:i,yAlign:n}=this,{caretSize:r,cornerRadius:a}=s,{topLeft:o,topRight:l,bottomLeft:c,bottomRight:d}=Nn(a),{x:h,y:u}=e,{width:p,height:f}=t;let m,g,v,b,y,x;return"center"===n?(y=u+f/2,"left"===i?(m=h,g=m-r,b=y+r,x=y-r):(m=h+p,g=m+r,b=y-r,x=y+r),v=m):(g="left"===i?h+Math.max(o,c)+r:"right"===i?h+p-Math.max(l,d)-r:this.caretX,"top"===n?(b=u,y=b-r,m=g-r,v=g+r):(b=u+f,y=b+r,m=g+r,v=g-r),x=b),{x1:m,x2:g,x3:v,y1:b,y2:y,y3:x}}drawTitle(e,t,s){const i=this.title,n=i.length;let r,a,o;if(n){const l=fr(s.rtl,this.x,this.width);for(e.x=Ko(this,s.titleAlign,s),t.textAlign=l.textAlign(s.titleAlign),t.textBaseline="middle",r=Tn(s.titleFont),a=s.titleSpacing,t.fillStyle=s.titleColor,t.font=r.string,o=0;o<n;++o)t.fillText(i[o],l.x(e.x),e.y+r.lineHeight/2),e.y+=r.lineHeight+a,o+1===n&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,t,s,i,n){const r=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:o,boxWidth:l}=n,c=Tn(n.bodyFont),d=Ko(this,"left",n),h=i.x(d),u=o<c.lineHeight?(c.lineHeight-o)/2:0,p=t.y+u;if(n.usePointStyle){const t={radius:Math.min(l,o)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},s=i.leftForLtr(h,l)+l/2,c=p+o/2;e.strokeStyle=n.multiKeyBackground,e.fillStyle=n.multiKeyBackground,un(e,t,s,c),e.strokeStyle=r.borderColor,e.fillStyle=r.backgroundColor,un(e,t,s,c)}else{e.lineWidth=$s(r.borderWidth)?Math.max(...Object.values(r.borderWidth)):r.borderWidth||1,e.strokeStyle=r.borderColor,e.setLineDash(r.borderDash||[]),e.lineDashOffset=r.borderDashOffset||0;const t=i.leftForLtr(h,l),s=i.leftForLtr(i.xPlus(h,1),l-2),a=Nn(r.borderRadius);Object.values(a).some((e=>0!==e))?(e.beginPath(),e.fillStyle=n.multiKeyBackground,_n(e,{x:t,y:p,w:l,h:o,radius:a}),e.fill(),e.stroke(),e.fillStyle=r.backgroundColor,e.beginPath(),_n(e,{x:s,y:p+1,w:l-2,h:o-2,radius:a}),e.fill()):(e.fillStyle=n.multiKeyBackground,e.fillRect(t,p,l,o),e.strokeRect(t,p,l,o),e.fillStyle=r.backgroundColor,e.fillRect(s,p+1,l-2,o-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,t,s){const{body:i}=this,{bodySpacing:n,bodyAlign:r,displayColors:a,boxHeight:o,boxWidth:l,boxPadding:c}=s,d=Tn(s.bodyFont);let h=d.lineHeight,u=0;const p=fr(s.rtl,this.x,this.width),f=function(s){t.fillText(s,p.x(e.x+u),e.y+h/2),e.y+=h+n},m=p.textAlign(r);let g,v,b,y,x,w,_;for(t.textAlign=r,t.textBaseline="middle",t.font=d.string,e.x=Ko(this,m,s),t.fillStyle=s.bodyColor,Gs(this.beforeBody,f),u=a&&"right"!==m?"center"===r?l/2+c:l+2+c:0,y=0,w=i.length;y<w;++y){for(g=i[y],v=this.labelTextColors[y],t.fillStyle=v,Gs(g.before,f),b=g.lines,a&&b.length&&(this._drawColorBox(t,e,y,p,s),h=Math.max(d.lineHeight,o)),x=0,_=b.length;x<_;++x)f(b[x]),h=d.lineHeight;Gs(g.after,f)}u=0,h=d.lineHeight,Gs(this.afterBody,f),e.y-=n}drawFooter(e,t,s){const i=this.footer,n=i.length;let r,a;if(n){const o=fr(s.rtl,this.x,this.width);for(e.x=Ko(this,s.footerAlign,s),e.y+=s.footerMarginTop,t.textAlign=o.textAlign(s.footerAlign),t.textBaseline="middle",r=Tn(s.footerFont),t.fillStyle=s.footerColor,t.font=r.string,a=0;a<n;++a)t.fillText(i[a],o.x(e.x),e.y+r.lineHeight/2),e.y+=r.lineHeight+s.footerSpacing}}drawBackground(e,t,s,i){const{xAlign:n,yAlign:r}=this,{x:a,y:o}=e,{width:l,height:c}=s,{topLeft:d,topRight:h,bottomLeft:u,bottomRight:p}=Nn(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(a+d,o),"top"===r&&this.drawCaret(e,t,s,i),t.lineTo(a+l-h,o),t.quadraticCurveTo(a+l,o,a+l,o+h),"center"===r&&"right"===n&&this.drawCaret(e,t,s,i),t.lineTo(a+l,o+c-p),t.quadraticCurveTo(a+l,o+c,a+l-p,o+c),"bottom"===r&&this.drawCaret(e,t,s,i),t.lineTo(a+u,o+c),t.quadraticCurveTo(a,o+c,a,o+c-u),"center"===r&&"left"===n&&this.drawCaret(e,t,s,i),t.lineTo(a,o+d),t.quadraticCurveTo(a,o,a+d,o),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,s=this.$animations,i=s&&s.x,n=s&&s.y;if(i||n){const s=$o[e.position].call(this,this._active,this._eventPosition);if(!s)return;const r=this._size=Wo(this,e),a=Object.assign({},s,this._size),o=Go(t,e,a),l=Yo(e,a,o,t);i._to===l.x&&n._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=r.width,this.height=r.height,this.caretX=s.x,this.caretY=s.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},n={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const r=jn(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(n,e,i,t),mr(e,t.textDirection),n.y+=r.top,this.drawTitle(n,e,t),this.drawBody(n,e,t),this.drawFooter(n,e,t),gr(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const s=this._active,i=e.map((e=>{let{datasetIndex:t,index:s}=e;const i=this.chart.getDatasetMeta(t);if(!i)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:i.data[s],index:s}})),n=!Ys(s,i),r=this._positionChanged(i,t);(n||r)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,n=this._active||[],r=this._getActiveElements(e,n,t,s),a=this._positionChanged(r,e),o=t||!Ys(r,n)||a;return o&&(this._active=r,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}_getActiveElements(e,t,s,i){const n=this.options;if("mouseout"===e.type)return[];if(!i)return t.filter((e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index)));const r=this.chart.getElementsAtEventForMode(e,n.mode,n,s);return n.reverse&&r.reverse(),r}_positionChanged(e,t){const{caretX:s,caretY:i,options:n}=this,r=$o[n.position].call(this,e,t);return!1!==r&&(s!==r.x||i!==r.y)}}var tl={id:"tooltip",_element:el,positioners:$o,afterInit(e,t,s){s&&(e.tooltip=new el({chart:e,options:s}))},beforeUpdate(e,t,s){e.tooltip&&e.tooltip.initialize(s)},reset(e,t,s){e.tooltip&&e.tooltip.initialize(s)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const s={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",{...s,cancelable:!0}))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",s)}},afterEvent(e,t){if(e.tooltip){const s=t.replay;e.tooltip.handleEvent(t.event,s,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Qo},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function sl(e,t,s,i){const n=e.indexOf(t);if(-1===n)return((e,t,s,i)=>("string"===typeof t?(s=e.push(t)-1,i.unshift({index:s,label:t})):isNaN(t)&&(s=null),s))(e,t,s,i);return n!==e.lastIndexOf(t)?s:n}function il(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class nl extends za{static id="category";static defaults=(()=>({ticks:{callback:il}}))();constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:s,label:i}of t)e[s]===i&&e.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(zs(e))return null;const s=this.getLabels();return((e,t)=>null===e?null:ji(Math.round(e),0,t))(t=isFinite(t)&&s[t]===e?t:sl(s,e,Vs(t,e),this._addedLabels),s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:s,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(s=0),t||(i=this.getLabels().length-1)),this.min=s,this.max=i}buildTicks(){const e=this.min,t=this.max,s=this.options.offset,i=[];let n=this.getLabels();n=0===e&&t===n.length-1?n:n.slice(e,t+1),this._valueRange=Math.max(n.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let r=e;r<=t;r++)i.push({value:r});return i}getLabelForValue(e){return il.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function rl(e,t){const s=[],{bounds:i,step:n,min:r,max:a,precision:o,count:l,maxTicks:c,maxDigits:d,includeBounds:h}=e,u=n||1,p=c-1,{min:f,max:m}=t,g=!zs(r),v=!zs(a),b=!zs(l),y=(m-f)/(d+1);let x,w,_,S,k=bi((m-f)/p/u)*u;if(k<1e-14&&!g&&!v)return[{value:f},{value:m}];S=Math.ceil(m/k)-Math.floor(f/k),S>p&&(k=bi(S*k/p/u)*u),zs(o)||(x=Math.pow(10,o),k=Math.ceil(k*x)/x),"ticks"===i?(w=Math.floor(f/k)*k,_=Math.ceil(m/k)*k):(w=f,_=m),g&&v&&n&&function(e,t){const s=Math.round(e);return s-t<=e&&s+t>=e}((a-r)/n,k/1e3)?(S=Math.round(Math.min((a-r)/k,c)),k=(a-r)/S,w=r,_=a):b?(w=g?r:w,_=v?a:_,S=l-1,k=(_-w)/S):(S=(_-w)/k,S=vi(S,Math.round(S),k/1e3)?Math.round(S):Math.ceil(S));const A=Math.max(Si(k),Si(w));x=Math.pow(10,zs(o)?A:o),w=Math.round(w*x)/x,_=Math.round(_*x)/x;let C=0;for(g&&(h&&w!==r?(s.push({value:r}),w<r&&C++,vi(Math.round((w+C*k)*x)/x,r,al(r,y,e))&&C++):w<r&&C++);C<S;++C){const e=Math.round((w+C*k)*x)/x;if(v&&e>a)break;s.push({value:e})}return v&&h&&_!==a?s.length&&vi(s[s.length-1].value,a,al(a,y,e))?s[s.length-1].value=a:s.push({value:a}):v&&_!==a||s.push({value:_}),s}function al(e,t,s){let{horizontal:i,minRotation:n}=s;const r=wi(n),a=(i?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+e).length;return Math.min(t/a,o)}class ol extends za{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return zs(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:s}=this.getUserBounds();let{min:i,max:n}=this;const r=e=>i=t?i:e,a=e=>n=s?n:e;if(e){const e=gi(i),t=gi(n);e<0&&t<0?a(0):e>0&&t>0&&r(0)}if(i===n){let t=0===n?1:Math.abs(.05*n);a(n+t),e||r(i-t)}this.min=i,this.max=n}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:s,stepSize:i}=e;return i?(t=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,t>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${t} ticks. Limiting to 1000.`),t=1e3)):(t=this.computeTickLimit(),s=s||11),s&&(t=Math.min(s,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const i=rl({maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&xi(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const e=this.ticks;let t=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const i=(s-t)/Math.max(e.length-1,1)/2;t-=i,s+=i}this._startValue=t,this._endValue=s,this._valueRange=s-t}getLabelForValue(e){return Zi(e,this.chart.options.locale,this.options.ticks.format)}}class ll extends ol{static id="linear";static defaults=(()=>({ticks:{callback:tn.formatters.numeric}}))();determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Hs(e)?e:0,this.max=Hs(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,s=wi(this.options.ticks.minRotation),i=(e?Math.sin(s):Math.cos(s))||.001,n=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,n.lineHeight/i))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}tn.formatters.logarithmic;tn.formatters.numeric;const cl={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},dl=Object.keys(cl);function hl(e,t){return e-t}function ul(e,t){if(zs(t))return null;const s=e._adapter,{parser:i,round:n,isoWeekday:r}=e._parseOpts;let a=t;return"function"===typeof i&&i(a),Hs(a)||("string"===typeof i?s.parse(a,i):s.parse(a)),null===a?null:(n&&("week"!==n||!yi(r)&&!0!==r?s.startOf(a,n):s.startOf(a,"isoWeek",r)),+a)}function pl(e,t,s,i){const n=dl.length;for(let r=dl.indexOf(e);r<n-1;++r){const e=cl[dl[r]],n=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((s-t)/(n*e.size))<=i)return dl[r]}return dl[n-1]}function fl(e,t,s){if(s){if(s.length){const{lo:i,hi:n}=Mi(s,t);e[s[i]>=t?s[i]:s[n]]=!0}}else e[t]=!0}function ml(e,t,s){const i=[],n={},r=t.length;let a,o;for(0;a<r;++a)t[a],n[o]=a,i.push({value:o,major:!1});return 0!==r&&s?function(e,t,s,i){const n=e._adapter,r=+n.startOf(t[0].value,i),a=t[t.length-1].value;let o,l;for(r;o<=a;+n.add(o,1,i))s[o],l>=0&&(t[l].major=!0);return t}(e,i,n,s):i}class gl extends za{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=e.time||(e.time={}),i=this._adapter=new Wr(e.adapters.date);i.init(t),Zs(s.displayFormats,i.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:ul(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,s=e.time.unit||"day";let{min:i,max:n,minDefined:r,maxDefined:a}=this.getUserBounds();function o(e){r||isNaN(e.min)||Math.min(i,e.min),a||isNaN(e.max)||Math.max(n,e.max)}r&&a||(o(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||o(this.getMinMax(!1))),Hs(i)&&!isNaN(i)?i:+t.startOf(Date.now(),s),Hs(n)&&!isNaN(n)?n:+t.endOf(Date.now(),s)+1,this.min=Math.min(i,n-1),this.max=Math.max(i+1,n)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(e[0],e[e.length-1]),{min:t,max:s}}buildTicks(){const e=this.options,t=e.time,s=e.ticks,i="labels"===s.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const n=this.min,r=function(e,t,s){let i=0,n=e.length;for(;i<n&&e[i]<t;)0;for(;n>i&&e[n-1]>s;)0;return i>0||n<e.length?e.slice(i,n):e}(i,n,this.max);return this._unit=t.unit||(s.autoSkip?pl(t.minUnit,this.min,this.max,this._getLabelCapacity(n)):function(e,t,s,i,n){for(let r=dl.length-1;r>=dl.indexOf(s);r--){const s=dl[r];if(cl[s].common&&e._adapter.diff(n,i,s)>=t-1)return s}return dl[s?dl.indexOf(s):0]}(this,r.length,t.minUnit,this.min,this.max)),this._majorUnit=s.major.enabled&&"year"!==this._unit?function(e){for(let t=dl.indexOf(e)+1,s=dl.length;t<s;++t)if(cl[dl[t]].common)return dl[t]}(this._unit):void 0,this.initOffsets(i),e.reverse&&r.reverse(),ml(this,r,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((e=>+e.value)))}initOffsets(){let e,t,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=0,n=0;this.options.offset&&s.length&&(this.getDecimalForValue(s[0]),1===s.length?1-e:(this.getDecimalForValue(s[1])-e)/2,this.getDecimalForValue(s[s.length-1]),1===s.length?t:(t-this.getDecimalForValue(s[s.length-2]))/2);const r=s.length<3?.5:.25;ji(i,0,r),ji(n,0,r),this._offsets={start:i,end:n,factor:1/(i+1+n)}}_generate(){const e=this._adapter,t=this.min,s=this.max,i=this.options,n=i.time,r=n.unit||pl(n.minUnit,t,s,this._getLabelCapacity(t)),a=Vs(i.ticks.stepSize,1),o="week"===r&&n.isoWeekday,l=yi(o)||!0===o,c={};let d,h,u=t;if(l&&+e.startOf(u,"isoWeek",o),+e.startOf(u,l?"day":r),e.diff(s,t,r)>1e5*a)throw new Error(t+" and "+s+" are too far apart with stepSize of "+a+" "+r);const p="data"===i.ticks.source&&this.getDataTimestamps();for(0;d<s;+e.add(d,a,r),h++)fl(c,d,p);return d!==s&&"ticks"!==i.bounds&&1!==h||fl(c,d,p),Object.keys(c).sort(hl).map((e=>+e))}getLabelForValue(e){const t=this._adapter,s=this.options.time;return s.tooltipFormat?t.format(e,s.tooltipFormat):t.format(e,s.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,i=this._unit,n=t||s[i];return this._adapter.format(e,n)}_tickFormatFunction(e,t,s,i){const n=this.options,r=n.ticks.callback;if(r)return qs(r,[e,t,s],this);const a=n.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&a[o],d=l&&a[l],h=s[t],u=l&&d&&h&&h.major;return this._adapter.format(e,i||(u?d:c))}generateTickLabels(e){let t,s,i;for(e.length;t<s;++t)e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+s)*t.factor)}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,s=this.ctx.measureText(e).width,i=wi(this.isHorizontal()?t.maxRotation:t.minRotation),n=Math.cos(i),r=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:s*n+a*r,h:s*r+a*n}}_getLabelCapacity(e){const t=this.options.time,s=t.displayFormats,i=s[t.unit]||s.millisecond,n=this._tickFormatFunction(e,0,ml(this,[e],this._majorUnit),i),r=this._getLabelSize(n),a=Math.floor(this.isHorizontal()?this.width/r.w:this.height/r.h)-1;return a>0?a:1}getDataTimestamps(){let e,t,s=this._cache.data||[];if(s.length)return s;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(i.length;e<t;++e)s.concat(i[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(s)}getLabelTimestamps(){const e=this._cache.labels||[];let t,s;if(e.length)return e;const i=this.getLabels();for(i.length;t<s;++t)e.push(ul(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Li(e.sort(hl))}}vo.register(nl,ll,Do,Po,So,Bo,tl,Fo);const vl=()=>{const e=ee(),{user:s}=De(),[i,n]=(0,t.useState)(null),[r,a]=(0,t.useState)(!0),[o,l]=(0,t.useState)({vitals:[],medications:[],appointments:[],conditions:[],alerts:[]}),[c,d]=(0,t.useState)(null),h=function(e){n({message:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"}),setTimeout((()=>n(null)),3e3)};(0,t.useEffect)((()=>{!async function(){try{const{data:{user:e},error:t}=await $e.auth.getUser();if(console.log("Fetched user:",e,"Error:",t),t||!e)return void(window.location.href="/");const{data:s,error:i}=await $e.from("profiles").select("*").eq("id",e.id).single();if(i)throw i;if(s){const e=document.getElementById("user-name");e&&(e.textContent=`${s.first_name} ${s.last_name}`)}}catch(c){console.error("Error fetching profile:",c)}finally{a(!1)}}(),Le();const t=document.getElementById("logout-div");t&&t.addEventListener("click",(async()=>{try{const{error:t}=await $e.auth.signOut();if(t)throw t;h("Logout successful!","success"),setTimeout((()=>{e("/")}),3e3)}catch(c){console.error("Logout error:",c),h("Logout failed. Please try again.","danger")}})),async function(){const e=await $e.auth.getUser();if(!e||!e.data.user)return;const t=e.data.user.id,{data:s,error:i}=await $e.from("emergency_contacts").select("qr_code_url").eq("user_id",t).single();if(i)console.error("Error fetching QR code URL:",i);else if(s&&s.qr_code_url){const e=document.getElementById("qrCodeCard");e&&(e.innerHTML=`<img src="${s.qr_code_url}" alt="QR Code" />`)}}();const s=$e.auth.onAuthStateChange(((t,s)=>{"SIGNED_OUT"===t&&e("/")}));return()=>{s&&"function"===typeof s.unsubscribe&&s.unsubscribe()}}),[e]),(0,t.useEffect)((()=>{u()}),[s]);const u=async()=>{try{a(!0);const[{data:e,error:t},{data:i,error:n},{data:r,error:o},{data:c,error:d},{data:h,error:u}]=await Promise.all([$e.from("vitals").select("*").eq("user_id",s.id).order("date",{ascending:!1}).limit(7),$e.from("medications").select("*").eq("user_id",s.id),$e.from("appointments").select("*").eq("user_id",s.id).order("date",{ascending:!0}).limit(5),$e.from("conditions").select("*").eq("user_id",s.id),$e.from("alerts").select("*").eq("user_id",s.id).eq("status","active")]);if(t)throw t;if(n)throw n;if(o)throw o;if(d)throw d;if(u)throw u;l({vitals:e||[],medications:i||[],appointments:r||[],conditions:c||[],alerts:h||[]})}catch(c){console.error("Error fetching dashboard data:",c),d("Failed to load dashboard data")}finally{a(!1)}};return r?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{id:"dashboard",children:[(0,Pe.jsx)("br",{}),(0,Pe.jsx)("br",{}),(0,Pe.jsxs)("div",{className:"container",children:[i&&(0,Pe.jsx)("div",{className:`alert alert-${i.type} alert-dismissible fade show`,role:"alert",children:i.message}),(0,Pe.jsxs)("div",{className:"home-header",children:[(0,Pe.jsx)("h1",{children:"Welcome to Your Digital Health Passport"}),(0,Pe.jsx)("p",{children:"Your health, managed smarter and more securely."}),(0,Pe.jsxs)("p",{className:"user-welcome",children:["Hello, ",(0,Pe.jsx)("span",{id:"user-name"}),". Here's what's happening today."]})]}),(0,Pe.jsxs)("div",{className:"home-cards",children:[(0,Pe.jsxs)("div",{className:"card",id:"upcoming-appointments-card",children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)(nt,{})}),(0,Pe.jsxs)("div",{className:"content",children:[(0,Pe.jsx)("h3",{children:"Upcoming Appointments"}),(0,Pe.jsx)("p",{children:"View and manage your appointments effortlessly."}),(0,Pe.jsx)(Ee,{to:"/appointments",className:"action-link",children:"View Details"})]})]}),(0,Pe.jsxs)("div",{className:"card",id:"qrCodeCard",children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)(Ot,{})}),(0,Pe.jsxs)("div",{className:"content",children:[(0,Pe.jsx)("h3",{children:"Emergency Contact QR Code"}),(0,Pe.jsx)("p",{children:"Your emergency contact QR code."})]})]}),(0,Pe.jsxs)("div",{className:"card",id:"vaccination-records-card",children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)(Ut,{})}),(0,Pe.jsxs)("div",{className:"content",children:[(0,Pe.jsx)("h3",{children:"Vaccination Records"}),(0,Pe.jsx)("p",{children:"Track and update your vaccination history."}),(0,Pe.jsx)(Ee,{to:"/vaccinations",className:"action-link",children:"View Details"})]})]}),(0,Pe.jsxs)("div",{className:"card",id:"health-records-card",children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)(xt,{})}),(0,Pe.jsxs)("div",{className:"content",children:[(0,Pe.jsx)("h3",{children:"Health Records"}),(0,Pe.jsx)("p",{children:"Access all your health records in one place."}),(0,Pe.jsx)(Ee,{to:"/health-records",className:"action-link",children:"View Details"})]})]}),(0,Pe.jsxs)("div",{className:"card",id:"doctor-consultations-card",children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)(Ht,{})}),(0,Pe.jsxs)("div",{className:"content",children:[(0,Pe.jsx)("h3",{children:"Doctor Consultations"}),(0,Pe.jsx)("p",{children:"Review past doctor consultations and notes."}),(0,Pe.jsx)(Ee,{to:"/consultations",className:"action-link",children:"View Details"})]})]}),(0,Pe.jsxs)("div",{className:"card",id:"medication-history-card",children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)(It,{})}),(0,Pe.jsxs)("div",{className:"content",children:[(0,Pe.jsx)("h3",{children:"Medication History"}),(0,Pe.jsx)("p",{children:"Keep track of your medications and prescriptions."}),(0,Pe.jsx)(Ee,{to:"/medications",className:"action-link",children:"View Details"})]})]}),(0,Pe.jsxs)("div",{className:"card",id:"bone-health-card",children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)(st,{})}),(0,Pe.jsxs)("div",{className:"content",children:[(0,Pe.jsx)("h3",{children:"Bone Health"}),(0,Pe.jsx)("p",{children:"Monitor your bone health status and treatments."}),(0,Pe.jsx)(Ee,{to:"/bone-health",className:"action-link",children:"View Details"})]})]}),(0,Pe.jsxs)("div",{className:"card",id:"emergency-contacts-card",children:[(0,Pe.jsx)("div",{className:"icon",children:(0,Pe.jsx)(et,{})}),(0,Pe.jsxs)("div",{className:"content",children:[(0,Pe.jsx)("h3",{children:"Emergency Contacts"}),(0,Pe.jsx)("p",{children:"Update and view your emergency contact details."}),(0,Pe.jsx)(Ee,{to:"/emergency-contacts",className:"action-link",children:"View Details"})]})]})]})]}),(0,Pe.jsx)("div",{id:"main-content"}),(0,Pe.jsx)("div",{className:"overlay"})]})};var bl=s(139),yl=s.n(bl);const xl=["xxl","xl","lg","md","sm","xs"],wl="xs",_l=t.createContext({prefixes:{},breakpoints:xl,minBreakpoint:wl}),{Consumer:Sl,Provider:kl}=_l;function Al(e,s){const{prefixes:i}=(0,t.useContext)(_l);return e||i[s]||s}function Cl(){const{breakpoints:e}=(0,t.useContext)(_l);return e}function El(){const{minBreakpoint:e}=(0,t.useContext)(_l);return e}const Nl=t.forwardRef(((e,t)=>{let{bsPrefix:s,fluid:i=!1,as:n="div",className:r,...a}=e;const o=Al(s,"container"),l="string"===typeof i?`-${i}`:"-fluid";return(0,Pe.jsx)(n,{ref:t,...a,className:yl()(r,i?`${o}${l}`:o)})}));Nl.displayName="Container";const jl=Nl,Tl=["as","disabled"];function Ml(e){let{tagName:t,disabled:s,href:i,target:n,rel:r,role:a,onClick:o,tabIndex:l=0,type:c}=e;t||(t=null!=i||null!=n||null!=r?"a":"button");const d={tagName:t};if("button"===t)return[{type:c||"button",disabled:s},d];const h=e=>{(s||"a"===t&&function(e){return!e||"#"===e.trim()}(i))&&e.preventDefault(),s?e.stopPropagation():null==o||o(e)};return"a"===t&&(i||(i="#"),s&&(i=void 0)),[{role:null!=a?a:"button",disabled:void 0,tabIndex:s?void 0:l,href:i,target:"a"===t?n:void 0,"aria-disabled":s||void 0,rel:"a"===t?r:void 0,onClick:h,onKeyDown:e=>{" "===e.key&&(e.preventDefault(),h(e))}},d]}const Pl=t.forwardRef(((e,t)=>{let{as:s,disabled:i}=e,n=function(e,t){if(null==e)return{};var s={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;s[i]=e[i]}return s}(e,Tl);const[r,{tagName:a}]=Ml(Object.assign({tagName:s,disabled:i},n));return(0,Pe.jsx)(a,Object.assign({},n,r,{ref:t}))}));Pl.displayName="Button";const Rl=t.forwardRef(((e,t)=>{let{as:s,bsPrefix:i,variant:n="primary",size:r,active:a=!1,disabled:o=!1,className:l,...c}=e;const d=Al(i,"btn"),[h,{tagName:u}]=Ml({tagName:s,disabled:o,...c}),p=u;return(0,Pe.jsx)(p,{...h,...c,ref:t,disabled:o,className:yl()(l,d,a&&"active",n&&`${d}-${n}`,r&&`${d}-${r}`,c.href&&o&&"disabled")})}));Rl.displayName="Button";const Dl=Rl,Il=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:i,as:n="div",...r}=e;const a=Al(s,"row"),o=Cl(),l=El(),c=`${a}-cols`,d=[];return o.forEach((e=>{const t=r[e];let s;delete r[e],null!=t&&"object"===typeof t?({cols:s}=t):s=t;const i=e!==l?`-${e}`:"";null!=s&&d.push(`${c}${i}-${s}`)})),(0,Pe.jsx)(n,{ref:t,...r,className:yl()(i,a,...d)})}));Il.displayName="Row";const Ll=Il;const Ol=t.forwardRef(((e,t)=>{const[{className:s,...i},{as:n="div",bsPrefix:r,spans:a}]=function(e){let{as:t,bsPrefix:s,className:i,...n}=e;s=Al(s,"col");const r=Cl(),a=El(),o=[],l=[];return r.forEach((e=>{const t=n[e];let i,r,c;delete n[e],"object"===typeof t&&null!=t?({span:i,offset:r,order:c}=t):i=t;const d=e!==a?`-${e}`:"";i&&o.push(!0===i?`${s}${d}`:`${s}${d}-${i}`),null!=c&&l.push(`order${d}-${c}`),null!=r&&l.push(`offset${d}-${r}`)})),[{...n,className:yl()(i,...o,...l)},{as:t,bsPrefix:s,spans:o}]}(e);return(0,Pe.jsx)(n,{...i,ref:t,className:yl()(s,!a.length&&r)})}));Ol.displayName="Col";const Fl=Ol,zl=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n="div",...r}=e;return i=Al(i,"card-body"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));zl.displayName="CardBody";const Bl=zl,$l=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n="div",...r}=e;return i=Al(i,"card-footer"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));$l.displayName="CardFooter";const Hl=$l,Ul=t.createContext(null);Ul.displayName="CardHeaderContext";const Vl=Ul,Wl=t.forwardRef(((e,s)=>{let{bsPrefix:i,className:n,as:r="div",...a}=e;const o=Al(i,"card-header"),l=(0,t.useMemo)((()=>({cardHeaderBsPrefix:o})),[o]);return(0,Pe.jsx)(Vl.Provider,{value:l,children:(0,Pe.jsx)(r,{ref:s,...a,className:yl()(n,o)})})}));Wl.displayName="CardHeader";const ql=Wl,Gl=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:i,variant:n,as:r="img",...a}=e;const o=Al(s,"card-img");return(0,Pe.jsx)(r,{ref:t,className:yl()(n?`${o}-${n}`:o,i),...a})}));Gl.displayName="CardImg";const Yl=Gl,Kl=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n="div",...r}=e;return i=Al(i,"card-img-overlay"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));Kl.displayName="CardImgOverlay";const Xl=Kl,Jl=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n="a",...r}=e;return i=Al(i,"card-link"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));Jl.displayName="CardLink";const Ql=Jl,Zl=e=>t.forwardRef(((t,s)=>(0,Pe.jsx)("div",{...t,ref:s,className:yl()(t.className,e)}))),ec=Zl("h6"),tc=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n=ec,...r}=e;return i=Al(i,"card-subtitle"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));tc.displayName="CardSubtitle";const sc=tc,ic=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n="p",...r}=e;return i=Al(i,"card-text"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));ic.displayName="CardText";const nc=ic,rc=Zl("h5"),ac=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n=rc,...r}=e;return i=Al(i,"card-title"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));ac.displayName="CardTitle";const oc=ac,lc=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:i,bg:n,text:r,border:a,body:o=!1,children:l,as:c="div",...d}=e;const h=Al(s,"card");return(0,Pe.jsx)(c,{ref:t,...d,className:yl()(i,h,n&&`bg-${n}`,r&&`text-${r}`,a&&`border-${a}`),children:o?(0,Pe.jsx)(Bl,{children:l}):l})}));lc.displayName="Card";const cc=Object.assign(lc,{Img:Yl,Title:oc,Subtitle:sc,Body:Bl,Link:Ql,Text:nc,Header:ql,Footer:Hl,ImgOverlay:Xl}),dc=!("undefined"===typeof window||!window.document||!window.document.createElement);var hc=!1,uc=!1;try{var pc={get passive(){return hc=!0},get once(){return uc=hc=!0}};dc&&(window.addEventListener("test",pc,pc),window.removeEventListener("test",pc,!0))}catch(yv){}const fc=function(e,t,s,i){if(i&&"boolean"!==typeof i&&!uc){var n=i.once,r=i.capture,a=s;!uc&&n&&(a=s.__once||function e(i){this.removeEventListener(t,e,r),s.call(this,i)},s.__once=a),e.addEventListener(t,a,hc?i:r)}e.addEventListener(t,s,i)};function mc(e){return e&&e.ownerDocument||document}const gc=function(e,t,s,i){var n=i&&"boolean"!==typeof i?i.capture:i;e.removeEventListener(t,s,n),s.__once&&e.removeEventListener(t,s.__once,n)};var vc;function bc(e){if((!vc&&0!==vc||e)&&dc){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),vc=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return vc}const yc=function(e){const s=(0,t.useRef)(e);return(0,t.useEffect)((()=>{s.current=e}),[e]),s};function xc(e){const s=yc(e);return(0,t.useCallback)((function(){return s.current&&s.current(...arguments)}),[s])}const wc=e=>e&&"function"!==typeof e?t=>{e.current=t}:e;const _c=function(e,s){return(0,t.useMemo)((()=>function(e,t){const s=wc(e),i=wc(t);return e=>{s&&s(e),i&&i(e)}}(e,s)),[e,s])};function Sc(e){const s=function(e){const s=(0,t.useRef)(e);return s.current=e,s}(e);(0,t.useEffect)((()=>()=>s.current()),[])}function kc(e,t){return function(e){var t=mc(e);return t&&t.defaultView||window}(e).getComputedStyle(e,t)}var Ac=/([A-Z])/g;var Cc=/^ms-/;function Ec(e){return function(e){return e.replace(Ac,"-$1").toLowerCase()}(e).replace(Cc,"-ms-")}var Nc=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;const jc=function(e,t){var s="",i="";if("string"===typeof t)return e.style.getPropertyValue(Ec(t))||kc(e).getPropertyValue(Ec(t));Object.keys(t).forEach((function(n){var r=t[n];r||0===r?!function(e){return!(!e||!Nc.test(e))}(n)?s+=Ec(n)+": "+r+";":i+=n+"("+r+") ":e.style.removeProperty(Ec(n))})),i&&(s+="transform: "+i+";"),e.style.cssText+=";"+s};const Tc=function(e,t,s,i){return fc(e,t,s,i),function(){gc(e,t,s,i)}};function Mc(e,t,s){void 0===s&&(s=5);var i=!1,n=setTimeout((function(){i||function(e,t,s,i){if(void 0===s&&(s=!1),void 0===i&&(i=!0),e){var n=document.createEvent("HTMLEvents");n.initEvent(t,s,i),e.dispatchEvent(n)}}(e,"transitionend",!0)}),t+s),r=Tc(e,"transitionend",(function(){i=!0}),{once:!0});return function(){clearTimeout(n),r()}}function Pc(e,t,s,i){null==s&&(s=function(e){var t=jc(e,"transitionDuration")||"",s=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*s}(e)||0);var n=Mc(e,s,i),r=Tc(e,"transitionend",t);return function(){n(),r()}}function Rc(e){void 0===e&&(e=mc());try{var t=e.activeElement;return t&&t.nodeName?t:null}catch(yv){return e.body}}function Dc(e,t){return e.contains?e.contains(t):e.compareDocumentPosition?e===t||!!(16&e.compareDocumentPosition(t)):void 0}function Ic(e){const s=function(e){const s=(0,t.useRef)(e);return s.current=e,s}(e);(0,t.useEffect)((()=>()=>s.current()),[])}const Lc=function(e){const s=(0,t.useRef)(e);return(0,t.useEffect)((()=>{s.current=e}),[e]),s};function Oc(e){const s=Lc(e);return(0,t.useCallback)((function(){return s.current&&s.current(...arguments)}),[s])}const Fc=`data-rr-ui-${"modal-open"}`;const zc=class{constructor(){let{ownerDocument:e,handleContainerOverflow:t=!0,isRTL:s=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.handleContainerOverflow=t,this.isRTL=s,this.modals=[],this.ownerDocument=e}getScrollbarWidth(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.defaultView;return Math.abs(t.innerWidth-e.documentElement.clientWidth)}(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(e){}removeModalAttributes(e){}setContainerStyle(e){const t={overflow:"hidden"},s=this.isRTL?"paddingLeft":"paddingRight",i=this.getElement();e.style={overflow:i.style.overflow,[s]:i.style[s]},e.scrollBarWidth&&(t[s]=`${parseInt(jc(i,s)||"0",10)+e.scrollBarWidth}px`),i.setAttribute(Fc,""),jc(i,t)}reset(){[...this.modals].forEach((e=>this.remove(e)))}removeContainerStyle(e){const t=this.getElement();t.removeAttribute(Fc),Object.assign(t.style,e.style)}add(e){let t=this.modals.indexOf(e);return-1!==t?t:(t=this.modals.length,this.modals.push(e),this.setModalAttributes(e),0!==t||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),t)}remove(e){const t=this.modals.indexOf(e);-1!==t&&(this.modals.splice(t,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}isTopModal(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}},Bc=(0,t.createContext)(dc?window:void 0);Bc.Provider;function $c(){return(0,t.useContext)(Bc)}const Hc=(e,t)=>dc?null==e?(t||mc()).body:("function"===typeof e&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null;const Uc=e=>e&&"function"!==typeof e?t=>{e.current=t}:e;const Vc=function(e,s){return(0,t.useMemo)((()=>function(e,t){const s=Uc(e),i=Uc(t);return e=>{s&&s(e),i&&i(e)}}(e,s)),[e,s])},Wc="undefined"!==typeof s.g&&s.g.navigator&&"ReactNative"===s.g.navigator.product,qc="undefined"!==typeof document||Wc?t.useLayoutEffect:t.useEffect;function Gc(e){if(!e||"function"===typeof e)return null;const{major:s}=function(){const e=t.version.split(".");return{major:+e[0],minor:+e[1],patch:+e[2]}}();return s>=19?e.props.ref:e.ref}const Yc=function(e){let{children:s,in:i,onExited:n,mountOnEnter:r,unmountOnExit:a}=e;const o=(0,t.useRef)(null),l=(0,t.useRef)(i),c=Oc(n);(0,t.useEffect)((()=>{i?l.current=!0:c(o.current)}),[i,c]);const d=Vc(o,Gc(s)),h=(0,t.cloneElement)(s,{ref:d});return i?h:a||!l.current&&r?null:h},Kc=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];const Xc=["component"];const Jc=t.forwardRef(((e,s)=>{let{component:i}=e;const n=function(e){let{onEnter:s,onEntering:i,onEntered:n,onExit:r,onExiting:a,onExited:o,addEndListener:l,children:c}=e,d=function(e,t){if(null==e)return{};var s={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;s[i]=e[i]}return s}(e,Kc);const h=(0,t.useRef)(null),u=Vc(h,Gc(c)),p=e=>t=>{e&&h.current&&e(h.current,t)},f=(0,t.useCallback)(p(s),[s]),m=(0,t.useCallback)(p(i),[i]),g=(0,t.useCallback)(p(n),[n]),v=(0,t.useCallback)(p(r),[r]),b=(0,t.useCallback)(p(a),[a]),y=(0,t.useCallback)(p(o),[o]),x=(0,t.useCallback)(p(l),[l]);return Object.assign({},d,{nodeRef:h},s&&{onEnter:f},i&&{onEntering:m},n&&{onEntered:g},r&&{onExit:v},a&&{onExiting:b},o&&{onExited:y},l&&{addEndListener:x},{children:"function"===typeof c?(e,t)=>c(e,Object.assign({},t,{ref:u})):(0,t.cloneElement)(c,{ref:u})})}(function(e,t){if(null==e)return{};var s={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;s[i]=e[i]}return s}(e,Xc));return(0,Pe.jsx)(i,Object.assign({ref:s},n))})),Qc=Jc;function Zc(e){let{children:s,in:i,onExited:n,onEntered:r,transition:a}=e;const[o,l]=(0,t.useState)(!i);i&&o&&l(!1);const c=function(e){let{in:s,onTransition:i}=e;const n=(0,t.useRef)(null),r=(0,t.useRef)(!0),a=Oc(i);return qc((()=>{if(!n.current)return;let e=!1;return a({in:s,element:n.current,initial:r.current,isStale:()=>e}),()=>{e=!0}}),[s,a]),qc((()=>(r.current=!1,()=>{r.current=!0})),[]),n}({in:!!i,onTransition:e=>{Promise.resolve(a(e)).then((()=>{e.isStale()||(e.in?null==r||r(e.element,e.initial):(l(!0),null==n||n(e.element)))}),(t=>{throw e.in||l(!0),t}))}}),d=Vc(c,Gc(s));return o&&!i?null:(0,t.cloneElement)(s,{ref:d})}function ed(e,t,s){return e?(0,Pe.jsx)(Qc,Object.assign({},s,{component:e})):t?(0,Pe.jsx)(Zc,Object.assign({},s,{transition:t})):(0,Pe.jsx)(Yc,Object.assign({},s))}const td=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];let sd;function id(e){const s=$c(),i=e||function(e){return sd||(sd=new zc({ownerDocument:null==e?void 0:e.document})),sd}(s),n=(0,t.useRef)({dialog:null,backdrop:null});return Object.assign(n.current,{add:()=>i.add(n.current),remove:()=>i.remove(n.current),isTopModal:()=>i.isTopModal(n.current),setDialogRef:(0,t.useCallback)((e=>{n.current.dialog=e}),[]),setBackdropRef:(0,t.useCallback)((e=>{n.current.backdrop=e}),[])})}const nd=(0,t.forwardRef)(((e,s)=>{let{show:i=!1,role:n="dialog",className:a,style:o,children:l,backdrop:c=!0,keyboard:d=!0,onBackdropClick:h,onEscapeKeyDown:u,transition:p,runTransition:f,backdropTransition:m,runBackdropTransition:g,autoFocus:v=!0,enforceFocus:b=!0,restoreFocus:y=!0,restoreFocusOptions:x,renderDialog:w,renderBackdrop:_=e=>(0,Pe.jsx)("div",Object.assign({},e)),manager:S,container:k,onShow:A,onHide:C=()=>{},onExit:E,onExited:N,onExiting:j,onEnter:T,onEntering:M,onEntered:P}=e,R=function(e,t){if(null==e)return{};var s={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;s[i]=e[i]}return s}(e,td);const D=$c(),I=function(e,s){const i=$c(),[n,r]=(0,t.useState)((()=>Hc(e,null==i?void 0:i.document)));if(!n){const t=Hc(e);t&&r(t)}return(0,t.useEffect)((()=>{s&&n&&s(n)}),[s,n]),(0,t.useEffect)((()=>{const t=Hc(e);t!==n&&r(t)}),[e,n]),n}(k),L=id(S),O=function(){const e=(0,t.useRef)(!0),s=(0,t.useRef)((()=>e.current));return(0,t.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),s.current}(),F=function(e){const s=(0,t.useRef)(null);return(0,t.useEffect)((()=>{s.current=e})),s.current}(i),[z,B]=(0,t.useState)(!i),$=(0,t.useRef)(null);(0,t.useImperativeHandle)(s,(()=>L),[L]),dc&&!F&&i&&($.current=Rc(null==D?void 0:D.document)),i&&z&&B(!1);const H=Oc((()=>{if(L.add(),Y.current=Tc(document,"keydown",q),G.current=Tc(document,"focus",(()=>setTimeout(V)),!0),A&&A(),v){var e,t;const s=Rc(null!=(e=null==(t=L.dialog)?void 0:t.ownerDocument)?e:null==D?void 0:D.document);L.dialog&&s&&!Dc(L.dialog,s)&&($.current=s,L.dialog.focus())}})),U=Oc((()=>{var e;(L.remove(),null==Y.current||Y.current(),null==G.current||G.current(),y)&&(null==(e=$.current)||null==e.focus||e.focus(x),$.current=null)}));(0,t.useEffect)((()=>{i&&I&&H()}),[i,I,H]),(0,t.useEffect)((()=>{z&&U()}),[z,U]),Ic((()=>{U()}));const V=Oc((()=>{if(!b||!O()||!L.isTopModal())return;const e=Rc(null==D?void 0:D.document);L.dialog&&e&&!Dc(L.dialog,e)&&L.dialog.focus()})),W=Oc((e=>{e.target===e.currentTarget&&(null==h||h(e),!0===c&&C())})),q=Oc((e=>{d&&function(e){return"Escape"===e.code||27===e.keyCode}(e)&&L.isTopModal()&&(null==u||u(e),e.defaultPrevented||C())})),G=(0,t.useRef)(),Y=(0,t.useRef)();if(!I)return null;const K=Object.assign({role:n,ref:L.setDialogRef,"aria-modal":"dialog"===n||void 0},R,{style:o,className:a,tabIndex:-1});let X=w?w(K):(0,Pe.jsx)("div",Object.assign({},K,{children:t.cloneElement(l,{role:"document"})}));X=ed(p,f,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!i,onExit:E,onExiting:j,onExited:function(){B(!0),null==N||N(...arguments)},onEnter:T,onEntering:M,onEntered:P,children:X});let J=null;return c&&(J=_({ref:L.setBackdropRef,onClick:W}),J=ed(m,g,{in:!!i,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:J})),(0,Pe.jsx)(Pe.Fragment,{children:r.createPortal((0,Pe.jsxs)(Pe.Fragment,{children:[J,X]}),I)})}));nd.displayName="Modal";const rd=Object.assign(nd,{Manager:zc});var ad=Function.prototype.bind.call(Function.prototype.call,[].slice);function od(e,t){return ad(e.querySelectorAll(t))}function ld(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}const cd=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",dd=".sticky-top",hd=".navbar-toggler";class ud extends zc{adjustAndStore(e,t,s){const i=t.style[e];t.dataset[e]=i,jc(t,{[e]:`${parseFloat(jc(t,e))+s}px`})}restore(e,t){const s=t.dataset[e];void 0!==s&&(delete t.dataset[e],jc(t,{[e]:s}))}setContainerStyle(e){super.setContainerStyle(e);const t=this.getElement();var s,i;if(i="modal-open",(s=t).classList?s.classList.add(i):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(s,i)||("string"===typeof s.className?s.className=s.className+" "+i:s.setAttribute("class",(s.className&&s.className.baseVal||"")+" "+i)),!e.scrollBarWidth)return;const n=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";od(t,cd).forEach((t=>this.adjustAndStore(n,t,e.scrollBarWidth))),od(t,dd).forEach((t=>this.adjustAndStore(r,t,-e.scrollBarWidth))),od(t,hd).forEach((t=>this.adjustAndStore(r,t,e.scrollBarWidth)))}removeContainerStyle(e){super.removeContainerStyle(e);const t=this.getElement();var s,i;i="modal-open",(s=t).classList?s.classList.remove(i):"string"===typeof s.className?s.className=ld(s.className,i):s.setAttribute("class",ld(s.className&&s.className.baseVal||"",i));const n=this.isRTL?"paddingLeft":"paddingRight",r=this.isRTL?"marginLeft":"marginRight";od(t,cd).forEach((e=>this.restore(n,e))),od(t,dd).forEach((e=>this.restore(r,e))),od(t,hd).forEach((e=>this.restore(r,e)))}}let pd;function fd(e,t){return fd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fd(e,t)}const md=!1,gd=t.createContext(null);var vd="unmounted",bd="exited",yd="entering",xd="entered",wd="exiting",_d=function(e){var s,i;function n(t,s){var i;i=e.call(this,t,s)||this;var n,r=s&&!s.isMounting?t.enter:t.appear;return i.appearStatus=null,t.in?r?(n=bd,i.appearStatus=yd):n=xd:n=t.unmountOnExit||t.mountOnEnter?vd:bd,i.state={status:n},i.nextCallback=null,i}i=e,(s=n).prototype=Object.create(i.prototype),s.prototype.constructor=s,fd(s,i),n.getDerivedStateFromProps=function(e,t){return e.in&&t.status===vd?{status:bd}:null};var a=n.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(e){var t=null;if(e!==this.props){var s=this.state.status;this.props.in?s!==yd&&s!==xd&&(t=yd):s!==yd&&s!==xd||(t=wd)}this.updateStatus(!1,t)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var e,t,s,i=this.props.timeout;return e=t=s=i,null!=i&&"number"!==typeof i&&(e=i.exit,t=i.enter,s=void 0!==i.appear?i.appear:t),{exit:e,enter:t,appear:s}},a.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===yd){if(this.props.unmountOnExit||this.props.mountOnEnter){var s=this.props.nodeRef?this.props.nodeRef.current:r.findDOMNode(this);s&&function(e){e.scrollTop}(s)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===bd&&this.setState({status:vd})},a.performEnter=function(e){var t=this,s=this.props.enter,i=this.context?this.context.isMounting:e,n=this.props.nodeRef?[i]:[r.findDOMNode(this),i],a=n[0],o=n[1],l=this.getTimeouts(),c=i?l.appear:l.enter;!e&&!s||md?this.safeSetState({status:xd},(function(){t.props.onEntered(a)})):(this.props.onEnter(a,o),this.safeSetState({status:yd},(function(){t.props.onEntering(a,o),t.onTransitionEnd(c,(function(){t.safeSetState({status:xd},(function(){t.props.onEntered(a,o)}))}))})))},a.performExit=function(){var e=this,t=this.props.exit,s=this.getTimeouts(),i=this.props.nodeRef?void 0:r.findDOMNode(this);t&&!md?(this.props.onExit(i),this.safeSetState({status:wd},(function(){e.props.onExiting(i),e.onTransitionEnd(s.exit,(function(){e.safeSetState({status:bd},(function(){e.props.onExited(i)}))}))}))):this.safeSetState({status:bd},(function(){e.props.onExited(i)}))},a.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},a.setNextCallback=function(e){var t=this,s=!0;return this.nextCallback=function(i){s&&(s=!1,t.nextCallback=null,e(i))},this.nextCallback.cancel=function(){s=!1},this.nextCallback},a.onTransitionEnd=function(e,t){this.setNextCallback(t);var s=this.props.nodeRef?this.props.nodeRef.current:r.findDOMNode(this),i=null==e&&!this.props.addEndListener;if(s&&!i){if(this.props.addEndListener){var n=this.props.nodeRef?[this.nextCallback]:[s,this.nextCallback],a=n[0],o=n[1];this.props.addEndListener(a,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},a.render=function(){var e=this.state.status;if(e===vd)return null;var s=this.props,i=s.children,n=(s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef,function(e,t){if(null==e)return{};var s={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;s[i]=e[i]}return s}(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return t.createElement(gd.Provider,{value:null},"function"===typeof i?i(e,n):t.cloneElement(t.Children.only(i),n))},n}(t.Component);function Sd(){}_d.contextType=gd,_d.propTypes={},_d.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Sd,onEntering:Sd,onEntered:Sd,onExit:Sd,onExiting:Sd,onExited:Sd},_d.UNMOUNTED=vd,_d.EXITED=bd,_d.ENTERING=yd,_d.ENTERED=xd,_d.EXITING=wd;const kd=_d;function Ad(e,t){const s=jc(e,t)||"",i=-1===s.indexOf("ms")?1e3:1;return parseFloat(s)*i}function Cd(e,t){const s=Ad(e,"transitionDuration"),i=Ad(e,"transitionDelay"),n=Pc(e,(s=>{s.target===e&&(n(),t(s))}),s+i)}const Ed=t.forwardRef(((e,s)=>{let{onEnter:i,onEntering:n,onEntered:a,onExit:o,onExiting:l,onExited:c,addEndListener:d,children:h,childRef:u,...p}=e;const f=(0,t.useRef)(null),m=_c(f,u),g=e=>{var t;m((t=e)&&"setState"in t?r.findDOMNode(t):null!=t?t:null)},v=e=>t=>{e&&f.current&&e(f.current,t)},b=(0,t.useCallback)(v(i),[i]),y=(0,t.useCallback)(v(n),[n]),x=(0,t.useCallback)(v(a),[a]),w=(0,t.useCallback)(v(o),[o]),_=(0,t.useCallback)(v(l),[l]),S=(0,t.useCallback)(v(c),[c]),k=(0,t.useCallback)(v(d),[d]);return(0,Pe.jsx)(kd,{ref:s,...p,onEnter:b,onEntered:x,onEntering:y,onExit:w,onExited:S,onExiting:_,addEndListener:k,nodeRef:f,children:"function"===typeof h?(e,t)=>h(e,{...t,ref:g}):t.cloneElement(h,{ref:g})})})),Nd=Ed,jd={[yd]:"show",[xd]:"show"},Td=t.forwardRef(((e,s)=>{let{className:i,children:n,transitionClasses:r={},onEnter:a,...o}=e;const l={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...o},c=(0,t.useCallback)(((e,t)=>{!function(e){e.offsetHeight}(e),null==a||a(e,t)}),[a]);return(0,Pe.jsx)(Nd,{ref:s,addEndListener:Cd,...l,onEnter:c,childRef:Gc(n),children:(e,s)=>t.cloneElement(n,{...s,className:yl()("fade",i,n.props.className,jd[e],r[e])})})}));Td.displayName="Fade";const Md=Td,Pd=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n="div",...r}=e;return i=Al(i,"modal-body"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));Pd.displayName="ModalBody";const Rd=Pd,Dd=t.createContext({onHide(){}}),Id=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:i,contentClassName:n,centered:r,size:a,fullscreen:o,children:l,scrollable:c,...d}=e;s=Al(s,"modal");const h=`${s}-dialog`,u="string"===typeof o?`${s}-fullscreen-${o}`:`${s}-fullscreen`;return(0,Pe.jsx)("div",{...d,ref:t,className:yl()(h,i,a&&`${s}-${a}`,r&&`${h}-centered`,c&&`${h}-scrollable`,o&&u),children:(0,Pe.jsx)("div",{className:yl()(`${s}-content`,n),children:l})})}));Id.displayName="ModalDialog";const Ld=Id,Od=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n="div",...r}=e;return i=Al(i,"modal-footer"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));Od.displayName="ModalFooter";const Fd=Od;var zd=s(173),Bd=s.n(zd);const $d={"aria-label":Bd().string,onClick:Bd().func,variant:Bd().oneOf(["white"])},Hd=t.forwardRef(((e,t)=>{let{className:s,variant:i,"aria-label":n="Close",...r}=e;return(0,Pe.jsx)("button",{ref:t,type:"button",className:yl()("btn-close",i&&`btn-close-${i}`,s),"aria-label":n,...r})}));Hd.displayName="CloseButton",Hd.propTypes=$d;const Ud=Hd,Vd=t.forwardRef(((e,s)=>{let{closeLabel:i="Close",closeVariant:n,closeButton:r=!1,onHide:a,children:o,...l}=e;const c=(0,t.useContext)(Dd),d=xc((()=>{null==c||c.onHide(),null==a||a()}));return(0,Pe.jsxs)("div",{ref:s,...l,children:[o,r&&(0,Pe.jsx)(Ud,{"aria-label":i,variant:n,onClick:d})]})})),Wd=Vd,qd=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:i,closeLabel:n="Close",closeButton:r=!1,...a}=e;return s=Al(s,"modal-header"),(0,Pe.jsx)(Wd,{ref:t,...a,className:yl()(i,s),closeLabel:n,closeButton:r})}));qd.displayName="ModalHeader";const Gd=qd,Yd=Zl("h4"),Kd=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n=Yd,...r}=e;return i=Al(i,"modal-title"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));Kd.displayName="ModalTitle";const Xd=Kd;function Jd(e){return(0,Pe.jsx)(Md,{...e,timeout:null})}function Qd(e){return(0,Pe.jsx)(Md,{...e,timeout:null})}const Zd=t.forwardRef(((e,s)=>{let{bsPrefix:i,className:n,style:r,dialogClassName:a,contentClassName:o,children:l,dialogAs:c=Ld,"data-bs-theme":d,"aria-labelledby":h,"aria-describedby":u,"aria-label":p,show:f=!1,animation:m=!0,backdrop:g=!0,keyboard:v=!0,onEscapeKeyDown:b,onShow:y,onHide:x,container:w,autoFocus:_=!0,enforceFocus:S=!0,restoreFocus:k=!0,restoreFocusOptions:A,onEntered:C,onExit:E,onExiting:N,onEnter:j,onEntering:T,onExited:M,backdropClassName:P,manager:R,...D}=e;const[I,L]=(0,t.useState)({}),[O,F]=(0,t.useState)(!1),z=(0,t.useRef)(!1),B=(0,t.useRef)(!1),$=(0,t.useRef)(null),[H,U]=(0,t.useState)(null),V=_c(s,U),W=xc(x),q=function(){const{dir:e}=(0,t.useContext)(_l);return"rtl"===e}();i=Al(i,"modal");const G=(0,t.useMemo)((()=>({onHide:W})),[W]);function Y(){return R||function(e){return pd||(pd=new ud(e)),pd}({isRTL:q})}function K(e){if(!dc)return;const t=Y().getScrollbarWidth()>0,s=e.scrollHeight>mc(e).documentElement.clientHeight;L({paddingRight:t&&!s?bc():void 0,paddingLeft:!t&&s?bc():void 0})}const X=xc((()=>{H&&K(H.dialog)}));Sc((()=>{gc(window,"resize",X),null==$.current||$.current()}));const J=()=>{z.current=!0},Q=e=>{z.current&&H&&e.target===H.dialog&&(B.current=!0),z.current=!1},Z=()=>{F(!0),$.current=Pc(H.dialog,(()=>{F(!1)}))},ee=e=>{"static"!==g?B.current||e.target!==e.currentTarget?B.current=!1:null==x||x():(e=>{e.target===e.currentTarget&&Z()})(e)},te=(0,t.useCallback)((e=>(0,Pe.jsx)("div",{...e,className:yl()(`${i}-backdrop`,P,!m&&"show")})),[m,P,i]),se={...r,...I};se.display="block";return(0,Pe.jsx)(Dd.Provider,{value:G,children:(0,Pe.jsx)(rd,{show:f,ref:V,backdrop:g,container:w,keyboard:!0,autoFocus:_,enforceFocus:S,restoreFocus:k,restoreFocusOptions:A,onEscapeKeyDown:e=>{v?null==b||b(e):(e.preventDefault(),"static"===g&&Z())},onShow:y,onHide:x,onEnter:(e,t)=>{e&&K(e),null==j||j(e,t)},onEntering:(e,t)=>{null==T||T(e,t),fc(window,"resize",X)},onEntered:C,onExit:e=>{null==$.current||$.current(),null==E||E(e)},onExiting:N,onExited:e=>{e&&(e.style.display=""),null==M||M(e),gc(window,"resize",X)},manager:Y(),transition:m?Jd:void 0,backdropTransition:m?Qd:void 0,renderBackdrop:te,renderDialog:e=>(0,Pe.jsx)("div",{role:"dialog",...e,style:se,className:yl()(n,i,O&&`${i}-static`,!m&&"show"),onClick:g?ee:void 0,onMouseUp:Q,"data-bs-theme":d,"aria-label":p,"aria-labelledby":h,"aria-describedby":u,children:(0,Pe.jsx)(c,{...D,onMouseDown:J,className:a,contentClassName:o,children:l})})})})}));Zd.displayName="Modal";const eh=Object.assign(Zd,{Body:Rd,Header:Gd,Title:Xd,Footer:Fd,Dialog:Ld,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),th={type:Bd().string,tooltip:Bd().bool,as:Bd().elementType},sh=t.forwardRef(((e,t)=>{let{as:s="div",className:i,type:n="valid",tooltip:r=!1,...a}=e;return(0,Pe.jsx)(s,{...a,ref:t,className:yl()(i,`${n}-${r?"tooltip":"feedback"}`)})}));sh.displayName="Feedback",sh.propTypes=th;const ih=sh,nh=t.createContext({}),rh=t.forwardRef(((e,s)=>{let{id:i,bsPrefix:n,className:r,type:a="checkbox",isValid:o=!1,isInvalid:l=!1,as:c="input",...d}=e;const{controlId:h}=(0,t.useContext)(nh);return n=Al(n,"form-check-input"),(0,Pe.jsx)(c,{...d,ref:s,type:a,id:i||h,className:yl()(r,n,o&&"is-valid",l&&"is-invalid")})}));rh.displayName="FormCheckInput";const ah=rh,oh=t.forwardRef(((e,s)=>{let{bsPrefix:i,className:n,htmlFor:r,...a}=e;const{controlId:o}=(0,t.useContext)(nh);return i=Al(i,"form-check-label"),(0,Pe.jsx)("label",{...a,ref:s,htmlFor:r||o,className:yl()(n,i)})}));oh.displayName="FormCheckLabel";const lh=oh;const ch=t.forwardRef(((e,s)=>{let{id:i,bsPrefix:n,bsSwitchPrefix:r,inline:a=!1,reverse:o=!1,disabled:l=!1,isValid:c=!1,isInvalid:d=!1,feedbackTooltip:h=!1,feedback:u,feedbackType:p,className:f,style:m,title:g="",type:v="checkbox",label:b,children:y,as:x="input",...w}=e;n=Al(n,"form-check"),r=Al(r,"form-switch");const{controlId:_}=(0,t.useContext)(nh),S=(0,t.useMemo)((()=>({controlId:i||_})),[_,i]),k=!y&&null!=b&&!1!==b||function(e,s){return t.Children.toArray(e).some((e=>t.isValidElement(e)&&e.type===s))}(y,lh),A=(0,Pe.jsx)(ah,{...w,type:"switch"===v?"checkbox":v,ref:s,isValid:c,isInvalid:d,disabled:l,as:x});return(0,Pe.jsx)(nh.Provider,{value:S,children:(0,Pe.jsx)("div",{style:m,className:yl()(f,k&&n,a&&`${n}-inline`,o&&`${n}-reverse`,"switch"===v&&r),children:y||(0,Pe.jsxs)(Pe.Fragment,{children:[A,k&&(0,Pe.jsx)(lh,{title:g,children:b}),u&&(0,Pe.jsx)(ih,{type:p,tooltip:h,children:u})]})})})}));ch.displayName="FormCheck";const dh=Object.assign(ch,{Input:ah,Label:lh});s(440);const hh=t.forwardRef(((e,s)=>{let{bsPrefix:i,type:n,size:r,htmlSize:a,id:o,className:l,isValid:c=!1,isInvalid:d=!1,plaintext:h,readOnly:u,as:p="input",...f}=e;const{controlId:m}=(0,t.useContext)(nh);return i=Al(i,"form-control"),(0,Pe.jsx)(p,{...f,type:n,size:a,ref:s,readOnly:u,id:o||m,className:yl()(l,h?`${i}-plaintext`:i,r&&`${i}-${r}`,"color"===n&&`${i}-color`,c&&"is-valid",d&&"is-invalid")})}));hh.displayName="FormControl";const uh=Object.assign(hh,{Feedback:ih}),ph=t.forwardRef(((e,t)=>{let{className:s,bsPrefix:i,as:n="div",...r}=e;return i=Al(i,"form-floating"),(0,Pe.jsx)(n,{ref:t,className:yl()(s,i),...r})}));ph.displayName="FormFloating";const fh=ph,mh=t.forwardRef(((e,s)=>{let{controlId:i,as:n="div",...r}=e;const a=(0,t.useMemo)((()=>({controlId:i})),[i]);return(0,Pe.jsx)(nh.Provider,{value:a,children:(0,Pe.jsx)(n,{...r,ref:s})})}));mh.displayName="FormGroup";const gh=mh,vh=t.forwardRef(((e,s)=>{let{as:i="label",bsPrefix:n,column:r=!1,visuallyHidden:a=!1,className:o,htmlFor:l,...c}=e;const{controlId:d}=(0,t.useContext)(nh);n=Al(n,"form-label");let h="col-form-label";"string"===typeof r&&(h=`${h} ${h}-${r}`);const u=yl()(o,n,a&&"visually-hidden",r&&h);return l=l||d,r?(0,Pe.jsx)(Fl,{ref:s,as:"label",className:u,htmlFor:l,...c}):(0,Pe.jsx)(i,{ref:s,className:u,htmlFor:l,...c})}));vh.displayName="FormLabel";const bh=vh,yh=t.forwardRef(((e,s)=>{let{bsPrefix:i,className:n,id:r,...a}=e;const{controlId:o}=(0,t.useContext)(nh);return i=Al(i,"form-range"),(0,Pe.jsx)("input",{...a,type:"range",ref:s,className:yl()(n,i),id:r||o})}));yh.displayName="FormRange";const xh=yh,wh=t.forwardRef(((e,s)=>{let{bsPrefix:i,size:n,htmlSize:r,className:a,isValid:o=!1,isInvalid:l=!1,id:c,...d}=e;const{controlId:h}=(0,t.useContext)(nh);return i=Al(i,"form-select"),(0,Pe.jsx)("select",{...d,size:r,ref:s,className:yl()(a,i,n&&`${i}-${n}`,o&&"is-valid",l&&"is-invalid"),id:c||h})}));wh.displayName="FormSelect";const _h=wh,Sh=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:i,as:n="small",muted:r,...a}=e;return s=Al(s,"form-text"),(0,Pe.jsx)(n,{...a,ref:t,className:yl()(i,s,r&&"text-muted")})}));Sh.displayName="FormText";const kh=Sh,Ah=t.forwardRef(((e,t)=>(0,Pe.jsx)(dh,{...e,ref:t,type:"switch"})));Ah.displayName="Switch";const Ch=Object.assign(Ah,{Input:dh.Input,Label:dh.Label}),Eh=t.forwardRef(((e,t)=>{let{bsPrefix:s,className:i,children:n,controlId:r,label:a,...o}=e;return s=Al(s,"form-floating"),(0,Pe.jsxs)(gh,{ref:t,className:yl()(i,s),controlId:r,...o,children:[n,(0,Pe.jsx)("label",{htmlFor:r,children:a})]})}));Eh.displayName="FloatingLabel";const Nh=Eh,jh={_ref:Bd().any,validated:Bd().bool,as:Bd().elementType},Th=t.forwardRef(((e,t)=>{let{className:s,validated:i,as:n="form",...r}=e;return(0,Pe.jsx)(n,{...r,ref:t,className:yl()(s,i&&"was-validated")})}));Th.displayName="Form",Th.propTypes=jh;const Mh=Object.assign(Th,{Group:gh,Control:uh,Floating:fh,Check:dh,Switch:Ch,Label:bh,Text:kh,Range:xh,Select:_h,FloatingLabel:Nh});var Ph={d:(e,t)=>{for(var s in t)Ph.o(t,s)&&!Ph.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},Rh=globalThis.pdfjsLib={};Ph.d(Rh,{AbortException:()=>Wu,AnnotationEditorLayer:()=>Lg,AnnotationEditorParamsType:()=>Yh,AnnotationEditorType:()=>Gh,AnnotationEditorUIManager:()=>Tp,AnnotationLayer:()=>vg,AnnotationMode:()=>qh,ColorPicker:()=>Eg,DOMSVGFactory:()=>zm,DrawLayer:()=>Og,FeatureTest:()=>Ku,GlobalWorkerOptions:()=>zf,ImageKind:()=>su,InvalidPDFException:()=>$u,MissingPDFException:()=>Hu,OPS:()=>Eu,OutputScale:()=>wp,PDFDataRangeTransport:()=>Sm,PDFDateString:()=>mp,PDFWorker:()=>Em,PasswordResponses:()=>Nu,PermissionFlag:()=>Kh,PixelsPerInch:()=>ip,RenderingCancelledException:()=>ap,TextLayer:()=>pm,TouchManager:()=>Pp,UnexpectedResponseException:()=>Uu,Util:()=>Ju,VerbosityLevel:()=>Cu,XfaLayer:()=>Bm,build:()=>Dm,createValidAbsoluteUrl:()=>Lu,fetchData:()=>np,getDocument:()=>xm,getFilenameFromUrl:()=>cp,getPdfFilenameFromUrl:()=>dp,getXfaPageViewport:()=>gp,isDataScheme:()=>op,isPdfFile:()=>lp,noContextMenu:()=>pp,normalizeUnicode:()=>ep,setLayerDimensions:()=>xp,shadow:()=>Ou,stopEvent:()=>fp,version:()=>Rm});const Dh="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type),Ih=[1,0,0,1,0,0],Lh=[.001,0,0,.001,0,0],Oh=1.35,Fh=1,zh=2,Bh=4,$h=16,Hh=32,Uh=64,Vh=128,Wh=256,qh={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Gh={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Yh={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},Kh={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Xh=0,Jh=1,Qh=2,Zh=3,eu=3,tu=4,su={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},iu=1,nu=2,ru=3,au=4,ou=5,lu=6,cu=7,du=8,hu=9,uu=10,pu=11,fu=12,mu=13,gu=14,vu=15,bu=16,yu=17,xu=20,wu=1,_u=2,Su=3,ku=4,Au=5,Cu={ERRORS:0,WARNINGS:1,INFOS:5},Eu={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Nu={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ju=Cu.WARNINGS;function Tu(e){Number.isInteger(e)&&(ju=e)}function Mu(){return ju}function Pu(e){ju>=Cu.INFOS&&console.log(`Info: ${e}`)}function Ru(e){ju>=Cu.WARNINGS&&console.log(`Warning: ${e}`)}function Du(e){throw new Error(e)}function Iu(e,t){e||Du(t)}function Lu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;try{if(s&&"string"===typeof e){if(s.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);t?.length>=2&&(e=`http://${e}`)}if(s.tryConvertEncoding)try{e=decodeURIComponent(escape(e))}catch{}}const i=t?new URL(e,t):new URL(e);if(function(e){switch(e?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch{}return null}function Ou(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.defineProperty(e,t,{value:s,enumerable:!i,configurable:!0,writable:!1}),s}const Fu=function(){function e(e,t){this.message=e,this.name=t}return e.prototype=new Error,e.constructor=e,e}();class zu extends Fu{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Bu extends Fu{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class $u extends Fu{constructor(e){super(e,"InvalidPDFException")}}class Hu extends Fu{constructor(e){super(e,"MissingPDFException")}}class Uu extends Fu{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class Vu extends Fu{constructor(e){super(e,"FormatError")}}class Wu extends Fu{constructor(e){super(e,"AbortException")}}function qu(e){"object"===typeof e&&void 0!==e?.length||Du("Invalid argument for bytesToString");const t=e.length,s=8192;if(t<s)return String.fromCharCode.apply(null,e);const i=[];for(let n=0;n<t;n+=s){const r=Math.min(n+s,t),a=e.subarray(n,r);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Gu(e){"string"!==typeof e&&Du("Invalid argument for stringToBytes");const t=e.length,s=new Uint8Array(t);for(let i=0;i<t;++i)s[i]=255&e.charCodeAt(i);return s}function Yu(e){const t=Object.create(null);for(const[s,i]of e)t[s]=i;return t}class Ku{static get isLittleEndian(){return Ou(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return Ou(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return Ou(this,"isOffscreenCanvasSupported","undefined"!==typeof OffscreenCanvas)}static get isImageDecoderSupported(){return Ou(this,"isImageDecoderSupported","undefined"!==typeof ImageDecoder)}static get platform(){return"undefined"!==typeof navigator&&"string"===typeof navigator?.platform?Ou(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:"string"===typeof navigator?.userAgent&&navigator.userAgent.includes("Firefox")}):Ou(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Ou(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Xu=Array.from(Array(256).keys(),(e=>e.toString(16).padStart(2,"0")));class Ju{static makeHexColor(e,t,s){return`#${Xu[e]}${Xu[t]}${Xu[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),n=this.applyTransform([e[0],e[3]],t),r=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],n[0],r[0]),Math.min(s[1],i[1],n[1],r[1]),Math.max(s[0],i[0],n[0],r[0]),Math.max(s[1],i[1],n[1],r[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],n=e[2]*t[0]+e[3]*t[2],r=e[2]*t[1]+e[3]*t[3],a=(s+r)/2,o=Math.sqrt((s+r)**2-4*(s*r-n*i))/2,l=a+o||1,c=a-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const n=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),r=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return n>r?null:[s,n,i,r]}static#e(e,t,s,i,n,r,a,o,l,c){if(l<=0||l>=1)return;const d=1-l,h=l*l,u=h*l,p=d*(d*(d*e+3*l*t)+3*h*s)+u*i,f=d*(d*(d*n+3*l*r)+3*h*a)+u*o;c[0]=Math.min(c[0],p),c[1]=Math.min(c[1],f),c[2]=Math.max(c[2],p),c[3]=Math.max(c[3],f)}static#t(e,t,s,i,n,r,a,o,l,c,d,h){if(Math.abs(l)<1e-12)return void(Math.abs(c)>=1e-12&&this.#e(e,t,s,i,n,r,a,o,-d/c,h));const u=c**2-4*d*l;if(u<0)return;const p=Math.sqrt(u),f=2*l;this.#e(e,t,s,i,n,r,a,o,(-c+p)/f,h),this.#e(e,t,s,i,n,r,a,o,(-c-p)/f,h)}static bezierBoundingBox(e,t,s,i,n,r,a,o,l){return l?(l[0]=Math.min(l[0],e,a),l[1]=Math.min(l[1],t,o),l[2]=Math.max(l[2],e,a),l[3]=Math.max(l[3],t,o)):l=[Math.min(e,a),Math.min(t,o),Math.max(e,a),Math.max(t,o)],this.#t(e,s,n,a,t,i,r,o,3*(3*(s-n)-e+a),6*(e-2*s+n),3*(s-e),l),this.#t(e,s,n,a,t,i,r,o,3*(3*(i-r)-t+o),6*(t-2*i+r),3*(i-t),l),l}}let Qu=null,Zu=null;function ep(e){return Qu||(Qu=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Zu=new Map([["\ufb05","\u017ft"]])),e.replaceAll(Qu,((e,t,s)=>t?t.normalize("NFKC"):Zu.get(s)))}const tp="pdfjs_internal_id_";"function"!==typeof Promise.try&&(Promise.try=function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];return new Promise((t=>{t(e(...s))}))});const sp="http://www.w3.org/2000/svg";class ip{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=(()=>this.CSS/this.PDF)()}async function np(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";if(up(e,document.baseURI)){const s=await fetch(e);if(!s.ok)throw new Error(s.statusText);switch(t){case"arraybuffer":return s.arrayBuffer();case"blob":return s.blob();case"json":return s.json()}return s.text()}return new Promise(((s,i)=>{const n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType=t,n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE)if(200!==n.status&&0!==n.status)i(new Error(n.statusText));else{switch(t){case"arraybuffer":case"blob":case"json":return void s(n.response)}s(n.responseText)}},n.send(null)}))}class rp{constructor(e){let{viewBox:t,userUnit:s,scale:i,rotation:n,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}=e;this.viewBox=t,this.userUnit=s,this.scale=i,this.rotation=n,this.offsetX=r,this.offsetY=a,i*=s;const l=(t[2]+t[0])/2,c=(t[3]+t[1])/2;let d,h,u,p,f,m,g,v;switch(n%=360,n<0&&(n+=360),n){case 180:d=-1,h=0,u=0,p=1;break;case 90:d=0,h=1,u=1,p=0;break;case 270:d=0,h=-1,u=-1,p=0;break;case 0:d=1,h=0,u=0,p=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(u=-u,p=-p),0===d?(f=Math.abs(c-t[1])*i+r,m=Math.abs(l-t[0])*i+a,g=(t[3]-t[1])*i,v=(t[2]-t[0])*i):(f=Math.abs(l-t[0])*i+r,m=Math.abs(c-t[1])*i+a,g=(t[2]-t[0])*i,v=(t[3]-t[1])*i),this.transform=[d*i,h*i,u*i,p*i,f-d*i*l-u*i*c,m-h*i*l-p*i*c],this.width=g,this.height=v}get rawDims(){const{userUnit:e,viewBox:t}=this,s=t.map((t=>t*e));return Ou(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone(){let{scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new rp({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:n})}convertToViewportPoint(e,t){return Ju.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=Ju.applyTransform([e[0],e[1]],this.transform),s=Ju.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return Ju.applyInverseTransform([e,t],this.transform)}}class ap extends Fu{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(e,"RenderingCancelledException"),this.extraDelay=t}}function op(e){const t=e.length;let s=0;for(;s<t&&""===e[s].trim();)s++;return"data:"===e.substring(s,s+5).toLowerCase()}function lp(e){return"string"===typeof e&&/\.pdf$/i.test(e)}function cp(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)}function dp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof e)return t;if(op(e))return Ru('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e);let n=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(n&&(n=n[0],n.includes("%")))try{n=s.exec(decodeURIComponent(n))[0]}catch{}return n||t}class hp{started=(()=>Object.create(null))();times=[];time(e){e in this.started&&Ru(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ru(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:n}of this.times)e.push(`${s.padEnd(t)} ${n-i}ms\n`);return e.join("")}}function up(e,t){try{const{protocol:s}=t?new URL(e,t):new URL(e);return"http:"===s||"https:"===s}catch{return!1}}function pp(e){e.preventDefault()}function fp(e){e.preventDefault(),e.stopPropagation()}class mp{static#s;static toDateObject(e){if(!e||"string"!==typeof e)return null;this.#s||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#s.exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let n=parseInt(t[3],10);n=n>=1&&n<=31?n:1;let r=parseInt(t[4],10);r=r>=0&&r<=23?r:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let o=parseInt(t[6],10);o=o>=0&&o<=59?o:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(r+=c,a+=d):"+"===l&&(r-=c,a-=d),new Date(Date.UTC(s,i,n,r,a,o))}}function gp(e,t){let{scale:s=1,rotation:i=0}=t;const{width:n,height:r}=e.attributes.style,a=[0,0,parseInt(n),parseInt(r)];return new rp({viewBox:a,userUnit:1,scale:s,rotation:i})}function vp(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map((e=>parseInt(e))):e.startsWith("rgba(")?e.slice(5,-1).split(",").map((e=>parseInt(e))).slice(0,3):(Ru(`Not a valid color format: "${e}"`),[0,0,0])}function bp(e){const{a:t,b:s,c:i,d:n,e:r,f:a}=e.getTransform();return[t,s,i,n,r,a]}function yp(e){const{a:t,b:s,c:i,d:n,e:r,f:a}=e.getTransform().invertSelf();return[t,s,i,n,r,a]}function xp(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t instanceof rp){const{pageWidth:i,pageHeight:n}=t.rawDims,{style:r}=e,a=Ku.isCSSRoundSupported,o=`var(--scale-factor) * ${i}px`,l=`var(--scale-factor) * ${n}px`,c=a?`round(down, ${o}, var(--scale-round-x, 1px))`:`calc(${o})`,d=a?`round(down, ${l}, var(--scale-round-y, 1px))`:`calc(${l})`;s&&t.rotation%180!==0?(r.width=d,r.height=c):(r.width=c,r.height=d)}i&&e.setAttribute("data-main-rotation",t.rotation)}class wp{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}}class _p{#i=null;#n=null;#r;#a=null;#o=null;static#l=null;constructor(e){this.#r=e,_p.#l||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const e=this.#i=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#r._uiManager._signal;e.addEventListener("contextmenu",pp,{signal:t}),e.addEventListener("pointerdown",_p.#c,{signal:t});const s=this.#a=document.createElement("div");s.className="buttons",e.append(s);const i=this.#r.toolbarPosition;if(i){const{style:t}=e,s="ltr"===this.#r._uiManager.direction?1-i[0]:i[0];t.insetInlineEnd=100*s+"%",t.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),e}get div(){return this.#i}static#c(e){e.stopPropagation()}#h(e){this.#r._focusEventsAllowed=!1,fp(e)}#u(e){this.#r._focusEventsAllowed=!0,fp(e)}#p(e){const t=this.#r._uiManager._signal;e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#u.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",pp,{signal:t})}hide(){this.#i.classList.add("hidden"),this.#n?.hideDropdown()}show(){this.#i.classList.remove("hidden"),this.#o?.shown()}#d(){const{editorType:e,_uiManager:t}=this.#r,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",_p.#l[e]),this.#p(s),s.addEventListener("click",(e=>{t.delete()}),{signal:t._signal}),this.#a.append(s)}get#f(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#p(t),this.#a.prepend(t,this.#f),this.#o=e}addColorPicker(e){this.#n=e;const t=e.renderButton();this.#p(t),this.#a.prepend(t,this.#f)}remove(){this.#i.remove(),this.#n?.destroy(),this.#n=null}}class Sp{#a=null;#i=null;#m;constructor(e){this.#m=e}#g(){const e=this.#i=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",pp,{signal:this.#m._signal});const t=this.#a=document.createElement("div");return t.className="buttons",e.append(t),this.#v(),e}#b(e,t){let s=0,i=0;for(const n of e){const e=n.y+n.height;if(e<s)continue;const r=n.x+(t?n.width:0);e>s?(i=r,s=e):t?r>i&&(i=r):r<i&&(i=r)}return[t?1-i:i,s]}show(e,t,s){const[i,n]=this.#b(t,s),{style:r}=this.#i||=this.#g();e.append(this.#i),r.insetInlineEnd=100*i+"%",r.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){this.#i.remove()}#v(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#m._signal;e.addEventListener("contextmenu",pp,{signal:s}),e.addEventListener("click",(()=>{this.#m.highlightSelection("floating_button")}),{signal:s}),this.#a.append(e)}}function kp(e,t,s){for(const i of s)t.addEventListener(i,e[i].bind(e))}class Ap{#y=0;get id(){return"pdfjs_internal_editor_"+this.#y++}}class Cp{#x=(()=>function(){if("function"===typeof crypto.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);return crypto.getRandomValues(e),qu(e)}())();#y=0;#w=null;static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';return Ou(this,"_isSVGFittingCanvas",t.decode().then((()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]))))}async#_(e,t){this.#w||=new Map;let s=this.#w.get(e);if(null===s)return null;if(s?.bitmap)return s.refCounter+=1,s;try{let e;if(s||={bitmap:null,id:`image_${this.#x}_${this.#y++}`,refCounter:0,isSvg:!1},"string"===typeof t?(s.url=t,e=await np(t,"blob")):t instanceof File?e=s.file=t:t instanceof Blob&&(e=t),"image/svg+xml"===e.type){const t=Cp._isSVGFittingCanvas,i=new FileReader,n=new Image,r=new Promise(((e,r)=>{n.onload=()=>{s.bitmap=n,s.isSvg=!0,e()},i.onload=async()=>{const e=s.svgUrl=i.result;n.src=await t?`${e}#svgView(preserveAspectRatio(none))`:e},n.onerror=i.onerror=r}));i.readAsDataURL(e),await r}else s.bitmap=await createImageBitmap(e);s.refCounter=1}catch(yv){Ru(yv),s=null}return this.#w.set(e,s),s&&this.#w.set(s.id,s),s}async getFromFile(e){const{lastModified:t,name:s,size:i,type:n}=e;return this.#_(`${t}_${s}_${i}_${n}`,e)}async getFromUrl(e){return this.#_(e,e)}async getFromBlob(e,t){const s=await t;return this.#_(e,s)}async getFromId(e){this.#w||=new Map;const t=this.#w.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:e}=t;return delete t.blobPromise,this.getFromBlob(t.id,e)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#w||=new Map;let s=this.#w.get(e);if(s?.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${this.#x}_${this.#y++}`,refCounter:1,isSvg:!1},this.#w.set(e,s),this.#w.set(s.id,s),s}getSvgUrl(e){const t=this.#w.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#w||=new Map;const t=this.#w.get(e);if(!t)return;if(t.refCounter-=1,0!==t.refCounter)return;const{bitmap:s}=t;if(!t.url&&!t.file){const e=new OffscreenCanvas(s.width,s.height);e.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=e.convertToBlob()}s.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#x}_`)}}class Ep{#S=[];#k=!1;#A;#C=-1;constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;this.#A=e}add(e){let{cmd:t,undo:s,post:i,mustExec:n,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}=e;if(n&&t(),this.#k)return;const l={cmd:t,undo:s,post:i,type:r};if(-1===this.#C)return this.#S.length>0&&(this.#S.length=0),this.#C=0,void this.#S.push(l);if(a&&this.#S[this.#C].type===r)return o&&(l.undo=this.#S[this.#C].undo),void(this.#S[this.#C]=l);const c=this.#C+1;c===this.#A?this.#S.splice(0,1):(this.#C=c,c<this.#S.length&&this.#S.splice(c)),this.#S.push(l)}undo(){if(-1===this.#C)return;this.#k=!0;const{undo:e,post:t}=this.#S[this.#C];e(),t?.(),this.#k=!1,this.#C-=1}redo(){if(this.#C<this.#S.length-1){this.#C+=1,this.#k=!0;const{cmd:e,post:t}=this.#S[this.#C];e(),t?.(),this.#k=!1}}hasSomethingToUndo(){return-1!==this.#C}hasSomethingToRedo(){return this.#C<this.#S.length-1}cleanType(e){if(-1!==this.#C){for(let t=this.#C;t>=0;t--)if(this.#S[t].type!==e)return this.#S.splice(t+1,this.#C-t),void(this.#C=t);this.#S.length=0,this.#C=-1}}destroy(){this.#S=null}}class Np{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Ku.platform;for(const[s,i,n={}]of e)for(const e of s){const s=e.startsWith("mac+");t&&s?(this.callbacks.set(e.slice(4),{callback:i,options:n}),this.allKeys.add(e.split("+").at(-1))):t||s||(this.callbacks.set(e,{callback:i,options:n}),this.allKeys.add(e.split("+").at(-1)))}}#E(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(this.#E(t));if(!s)return;const{callback:i,options:{bubbles:n=!1,args:r=[],checker:a=null}}=s;a&&!a(e,t)||(i.bind(e,...r,t)(),n||fp(t))}}class jp{static _colorsMapping=(()=>new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]))();get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return function(e){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const s of e.keys()){t.style.color=s;const i=window.getComputedStyle(t).color;e.set(s,vp(i))}t.remove()}(e),Ou(this,"_colors",e)}convert(e){const t=vp(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every(((e,s)=>e===t[s])))return jp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?Ju.makeHexColor(...t):e}}class Tp{#N=(()=>new AbortController)();#j=null;#T=(()=>new Map)();#M=(()=>new Map)();#P=null;#R=null;#D=null;#I=(()=>new Ep)();#L=null;#O=null;#F=0;#z=(()=>new Set)();#B=null;#$=null;#H=(()=>new Set)();_editorUndoBar=null;#U=!1;#V=!1;#W=!1;#q=null;#G=null;#Y=null;#K=null;#X=!1;#J=null;#Q=(()=>new Ap)();#Z=!1;#ee=!1;#te=null;#se=null;#ie=null;#ne=null;#re=(()=>Gh.NONE)();#ae=(()=>new Set)();#oe=null;#le=null;#ce=null;#de={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#he=[0,0];#ue=null;#pe=null;#fe=null;#me=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Tp.prototype,t=e=>e.#pe.contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&e.hasSomethingToControl(),s=(e,t)=>{let{target:s}=t;if(s instanceof HTMLInputElement){const{type:e}=s;return"text"!==e&&"number"!==e}return!0},i=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return Ou(this,"_keyboardManager",new Np([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:s}=t;return!(s instanceof HTMLButtonElement)&&e.#pe.contains(s)&&!e.isEnterHandled}}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(e,t)=>{let{target:s}=t;return!(s instanceof HTMLButtonElement)&&e.#pe.contains(document.activeElement)}}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}]]))}constructor(e,t,s,i,n,r,a,o,l,c,d,h,u){const p=this._signal=this.#N.signal;this.#pe=e,this.#fe=t,this.#P=s,this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:p}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:p}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:p}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:p}),i._on("setpreference",this.onSetPreference.bind(this),{signal:p}),i._on("switchannotationeditorparams",(e=>this.updateParams(e.type,e.value)),{signal:p}),this.#ge(),this.#ve(),this.#be(),this.#R=n.annotationStorage,this.#q=n.filterFactory,this.#le=r,this.#K=a||null,this.#U=o,this.#V=l,this.#W=c,this.#ne=d||null,this.viewParameters={realScale:ip.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=h||null,this._supportsPinchToZoom=!1!==u}destroy(){this.#me?.resolve(),this.#me=null,this.#N?.abort(),this.#N=null,this._signal=null;for(const e of this.#M.values())e.destroy();this.#M.clear(),this.#T.clear(),this.#H.clear(),this.#j=null,this.#ae.clear(),this.#I.destroy(),this.#P?.destroy(),this.#J?.hide(),this.#J=null,this.#G&&(clearTimeout(this.#G),this.#G=null),this.#ue&&(clearTimeout(this.#ue),this.#ue=null),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#ne}get useNewAltTextFlow(){return this.#V}get useNewAltTextWhenAddingImage(){return this.#W}get hcmFilter(){return Ou(this,"hcmFilter",this.#le?this.#q.addHCMFilter(this.#le.foreground,this.#le.background):"none")}get direction(){return Ou(this,"direction",getComputedStyle(this.#pe).direction)}get highlightColors(){return Ou(this,"highlightColors",this.#K?new Map(this.#K.split(",").map((e=>e.split("=").map((e=>e.trim()))))):null)}get highlightColorNames(){return Ou(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,(e=>e.reverse()))):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#O=e}setMainHighlightColorPicker(e){this.#ie=e}editAltText(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.#P?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference(e){let{name:t,value:s}=e;if("enableNewAltTextWhenAddingImage"===t)this.#W=s}onPageChanging(e){let{pageNumber:t}=e;this.#F=t-1}focusMainContainer(){this.#pe.focus()}findParent(e,t){for(const s of this.#M.values()){const{x:i,y:n,width:r,height:a}=s.div.getBoundingClientRect();if(e>=i&&e<=i+r&&t>=n&&t<=n+a)return s}return null}disableUserSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.#fe.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#H.add(e)}removeShouldRescale(e){this.#H.delete(e)}onScaleChanging(e){let{scale:t}=e;this.commitOrRemove(),this.viewParameters.realScale=t*ip.PDF_TO_CSS_UNITS;for(const s of this.#H)s.onScaleChanging();this.#O?.onScaleChanging()}onRotationChanging(e){let{pagesRotation:t}=e;this.commitOrRemove(),this.viewParameters.rotation=t}#ye(e){let{anchorNode:t}=e;return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#xe(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of this.#M.values())if(s.hasTextLayer(e))return s;return null}highlightSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:n,focusOffset:r}=t,a=t.toString(),o=this.#ye(t).closest(".textLayer"),l=this.getSelectionBoxes(o);if(!l)return;t.empty();const c=this.#xe(o),d=this.#re===Gh.NONE,h=()=>{c?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:l,anchorNode:s,anchorOffset:i,focusNode:n,focusOffset:r,text:a}),d&&this.showAllEditors("highlight",!0,!0)};d?this.switchToMode(Gh.HIGHLIGHT,h):h()}#we(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=this.#ye(e).closest(".textLayer"),s=this.getSelectionBoxes(t);s&&(this.#J||=new Sp(this),this.#J.show(t,s,"ltr"===this.direction))}addToAnnotationStorage(e){e.isEmpty()||!this.#R||this.#R.has(e.id)||this.#R.setValue(e.id,e)}#_e(){const e=document.getSelection();if(!e||e.isCollapsed)return void(this.#oe&&(this.#J?.hide(),this.#oe=null,this.#Se({hasSelectedText:!1})));const{anchorNode:t}=e;if(t===this.#oe)return;const s=this.#ye(e).closest(".textLayer");if(s){if(this.#J?.hide(),this.#oe=t,this.#Se({hasSelectedText:!0}),(this.#re===Gh.HIGHLIGHT||this.#re===Gh.NONE)&&(this.#re===Gh.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#X=this.isShiftKeyDown,!this.isShiftKeyDown)){const e=this.#re===Gh.HIGHLIGHT?this.#xe(s):null;e?.toggleDrawing();const t=new AbortController,i=this.combinedSignal(t),n=s=>{"pointerup"===s.type&&0!==s.button||(t.abort(),e?.toggleDrawing(!0),"pointerup"===s.type&&this.#ke("main_toolbar"))};window.addEventListener("pointerup",n,{signal:i}),window.addEventListener("blur",n,{signal:i})}}else this.#oe&&(this.#J?.hide(),this.#oe=null,this.#Se({hasSelectedText:!1}))}#ke(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.#re===Gh.HIGHLIGHT?this.highlightSelection(e):this.#U&&this.#we()}#ge(){document.addEventListener("selectionchange",this.#_e.bind(this),{signal:this._signal})}#Ae(){if(this.#Y)return;this.#Y=new AbortController;const e=this.combinedSignal(this.#Y);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#Ce(){this.#Y?.abort(),this.#Y=null}blur(){if(this.isShiftKeyDown=!1,this.#X&&(this.#X=!1,this.#ke("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#ae)if(t.div.contains(e)){this.#se=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#se)return;const[e,t]=this.#se;this.#se=null,t.addEventListener("focusin",(()=>{e._focusEventsAllowed=!0}),{once:!0,signal:this._signal}),t.focus()}#be(){if(this.#te)return;this.#te=new AbortController;const e=this.combinedSignal(this.#te);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#Ee(){this.#te?.abort(),this.#te=null}#Ne(){if(this.#L)return;this.#L=new AbortController;const e=this.combinedSignal(this.#L);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#je(){this.#L?.abort(),this.#L=null}#ve(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#be(),this.#Ne()}removeEditListeners(){this.#Ee(),this.#je()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of this.#$)if(s.isHandlingMimeForPasting(t))return e.dataTransfer.dropEffect="copy",void e.preventDefault()}drop(e){for(const t of e.dataTransfer.items)for(const s of this.#$)if(s.isHandlingMimeForPasting(t.type))return s.paste(t,this.currentLayer),void e.preventDefault()}copy(e){if(e.preventDefault(),this.#j?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of this.#ae){const e=s.serialize(!0);e&&t.push(e)}0!==t.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const e of this.#$)if(e.isHandlingMimeForPasting(r.type))return void e.paste(r,this.currentLayer);let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(n){return void Ru(`paste: "${n.message}".`)}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const e=[];for(const r of s){const t=await i.deserialize(r);if(!t)return;e.push(t)}const t=()=>{for(const t of e)this.#Te(t);this.#Me(e)},n=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:n,mustExec:!0})}catch(n){Ru(`paste: "${n.message}".`)}}keydown(e){this.isShiftKeyDown||"Shift"!==e.key||(this.isShiftKeyDown=!0),this.#re===Gh.NONE||this.isEditorHandlingKeyboard||Tp._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&"Shift"===e.key&&(this.isShiftKeyDown=!1,this.#X&&(this.#X=!1,this.#ke("main_toolbar")))}onEditingAction(e){let{name:t}=e;switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu")}}#Se(e){Object.entries(e).some((e=>{let[t,s]=e;return this.#de[t]!==s}))&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#de,e)}),this.#re===Gh.HIGHLIGHT&&!1===e.hasSelectedEditor&&this.#Pe([[Yh.HIGHLIGHT_FREE,!0]]))}#Pe(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#Ae(),this.#Ne(),this.#Se({isEditing:this.#re!==Gh.NONE,isEmpty:this.#Re(),hasSomethingToUndo:this.#I.hasSomethingToUndo(),hasSomethingToRedo:this.#I.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#Ce(),this.#je(),this.#Se({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#$){this.#$=e;for(const e of this.#$)this.#Pe(e.defaultPropertiesToUpdate)}}getId(){return this.#Q.id}get currentLayer(){return this.#M.get(this.#F)}getLayer(e){return this.#M.get(e)}get currentPageIndex(){return this.#F}addLayer(e){this.#M.set(e.pageIndex,e),this.#Z?e.enable():e.disable()}removeLayer(e){this.#M.delete(e.pageIndex)}async updateMode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.#re!==e&&(!this.#me||(await this.#me.promise,this.#me))){if(this.#me=Promise.withResolvers(),this.#re=e,e===Gh.NONE)return this.setEditingState(!1),this.#De(),this._editorUndoBar?.hide(),void this.#me.resolve();this.setEditingState(!0),await this.#Ie(),this.unselectAll();for(const t of this.#M.values())t.updateMode(e);if(!t)return s&&this.addNewEditorFromKeyboard(),void this.#me.resolve();for(const e of this.#T.values())e.annotationElementId===t?(this.setSelected(e),e.enterInEditMode()):e.unselect();this.#me.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==this.#re&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#$){switch(e){case Yh.CREATE:return void this.currentLayer.addNewEditor();case Yh.HIGHLIGHT_DEFAULT_COLOR:this.#ie?.updateColor(t);break;case Yh.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#ce||=new Map).set(e,t),this.showAllEditors("highlight",t)}for(const s of this.#ae)s.updateParams(e,t);for(const s of this.#$)s.updateDefaultParams(e,t)}}showAllEditors(e,t){for(const s of this.#T.values())s.editorType===e&&s.show(t);(this.#ce?.get(Yh.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#Pe([[Yh.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.#ee!==e){this.#ee=e;for(const t of this.#M.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#Ie(){if(!this.#Z){this.#Z=!0;const e=[];for(const t of this.#M.values())e.push(t.enable());await Promise.all(e);for(const t of this.#T.values())t.enable()}}#De(){if(this.unselectAll(),this.#Z){this.#Z=!1;for(const e of this.#M.values())e.disable();for(const e of this.#T.values())e.disable()}}getEditors(e){const t=[];for(const s of this.#T.values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return this.#T.get(e)}addEditor(e){this.#T.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#G&&clearTimeout(this.#G),this.#G=setTimeout((()=>{this.focusMainContainer(),this.#G=null}),0)),this.#T.delete(e.id),this.unselect(e),e.annotationElementId&&this.#z.has(e.annotationElementId)||this.#R?.remove(e.id)}addDeletedAnnotationElement(e){this.#z.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#z.has(e)}removeDeletedAnnotationElement(e){this.#z.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#Te(e){const t=this.#M.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#j!==e&&(this.#j=e,e&&this.#Pe(e.propertiesToUpdate))}get#Le(){let e=null;for(e of this.#ae);return e}updateUI(e){this.#Le===e&&this.#Pe(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#Pe(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#ae.has(e))return this.#ae.delete(e),e.unselect(),void this.#Se({hasSelectedEditor:this.hasSelection});this.#ae.add(e),e.select(),this.#Pe(e.propertiesToUpdate),this.#Se({hasSelectedEditor:!0})}setSelected(e){this.#O?.commitOrRemove();for(const t of this.#ae)t!==e&&t.unselect();this.#ae.clear(),this.#ae.add(e),e.select(),this.#Pe(e.propertiesToUpdate),this.#Se({hasSelectedEditor:!0})}isSelected(e){return this.#ae.has(e)}get firstSelectedEditor(){return this.#ae.values().next().value}unselect(e){e.unselect(),this.#ae.delete(e),this.#Se({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#ae.size}get isEnterHandled(){return 1===this.#ae.size&&this.firstSelectedEditor.isEnterHandled}undo(){this.#I.undo(),this.#Se({hasSomethingToUndo:this.#I.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Re()}),this._editorUndoBar?.hide()}redo(){this.#I.redo(),this.#Se({hasSomethingToUndo:!0,hasSomethingToRedo:this.#I.hasSomethingToRedo(),isEmpty:this.#Re()})}addCommands(e){this.#I.add(e),this.#Se({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Re()})}cleanUndoStack(e){this.#I.cleanType(e)}#Re(){if(0===this.#T.size)return!0;if(1===this.#T.size)for(const e of this.#T.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#ae],s=()=>{for(const e of t)this.#Te(e)};this.addCommands({cmd:()=>{this._editorUndoBar?.show(s,1===t.length?t[0].editorType:t.length);for(const e of t)e.remove()},undo:s,mustExec:!0})}commitOrRemove(){this.#j?.commitOrRemove()}hasSomethingToControl(){return this.#j||this.hasSelection}#Me(e){for(const t of this.#ae)t.unselect();this.#ae.clear();for(const t of e)t.isEmpty()||(this.#ae.add(t),t.select());this.#Se({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#ae)e.commit();this.#Me(this.#T.values())}unselectAll(){if((!this.#j||(this.#j.commitOrRemove(),this.#re===Gh.NONE))&&!this.#O?.commitOrRemove()&&this.hasSelection){for(const e of this.#ae)e.unselect();this.#ae.clear(),this.#Se({hasSelectedEditor:!1})}}translateSelectedEditors(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]||this.commitOrRemove(),!this.hasSelection)return;this.#he[0]+=e,this.#he[1]+=t;const[s,i]=this.#he,n=[...this.#ae];this.#ue&&clearTimeout(this.#ue),this.#ue=setTimeout((()=>{this.#ue=null,this.#he[0]=this.#he[1]=0,this.addCommands({cmd:()=>{for(const e of n)this.#T.has(e.id)&&e.translateInPage(s,i)},undo:()=>{for(const e of n)this.#T.has(e.id)&&e.translateInPage(-s,-i)},mustExec:!1})}),1e3);for(const r of n)r.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#B=new Map;for(const e of this.#ae)this.#B.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#B)return!1;this.disableUserSelect(!1);const e=this.#B;this.#B=null;let t=!1;for(const[{x:i,y:n,pageIndex:r},a]of e)a.newX=i,a.newY=n,a.newPageIndex=r,t||=i!==a.savedX||n!==a.savedY||r!==a.savedPageIndex;if(!t)return!1;const s=(e,t,s,i)=>{if(this.#T.has(e.id)){const n=this.#M.get(i);n?e._setParentAndPosition(n,t,s):(e.pageIndex=i,e.x=t,e.y=s)}};return this.addCommands({cmd:()=>{for(const[t,{newX:i,newY:n,newPageIndex:r}]of e)s(t,i,n,r)},undo:()=>{for(const[t,{savedX:i,savedY:n,savedPageIndex:r}]of e)s(t,i,n,r)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#B)for(const s of this.#B.keys())s.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===this.#ae.size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#j===e}getActive(){return this.#j}getMode(){return this.#re}get imageManager(){return Ou(this,"imageManager",new Cp)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let l=0,c=t.rangeCount;l<c;l++)if(!e.contains(t.getRangeAt(l).commonAncestorContainer))return null;const{x:s,y:i,width:n,height:r}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(e,t,a,o)=>({x:(t-i)/r,y:1-(e+a-s)/n,width:o/r,height:a/n});break;case"180":a=(e,t,a,o)=>({x:1-(e+a-s)/n,y:1-(t+o-i)/r,width:a/n,height:o/r});break;case"270":a=(e,t,a,o)=>({x:1-(t+o-i)/r,y:(e-s)/n,width:o/r,height:a/n});break;default:a=(e,t,a,o)=>({x:(e-s)/n,y:(t-i)/r,width:a/n,height:o/r})}const o=[];for(let l=0,c=t.rangeCount;l<c;l++){const e=t.getRangeAt(l);if(!e.collapsed)for(const{x:t,y:s,width:i,height:n}of e.getClientRects())0!==i&&0!==n&&o.push(a(t,s,i,n))}return 0===o.length?null:o}addChangedExistingAnnotation(e){let{annotationElementId:t,id:s}=e;(this.#D||=new Map).set(t,s)}removeChangedExistingAnnotation(e){let{annotationElementId:t}=e;this.#D?.delete(t)}renderAnnotationElement(e){const t=this.#D?.get(e.data.id);if(!t)return;const s=this.#R.getRawValue(t);s&&(this.#re!==Gh.NONE||s.hasBeenModified)&&s.renderAnnotationElement(e)}}class Mp{#o=null;#Oe=!1;#Fe=null;#ze=null;#Be=null;#$e=null;#He=!1;#Ue=null;#r=null;#Ve=null;#We=null;#qe=!1;static#Ge=null;static _l10n=null;constructor(e){this.#r=e,this.#qe=e._uiManager.useNewAltTextFlow,Mp.#Ge||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Mp._l10n??=e}async render(){const e=this.#Fe=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#ze=document.createElement("span");e.append(t),this.#qe?(e.classList.add("new"),e.setAttribute("data-l10n-id",Mp.#Ge.missing),t.setAttribute("data-l10n-id",Mp.#Ge["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#r._uiManager._signal;e.addEventListener("contextmenu",pp,{signal:s}),e.addEventListener("pointerdown",(e=>e.stopPropagation()),{signal:s});const i=e=>{e.preventDefault(),this.#r._uiManager.editAltText(this.#r),this.#qe&&this.#r._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#Ye}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",(t=>{t.target===e&&"Enter"===t.key&&(this.#He=!0,i(t))}),{signal:s}),await this.#Ke(),e}get#Ye(){return(this.#o?"added":null===this.#o&&this.guessedText&&"review")||"missing"}finish(){this.#Fe&&(this.#Fe.focus({focusVisible:this.#He}),this.#He=!1)}isEmpty(){return this.#qe?null===this.#o:!this.#o&&!this.#Oe}hasData(){return this.#qe?null!==this.#o||!!this.#Ve:this.isEmpty()}get guessedText(){return this.#Ve}async setGuessedText(e){null===this.#o&&(this.#Ve=e,this.#We=await Mp._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#Ke())}toggleAltTextBadge(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.#qe||this.#o)return this.#Ue?.remove(),void(this.#Ue=null);if(!this.#Ue){const e=this.#Ue=document.createElement("div");e.className="noAltTextBadge",this.#r.div.append(e)}this.#Ue.classList.toggle("hidden",!e)}serialize(e){let t=this.#o;return e||this.#Ve!==t||(t=this.#We),{altText:t,decorative:this.#Oe,guessedText:this.#Ve,textWithDisclaimer:this.#We}}get data(){return{altText:this.#o,decorative:this.#Oe}}set data(e){let{altText:t,decorative:s,guessedText:i,textWithDisclaimer:n,cancel:r=!1}=e;i&&(this.#Ve=i,this.#We=n),this.#o===t&&this.#Oe===s||(r||(this.#o=t,this.#Oe=s),this.#Ke())}toggle(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.#Fe&&(!e&&this.#$e&&(clearTimeout(this.#$e),this.#$e=null),this.#Fe.disabled=!e)}shown(){this.#r._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#Ye}})}destroy(){this.#Fe?.remove(),this.#Fe=null,this.#ze=null,this.#Be=null,this.#Ue?.remove(),this.#Ue=null}async#Ke(){const e=this.#Fe;if(!e)return;if(this.#qe){if(e.classList.toggle("done",!!this.#o),e.setAttribute("data-l10n-id",Mp.#Ge[this.#Ye]),this.#ze?.setAttribute("data-l10n-id",Mp.#Ge[`${this.#Ye}-label`]),!this.#o)return void this.#Be?.remove()}else{if(!this.#o&&!this.#Oe)return e.classList.remove("done"),void this.#Be?.remove();e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#Be;if(!t){this.#Be=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#r.id}`;const s=100,i=this.#r._uiManager._signal;i.addEventListener("abort",(()=>{clearTimeout(this.#$e),this.#$e=null}),{once:!0}),e.addEventListener("mouseenter",(()=>{this.#$e=setTimeout((()=>{this.#$e=null,this.#Be.classList.add("show"),this.#r._reportTelemetry({action:"alt_text_tooltip"})}),s)}),{signal:i}),e.addEventListener("mouseleave",(()=>{this.#$e&&(clearTimeout(this.#$e),this.#$e=null),this.#Be?.classList.remove("show")}),{signal:i})}this.#Oe?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#o),t.parentNode||e.append(t);const s=this.#r.getImageForAltText();s?.setAttribute("aria-describedby",t.id)}}class Pp{#pe;#Xe=!1;#Je=null;#Qe;#Ze;#et;#tt;#st;#it=null;#nt;#rt=null;constructor(e){let{container:t,isPinchingDisabled:s=null,isPinchingStopped:i=null,onPinchStart:n=null,onPinching:r=null,onPinchEnd:a=null,signal:o}=e;this.#pe=t,this.#Je=i,this.#Qe=s,this.#Ze=n,this.#et=r,this.#tt=a,this.#nt=new AbortController,this.#st=AbortSignal.any([o,this.#nt.signal]),t.addEventListener("touchstart",this.#at.bind(this),{passive:!1,signal:this.#st})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Ou(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#at(e){if(this.#Qe?.()||e.touches.length<2)return;if(!this.#rt){this.#rt=new AbortController;const e=AbortSignal.any([this.#st,this.#rt.signal]),t=this.#pe,s={signal:e,passive:!1};t.addEventListener("touchmove",this.#ot.bind(this),s),t.addEventListener("touchend",this.#lt.bind(this),s),t.addEventListener("touchcancel",this.#lt.bind(this),s),this.#Ze?.()}if(fp(e),2!==e.touches.length||this.#Je?.())return void(this.#it=null);let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),this.#it={touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#ot(e){if(!this.#it||2!==e.touches.length)return;let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:n}=t,{screenX:r,screenY:a}=s,o=this.#it,{touch0X:l,touch0Y:c,touch1X:d,touch1Y:h}=o,u=d-l,p=h-c,f=r-i,m=a-n,g=Math.hypot(f,m)||1,v=Math.hypot(u,p)||1;if(!this.#Xe&&Math.abs(v-g)<=Pp.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(o.touch0X=i,o.touch0Y=n,o.touch1X=r,o.touch1Y=a,e.preventDefault(),!this.#Xe)return void(this.#Xe=!0);const b=[(i+r)/2,(n+a)/2];this.#et?.(b,v,g)}#lt(e){this.#rt.abort(),this.#rt=null,this.#tt?.(),this.#it&&(e.preventDefault(),this.#it=null,this.#Xe=!1)}destroy(){this.#nt?.abort(),this.#nt=null}}class Rp{#ct=null;#dt=null;#o=null;#ht=!1;#ut=null;#pt="";#ft=!1;#mt=null;#gt=null;#vt=null;#bt=null;#yt="";#xt=!1;#wt=null;#_t=!1;#St=!1;#kt=!1;#At=null;#Ct=0;#Et=0;#Nt=null;#jt=null;_editToolbar=null;_initialOptions=(()=>Object.create(null))();_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#Tt=!1;#Mt=(()=>Rp._zIndex++)();static _borderLineWidth=-1;static _colorManager=(()=>new jp)();static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=Rp.prototype._resizeWithKeyboard,t=Tp.TRANSLATE_SMALL,s=Tp.TRANSLATE_BIG;return Ou(this,"_resizerKeyboardManager",new Np([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],Rp.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:n,pageY:r}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[n,r];const[a,o]=this.parentDimensions;this.x=e.x/a,this.y=e.y/o,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Ou(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Dp({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Rp._l10n??=e,Rp._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),-1!==Rp._borderLineWidth)return;const s=getComputedStyle(document.documentElement);Rp._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Du("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#Tt}set _isDraggable(e){this.#Tt=e,this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#Mt}setParent(e){null!==e?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):this.#Pt(),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#xt?this.#xt=!1:this.parent.setSelected(this))}focusout(e){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const t=e.relatedTarget;t?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[n,r]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/n,this.y=(t+i)/r,this.fixAndSetPosition()}#Rt(e,t,s){let[i,n]=e;[t,s]=this.screenToPageTranslation(t,s),this.x+=t/i,this.y+=s/n,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#Rt(this.parentDimensions,e,t)}translateInPage(e,t){this.#wt||=[this.x,this.y,this.width,this.height],this.#Rt(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){this.#wt||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[i,n]}=this;if(this.x+=e/i,this.y+=t/n,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:a}=this;const[o,l]=this.getBaseTranslation();r+=o,a+=l;const{style:c}=s;c.left=`${(100*r).toFixed(2)}%`,c.top=`${(100*a).toFixed(2)}%`,this._onTranslating(r,a),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#wt&&(this.#wt[0]!==this.x||this.#wt[1]!==this.y)}get _hasBeenResized(){return!!this.#wt&&(this.#wt[2]!==this.width||this.#wt[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=Rp,i=s/e,n=s/t;switch(this.rotation){case 90:return[-i,n];case 180:return[i,n];case 270:return[i,-n];default:return[-i,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rotation;const{div:{style:t},pageDimensions:[s,i]}=this;let{x:n,y:r,width:a,height:o}=this;if(a*=s,o*=i,n*=s,r*=i,this._mustFixPosition)switch(e){case 0:n=Math.max(0,Math.min(s-a,n)),r=Math.max(0,Math.min(i-o,r));break;case 90:n=Math.max(0,Math.min(s-o,n)),r=Math.min(i,Math.max(a,r));break;case 180:n=Math.min(s,Math.max(a,n)),r=Math.min(i,Math.max(o,r));break;case 270:n=Math.min(s,Math.max(o,n)),r=Math.max(0,Math.min(i-a,r))}this.x=n/=s,this.y=r/=i;const[l,c]=this.getBaseTranslation();n+=l,r+=c,t.left=`${(100*n).toFixed(2)}%`,t.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}static#Dt(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return Rp.#Dt(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return Rp.#Dt(e,t,360-this.parentRotation)}#It(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:n}=this.div;n.width=`${(100*e/s).toFixed(2)}%`,this.#ft||(n.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),n=!this.#ft&&t.endsWith("%");if(i&&n)return;const[r,a]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/r).toFixed(2)}%`),this.#ft||n||(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#Lt(){if(this.#mt)return;this.#mt=document.createElement("div"),this.#mt.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const e=document.createElement("div");this.#mt.append(e),e.classList.add("resizer",s),e.setAttribute("data-resizer-name",s),e.addEventListener("pointerdown",this.#Ot.bind(this,s),{signal:t}),e.addEventListener("contextmenu",pp,{signal:t}),e.tabIndex=-1}this.div.prepend(this.#mt)}#Ot(e,t){t.preventDefault();const{isMac:s}=Ku.platform;if(0!==t.button||t.ctrlKey&&s)return;this.#o?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#gt=[t.screenX,t.screenY];const n=new AbortController,r=this._uiManager.combinedSignal(n);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#Ft.bind(this,e),{passive:!0,capture:!0,signal:r}),window.addEventListener("touchmove",fp,{passive:!1,signal:r}),window.addEventListener("contextmenu",pp,{signal:r}),this.#vt={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const a=this.parent.div.style.cursor,o=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const l=()=>{n.abort(),this.parent.togglePointerEvents(!0),this.#o?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=a,this.div.style.cursor=o,this.#zt()};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})}#Bt(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[n,r]=this.parentDimensions;this.setDims(n*s,r*i),this.fixAndSetPosition(),this._onResized()}_onResized(){}#zt(){if(!this.#vt)return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=this.#vt;this.#vt=null;const n=this.x,r=this.y,a=this.width,o=this.height;n===e&&r===t&&a===s&&o===i||this.addCommands({cmd:this.#Bt.bind(this,n,r,a,o),undo:this.#Bt.bind(this,e,t,s,i),mustExec:!0})}static _round(e){return Math.round(1e4*e)/1e4}#Ft(e,t){const[s,i]=this.parentDimensions,n=this.x,r=this.y,a=this.width,o=this.height,l=Rp.MIN_SIZE/s,c=Rp.MIN_SIZE/i,d=this.#It(this.rotation),h=(e,t)=>[d[0]*e+d[2]*t,d[1]*e+d[3]*t],u=this.#It(360-this.rotation);let p,f,m=!1,g=!1;switch(e){case"topLeft":m=!0,p=(e,t)=>[0,0],f=(e,t)=>[e,t];break;case"topMiddle":p=(e,t)=>[e/2,0],f=(e,t)=>[e/2,t];break;case"topRight":m=!0,p=(e,t)=>[e,0],f=(e,t)=>[0,t];break;case"middleRight":g=!0,p=(e,t)=>[e,t/2],f=(e,t)=>[0,t/2];break;case"bottomRight":m=!0,p=(e,t)=>[e,t],f=(e,t)=>[0,0];break;case"bottomMiddle":p=(e,t)=>[e/2,t],f=(e,t)=>[e/2,0];break;case"bottomLeft":m=!0,p=(e,t)=>[0,t],f=(e,t)=>[e,0];break;case"middleLeft":g=!0,p=(e,t)=>[0,t/2],f=(e,t)=>[e,t/2]}const v=p(a,o),b=f(a,o);let y=h(...b);const x=Rp._round(n+y[0]),w=Rp._round(r+y[1]);let _,S,k=1,A=1;if(t.fromKeyboard)({deltaX:_,deltaY:S}=t);else{const{screenX:e,screenY:s}=t,[i,n]=this.#gt;[_,S]=this.screenToPageTranslation(e-i,s-n),this.#gt[0]=e,this.#gt[1]=s}var C,E;if([_,S]=(C=_/s,E=S/i,[u[0]*C+u[2]*E,u[1]*C+u[3]*E]),m){const e=Math.hypot(a,o);k=A=Math.max(Math.min(Math.hypot(b[0]-v[0]-_,b[1]-v[1]-S)/e,1/a,1/o),l/a,c/o)}else g?k=Math.max(l,Math.min(1,Math.abs(b[0]-v[0]-_)))/a:A=Math.max(c,Math.min(1,Math.abs(b[1]-v[1]-S)))/o;const N=Rp._round(a*k),j=Rp._round(o*A);y=h(...f(N,j));const T=x-y[0],M=w-y[1];this.#wt||=[this.x,this.y,this.width,this.height],this.width=N,this.height=j,this.x=T,this.y=M,this.setDims(s*N,i*j),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#o?.finish()}async addEditToolbar(){return this._editToolbar||this.#St||(this._editToolbar=new _p(this),this.div.append(this._editToolbar.render()),this.#o&&await this._editToolbar.addAltText(this.#o)),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#o?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#o||(Mp.initialize(Rp._l10n),this.#o=new Mp(this),this.#ct&&(this.#o.data=this.#ct,this.#ct=null),await this.addEditToolbar())}get altTextData(){return this.#o?.data}set altTextData(e){this.#o&&(this.#o.data=e)}get guessedAltText(){return this.#o?.guessedText}async setGuessedAltText(e){await(this.#o?.setGuessedText(e))}serializeAltText(e){return this.#o?.serialize(e)}hasAltText(){return!!this.#o&&!this.#o.isEmpty()}hasAltTextData(){return this.#o?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#ht?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#$t();const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),kp(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#jt||=new Pp({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#Ht.bind(this),onPinching:this.#Ut.bind(this),onPinchEnd:this.#Vt.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#Ht(){this.#vt={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#o?.toggle(!1),this.parent.togglePointerEvents(!1)}#Ut(e,t,s){let i=s/t*.7+1-.7;if(1===i)return;const n=this.#It(this.rotation),r=(e,t)=>[n[0]*e+n[2]*t,n[1]*e+n[3]*t],[a,o]=this.parentDimensions,l=this.x,c=this.y,d=this.width,h=this.height,u=Rp.MIN_SIZE/a,p=Rp.MIN_SIZE/o;i=Math.max(Math.min(i,1/d,1/h),u/d,p/h);const f=Rp._round(d*i),m=Rp._round(h*i);if(f===d&&m===h)return;this.#wt||=[l,c,d,h];const g=r(d/2,h/2),v=Rp._round(l+g[0]),b=Rp._round(c+g[1]),y=r(f/2,m/2);this.x=v-y[0],this.y=b-y[1],this.width=f,this.height=m,this.setDims(a*f,o*m),this.fixAndSetPosition(),this._onResizing()}#Vt(){this.#o?.toggle(!0),this.parent.togglePointerEvents(!0),this.#zt()}pointerdown(e){const{isMac:t}=Ku.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(this.#xt=!0,this._isDraggable?this.#Wt(e):this.#qt(e))}get isSelected(){return this._uiManager.isSelected(this)}#qt(e){const{isMac:t}=Ku.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#Wt(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,n=this._uiManager.combinedSignal(i),r={capture:!0,passive:!1,signal:n},a=e=>{i.abort(),this.#ut=null,this.#xt=!1,this._uiManager.endDragSession()||this.#qt(e),s&&this._onStopDragging()};t&&(this.#Ct=e.clientX,this.#Et=e.clientY,this.#ut=e.pointerId,this.#pt=e.pointerType,window.addEventListener("pointermove",(e=>{s||(s=!0,this._onStartDragging());const{clientX:t,clientY:i,pointerId:n}=e;if(n!==this.#ut)return void fp(e);const[r,a]=this.screenToPageTranslation(t-this.#Ct,i-this.#Et);this.#Ct=t,this.#Et=i,this._uiManager.dragSelectedEditors(r,a)}),r),window.addEventListener("touchmove",fp,r),window.addEventListener("pointerdown",(e=>{e.pointerType===this.#pt&&(this.#jt||e.isPrimary)&&a(e),fp(e)}),r));const o=e=>{this.#ut&&this.#ut!==e.pointerId?fp(e):a(e)};window.addEventListener("pointerup",o,{signal:n}),window.addEventListener("blur",o,{signal:n})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#At&&clearTimeout(this.#At),this.#At=setTimeout((()=>{this.#At=null,this.parent?.moveEditorInDOM(this)}),0)}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rotation;const i=this.parentScale,[n,r]=this.pageDimensions,[a,o]=this.pageTranslation,l=e/i,c=t/i,d=this.x*n,h=this.y*r,u=this.width*n,p=this.height*r;switch(s){case 0:return[d+l+a,r-h-c-p+o,d+l+u+a,r-h-c+o];case 90:return[d+c+a,r-h+l+o,d+c+p+a,r-h+l+u+o];case 180:return[d-l-u+a,r-h+c+o,d-l+a,r-h+c+p+o];case 270:return[d-c-p+a,r-h-l-u+o,d-c+a,r-h-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,n,r]=e,a=n-s,o=r-i;switch(this.rotation){case 0:return[s,t-r,a,o];case 90:return[s,t-i,o,a];case 180:return[n,t-i,a,o];case 270:return[n,t-r,o,a];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){this.#St=!0}disableEditMode(){this.#St=!1}isInEditMode(){return this.#St}shouldGetKeyboardEvents(){return this.#kt}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:n,innerWidth:r}=window;return t<r&&i>0&&e<n&&s>0}#$t(){if(this.#bt||!this.div)return;this.#bt=new AbortController;const e=this._uiManager.combinedSignal(this.#bt);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#$t()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(){Du("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,i.#ct=e.accessibilityData;const[n,r]=i.pageDimensions,[a,o,l,c]=i.getRectInCurrentCoords(e.rect,r);return i.x=a/n,i.y=o/r,i.width=l/n,i.height=c/r,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){if(this.#bt?.abort(),this.#bt=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#At&&(clearTimeout(this.#At),this.#At=null),this.#Pt(),this.removeEditToolbar(),this.#Nt){for(const e of this.#Nt.values())clearTimeout(e);this.#Nt=null}this.parent=null,this.#jt?.destroy(),this.#jt=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#Lt(),this.#mt.classList.remove("hidden"),kp(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||"Enter"!==e.key)return;this._uiManager.setSelected(this),this.#vt={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#mt.children;if(!this.#dt){this.#dt=Array.from(t);const e=this.#Gt.bind(this),s=this.#Yt.bind(this),i=this._uiManager._signal;for(const t of this.#dt){const n=t.getAttribute("data-resizer-name");t.setAttribute("role","spinbutton"),t.addEventListener("keydown",e,{signal:i}),t.addEventListener("blur",s,{signal:i}),t.addEventListener("focus",this.#Kt.bind(this,n),{signal:i}),t.setAttribute("data-l10n-id",Rp._l10nResizer[n])}}const s=this.#dt[0];let i=0;for(const r of t){if(r===s)break;i++}const n=(360-this.rotation+this.parentRotation)%360/90*(this.#dt.length/4);if(n!==i){if(n<i)for(let t=0;t<i-n;t++)this.#mt.append(this.#mt.firstChild);else if(n>i)for(let t=0;t<n-i;t++)this.#mt.firstChild.before(this.#mt.lastChild);let e=0;for(const s of t){const t=this.#dt[e++].getAttribute("data-resizer-name");s.setAttribute("data-l10n-id",Rp._l10nResizer[t])}}this.#Xt(0),this.#kt=!0,this.#mt.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#Gt(e){Rp._resizerKeyboardManager.exec(this,e)}#Yt(e){this.#kt&&e.relatedTarget?.parentNode!==this.#mt&&this.#Pt()}#Kt(e){this.#yt=this.#kt?e:""}#Xt(e){if(this.#dt)for(const t of this.#dt)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#kt&&this.#Ft(this.#yt,{deltaX:e,deltaY:t,fromKeyboard:!0})}#Pt(){this.#kt=!1,this.#Xt(-1),this.#zt()}_stopResizingWithKeyboard(){this.#Pt(),this.div.focus()}select(){this.makeResizable(),this.div?.classList.add("selectedEditor"),this._editToolbar?(this._editToolbar?.show(),this.#o?.toggleAltTextBadge(!1)):this.addEditToolbar().then((()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()}))}unselect(){this.#mt?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#o?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#_t}set isEditing(e){this.#_t=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#ft=!0;const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){this.#Nt||=new Map;const{action:t}=e;let s=this.#Nt.get(t);return s&&clearTimeout(s),s=setTimeout((()=>{this._reportTelemetry(e),this.#Nt.delete(t),0===this.#Nt.size&&(this.#Nt=null)}),Rp._telemetryTimeout),void this.#Nt.set(t,s)}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#ht=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#ht=!0}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(t){if("CANVAS"===t.nodeName){const e=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.before(t)}}else t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);return t}resetAnnotationElement(e){const{firstChild:t}=e.container;"DIV"===t?.nodeName&&t.classList.contains("annotationContent")&&t.remove()}}class Dp extends Rp{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ip=3285377520,Lp=4294901760,Op=65535;class Fp{constructor(e){this.h1=e?4294967295&e:Ip,this.h2=e?4294967295&e:Ip}update(e){let t,s;if("string"===typeof e){t=new Uint8Array(2*e.length),s=0;for(let i=0,n=e.length;i<n;i++){const n=e.charCodeAt(i);n<=255?t[s++]=n:(t[s++]=n>>>8,t[s++]=255&n)}}else{if(!ArrayBuffer.isView(e))throw new Error("Invalid data format, must be a string or TypedArray.");t=e.slice(),s=t.byteLength}const i=s>>2,n=s-4*i,r=new Uint32Array(t.buffer,0,i);let a=0,o=0,l=this.h1,c=this.h2;const d=3432918353,h=461845907,u=11601,p=13715;for(let f=0;f<i;f++)1&f?(a=r[f],a=a*d&Lp|a*u&Op,a=a<<15|a>>>17,a=a*h&Lp|a*p&Op,l^=a,l=l<<13|l>>>19,l=5*l+3864292196):(o=r[f],o=o*d&Lp|o*u&Op,o=o<<15|o>>>17,o=o*h&Lp|o*p&Op,c^=o,c=c<<13|c>>>19,c=5*c+3864292196);switch(a=0,n){case 3:a^=t[4*i+2]<<16;case 2:a^=t[4*i+1]<<8;case 1:a^=t[4*i],a=a*d&Lp|a*u&Op,a=a<<15|a>>>17,a=a*h&Lp|a*p&Op,1&i?l^=a:c^=a}this.h1=l,this.h2=c}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&Lp|36045*e&Op,t=4283543511*t&Lp|(2950163797*(t<<16|e>>>16)&Lp)>>>16,e^=t>>>1,e=444984403*e&Lp|60499*e&Op,t=3301882366*t&Lp|(3120437893*(t<<16|e>>>16)&Lp)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const zp=Object.freeze({map:null,hash:"",transfer:void 0});class Bp{#Jt=!1;#Qt=null;#Zt=(()=>new Map)();constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this.#Zt.get(e);return void 0===s?t:Object.assign(t,s)}getRawValue(e){return this.#Zt.get(e)}remove(e){if(this.#Zt.delete(e),0===this.#Zt.size&&this.resetModified(),"function"===typeof this.onAnnotationEditor){for(const e of this.#Zt.values())if(e instanceof Rp)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this.#Zt.get(e);let i=!1;if(void 0!==s)for(const[n,r]of Object.entries(t))s[n]!==r&&(i=!0,s[n]=r);else i=!0,this.#Zt.set(e,t);i&&this.#es(),t instanceof Rp&&"function"===typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#Zt.has(e)}getAll(){return this.#Zt.size>0?Yu(this.#Zt):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return this.#Zt.size}#es(){this.#Jt||(this.#Jt=!0,"function"===typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#Jt&&(this.#Jt=!1,"function"===typeof this.onResetModified&&this.onResetModified())}get print(){return new $p(this)}get serializable(){if(0===this.#Zt.size)return zp;const e=new Map,t=new Fp,s=[],i=Object.create(null);let n=!1;for(const[r,a]of this.#Zt){const s=a instanceof Rp?a.serialize(!1,i):a;s&&(e.set(r,s),t.update(`${r}:${JSON.stringify(s)}`),n||=!!s.bitmap)}if(n)for(const r of e.values())r.bitmap&&s.push(r.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:zp}get editorStats(){let e=null;const t=new Map;for(const s of this.#Zt.values()){if(!(s instanceof Rp))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:n}=i;t.has(n)||t.set(n,Object.getPrototypeOf(s).constructor),e||=Object.create(null);const r=e[n]||=new Map;for(const[e,t]of Object.entries(i)){if("type"===e)continue;let s=r.get(e);s||(s=new Map,r.set(e,s));const i=s.get(t)??0;s.set(t,i+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){this.#Qt=null}get modifiedIds(){if(this.#Qt)return this.#Qt;const e=[];for(const t of this.#Zt.values())t instanceof Rp&&t.annotationElementId&&t.serialize()&&e.push(t.annotationElementId);return this.#Qt={ids:new Set(e),hash:e.join(",")}}}class $p extends Bp{#ts;constructor(e){super();const{map:t,hash:s,transfer:i}=e.serializable,n=structuredClone(t,i?{transfer:i}:null);this.#ts={map:n,hash:s,transfer:i}}get print(){Du("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#ts}get modifiedIds(){return Ou(this,"modifiedIds",{ids:new Set,hash:""})}}class Hp{#ss=(()=>new Set)();constructor(e){let{ownerDocument:t=globalThis.document,styleElement:s=null}=e;this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#ss.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){let{systemFontInfo:t,_inspectFont:s}=e;if(t&&!this.#ss.has(t.loadedName))if(Iu(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:e,src:i,style:n}=t,r=new FontFace(e,i,n);this.addNativeFontFace(r);try{await r.load(),this.#ss.add(e),s?.(t)}catch{Ru(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}}else Du("Not implemented: loadSystemFont without the Font Loading API.")}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(s){throw Ru(`Failed to load font '${t.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise((t=>{const s=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,s)}))}}get isFontLoadingAPISupported(){return Ou(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){let e=!1;return(Dh||"undefined"!==typeof navigator&&"string"===typeof navigator?.userAgent&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Ou(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const{loadingRequests:t}=this,s={done:!1,complete:function(){for(Iu(!s.done,"completeRequest() cannot be called twice."),s.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(s),s}get _loadTestFont(){return Ou(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t){function s(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function i(e,t,s,i){return e.substring(0,t)+i+e.substring(t+s)}let n,r;const a=this._document.createElement("canvas");a.width=1,a.height=1;const o=a.getContext("2d");let l=0;const c=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=i(d,976,c.length,c);const h=1482184792;let u=s(d,16);for(n=0,r=c.length-3;n<r;n+=4)u=u-h+s(c,n)|0;var p;n<c.length&&(u=u-h+s(c+"XXX",n)|0),d=i(d,16,4,(p=u,String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,255&p)));const f=`@font-face {font-family:"${c}";src:${`url(data:font/opentype;base64,${btoa(d)});`}}`;this.insertRule(f);const m=this._document.createElement("div");m.style.visibility="hidden",m.style.width=m.style.height="10px",m.style.position="absolute",m.style.top=m.style.left="0px";for(const g of[e.loadedName,c]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=g,m.append(e)}this._document.body.append(m),function e(t,s){if(++l>30)return Ru("Load test font never loaded."),void s();o.font="30px "+t,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?s():setTimeout(e.bind(null,t,s))}(c,(()=>{m.remove(),t.complete()}))}}class Up{constructor(e,t){let{disableFontFace:s=!1,fontExtraProperties:i=!1,inspectFont:n=null}=t;this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=!0===s,this.fontExtraProperties=!0===i,this._inspectFont=n}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(this.cssFontInfo){const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}else e=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${t=this.data,Uint8Array.prototype.toBase64?t.toBase64():btoa(qu(t))});`;var t;let s;if(this.cssFontInfo){let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${e}}`}else s=`@font-face {font-family:"${this.loadedName}";src:${e}}`;return this._inspectFont?.(this,e),s}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(r){Ru(`getPathGenerator - ignoring character: "${r}".`)}const n=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=n}}const Vp=1,Wp=2,qp=1,Gp=2,Yp=3,Kp=4,Xp=5,Jp=6,Qp=7,Zp=8;function ef(){}function tf(e){if(e instanceof Wu||e instanceof $u||e instanceof Hu||e instanceof zu||e instanceof Uu||e instanceof Bu)return e;switch(e instanceof Error||"object"===typeof e&&null!==e||Du('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new Wu(e.message);case"InvalidPDFException":return new $u(e.message);case"MissingPDFException":return new Hu(e.message);case"PasswordException":return new zu(e.message,e.code);case"UnexpectedResponseException":return new Uu(e.message,e.status);case"UnknownErrorException":return new Bu(e.message,e.details)}return new Bu(e.message,e.toString())}class sf{#is=(()=>new AbortController)();constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#ns.bind(this),{signal:this.#is.signal})}#ns(e){let{data:t}=e;if(t.targetName!==this.sourceName)return;if(t.stream)return void this.#rs(t);if(t.callback){const e=t.callbackId,s=this.callbackCapabilities[e];if(!s)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],t.callback===Vp)s.resolve(t.data);else{if(t.callback!==Wp)throw new Error("Unexpected callback case");s.reject(tf(t.reason))}return}const s=this.actionHandler[t.action];if(!s)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const e=this.sourceName,i=t.sourceName,n=this.comObj;Promise.try(s,t.data).then((function(s){n.postMessage({sourceName:e,targetName:i,callback:Vp,callbackId:t.callbackId,data:s})}),(function(s){n.postMessage({sourceName:e,targetName:i,callback:Wp,callbackId:t.callbackId,reason:tf(s)})}))}else t.streamId?this.#as(t):s(t.data)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[i]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(r){n.reject(r)}return n.promise}sendWithStream(e,t,s,i){const n=this.streamId++,r=this.sourceName,a=this.targetName,o=this.comObj;return new ReadableStream({start:s=>{const l=Promise.withResolvers();return this.streamControllers[n]={controller:s,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:r,targetName:a,action:e,streamId:n,data:t,desiredSize:s.desiredSize},i),l.promise},pull:e=>{const t=Promise.withResolvers();return this.streamControllers[n].pullCall=t,o.postMessage({sourceName:r,targetName:a,stream:Jp,streamId:n,desiredSize:e.desiredSize}),t.promise},cancel:e=>{Iu(e instanceof Error,"cancel must have a valid reason");const t=Promise.withResolvers();return this.streamControllers[n].cancelCall=t,this.streamControllers[n].isClosed=!0,o.postMessage({sourceName:r,targetName:a,stream:qp,streamId:n,reason:tf(e)}),t.promise}},s)}#as(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,n=this.comObj,r=this,a=this.actionHandler[e.action],o={enqueue(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=r,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),n.postMessage({sourceName:s,targetName:i,stream:Kp,streamId:t,chunk:e},a)},close(){this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:s,targetName:i,stream:Yp,streamId:t}),delete r.streamSinks[t])},error(e){Iu(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,n.postMessage({sourceName:s,targetName:i,stream:Xp,streamId:t,reason:tf(e)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[t]=o,Promise.try(a,e.data,o).then((function(){n.postMessage({sourceName:s,targetName:i,stream:Zp,streamId:t,success:!0})}),(function(e){n.postMessage({sourceName:s,targetName:i,stream:Zp,streamId:t,reason:tf(e)})}))}#rs(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,n=this.comObj,r=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Zp:e.success?r.startCall.resolve():r.startCall.reject(tf(e.reason));break;case Qp:e.success?r.pullCall.resolve():r.pullCall.reject(tf(e.reason));break;case Jp:if(!a){n.postMessage({sourceName:s,targetName:i,stream:Qp,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||ef).then((function(){n.postMessage({sourceName:s,targetName:i,stream:Qp,streamId:t,success:!0})}),(function(e){n.postMessage({sourceName:s,targetName:i,stream:Qp,streamId:t,reason:tf(e)})}));break;case Kp:if(Iu(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(e.chunk);break;case Yp:if(Iu(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),this.#os(r,t);break;case Xp:Iu(r,"error should have stream controller"),r.controller.error(tf(e.reason)),this.#os(r,t);break;case Gp:e.success?r.cancelCall.resolve():r.cancelCall.reject(tf(e.reason)),this.#os(r,t);break;case qp:if(!a)break;const o=tf(e.reason);Promise.try(a.onCancel||ef,o).then((function(){n.postMessage({sourceName:s,targetName:i,stream:Gp,streamId:t,success:!0})}),(function(e){n.postMessage({sourceName:s,targetName:i,stream:Gp,streamId:t,reason:tf(e)})})),a.sinkCapability.reject(o),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#os(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#is?.abort(),this.#is=null}}class nf{#ls=!1;constructor(e){let{enableHWA:t=!1}=e;this.#ls=t}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#ls})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Du("Abstract method `_createCanvas` called.")}}class rf{constructor(e){let{baseUrl:t=null,isCompressed:s=!0}=e;this.baseUrl=t,this.isCompressed=s}async fetch(e){let{name:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const s=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(s).then((e=>({cMapData:e,isCompressed:this.isCompressed}))).catch((e=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${s}`)}))}async _fetch(e){Du("Abstract method `_fetch` called.")}}class af extends rf{async _fetch(e){const t=await np(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Gu(t)}}class of{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,n){return"none"}destroy(){}}class lf{constructor(e){let{baseUrl:t=null}=e;this.baseUrl=t}async fetch(e){let{filename:t}=e;if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const s=`${this.baseUrl}${t}`;return this._fetch(s).catch((e=>{throw new Error(`Unable to load font data at: ${s}`)}))}async _fetch(e){Du("Abstract method `_fetch` called.")}}class cf extends lf{async _fetch(e){const t=await np(e,"arraybuffer");return new Uint8Array(t)}}async function df(e){const t=process.getBuiltinModule("fs"),s=await t.promises.readFile(e);return new Uint8Array(s)}Dh&&Ru("Please use the `legacy` build in Node.js environments.");const hf="Fill",uf="Stroke",pf="Shading";function ff(e,t){if(!t)return;const s=t[2]-t[0],i=t[3]-t[1],n=new Path2D;n.rect(t[0],t[1],s,i),e.clip(n)}class mf{getPattern(){Du("Abstract method `getPattern` called.")}}class gf extends mf{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;"axial"===this._type?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let n;if(i===uf||i===hf){const r=t.current.getClippedPathBoundingBox(i,bp(e))||[0,0,0,0],a=Math.ceil(r[2]-r[0])||1,o=Math.ceil(r[3]-r[1])||1,l=t.cachedCanvases.getCanvas("pattern",a,o),c=l.context;c.clearRect(0,0,c.canvas.width,c.canvas.height),c.beginPath(),c.rect(0,0,c.canvas.width,c.canvas.height),c.translate(-r[0],-r[1]),s=Ju.transform(s,[1,0,0,1,r[0],r[1]]),c.transform(...t.baseTransform),this.matrix&&c.transform(...this.matrix),ff(c,this._bbox),c.fillStyle=this._createGradient(c),c.fill(),n=e.createPattern(l.canvas,"no-repeat");const d=new DOMMatrix(s);n.setTransform(d)}else ff(e,this._bbox),n=this._createGradient(e);return n}}function vf(e,t,s,i,n,r,a,o){const l=t.coords,c=t.colors,d=e.data,h=4*e.width;let u;l[s+1]>l[i+1]&&(u=s,s=i,i=u,u=r,r=a,a=u),l[i+1]>l[n+1]&&(u=i,i=n,n=u,u=a,a=o,o=u),l[s+1]>l[i+1]&&(u=s,s=i,i=u,u=r,r=a,a=u);const p=(l[s]+t.offsetX)*t.scaleX,f=(l[s+1]+t.offsetY)*t.scaleY,m=(l[i]+t.offsetX)*t.scaleX,g=(l[i+1]+t.offsetY)*t.scaleY,v=(l[n]+t.offsetX)*t.scaleX,b=(l[n+1]+t.offsetY)*t.scaleY;if(f>=b)return;const y=c[r],x=c[r+1],w=c[r+2],_=c[a],S=c[a+1],k=c[a+2],A=c[o],C=c[o+1],E=c[o+2],N=Math.round(f),j=Math.round(b);let T,M,P,R,D,I,L,O;for(let F=N;F<=j;F++){if(F<g){const e=F<f?0:(f-F)/(f-g);T=p-(p-m)*e,M=y-(y-_)*e,P=x-(x-S)*e,R=w-(w-k)*e}else{let e;e=F>b?1:g===b?0:(g-F)/(g-b),T=m-(m-v)*e,M=_-(_-A)*e,P=S-(S-C)*e,R=k-(k-E)*e}let e;e=F<f?0:F>b?1:(f-F)/(f-b),D=p-(p-v)*e,I=y-(y-A)*e,L=x-(x-C)*e,O=w-(w-E)*e;const t=Math.round(Math.min(T,D)),s=Math.round(Math.max(T,D));let i=h*F+4*t;for(let n=t;n<=s;n++)e=(T-n)/(T-D),e<0?e=0:e>1&&(e=1),d[i++]=M-(M-I)*e|0,d[i++]=P-(P-L)*e|0,d[i++]=R-(R-O)*e|0,d[i++]=255}}function bf(e,t,s){const i=t.coords,n=t.colors;let r,a;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let t=r*o;for(let r=0;r<c;r++,t++)vf(e,s,i[t],i[t+1],i[t+o],n[t],n[t+1],n[t+o]),vf(e,s,i[t+o+1],i[t+1],i[t+o],n[t+o+1],n[t+1],n[t+o])}break;case"triangles":for(r=0,a=i.length;r<a;r+=3)vf(e,s,i[r],i[r+1],i[r+2],n[r],n[r+1],n[r+2]);break;default:throw new Error("illegal figure")}}class yf extends mf{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const i=Math.floor(this._bounds[0]),n=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-i,a=Math.ceil(this._bounds[3])-n,o=Math.min(Math.ceil(Math.abs(r*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(a*e[1]*1.1)),3e3),c=r/o,d=a/l,h={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-n,scaleX:1/c,scaleY:1/d},u=o+4,p=l+4,f=s.getCanvas("mesh",u,p),m=f.context,g=m.createImageData(o,l);if(t){const e=g.data;for(let s=0,i=e.length;s<i;s+=4)e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=255}for(const v of this._figures)bf(g,v,h);m.putImageData(g,2,2);return{canvas:f.canvas,offsetX:i-2*c,offsetY:n-2*d,scaleX:c,scaleY:d}}getPattern(e,t,s,i){let n;if(ff(e,this._bbox),i===pf)n=Ju.singularValueDecompose2dScale(bp(e));else if(n=Ju.singularValueDecompose2dScale(t.baseTransform),this.matrix){const e=Ju.singularValueDecompose2dScale(this.matrix);n=[n[0]*e[0],n[1]*e[1]]}const r=this._createMeshCanvas(n,i===pf?null:this._background,t.cachedCanvases);return i!==pf&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(r.offsetX,r.offsetY),e.scale(r.scaleX,r.scaleY),e.createPattern(r.canvas,"no-repeat")}}class xf extends mf{getPattern(){return"hotpink"}}const wf=1,_f=2;class Sf{static MAX_PATTERN_SIZE=3e3;constructor(e,t,s,i,n){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:n,color:r,canvasGraphicsFactory:a}=this;let{xstep:o,ystep:l}=this;o=Math.abs(o),l=Math.abs(l),Pu("TilingType: "+n);const c=t[0],d=t[1],h=t[2],u=t[3],p=h-c,f=u-d,m=Ju.singularValueDecompose2dScale(this.matrix),g=Ju.singularValueDecompose2dScale(this.baseTransform),v=m[0]*g[0],b=m[1]*g[1];let y=p,x=f,w=!1,_=!1;const S=Math.ceil(o*v),k=Math.ceil(l*b);S>=Math.ceil(p*v)?y=o:w=!0,k>=Math.ceil(f*b)?x=l:_=!0;const A=this.getSizeAndScale(y,this.ctx.canvas.width,v),C=this.getSizeAndScale(x,this.ctx.canvas.height,b),E=e.cachedCanvases.getCanvas("pattern",A.size,C.size),N=E.context,j=a.createCanvasGraphics(N);if(j.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(j,i,r),N.translate(-A.scale*c,-C.scale*d),j.transform(A.scale,0,0,C.scale,0,0),N.save(),this.clipBbox(j,c,d,h,u),j.baseTransform=bp(j.ctx),j.executeOperatorList(s),j.endDrawing(),N.restore(),w||_){const t=E.canvas;w&&(y=o),_&&(x=l);const s=this.getSizeAndScale(y,this.ctx.canvas.width,v),i=this.getSizeAndScale(x,this.ctx.canvas.height,b),n=s.size,r=i.size,a=e.cachedCanvases.getCanvas("pattern-workaround",n,r),h=a.context,u=w?Math.floor(p/o):0,m=_?Math.floor(f/l):0;for(let e=0;e<=u;e++)for(let s=0;s<=m;s++)h.drawImage(t,n*e,r*s,n,r,0,0,n,r);return{canvas:a.canvas,scaleX:s.scale,scaleY:i.scale,offsetX:c,offsetY:d}}return{canvas:E.canvas,scaleX:A.scale,scaleY:C.scale,offsetX:c,offsetY:d}}getSizeAndScale(e,t,s){const i=Math.max(Sf.MAX_PATTERN_SIZE,t);let n=Math.ceil(e*s);return n>=i?n=i:s=n/e,{scale:s,size:n}}clipBbox(e,t,s,i,n){const r=i-t,a=n-s;e.ctx.rect(t,s,r,a),e.current.updateRectMinMax(bp(e.ctx),[t,s,i,n]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,n=e.current;switch(t){case wf:const e=this.ctx;i.fillStyle=e.fillStyle,i.strokeStyle=e.strokeStyle,n.fillColor=e.fillStyle,n.strokeColor=e.strokeStyle;break;case _f:const r=Ju.makeHexColor(s[0],s[1],s[2]);i.fillStyle=r,i.strokeStyle=r,n.fillColor=r,n.strokeColor=r;break;default:throw new Vu(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let n=s;i!==pf&&(n=Ju.transform(n,t.baseTransform),this.matrix&&(n=Ju.transform(n,this.matrix)));const r=this.createPatternCanvas(t);let a=new DOMMatrix(n);a=a.translate(r.offsetX,r.offsetY),a=a.scale(1/r.scaleX,1/r.scaleY);const o=e.createPattern(r.canvas,"repeat");return o.setTransform(a),o}}function kf(e){let{src:t,srcPos:s=0,dest:i,width:n,height:r,nonBlackColor:a=4294967295,inverseDecode:o=!1}=e;const l=Ku.isLittleEndian?4278190080:255,[c,d]=o?[a,l]:[l,a],h=n>>3,u=7&n,p=t.length;i=new Uint32Array(i.buffer);let f=0;for(let m=0;m<r;m++){for(const n=s+h;s<n;s++){const e=s<p?t[s]:255;i[f++]=128&e?d:c,i[f++]=64&e?d:c,i[f++]=32&e?d:c,i[f++]=16&e?d:c,i[f++]=8&e?d:c,i[f++]=4&e?d:c,i[f++]=2&e?d:c,i[f++]=1&e?d:c}if(0===u)continue;const e=s<p?t[s++]:255;for(let t=0;t<u;t++)i[f++]=e&1<<7-t?d:c}return{srcPos:s,destPos:f}}const Af=16;class Cf{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Ef(e,t,s,i,n,r,a,o,l,c){const[d,h,u,p,f,m]=bp(e);if(0===h&&0===u){const g=a*d+f,v=Math.round(g),b=o*p+m,y=Math.round(b),x=(a+l)*d+f,w=Math.abs(Math.round(x)-v)||1,_=(o+c)*p+m,S=Math.abs(Math.round(_)-y)||1;return e.setTransform(Math.sign(d),0,0,Math.sign(p),v,y),e.drawImage(t,s,i,n,r,0,0,w,S),e.setTransform(d,h,u,p,f,m),[w,S]}if(0===d&&0===p){const g=o*u+f,v=Math.round(g),b=a*h+m,y=Math.round(b),x=(o+c)*u+f,w=Math.abs(Math.round(x)-v)||1,_=(a+l)*h+m,S=Math.abs(Math.round(_)-y)||1;return e.setTransform(0,Math.sign(h),Math.sign(u),0,v,y),e.drawImage(t,s,i,n,r,0,0,S,w),e.setTransform(d,h,u,p,f,m),[S,w]}e.drawImage(t,s,i,n,r,a,o,l,c);return[Math.hypot(d,h)*l,Math.hypot(u,p)*c]}class Nf{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Ih,this.textMatrixScale=1,this.fontMatrix=Lh,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Xh,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=Ju.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=Ju.applyTransform(t,e),i=Ju.applyTransform(t.slice(2),e),n=Ju.applyTransform([t[0],t[3]],e),r=Ju.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],n[0],r[0]),this.minY=Math.min(this.minY,s[1],i[1],n[1],r[1]),this.maxX=Math.max(this.maxX,s[0],i[0],n[0],r[0]),this.maxY=Math.max(this.maxY,s[1],i[1],n[1],r[1])}updateScalingPathMinMax(e,t){Ju.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,n,r,a,o,l,c){const d=Ju.bezierBoundingBox(t,s,i,n,r,a,o,l,c);c||this.updateRectMinMax(e,d)}getPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hf,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===uf){t||Du("Stroke bounding box must include transform.");const e=Ju.singularValueDecompose2dScale(t),i=e[0]*this.lineWidth/2,n=e[1]*this.lineWidth/2;s[0]-=i,s[1]-=n,s[2]+=i,s[3]+=n}return s}updateClipFromPath(){const e=Ju.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hf,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Ju.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function jf(e,t){if(t instanceof ImageData)return void e.putImageData(t,0,0);const s=t.height,i=t.width,n=s%Af,r=(s-n)/Af,a=0===n?r:r+1,o=e.createImageData(i,Af);let l,c=0;const d=t.data,h=o.data;let u,p,f,m;if(t.kind===su.GRAYSCALE_1BPP){const t=d.byteLength,s=new Uint32Array(h.buffer,0,h.byteLength>>2),m=s.length,g=i+7>>3,v=4294967295,b=Ku.isLittleEndian?4278190080:255;for(u=0;u<a;u++){for(f=u<r?Af:n,l=0,p=0;p<f;p++){const e=t-c;let n=0;const r=e>g?i:8*e-7,a=-8&r;let o=0,h=0;for(;n<a;n+=8)h=d[c++],s[l++]=128&h?v:b,s[l++]=64&h?v:b,s[l++]=32&h?v:b,s[l++]=16&h?v:b,s[l++]=8&h?v:b,s[l++]=4&h?v:b,s[l++]=2&h?v:b,s[l++]=1&h?v:b;for(;n<r;n++)0===o&&(h=d[c++],o=128),s[l++]=h&o?v:b,o>>=1}for(;l<m;)s[l++]=0;e.putImageData(o,0,u*Af)}}else if(t.kind===su.RGBA_32BPP){for(p=0,m=i*Af*4,u=0;u<r;u++)h.set(d.subarray(c,c+m)),c+=m,e.putImageData(o,0,p),p+=Af;u<a&&(m=i*n*4,h.set(d.subarray(c,c+m)),e.putImageData(o,0,p))}else{if(t.kind!==su.RGB_24BPP)throw new Error(`bad image kind: ${t.kind}`);for(f=Af,m=i*f,u=0;u<a;u++){for(u>=r&&(f=n,m=i*f),l=0,p=m;p--;)h[l++]=d[c++],h[l++]=d[c++],h[l++]=d[c++],h[l++]=255;e.putImageData(o,0,u*Af)}}}function Tf(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const s=t.height,i=t.width,n=s%Af,r=(s-n)/Af,a=0===n?r:r+1,o=e.createImageData(i,Af);let l=0;const c=t.data,d=o.data;for(let h=0;h<a;h++){const t=h<r?Af:n;({srcPos:l}=kf({src:c,srcPos:l,dest:d,width:i,height:t,nonBlackColor:0})),e.putImageData(o,0,h*Af)}}function Mf(e,t){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of s)void 0!==e[i]&&(t[i]=e[i]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function Pf(e){if(e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0),!Dh){const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}}function Rf(e,t){if(t)return!0;const s=Ju.singularValueDecompose2dScale(e);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*ip.PDF_TO_CSS_UNITS);return s[0]<=i&&s[1]<=i}const Df=["butt","round","square"],If=["miter","round","bevel"],Lf={},Of={};class Ff{constructor(e,t,s,i,n,r,a,o){let{optionalContentConfig:l,markedContentStack:c=null}=r;this.ctx=e,this.current=new Nf(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new Cf(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=a,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=o,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"===typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing(e){let{transform:t,viewport:s,transparency:i=!1,background:n=null}=e;const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,i){const e=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...bp(this.compositeCtx))}this.ctx.save(),Pf(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...s.transform),this.viewportScale=s.scale,this.baseTransform=bp(this.ctx)}executeOperatorList(e,t,s,i){const n=e.argsArray,r=e.fnArray;let a=t||0;const o=n.length;if(o===a)return a;const l=o-a>10&&"function"===typeof s,c=l?Date.now()+15:0;let d=0;const h=this.commonObjs,u=this.objs;let p;for(;;){if(void 0!==i&&a===i.nextBreakPoint)return i.breakIt(a,s),a;if(p=r[a],p!==Eu.dependency)this[p].apply(this,n[a]);else for(const e of n[a]){const t=e.startsWith("g_")?h:u;if(!t.has(e))return t.get(e,s),a}if(a++,a===o)return a;if(l&&++d>10){if(Date.now()>c)return s(),a;d=0}}}#cs(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#cs(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#ds()}#ds(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let n,r,a=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=s,c=i,d="prescale1";for(;a>2&&l>1||o>2&&c>1;){let t=l,s=c;a>2&&l>1&&(t=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),a/=l/t),o>2&&c>1&&(s=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,o/=c/s),n=this.cachedCanvases.getCanvas(d,t,s),r=n.context,r.clearRect(0,0,t,s),r.drawImage(e,0,0,l,c,0,0,t,s),e=n.canvas,l=t,c=s,d="prescale1"===d?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,n=this.current.fillColor,r=this.current.patternFill,a=bp(t);let o,l,c,d;if((e.bitmap||e.data)&&e.count>1){const t=e.bitmap||e.data.buffer;l=JSON.stringify(r?a:[a.slice(0,4),n]),o=this._cachedBitmapsMap.get(t),o||(o=new Map,this._cachedBitmapsMap.set(t,o));const s=o.get(l);if(s&&!r){return{canvas:s,offsetX:Math.round(Math.min(a[0],a[2])+a[4]),offsetY:Math.round(Math.min(a[1],a[3])+a[5])}}c=s}c||(d=this.cachedCanvases.getCanvas("maskCanvas",s,i),Tf(d.context,e));let h=Ju.transform(a,[1/s,0,0,-1/i,0,0]);h=Ju.transform(h,[1,0,0,1,0,-i]);const[u,p,f,m]=Ju.getAxialAlignedBoundingBox([0,0,s,i],h),g=Math.round(f-u)||1,v=Math.round(m-p)||1,b=this.cachedCanvases.getCanvas("fillCanvas",g,v),y=b.context,x=u,w=p;y.translate(-x,-w),y.transform(...h),c||(c=this._scaleImage(d.canvas,yp(y)),c=c.img,o&&r&&o.set(l,c)),y.imageSmoothingEnabled=Rf(bp(y),e.interpolate),Ef(y,c,0,0,c.width,c.height,0,0,s,i),y.globalCompositeOperation="source-in";const _=Ju.transform(yp(y),[1,0,0,1,-x,-w]);return y.fillStyle=r?n.getPattern(t,this,_,hf):n,y.fillRect(0,0,s,i),o&&!r&&(this.cachedCanvases.delete("fillCanvas"),o.set(l,b.canvas)),{canvas:b.canvas,offsetX:Math.round(x),offsetY:Math.round(w)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=Df[e]}setLineJoin(e){this.ctx.lineJoin=If[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;void 0!==s.setLineDash&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const n=this.ctx;n.setTransform(...bp(this.suspendedCtx)),Mf(this.suspendedCtx,n),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,s){t.translate(e,s),this.__originalTranslate(e,s)},e.scale=function(e,s){t.scale(e,s),this.__originalScale(e,s)},e.transform=function(e,s,i,n,r,a){t.transform(e,s,i,n,r,a),this.__originalTransform(e,s,i,n,r,a)},e.setTransform=function(e,s,i,n,r,a){t.setTransform(e,s,i,n,r,a),this.__originalSetTransform(e,s,i,n,r,a)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},e.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},e.bezierCurveTo=function(e,s,i,n,r,a){t.bezierCurveTo(e,s,i,n,r,a),this.__originalBezierCurveTo(e,s,i,n,r,a)},e.rect=function(e,s,i,n){t.rect(e,s,i,n),this.__originalRect(e,s,i,n)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Mf(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const n=i[0],r=i[1],a=i[2]-n,o=i[3]-r;0!==a&&0!==o&&(this.genericComposeSMask(t.context,s,a,o,t.subtype,t.backdrop,t.transferMap,n,r,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,n,r,a,o,l,c,d){let h=e.canvas,u=o-c,p=l-d;if(r){const t=Ju.makeHexColor(...r);if(u<0||p<0||u+s>h.width||p+i>h.height){const e=this.cachedCanvases.getCanvas("maskExtension",s,i),n=e.context;n.drawImage(h,-u,-p),n.globalCompositeOperation="destination-atop",n.fillStyle=t,n.fillRect(0,0,s,i),n.globalCompositeOperation="source-over",h=e.canvas,u=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const n=new Path2D;n.rect(u,p,s,i),e.clip(n),e.globalCompositeOperation="destination-atop",e.fillStyle=t,e.fillRect(u,p,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),"Alpha"===n&&a?t.filter=this.filterFactory.addAlphaFilter(a):"Luminosity"===n&&(t.filter=this.filterFactory.addLuminosityFilter(a));const f=new Path2D;f.rect(o,l,s,i),t.clip(f),t.globalCompositeOperation="destination-in",t.drawImage(h,u,p,s,i,o,l,s,i),t.restore()}save(){this.inSMaskMode?(Mf(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Mf(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,n,r){this.ctx.transform(e,t,s,i,n,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,n=this.current;let r,a,o=n.x,l=n.y;const c=bp(i),d=0===c[0]&&0===c[3]||0===c[1]&&0===c[2],h=d?s.slice(0):null;for(let u=0,p=0,f=e.length;u<f;u++)switch(0|e[u]){case Eu.rectangle:o=t[p++],l=t[p++];const e=t[p++],s=t[p++],u=o+e,f=l+s;i.moveTo(o,l),0===e||0===s?i.lineTo(u,f):(i.lineTo(u,l),i.lineTo(u,f),i.lineTo(o,f)),d||n.updateRectMinMax(c,[o,l,u,f]),i.closePath();break;case Eu.moveTo:o=t[p++],l=t[p++],i.moveTo(o,l),d||n.updatePathMinMax(c,o,l);break;case Eu.lineTo:o=t[p++],l=t[p++],i.lineTo(o,l),d||n.updatePathMinMax(c,o,l);break;case Eu.curveTo:r=o,a=l,o=t[p+4],l=t[p+5],i.bezierCurveTo(t[p],t[p+1],t[p+2],t[p+3],o,l),n.updateCurvePathMinMax(c,r,a,t[p],t[p+1],t[p+2],t[p+3],o,l,h),p+=6;break;case Eu.curveTo2:r=o,a=l,i.bezierCurveTo(o,l,t[p],t[p+1],t[p+2],t[p+3]),n.updateCurvePathMinMax(c,r,a,o,l,t[p],t[p+1],t[p+2],t[p+3],h),o=t[p+2],l=t[p+3],p+=4;break;case Eu.curveTo3:r=o,a=l,o=t[p+2],l=t[p+3],i.bezierCurveTo(t[p],t[p+1],o,l,o,l),n.updateCurvePathMinMax(c,r,a,t[p],t[p+1],o,l,o,l,h),p+=4;break;case Eu.closePath:i.closePath()}d&&n.updateScalingPathMinMax(c,h),n.setCurrentPoint(o,l)}closePath(){this.ctx.closePath()}stroke(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"===typeof s&&s?.getPattern?(t.save(),t.strokeStyle=s.getPattern(t,this,yp(t),uf),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.ctx,s=this.current.fillColor;let i=!1;this.current.patternFill&&(t.save(),t.fillStyle=s.getPattern(t,this,yp(t),hf),i=!0);const n=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==n&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath(n)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Lf}eoClip(){this.pendingClip=Of}beginText(){this.current.textMatrix=Ih,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(void 0===e)return void t.beginPath();const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:n,x:r,y:a,fontSize:o,path:l}of e)s.addPath(l,new DOMMatrix(n).preMultiplySelf(i).translate(r,a).scale(o,-o));t.clip(s),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||Lh,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||Ru("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const n=s.loadedName||"sans-serif",r=s.systemFontInfo?.css||`"${n}", ${s.fallbackName}`;let a="normal";s.black?a="900":s.bold&&(a="bold");const o=s.italic?"italic":"normal";let l=t;t<16?l=16:t>100&&(l=100),this.current.fontSizeScale=t/l,this.ctx.font=`${o} ${a} ${l}px ${r}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,n,r){this.current.textMatrix=[e,t,s,i,n,r],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#hs(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i}paintChar(e,t,s,i,n){const r=this.ctx,a=this.current,o=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,d=l&eu,h=!!(l&tu),u=a.patternFill&&!o.missingFile,p=a.patternStroke&&!o.missingFile;let f;if((o.disableFontFace||h||u||p)&&(f=o.getPathGenerator(this.commonObjs,e)),o.disableFontFace||u||p){if(r.save(),r.translate(t,s),r.scale(c,-c),d===Xh||d===Qh)if(i){const e=r.getTransform();r.setTransform(...i),r.fill(this.#hs(f,e,i))}else r.fill(f);if(d===Jh||d===Qh)if(n){const e=r.getTransform();r.setTransform(...n),r.stroke(this.#hs(f,e,n))}else r.lineWidth/=c,r.stroke(f);r.restore()}else d!==Xh&&d!==Qh||r.fillText(e,t,s),d!==Jh&&d!==Qh||r.strokeText(e,t,s);if(h){(this.pendingTextPaths||=[]).push({transform:bp(r),x:t,y:s,fontSize:c,path:f})}}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return Ou(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(0===i)return;const n=this.ctx,r=t.fontSizeScale,a=t.charSpacing,o=t.wordSpacing,l=t.fontDirection,c=t.textHScale*l,d=e.length,h=s.vertical,u=h?1:-1,p=s.defaultVMetrics,f=i*t.fontMatrix[0],m=t.textRenderingMode===Xh&&!s.disableFontFace&&!t.patternFill;let g,v;if(n.save(),n.transform(...t.textMatrix),n.translate(t.x,t.y+t.textRise),l>0?n.scale(c,-1):n.scale(c,1),t.patternFill){n.save();const e=t.fillColor.getPattern(n,this,yp(n),hf);g=bp(n),n.restore(),n.fillStyle=e}if(t.patternStroke){n.save();const e=t.strokeColor.getPattern(n,this,yp(n),uf);v=bp(n),n.restore(),n.strokeStyle=e}let b=t.lineWidth;const y=t.textMatrixScale;if(0===y||0===b){const e=t.textRenderingMode&eu;e!==Jh&&e!==Qh||(b=this.getSinglePixelWidth())}else b/=y;if(1!==r&&(n.scale(r,r),b/=r),n.lineWidth=b,s.isInvalidPDFjsFont){const s=[];let i=0;for(const t of e)s.push(t.unicode),i+=t.width;return n.fillText(s.join(""),0,0),t.x+=i*f*c,n.restore(),void this.compose()}let x,w=0;for(x=0;x<d;++x){const t=e[x];if("number"===typeof t){w+=u*t*i/1e3;continue}let c=!1;const d=(t.isSpace?o:0)+a,b=t.fontChar,y=t.accent;let _,S,k=t.width;if(h){const e=t.vmetric||p,s=-(t.vmetric?e[1]:.5*k)*f,i=e[2]*f;k=e?-e[0]:k,_=s/r,S=(w+i)/r}else _=w/r,S=0;if(s.remeasure&&k>0){const e=1e3*n.measureText(b).width/i*r;if(k<e&&this.isFontSubpixelAAEnabled){const t=k/e;c=!0,n.save(),n.scale(t,1),_/=t}else k!==e&&(_+=(k-e)/2e3*i/r)}if(this.contentVisible&&(t.isInFont||s.missingFile))if(m&&!y)n.fillText(b,_,S);else if(this.paintChar(b,_,S,g,v),y){const e=_+i*y.offset.x/r,t=S-i*y.offset.y/r;this.paintChar(y.fontChar,e,t,g,v)}w+=h?k*f-d*l:k*f+d*l,c&&n.restore()}h?t.y-=w:t.x+=w*c,n.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,n=s.fontSize,r=s.fontDirection,a=i.vertical?1:-1,o=s.charSpacing,l=s.wordSpacing,c=s.textHScale*r,d=s.fontMatrix||Lh,h=e.length;let u,p,f,m;if(!(s.textRenderingMode===Zh)&&0!==n){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(c,r),u=0;u<h;++u){if(p=e[u],"number"===typeof p){m=a*p*n/1e3,this.ctx.translate(m,0),s.x+=m*c;continue}const r=(p.isSpace?l:0)+o,h=i.charProcOperatorList[p.operatorListId];if(!h){Ru(`Type3 character "${p.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=p,this.save(),t.scale(n,n),t.transform(...d),this.executeOperatorList(h),this.restore());f=Ju.applyTransform([p.width,0],d)[0]*n+r,t.translate(f,0),s.x+=f*c}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,n,r){this.ctx.rect(s,i,n-s,r-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if("TilingPattern"===e[0]){const s=e[1],i=this.baseTransform||bp(this.ctx),n={createCanvasGraphics:e=>new Ff(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Sf(e,s,this.ctx,n,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=Ju.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=Ju.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cachedPatterns.has(e)?t=this.cachedPatterns.get(e):(t=function(e){switch(e[0]){case"RadialAxial":return new gf(e);case"Mesh":return new yf(e);case"Dummy":return new xf}throw new Error(`Unknown IR type: ${e[0]}`)}(this.getObject(e)),this.cachedPatterns.set(e,t)),s&&(t.matrix=s),t}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,yp(t),pf);const i=yp(t);if(i){const{width:e,height:s}=t.canvas,[n,r,a,o]=Ju.getAxialAlignedBoundingBox([0,0,e,s],i);this.ctx.fillRect(n,r,a-n,o-r)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Du("Should not call beginInlineImage")}beginImageData(){Du("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=bp(this.ctx),t)){const e=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],e,s),this.current.updateRectMinMax(bp(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Pu("TODO: Support non-isolated groups."),e.knockout&&Ru("Knockout groups not supported.");const s=bp(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=Ju.getAxialAlignedBoundingBox(e.bbox,bp(t));const n=[0,0,t.canvas.width,t.canvas.height];i=Ju.intersect(i,n)||[0,0,0,0];const r=Math.floor(i[0]),a=Math.floor(i[1]),o=Math.max(Math.ceil(i[2])-r,1),l=Math.max(Math.ceil(i[3])-a,1);this.current.startNewPathAndClipBox([0,0,o,l]);let c="groupAt"+this.groupLevel;e.smask&&(c+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(c,o,l),h=d.context;h.translate(-r,-a),h.transform(...s),e.smask?this.smaskStack.push({canvas:d.canvas,context:h,offsetX:r,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(r,a),t.save()),Mf(t,h),this.ctx=h,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=bp(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...e);const s=Ju.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],e);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,s,i,n){if(this.#cs(),Pf(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const i=t[2]-t[0],r=t[3]-t[1];if(n&&this.annotationCanvasMap){(s=s.slice())[4]-=t[0],s[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=i,t[3]=r;const[n,a]=Ju.singularValueDecompose2dScale(bp(this.ctx)),{viewportScale:o}=this,l=Math.ceil(i*this.outputScaleX*o),c=Math.ceil(r*this.outputScaleY*o);this.annotationCanvas=this.canvasFactory.create(l,c);const{canvas:d,context:h}=this.annotationCanvas;this.annotationCanvasMap.set(e,d),this.annotationCanvas.savedCtx=this.ctx,this.ctx=h,this.ctx.save(),this.ctx.setTransform(n,0,0,-a,0,r*a),Pf(this.ctx)}else Pf(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],i,r),this.ctx.clip(),this.ctx.beginPath()}this.current=new Nf(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#ds(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const s=this.ctx,i=this.processingType3;if(i&&(void 0===i.compiled&&(i.compiled=function(e){const{width:t,height:s}=e;if(t>1e3||s>1e3)return null;const i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=t+1;let r,a,o,l=new Uint8Array(n*(s+1));const c=t+7&-8;let d=new Uint8Array(c*s),h=0;for(const m of e.data){let e=128;for(;e>0;)d[h++]=m&e?0:255,e>>=1}let u=0;for(h=0,0!==d[h]&&(l[0]=1,++u),a=1;a<t;a++)d[h]!==d[h+1]&&(l[a]=d[h]?2:1,++u),h++;for(0!==d[h]&&(l[a]=2,++u),r=1;r<s;r++){h=r*c,o=r*n,d[h-c]!==d[h]&&(l[o]=d[h]?1:8,++u);let e=(d[h]?4:0)+(d[h-c]?8:0);for(a=1;a<t;a++)e=(e>>2)+(d[h+1]?4:0)+(d[h-c+1]?8:0),i[e]&&(l[o+a]=i[e],++u),h++;if(d[h-c]!==d[h]&&(l[o+a]=d[h]?2:4,++u),u>1e3)return null}for(h=c*(s-1),o=r*n,0!==d[h]&&(l[o]=8,++u),a=1;a<t;a++)d[h]!==d[h+1]&&(l[o+a]=d[h]?4:8,++u),h++;if(0!==d[h]&&(l[o+a]=4,++u),u>1e3)return null;const p=new Int32Array([0,n,-1,0,-n,0,0,0,1]),f=new Path2D;for(r=0;u&&r<=s;r++){let e=r*n;const s=e+t;for(;e<s&&!l[e];)e++;if(e===s)continue;f.moveTo(e%n,r);const i=e;let a=l[e];do{const t=p[a];do{e+=t}while(!l[e]);const s=l[e];5!==s&&10!==s?(a=s,l[e]=0):(a=s&51*a>>4,l[e]&=a>>2|a<<2),f.lineTo(e%n,e/n|0),l[e]||--u}while(i!==e);--r}return d=null,l=null,function(e){e.save(),e.scale(1/t,-1/s),e.translate(0,-s),e.fill(f),e.beginPath(),e.restore()}}(e)),i.compiled))return void i.compiled(s);const n=this._createMaskCanvas(e),r=n.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,n.offsetX,n.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const o=bp(a);a.transform(t,s,i,n,0,0);const l=this._createMaskCanvas(e);a.setTransform(1,0,0,1,l.offsetX-o[4],l.offsetY-o[5]);for(let c=0,d=r.length;c<d;c+=2){const e=Ju.transform(o,[t,s,i,n,r[c],r[c+1]]),[d,h]=Ju.applyTransform([0,0],e);a.drawImage(l.canvas,d,h)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const n of e){const{data:e,width:r,height:a,transform:o}=n,l=this.cachedCanvases.getCanvas("maskCanvas",r,a),c=l.context;c.save();Tf(c,this.getObject(e,n)),c.globalCompositeOperation="source-in",c.fillStyle=i?s.getPattern(c,this,yp(t),hf):s,c.fillRect(0,0,r,a),c.restore(),t.save(),t.transform(...o),t.scale(1,-1),Ef(t,l.canvas,0,0,r,a,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t?this.paintInlineImageXObject(t):Ru("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const n=this.getObject(e);if(!n)return void Ru("Dependent image isn't ready yet");const r=n.width,a=n.height,o=[];for(let l=0,c=i.length;l<c;l+=2)o.push({transform:[t,0,0,s,i[l],i[l+1]],x:0,y:0,w:r,h:a});this.paintInlineImageXObjectGroup(n,o)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:s,height:i}=e,n=this.cachedCanvases.getCanvas("inlineImage",s,i),r=n.context;return r.filter=this.current.transferMaps,r.drawImage(t,0,0),r.filter="none",n.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!Dh){const{filter:e}=i;"none"!==e&&""!==e&&(i.filter="none")}let n;if(i.scale(1/t,-1/s),e.bitmap)n=this.applyTransferMapsToBitmap(e);else if("function"===typeof HTMLElement&&e instanceof HTMLElement||!e.data)n=e;else{const i=this.cachedCanvases.getCanvas("inlineImage",t,s).context;jf(i,e),n=this.applyTransferMapsToCanvas(i)}const r=this._scaleImage(n,yp(i));i.imageSmoothingEnabled=Rf(bp(i),e.interpolate),Ef(i,r.img,0,0,r.paintWidth,r.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const t=e.width,s=e.height,n=this.cachedCanvases.getCanvas("inlineImage",t,s).context;jf(n,e),i=this.applyTransferMapsToCanvas(n)}for(const n of t)s.save(),s.transform(...n.transform),s.scale(1,-1),Ef(s,i,n.x,n.y,n.w,n.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===Of?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=bp(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:n}=this.ctx.getTransform();let r,a;if(0===s&&0===i){const s=Math.abs(t),i=Math.abs(n);if(s===i)if(0===e)r=a=1/s;else{const t=s*e;r=a=t<1?1/t:1}else if(0===e)r=1/s,a=1/i;else{const t=s*e,n=i*e;r=t<1?1/t:1,a=n<1?1/n:1}}else{const o=Math.abs(t*n-s*i),l=Math.hypot(t,s),c=Math.hypot(i,n);if(0===e)r=c/o,a=l/o;else{const t=e*o;r=c>t?c/t:1,a=l>t?l/t:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,n]=this.getScaleForStroking();if(t.lineWidth=s||1,1===i&&1===n)return void t.stroke();const r=t.getLineDash();if(e&&t.save(),t.scale(i,n),r.length>0){const e=Math.max(i,n);t.setLineDash(r.map((t=>t/e))),t.lineDashOffset/=e}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const s in Eu)void 0!==Ff.prototype[s]&&(Ff.prototype[Eu[s]]=Ff.prototype[s]);class zf{static#us=null;static#ps="";static get workerPort(){return this.#us}static set workerPort(e){if(!("undefined"!==typeof Worker&&e instanceof Worker)&&null!==e)throw new Error("Invalid `workerPort` type.");this.#us=e}static get workerSrc(){return this.#ps}static set workerSrc(e){if("string"!==typeof e)throw new Error("Invalid `workerSrc` type.");this.#ps=e}}class Bf{#fs;#ms;constructor(e){let{parsedData:t,rawData:s}=e;this.#fs=t,this.#ms=s}getRaw(){return this.#ms}get(e){return this.#fs.get(e)??null}getAll(){return Yu(this.#fs)}has(e){return this.#fs.has(e)}}const $f=Symbol("INTERNAL");class Hf{#gs=!1;#vs=!1;#bs=!1;#ys=!0;constructor(e,t){let{name:s,intent:i,usage:n,rbGroups:r}=t;this.#gs=!!(e&zh),this.#vs=!!(e&Bh),this.name=s,this.intent=i,this.usage=n,this.rbGroups=r}get visible(){if(this.#bs)return this.#ys;if(!this.#ys)return!1;const{print:e,view:t}=this.usage;return this.#gs?"OFF"!==t?.viewState:!this.#vs||"OFF"!==e?.printState}_setVisible(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e!==$f&&Du("Internal method `_setVisible` called."),this.#bs=s,this.#ys=t}}class Uf{#xs=null;#ws=(()=>new Map)();#_s=null;#Ss=null;constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zh;if(this.renderingIntent=t,this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,this.#Ss=e.order;for(const s of e.groups)this.#ws.set(s.id,new Hf(t,s));if("OFF"===e.baseState)for(const e of this.#ws.values())e._setVisible($f,!1);for(const t of e.on)this.#ws.get(t)._setVisible($f,!0);for(const t of e.off)this.#ws.get(t)._setVisible($f,!1);this.#_s=this.getHash()}}#ks(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const t=e[i];let n;if(Array.isArray(t))n=this.#ks(t);else{if(!this.#ws.has(t))return Ru(`Optional content group not found: ${t}`),!0;n=this.#ws.get(t).visible}switch(s){case"And":if(!n)return!1;break;case"Or":if(n)return!0;break;case"Not":return!n;default:return!0}}return"And"===s}isVisible(e){if(0===this.#ws.size)return!0;if(!e)return Pu("Optional content group not defined."),!0;if("OCG"===e.type)return this.#ws.has(e.id)?this.#ws.get(e.id).visible:(Ru(`Optional content group not found: ${e.id}`),!0);if("OCMD"===e.type){if(e.expression)return this.#ks(e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!this.#ws.has(t))return Ru(`Optional content group not found: ${t}`),!0;if(this.#ws.get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!this.#ws.has(t))return Ru(`Optional content group not found: ${t}`),!0;if(!this.#ws.get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!this.#ws.has(t))return Ru(`Optional content group not found: ${t}`),!0;if(!this.#ws.get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!this.#ws.has(t))return Ru(`Optional content group not found: ${t}`),!0;if(this.#ws.get(t).visible)return!1}return!0}return Ru(`Unknown optional content policy ${e.policy}.`),!0}return Ru(`Unknown group type ${e.type}.`),!0}setVisibility(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=this.#ws.get(e);if(i){if(s&&t&&i.rbGroups.length)for(const t of i.rbGroups)for(const s of t)s!==e&&this.#ws.get(s)?._setVisible($f,!1,!0);i._setVisible($f,!!t,!0),this.#xs=null}else Ru(`Optional content group not found: ${e}`)}setOCGState(e){let t,{state:s,preserveRB:i}=e;for(const n of s){switch(n){case"ON":case"OFF":case"Toggle":t=n;continue}const e=this.#ws.get(n);if(e)switch(t){case"ON":this.setVisibility(n,!0,i);break;case"OFF":this.setVisibility(n,!1,i);break;case"Toggle":this.setVisibility(n,!e.visible,i)}}this.#xs=null}get hasInitialVisibility(){return null===this.#_s||this.getHash()===this.#_s}getOrder(){return this.#ws.size?this.#Ss?this.#Ss.slice():[...this.#ws.keys()]:null}getGroups(){return this.#ws.size>0?Yu(this.#ws):null}getGroup(e){return this.#ws.get(e)||null}getHash(){if(null!==this.#xs)return this.#xs;const e=new Fp;for(const[t,s]of this.#ws)e.update(`${t}:${s.visible}`);return this.#xs=e.hexdigest()}}class Vf{constructor(e,t){let{disableRange:s=!1,disableStream:i=!1}=t;Iu(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,r?.length>0){const e=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!s,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener(((e,t)=>{this._onReceiveData({begin:e,chunk:t})})),e.addProgressListener(((e,t)=>{this._onProgress({loaded:e,total:t})})),e.addProgressiveReadListener((e=>{this._onReceiveData({chunk:e})})),e.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),e.transportReady()}_onReceiveData(e){let{begin:t,chunk:s}=e;const i=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;if(void 0===t)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{Iu(this._rangeReaders.some((function(e){return e._begin===t&&(e._enqueue(i),!0)})),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){void 0===e.total?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Iu(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new Wf(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new qf(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class Wf{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._stream=e,this._done=s||!1,this._filename=lp(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunks.push(e);this._loaded+=e.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class qf{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Gf(e,t){const s=new Headers;if(!e||!t||"object"!==typeof t)return s;for(const i in t){const e=t[i];void 0!==e&&s.append(i,e)}return s}function Yf(e){try{return new URL(e).origin}catch{}return null}function Kf(e){let{responseHeaders:t,isHttp:s,rangeChunkSize:i,disableRange:n}=e;const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(t.get("Content-Length"),10);if(!Number.isInteger(a))return r;if(r.suggestedLength=a,a<=2*i)return r;if(n||!s)return r;if("bytes"!==t.get("Accept-Ranges"))return r;return"identity"!==(t.get("Content-Encoding")||"identity")||(r.allowRangeRequests=!0),r}function Xf(e){const t=e.get("Content-Disposition");if(t){let e=function(e){let t=!0,s=i("filename\\*","i").exec(e);if(s){s=s[1];let e=a(s);return e=unescape(e),e=o(e),e=l(e),r(e)}if(s=function(e){const t=[];let s;const n=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(s=n.exec(e));){let[,e,i,n]=s;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[i,n]}const r=[];for(let i=0;i<t.length&&i in t;++i){let[e,s]=t[i];s=a(s),e&&(s=unescape(s),0===i&&(s=o(s))),r.push(s)}return r.join("")}(e),s)return r(l(s));if(s=i("filename","i").exec(e),s){s=s[1];let e=a(s);return e=l(e),r(e)}function i(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function n(e,s){if(e){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const i=new TextDecoder(e,{fatal:!0}),n=Gu(s);s=i.decode(n),t=!1}catch{}}return s}function r(e){return t&&/[\x80-\xff]/.test(e)&&(e=n("utf-8",e),t&&(e=n("iso-8859-1",e))),e}function a(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const s=t[e].indexOf('"');-1!==s&&(t[e]=t[e].slice(0,s),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function o(e){const t=e.indexOf("'");return-1===t?e:n(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function l(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(e,t,s,i){if("q"===s||"Q"===s)return i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})),n(t,i);try{i=atob(i)}catch{}return n(t,i)}))}return""}(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(lp(e))return e}return null}function Jf(e,t){return 404===e||0===e&&t.startsWith("file:")?new Hu('Missing PDF "'+t+'".'):new Uu(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e)}function Qf(e){return 200===e||206===e}function Zf(e,t,s){return{method:"GET",headers:e,signal:s.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function em(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(Ru(`getArrayBuffer - unexpected data format: ${e}`),new Uint8Array(e).buffer)}class tm{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Gf(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Iu(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new sm(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new im(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class sm{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,Zf(s,this._withCredentials,this._abortController)).then((t=>{if(e._responseOrigin=Yf(t.url),!Qf(t.status))throw Jf(t.status,i);this._reader=t.body.getReader(),this._headersCapability.resolve();const s=t.headers,{allowRangeRequests:n,suggestedLength:r}=Kf({responseHeaders:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=n,this._contentLength=r||this._contentLength,this._filename=Xf(s),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Wu("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:em(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class im{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const n=new Headers(e.headers);n.append("Range",`bytes=${t}-${s-1}`);const r=i.url;fetch(r,Zf(n,this._withCredentials,this._abortController)).then((t=>{const s=Yf(t.url);if(s!==e._responseOrigin)throw new Error(`Expected range response-origin "${s}" to match "${e._responseOrigin}".`);if(!Qf(t.status))throw Jf(t.status,r);this._readCapability.resolve(),this._reader=t.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:em(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class nm{_responseOrigin=null;constructor(e){let{url:t,httpHeaders:s,withCredentials:i}=e;this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Gf(this.isHttp,s),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[n,r]of this.headers)t.setRequestHeader(n,r);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",Iu(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),4!==i.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===i.status&&this.isHttp)return void s.onError(i.status);const n=i.status||200;if(!(200===n&&206===s.expectedStatus)&&n!==s.expectedStatus)return void s.onError(i.status);const r=function(e){const t=e.response;return"string"!==typeof t?t:Gu(t).buffer}(i);if(206===n){const e=i.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);t?s.onDone({begin:parseInt(t[1],10),chunk:r}):(Ru('Missing or invalid "Content-Range" header.'),s.onError(0))}else r?s.onDone({begin:0,chunk:r}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class rm{constructor(e){this._source=e,this._manager=new nm(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Iu(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new am(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new om(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class am{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Yf(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map((e=>{const[t,...s]=e.split(": ");return[t,s.join(": ")]})):[]),{allowRangeRequests:n,suggestedLength:r}=Kf({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=Xf(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e)if(this._requests.length>0){this._requests.shift().resolve({value:e.chunk,done:!1})}else this._cachedChunks.push(e.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Jf(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class om{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Yf(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunk=t;this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=Jf(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const lm=/^[a-z][a-z0-9\-+.]+:/i;class cm{constructor(e){this.source=e,this.url=function(e){if(lm.test(e))return new URL(e);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(e))}(e.url),Iu("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Iu(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new dm(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new hm(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class dm{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then((e=>{this._contentLength=e.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()}),(e=>{"ENOENT"===e.code&&(e=new Hu(`Missing PDF "${this._url}".`)),this._storedError=e,this._headersCapability.reject(e)}))}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();if(null===e)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(e).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",(()=>{this._readCapability.resolve()})),e.on("end",(()=>{e.destroy(),this._done=!0,this._readCapability.resolve()})),e.on("error",(e=>{this._error(e)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Wu("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class hm{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const n=process.getBuiltinModule("fs");this._setReadableStream(n.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();if(null===e)return this._readCapability=Promise.withResolvers(),this.read();this._loaded+=e.length,this.onProgress?.({loaded:this._loaded});return{value:new Uint8Array(e).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",(()=>{this._readCapability.resolve()})),e.on("end",(()=>{e.destroy(),this._done=!0,this._readCapability.resolve()})),e.on("error",(e=>{this._error(e)})),this._storedError&&this._readableStream.destroy(this._storedError)}}const um=30;class pm{#As=(()=>Promise.withResolvers())();#pe=null;#Cs=!1;#Es=(()=>!!globalThis.FontInspector?.enabled)();#Ns=null;#js=null;#Ts=0;#Ms=0;#Ps=null;#Rs=null;#Ds=0;#Is=0;#Ls=(()=>Object.create(null))();#Os=[];#Fs=null;#zs=[];#Bs=(()=>new WeakMap)();#$s=null;static#Hs=(()=>new Map)();static#Us=(()=>new Map)();static#Vs=(()=>new WeakMap)();static#Ws=null;static#qs=(()=>new Set)();constructor(e){let{textContentSource:t,container:s,viewport:i}=e;if(t instanceof ReadableStream)this.#Fs=t;else{if("object"!==typeof t)throw new Error('No "textContentSource" parameter specified.');this.#Fs=new ReadableStream({start(e){e.enqueue(t),e.close()}})}this.#pe=this.#Rs=s,this.#Is=i.scale*(globalThis.devicePixelRatio||1),this.#Ds=i.rotation,this.#js={div:null,properties:null,ctx:null};const{pageWidth:n,pageHeight:r,pageX:a,pageY:o}=i.rawDims;this.#$s=[1,0,0,-1,-a,o+r],this.#Ms=n,this.#Ts=r,pm.#Gs(),xp(s,i),this.#As.promise.finally((()=>{pm.#qs.delete(this),this.#js=null,this.#Ls=null})).catch((()=>{}))}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Ku.platform;return Ou(this,"fontFamilyMap",new Map([["sans-serif",(e&&t?"Calibri, ":"")+"sans-serif"],["monospace",(e&&t?"Lucida Console, ":"")+"monospace"]]))}render(){const e=()=>{this.#Ps.read().then((t=>{let{value:s,done:i}=t;i?this.#As.resolve():(this.#Ns??=s.lang,Object.assign(this.#Ls,s.styles),this.#Ys(s.items),e())}),this.#As.reject)};return this.#Ps=this.#Fs.getReader(),pm.#qs.add(this),e(),this.#As.promise}update(e){let{viewport:t,onBefore:s=null}=e;const i=t.scale*(globalThis.devicePixelRatio||1),n=t.rotation;if(n!==this.#Ds&&(s?.(),this.#Ds=n,xp(this.#Rs,{rotation:n})),i!==this.#Is){s?.(),this.#Is=i;const e={div:null,properties:null,ctx:pm.#Ks(this.#Ns)};for(const t of this.#zs)e.properties=this.#Bs.get(t),e.div=t,this.#Xs(e)}}cancel(){const e=new Wu("TextLayer task cancelled.");this.#Ps?.cancel(e).catch((()=>{})),this.#Ps=null,this.#As.reject(e)}get textDivs(){return this.#zs}get textContentItemsStr(){return this.#Os}#Ys(e){if(this.#Cs)return;this.#js.ctx??=pm.#Ks(this.#Ns);const t=this.#zs,s=this.#Os;for(const i of e){if(t.length>1e5)return Ru("Ignoring additional textDivs for performance reasons."),void(this.#Cs=!0);if(void 0!==i.str)s.push(i.str),this.#Js(i);else if("beginMarkedContentProps"===i.type||"beginMarkedContent"===i.type){const e=this.#pe;this.#pe=document.createElement("span"),this.#pe.classList.add("markedContent"),null!==i.id&&this.#pe.setAttribute("id",`${i.id}`),e.append(this.#pe)}else"endMarkedContent"===i.type&&(this.#pe=this.#pe.parentNode)}}#Js(e){const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:""!==e.str,hasEOL:e.hasEOL,fontSize:0};this.#zs.push(t);const i=Ju.transform(this.#$s,e.transform);let n=Math.atan2(i[1],i[0]);const r=this.#Ls[e.fontName];r.vertical&&(n+=Math.PI/2);let a=this.#Es&&r.fontSubstitution||r.fontFamily;a=pm.fontFamilyMap.get(a)||a;const o=Math.hypot(i[2],i[3]),l=o*pm.#Qs(a,this.#Ns);let c,d;0===n?(c=i[4],d=i[5]-l):(c=i[4]+l*Math.sin(n),d=i[5]-l*Math.cos(n));const h="calc(var(--scale-factor)*",u=t.style;this.#pe===this.#Rs?(u.left=`${(100*c/this.#Ms).toFixed(2)}%`,u.top=`${(100*d/this.#Ts).toFixed(2)}%`):(u.left=`${h}${c.toFixed(2)}px)`,u.top=`${h}${d.toFixed(2)}px)`),u.fontSize=`${h}${(pm.#Ws*o).toFixed(2)}px)`,u.fontFamily=a,s.fontSize=o,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#Es&&(t.dataset.fontName=r.fontSubstitutionLoadedName||e.fontName),0!==n&&(s.angle=n*(180/Math.PI));let p=!1;if(e.str.length>1)p=!0;else if(" "!==e.str&&e.transform[0]!==e.transform[3]){const t=Math.abs(e.transform[0]),s=Math.abs(e.transform[3]);t!==s&&Math.max(t,s)/Math.min(t,s)>1.5&&(p=!0)}if(p&&(s.canvasWidth=r.vertical?e.height:e.width),this.#Bs.set(t,s),this.#js.div=t,this.#js.properties=s,this.#Xs(this.#js),s.hasText&&this.#pe.append(t),s.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),this.#pe.append(e)}}#Xs(e){const{div:t,properties:s,ctx:i}=e,{style:n}=t;let r="";if(pm.#Ws>1&&(r=`scale(${1/pm.#Ws})`),0!==s.canvasWidth&&s.hasText){const{fontFamily:e}=n,{canvasWidth:a,fontSize:o}=s;pm.#Zs(i,o*this.#Is,e);const{width:l}=i.measureText(t.textContent);l>0&&(r=`scaleX(${a*this.#Is/l}) ${r}`)}0!==s.angle&&(r=`rotate(${s.angle}deg) ${r}`),r.length>0&&(n.transform=r)}static cleanup(){if(!(this.#qs.size>0)){this.#Hs.clear();for(const{canvas:e}of this.#Us.values())e.remove();this.#Us.clear()}}static#Ks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.#Us.get(e||="");if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#Us.set(e,t),this.#Vs.set(t,{size:0,family:""})}return t}static#Zs(e,t,s){const i=this.#Vs.get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)}static#Gs(){if(null!==this.#Ws)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#Ws=e.getBoundingClientRect().height,e.remove()}static#Qs(e,t){const s=this.#Hs.get(e);if(s)return s;const i=this.#Ks(t);i.canvas.width=i.canvas.height=um,this.#Zs(i,um,e);const n=i.measureText("");let r=n.fontBoundingBoxAscent,a=Math.abs(n.fontBoundingBoxDescent);if(r){const t=r/(r+a);return this.#Hs.set(e,t),i.canvas.width=i.canvas.height=0,t}i.strokeStyle="red",i.clearRect(0,0,um,um),i.strokeText("g",0,0);let o=i.getImageData(0,0,um,um).data;a=0;for(let c=o.length-1-3;c>=0;c-=4)if(o[c]>0){a=Math.ceil(c/4/um);break}i.clearRect(0,0,um,um),i.strokeText("A",0,um),o=i.getImageData(0,0,um,um).data,r=0;for(let c=0,d=o.length;c<d;c+=4)if(o[c]>0){r=um-Math.floor(c/4/um);break}i.canvas.width=i.canvas.height=0;const l=r?r/(r+a):.8;return this.#Hs.set(e,l),l}}class fm{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};return function e(s){if(!s)return;let i=null;const n=s.name;if("#text"===n)i=s.value;else{if(!fm.shouldBuildText(n))return;s?.attributes?.textContent?i=s.attributes.textContent:s.value&&(i=s.value)}if(null!==i&&t.push({str:i}),s.children)for(const t of s.children)e(t)}(e),s}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}const mm=65536,gm=Dh?class extends nf{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire("file:///C:/Users/shrut/OneDrive/Desktop/DigiHealth(React)/digihealth/node_modules/pdfjs-dist/build/pdf.mjs")("@napi-rs/canvas").createCanvas(e,t)}}:class extends nf{constructor(e){let{ownerDocument:t=globalThis.document,enableHWA:s=!1}=e;super({enableHWA:s}),this._document=t}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}},vm=Dh?class extends rf{async _fetch(e){return df(e)}}:af,bm=Dh?class extends of{}:class extends of{#ei;#ti;#si;#ii;#ni;#ri;#y=0;constructor(e){let{docId:t,ownerDocument:s=globalThis.document}=e;super(),this.#ii=t,this.#ni=s}get#w(){return this.#ti||=new Map}get#ai(){return this.#ri||=new Map}get#oi(){if(!this.#si){const e=this.#ni.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=this.#ni.createElementNS(sp,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#si=this.#ni.createElementNS(sp,"defs"),e.append(s),s.append(this.#si),this.#ni.body.append(e)}return this.#si}#li(e){if(1===e.length){const t=e[0],s=new Array(256);for(let e=0;e<256;e++)s[e]=t[e]/255;const i=s.join(",");return[i,i,i]}const[t,s,i]=e,n=new Array(256),r=new Array(256),a=new Array(256);for(let o=0;o<256;o++)n[o]=t[o]/255,r[o]=s[o]/255,a[o]=i[o]/255;return[n.join(","),r.join(","),a.join(",")]}#ci(e){if(void 0===this.#ei){this.#ei="";const e=this.#ni.URL;e!==this.#ni.baseURI&&(op(e)?Ru('#createUrl: ignore "data:"-URL for performance reasons.'):this.#ei=e.split("#",1)[0])}return`url(${this.#ei}#${e})`}addFilter(e){if(!e)return"none";let t=this.#w.get(e);if(t)return t;const[s,i,n]=this.#li(e),r=1===e.length?s:`${s}${i}${n}`;if(t=this.#w.get(r),t)return this.#w.set(e,t),t;const a=`g_${this.#ii}_transfer_map_${this.#y++}`,o=this.#ci(a);this.#w.set(e,o),this.#w.set(r,o);const l=this.#di(a);return this.#hi(s,i,n,l),o}addHCMFilter(e,t){const s=`${e}-${t}`,i="base";let n=this.#ai.get(i);if(n?.key===s)return n.url;if(n?(n.filter?.remove(),n.key=s,n.url="none",n.filter=null):(n={key:s,url:"none",filter:null},this.#ai.set(i,n)),!e||!t)return n.url;const r=this.#ui(e);e=Ju.makeHexColor(...r);const a=this.#ui(t);if(t=Ju.makeHexColor(...a),this.#oi.style.color="","#000000"===e&&"#ffffff"===t||e===t)return n.url;const o=new Array(256);for(let u=0;u<=255;u++){const e=u/255;o[u]=e<=.03928?e/12.92:((e+.055)/1.055)**2.4}const l=o.join(","),c=`g_${this.#ii}_hcm_filter`,d=n.filter=this.#di(c);this.#hi(l,l,l,d),this.#pi(d);const h=(e,t)=>{const s=r[e]/255,i=a[e]/255,n=new Array(t+1);for(let r=0;r<=t;r++)n[r]=s+r/t*(i-s);return n.join(",")};return this.#hi(h(0,5),h(1,5),h(2,5),d),n.url=this.#ci(c),n.url}addAlphaFilter(e){let t=this.#w.get(e);if(t)return t;const[s]=this.#li([e]),i=`alpha_${s}`;if(t=this.#w.get(i),t)return this.#w.set(e,t),t;const n=`g_${this.#ii}_alpha_map_${this.#y++}`,r=this.#ci(n);this.#w.set(e,r),this.#w.set(i,r);const a=this.#di(n);return this.#fi(s,a),r}addLuminosityFilter(e){let t,s,i=this.#w.get(e||"luminosity");if(i)return i;if(e?([t]=this.#li([e]),s=`luminosity_${t}`):s="luminosity",i=this.#w.get(s),i)return this.#w.set(e,i),i;const n=`g_${this.#ii}_luminosity_map_${this.#y++}`,r=this.#ci(n);this.#w.set(e,r),this.#w.set(s,r);const a=this.#di(n);return this.#mi(a),e&&this.#fi(t,a),r}addHighlightHCMFilter(e,t,s,i,n){const r=`${t}-${s}-${i}-${n}`;let a=this.#ai.get(e);if(a?.key===r)return a.url;if(a?(a.filter?.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},this.#ai.set(e,a)),!t||!s)return a.url;const[o,l]=[t,s].map(this.#ui.bind(this));let c=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),d=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[h,u]=[i,n].map(this.#ui.bind(this));d<c&&([c,d,h,u]=[d,c,u,h]),this.#oi.style.color="";const p=(e,t,s)=>{const i=new Array(256),n=(d-c)/s,r=e/255,a=(t-e)/(255*s);let o=0;for(let l=0;l<=s;l++){const e=Math.round(c+l*n),t=r+l*a;for(let s=o;s<=e;s++)i[s]=t;o=e+1}for(let l=o;l<256;l++)i[l]=i[o-1];return i.join(",")},f=`g_${this.#ii}_hcm_${e}_filter`,m=a.filter=this.#di(f);return this.#pi(m),this.#hi(p(h[0],u[0],5),p(h[1],u[1],5),p(h[2],u[2],5),m),a.url=this.#ci(f),a.url}destroy(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&this.#ri?.size||(this.#si?.parentNode.parentNode.remove(),this.#si=null,this.#ti?.clear(),this.#ti=null,this.#ri?.clear(),this.#ri=null,this.#y=0)}#mi(e){const t=this.#ni.createElementNS(sp,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#pi(e){const t=this.#ni.createElementNS(sp,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#di(e){const t=this.#ni.createElementNS(sp,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#oi.append(t),t}#gi(e,t,s){const i=this.#ni.createElementNS(sp,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",s),e.append(i)}#hi(e,t,s,i){const n=this.#ni.createElementNS(sp,"feComponentTransfer");i.append(n),this.#gi(n,"feFuncR",e),this.#gi(n,"feFuncG",t),this.#gi(n,"feFuncB",s)}#fi(e,t){const s=this.#ni.createElementNS(sp,"feComponentTransfer");t.append(s),this.#gi(s,"feFuncA",e)}#ui(e){return this.#oi.style.color=e,vp(getComputedStyle(this.#oi).getPropertyValue("color"))}},ym=Dh?class extends lf{async _fetch(e){return df(e)}}:cf;function xm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"string"===typeof e||e instanceof URL?e={url:e}:(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t=new _m,{docId:s}=t,i=e.url?function(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(Dh&&"string"===typeof e)return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(e.url):null,n=e.data?function(e){if(Dh&&"undefined"!==typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"===typeof e)return Gu(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||"object"===typeof e&&!isNaN(e?.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(e.data):null,r=e.httpHeaders||null,a=!0===e.withCredentials,o=e.password??null,l=e.range instanceof Sm?e.range:null,c=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:mm;let d=e.worker instanceof Em?e.worker:null;const h=e.verbosity,u="string"!==typeof e.docBaseUrl||op(e.docBaseUrl)?null:e.docBaseUrl,p="string"===typeof e.cMapUrl?e.cMapUrl:null,f=!1!==e.cMapPacked,m=e.CMapReaderFactory||vm,g="string"===typeof e.standardFontDataUrl?e.standardFontDataUrl:null,v=e.StandardFontDataFactory||ym,b=!0!==e.stopAtErrors,y=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,x=!1!==e.isEvalSupported,w="boolean"===typeof e.isOffscreenCanvasSupported?e.isOffscreenCanvasSupported:!Dh,_="boolean"===typeof e.isImageDecoderSupported?e.isImageDecoderSupported:!Dh&&(Ku.platform.isFirefox||!globalThis.chrome),S=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,k="boolean"===typeof e.disableFontFace?e.disableFontFace:Dh,A=!0===e.fontExtraProperties,C=!0===e.enableXfa,E=e.ownerDocument||globalThis.document,N=!0===e.disableRange,j=!0===e.disableStream,T=!0===e.disableAutoFetch,M=!0===e.pdfBug,P=e.CanvasFactory||gm,R=e.FilterFactory||bm,D=!0===e.enableHWA,I=l?l.length:e.length??NaN,L="boolean"===typeof e.useSystemFonts?e.useSystemFonts:!Dh&&!k,O="boolean"===typeof e.useWorkerFetch?e.useWorkerFetch:m===af&&v===cf&&p&&g&&up(p,document.baseURI)&&up(g,document.baseURI);Tu(h);const F={canvasFactory:new P({ownerDocument:E,enableHWA:D}),filterFactory:new R({docId:s,ownerDocument:E}),cMapReaderFactory:O?null:new m({baseUrl:p,isCompressed:f}),standardFontDataFactory:O?null:new v({baseUrl:g})};if(!d){const e={verbosity:h,port:zf.workerPort};d=e.port?Em.fromPort(e):new Em(e),t._worker=d}const z={docId:s,apiVersion:"4.10.38",data:n,password:o,disableAutoFetch:T,rangeChunkSize:c,length:I,docBaseUrl:u,enableXfa:C,evaluatorOptions:{maxImageSize:y,disableFontFace:k,ignoreErrors:b,isEvalSupported:x,isOffscreenCanvasSupported:w,isImageDecoderSupported:_,canvasMaxAreaInBytes:S,fontExtraProperties:A,useSystemFonts:L,cMapUrl:O?p:null,standardFontDataUrl:O?g:null}},B={disableFontFace:k,fontExtraProperties:A,ownerDocument:E,pdfBug:M,styleElement:null,loadingParams:{disableAutoFetch:T,enableXfa:C}};return d.promise.then((function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const e=d.messageHandler.sendWithPromise("GetDocRequest",z,n?[n.buffer]:null);let o;if(l)o=new Vf(l,{disableRange:N,disableStream:j});else if(!n){if(!i)throw new Error("getDocument - no `url` parameter provided.");let e;if(Dh)if(up(i)){if("undefined"===typeof fetch||"undefined"===typeof Response||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");e=tm}else e=cm;else e=up(i)?tm:rm;o=new e({url:i,length:I,httpHeaders:r,withCredentials:a,rangeChunkSize:c,disableRange:N,disableStream:j})}return e.then((e=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const i=new sf(s,e,d.port),n=new Nm(i,t,o,B,F);t._transport=n,i.send("Ready",null)}))})).catch(t._capability.reject),t}function wm(e){return"object"===typeof e&&Number.isInteger(e?.num)&&e.num>=0&&Number.isInteger(e?.gen)&&e.gen>=0}class _m{static#ii=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId="d"+_m.#ii++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}}class Sm{constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then((()=>{for(const s of this._progressListeners)s(e,t)}))}onDataProgressiveRead(e){this._readyCapability.promise.then((()=>{for(const t of this._progressiveReadListeners)t(e)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const e of this._progressiveDoneListeners)e()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Du("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class km{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ou(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Am{#vi=null;#bi=!1;constructor(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new hp:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new Tm,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:n=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new rp({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:n})}getAnnotations(){let{intent:e="display"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ou(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render(e){let{canvasContext:t,viewport:s,intent:i="display",annotationMode:n=qh.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:d=null,isEditing:h=!1}=e;this._stats?.time("Overall");const u=this._transport.getRenderingIntent(i,n,d,h),{renderingIntent:p,cacheKey:f}=u;this.#bi=!1,this.#yi(),o||=this._transport.getOptionalContentConfig(p);let m=this._intentStates.get(f);m||(m=Object.create(null),this._intentStates.set(f,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const g=!!(p&Bh);m.displayReadyCapability||(m.displayReadyCapability=Promise.withResolvers(),m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(u));const v=e=>{m.renderTasks.delete(b),(this._maybeCleanupAfterRender||g)&&(this.#bi=!0),this.#xi(!g),e?(b.capability.reject(e),this._abortOperatorList({intentState:m,reason:e instanceof Error?e:new Error(e)})):b.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},b=new Pm({callback:v,params:{canvasContext:t,viewport:s,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!g,pdfBug:this._pdfBug,pageColors:c});(m.renderTasks||=new Set).add(b);const y=b.task;return Promise.all([m.displayReadyCapability.promise,o]).then((e=>{let[t,s]=e;if(this.destroyed)v();else{if(this._stats?.time("Rendering"),!(s.renderingIntent&p))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");b.initializeGraphics({transparency:t,optionalContentConfig:s}),b.operatorListChanged()}})).catch(v),y}getOperatorList(){let{intent:e="display",annotationMode:t=qh.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=this._transport.getRenderingIntent(e,t,s,i,!0);let r,a=this._intentStates.get(n.cacheKey);return a||(a=Object.create(null),this._intentStates.set(n.cacheKey,a)),a.opListReadCapability||(r=Object.create(null),r.operatorListChanged=function(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(r))},a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||=new Set).add(r),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(n)),a.opListReadCapability.promise}streamTextContent(){let{includeMarkedContent:e=!1,disableNormalization:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then((e=>fm.textContent(e)));const t=this.streamTextContent(e);return new Promise((function(e,s){const i=t.getReader(),n={items:[],styles:Object.create(null),lang:null};!function t(){i.read().then((function(s){let{value:i,done:r}=s;r?e(n):(n.lang??=i.lang,Object.assign(n.styles,i.styles),n.items.push(...i.items),t())}),s)}()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),this.#bi=!1,this.#yi(),Promise.all(e)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.#bi=!0;const t=this.#xi(!1);return e&&t&&(this._stats&&=new hp),t}#xi(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.#yi(),!this.#bi||this.destroyed)return!1;if(e)return this.#vi=setTimeout((()=>{this.#vi=null,this.#xi(!1)}),5e3),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#bi=!1,!0}#yi(){this.#vi&&(clearTimeout(this.#vi),this.#vi=null)}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&this.#xi(!0)}_pumpOperatorList(e){let{renderingIntent:t,cacheKey:s,annotationStorageSerializable:i,modifiedIds:n}=e;const{map:r,transfer:a}=i,o=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:s,annotationStorage:r,modifiedIds:n},a).getReader(),l=this._intentStates.get(s);l.streamReader=o;const c=()=>{o.read().then((e=>{let{value:t,done:s}=e;s?l.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,l),c())}),(e=>{if(l.streamReader=null,!this._transport.destroyed){if(l.operatorList){l.operatorList.lastChunk=!0;for(const e of l.renderTasks)e.operatorListChanged();this.#xi(!0)}if(l.displayReadyCapability)l.displayReadyCapability.reject(e);else{if(!l.opListReadCapability)throw e;l.opListReadCapability.reject(e)}}}))};c()}_abortOperatorList(e){let{intentState:t,reason:s,force:i=!1}=e;if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(s instanceof ap){let e=100;return s.extraDelay>0&&s.extraDelay<1e3&&(e+=s.extraDelay),void(t.streamReaderCancelTimeout=setTimeout((()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:s,force:!0})}),e))}}if(t.streamReader.cancel(new Wu(s.message)).catch((()=>{})),t.streamReader=null,!this._transport.destroyed){for(const[e,s]of this._intentStates)if(s===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}class Cm{#wi=(()=>new Map)();#_i=(()=>Promise.resolve())();postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};this.#_i.then((()=>{for(const[e]of this.#wi)e.call(this,s)}))}addEventListener(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null;if(s?.signal instanceof AbortSignal){const{signal:n}=s;if(n.aborted)return void Ru("LoopbackPort - cannot use an `aborted` signal.");const r=()=>this.removeEventListener(e,t);i=()=>n.removeEventListener("abort",r),n.addEventListener("abort",r)}this.#wi.set(t,i)}removeEventListener(e,t){const s=this.#wi.get(t);s?.(),this.#wi.delete(t)}terminate(){for(const[,e]of this.#wi)e?.();this.#wi.clear()}}class Em{static#Si=0;static#ki=!1;static#Ai;static#Ci=(()=>{Dh&&(this.#ki=!0,zf.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||"null"===s.origin)return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}})();constructor(){let{name:e=null,port:t=null,verbosity:s=Mu()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(Em.#Ai?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");return(Em.#Ai||=new WeakMap).set(t,this),void this._initializeFromPort(t)}this._initialize()}get promise(){return this._readyCapability.promise}#Ei(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new sf("main","worker",e),this._messageHandler.on("ready",(function(){})),this.#Ei()}_initialize(){if(Em.#ki||Em.#Ni)return void this._setupFakeWorker();let{workerSrc:e}=Em;try{Em._isSameOrigin(window.location.href,e)||(e=Em._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new sf("main","worker",t),i=()=>{n.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;t.addEventListener("error",(()=>{this._webWorker||i()}),{signal:n.signal}),s.on("test",(e=>{n.abort(),!this.destroyed&&e?(this._messageHandler=s,this._port=t,this._webWorker=t,this.#Ei()):i()})),s.on("ready",(e=>{if(n.abort(),this.destroyed)i();else try{r()}catch{this._setupFakeWorker()}}));const r=()=>{const e=new Uint8Array;s.send("test",e,[e.buffer])};return void r()}catch{Pu("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Em.#ki||(Ru("Setting up fake worker."),Em.#ki=!0),Em._setupFakeWorkerGlobal.then((e=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const t=new Cm;this._port=t;const s="fake"+Em.#Si++,i=new sf(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new sf(s,s+"_worker",t),this.#Ei()})).catch((e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,Em.#Ai?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#Ai?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Em(e)}static get workerSrc(){if(zf.workerSrc)return zf.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#Ni(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return Ou(this,"_setupFakeWorkerGlobal",(async()=>{if(this.#Ni)return this.#Ni;return(await import(this.workerSrc)).WorkerMessageHandler})())}}class Nm{#ji=(()=>new Map)();#Ti=(()=>new Map)();#Mi=(()=>new Map)();#Pi=(()=>new Map)();#Ri=null;constructor(e,t,s,i,n){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Tm,this.fontLoader=new Hp({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#Di(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.#ji.get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return this.#ji.set(e,i),i}get annotationStorage(){return Ou(this,"annotationStorage",new Bp)}getRenderingIntent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qh.ENABLE,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=zh,a=zp;switch(e){case"any":r=Fh;break;case"display":break;case"print":r=Bh;break;default:Ru(`getRenderingIntent - invalid intent: ${e}`)}const o=r&Bh&&s instanceof $p?s:this.annotationStorage;switch(t){case qh.DISABLE:r+=Uh;break;case qh.ENABLE:break;case qh.ENABLE_FORMS:r+=$h;break;case qh.ENABLE_STORAGE:r+=Hh,a=o.serializable;break;default:Ru(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(r+=Vh),n&&(r+=Wh);const{ids:l,hash:c}=o.modifiedIds;return{renderingIntent:r,cacheKey:[r,a.hash,c].join("_"),annotationStorageSerializable:a,modifiedIds:l}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#Ri?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of this.#Ti.values())e.push(s._destroy());this.#Ti.clear(),this.#Mi.clear(),this.#Pi.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#ji.clear(),this.filterFactory.destroy(),pm.cleanup(),this._networkStream?.cancelAllRequests(new Wu("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",((e,t)=>{Iu(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then((function(e){let{value:s,done:i}=e;i?t.close():(Iu(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(s),1,[s]))})).catch((e=>{t.error(e)}))},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch((e=>{if(!this.destroyed)throw e}))}})),e.on("ReaderHeadersReady",(async e=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:i,contentLength:n}=this._fullReader;return s&&i||(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=e=>{t.onProgress?.({loaded:e.loaded,total:e.total})}),{isStreamingSupported:s,isRangeSupported:i,contentLength:n}})),e.on("GetRangeReader",((e,t)=>{Iu(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(e.begin,e.end);s?(t.onPull=()=>{s.read().then((function(e){let{value:s,done:i}=e;i?t.close():(Iu(s instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(s),1,[s]))})).catch((e=>{t.error(e)}))},t.onCancel=e=>{s.cancel(e),t.ready.catch((e=>{if(!this.destroyed)throw e}))}):t.close()})),e.on("GetDoc",(e=>{let{pdfInfo:s}=e;this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new km(s,this))})),e.on("DocException",(e=>{t._capability.reject(tf(e))})),e.on("PasswordRequest",(e=>{this.#Ri=Promise.withResolvers();try{if(!t.onPassword)throw tf(e);const s=e=>{e instanceof Error?this.#Ri.reject(e):this.#Ri.resolve({password:e})};t.onPassword(s,e.code)}catch(s){this.#Ri.reject(s)}return this.#Ri.promise})),e.on("DataLoaded",(e=>{t.onProgress?.({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)})),e.on("StartRenderPage",(e=>{if(this.destroyed)return;this.#Ti.get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)})),e.on("commonobj",(t=>{let[s,i,n]=t;if(this.destroyed)return null;if(this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:t,fontExtraProperties:r,pdfBug:a}=this._params;if("error"in n){const e=n.error;Ru(`Error during font loading: ${e}`),this.commonObjs.resolve(s,e);break}const o=a&&globalThis.FontInspector?.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,l=new Up(n,{disableFontFace:t,fontExtraProperties:r,inspectFont:o});this.fontLoader.bind(l).catch((()=>e.sendWithPromise("FontFallback",{id:s}))).finally((()=>{!r&&l.data&&(l.data=null),this.commonObjs.resolve(s,l)}));break;case"CopyLocalImage":const{imageRef:c}=n;Iu(c,"The imageRef must be defined.");for(const e of this.#Ti.values())for(const[,t]of e.objs)if(t?.ref===c)return t.dataLen?(this.commonObjs.resolve(s,structuredClone(t)),t.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,n);break;default:throw new Error(`Got unknown common object type ${i}`)}return null})),e.on("obj",(e=>{let[t,s,i,n]=e;if(this.destroyed)return;const r=this.#Ti.get(s);if(!r.objs.has(t))if(0!==r._intentStates.size)switch(i){case"Image":r.objs.resolve(t,n),n?.dataLen>1e7&&(r._maybeCleanupAfterRender=!0);break;case"Pattern":r.objs.resolve(t,n);break;default:throw new Error(`Got unknown object type ${i}`)}else n?.bitmap?.close()})),e.on("DocProgress",(e=>{this.destroyed||t.onProgress?.({loaded:e.loaded,total:e.total})})),e.on("FetchBuiltInCMap",(async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(e)})),e.on("FetchStandardFontData",(async e=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(e)}))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ru("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally((()=>{this.annotationStorage.resetModified()}))}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#Mi.get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then((s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&this.#Pi.set(s.refStr,e);const i=new Am(t,s,this,this._params.pdfBug);return this.#Ti.set(t,i),i}));return this.#Mi.set(t,i),i}getPageIndex(e){return wm(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#Di("GetFieldObjects")}hasJSActions(){return this.#Di("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!==typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#Di("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#Di("GetOptionalContentConfig").then((t=>new Uf(t,e)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#ji.get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then((e=>({info:e[0],metadata:e[1]?new Bf(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})));return this.#ji.set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#Ti.values()){if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`)}this.commonObjs.clear(),e||this.fontLoader.clear(),this.#ji.clear(),this.filterFactory.destroy(!0),pm.cleanup()}}cachedPageNumber(e){if(!wm(e))return null;const t=0===e.gen?`${e.num}R`:`${e.num}R${e.gen}`;return this.#Pi.get(t)??null}}const jm=Symbol("INITIAL_DATA");class Tm{#Ii=(()=>Object.create(null))();#Li(e){return this.#Ii[e]||={...Promise.withResolvers(),data:jm}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t){const s=this.#Li(e);return s.promise.then((()=>t(s.data))),null}const s=this.#Ii[e];if(!s||s.data===jm)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=this.#Ii[e];return!!t&&t.data!==jm}delete(e){const t=this.#Ii[e];return!(!t||t.data===jm)&&(delete this.#Ii[e],!0)}resolve(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.#Li(e);s.data=t,s.resolve()}clear(){for(const e in this.#Ii){const{data:t}=this.#Ii[e];t?.bitmap?.close()}this.#Ii=Object.create(null)}*[Symbol.iterator](){for(const e in this.#Ii){const{data:t}=this.#Ii[e];t!==jm&&(yield[e,t])}}}class Mm{#Oi=null;constructor(e){this.#Oi=e,this.onContinue=null}get promise(){return this.#Oi.capability.promise}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.#Oi.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#Oi.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#Oi;return e.form||e.canvas&&t?.size>0}}class Pm{#Fi=null;static#zi=(()=>new WeakSet)();constructor(e){let{callback:t,params:s,objs:i,commonObjs:n,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:d=!1,pdfBug:h=!1,pageColors:u=null}=e;this.callback=t,this.params=s,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=h,this.pageColors=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===d&&"undefined"!==typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Mm(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=s.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics(e){let{transparency:t=!1,optionalContentConfig:s}=e;if(this.cancelled)return;if(this._canvas){if(Pm.#zi.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Pm.#zi.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:n,transform:r,background:a}=this.params;this.gfx=new Ff(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:s},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#Fi&&(window.cancelAnimationFrame(this.#Fi),this.#Fi=null),Pm.#zi.delete(this._canvas),this.callback(e||new ap(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#Fi=window.requestAnimationFrame((()=>{this.#Fi=null,this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Pm.#zi.delete(this._canvas),this.callback())))}}const Rm="4.10.38",Dm="f9bea397f";function Im(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function Lm(e){return Math.max(0,Math.min(255,255*e))}class Om{static CMYK_G(e){let[t,s,i,n]=e;return["G",1-Math.min(1,.3*t+.59*i+.11*s+n)]}static G_CMYK(e){let[t]=e;return["CMYK",0,0,0,1-t]}static G_RGB(e){let[t]=e;return["RGB",t,t,t]}static G_rgb(e){let[t]=e;return t=Lm(t),[t,t,t]}static G_HTML(e){let[t]=e;const s=Im(t);return`#${s}${s}${s}`}static RGB_G(e){let[t,s,i]=e;return["G",.3*t+.59*s+.11*i]}static RGB_rgb(e){return e.map(Lm)}static RGB_HTML(e){return`#${e.map(Im).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB(e){let[t,s,i,n]=e;return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,s+n)]}static CMYK_rgb(e){let[t,s,i,n]=e;return[Lm(1-Math.min(1,t+n)),Lm(1-Math.min(1,i+n)),Lm(1-Math.min(1,s+n))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK(e){let[t,s,i]=e;const n=1-t,r=1-s,a=1-i;return["CMYK",n,r,a,Math.min(n,r,a)]}}class Fm{create(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if("string"!==typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Du("Abstract method `_createSVG` called.")}}class zm extends Fm{_createSVG(e){return document.createElementNS(sp,e)}}class Bm{static setupStorage(e,t,s,i,n){const r=i.getValue(t,{value:null});switch(s.name){case"textarea":if(null!==r.value&&(e.textContent=r.value),"print"===n)break;e.addEventListener("input",(e=>{i.setValue(t,{value:e.target.value})}));break;case"input":if("radio"===s.attributes.type||"checkbox"===s.attributes.type){if(r.value===s.attributes.xfaOn?e.setAttribute("checked",!0):r.value===s.attributes.xfaOff&&e.removeAttribute("checked"),"print"===n)break;e.addEventListener("change",(e=>{i.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})}))}else{if(null!==r.value&&e.setAttribute("value",r.value),"print"===n)break;e.addEventListener("input",(e=>{i.setValue(t,{value:e.target.value})}))}break;case"select":if(null!==r.value){e.setAttribute("value",r.value);for(const e of s.children)e.attributes.value===r.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",(e=>{const s=e.target.options,n=-1===s.selectedIndex?"":s[s.selectedIndex].value;i.setValue(t,{value:n})}))}}static setAttributes(e){let{html:t,element:s,storage:i=null,intent:n,linkService:r}=e;const{attributes:a}=s,o=t instanceof HTMLAnchorElement;"radio"===a.type&&(a.name=`${a.name}-${n}`);for(const[l,c]of Object.entries(a))if(null!==c&&void 0!==c)switch(l){case"class":c.length&&t.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",c);break;case"style":Object.assign(t.style,c);break;case"textContent":t.textContent=c;break;default:(!o||"href"!==l&&"newWindow"!==l)&&t.setAttribute(l,c)}o&&r.addLinkAttributes(t,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(t,a.dataId,s,i)}static render(e){const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,n=e.intent||"display",r=document.createElement(i.name);i.attributes&&this.setAttributes({html:r,element:i,intent:n,linkService:s});const a="richText"!==n,o=e.div;if(o.append(r),e.viewport){const t=`matrix(${e.viewport.transform.join(",")})`;o.style.transform=t}a&&o.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===i.children.length){if(i.value){const e=document.createTextNode(i.value);r.append(e),a&&fm.shouldBuildText(i.name)&&l.push(e)}return{textDivs:l}}const c=[[i,-1,r]];for(;c.length>0;){const[e,i,r]=c.at(-1);if(i+1===e.children.length){c.pop();continue}const o=e.children[++c.at(-1)[1]];if(null===o)continue;const{name:d}=o;if("#text"===d){const e=document.createTextNode(o.value);l.push(e),r.append(e);continue}const h=o?.attributes?.xmlns?document.createElementNS(o.attributes.xmlns,d):document.createElement(d);if(r.append(h),o.attributes&&this.setAttributes({html:h,element:o,storage:t,intent:n,linkService:s}),o.children?.length>0)c.push([o,-1,h]);else if(o.value){const e=document.createTextNode(o.value);a&&fm.shouldBuildText(d)&&l.push(e),h.append(e)}}for(const d of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:l}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const $m=1e3,Hm=new WeakSet;function Um(e){return{width:e[2]-e[0],height:e[3]-e[1]}}class Vm{static create(e){switch(e.data.annotationType){case nu:return new qm(e);case iu:return new Gm(e);case xu:switch(e.data.fieldType){case"Tx":return new Km(e);case"Btn":return e.data.radioButton?new Qm(e):e.data.checkBox?new Jm(e):new Zm(e);case"Ch":return new eg(e);case"Sig":return new Xm(e)}return new Ym(e);case bu:return new tg(e);case ru:return new ig(e);case au:return new ng(e);case ou:return new rg(e);case lu:return new ag(e);case du:return new og(e);case gu:return new cg(e);case vu:return new dg(e);case cu:return new lg(e);case hu:return new hg(e);case uu:return new ug(e);case pu:return new pg(e);case fu:return new fg(e);case mu:return new mg(e);case yu:return new gg(e);default:return new Wm(e)}}}class Wm{#Bi=null;#$i=!1;#Hi=null;constructor(e){let{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData(e){let{titleObj:t,contentsObj:s,richText:i}=e;return!!(t?.str||s?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Wm._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;this.#Bi||={rect:this.data.rect.slice(0)};const{rect:t}=e;t&&this.#Ui(t),this.#Hi?.popup.updateEdited(e)}resetEdited(){this.#Bi&&(this.#Ui(this.#Bi.rect),this.#Hi?.popup.resetEdited(),this.#Bi=null)}#Ui(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:o}}}}=this;s?.splice(0,4,...e);const{width:l,height:c}=Um(e);t.left=100*(e[0]-a)/n+"%",t.top=100*(r-e[3]+o)/r+"%",0===i?(t.width=100*l/n+"%",t.height=100*c/r+"%"):this.setRotation(i)}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",t.id),this instanceof Ym||(n.tabIndex=$m);const{style:r}=n;if(r.zIndex=this.parent.zIndex++,t.alternativeText&&(n.title=t.alternativeText),t.noRotate&&n.classList.add("norotate"),!t.rect||this instanceof tg){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,n),n}const{width:a,height:o}=Um(t.rect);if(!e&&t.borderStyle.width>0){r.borderWidth=`${t.borderStyle.width}px`;const e=t.borderStyle.horizontalCornerRadius,s=t.borderStyle.verticalCornerRadius;if(e>0||s>0){const t=`calc(${e}px * var(--scale-factor)) / calc(${s}px * var(--scale-factor))`;r.borderRadius=t}else if(this instanceof Qm){const e=`calc(${a}px * var(--scale-factor)) / calc(${o}px * var(--scale-factor))`;r.borderRadius=e}switch(t.borderStyle.style){case wu:r.borderStyle="solid";break;case _u:r.borderStyle="dashed";break;case Su:Ru("Unimplemented border style: beveled");break;case ku:Ru("Unimplemented border style: inset");break;case Au:r.borderBottomStyle="solid"}const i=t.borderColor||null;i?(this.#$i=!0,r.borderColor=Ju.makeHexColor(0|i[0],0|i[1],0|i[2])):r.borderWidth=0}const l=Ju.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:c,pageHeight:d,pageX:h,pageY:u}=i.rawDims;r.left=100*(l[0]-h)/c+"%",r.top=100*(l[1]-u)/d+"%";const{rotation:p}=t;return t.hasOwnCanvas||0===p?(r.width=100*a/c+"%",r.height=100*o/d+"%"):this.setRotation(p,n),n}setRotation(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:n,height:r}=Um(this.data.rect);let a,o;e%180===0?(a=100*n/s,o=100*r/i):(a=100*r/s,o=100*n/i),t.style.width=`${a}%`,t.style.height=`${o}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,s)=>{const i=s.detail[e],n=i[0],r=i.slice(1);s.target.style[t]=Om[`${n}_HTML`](r),this.annotationStorage.setValue(this.data.id,{[t]:Om[`${n}_rgb`](r)})};return Ou(this,"_commonActions",{display:e=>{const{display:t}=e.detail,s=t%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout((()=>e.target.focus({preventScroll:!1})),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const n=e[i]||s[i];n?.(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,n]of Object.entries(t)){const r=s[i];if(r){r({detail:{[i]:n},target:e}),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,n]=this.data.rect.map((e=>Math.fround(e)));if(8===e.length){const[r,a,o,l]=e.subarray(2,6);if(i===r&&n===a&&t===o&&s===l)return}const{style:r}=this.container;let a;if(this.#$i){const{borderColor:e,borderWidth:t}=r;r.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${e}" stroke-width="${t}">`],this.container.classList.add("hasBorder")}const o=i-t,l=n-s,{svgFactory:c}=this,d=c.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const h=c.createElement("defs");d.append(h);const u=c.createElement("clipPath"),p=`clippath_${this.data.id}`;u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),h.append(u);for(let f=2,m=e.length;f<m;f+=8){const s=e[f],i=e[f+1],r=e[f+2],d=e[f+3],h=c.createElement("rect"),p=(r-t)/o,m=(n-i)/l,g=(s-r)/o,v=(i-d)/l;h.setAttribute("x",p),h.setAttribute("y",m),h.setAttribute("width",g),h.setAttribute("height",v),u.append(h),a?.push(`<rect vector-effect="non-scaling-stroke" x="${p}" y="${m}" width="${g}" height="${v}"/>`)}this.#$i&&(a.push("</g></svg>')"),r.backgroundImage=a.join("")),this.container.append(d),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{data:e}=this,t=this.#Hi=new tg({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]});this.parent.div.append(t.render())}render(){Du("Abstract method `AnnotationElement.render` called")}_getElementsByName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:e,id:n,exportValues:r}of i){if(-1===e)continue;if(n===t)continue;const i="string"===typeof r?r:null,a=document.querySelector(`[data-element-id="${n}"]`);!a||Hm.has(a)?s.push({id:n,exportValue:i,domElement:a}):Ru(`_getElementsByName - element not allowed: ${n}`)}return s}for(const i of document.getElementsByName(e)){const{exportValue:e}=i,n=i.getAttribute("data-element-id");n!==t&&(Hm.has(i)&&s.push({id:n,exportValue:e,domElement:i}))}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",(()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})}))}}class qm extends Wm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(s,e.action),i=!0):e.attachment?(this.#Vi(s,e.attachment,e.attachmentDest),i=!0):e.setOCGState?(this.#Wi(s,e.setOCGState),i=!0):e.dest?(this._bindLink(s,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),i=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(s,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(s),this.container}#qi(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&this.#qi()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#qi()}#Vi(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#qi()}#Wi(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#qi()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const n=s.get(i);n&&(e[n]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),this.#qi()}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),this.#qi(),!this._fieldObjects)return Ru('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(s||(e.onclick=()=>!1));e.onclick=()=>{s?.();const{fields:e,refs:i,include:n}=t,r=[];if(0!==e.length||0!==i.length){const t=new Set(i);for(const s of e){const e=this._fieldObjects[s]||[];for(const{id:s}of e)t.add(s)}for(const e of Object.values(this._fieldObjects))for(const s of e)t.has(s.id)===n&&r.push(s)}else for(const t of Object.values(this._fieldObjects))r.push(...t);const a=this.annotationStorage,o=[];for(const t of r){const{id:e}=t;switch(o.push(e),t.type){case"text":{const s=t.defaultValue||"";a.setValue(e,{value:s});break}case"checkbox":case"radiobutton":{const s=t.defaultValue===t.exportValues;a.setValue(e,{value:s});break}case"combobox":case"listbox":{const s=t.defaultValue||"";a.setValue(e,{value:s});break}default:continue}const s=document.querySelector(`[data-element-id="${e}"]`);s&&(Hm.has(s)?s.dispatchEvent(new Event("resetform")):Ru(`_bindResetFormAction - element not allowed: ${e}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}),!1}}}class Gm extends Wm{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Ym extends Wm{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&("CANVAS"===e.previousSibling?.nodeName&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Ku.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,n){s.includes("mouse")?e.addEventListener(s,(e=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:n(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})})):e.addEventListener(s,(e=>{if("blur"===s){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===s){if(t.focused)return;t.focused=!0}n&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:n(e)}})}))}_setEventListeners(e,t,s,i){for(const[n,r]of s)("Action"===r||this.data.actions?.[r])&&("Focus"!==r&&"Blur"!==r||(t||={focused:!1}),this._setEventListener(e,t,n,r,i),"Focus"!==r||this.data.actions?.Blur?"Blur"!==r||this.data.actions?.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":Ju.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||9,n=e.style;let r;const a=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(Oh*i))||1);r=Math.min(i,a(t/Oh))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);r=Math.min(i,a(e/Oh))}n.fontSize=`calc(${r}px * var(--scale-factor))`,n.color=Ju.makeHexColor(s[0],s[1],s[2]),null!==this.data.textAlignment&&(n.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class Km extends Ym{constructor(e){super(e,{isRenderable:e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,s,i){const n=this.annotationStorage;for(const r of this._getElementsByName(e.name,e.id))r.domElement&&(r.domElement[t]=s),n.setValue(r.id,{[i]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let n=i.value||"";const r=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;r&&n.length>r&&(n=n.slice(0,r));let a=i.formattedValue||this.data.textContent?.join("\n")||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));const o={userValue:n,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=a??n,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",a??n),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),Hm.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=$m,this._setRequired(s,this.data.required),r&&(s.maxLength=r),s.addEventListener("input",(i=>{e.setValue(t,{value:i.target.value}),this.setPropertyOnSiblings(s,"value",i.target.value,"value"),o.formattedValue=null})),s.addEventListener("resetform",(e=>{const t=this.data.defaultFieldValue??"";s.value=o.userValue=t,o.formattedValue=null}));let l=e=>{const{formattedValue:t}=o;null!==t&&void 0!==t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",(e=>{if(o.focused)return;const{target:t}=e;o.userValue&&(t.value=o.userValue),o.lastCommittedValue=t.value,o.commitKey=1,this.data.actions?.Focus||(o.focused=!0)})),s.addEventListener("updatefromsandbox",(s=>{this.showElementAndHideCanvas(s.target);const i={value(s){o.userValue=s.detail.value??"",e.setValue(t,{value:o.userValue.toString()}),s.target.value=o.userValue},formattedValue(s){const{formattedValue:i}=s.detail;o.formattedValue=i,null!==i&&void 0!==i&&s.target!==document.activeElement&&(s.target.value=i),e.setValue(t,{formattedValue:i})},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:s=>{const{charLimit:i}=s.detail,{target:n}=s;if(0===i)return void n.removeAttribute("maxLength");n.setAttribute("maxLength",i);let r=o.userValue;!r||r.length<=i||(r=r.slice(0,i),n.value=o.userValue=r,e.setValue(t,{value:r}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,willCommit:!0,commitKey:1,selStart:n.selectionStart,selEnd:n.selectionEnd}}))}};this._dispatchEventFromSandbox(i,s)})),s.addEventListener("keydown",(e=>{o.commitKey=1;let s=-1;if("Escape"===e.key?s=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(o.commitKey=3):s=2,-1===s)return;const{value:i}=e.target;o.lastCommittedValue!==i&&(o.lastCommittedValue=i,o.userValue=i,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:i,willCommit:!0,commitKey:s,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))}));const i=l;l=null,s.addEventListener("blur",(e=>{if(!o.focused||!e.relatedTarget)return;this.data.actions?.Blur||(o.focused=!1);const{value:s}=e.target;o.userValue=s,o.lastCommittedValue!==s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,willCommit:!0,commitKey:o.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}),i(e)})),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",(e=>{o.lastCommittedValue=null;const{data:s,target:i}=e,{value:n,selectionStart:r,selectionEnd:a}=i;let l=r,c=a;switch(e.inputType){case"deleteWordBackward":{const e=n.substring(0,r).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=n.substring(r).match(/^[^\w]*\w*/);e&&(c+=e[0].length);break}case"deleteContentBackward":r===a&&(l-=1);break;case"deleteContentForward":r===a&&(c+=1)}e.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:n,change:s||"",willCommit:!1,selStart:l,selEnd:c}})})),this._setEventListeners(s,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.value))}if(l&&s.addEventListener("blur",l),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/r;s.classList.add("comb"),s.style.letterSpacing=`calc(${e}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Xm extends Ym{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class Jm extends Ym{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;"string"===typeof i&&(i="Off"!==i,e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const n=document.createElement("input");return Hm.add(n),n.setAttribute("data-element-id",s),n.disabled=t.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=t.fieldName,i&&n.setAttribute("checked",!0),n.setAttribute("exportValue",t.exportValue),n.tabIndex=$m,n.addEventListener("change",(i=>{const{name:n,checked:r}=i.target;for(const a of this._getElementsByName(n,s)){const s=r&&a.exportValue===t.exportValue;a.domElement&&(a.domElement.checked=s),e.setValue(a.id,{value:s})}e.setValue(s,{value:r})})),n.addEventListener("resetform",(e=>{const s=t.defaultFieldValue||"Off";e.target.checked=s===t.exportValue})),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",(t=>{const i={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(s,{value:t.target.checked})}};this._dispatchEventFromSandbox(i,t)})),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.checked))),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Qm extends Ym{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if("string"===typeof i&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const r of this._getElementsByName(t.fieldName,s))e.setValue(r.id,{value:!1});const n=document.createElement("input");if(Hm.add(n),n.setAttribute("data-element-id",s),n.disabled=t.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=t.fieldName,i&&n.setAttribute("checked",!0),n.tabIndex=$m,n.addEventListener("change",(t=>{const{name:i,checked:n}=t.target;for(const r of this._getElementsByName(i,s))e.setValue(r.id,{value:!1});e.setValue(s,{value:n})})),n.addEventListener("resetform",(e=>{const s=t.defaultFieldValue;e.target.checked=null!==s&&void 0!==s&&s===t.buttonValue})),this.enableScripting&&this.hasJSActions){const i=t.buttonValue;n.addEventListener("updatefromsandbox",(t=>{const n={value:t=>{const n=i===t.detail.value;for(const i of this._getElementsByName(t.target.name)){const t=n&&i.id===s;i.domElement&&(i.domElement.checked=t),e.setValue(i.id,{value:t})}}};this._dispatchEventFromSandbox(n,t)})),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.checked))}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class Zm extends qm{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",(e=>{this._dispatchEventFromSandbox({},e)}))),e}}class eg extends Ym{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");Hm.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=$m;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",(e=>{const t=this.data.defaultFieldValue;for(const s of i.options)s.selected=s.value===t}));for(const c of this.data.options){const e=document.createElement("option");e.textContent=c.displayValue,e.value=c.exportValue,s.value.includes(c.exportValue)&&(e.setAttribute("selected",!0),n=!1),i.append(e)}let r=null;if(n){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),i.prepend(e),r=()=>{e.remove(),i.removeEventListener("input",r),r=null},i.addEventListener("input",r)}const a=e=>{const t=e?"value":"textContent",{options:s,multiple:n}=i;return n?Array.prototype.filter.call(s,(e=>e.selected)).map((e=>e[t])):-1===s.selectedIndex?null:s[s.selectedIndex][t]};let o=a(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,(e=>({displayValue:e.textContent,exportValue:e.value})))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",(s=>{const n={value(s){r?.();const n=s.detail.value,l=new Set(Array.isArray(n)?n:[n]);for(const e of i.options)e.selected=l.has(e.value);e.setValue(t,{value:a(!0)}),o=a(!1)},multipleSelection(e){i.multiple=!0},remove(s){const n=i.options,r=s.detail.remove;if(n[r].selected=!1,i.remove(r),n.length>0){-1===Array.prototype.findIndex.call(n,(e=>e.selected))&&(n[0].selected=!0)}e.setValue(t,{value:a(!0),items:l(s)}),o=a(!1)},clear(s){for(;0!==i.length;)i.remove(0);e.setValue(t,{value:null,items:[]}),o=a(!1)},insert(s){const{index:n,displayValue:r,exportValue:c}=s.detail.insert,d=i.children[n],h=document.createElement("option");h.textContent=r,h.value=c,d?d.before(h):i.append(h),e.setValue(t,{value:a(!0),items:l(s)}),o=a(!1)},items(s){const{items:n}=s.detail;for(;0!==i.length;)i.remove(0);for(const e of n){const{displayValue:t,exportValue:s}=e,n=document.createElement("option");n.textContent=t,n.value=s,i.append(n)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:a(!0),items:l(s)}),o=a(!1)},indices(s){const i=new Set(s.detail.indices);for(const e of s.target.options)e.selected=i.has(e.index);e.setValue(t,{value:a(!0)}),o=a(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(n,s)})),i.addEventListener("input",(s=>{const i=a(!0),n=a(!1);e.setValue(t,{value:i}),s.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:o,change:n,changeEx:i,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(e=>e.target.value))):i.addEventListener("input",(function(s){e.setValue(t,{value:a(!0)})})),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class tg extends Wm{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Wm._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new sg({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map((e=>`${tp}${e}`)).join(",")),this.container}}class sg{#Gi=this.#Yi.bind(this);#Ki=this.#Xi.bind(this);#Ji=this.#Qi.bind(this);#Zi=this.#en.bind(this);#tn=null;#pe=null;#sn=null;#in=null;#nn=null;#rn=null;#an=null;#on=!1;#ln=null;#C=null;#cn=null;#dn=null;#hn=null;#Bi=null;#un=!1;constructor(e){let{container:t,color:s,elements:i,titleObj:n,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:c,parentRect:d,open:h}=e;this.#pe=t,this.#hn=n,this.#sn=a,this.#dn=o,this.#rn=l,this.#tn=s,this.#cn=c,this.#an=d,this.#nn=i,this.#in=mp.toDateObject(r),this.trigger=i.flatMap((e=>e.getElementsToTriggerPopup()));for(const u of this.trigger)u.addEventListener("click",this.#Zi),u.addEventListener("mouseenter",this.#Ji),u.addEventListener("mouseleave",this.#Ki),u.classList.add("popupTriggerArea");for(const u of i)u.container?.addEventListener("keydown",this.#Gi);this.#pe.hidden=!0,h&&this.#en()}render(){if(this.#ln)return;const e=this.#ln=document.createElement("div");if(e.className="popup",this.#tn){const t=e.style.outlineColor=Ju.makeHexColor(...this.#tn);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))e.style.backgroundColor=`color-mix(in srgb, ${t} 30%, white)`;else{const t=.7;e.style.backgroundColor=Ju.makeHexColor(...this.#tn.map((e=>Math.floor(t*(255-e)+e))))}}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),({dir:s.dir,str:s.textContent}=this.#hn),e.append(t),this.#in){const e=document.createElement("span");e.classList.add("popupDate"),e.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),e.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#in.valueOf()})),t.append(e)}const i=this.#pn;if(i)Bm.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const t=this._formatContents(this.#sn);e.append(t)}this.#pe.append(e)}get#pn(){const e=this.#dn,t=this.#sn;return!e?.str||t?.str&&t.str!==e.str?null:this.#dn.html||null}get#fn(){return this.#pn?.attributes?.style?.fontSize||0}get#mn(){return this.#pn?.attributes?.style?.color||null}#gn(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#mn,fontSize:this.#fn?`calc(${this.#fn}px * var(--scale-factor))`:""}};for(const n of e.split("\n"))t.push({name:"span",value:n,attributes:i});return s}_formatContents(e){let{str:t,dir:s}=e;const i=document.createElement("p");i.classList.add("popupContent"),i.dir=s;const n=t.split(/(?:\r\n?|\n)/);for(let r=0,a=n.length;r<a;++r){const e=n[r];i.append(document.createTextNode(e)),r<a-1&&i.append(document.createElement("br"))}return i}#Yi(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&this.#on)&&this.#en()}updateEdited(e){let{rect:t,popupContent:s}=e;this.#Bi||={contentsObj:this.#sn,richText:this.#dn},t&&(this.#C=null),s&&(this.#dn=this.#gn(s),this.#sn=null),this.#ln?.remove(),this.#ln=null}resetEdited(){this.#Bi&&(({contentsObj:this.#sn,richText:this.#dn}=this.#Bi),this.#Bi=null,this.#ln?.remove(),this.#ln=null,this.#C=null)}#vn(){if(null!==this.#C)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:n}}}=this.#rn;let r=!!this.#an,a=r?this.#an:this.#cn;for(const u of this.#nn)if(!a||null!==Ju.intersect(u.data.rect,a)){a=u.data.rect,r=!0;break}const o=Ju.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),l=r?a[2]-a[0]+5:0,c=o[0]+l,d=o[1];this.#C=[100*(c-i)/t,100*(d-n)/s];const{style:h}=this.#pe;h.left=`${this.#C[0]}%`,h.top=`${this.#C[1]}%`}#en(){this.#on=!this.#on,this.#on?(this.#Qi(),this.#pe.addEventListener("click",this.#Zi),this.#pe.addEventListener("keydown",this.#Gi)):(this.#Xi(),this.#pe.removeEventListener("click",this.#Zi),this.#pe.removeEventListener("keydown",this.#Gi))}#Qi(){this.#ln||this.render(),this.isVisible?this.#on&&this.#pe.classList.add("focused"):(this.#vn(),this.#pe.hidden=!1,this.#pe.style.zIndex=parseInt(this.#pe.style.zIndex)+1e3)}#Xi(){this.#pe.classList.remove("focused"),!this.#on&&this.isVisible&&(this.#pe.hidden=!0,this.#pe.style.zIndex=parseInt(this.#pe.style.zIndex)-1e3)}forceHide(){this.#un=this.isVisible,this.#un&&(this.#pe.hidden=!0)}maybeShow(){this.#un&&(this.#ln||this.#Qi(),this.#un=!1,this.#pe.hidden=!1)}get isVisible(){return!1===this.#pe.hidden}}class ig extends Wm{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Gh.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class ng extends Wm{#bn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:s}=Um(e.rect),i=this.svgFactory.create(t,s,!0),n=this.#bn=this.svgFactory.createElement("svg:line");return n.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),n.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),n.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),n.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),n.setAttribute("stroke-width",e.borderStyle.width||1),n.setAttribute("stroke","transparent"),n.setAttribute("fill","transparent"),i.append(n),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#bn}addHighlightArea(){this.container.classList.add("highlightArea")}}class rg extends Wm{#yn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:s}=Um(e.rect),i=this.svgFactory.create(t,s,!0),n=e.borderStyle.width,r=this.#yn=this.svgFactory.createElement("svg:rect");return r.setAttribute("x",n/2),r.setAttribute("y",n/2),r.setAttribute("width",t-n),r.setAttribute("height",s-n),r.setAttribute("stroke-width",n||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#yn}addHighlightArea(){this.container.classList.add("highlightArea")}}class ag extends Wm{#xn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:s}=Um(e.rect),i=this.svgFactory.create(t,s,!0),n=e.borderStyle.width,r=this.#xn=this.svgFactory.createElement("svg:ellipse");return r.setAttribute("cx",t/2),r.setAttribute("cy",s/2),r.setAttribute("rx",t/2-n/2),r.setAttribute("ry",s/2-n/2),r.setAttribute("stroke-width",n||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#xn}addHighlightArea(){this.container.classList.add("highlightArea")}}class og extends Wm{#wn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:s,popupRef:i}}=this;if(!t)return this.container;const{width:n,height:r}=Um(e),a=this.svgFactory.create(n,r,!0);let o=[];for(let c=0,d=t.length;c<d;c+=2){const s=t[c]-e[0],i=e[3]-t[c+1];o.push(`${s},${i}`)}o=o.join(" ");const l=this.#wn=this.svgFactory.createElement(this.svgElementName);return l.setAttribute("points",o),l.setAttribute("stroke-width",s.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#wn}addHighlightArea(){this.container.classList.add("highlightArea")}}class lg extends og{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class cg extends Wm{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class dg extends Wm{#_n=null;#Sn=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?Gh.HIGHLIGHT:Gh.INK}#kn(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:s,borderStyle:i,popupRef:n}}=this,{transform:r,width:a,height:o}=this.#kn(t,e),l=this.svgFactory.create(a,o,!0),c=this.#_n=this.svgFactory.createElement("svg:g");l.append(c),c.setAttribute("stroke-width",i.width||1),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-linejoin","round"),c.setAttribute("stroke-miterlimit",10),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),c.setAttribute("transform",r);for(let d=0,h=s.length;d<h;d++){const e=this.svgFactory.createElement(this.svgElementName);this.#Sn.push(e),e.setAttribute("points",s[d].join(",")),c.append(e)}return!n&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:s,rect:i}=e,n=this.#_n;if(t>=0&&n.setAttribute("stroke-width",t||1),s)for(let r=0,a=this.#Sn.length;r<a;r++)this.#Sn[r].setAttribute("points",s[r].join(","));if(i){const{transform:e,width:t,height:s}=this.#kn(this.data.rotation,i);n.parentElement.setAttribute("viewBox",`0 0 ${t} ${s}`),n.setAttribute("transform",e)}}getElementsToTriggerPopup(){return this.#Sn}addHighlightArea(){this.container.classList.add("highlightArea")}}class hg extends Wm{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Gh.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class ug extends Wm{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class pg extends Wm{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class fg extends Wm{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class mg extends Wm{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Gh.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class gg extends Wm{#An=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let s;t.hasAppearance||0===t.fillAlpha?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(100*t.fillAlpha)}%);`)),s.addEventListener("dblclick",this.#Cn.bind(this)),this.#An=s;const{isMac:i}=Ku.platform;return e.addEventListener("keydown",(e=>{"Enter"===e.key&&(i?e.metaKey:e.ctrlKey)&&this.#Cn()})),!t.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return this.#An}addHighlightArea(){this.container.classList.add("highlightArea")}#Cn(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class vg{#En=null;#Nn=null;#jn=(()=>new Map)();#Tn=null;constructor(e){let{div:t,accessibilityManager:s,annotationCanvasMap:i,annotationEditorUIManager:n,page:r,viewport:a,structTreeLayer:o}=e;this.div=t,this.#En=s,this.#Nn=i,this.#Tn=o||null,this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=n}hasEditableAnnotations(){return this.#jn.size>0}async#Mn(e,t){const s=e.firstChild||e,i=s.id=`${tp}${t}`,n=await(this.#Tn?.getAriaAttributes(i));if(n)for(const[r,a]of n)s.setAttribute(r,a);this.div.append(e),this.#En?.moveElementInDOM(this.div,e,s,!1)}async render(e){const{annotations:t}=e,s=this.div;xp(s,this.viewport);const i=new Map,n={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new zm,annotationStorage:e.annotationStorage||new Bp,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const r of t){if(r.noHTML)continue;const e=r.annotationType===bu;if(e){const e=i.get(r.id);if(!e)continue;n.elements=e}else{const{width:e,height:t}=Um(r.rect);if(e<=0||t<=0)continue}n.data=r;const t=Vm.create(n);if(!t.isRenderable)continue;if(!e&&r.popupRef){const e=i.get(r.popupRef);e?e.push(t):i.set(r.popupRef,[t])}const s=t.render();r.hidden&&(s.style.visibility="hidden"),await this.#Mn(s,r.id),t._isEditable&&(this.#jn.set(t.data.id,t),this._annotationEditorUIManager?.renderAnnotationElement(t))}this.#Pn()}update(e){let{viewport:t}=e;const s=this.div;this.viewport=t,xp(s,{rotation:t.rotation}),this.#Pn(),s.hidden=!1}#Pn(){if(!this.#Nn)return;const e=this.div;for(const[t,s]of this.#Nn){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:n}=i;n?"CANVAS"===n.nodeName?n.replaceWith(s):n.classList.contains("annotationContent")?n.after(s):n.before(s):i.append(s)}this.#Nn.clear()}getEditableAnnotations(){return Array.from(this.#jn.values())}getEditableAnnotation(e){return this.#jn.get(e)}}const bg=/\r\n?|\n/g;class yg extends Rp{#tn;#Rn="";#Dn=`${this.id}-editor`;#In=null;#fn;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=yg.prototype,t=e=>e.isEmpty(),s=Tp.TRANSLATE_SMALL,i=Tp.TRANSLATE_BIG;return Ou(this,"_keyboardManager",new Np([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=(()=>Gh.FREETEXT)();constructor(e){super({...e,name:"freeTextEditor"}),this.#tn=e.color||yg._defaultColor||Rp._defaultLineColor,this.#fn=e.fontSize||yg._defaultFontSize}static initialize(e,t){Rp.initialize(e,t);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Yh.FREETEXT_SIZE:yg._defaultFontSize=t;break;case Yh.FREETEXT_COLOR:yg._defaultColor=t}}updateParams(e,t){switch(e){case Yh.FREETEXT_SIZE:this.#Ln(t);break;case Yh.FREETEXT_COLOR:this.#On(t)}}static get defaultPropertiesToUpdate(){return[[Yh.FREETEXT_SIZE,yg._defaultFontSize],[Yh.FREETEXT_COLOR,yg._defaultColor||Rp._defaultLineColor]]}get propertiesToUpdate(){return[[Yh.FREETEXT_SIZE,this.#fn],[Yh.FREETEXT_COLOR,this.#tn]]}#Ln(e){const t=e=>{this.editorDiv.style.fontSize=`calc(${e}px * var(--scale-factor))`,this.translate(0,-(e-this.#fn)*this.parentScale),this.#fn=e,this.#Fn()},s=this.#fn;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Yh.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#On(e){const t=e=>{this.#tn=this.editorDiv.style.color=e},s=this.#tn;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Yh.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-yg._internalPadding*e,-(yg._internalPadding+this.#fn)*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Gh.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#In=new AbortController;const e=this._uiManager.combinedSignal(this.#In);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#Dn),this._isDraggable=!0,this.#In?.abort(),this.#In=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#zn(){const e=[];this.editorDiv.normalize();let t=null;for(const s of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&"BR"===s.nodeName||(e.push(yg.#Bn(s)),t=s);return e.join("\n")}#Fn(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,i=t.style.display,n=t.classList.contains("hidden");t.classList.remove("hidden"),t.style.display="hidden",e.div.append(this.div),s=t.getBoundingClientRect(),t.remove(),t.style.display=i,t.classList.toggle("hidden",n)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#Rn,t=this.#Rn=this.#zn().trimEnd();if(e===t)return;const s=e=>{this.#Rn=e,e?(this.#$n(),this._uiManager.rebuild(this),this.#Fn()):this.remove()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(e)},mustExec:!1}),this.#Fn()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){yg._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#Dn),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#fn}px * var(--scale-factor))`,s.color=this.#tn,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),kp(this,this.div,["dblclick","keydown"]),this.width){const[s,i]=this.parentDimensions;if(this.annotationElementId){const{position:n}=this._initialData;let[r,a]=this.getInitialTranslation();[r,a]=this.pageTranslationToScreen(r,a);const[o,l]=this.pageDimensions,[c,d]=this.pageTranslation;let h,u;switch(this.rotation){case 0:h=e+(n[0]-c)/o,u=t+this.height-(n[1]-d)/l;break;case 90:h=e+(n[0]-c)/o,u=t-(n[1]-d)/l,[r,a]=[a,-r];break;case 180:h=e-this.width+(n[0]-c)/o,u=t-(n[1]-d)/l,[r,a]=[-r,-a];break;case 270:h=e+(n[0]-c-this.height*l)/o,u=t+(n[1]-d-this.width*o)/l,[r,a]=[-a,r]}this.setAt(h*s,u*i,r,a)}else this.setAt(e*s,t*i,this.width*s,this.height*i);this.#$n(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#Bn(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(bg,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:s}=t;if(1===s.length&&"text/plain"===s[0])return;e.preventDefault();const i=yg.#Hn(t.getData("text")||"").replaceAll(bg,"\n");if(!i)return;const n=window.getSelection();if(!n.rangeCount)return;this.editorDiv.normalize(),n.deleteFromDocument();const r=n.getRangeAt(0);if(!i.includes("\n"))return r.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),void n.collapseToStart();const{startContainer:a,startOffset:o}=r,l=[],c=[];if(a.nodeType===Node.TEXT_NODE){const e=a.parentElement;if(c.push(a.nodeValue.slice(o).replaceAll(bg,"")),e!==this.editorDiv){let t=l;for(const s of this.editorDiv.childNodes)s!==e?t.push(yg.#Bn(s)):t=c}l.push(a.nodeValue.slice(0,o).replaceAll(bg,""))}else if(a===this.editorDiv){let e=l,t=0;for(const s of this.editorDiv.childNodes)t++===o&&(e=c),e.push(yg.#Bn(s))}this.#Rn=`${l.join("\n")}${i}${c.join("\n")}`,this.#$n();const d=new Range;let h=l.reduce(((e,t)=>e+t.length),0);for(const{firstChild:u}of this.editorDiv.childNodes)if(u.nodeType===Node.TEXT_NODE){const e=u.nodeValue.length;if(h<=e){d.setStart(u,h),d.setEnd(u,h);break}h-=e}n.removeAllRanges(),n.addRange(d)}#$n(){if(this.editorDiv.replaceChildren(),this.#Rn)for(const e of this.#Rn.split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#Un(){return this.#Rn.replaceAll("\xa0"," ")}static#Hn(e){return e.replaceAll(" ","\xa0")}get contentDiv(){return this.editorDiv}static async deserialize(e,t,s){let i=null;if(e instanceof ig){const{data:{defaultAppearanceData:{fontSize:t,fontColor:s},rect:n,rotation:r,id:a,popupRef:o},textContent:l,textPosition:c,parent:{page:{pageNumber:d}}}=e;if(!l||0===l.length)return null;i=e={annotationType:Gh.FREETEXT,color:Array.from(s),fontSize:t,value:l.join("\n"),position:c,pageIndex:d-1,rect:n.slice(0),rotation:r,id:a,deleted:!1,popupRef:o}}const n=await super.deserialize(e,t,s);return n.#fn=e.fontSize,n.#tn=Ju.makeHexColor(...e.color),n.#Rn=yg.#Hn(e.value),n.annotationElementId=e.id||null,n._initialData=i,n}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=yg._internalPadding*this.parentScale,s=this.getRect(t,t),i=Rp._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#tn),n={annotationType:Gh.FREETEXT,color:i,fontSize:this.#fn,value:this.#Un(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?n:this.annotationElementId&&!this.#Vn(n)?null:(n.id=this.annotationElementId,n)}#Vn(e){const{value:t,fontSize:s,color:i,pageIndex:n}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some(((e,t)=>e!==i[t]))||e.pageIndex!==n}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(this.deleted)return t;const{style:s}=t;s.fontSize=`calc(${this.#fn}px * var(--scale-factor))`,s.color=this.#tn,t.replaceChildren();for(const n of this.#Rn.split("\n")){const e=document.createElement("div");e.append(n?document.createTextNode(n):document.createElement("br")),t.append(e)}const i=yg._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(i,i),popupContent:this.#Rn}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class xg{static PRECISION=1e-4;toSVGPath(){Du("Abstract method `toSVGPath` must be implemented.")}get box(){Du("Abstract getter `box` must be implemented.")}serialize(e,t){Du("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,n,r){r||=new Float32Array(e.length);for(let a=0,o=e.length;a<o;a+=2)r[a]=t+e[a]*i,r[a+1]=s+e[a+1]*n;return r}static _rescaleAndSwap(e,t,s,i,n,r){r||=new Float32Array(e.length);for(let a=0,o=e.length;a<o;a+=2)r[a]=t+e[a+1]*i,r[a+1]=s+e[a]*n;return r}static _translate(e,t,s,i){i||=new Float32Array(e.length);for(let n=0,r=e.length;n<r;n+=2)i[n]=t+e[n],i[n+1]=s+e[n+1];return i}static svgRound(e){return Math.round(1e4*e)}static _normalizePoint(e,t,s,i,n){switch(n){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,n,r){return[(e+5*s)/6,(t+5*i)/6,(5*s+n)/6,(5*i+r)/6,(s+n)/2,(i+r)/2]}}class wg{#Wn;#qn=[];#Gn;#Yn;#Kn=[];#Xn=(()=>new Float32Array(18))();#Jn;#Qn;#Zn;#er;#tr;#sr;#ir=[];static#nr=8;static#rr=2;static#ar=(()=>wg.#nr+wg.#rr)();constructor(e,t,s,i,n){let{x:r,y:a}=e,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;this.#Wn=t,this.#sr=i*s,this.#Yn=n,this.#Xn.set([NaN,NaN,NaN,NaN,r,a],6),this.#Gn=o,this.#er=wg.#nr*s,this.#Zn=wg.#ar*s,this.#tr=s,this.#ir.push(r,a)}isEmpty(){return isNaN(this.#Xn[8])}#or(){const e=this.#Xn.subarray(4,6),t=this.#Xn.subarray(16,18),[s,i,n,r]=this.#Wn;return[(this.#Jn+(e[0]-t[0])/2-s)/n,(this.#Qn+(e[1]-t[1])/2-i)/r,(this.#Jn+(t[0]-e[0])/2-s)/n,(this.#Qn+(t[1]-e[1])/2-i)/r]}add(e){let{x:t,y:s}=e;this.#Jn=t,this.#Qn=s;const[i,n,r,a]=this.#Wn;let[o,l,c,d]=this.#Xn.subarray(8,12);const h=t-c,u=s-d,p=Math.hypot(h,u);if(p<this.#Zn)return!1;const f=p-this.#er,m=f/p,g=m*h,v=m*u;let b=o,y=l;o=c,l=d,c+=g,d+=v,this.#ir?.push(t,s);const x=g/f,w=-v/f*this.#sr,_=x*this.#sr;if(this.#Xn.set(this.#Xn.subarray(2,8),0),this.#Xn.set([c+w,d+_],4),this.#Xn.set(this.#Xn.subarray(14,18),12),this.#Xn.set([c-w,d-_],16),isNaN(this.#Xn[6]))return 0===this.#Kn.length&&(this.#Xn.set([o+w,l+_],2),this.#Kn.push(NaN,NaN,NaN,NaN,(o+w-i)/r,(l+_-n)/a),this.#Xn.set([o-w,l-_],14),this.#qn.push(NaN,NaN,NaN,NaN,(o-w-i)/r,(l-_-n)/a)),this.#Xn.set([b,y,o,l,c,d],6),!this.isEmpty();this.#Xn.set([b,y,o,l,c,d],6);return Math.abs(Math.atan2(y-l,b-o)-Math.atan2(v,g))<Math.PI/2?([o,l,c,d]=this.#Xn.subarray(2,6),this.#Kn.push(NaN,NaN,NaN,NaN,((o+c)/2-i)/r,((l+d)/2-n)/a),[o,l,b,y]=this.#Xn.subarray(14,18),this.#qn.push(NaN,NaN,NaN,NaN,((b+o)/2-i)/r,((y+l)/2-n)/a),!0):([b,y,o,l,c,d]=this.#Xn.subarray(0,6),this.#Kn.push(((b+5*o)/6-i)/r,((y+5*l)/6-n)/a,((5*o+c)/6-i)/r,((5*l+d)/6-n)/a,((o+c)/2-i)/r,((l+d)/2-n)/a),[c,d,o,l,b,y]=this.#Xn.subarray(12,18),this.#qn.push(((b+5*o)/6-i)/r,((y+5*l)/6-n)/a,((5*o+c)/6-i)/r,((5*l+d)/6-n)/a,((o+c)/2-i)/r,((l+d)/2-n)/a),!0)}toSVGPath(){if(this.isEmpty())return"";const e=this.#Kn,t=this.#qn;if(isNaN(this.#Xn[6])&&!this.isEmpty())return this.#lr();const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#cr(s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#dr(s),s.join(" ")}#lr(){const[e,t,s,i]=this.#Wn,[n,r,a,o]=this.#or();return`M${(this.#Xn[2]-e)/s} ${(this.#Xn[3]-t)/i} L${(this.#Xn[4]-e)/s} ${(this.#Xn[5]-t)/i} L${n} ${r} L${a} ${o} L${(this.#Xn[16]-e)/s} ${(this.#Xn[17]-t)/i} L${(this.#Xn[14]-e)/s} ${(this.#Xn[15]-t)/i} Z`}#dr(e){const t=this.#qn;e.push(`L${t[4]} ${t[5]} Z`)}#cr(e){const[t,s,i,n]=this.#Wn,r=this.#Xn.subarray(4,6),a=this.#Xn.subarray(16,18),[o,l,c,d]=this.#or();e.push(`L${(r[0]-t)/i} ${(r[1]-s)/n} L${o} ${l} L${c} ${d} L${(a[0]-t)/i} ${(a[1]-s)/n}`)}newFreeDrawOutline(e,t,s,i,n,r){return new _g(e,t,s,i,n,r)}getOutlines(){const e=this.#Kn,t=this.#qn,s=this.#Xn,[i,n,r,a]=this.#Wn,o=new Float32Array((this.#ir?.length??0)+2);for(let d=0,h=o.length-2;d<h;d+=2)o[d]=(this.#ir[d]-i)/r,o[d+1]=(this.#ir[d+1]-n)/a;if(o[o.length-2]=(this.#Jn-i)/r,o[o.length-1]=(this.#Qn-n)/a,isNaN(s[6])&&!this.isEmpty())return this.#hr(o);const l=new Float32Array(this.#Kn.length+24+this.#qn.length);let c=e.length;for(let d=0;d<c;d+=2)isNaN(e[d])?l[d]=l[d+1]=NaN:(l[d]=e[d],l[d+1]=e[d+1]);c=this.#ur(l,c);for(let d=t.length-6;d>=6;d-=6)for(let e=0;e<6;e+=2)isNaN(t[d+e])?(l[c]=l[c+1]=NaN,c+=2):(l[c]=t[d+e],l[c+1]=t[d+e+1],c+=2);return this.#pr(l,c),this.newFreeDrawOutline(l,o,this.#Wn,this.#tr,this.#Gn,this.#Yn)}#hr(e){const t=this.#Xn,[s,i,n,r]=this.#Wn,[a,o,l,c]=this.#or(),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/n,(t[3]-i)/r,NaN,NaN,NaN,NaN,(t[4]-s)/n,(t[5]-i)/r,NaN,NaN,NaN,NaN,a,o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,(t[16]-s)/n,(t[17]-i)/r,NaN,NaN,NaN,NaN,(t[14]-s)/n,(t[15]-i)/r],0),this.newFreeDrawOutline(d,e,this.#Wn,this.#tr,this.#Gn,this.#Yn)}#pr(e,t){const s=this.#qn;return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+6}#ur(e,t){const s=this.#Xn.subarray(4,6),i=this.#Xn.subarray(16,18),[n,r,a,o]=this.#Wn,[l,c,d,h]=this.#or();return e.set([NaN,NaN,NaN,NaN,(s[0]-n)/a,(s[1]-r)/o,NaN,NaN,NaN,NaN,l,c,NaN,NaN,NaN,NaN,d,h,NaN,NaN,NaN,NaN,(i[0]-n)/a,(i[1]-r)/o],t),t+24}}class _g extends xg{#Wn;#fr=(()=>new Float32Array(4))();#Gn;#Yn;#ir;#tr;#mr;constructor(e,t,s,i,n,r){super(),this.#mr=e,this.#ir=t,this.#Wn=s,this.#tr=i,this.#Gn=n,this.#Yn=r,this.lastPoint=[NaN,NaN],this.#gr(r);const[a,o,l,c]=this.#fr;for(let d=0,h=e.length;d<h;d+=2)e[d]=(e[d]-a)/l,e[d+1]=(e[d+1]-o)/c;for(let d=0,h=t.length;d<h;d+=2)t[d]=(t[d]-a)/l,t[d+1]=(t[d+1]-o)/c}toSVGPath(){const e=[`M${this.#mr[4]} ${this.#mr[5]}`];for(let t=6,s=this.#mr.length;t<s;t+=6)isNaN(this.#mr[t])?e.push(`L${this.#mr[t+4]} ${this.#mr[t+5]}`):e.push(`C${this.#mr[t]} ${this.#mr[t+1]} ${this.#mr[t+2]} ${this.#mr[t+3]} ${this.#mr[t+4]} ${this.#mr[t+5]}`);return e.push("Z"),e.join(" ")}serialize(e,t){let[s,i,n,r]=e;const a=n-s,o=r-i;let l,c;switch(t){case 0:l=xg._rescale(this.#mr,s,r,a,-o),c=xg._rescale(this.#ir,s,r,a,-o);break;case 90:l=xg._rescaleAndSwap(this.#mr,s,i,a,o),c=xg._rescaleAndSwap(this.#ir,s,i,a,o);break;case 180:l=xg._rescale(this.#mr,n,i,-a,o),c=xg._rescale(this.#ir,n,i,-a,o);break;case 270:l=xg._rescaleAndSwap(this.#mr,n,r,-a,-o),c=xg._rescaleAndSwap(this.#ir,n,r,-a,-o)}return{outline:Array.from(l),points:[Array.from(c)]}}#gr(e){const t=this.#mr;let s=t[4],i=t[5],n=s,r=i,a=s,o=i,l=s,c=i;const d=e?Math.max:Math.min;for(let u=6,p=t.length;u<p;u+=6){if(isNaN(t[u]))n=Math.min(n,t[u+4]),r=Math.min(r,t[u+5]),a=Math.max(a,t[u+4]),o=Math.max(o,t[u+5]),c<t[u+5]?(l=t[u+4],c=t[u+5]):c===t[u+5]&&(l=d(l,t[u+4]));else{const e=Ju.bezierBoundingBox(s,i,...t.slice(u,u+6));n=Math.min(n,e[0]),r=Math.min(r,e[1]),a=Math.max(a,e[2]),o=Math.max(o,e[3]),c<e[3]?(l=e[2],c=e[3]):c===e[3]&&(l=d(l,e[2]))}s=t[u+4],i=t[u+5]}const h=this.#fr;h[0]=n-this.#Gn,h[1]=r-this.#Gn,h[2]=a-n+2*this.#Gn,h[3]=o-r+2*this.#Gn,this.lastPoint=[l,c]}get box(){return this.#fr}newOutliner(e,t,s,i,n){return new wg(e,t,s,i,n,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}getNewOutline(e,t){const[s,i,n,r]=this.#fr,[a,o,l,c]=this.#Wn,d=n*l,h=r*c,u=s*l+a,p=i*c+o,f=this.newOutliner({x:this.#ir[0]*d+u,y:this.#ir[1]*h+p},this.#Wn,this.#tr,e,this.#Yn,t??this.#Gn);for(let m=2;m<this.#ir.length;m+=2)f.add({x:this.#ir[m]*d+u,y:this.#ir[m+1]*h+p});return f.getOutlines()}}class Sg{#Wn;#vr;#br=[];#yr=[];constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=1/0,r=-1/0,a=1/0,o=-1/0;const l=10**-4;for(const{x:m,y:g,width:v,height:b}of e){const e=Math.floor((m-t)/l)*l,s=Math.ceil((m+v+t)/l)*l,i=Math.floor((g-t)/l)*l,c=Math.ceil((g+b+t)/l)*l,d=[e,i,c,!0],h=[s,i,c,!1];this.#br.push(d,h),n=Math.min(n,e),r=Math.max(r,s),a=Math.min(a,i),o=Math.max(o,c)}const c=r-n+2*s,d=o-a+2*s,h=n-s,u=a-s,p=this.#br.at(i?-1:-2),f=[p[0],p[2]];for(const m of this.#br){const[e,t,s]=m;m[0]=(e-h)/c,m[1]=(t-u)/d,m[2]=(s-u)/d}this.#Wn=new Float32Array([h,u,c,d]),this.#vr=f}getOutlines(){this.#br.sort(((e,t)=>e[0]-t[0]||e[1]-t[1]||e[2]-t[2]));const e=[];for(const t of this.#br)t[3]?(e.push(...this.#xr(t)),this.#wr(t)):(this.#_r(t),e.push(...this.#xr(t)));return this.#Sr(e)}#Sr(e){const t=[],s=new Set;for(const r of e){const[e,s,i]=r;t.push([e,s,r],[e,i,r])}t.sort(((e,t)=>e[1]-t[1]||e[0]-t[0]));for(let r=0,a=t.length;r<a;r+=2){const e=t[r][2],i=t[r+1][2];e.push(i),i.push(e),s.add(e),s.add(i)}const i=[];let n;for(;s.size>0;){const e=s.values().next().value;let[t,r,a,o,l]=e;s.delete(e);let c=t,d=r;for(n=[t,a],i.push(n);;){let e;if(s.has(o))e=o;else{if(!s.has(l))break;e=l}s.delete(e),[t,r,a,o,l]=e,c!==t&&(n.push(c,d,t,d===r?r:a),c=t),d=d===r?a:r}n.push(c,d)}return new kg(i,this.#Wn,this.#vr)}#kr(e){const t=this.#yr;let s=0,i=t.length-1;for(;s<=i;){const n=s+i>>1,r=t[n][0];if(r===e)return n;r<e?s=n+1:i=n-1}return i+1}#wr(e){let[,t,s]=e;const i=this.#kr(t);this.#yr.splice(i,0,[t,s])}#_r(e){let[,t,s]=e;const i=this.#kr(t);for(let n=i;n<this.#yr.length;n++){const[e,i]=this.#yr[n];if(e!==t)break;if(e===t&&i===s)return void this.#yr.splice(n,1)}for(let n=i-1;n>=0;n--){const[e,i]=this.#yr[n];if(e!==t)break;if(e===t&&i===s)return void this.#yr.splice(n,1)}}#xr(e){const[t,s,i]=e,n=[[t,s,i]],r=this.#kr(i);for(let a=0;a<r;a++){const[e,s]=this.#yr[a];for(let i=0,r=n.length;i<r;i++){const[,a,o]=n[i];if(!(s<=a||o<=e))if(a>=e)if(o>s)n[i][1]=s;else{if(1===r)return[];n.splice(i,1),i--,r--}else n[i][2]=e,o>s&&n.push([t,s,o])}}return n}}class kg extends xg{#Wn;#Ar;constructor(e,t,s){super(),this.#Ar=e,this.#Wn=t,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#Ar){let[s,i]=t;e.push(`M${s} ${i}`);for(let n=2;n<t.length;n+=2){const r=t[n],a=t[n+1];r===s?(e.push(`V${a}`),i=a):a===i&&(e.push(`H${r}`),s=r)}e.push("Z")}return e.join(" ")}serialize(e,t){let[s,i,n,r]=e;const a=[],o=n-s,l=r-i;for(const c of this.#Ar){const e=new Array(c.length);for(let t=0;t<c.length;t+=2)e[t]=s+c[t]*o,e[t+1]=r-c[t+1]*l;a.push(e)}return a}get box(){return this.#Wn}get classNamesForOutlining(){return["highlightOutline"]}}class Ag extends wg{newFreeDrawOutline(e,t,s,i,n,r){return new Cg(e,t,s,i,n,r)}}class Cg extends _g{newOutliner(e,t,s,i,n){return new Ag(e,t,s,i,n,arguments.length>5&&void 0!==arguments[5]?arguments[5]:0)}}class Eg{#Cr=null;#Er=null;#Nr;#jr=null;#Tr=!1;#Mr=!1;#r=null;#Pr;#Rr=null;#m=null;#Dr;static#Ir=null;static get _keyboardManager(){return Ou(this,"_keyboardManager",new Np([[["Escape","mac+Escape"],Eg.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Eg.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Eg.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Eg.prototype._moveToPrevious],[["Home","mac+Home"],Eg.prototype._moveToBeginning],[["End","mac+End"],Eg.prototype._moveToEnd]]))}constructor(e){let{editor:t=null,uiManager:s=null}=e;t?(this.#Mr=!1,this.#Dr=Yh.HIGHLIGHT_COLOR,this.#r=t):(this.#Mr=!0,this.#Dr=Yh.HIGHLIGHT_DEFAULT_COLOR),this.#m=t?._uiManager||s,this.#Pr=this.#m._eventBus,this.#Nr=t?.color||this.#m?.highlightColors.values().next().value||"#FFFF98",Eg.#Ir||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#Cr=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=this.#m._signal;e.addEventListener("click",this.#Lr.bind(this),{signal:t}),e.addEventListener("keydown",this.#Yi.bind(this),{signal:t});const s=this.#Er=document.createElement("span");return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=this.#Nr,e.append(s),e}renderMainDropdown(){const e=this.#jr=this.#Or();return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}#Or(){const e=document.createElement("div"),t=this.#m._signal;e.addEventListener("contextmenu",pp,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of this.#m.highlightColors){const n=document.createElement("button");n.tabIndex="0",n.role="option",n.setAttribute("data-color",i),n.title=s,n.setAttribute("data-l10n-id",Eg.#Ir[s]);const r=document.createElement("span");n.append(r),r.className="swatch",r.style.backgroundColor=i,n.setAttribute("aria-selected",i===this.#Nr),n.addEventListener("click",this.#Fr.bind(this,i),{signal:t}),e.append(n)}return e.addEventListener("keydown",this.#Yi.bind(this),{signal:t}),e}#Fr(e,t){t.stopPropagation(),this.#Pr.dispatch("switchannotationeditorparams",{source:this,type:this.#Dr,value:e})}_colorSelectFromKeyboard(e){if(e.target===this.#Cr)return void this.#Lr(e);const t=e.target.getAttribute("data-color");t&&this.#Fr(t,e)}_moveToNext(e){this.#zr?e.target!==this.#Cr?e.target.nextSibling?.focus():this.#jr.firstChild?.focus():this.#Lr(e)}_moveToPrevious(e){e.target!==this.#jr?.firstChild&&e.target!==this.#Cr?(this.#zr||this.#Lr(e),e.target.previousSibling?.focus()):this.#zr&&this._hideDropdownFromKeyboard()}_moveToBeginning(e){this.#zr?this.#jr.firstChild?.focus():this.#Lr(e)}_moveToEnd(e){this.#zr?this.#jr.lastChild?.focus():this.#Lr(e)}#Yi(e){Eg._keyboardManager.exec(this,e)}#Lr(e){if(this.#zr)return void this.hideDropdown();if(this.#Tr=0===e.detail,this.#Rr||(this.#Rr=new AbortController,window.addEventListener("pointerdown",this.#c.bind(this),{signal:this.#m.combinedSignal(this.#Rr)})),this.#jr)return void this.#jr.classList.remove("hidden");const t=this.#jr=this.#Or();this.#Cr.append(t)}#c(e){this.#jr?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#jr?.classList.add("hidden"),this.#Rr?.abort(),this.#Rr=null}get#zr(){return this.#jr&&!this.#jr.classList.contains("hidden")}_hideDropdownFromKeyboard(){this.#Mr||(this.#zr?(this.hideDropdown(),this.#Cr.focus({preventScroll:!0,focusVisible:this.#Tr})):this.#r?.unselect())}updateColor(e){if(this.#Er&&(this.#Er.style.backgroundColor=e),!this.#jr)return;const t=this.#m.highlightColors.values();for(const s of this.#jr.children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){this.#Cr?.remove(),this.#Cr=null,this.#Er=null,this.#jr?.remove(),this.#jr=null}}class Ng extends Rp{#Br=null;#$r=0;#Hr;#Ur=null;#n=null;#Vr=null;#Wr=null;#qr=0;#Gr=null;#Yr=null;#y=null;#Kr=!1;#vr=null;#Xr;#Jr=null;#Qr="";#sr;#Zr="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=(()=>Gh.HIGHLIGHT)();static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Ng.prototype;return Ou(this,"_keyboardManager",new Np([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Ng._defaultColor,this.#sr=e.thickness||Ng._defaultThickness,this.#Xr=e.opacity||Ng._defaultOpacity,this.#Hr=e.boxes||null,this.#Zr=e.methodOfCreation||"",this.#Qr=e.text||"",this._isDraggable=!1,e.highlightId>-1?(this.#Kr=!0,this.#ea(e),this.#ta()):this.#Hr&&(this.#Br=e.anchorNode,this.#$r=e.anchorOffset,this.#Wr=e.focusNode,this.#qr=e.focusOffset,this.#sa(),this.#ta(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#Kr?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#sr,methodOfCreation:this.#Zr}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#sa(){const e=new Sg(this.#Hr,.001);this.#Yr=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#Yr.box;const t=new Sg(this.#Hr,.0025,.001,"ltr"===this._uiManager.direction);this.#Vr=t.getOutlines();const{lastPoint:s}=this.#Vr;this.#vr=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#ea(e){let{highlightOutlines:t,highlightId:s,clipPathId:i}=e;this.#Yr=t;if(this.#Vr=t.getNewOutline(this.#sr/2+1.5,.0025),s>=0)this.#y=s,this.#Ur=i,this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#Jr=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#Vr.box,path:{d:this.#Vr.toSVGPath()}},!0);else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#y,{bbox:Ng.#ia(this.#Yr.box,(e-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#Jr,{bbox:Ng.#ia(this.#Vr.box,e),path:{d:this.#Vr.toSVGPath()}})}const[n,r,a,o]=t.box;switch(this.rotation){case 0:this.x=n,this.y=r,this.width=a,this.height=o;break;case 90:{const[e,t]=this.parentDimensions;this.x=r,this.y=1-n,this.width=a*t/e,this.height=o*e/t;break}case 180:this.x=1-n,this.y=1-r,this.width=a,this.height=o;break;case 270:{const[e,t]=this.parentDimensions;this.x=1-r,this.y=n,this.width=a*t/e,this.height=o*e/t;break}}const{lastPoint:l}=this.#Vr;this.#vr=[(l[0]-n)/a,(l[1]-r)/o]}static initialize(e,t){Rp.initialize(e,t),Ng._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Yh.HIGHLIGHT_DEFAULT_COLOR:Ng._defaultColor=t;break;case Yh.HIGHLIGHT_THICKNESS:Ng._defaultThickness=t}}translateInPage(e,t){}get toolbarPosition(){return this.#vr}updateParams(e,t){switch(e){case Yh.HIGHLIGHT_COLOR:this.#On(t);break;case Yh.HIGHLIGHT_THICKNESS:this.#na(t)}}static get defaultPropertiesToUpdate(){return[[Yh.HIGHLIGHT_DEFAULT_COLOR,Ng._defaultColor],[Yh.HIGHLIGHT_THICKNESS,Ng._defaultThickness]]}get propertiesToUpdate(){return[[Yh.HIGHLIGHT_COLOR,this.color||Ng._defaultColor],[Yh.HIGHLIGHT_THICKNESS,this.#sr||Ng._defaultThickness],[Yh.HIGHLIGHT_FREE,this.#Kr]]}#On(e){const t=(e,t)=>{this.color=e,this.#Xr=t,this.parent?.drawLayer.updateProperties(this.#y,{root:{fill:e,"fill-opacity":t}}),this.#n?.updateColor(e)},s=this.color,i=this.#Xr;this.addCommands({cmd:t.bind(this,e,Ng._defaultOpacity),undo:t.bind(this,s,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Yh.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)}#na(e){const t=this.#sr,s=e=>{this.#sr=e,this.#ra(e)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Yh.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(this.#n=new Eg({editor:this}),e.addColorPicker(this.#n)),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#aa())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#aa())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#oa(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#ta(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#oa():e&&(this.#ta(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#ra(e){if(!this.#Kr)return;this.#ea({highlightOutlines:this.#Yr.getNewOutline(e/2)}),this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}#oa(){null!==this.#y&&this.parent&&(this.parent.drawLayer.remove(this.#y),this.#y=null,this.parent.drawLayer.remove(this.#Jr),this.#Jr=null)}#ta(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null===this.#y&&(({id:this.#y,clipPathId:this.#Ur}=e.drawLayer.draw({bbox:this.#Yr.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#Xr},rootClass:{highlight:!0,free:this.#Kr},path:{d:this.#Yr.toSVGPath()}},!1,!0)),this.#Jr=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#Kr},bbox:this.#Vr.box,path:{d:this.#Vr.toSVGPath()}},this.#Kr),this.#Gr&&(this.#Gr.style.clipPath=this.#Ur))}static#ia(e,t){let[s,i,n,r]=e;switch(t){case 90:return[1-i-r,s,r,n];case 180:return[1-s-n,1-i-r,n,r];case 270:return[i,1-s-n,r,n]}return[s,i,n,r]}rotate(e){const{drawLayer:t}=this.parent;let s;this.#Kr?(e=(e-this.rotation+360)%360,s=Ng.#ia(this.#Yr.box,e)):s=Ng.#ia([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#y,{bbox:s,root:{"data-main-rotation":e}}),t.updateProperties(this.#Jr,{bbox:Ng.#ia(this.#Vr.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#Qr&&(e.setAttribute("aria-label",this.#Qr),e.setAttribute("role","mark")),this.#Kr?e.classList.add("free"):this.div.addEventListener("keydown",this.#la.bind(this),{signal:this._uiManager._signal});const t=this.#Gr=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#Ur;const[s,i]=this.parentDimensions;return this.setDims(this.width*s,this.height*i),kp(this,this.#Gr,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#Jr,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#Jr,{rootClass:{hovered:!1}})}#la(e){Ng._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#ca(!0);break;case 1:case 3:this.#ca(!1)}}#ca(e){if(!this.#Br)return;const t=window.getSelection();e?t.setPosition(this.#Br,this.#$r):t.setPosition(this.#Wr,this.#qr)}select(){super.select(),this.#Jr&&this.parent?.drawLayer.updateProperties(this.#Jr,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#Jr&&(this.parent?.drawLayer.updateProperties(this.#Jr,{rootClass:{selected:!1}}),this.#Kr||this.#ca(!1))}get _mustFixPosition(){return!this.#Kr}show(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._isVisible;super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#y,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#Jr,{rootClass:{hidden:!e}}))}#aa(){return this.#Kr?this.rotation:0}#da(){if(this.#Kr)return null;const[e,t]=this.pageDimensions,[s,i]=this.pageTranslation,n=this.#Hr,r=new Float32Array(8*n.length);let a=0;for(const{x:o,y:l,width:c,height:d}of n){const n=o*e+s,h=(1-l)*t+i;r[a]=r[a+4]=n,r[a+1]=r[a+3]=h,r[a+2]=r[a+6]=n+c*e,r[a+5]=r[a+7]=h-d*t,a+=8}return r}#ha(e){return this.#Yr.serialize(e,this.#aa())}static startHighlighting(e,t,s){let{target:i,x:n,y:r}=s;const{x:a,y:o,width:l,height:c}=i.getBoundingClientRect(),d=new AbortController,h=e.combinedSignal(d),u=t=>{d.abort(),this.#ua(e,t)};window.addEventListener("blur",u,{signal:h}),window.addEventListener("pointerup",u,{signal:h}),window.addEventListener("pointerdown",fp,{capture:!0,passive:!1,signal:h}),window.addEventListener("contextmenu",pp,{signal:h}),i.addEventListener("pointermove",this.#pa.bind(this,e),{signal:h}),this._freeHighlight=new Ag({x:n,y:r},[a,o,l,c],e.scale,this._defaultThickness/2,t,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static#pa(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#ua(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,s){let i=null;if(e instanceof hg){const{data:{quadPoints:t,rect:s,rotation:n,id:r,color:a,opacity:o,popupRef:l},parent:{page:{pageNumber:c}}}=e;i=e={annotationType:Gh.HIGHLIGHT,color:Array.from(a),opacity:o,quadPoints:t,boxes:null,pageIndex:c-1,rect:s.slice(0),rotation:n,id:r,deleted:!1,popupRef:l}}else if(e instanceof dg){const{data:{inkLists:t,rect:s,rotation:n,id:r,color:a,borderStyle:{rawWidth:o},popupRef:l},parent:{page:{pageNumber:c}}}=e;i=e={annotationType:Gh.HIGHLIGHT,color:Array.from(a),thickness:o,inkLists:t,boxes:null,pageIndex:c-1,rect:s.slice(0),rotation:n,id:r,deleted:!1,popupRef:l}}const{color:n,quadPoints:r,inkLists:a,opacity:o}=e,l=await super.deserialize(e,t,s);l.color=Ju.makeHexColor(...n),l.#Xr=o||1,a&&(l.#sr=e.thickness),l.annotationElementId=e.id||null,l._initialData=i;const[c,d]=l.pageDimensions,[h,u]=l.pageTranslation;if(r){const e=l.#Hr=[];for(let t=0;t<r.length;t+=8)e.push({x:(r[t]-h)/c,y:1-(r[t+1]-u)/d,width:(r[t+2]-r[t])/c,height:(r[t+1]-r[t+5])/d});l.#sa(),l.#ta(),l.rotate(l.rotation)}else if(a){l.#Kr=!0;const e=a[0],s={x:e[0]-h,y:d-(e[1]-u)},i=new Ag(s,[0,0,c,d],1,l.#sr/2,!0,.001);for(let t=0,a=e.length;t<a;t+=2)s.x=e[t]-h,s.y=d-(e[t+1]-u),i.add(s);const{id:n,clipPathId:r}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:l.color,"fill-opacity":l._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:i.toSVGPath()}},!0,!0);l.#ea({highlightOutlines:i.getOutlines(),highlightId:n,clipPathId:r}),l.#ta()}return l}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=this.getRect(0,0),s=Rp._colorManager.convert(this.color),i={annotationType:Gh.HIGHLIGHT,color:s,opacity:this.#Xr,thickness:this.#sr,quadPoints:this.#da(),outlines:this.#ha(t),pageIndex:this.pageIndex,rect:t,rotation:this.#aa(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#Vn(i)?null:(i.id=this.annotationElementId,i)}#Vn(e){const{color:t}=this._initialData;return e.color.some(((e,s)=>e!==t[s]))}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class jg{#fa=(()=>Object.create(null))();updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){this.#fa[e]=t}toSVGProperties(){const e=this.#fa;return this.#fa=Object.create(null),{root:e}}reset(){this.#fa=Object.create(null)}updateAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;this.updateProperties(e)}clone(){Du("Not implemented")}}class Tg extends Rp{#ma=null;#ga;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#va=null;static#ba=null;static#ya=null;static#xa=NaN;static#wa=null;static#_a=null;static#Sa=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#ga=e.mustBeCommitted||!1,e.drawOutlines&&(this.#ka(e),this.#ta())}#ka(e){let{drawOutlines:t,drawId:s,drawingOptions:i}=e;this.#ma=t,this._drawingOptions||=i,s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=this.#Aa(t,this.parent),this.#Ca(t.box)}#Aa(e,t){const{id:s}=t.drawLayer.draw(Tg._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(e,t){const s=new Set(Object.keys(e));for(const[i,n]of Object.entries(t))s.has(i)?Object.assign(e[i],n):e[i]=n;return e}static getDefaultDrawingOptions(e){Du("Not implemented")}static get typesMap(){Du("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,t),this._currentParent&&(Tg.#va.updateProperty(s,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[s,i]of this.typesMap)e.push([s,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[s,i]of this.constructor.typesMap)e.push([s,t[i]]);return e}_updateProperty(e,t,s){const i=this._drawingOptions,n=i[t],r=e=>{i.updateProperty(t,e);const s=this.#ma.updateProperty(t,e);s&&this.#Ca(s),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:r.bind(this,s),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Tg._mergeSVGProperties(this.#ma.getPathResizingSVGProperties(this.#Ea()),{bbox:this.#Na()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Tg._mergeSVGProperties(this.#ma.getPathResizedSVGProperties(this.#Ea()),{bbox:this.#Na()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#Na(e,t)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Tg._mergeSVGProperties(this.#ma.getPathTranslatedSVGProperties(this.#Ea(),this.parentDimensions),{bbox:this.#Na()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#ga&&(this.#ga=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#oa(),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.#ta(),this.#Ca(this.#ma.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#oa()):e&&(this._uiManager.addShouldRescale(this),this.#ta(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#oa(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#ta(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parent;null!==this._drawId&&this.parent===e||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=this.#Aa(this.#ma,e)):this.parent.drawLayer.updateParent(this._drawId,e.drawLayer))}#ja(e){let[t,s,i,n]=e;const{parentDimensions:[r,a],rotation:o}=this;switch(o){case 90:return[s,1-t,i*(a/r),n*(r/a)];case 180:return[1-t,1-s,i,n];case 270:return[1-s,t,i*(a/r),n*(r/a)];default:return[t,s,i,n]}}#Ea(){const{x:e,y:t,width:s,height:i,parentDimensions:[n,r],rotation:a}=this;switch(a){case 90:return[1-t,e,s*(n/r),i*(r/n)];case 180:return[1-e,1-t,s,i];case 270:return[t,1-e,s*(n/r),i*(r/n)];default:return[e,t,s,i]}}#Ca(e){if([this.x,this.y,this.width,this.height]=this.#ja(e),this.div){this.fixAndSetPosition();const[e,t]=this.parentDimensions;this.setDims(this.width*e,this.height*t)}this._onResized()}#Na(){const{x:e,y:t,width:s,height:i,rotation:n,parentRotation:r,parentDimensions:[a,o]}=this;switch((4*n+r)/90){case 1:return[1-t-i,e,i,s];case 2:return[1-e-s,1-t-i,s,i];case 3:return[t,1-e-s,i,s];case 4:return[e,t-s*(a/o),i*(o/a),s*(a/o)];case 5:return[1-t,e,s*(a/o),i*(o/a)];case 6:return[1-e-i*(o/a),1-t,i*(o/a),s*(a/o)];case 7:return[t-s*(a/o),1-e-i*(o/a),s*(a/o),i*(o/a)];case 8:return[e-s,t-i,s,i];case 9:return[1-t,e-s,i,s];case 10:return[1-e,1-t,s,i];case 11:return[t-i,1-e,i,s];case 12:return[e-i*(o/a),t,i*(o/a),s*(a/o)];case 13:return[1-t-s*(a/o),e-i*(o/a),s*(a/o),i*(o/a)];case 14:return[1-e,1-t-s*(a/o),i*(o/a),s*(a/o)];case 15:return[t,1-e,s*(a/o),i*(o/a)];default:return[e,t,s,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Tg._mergeSVGProperties({bbox:this.#Na()},this.#ma.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#Ca(this.#ma.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const t=document.createElement("div");e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal";const[s,i]=this.parentDimensions;return this.setDims(this.width*s,this.height*i),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,t,s,i,n){Du("Not implemented")}static startDrawing(e,t,s,i){const{target:n,offsetX:r,offsetY:a,pointerId:o,pointerType:l}=i;if(Tg.#wa&&Tg.#wa!==l)return;const{viewport:{rotation:c}}=e,{width:d,height:h}=n.getBoundingClientRect(),u=Tg.#ba=new AbortController,p=e.combinedSignal(u);Tg.#xa||=o,Tg.#wa??=l,window.addEventListener("pointerup",(e=>{Tg.#xa===e.pointerId?this._endDraw(e):Tg.#_a?.delete(e.pointerId)}),{signal:p}),window.addEventListener("pointercancel",(e=>{Tg.#xa===e.pointerId?this._currentParent.endDrawingSession():Tg.#_a?.delete(e.pointerId)}),{signal:p}),window.addEventListener("pointerdown",(e=>{Tg.#wa===e.pointerType&&((Tg.#_a||=new Set).add(e.pointerId),Tg.#va.isCancellable()&&(Tg.#va.removeLastElement(),Tg.#va.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))}),{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",pp,{signal:p}),n.addEventListener("pointermove",this._drawMove.bind(this),{signal:p}),n.addEventListener("touchmove",(e=>{e.timeStamp===Tg.#Sa&&fp(e)}),{signal:p}),e.toggleDrawing(),t._editorUndoBar?.hide(),Tg.#va?e.drawLayer.updateProperties(this._currentDrawId,Tg.#va.startNew(r,a,d,h,c)):(t.updateUIForDefaultProperties(this),Tg.#va=this.createDrawerInstance(r,a,d,h,c),Tg.#ya=this.getDefaultDrawingOptions(),this._currentParent=e,({id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(Tg.#ya.toSVGProperties(),Tg.#va.defaultSVGProperties),!0,!1)))}static _drawMove(e){if(Tg.#Sa=-1,!Tg.#va)return;const{offsetX:t,offsetY:s,pointerId:i}=e;Tg.#xa===i&&(Tg.#_a?.size>=1?this._endDraw(e):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,Tg.#va.add(t,s)),Tg.#Sa=e.timeStamp,fp(e)))}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Tg.#va=null,Tg.#ya=null,Tg.#wa=null,Tg.#Sa=NaN),Tg.#ba&&(Tg.#ba.abort(),Tg.#ba=null,Tg.#xa=NaN,Tg.#_a=null)}static _endDraw(e){const t=this._currentParent;if(t)if(t.toggleDrawing(!0),this._cleanup(!1),e&&t.drawLayer.updateProperties(this._currentDrawId,Tg.#va.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const e=Tg.#va,s=this._currentDrawId,i=e.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,e.setLastElement(i))},undo:()=>{t.drawLayer.updateProperties(s,e.removeLastElement())},mustExec:!1,type:Yh.DRAW_STEP})}else this.endDrawing(!1)}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Yh.DRAW_STEP),!Tg.#va.isEmpty()){const{pageDimensions:[s,i],scale:n}=t,r=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Tg.#va.getOutlines(s*n,i*n,n,this._INNER_MARGIN),drawingOptions:Tg.#ya,mustBeCommitted:!e});return this._cleanup(!0),r}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,s,i,n,r){Du("Not implemented")}static async deserialize(e,t,s){const{rawDims:{pageWidth:i,pageHeight:n,pageX:r,pageY:a}}=t.viewport,o=this.deserializeDraw(r,a,i,n,this._INNER_MARGIN,e),l=await super.deserialize(e,t,s);return l.createDrawingOptions(e),l.#ka({drawOutlines:o}),l.#ta(),l.onScaleChanging(),l.rotate(),l}serializeDraw(e){const[t,s]=this.pageTranslation,[i,n]=this.pageDimensions;return this.#ma.serialize([t,s,i,n],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class Mg{#Xn=(()=>new Float64Array(6))();#bn;#Ta;#Ds;#sr;#ir;#Ma="";#Pa=0;#Ar=(()=>new Pg)();#Ra;#Da;constructor(e,t,s,i,n,r){this.#Ra=s,this.#Da=i,this.#Ds=n,this.#sr=r,[e,t]=this.#Ia(e,t);const a=this.#bn=[NaN,NaN,NaN,NaN,e,t];this.#ir=[e,t],this.#Ta=[{line:a,points:this.#ir}],this.#Xn.set(a,0)}updateProperty(e,t){"stroke-width"===e&&(this.#sr=t)}#Ia(e,t){return xg._normalizePoint(e,t,this.#Ra,this.#Da,this.#Ds)}isEmpty(){return!this.#Ta||0===this.#Ta.length}isCancellable(){return this.#ir.length<=10}add(e,t){[e,t]=this.#Ia(e,t);const[s,i,n,r]=this.#Xn.subarray(2,6),a=e-n,o=t-r;return Math.hypot(this.#Ra*a,this.#Da*o)<=2?null:(this.#ir.push(e,t),isNaN(s)?(this.#Xn.set([n,r,e,t],2),this.#bn.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#Xn[0])&&this.#bn.splice(6,6),this.#Xn.set([s,i,n,r,e,t],0),this.#bn.push(...xg.createBezierPoints(s,i,n,r,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(2===this.#ir.length?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,n){this.#Ra=s,this.#Da=i,this.#Ds=n,[e,t]=this.#Ia(e,t);const r=this.#bn=[NaN,NaN,NaN,NaN,e,t];this.#ir=[e,t];const a=this.#Ta.at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),this.#Ta.push({line:r,points:this.#ir}),this.#Xn.set(r,0),this.#Pa=0,this.toSVGPath(),null}getLastElement(){return this.#Ta.at(-1)}setLastElement(e){return this.#Ta?(this.#Ta.push(e),this.#bn=e.line,this.#ir=e.points,this.#Pa=0,{path:{d:this.toSVGPath()}}):this.#Ar.setLastElement(e)}removeLastElement(){if(!this.#Ta)return this.#Ar.removeLastElement();this.#Ta.pop(),this.#Ma="";for(let e=0,t=this.#Ta.length;e<t;e++){const{line:t,points:s}=this.#Ta[e];this.#bn=t,this.#ir=s,this.#Pa=0,this.toSVGPath()}return{path:{d:this.#Ma}}}toSVGPath(){const e=xg.svgRound(this.#bn[4]),t=xg.svgRound(this.#bn[5]);if(2===this.#ir.length)return this.#Ma=`${this.#Ma} M ${e} ${t} Z`,this.#Ma;if(this.#ir.length<=6){const s=this.#Ma.lastIndexOf("M");this.#Ma=`${this.#Ma.slice(0,s)} M ${e} ${t}`,this.#Pa=6}if(4===this.#ir.length){const e=xg.svgRound(this.#bn[10]),t=xg.svgRound(this.#bn[11]);return this.#Ma=`${this.#Ma} L ${e} ${t}`,this.#Pa=12,this.#Ma}const s=[];0===this.#Pa&&(s.push(`M ${e} ${t}`),this.#Pa=6);for(let i=this.#Pa,n=this.#bn.length;i<n;i+=6){const[e,t,n,r,a,o]=this.#bn.slice(i,i+6).map(xg.svgRound);s.push(`C${e} ${t} ${n} ${r} ${a} ${o}`)}return this.#Ma+=s.join(" "),this.#Pa=this.#bn.length,this.#Ma}getOutlines(e,t,s,i){const n=this.#Ta.at(-1);return n.line=new Float32Array(n.line),n.points=new Float32Array(n.points),this.#Ar.build(this.#Ta,e,t,s,this.#Ds,this.#sr,i),this.#Xn=null,this.#bn=null,this.#Ta=null,this.#Ma=null,this.#Ar}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Pg extends xg{#fr;#La=0;#Gn;#Ta;#Ra;#Da;#Oa;#Ds;#sr;build(e,t,s,i,n,r,a){this.#Ra=t,this.#Da=s,this.#Oa=i,this.#Ds=n,this.#sr=r,this.#Gn=a??0,this.#Ta=e,this.#Fa()}setLastElement(e){return this.#Ta.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#Ta.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#Ta)if(e.push(`M${xg.svgRound(t[4])} ${xg.svgRound(t[5])}`),6!==t.length)if(12!==t.length)for(let s=6,i=t.length;s<i;s+=6){const[i,n,r,a,o,l]=t.subarray(s,s+6).map(xg.svgRound);e.push(`C${i} ${n} ${r} ${a} ${o} ${l}`)}else e.push(`L${xg.svgRound(t[10])} ${xg.svgRound(t[11])}`);else e.push("Z");return e.join("")}serialize(e,t){let[s,i,n,r]=e;const a=[],o=[],[l,c,d,h]=this.#za();let u,p,f,m,g,v,b,y,x;switch(this.#Ds){case 0:x=xg._rescale,u=s,p=i+r,f=n,m=-r,g=s+l*n,v=i+(1-c-h)*r,b=s+(l+d)*n,y=i+(1-c)*r;break;case 90:x=xg._rescaleAndSwap,u=s,p=i,f=n,m=r,g=s+c*n,v=i+l*r,b=s+(c+h)*n,y=i+(l+d)*r;break;case 180:x=xg._rescale,u=s+n,p=i,f=-n,m=r,g=s+(1-l-d)*n,v=i+c*r,b=s+(1-l)*n,y=i+(c+h)*r;break;case 270:x=xg._rescaleAndSwap,u=s+n,p=i+r,f=-n,m=-r,g=s+(1-c-h)*n,v=i+(1-l-d)*r,b=s+(1-c)*n,y=i+(1-l)*r}for(const{line:w,points:_}of this.#Ta)a.push(x(w,u,p,f,m,t?new Array(w.length):null)),o.push(x(_,u,p,f,m,t?new Array(_.length):null));return{lines:a,points:o,rect:[g,v,b,y]}}static deserialize(e,t,s,i,n,r){let{paths:{lines:a,points:o},rotation:l,thickness:c}=r;const d=[];let h,u,p,f,m;switch(l){case 0:m=xg._rescale,h=-e/s,u=t/i+1,p=1/s,f=-1/i;break;case 90:m=xg._rescaleAndSwap,h=-t/i,u=-e/s,p=1/i,f=1/s;break;case 180:m=xg._rescale,h=e/s+1,u=-t/i,p=-1/s,f=1/i;break;case 270:m=xg._rescaleAndSwap,h=t/i+1,u=e/s+1,p=-1/i,f=-1/s}if(!a){a=[];for(const e of o){const t=e.length;if(2===t){a.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1]]));continue}if(4===t){a.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1],NaN,NaN,NaN,NaN,e[2],e[3]]));continue}const s=new Float32Array(3*(t-2));a.push(s);let[i,n,r,o]=e.subarray(0,4);s.set([NaN,NaN,NaN,NaN,i,n],0);for(let a=4;a<t;a+=2){const t=e[a],l=e[a+1];s.set(xg.createBezierPoints(i,n,r,o,t,l),3*(a-2)),[i,n,r,o]=[r,o,t,l]}}}for(let v=0,b=a.length;v<b;v++)d.push({line:m(a[v].map((e=>e??NaN)),h,u,p,f),points:m(o[v].map((e=>e??NaN)),h,u,p,f)});const g=new Pg;return g.build(d,s,i,1,l,c,n),g}#Ba(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.#sr;const t=this.#Gn+e/2*this.#Oa;return this.#Ds%180===0?[t/this.#Ra,t/this.#Da]:[t/this.#Da,t/this.#Ra]}#za(){const[e,t,s,i]=this.#fr,[n,r]=this.#Ba(0);return[e+n,t+r,s-2*n,i-2*r]}#Fa(){const e=this.#fr=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#Ta){if(i.length<=12){for(let t=4,s=i.length;t<s;t+=6){const[s,n]=i.subarray(t,t+2);e[0]=Math.min(e[0],s),e[1]=Math.min(e[1],n),e[2]=Math.max(e[2],s),e[3]=Math.max(e[3],n)}continue}let t=i[4],s=i[5];for(let n=6,r=i.length;n<r;n+=6){const[r,a,o,l,c,d]=i.subarray(n,n+6);Ju.bezierBoundingBox(t,s,r,a,o,l,c,d,e),t=c,s=d}}const[t,s]=this.#Ba();e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-s)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+s)),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#fr}updateProperty(e,t){return"stroke-width"===e?this.#na(t):null}#na(e){const[t,s]=this.#Ba();this.#sr=e;const[i,n]=this.#Ba(),[r,a]=[i-t,n-s],o=this.#fr;return o[0]-=r,o[1]-=a,o[2]+=2*r,o[3]+=2*a,o}updateParentDimensions(e,t){let[s,i]=e;const[n,r]=this.#Ba();this.#Ra=s,this.#Da=i,this.#Oa=t;const[a,o]=this.#Ba(),l=a-n,c=o-r,d=this.#fr;return d[0]-=l,d[1]-=c,d[2]+=2*l,d[3]+=2*c,d}updateRotation(e){return this.#La=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#fr.map(xg.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#fr;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${xg.svgRound(e)} ${xg.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#fr;let s=0,i=0,n=0,r=0,a=0,o=0;switch(this.#La){case 90:i=t/e,n=-e/t,a=e;break;case 180:s=-1,r=-1,a=e,o=t;break;case 270:i=-t/e,n=e/t,o=t;break;default:return""}return`matrix(${s} ${i} ${n} ${r} ${xg.svgRound(a)} ${xg.svgRound(o)})`}getPathResizingSVGProperties(e){let[t,s,i,n]=e;const[r,a]=this.#Ba(),[o,l,c,d]=this.#fr;if(Math.abs(c-r)<=xg.PRECISION||Math.abs(d-a)<=xg.PRECISION){const e=t+i/2-(o+c/2),r=s+n/2-(l+d/2);return{path:{"transform-origin":`${xg.svgRound(t)} ${xg.svgRound(s)}`,transform:`${this.rotationTransform} translate(${e} ${r})`}}}const h=(i-2*r)/(c-2*r),u=(n-2*a)/(d-2*a),p=c/i,f=d/n;return{path:{"transform-origin":`${xg.svgRound(o)} ${xg.svgRound(l)}`,transform:`${this.rotationTransform} scale(${p} ${f}) translate(${xg.svgRound(r)} ${xg.svgRound(a)}) scale(${h} ${u}) translate(${xg.svgRound(-r)} ${xg.svgRound(-a)})`}}}getPathResizedSVGProperties(e){let[t,s,i,n]=e;const[r,a]=this.#Ba(),o=this.#fr,[l,c,d,h]=o;if(o[0]=t,o[1]=s,o[2]=i,o[3]=n,Math.abs(d-r)<=xg.PRECISION||Math.abs(h-a)<=xg.PRECISION){const e=t+i/2-(l+d/2),r=s+n/2-(c+h/2);for(const{line:t,points:s}of this.#Ta)xg._translate(t,e,r,t),xg._translate(s,e,r,s);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${xg.svgRound(t)} ${xg.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const u=(i-2*r)/(d-2*r),p=(n-2*a)/(h-2*a),f=-u*(l+r)+t+r,m=-p*(c+a)+s+a;if(1!==u||1!==p||0!==f||0!==m)for(const{line:g,points:v}of this.#Ta)xg._rescale(g,f,m,u,p,g),xg._rescale(v,f,m,u,p,v);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${xg.svgRound(t)} ${xg.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties(e,t){let[s,i]=e;const[n,r]=t,a=this.#fr,o=s-a[0],l=i-a[1];if(this.#Ra===n&&this.#Da===r)for(const{line:c,points:d}of this.#Ta)xg._translate(c,o,l,c),xg._translate(d,o,l,d);else{const e=this.#Ra/n,t=this.#Da/r;this.#Ra=n,this.#Da=r;for(const{line:s,points:i}of this.#Ta)xg._rescale(s,o,l,e,t,s),xg._rescale(i,o,l,e,t,i);a[2]*=e,a[3]*=t}return a[0]=s,a[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${xg.svgRound(s)} ${xg.svgRound(i)}`}}}get defaultSVGProperties(){const e=this.#fr;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${xg.svgRound(e[0])} ${xg.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Rg extends jg{#$a;constructor(e){super(),this.#$a=e,super.updateProperties({fill:"none",stroke:Rp._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){"stroke-width"===e&&(t??=this["stroke-width"],t*=this.#$a.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Rg(this.#$a);return e.updateAll(this),e}}class Dg extends Tg{static _type="ink";static _editorType=(()=>Gh.INK)();static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(e,t){Rp.initialize(e,t),this._defaultDrawingOptions=new Rg(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ou(this,"typesMap",new Map([[Yh.INK_THICKNESS,"stroke-width"],[Yh.INK_COLOR,"stroke"],[Yh.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,s,i,n){return new Mg(e,t,s,i,n,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,s,i,n,r){return Pg.deserialize(e,t,s,i,n,r)}static async deserialize(e,t,s){let i=null;if(e instanceof dg){const{data:{inkLists:t,rect:s,rotation:n,id:r,color:a,opacity:o,borderStyle:{rawWidth:l},popupRef:c},parent:{page:{pageNumber:d}}}=e;i=e={annotationType:Gh.INK,color:Array.from(a),thickness:l,opacity:o,paths:{points:t},boxes:null,pageIndex:d-1,rect:s.slice(0),rotation:n,id:r,deleted:!1,popupRef:c}}const n=await super.deserialize(e,t,s);return n.annotationElementId=e.id||null,n._initialData=i,n}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:s}=this;t.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions(e){let{color:t,thickness:s,opacity:i}=e;this._drawingOptions=Dg.getDefaultDrawingOptions({stroke:Ju.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:s,rect:i}=this.serializeDraw(e),{_drawingOptions:{stroke:n,"stroke-opacity":r,"stroke-width":a}}=this,o={annotationType:Gh.INK,color:Rp._colorManager.convert(n),opacity:r,thickness:a,paths:{lines:t,points:s},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!this.#Vn(o)?null:(o.id=this.annotationElementId,o)}#Vn(e){const{color:t,thickness:s,opacity:i,pageIndex:n}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some(((e,s)=>e!==t[s]))||e.thickness!==s||e.opacity!==i||e.pageIndex!==n}renderAnnotationElement(e){const{points:t,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:t}),null}}class Ig extends Rp{#Ha=null;#Ua=null;#Va=null;#Wa=null;#qa=null;#Ga="";#Ya=null;#Ka=null;#Xa=!1;#Ja=!1;static _type="stamp";static _editorType=(()=>Gh.STAMP)();constructor(e){super({...e,name:"stampEditor"}),this.#Wa=e.bitmapUrl,this.#qa=e.bitmapFile}static initialize(e,t){Rp.initialize(e,t)}static get supportedTypes(){return Ou(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map((e=>`image/${e}`)))}static get supportedTypesStr(){return Ou(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(Gh.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#Qa(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?(this.#Ha=e.bitmap,t||(this.#Ua=e.id,this.#Xa=e.isSvg),e.file&&(this.#Ga=e.file.name),this.#Za()):this.remove()}#eo(){if(this.#Va=null,this._uiManager.enableWaiting(!1),this.#Ya){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Ha)return this._editToolbar.hide(),void this._uiManager.editAltText(this,!0);if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#Ha){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:n,height:r}=e||this.copyCanvas(null,null,!0).imageData,a=await s.guess({name:"altText",request:{data:i,width:n,height:r,channels:i.length/(n*r)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");const o=a.output;return await this.setGuessedAltText(o),t&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}#to(){if(this.#Ua)return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(this.#Ua).then((e=>this.#Qa(e,!0))).finally((()=>this.#eo()));if(this.#Wa){const e=this.#Wa;return this.#Wa=null,this._uiManager.enableWaiting(!0),void(this.#Va=this._uiManager.imageManager.getFromUrl(e).then((e=>this.#Qa(e))).finally((()=>this.#eo())))}if(this.#qa){const e=this.#qa;return this.#qa=null,this._uiManager.enableWaiting(!0),void(this.#Va=this._uiManager.imageManager.getFromFile(e).then((e=>this.#Qa(e))).finally((()=>this.#eo())))}const e=document.createElement("input");e.type="file",e.accept=Ig.supportedTypesStr;const t=this._uiManager._signal;this.#Va=new Promise((s=>{e.addEventListener("change",(async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#Qa(t)}else this.remove();s()}),{signal:t}),e.addEventListener("cancel",(()=>{this.remove(),s()}),{signal:t})})).finally((()=>this.#eo())),e.click()}remove(){this.#Ua&&(this.#Ha=null,this._uiManager.imageManager.deleteId(this.#Ua),this.#Ya?.remove(),this.#Ya=null,this.#Ka&&(clearTimeout(this.#Ka),this.#Ka=null)),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(this.#Ua&&null===this.#Ya&&this.#to(),this.isAttachedToDOM||this.parent.add(this))):this.#Ua&&this.#to()}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#Va||this.#Ha||this.#Wa||this.#qa||this.#Ua)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#Ha?this.#Za():this.#to(),this.width&&!this.annotationElementId){const[s,i]=this.parentDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;null!==this.#Ka&&clearTimeout(this.#Ka);this.#Ka=setTimeout((()=>{this.#Ka=null,this.#so()}),200)}#Za(){const{div:e}=this;let{width:t,height:s}=this.#Ha;const[i,n]=this.pageDimensions,r=.75;if(this.width)t=this.width*i,s=this.height*n;else if(t>r*i||s>r*n){const e=Math.min(r*i/t,r*n/s);t*=e,s*=e}const[a,o]=this.parentDimensions;this.setDims(t*a/i,s*o/n),this._uiManager.enableWaiting(!1);const l=this.#Ya=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),this.width=t/i,this.height=s/n,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(e.hidden=!1),this.#so(),this.#Ja||(this.parent.addUndoableEditor(this),this.#Ja=!0),this._reportTelemetry({action:"inserted_image"}),this.#Ga&&l.setAttribute("aria-label",this.#Ga)}copyCanvas(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e||(e=224);const{width:i,height:n}=this.#Ha,r=new wp;let a=this.#Ha,o=i,l=n,c=null;if(t){if(i>t||n>t){const e=Math.min(t/i,t/n);o=Math.floor(i*e),l=Math.floor(n*e)}c=document.createElement("canvas");const e=c.width=Math.ceil(o*r.sx),s=c.height=Math.ceil(l*r.sy);this.#Xa||(a=this.#io(e,s));const d=c.getContext("2d");d.filter=this._uiManager.hcmFilter;let h="white",u="#cfcfd8";"none"!==this._uiManager.hcmFilter?u="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(h="#8f8f9d",u="#42414d");const p=15,f=p*r.sx,m=p*r.sy,g=new OffscreenCanvas(2*f,2*m),v=g.getContext("2d");v.fillStyle=h,v.fillRect(0,0,2*f,2*m),v.fillStyle=u,v.fillRect(0,0,f,m),v.fillRect(f,m,f,m),d.fillStyle=d.createPattern(g,"repeat"),d.fillRect(0,0,e,s),d.drawImage(a,0,0,a.width,a.height,0,0,e,s)}let d=null;if(s){let t,s;if(r.symmetric&&a.width<e&&a.height<e)t=a.width,s=a.height;else if(a=this.#Ha,i>e||n>e){const r=Math.min(e/i,e/n);t=Math.floor(i*r),s=Math.floor(n*r),this.#Xa||(a=this.#io(t,s))}const o=new OffscreenCanvas(t,s).getContext("2d",{willReadFrequently:!0});o.drawImage(a,0,0,a.width,a.height,0,0,t,s),d={width:t,height:s,data:o.getImageData(0,0,t,s).data}}return{canvas:c,width:o,height:l,imageData:d}}#io(e,t){const{width:s,height:i}=this.#Ha;let n=s,r=i,a=this.#Ha;for(;n>2*e||r>2*t;){const s=n,i=r;n>2*e&&(n=n>=16384?Math.floor(n/2)-1:Math.ceil(n/2)),r>2*t&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const o=new OffscreenCanvas(n,r);o.getContext("2d").drawImage(a,0,0,s,i,0,0,n,r),a=o.transferToImageBitmap()}return a}#so(){const[e,t]=this.parentDimensions,{width:s,height:i}=this,n=new wp,r=Math.ceil(s*e*n.sx),a=Math.ceil(i*t*n.sy),o=this.#Ya;if(!o||o.width===r&&o.height===a)return;o.width=r,o.height=a;const l=this.#Xa?this.#Ha:this.#io(r,a),c=o.getContext("2d");c.filter=this._uiManager.hcmFilter,c.drawImage(l,0,0,l.width,l.height,0,0,r,a)}getImageForAltText(){return this.#Ya}#no(e){if(e){if(this.#Xa){const e=this._uiManager.imageManager.getSvgUrl(this.#Ua);if(e)return e}const e=document.createElement("canvas");({width:e.width,height:e.height}=this.#Ha);return e.getContext("2d").drawImage(this.#Ha,0,0),e.toDataURL()}if(this.#Xa){const[e,t]=this.pageDimensions,s=Math.round(this.width*e*ip.PDF_TO_CSS_UNITS),i=Math.round(this.height*t*ip.PDF_TO_CSS_UNITS),n=new OffscreenCanvas(s,i);return n.getContext("2d").drawImage(this.#Ha,0,0,this.#Ha.width,this.#Ha.height,0,0,s,i),n.transferToImageBitmap()}return structuredClone(this.#Ha)}static async deserialize(e,t,s){let i=null;if(e instanceof mg){const{data:{rect:n,rotation:r,id:a,structParent:o,popupRef:l},container:c,parent:{page:{pageNumber:d}}}=e,h=c.querySelector("canvas"),u=s.imageManager.getFromCanvas(c.id,h);h.remove();const p=(await t._structTree.getAriaAttributes(`${tp}${a}`))?.get("aria-label")||"";i=e={annotationType:Gh.STAMP,bitmapId:u.id,bitmap:u.bitmap,pageIndex:d-1,rect:n.slice(0),rotation:r,id:a,deleted:!1,accessibilityData:{decorative:!1,altText:p},isSvg:!1,structParent:o,popupRef:l}}const n=await super.deserialize(e,t,s),{rect:r,bitmap:a,bitmapUrl:o,bitmapId:l,isSvg:c,accessibilityData:d}=e;l&&s.imageManager.isValidId(l)?(n.#Ua=l,a&&(n.#Ha=a)):n.#Wa=o,n.#Xa=c;const[h,u]=n.pageDimensions;return n.width=(r[2]-r[0])/h,n.height=(r[3]-r[1])/u,n.annotationElementId=e.id||null,d&&(n.altTextData=d),n._initialData=i,n.#Ja=!!i,n}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:Gh.STAMP,bitmapId:this.#Ua,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#Xa,structTreeParentId:this._structTreeParentId};if(e)return s.bitmapUrl=this.#no(!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:i,altText:n}=this.serializeAltText(!1);if(!i&&n&&(s.accessibilityData={type:"Figure",alt:n}),this.annotationElementId){const e=this.#Vn(s);if(e.isSame)return null;e.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,null===t)return s;t.stamps||=new Map;const r=this.#Xa?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(t.stamps.has(this.#Ua)){if(this.#Xa){const e=t.stamps.get(this.#Ua);r>e.area&&(e.area=r,e.serialized.bitmap.close(),e.serialized.bitmap=this.#no(!1))}}else t.stamps.set(this.#Ua,{area:r,serialized:s}),s.bitmap=this.#no(!1);return s}#Vn(e){const{pageIndex:t,accessibilityData:{altText:s}}=this._initialData,i=e.pageIndex===t,n=(e.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&n,isSameAltText:n}}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}}class Lg{#En;#ro=!1;#ao=null;#oo=null;#lo=null;#co=(()=>new Map)();#do=!1;#ho=!1;#uo=!1;#po=null;#fo=null;#mo=null;#go=null;#m;static _initialized=!1;static#$=(()=>new Map([yg,Dg,Ig,Ng].map((e=>[e._editorType,e]))))();constructor(e){let{uiManager:t,pageIndex:s,div:i,structTreeLayer:n,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:d}=e;const h=[...Lg.#$.values()];if(!Lg._initialized){Lg._initialized=!0;for(const e of h)e.initialize(d,t)}t.registerEditorTypes(h),this.#m=t,this.pageIndex=s,this.div=i,this.#En=r,this.#ao=a,this.viewport=c,this.#mo=l,this.drawLayer=o,this._structTree=n,this.#m.addLayer(this)}get isEmpty(){return 0===this.#co.size}get isInvisible(){return this.isEmpty&&this.#m.getMode()===Gh.NONE}updateToolbar(e){this.#m.updateToolbar(e)}updateMode(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.#m.getMode();switch(this.#vo(),e){case Gh.NONE:return this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case Gh.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Gh.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of Lg.#$.values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){return e===this.#mo?.div}setEditingState(e){this.#m.setEditingState(e)}addCommands(e){this.#m.addCommands(e)}cleanUndoStack(e){this.#m.cleanUndoStack(e)}toggleDrawing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("drawing",!e)}togglePointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.#ao?.div.classList.toggle("disabled",!e)}async enable(){this.#uo=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of this.#co.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#m.removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!this.#ao)return void(this.#uo=!1);const t=this.#ao.getEditableAnnotations();for(const s of t){if(s.hide(),this.#m.isDeletedAnnotationElement(s.data.id))continue;if(e.has(s.data.id))continue;const t=await this.deserialize(s);t&&(this.addOrRebuild(t),t.enableEditing())}this.#uo=!1}disable(){this.#ho=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const i of this.#co.values())i.disableEditing(),i.annotationElementId&&(null===i.serialize()?(t.set(i.annotationElementId,i),this.getEditableAnnotation(i.annotationElementId)?.show(),i.remove()):e.set(i.annotationElementId,i));if(this.#ao){const s=this.#ao.getEditableAnnotations();for(const i of s){const{id:s}=i.data;if(this.#m.isDeletedAnnotationElement(s))continue;let n=t.get(s);n?(n.resetAnnotationElement(i),n.show(!1),i.show()):(n=e.get(s),n&&(this.#m.addChangedExistingAnnotation(n),n.renderAnnotationElement(i)&&n.show(!1)),i.show())}}this.#vo(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const i of Lg.#$.values())s.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#ho=!1}getEditableAnnotation(e){return this.#ao?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#m.getActive()!==e&&this.#m.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#mo?.div&&!this.#go){this.#go=new AbortController;const e=this.#m.combinedSignal(this.#go);this.#mo.div.addEventListener("pointerdown",this.#bo.bind(this),{signal:e}),this.#mo.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#mo?.div&&this.#go&&(this.#go.abort(),this.#go=null,this.#mo.div.classList.remove("highlighting"))}#bo(e){this.#m.unselectAll();const{target:t}=e;if(t===this.#mo.div||("img"===t.getAttribute("role")||t.classList.contains("endOfContent"))&&this.#mo.div.contains(t)){const{isMac:t}=Ku.platform;if(0!==e.button||e.ctrlKey&&t)return;this.#m.showAllEditors("highlight",!0,!0),this.#mo.div.classList.add("free"),this.toggleDrawing(),Ng.startHighlighting(this,"ltr"===this.#m.direction,{target:this.#mo.div,x:e.x,y:e.y}),this.#mo.div.addEventListener("pointerup",(()=>{this.#mo.div.classList.remove("free"),this.toggleDrawing(!0)}),{once:!0,signal:this.#m._signal}),e.preventDefault()}}enableClick(){if(this.#oo)return;this.#oo=new AbortController;const e=this.#m.combinedSignal(this.#oo);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#oo?.abort(),this.#oo=null}attach(e){this.#co.set(e.id,e);const{annotationElementId:t}=e;t&&this.#m.isDeletedAnnotationElement(t)&&this.#m.removeDeletedAnnotationElement(e)}detach(e){this.#co.delete(e.id),this.#En?.removePointerInTextLayer(e.contentDiv),!this.#ho&&e.annotationElementId&&this.#m.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#m.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#m.addDeletedAnnotationElement(e.annotationElementId),Rp.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(e.parent!==this||!e.isAttachedToDOM){if(this.changeParent(e),this.#m.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#uo),this.#m.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#lo&&(e._focusEventsAllowed=!1,this.#lo=setTimeout((()=>{this.#lo=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",(()=>{e._focusEventsAllowed=!0}),{once:!0,signal:this.#m._signal}),t.focus())}),0)),e._structTreeParentId=this.#En?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getNextId(){return this.#m.getId()}get#yo(){return Lg.#$.get(this.#m.getMode())}combinedSignal(e){return this.#m.combinedSignal(e)}#xo(e){const t=this.#yo;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#yo?.canCreateNewEmptyEditor()}pasteEditor(e,t){this.#m.updateToolbar(e),this.#m.updateMode(e);const{offsetX:s,offsetY:i}=this.#wo(),n=this.getNextId(),r=this.#xo({parent:this,id:n,x:s,y:i,uiManager:this.#m,isCentered:!0,...t});r&&this.add(r)}async deserialize(e){return await(Lg.#$.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#m))||null}createAndAddNewEditor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getNextId(),n=this.#xo({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:this.#m,isCentered:t,...s});return n&&this.add(n),n}#wo(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),n=Math.max(0,e),r=Math.max(0,t),a=(n+Math.min(window.innerWidth,e+s))/2-e,o=(r+Math.min(window.innerHeight,t+i))/2-t,[l,c]=this.viewport.rotation%180===0?[a,o]:[o,a];return{offsetX:l,offsetY:c}}addNewEditor(){this.createAndAddNewEditor(this.#wo(),!0)}setSelected(e){this.#m.setSelected(e)}toggleSelected(e){this.#m.toggleSelected(e)}unselect(e){this.#m.unselect(e)}pointerup(e){const{isMac:t}=Ku.platform;0!==e.button||e.ctrlKey&&t||e.target===this.div&&this.#do&&(this.#do=!1,this.#yo?.isDrawer&&this.#yo.supportMultipleDrawings||(this.#ro?this.#m.getMode()!==Gh.STAMP?this.createAndAddNewEditor(e,!1):this.#m.unselectAll():this.#ro=!0))}pointerdown(e){if(this.#m.getMode()===Gh.HIGHLIGHT&&this.enableTextSelection(),this.#do)return void(this.#do=!1);const{isMac:t}=Ku.platform;if(0!==e.button||e.ctrlKey&&t)return;if(e.target!==this.div)return;if(this.#do=!0,this.#yo?.isDrawer)return void this.startDrawingSession(e);const s=this.#m.getActive();this.#ro=!s||s.isEmpty()}startDrawingSession(e){if(this.div.focus(),this.#po)return void this.#yo.startDrawing(this,this.#m,!1,e);this.#m.setCurrentDrawingSession(this),this.#po=new AbortController;const t=this.#m.combinedSignal(this.#po);this.div.addEventListener("blur",(e=>{let{relatedTarget:t}=e;t&&!this.div.contains(t)&&(this.#fo=null,this.commitOrRemove())}),{signal:t}),this.#yo.startDrawing(this,this.#m,!1,e)}pause(e){if(e){const{activeElement:e}=document;this.div.contains(e)&&(this.#fo=e)}else this.#fo&&setTimeout((()=>{this.#fo?.focus(),this.#fo=null}),0)}endDrawingSession(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.#po?(this.#m.setCurrentDrawingSession(null),this.#po.abort(),this.#po=null,this.#fo=null,this.#yo.endDrawing(e)):null}findNewParent(e,t,s){const i=this.#m.findParent(t,s);return null!==i&&i!==this&&(i.changeParent(e),!0)}commitOrRemove(){return!!this.#po&&(this.endDrawingSession(),!0)}onScaleChanging(){this.#po&&this.#yo.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#m.getActive()?.parent===this&&(this.#m.commitOrRemove(),this.#m.setActiveEditor(null)),this.#lo&&(clearTimeout(this.#lo),this.#lo=null);for(const e of this.#co.values())this.#En?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#co.clear(),this.#m.removeLayer(this)}#vo(){for(const e of this.#co.values())e.isEmpty()&&e.remove()}render(e){let{viewport:t}=e;this.viewport=t,xp(this.div,t);for(const s of this.#m.getEditors(this.pageIndex))this.add(s),s.rebuild();this.updateMode()}update(e){let{viewport:t}=e;this.#m.commitOrRemove(),this.#vo();const s=this.viewport.rotation,i=t.rotation;if(this.viewport=t,xp(this.div,{rotation:i}),s!==i)for(const n of this.#co.values())n.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#m.viewParameters.realScale}}class Og{#rn=null;#y=0;#_o=(()=>new Map)();#So=(()=>new Map)();constructor(e){let{pageIndex:t}=e;this.pageIndex=t}setParent(e){if(this.#rn){if(this.#rn!==e){if(this.#_o.size>0)for(const t of this.#_o.values())t.remove(),e.append(t);this.#rn=e}}else this.#rn=e}static get _svgFactory(){return Ou(this,"_svgFactory",new zm)}static#ko(e,t){let[s,i,n,r]=t;const{style:a}=e;a.top=100*i+"%",a.left=100*s+"%",a.width=100*n+"%",a.height=100*r+"%"}#Ao(){const e=Og._svgFactory.create(1,1,!0);return this.#rn.append(e),e.setAttribute("aria-hidden",!0),e}#Co(e,t){const s=Og._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const n=Og._svgFactory.createElement("use");return s.append(n),n.setAttribute("href",`#${t}`),n.classList.add("clip"),i}#Eo(e,t){for(const[s,i]of Object.entries(t))null===i?e.removeAttribute(s):e.setAttribute(s,i)}draw(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.#y++,n=this.#Ao(),r=Og._svgFactory.createElement("defs");n.append(r);const a=Og._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#So.set(i,a);const l=s?this.#Co(r,o):null,c=Og._svgFactory.createElement("use");return n.append(c),c.setAttribute("href",`#${o}`),this.updateProperties(n,e),this.#_o.set(i,n),{id:i,clipPathId:`url(#${l})`}}drawOutline(e,t){const s=this.#y++,i=this.#Ao(),n=Og._svgFactory.createElement("defs");i.append(n);const r=Og._svgFactory.createElement("path");n.append(r);const a=`path_p${this.pageIndex}_${s}`;let o;if(r.setAttribute("id",a),r.setAttribute("vector-effect","non-scaling-stroke"),t){const e=Og._svgFactory.createElement("mask");n.append(e),o=`mask_p${this.pageIndex}_${s}`,e.setAttribute("id",o),e.setAttribute("maskUnits","objectBoundingBox");const t=Og._svgFactory.createElement("rect");e.append(t),t.setAttribute("width","1"),t.setAttribute("height","1"),t.setAttribute("fill","white");const i=Og._svgFactory.createElement("use");e.append(i),i.setAttribute("href",`#${a}`),i.setAttribute("stroke","none"),i.setAttribute("fill","black"),i.setAttribute("fill-rule","nonzero"),i.classList.add("mask")}const l=Og._svgFactory.createElement("use");i.append(l),l.setAttribute("href",`#${a}`),o&&l.setAttribute("mask",`url(#${o})`);const c=l.cloneNode();return i.append(c),l.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(i,e),this.#_o.set(s,i),s}finalizeDraw(e,t){this.#So.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:s,bbox:i,rootClass:n,path:r}=t,a="number"===typeof e?this.#_o.get(e):e;if(a){if(s&&this.#Eo(a,s),i&&Og.#ko(a,i),n){const{classList:e}=a;for(const[t,s]of Object.entries(n))e.toggle(t,s)}if(r){const e=a.firstChild.firstChild;this.#Eo(e,r)}}}updateParent(e,t){if(t===this)return;const s=this.#_o.get(e);s&&(t.#rn.append(s),this.#_o.delete(e),t.#_o.set(e,s))}remove(e){this.#So.delete(e),null!==this.#rn&&(this.#_o.get(e).remove(),this.#_o.delete(e))}destroy(){this.#rn=null;for(const e of this.#_o.values())e.remove();this.#_o.clear(),this.#So.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Sg};var Fg=Rh.getDocument,zg=Rh.version;Rh.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${zg}/pdf.worker.min.js`;const Bg=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(null),[r,a]=(0,t.useState)({first_name:"",last_name:"",email:""}),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({disease_id:"",since:"",file:null}),[h,u]=(0,t.useState)(null),[p,f]=(0,t.useState)(null),[m,g]=(0,t.useState)(!1),[v,b]=(0,t.useState)([]),[y,x]=(0,t.useState)([]),[w,_]=(0,t.useState)({});(0,t.useEffect)((()=>{(async()=>{g(!0);const{data:{user:e},error:t}=await $e.auth.getUser();t||(e&&(n(e.id),C(e.id),A(e.id),S(e.id),k(e.id)),g(!1))})()}),[]);const S=async e=>{const{data:t,error:s}=await $e.from("user_diseases").select("*").eq("user_id",e);s||b(t)},k=async e=>{const{data:t,error:s}=await $e.from("user_parameters").select("*").eq("user_id",e);s||x(t)},A=async e=>{const{data:t,error:s}=await $e.from("profiles").select("first_name, last_name, email").eq("id",e).single();s||a(t)},C=async e=>{g(!0);const{data:t,error:i}=await $e.from("healthrecords").select("\n        *,\n        user_diseases(disease_name)\n      ").eq("user_id",e);i||s(t),g(!1)},E=async e=>{try{let t="";if("application/pdf"===e.type){const s=await e.arrayBuffer(),i=await Fg({data:s}).promise;for(let e=1;e<=i.numPages;e++){const s=await i.getPage(e),n=await s.getTextContent();t+=n.items.map((e=>e.str)).join(" ")+"\n"}}else t=await e.text();const s={};return y.forEach((e=>{const i=new RegExp(`${e.parameter_name}\\s*[:=]\\s*([\\d.]+)`,"i"),n=t.match(i);n&&(s[e.parameter_name]=n[1])})),s}catch(t){throw console.error("Error extracting parameters:",t),t}};return(0,Pe.jsxs)(jl,{className:"py-4",children:[m&&(0,Pe.jsx)(is,{}),p&&(0,Pe.jsx)("div",{className:`alert alert-${p.type}`,role:"alert",children:p.message}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,Pe.jsx)("h2",{className:"text-primary",children:"Health Reports"}),(0,Pe.jsx)(Dl,{variant:"primary",onClick:()=>l(!0),children:"+ Upload Report"})]}),(0,Pe.jsx)(Ll,{children:e.map((e=>{var t;return(0,Pe.jsx)(Fl,{md:3,sm:6,className:"mb-3",children:(0,Pe.jsx)(cc,{className:"shadow-sm border-0",children:(0,Pe.jsxs)(cc.Body,{children:[(0,Pe.jsxs)(cc.Title,{children:["Disease: ",null===(t=e.user_diseases)||void 0===t?void 0:t.disease_name]}),(0,Pe.jsxs)(cc.Text,{children:["Since: ",e.since]}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Pe.jsx)(Dl,{variant:"danger",size:"md",className:"m-2",onClick:()=>console.log("Delete",e.id),children:"Delete"}),(0,Pe.jsx)(Dl,{variant:"info",size:"md",className:"m-2",onClick:()=>window.open(e.document_url,"_blank"),children:"View"})]})]})})},e.id)}))}),(0,Pe.jsxs)(eh,{show:o,onHide:()=>l(!1),centered:!0,children:[(0,Pe.jsx)(eh.Header,{closeButton:!0,children:(0,Pe.jsx)(eh.Title,{children:"Upload New Report"})}),(0,Pe.jsx)(eh.Body,{children:(0,Pe.jsxs)(Mh,{onSubmit:async e=>{e.preventDefault(),g(!0);try{const e=c.file.name.split(".").pop(),t=`${i}/${Date.now()}.${e}`,{data:s,error:n}=await $e.storage.from("health-reports").upload(t,c.file);if(n)throw n;const{data:{publicUrl:r}}=$e.storage.from("health-reports").getPublicUrl(t),{data:a,error:o}=await $e.from("healthrecords").insert([{user_id:i,disease_id:c.disease_id,since:c.since,document_url:r,created_at:(new Date).toISOString()}]).select().single();if(o)throw o;if(Object.keys(w).length>0){const e=Object.entries(w).map((e=>{var t;let[s,i]=e;return{report_id:a.id,parameter_id:null===(t=y.find((e=>e.parameter_name===s)))||void 0===t?void 0:t.id,value:i}})),{error:t}=await $e.from("report_parameters").insert(e);if(t)throw t}f({message:"Report uploaded successfully!",type:"success"}),l(!1),C(i)}catch(t){console.error("Error uploading report:",t),f({message:"Error uploading report",type:"danger"})}finally{g(!1)}},children:[(0,Pe.jsxs)(Mh.Group,{className:"mb-3",children:[(0,Pe.jsx)(Mh.Label,{children:"Select Disease"}),(0,Pe.jsxs)(Mh.Select,{value:c.disease_id,onChange:e=>d({...c,disease_id:e.target.value}),required:!0,children:[(0,Pe.jsx)("option",{value:"",children:"Select a disease"}),v.map((e=>(0,Pe.jsx)("option",{value:e.id,children:e.disease_name},e.id)))]})]}),(0,Pe.jsxs)(Mh.Group,{className:"mb-3",children:[(0,Pe.jsx)(Mh.Label,{children:"Since"}),(0,Pe.jsx)(Mh.Control,{type:"date",value:c.since,onChange:e=>d({...c,since:e.target.value}),required:!0})]}),(0,Pe.jsxs)(Mh.Group,{className:"mb-3",children:[(0,Pe.jsx)(Mh.Label,{children:"Upload File"}),(0,Pe.jsx)(Mh.Control,{type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:async e=>{const t=e.target.files[0];if(d({...c,file:t}),t){if(t.type.startsWith("image/")){const e=new FileReader;e.onloadend=()=>u(e.result),e.readAsDataURL(t)}try{const e=await E(t);_(e)}catch(s){console.error("Error extracting parameters:",s),f({message:"Error extracting parameters from file",type:"danger"})}}},required:!0})]}),h&&(0,Pe.jsx)("img",{src:h,alt:"Preview",className:"img-fluid rounded mb-3"}),Object.keys(w).length>0&&(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("h5",{children:"Extracted Parameters:"}),(0,Pe.jsx)("ul",{className:"list-group",children:Object.entries(w).map((e=>{let[t,s]=e;return(0,Pe.jsxs)("li",{className:"list-group-item",children:[t,": ",s]},t)}))})]}),(0,Pe.jsx)(Dl,{type:"submit",variant:"primary",disabled:m,children:m?"Uploading...":"Upload Report"})]})})]})]})},$g=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,condition:"",diagnosis_date:"",doctor:"",treatment:"",notes:""});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:i}=await $e.from("medical_history").select("*").eq("user_id",e.id).order("diagnosis_date",{ascending:!1});if(i)throw i;s(t||[])}catch(e){console.error("Error fetching medical records:",e),a({message:"Error fetching medical records.",type:"danger"})}finally{n(!1)}},u=e=>{const{name:t,value:s}=e.target;d((e=>({...e,[t]:s})))},p=()=>{l(!1),d({id:null,condition:"",diagnosis_date:"",doctor:"",treatment:"",notes:""})};return i&&0===e.length?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[r&&(0,Pe.jsx)("div",{className:`alert alert-${r.type} text-center`,children:r.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(kt,{className:"me-2"})," Medical History"]}),(0,Pe.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Pe.jsx)("h3",{children:o?"Edit Medical Record":"Add New Medical Record"}),(0,Pe.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await $e.from("medical_history").update({condition:c.condition,diagnosis_date:c.diagnosis_date,doctor:c.doctor,treatment:c.treatment,notes:c.notes}).eq("id",c.id);if(e)throw e;a({message:"Medical record updated successfully!",type:"success"})}else{const{error:t}=await $e.from("medical_history").insert([{condition:c.condition,diagnosis_date:c.diagnosis_date,doctor:c.doctor,treatment:c.treatment,notes:c.notes,user_id:e.id}]);if(t)throw t;a({message:"Medical record added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving medical record:",t),a({message:"Error saving medical record.",type:"danger"})}finally{n(!1)}},children:[(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"condition",className:"form-label",children:"Condition/Diagnosis"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"condition",name:"condition",value:c.condition,onChange:u,required:!0})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"diagnosis_date",className:"form-label",children:"Diagnosis Date"}),(0,Pe.jsx)("input",{type:"date",className:"form-control",id:"diagnosis_date",name:"diagnosis_date",value:c.diagnosis_date,onChange:u,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"doctor",className:"form-label",children:"Doctor/Healthcare Provider"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"doctor",name:"doctor",value:c.doctor,onChange:u})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"treatment",className:"form-label",children:"Treatment"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"treatment",name:"treatment",value:c.treatment,onChange:u})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Pe.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u})]}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(mt,{className:"me-2"})," Update Record"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Lt,{className:"me-2"})," Add Record"]})}),o&&(0,Pe.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),(0,Pe.jsx)("h2",{className:"text-center mb-3",children:"Your Medical History"}),0===e.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No medical records found. Add your first record above."}):(0,Pe.jsx)("div",{className:"table-responsive",children:(0,Pe.jsxs)("table",{className:"table table-striped",children:[(0,Pe.jsx)("thead",{children:(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("th",{children:"Condition"}),(0,Pe.jsx)("th",{children:"Diagnosis Date"}),(0,Pe.jsx)("th",{children:"Doctor"}),(0,Pe.jsx)("th",{children:"Treatment"}),(0,Pe.jsx)("th",{children:"Actions"})]})}),(0,Pe.jsx)("tbody",{children:e.map((t=>(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("td",{children:t.condition}),(0,Pe.jsx)("td",{children:new Date(t.diagnosis_date).toLocaleDateString()}),(0,Pe.jsx)("td",{children:t.doctor}),(0,Pe.jsx)("td",{children:t.treatment}),(0,Pe.jsxs)("td",{children:[(0,Pe.jsx)("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:(0,Pe.jsx)(mt,{})}),(0,Pe.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this record?")){n(!0);try{const{error:i}=await $e.from("medical_history").delete().eq("id",t);if(i)throw i;s(e.filter((e=>e.id!==t))),a({message:"Medical record deleted successfully!",type:"success"})}catch(i){console.error("Error deleting medical record:",i),a({message:"Error deleting medical record.",type:"danger"})}finally{n(!1)}}})(t.id),children:(0,Pe.jsx)(Kt,{})})]})]},t.id)))})]})})]})},Hg=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,disease_name:"",diagnosis_date:"",severity:"Mild",medications:"",symptoms:"",notes:""});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:i}=await $e.from("chronic_diseases").select("*").eq("user_id",e.id).order("diagnosis_date",{ascending:!1});if(i)throw i;s(t||[])}catch(e){console.error("Error fetching chronic diseases:",e),a({message:"Error fetching chronic diseases.",type:"danger"})}finally{n(!1)}},u=e=>{const{name:t,value:s}=e.target;d((e=>({...e,[t]:s})))},p=()=>{l(!1),d({id:null,disease_name:"",diagnosis_date:"",severity:"Mild",medications:"",symptoms:"",notes:""})},f=e=>{switch(e){case"Mild":return"bg-success";case"Moderate":return"bg-warning text-dark";case"Severe":return"bg-danger";default:return"bg-secondary"}};return i&&0===e.length?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[r&&(0,Pe.jsx)("div",{className:`alert alert-${r.type} text-center`,children:r.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(pt,{className:"me-2"})," Chronic Disease Management"]}),(0,Pe.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Pe.jsx)("h3",{children:o?"Edit Chronic Disease":"Add New Chronic Disease"}),(0,Pe.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await $e.from("chronic_diseases").update({disease_name:c.disease_name,diagnosis_date:c.diagnosis_date,severity:c.severity,medications:c.medications,symptoms:c.symptoms,notes:c.notes}).eq("id",c.id);if(e)throw e;a({message:"Chronic disease updated successfully!",type:"success"})}else{const{error:t}=await $e.from("chronic_diseases").insert([{disease_name:c.disease_name,diagnosis_date:c.diagnosis_date,severity:c.severity,medications:c.medications,symptoms:c.symptoms,notes:c.notes,user_id:e.id}]);if(t)throw t;a({message:"Chronic disease added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving chronic disease:",t),a({message:"Error saving chronic disease.",type:"danger"})}finally{n(!1)}},children:[(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"disease_name",className:"form-label",children:"Disease Name"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"disease_name",name:"disease_name",value:c.disease_name,onChange:u,required:!0})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"diagnosis_date",className:"form-label",children:"Diagnosis Date"}),(0,Pe.jsx)("input",{type:"date",className:"form-control",id:"diagnosis_date",name:"diagnosis_date",value:c.diagnosis_date,onChange:u,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"severity",className:"form-label",children:"Severity"}),(0,Pe.jsxs)("select",{className:"form-control",id:"severity",name:"severity",value:c.severity,onChange:u,children:[(0,Pe.jsx)("option",{value:"Mild",children:"Mild"}),(0,Pe.jsx)("option",{value:"Moderate",children:"Moderate"}),(0,Pe.jsx)("option",{value:"Severe",children:"Severe"})]})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"medications",className:"form-label",children:"Medications"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"medications",name:"medications",value:c.medications,onChange:u,placeholder:"Separate multiple medications with commas"})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"symptoms",className:"form-label",children:"Symptoms"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"symptoms",name:"symptoms",value:c.symptoms,onChange:u,placeholder:"Separate multiple symptoms with commas"})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Pe.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u})]}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(mt,{className:"me-2"})," Update Disease"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Lt,{className:"me-2"})," Add Disease"]})}),o&&(0,Pe.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),(0,Pe.jsx)("h2",{className:"text-center mb-3",children:"Your Chronic Diseases"}),0===e.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No chronic diseases found. Add your first record above."}):(0,Pe.jsx)("div",{className:"row",children:e.map((t=>(0,Pe.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Pe.jsxs)("div",{className:"card h-100 shadow",children:[(0,Pe.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,Pe.jsx)("h5",{className:"mb-0",children:t.disease_name}),(0,Pe.jsx)("span",{className:`badge ${f(t.severity)}`,children:t.severity})]}),(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("p",{children:[(0,Pe.jsx)("strong",{children:"Diagnosed:"})," ",new Date(t.diagnosis_date).toLocaleDateString()]}),t.medications&&(0,Pe.jsxs)("p",{children:[(0,Pe.jsx)("strong",{children:"Medications:"}),(0,Pe.jsx)("br",{}),t.medications.split(",").map(((e,t)=>(0,Pe.jsx)("span",{className:"badge bg-info text-dark me-1 mb-1",children:e.trim()},t)))]}),t.symptoms&&(0,Pe.jsxs)("p",{children:[(0,Pe.jsx)("strong",{children:"Symptoms:"}),(0,Pe.jsx)("br",{}),t.symptoms.split(",").map(((e,t)=>(0,Pe.jsx)("span",{className:"badge bg-secondary me-1 mb-1",children:e.trim()},t)))]}),t.notes&&(0,Pe.jsxs)("p",{children:[(0,Pe.jsx)("strong",{children:"Notes:"}),(0,Pe.jsx)("br",{}),t.notes]})]}),(0,Pe.jsxs)("div",{className:"card-footer d-flex justify-content-between",children:[(0,Pe.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:[(0,Pe.jsx)(mt,{className:"me-1"})," Edit"]}),(0,Pe.jsxs)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this chronic disease record?")){n(!0);try{const{error:i}=await $e.from("chronic_diseases").delete().eq("id",t);if(i)throw i;s(e.filter((e=>e.id!==t))),a({message:"Chronic disease deleted successfully!",type:"success"})}catch(i){console.error("Error deleting chronic disease:",i),a({message:"Error deleting chronic disease.",type:"danger"})}finally{n(!1)}}})(t.id),children:[(0,Pe.jsx)(Kt,{className:"me-1"})," Delete"]})]})]})},t.id)))})]})},Ug=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,vaccine_name:"",date_administered:"",administered_by:"",lot_number:"",next_dose_date:"",notes:""});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:i}=await $e.from("vaccinations").select("*").eq("user_id",e.id).order("date_administered",{ascending:!1});if(i)throw i;s(t||[])}catch(e){console.error("Error fetching vaccinations:",e),a({message:"Error fetching vaccinations.",type:"danger"})}finally{n(!1)}},u=e=>{const{name:t,value:s}=e.target;d((e=>({...e,[t]:s})))},p=()=>{l(!1),d({id:null,vaccine_name:"",date_administered:"",administered_by:"",lot_number:"",next_dose_date:"",notes:""})},f=e=>{if(!e)return!1;const t=new Date,s=new Date(e)-t,i=Math.ceil(s/864e5);return i>=0&&i<=30},m=e=>{if(!e)return!1;const t=new Date;return new Date(e)<t};return i&&0===e.length?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[r&&(0,Pe.jsx)("div",{className:`alert alert-${r.type} text-center`,children:r.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(Ut,{className:"me-2"})," Vaccination History"]}),(0,Pe.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Pe.jsx)("h3",{children:o?"Edit Vaccination Record":"Add New Vaccination"}),(0,Pe.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await $e.from("vaccinations").update({vaccine_name:c.vaccine_name,date_administered:c.date_administered,administered_by:c.administered_by,lot_number:c.lot_number,next_dose_date:c.next_dose_date,notes:c.notes}).eq("id",c.id);if(e)throw e;a({message:"Vaccination record updated successfully!",type:"success"})}else{const{error:t}=await $e.from("vaccinations").insert([{vaccine_name:c.vaccine_name,date_administered:c.date_administered,administered_by:c.administered_by,lot_number:c.lot_number,next_dose_date:c.next_dose_date,notes:c.notes,user_id:e.id}]);if(t)throw t;a({message:"Vaccination record added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving vaccination record:",t),a({message:"Error saving vaccination record.",type:"danger"})}finally{n(!1)}},children:[(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"vaccine_name",className:"form-label",children:"Vaccine Name"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"vaccine_name",name:"vaccine_name",value:c.vaccine_name,onChange:u,required:!0})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"date_administered",className:"form-label",children:"Date Administered"}),(0,Pe.jsx)("input",{type:"date",className:"form-control",id:"date_administered",name:"date_administered",value:c.date_administered,onChange:u,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"administered_by",className:"form-label",children:"Administered By"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"administered_by",name:"administered_by",value:c.administered_by,onChange:u})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"lot_number",className:"form-label",children:"Lot Number"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"lot_number",name:"lot_number",value:c.lot_number,onChange:u})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"next_dose_date",className:"form-label",children:"Next Dose Date (if applicable)"}),(0,Pe.jsx)("input",{type:"date",className:"form-control",id:"next_dose_date",name:"next_dose_date",value:c.next_dose_date,onChange:u})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Pe.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u})]})]}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(mt,{className:"me-2"})," Update Record"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Lt,{className:"me-2"})," Add Record"]})}),o&&(0,Pe.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),e.some((e=>f(e.next_dose_date)||m(e.next_dose_date)))&&(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-warning text-dark",children:(0,Pe.jsxs)("h3",{className:"mb-0",children:[(0,Pe.jsx)(rt,{className:"me-2"})," Upcoming & Overdue Vaccinations"]})}),(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsx)("div",{className:"table-responsive",children:(0,Pe.jsxs)("table",{className:"table",children:[(0,Pe.jsx)("thead",{children:(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("th",{children:"Vaccine"}),(0,Pe.jsx)("th",{children:"Due Date"}),(0,Pe.jsx)("th",{children:"Status"})]})}),(0,Pe.jsx)("tbody",{children:e.filter((e=>f(e.next_dose_date)||m(e.next_dose_date))).map((e=>(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("td",{children:e.vaccine_name}),(0,Pe.jsx)("td",{children:new Date(e.next_dose_date).toLocaleDateString()}),(0,Pe.jsx)("td",{children:m(e.next_dose_date)?(0,Pe.jsx)("span",{className:"badge bg-danger",children:"Overdue"}):(0,Pe.jsx)("span",{className:"badge bg-warning text-dark",children:"Due Soon"})})]},`upcoming-${e.id}`)))})]})})})]}),(0,Pe.jsx)("h2",{className:"text-center mb-3",children:"Your Vaccination History"}),0===e.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No vaccination records found. Add your first record above."}):(0,Pe.jsx)("div",{className:"table-responsive",children:(0,Pe.jsxs)("table",{className:"table table-striped",children:[(0,Pe.jsx)("thead",{children:(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("th",{children:"Vaccine"}),(0,Pe.jsx)("th",{children:"Date"}),(0,Pe.jsx)("th",{children:"Administered By"}),(0,Pe.jsx)("th",{children:"Lot Number"}),(0,Pe.jsx)("th",{children:"Next Dose"}),(0,Pe.jsx)("th",{children:"Actions"})]})}),(0,Pe.jsx)("tbody",{children:e.map((t=>(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("td",{children:t.vaccine_name}),(0,Pe.jsx)("td",{children:new Date(t.date_administered).toLocaleDateString()}),(0,Pe.jsx)("td",{children:t.administered_by}),(0,Pe.jsx)("td",{children:t.lot_number}),(0,Pe.jsx)("td",{children:t.next_dose_date?(0,Pe.jsxs)(Pe.Fragment,{children:[new Date(t.next_dose_date).toLocaleDateString(),m(t.next_dose_date)&&(0,Pe.jsx)("span",{className:"badge bg-danger ms-2",children:"Overdue"}),f(t.next_dose_date)&&!m(t.next_dose_date)&&(0,Pe.jsx)("span",{className:"badge bg-warning text-dark ms-2",children:"Due Soon"})]}):"N/A"}),(0,Pe.jsxs)("td",{children:[(0,Pe.jsx)("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:(0,Pe.jsx)(mt,{})}),(0,Pe.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this vaccination record?")){n(!0);try{const{error:i}=await $e.from("vaccinations").delete().eq("id",t);if(i)throw i;s(e.filter((e=>e.id!==t))),a({message:"Vaccination record deleted successfully!",type:"success"})}catch(i){console.error("Error deleting vaccination record:",i),a({message:"Error deleting vaccination record.",type:"danger"})}finally{n(!1)}}})(t.id),children:(0,Pe.jsx)(Kt,{})})]})]},t.id)))})]})})]})},Vg=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)({name:"",frequency:"",customFrequency:"",quantity:""}),[r,a]=(0,t.useState)(!0),[o,l]=(0,t.useState)(null);(0,t.useEffect)((()=>{(async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:i}=await $e.from("medications").select("*").eq("user_id",e.id);if(i)throw i;s(t)}catch(e){console.error("Error fetching medications:",e)}finally{a(!1)}})()}),[]),(0,t.useEffect)((()=>{"granted"!==Notification.permission&&Notification.requestPermission().then((e=>{"granted"!==e&&console.warn("Notification permission not granted")}))}),[]);const c=e=>{const{name:t,value:s}=e.target;n((e=>({...e,[t]:s})))};return r?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[o&&(0,Pe.jsx)("div",{className:`alert alert-${o.type} text-center`,children:o.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(It,{className:"me-2"})," Medication Tracker"]}),(0,Pe.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"name",className:"form-label",children:"Medication Name"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"name",name:"name",value:i.name,onChange:c})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"quantity",className:"form-label",children:"Quantity (number of tablets)"}),(0,Pe.jsx)("input",{type:"number",className:"form-control",id:"quantity",name:"quantity",value:i.quantity,onChange:c})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"frequency",className:"form-label",children:"Frequency"}),(0,Pe.jsxs)("select",{className:"form-control",id:"frequency",name:"frequency",value:i.frequency,onChange:c,children:[(0,Pe.jsx)("option",{value:"",children:"Select frequency"}),(0,Pe.jsx)("option",{value:"Once a day",children:"Once a day"}),(0,Pe.jsx)("option",{value:"Twice a day",children:"Twice a day"}),(0,Pe.jsx)("option",{value:"Three times a day",children:"Three times a day"}),(0,Pe.jsx)("option",{value:"Every 6 hours",children:"Every 6 hours"}),(0,Pe.jsx)("option",{value:"Every 8 hours",children:"Every 8 hours"})]})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"customFrequency",className:"form-label",children:"Custom Frequency"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"customFrequency",name:"customFrequency",placeholder:"e.g., Every 4 hours",value:i.customFrequency,onChange:c})]})]}),(0,Pe.jsxs)("button",{className:"btn btn-primary w-100",onClick:async()=>{a(!0);try{const{data:{user:t}}=await $e.auth.getUser();if(!t)return void(window.location.href="/");const r=i.customFrequency||i.frequency,{data:a,error:o}=await $e.from("medications").insert([{name:i.name,frequency:r,quantity:i.quantity,user_id:t.id,last_taken:(new Date).toISOString()}]).select();if(o)throw o;s([...e,...a]),n({name:"",frequency:"",customFrequency:"",quantity:""}),l({message:"Medication added successfully!",type:"success"}),new Notification("Medication added successfully!")}catch(t){console.error("Error adding medication:",t),l({message:"Error adding medication.",type:"danger"}),new Notification("Error adding medication.")}finally{a(!1)}},children:[(0,Pe.jsx)(Lt,{className:"me-2"})," Add Medication"]})]}),(0,Pe.jsx)("h2",{className:"text-center mb-3",children:"Your Medications"}),(0,Pe.jsxs)("table",{className:"table table-striped",children:[(0,Pe.jsx)("thead",{children:(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("th",{children:"Name"}),(0,Pe.jsx)("th",{children:"Frequency"}),(0,Pe.jsx)("th",{children:"Quantity"}),(0,Pe.jsx)("th",{children:"Action"})]})}),(0,Pe.jsx)("tbody",{children:e.map((t=>(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("td",{children:t.name}),(0,Pe.jsx)("td",{children:t.frequency}),(0,Pe.jsx)("td",{children:t.quantity}),(0,Pe.jsx)("td",{children:(0,Pe.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>(async t=>{a(!0);try{const{error:i}=await $e.from("medications").delete().eq("id",t);if(i)throw i;s(e.filter((e=>e.id!==t))),l({message:"Medication deleted successfully!",type:"success"}),new Notification("Medication deleted successfully!")}catch(i){console.error("Error deleting medication:",i),l({message:"Error deleting medication.",type:"danger"}),new Notification("Error deleting medication.")}finally{a(!1)}})(t.id),children:(0,Pe.jsx)(Kt,{})})})]},t.id)))})]})]})},Wg="label";function qg(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Gg(e,t){e.labels=t}function Yg(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wg;const i=[];e.datasets=t.map((t=>{const n=e.datasets.find((e=>e[s]===t[s]));return n&&t.data&&!i.includes(n)?(i.push(n),Object.assign(n,t),n):{...t}}))}function Kg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wg;const s={labels:[],datasets:[]};return Gg(s,e.labels),Yg(s,e.datasets,t),s}function Xg(e,s){const{height:i=150,width:n=300,redraw:r=!1,datasetIdKey:a,type:o,data:l,options:c,plugins:d=[],fallbackContent:h,updateMode:u,...p}=e,f=(0,t.useRef)(null),m=(0,t.useRef)(null),g=()=>{f.current&&(m.current=new vo(f.current,{type:o,data:Kg(l,a),options:c&&{...c},plugins:d}),qg(s,m.current))},v=()=>{qg(s,null),m.current&&(m.current.destroy(),m.current=null)};return(0,t.useEffect)((()=>{!r&&m.current&&c&&function(e,t){const s=e.options;s&&t&&Object.assign(s,t)}(m.current,c)}),[r,c]),(0,t.useEffect)((()=>{!r&&m.current&&Gg(m.current.config.data,l.labels)}),[r,l.labels]),(0,t.useEffect)((()=>{!r&&m.current&&l.datasets&&Yg(m.current.config.data,l.datasets,a)}),[r,l.datasets]),(0,t.useEffect)((()=>{m.current&&(r?(v(),setTimeout(g)):m.current.update(u))}),[r,c,l.labels,l.datasets,u]),(0,t.useEffect)((()=>{m.current&&(v(),setTimeout(g))}),[o]),(0,t.useEffect)((()=>(g(),()=>v())),[]),t.createElement("canvas",{ref:f,role:"img",height:i,width:n,...p},h)}const Jg=(0,t.forwardRef)(Xg);function Qg(e,s){return vo.register(s),(0,t.forwardRef)(((s,i)=>t.createElement(Jg,{...s,ref:i,type:e})))}const Zg=Qg("line",Hr);vo.register(nl,ll,Do,Po,Bo,tl,Fo);const ev=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)("weight"),[c,d]=(0,t.useState)("6months"),[h,u]=(0,t.useState)(null),[p,f]=(0,t.useState)(!1),[m,g]=(0,t.useState)({weight:"",heart_rate:"",blood_pressure_systolic:"",blood_pressure_diastolic:"",blood_sugar:"",oxygen_saturation:"",recorded_at:(new Date).toISOString().split("T")[0]});(0,t.useEffect)((()=>{v()}),[]),(0,t.useEffect)((()=>{e.length>0&&y()}),[e,o,c]);const v=async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:i}=await $e.from("health_metrics").select("*").eq("user_id",e.id).order("recorded_at",{ascending:!0});if(i)throw i;s(t||[])}catch(e){console.error("Error fetching health data:",e),a({message:"Error fetching health data.",type:"danger"})}finally{n(!1)}},b=e=>{const{name:t,value:s}=e.target;g((e=>({...e,[t]:s})))},y=()=>{const t=new Date;let s=[...e];if("1month"===c){const i=new Date(t.setMonth(t.getMonth()-1));s=e.filter((e=>new Date(e.recorded_at)>=i))}else if("3months"===c){const i=new Date(t.setMonth(t.getMonth()-3));s=e.filter((e=>new Date(e.recorded_at)>=i))}else if("6months"===c){const i=new Date(t.setMonth(t.getMonth()-6));s=e.filter((e=>new Date(e.recorded_at)>=i))}else if("1year"===c){const i=new Date(t.setFullYear(t.getFullYear()-1));s=e.filter((e=>new Date(e.recorded_at)>=i))}const i=s.map((e=>new Date(e.recorded_at).toLocaleDateString())),n=s.map((e=>e[o]||0));let r="#4bc0c0",a="rgba(75, 192, 192, 0.2)";switch(o){case"weight":r="#4bc0c0",a="rgba(75, 192, 192, 0.2)";break;case"heart_rate":r="#ff6384",a="rgba(255, 99, 132, 0.2)";break;case"blood_pressure_systolic":case"blood_pressure_diastolic":r="#ff9f40",a="rgba(255, 159, 64, 0.2)";break;case"blood_sugar":r="#9966ff",a="rgba(153, 102, 255, 0.2)";break;case"oxygen_saturation":r="#36a2eb",a="rgba(54, 162, 235, 0.2)"}u({labels:i,datasets:[{label:x(o),data:n,borderColor:r,backgroundColor:a,tension:.1,fill:!0}]})},x=e=>{switch(e){case"weight":return"Weight (kg)";case"heart_rate":return"Heart Rate (bpm)";case"blood_pressure_systolic":return"Blood Pressure - Systolic (mmHg)";case"blood_pressure_diastolic":return"Blood Pressure - Diastolic (mmHg)";case"blood_sugar":return"Blood Sugar (mg/dL)";case"oxygen_saturation":return"Oxygen Saturation (%)";default:return e}},w=t=>{if(0===e.length)return"N/A";const s=[...e].sort(((e,t)=>new Date(t.recorded_at)-new Date(e.recorded_at))),i=s[0][t];if(void 0===i||null===i)return"N/A";switch(t){case"weight":return`${i} kg`;case"heart_rate":return`${i} bpm`;case"blood_pressure_systolic":return`${i}/${s[0].blood_pressure_diastolic||"N/A"} mmHg`;case"blood_pressure_diastolic":return`${s[0].blood_pressure_systolic||"N/A"}/${i} mmHg`;case"blood_sugar":return`${i} mg/dL`;case"oxygen_saturation":return`${i}%`;default:return i}};return i&&0===e.length?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[r&&(0,Pe.jsx)("div",{className:`alert alert-${r.type} text-center`,children:r.message}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,Pe.jsxs)("h1",{children:[(0,Pe.jsx)(at,{className:"me-2"})," Health Analytics"]}),(0,Pe.jsxs)("div",{children:[(0,Pe.jsx)("button",{className:"btn btn-primary me-2",onClick:()=>f(!p),children:p?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Wt,{})," Cancel"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Lt,{})," Add New Metrics"]})}),e.length>0&&(0,Pe.jsx)("button",{className:"btn btn-success",onClick:()=>{const t=e.map((e=>[new Date(e.recorded_at).toLocaleDateString(),e.weight||"",e.heart_rate||"",`${e.blood_pressure_systolic||""}/${e.blood_pressure_diastolic||""}`,e.blood_sugar||"",e.oxygen_saturation?`${e.oxygen_saturation}%`:""])),s=[["Date","Weight (kg)","Heart Rate (bpm)","Blood Pressure (mmHg)","Blood Sugar (mg/dL)","Oxygen Saturation (%)"].join(","),...t.map((e=>e.join(",")))].join("\n"),i=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(i),r=document.createElement("a");r.setAttribute("href",n),r.setAttribute("download",`health_metrics_${(new Date).toISOString().split("T")[0]}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)},children:"Export Data"})]})]}),p&&(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Pe.jsx)("h3",{className:"mb-0",children:"Add New Health Metrics"})}),(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const t=Object.fromEntries(Object.entries(m).filter((e=>{let[t,s]=e;return""!==s})));t.user_id=e.id;const{error:s}=await $e.from("health_metrics").insert([t]);if(s)throw s;a({message:"Health metrics added successfully!",type:"success"}),f(!1),g({weight:"",heart_rate:"",blood_pressure_systolic:"",blood_pressure_diastolic:"",blood_sugar:"",oxygen_saturation:"",recorded_at:(new Date).toISOString().split("T")[0]}),v()}catch(t){console.error("Error adding health metrics:",t),a({message:"Error adding health metrics.",type:"danger"})}finally{n(!1)}},children:[(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"recorded_at",className:"form-label",children:"Date"}),(0,Pe.jsx)("input",{type:"date",className:"form-control",id:"recorded_at",name:"recorded_at",value:m.recorded_at,onChange:b,required:!0})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"weight",className:"form-label",children:"Weight (kg)"}),(0,Pe.jsx)("input",{type:"number",step:"0.1",className:"form-control",id:"weight",name:"weight",value:m.weight,onChange:b,placeholder:"e.g. 70.5"})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"heart_rate",className:"form-label",children:"Heart Rate (bpm)"}),(0,Pe.jsx)("input",{type:"number",className:"form-control",id:"heart_rate",name:"heart_rate",value:m.heart_rate,onChange:b,placeholder:"e.g. 72"})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"oxygen_saturation",className:"form-label",children:"Oxygen Saturation (%)"}),(0,Pe.jsx)("input",{type:"number",min:"0",max:"100",className:"form-control",id:"oxygen_saturation",name:"oxygen_saturation",value:m.oxygen_saturation,onChange:b,placeholder:"e.g. 98"})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"blood_pressure_systolic",className:"form-label",children:"Blood Pressure - Systolic (mmHg)"}),(0,Pe.jsx)("input",{type:"number",className:"form-control",id:"blood_pressure_systolic",name:"blood_pressure_systolic",value:m.blood_pressure_systolic,onChange:b,placeholder:"e.g. 120"})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"blood_pressure_diastolic",className:"form-label",children:"Blood Pressure - Diastolic (mmHg)"}),(0,Pe.jsx)("input",{type:"number",className:"form-control",id:"blood_pressure_diastolic",name:"blood_pressure_diastolic",value:m.blood_pressure_diastolic,onChange:b,placeholder:"e.g. 80"})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"blood_sugar",className:"form-label",children:"Blood Sugar (mg/dL)"}),(0,Pe.jsx)("input",{type:"number",className:"form-control",id:"blood_sugar",name:"blood_sugar",value:m.blood_sugar,onChange:b,placeholder:"e.g. 100"})]}),(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?"Saving...":"Save Metrics"})]})})]}),0===e.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No health data available. Please add health metrics to see analytics."}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsxs)("div",{className:"row mb-4",children:[(0,Pe.jsx)("div",{className:"col-md-4 mb-3",children:(0,Pe.jsx)("div",{className:"card shadow h-100",children:(0,Pe.jsxs)("div",{className:"card-body text-center",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(ts,{className:"me-2"})," Weight"]}),(0,Pe.jsx)("h2",{className:"card-text",children:w("weight")})]})})}),(0,Pe.jsx)("div",{className:"col-md-4 mb-3",children:(0,Pe.jsx)("div",{className:"card shadow h-100",children:(0,Pe.jsxs)("div",{className:"card-body text-center",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(St,{className:"me-2"})," Heart Rate"]}),(0,Pe.jsx)("h2",{className:"card-text",children:w("heart_rate")})]})})}),(0,Pe.jsx)("div",{className:"col-md-4 mb-3",children:(0,Pe.jsx)("div",{className:"card shadow h-100",children:(0,Pe.jsxs)("div",{className:"card-body text-center",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(qt,{className:"me-2"})," Blood Pressure"]}),(0,Pe.jsx)("h2",{className:"card-text",children:w("blood_pressure_systolic")})]})})})]}),(0,Pe.jsx)("div",{className:"card shadow mb-4",children:(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"metricSelect",className:"form-label",children:"Select Metric"}),(0,Pe.jsxs)("select",{id:"metricSelect",className:"form-select",value:o,onChange:e=>l(e.target.value),children:[(0,Pe.jsx)("option",{value:"weight",children:"Weight"}),(0,Pe.jsx)("option",{value:"heart_rate",children:"Heart Rate"}),(0,Pe.jsx)("option",{value:"blood_pressure_systolic",children:"Blood Pressure (Systolic)"}),(0,Pe.jsx)("option",{value:"blood_pressure_diastolic",children:"Blood Pressure (Diastolic)"}),(0,Pe.jsx)("option",{value:"blood_sugar",children:"Blood Sugar"}),(0,Pe.jsx)("option",{value:"oxygen_saturation",children:"Oxygen Saturation"})]})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"timeRangeSelect",className:"form-label",children:"Time Range"}),(0,Pe.jsxs)("select",{id:"timeRangeSelect",className:"form-select",value:c,onChange:e=>d(e.target.value),children:[(0,Pe.jsx)("option",{value:"1month",children:"Last Month"}),(0,Pe.jsx)("option",{value:"3months",children:"Last 3 Months"}),(0,Pe.jsx)("option",{value:"6months",children:"Last 6 Months"}),(0,Pe.jsx)("option",{value:"1year",children:"Last Year"}),(0,Pe.jsx)("option",{value:"all",children:"All Time"})]})]})]})})}),(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header",children:(0,Pe.jsxs)("h3",{className:"mb-0",children:[(e=>{switch(e){case"weight":return(0,Pe.jsx)(ts,{});case"heart_rate":return(0,Pe.jsx)(St,{});case"blood_pressure_systolic":case"blood_pressure_diastolic":case"blood_sugar":return(0,Pe.jsx)(qt,{});case"oxygen_saturation":return(0,Pe.jsx)(Mt,{});default:return(0,Pe.jsx)(at,{})}})(o)," ",x(o)," Trend"]})}),(0,Pe.jsx)("div",{className:"card-body",children:h?(0,Pe.jsx)(Zg,{data:h,options:{responsive:!0,plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1}},scales:{y:{beginAtZero:!1}}}}):(0,Pe.jsx)("p",{className:"text-center",children:"No data available for the selected metric and time range."})})]}),(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header",children:(0,Pe.jsx)("h3",{className:"mb-0",children:"Health Insights"})}),(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsx)("p",{children:"This dashboard provides a visual representation of your health metrics over time. Track your progress and identify trends to better manage your health."}),(0,Pe.jsx)("p",{children:"For personalized health advice, please consult with your healthcare provider."})]})]})]})]})},tv=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,doctor_name:"",specialty:"",date:"",time:"",location:"",notes:"",reminder_set:!1});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:i,error:n}=await $e.from("appointments").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(n)throw n;s(i||[])}catch(e){console.error("Error fetching appointments:",e),a({message:"Error fetching appointments.",type:"danger"})}finally{n(!1)}},u=e=>{const{name:t,value:s,type:i,checked:n}=e.target;d((e=>({...e,[t]:"checkbox"===i?n:s})))},p=()=>{l(!1),d({id:null,doctor_name:"",specialty:"",date:"",time:"",location:"",notes:"",reminder_set:!1})},f=e=>e===(new Date).toISOString().split("T")[0],m=e=>{const t=new Date,s=new Date(e)-t,i=Math.ceil(s/864e5);return i>0&&i<=3};return i&&0===e.length?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[r&&(0,Pe.jsx)("div",{className:`alert alert-${r.type} text-center`,children:r.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(rt,{className:"me-2"})," Upcoming Appointments"]}),(0,Pe.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Pe.jsx)("h3",{children:o?"Edit Appointment":"Schedule New Appointment"}),(0,Pe.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await $e.from("appointments").update({doctor_name:c.doctor_name,specialty:c.specialty,date:c.date,time:c.time,location:c.location,notes:c.notes,reminder_set:c.reminder_set}).eq("id",c.id);if(e)throw e;a({message:"Appointment updated successfully!",type:"success"})}else{const{error:t}=await $e.from("appointments").insert([{doctor_name:c.doctor_name,specialty:c.specialty,date:c.date,time:c.time,location:c.location,notes:c.notes,reminder_set:c.reminder_set,user_id:e.id}]);if(t)throw t;a({message:"Appointment added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving appointment:",t),a({message:"Error saving appointment.",type:"danger"})}finally{n(!1)}},children:[(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"doctor_name",className:"form-label",children:"Doctor Name"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"doctor_name",name:"doctor_name",value:c.doctor_name,onChange:u,required:!0})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"specialty",className:"form-label",children:"Specialty"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"specialty",name:"specialty",value:c.specialty,onChange:u})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"date",className:"form-label",children:"Date"}),(0,Pe.jsx)("input",{type:"date",className:"form-control",id:"date",name:"date",value:c.date,onChange:u,required:!0})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"time",className:"form-label",children:"Time"}),(0,Pe.jsx)("input",{type:"time",className:"form-control",id:"time",name:"time",value:c.time,onChange:u,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"location",className:"form-label",children:"Location"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"location",name:"location",value:c.location,onChange:u,required:!0})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Pe.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u})]}),(0,Pe.jsxs)("div",{className:"mb-3 form-check",children:[(0,Pe.jsx)("input",{type:"checkbox",className:"form-check-input",id:"reminder_set",name:"reminder_set",checked:c.reminder_set,onChange:u}),(0,Pe.jsx)("label",{className:"form-check-label",htmlFor:"reminder_set",children:"Set Reminder"})]}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(mt,{className:"me-2"})," Update Appointment"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Lt,{className:"me-2"})," Schedule Appointment"]})}),o&&(0,Pe.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),e.some((e=>f(e.date)))&&(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Pe.jsxs)("h3",{className:"mb-0",children:[(0,Pe.jsx)(dt,{className:"me-2"})," Today's Appointments"]})}),(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsx)("div",{className:"row",children:e.filter((e=>f(e.date))).map((e=>(0,Pe.jsx)("div",{className:"col-md-6 mb-3",children:(0,Pe.jsx)("div",{className:"card h-100 border-primary",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsx)("h5",{className:"card-title",children:e.doctor_name}),(0,Pe.jsx)("h6",{className:"card-subtitle mb-2 text-muted",children:e.specialty}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(dt,{className:"me-2"})," ",e.time,(0,Pe.jsx)("br",{}),(0,Pe.jsx)(Pt,{className:"me-2"})," ",e.location]}),e.notes&&(0,Pe.jsx)("p",{className:"card-text",children:e.notes})]})})},`today-${e.id}`)))})})]}),(0,Pe.jsx)("h2",{className:"text-center mb-3",children:"All Upcoming Appointments"}),0===e.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No upcoming appointments. Schedule your first appointment above."}):(0,Pe.jsx)("div",{className:"row",children:e.map((t=>(0,Pe.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Pe.jsxs)("div",{className:"card h-100 shadow "+(f(t.date)?"border-primary":m(t.date)?"border-warning":""),children:[(0,Pe.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,Pe.jsxs)("h5",{className:"mb-0",children:[(0,Pe.jsx)(Qt,{className:"me-2"})," ",t.doctor_name]}),f(t.date)&&(0,Pe.jsx)("span",{className:"badge bg-primary",children:"Today"}),m(t.date)&&!f(t.date)&&(0,Pe.jsx)("span",{className:"badge bg-warning text-dark",children:"Soon"})]}),(0,Pe.jsxs)("div",{className:"card-body",children:[t.specialty&&(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Specialty:"})," ",t.specialty]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(rt,{className:"me-2"})," ",new Date(t.date).toLocaleDateString()]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(dt,{className:"me-2"})," ",t.time]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(Pt,{className:"me-2"})," ",t.location]}),t.notes&&(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Notes:"}),(0,Pe.jsx)("br",{}),t.notes]}),t.reminder_set&&(0,Pe.jsx)("p",{className:"card-text",children:(0,Pe.jsx)("span",{className:"badge bg-info text-dark",children:"Reminder Set"})})]}),(0,Pe.jsxs)("div",{className:"card-footer d-flex justify-content-between",children:[(0,Pe.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:[(0,Pe.jsx)(mt,{className:"me-1"})," Edit"]}),(0,Pe.jsxs)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this appointment?")){n(!0);try{const{error:i}=await $e.from("appointments").delete().eq("id",t);if(i)throw i;s(e.filter((e=>e.id!==t))),a({message:"Appointment deleted successfully!",type:"success"})}catch(i){console.error("Error deleting appointment:",i),a({message:"Error deleting appointment.",type:"danger"})}finally{n(!1)}}})(t.id),children:[(0,Pe.jsx)(Kt,{className:"me-1"})," Cancel"]})]})]})},t.id)))})]})},sv=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[h,u]=(0,t.useState)(""),[p,f]=(0,t.useState)("desc");(0,t.useEffect)((()=>{m()}),[]);const m=async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:i,error:n}=await $e.from("appointments").select("*").eq("user_id",e.id).lt("date",t).order("date",{ascending:!1});if(n)throw n;s(i||[])}catch(e){console.error("Error fetching appointment history:",e),a({message:"Error fetching appointment history.",type:"danger"})}finally{n(!1)}},g=e.filter((e=>{const t=""===o||e.doctor_name.toLowerCase().includes(o.toLowerCase())||e.specialty&&e.specialty.toLowerCase().includes(o.toLowerCase())||e.location&&e.location.toLowerCase().includes(o.toLowerCase())||e.notes&&e.notes.toLowerCase().includes(o.toLowerCase()),s=""===c||e.date===c,i=""===h||e.doctor_name.toLowerCase().includes(h.toLowerCase());return t&&s&&i})).sort(((e,t)=>{const s=new Date(e.date),i=new Date(t.date);return"desc"===p?i-s:s-i}));return i&&0===e.length?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[r&&(0,Pe.jsx)("div",{className:`alert alert-${r.type} text-center`,children:r.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(kt,{className:"me-2"})," Appointment History"]}),(0,Pe.jsx)("div",{className:"card shadow mb-4",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("div",{className:"row mb-3",children:[(0,Pe.jsx)("div",{className:"col-md-6 mb-2",children:(0,Pe.jsxs)("div",{className:"input-group",children:[(0,Pe.jsx)("span",{className:"input-group-text",children:(0,Pe.jsx)(zt,{})}),(0,Pe.jsx)("input",{type:"text",className:"form-control",placeholder:"Search appointments...",value:o,onChange:e=>{l(e.target.value)}})]})}),(0,Pe.jsx)("div",{className:"col-md-3 mb-2",children:(0,Pe.jsx)("input",{type:"date",className:"form-control",placeholder:"Filter by date",value:c,onChange:e=>{d(e.target.value)}})}),(0,Pe.jsx)("div",{className:"col-md-3 mb-2",children:(0,Pe.jsx)("input",{type:"text",className:"form-control",placeholder:"Filter by doctor",value:h,onChange:e=>{u(e.target.value)}})})]}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,Pe.jsxs)("button",{className:"btn btn-outline-secondary",onClick:()=>{f("desc"===p?"asc":"desc")},children:["Sort by Date: ","desc"===p?"Newest First":"Oldest First"]}),(0,Pe.jsxs)("button",{className:"btn btn-success",onClick:()=>{const e=g.map((e=>[e.doctor_name,e.specialty,new Date(e.date).toLocaleDateString(),e.time,e.location,e.notes])),t=[["Doctor","Specialty","Date","Time","Location","Notes"].join(","),...e.map((e=>e.map((e=>`"${e||""}"`)).join(",")))].join("\n"),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(s),n=document.createElement("a");n.setAttribute("href",i),n.setAttribute("download",`appointment_history_${(new Date).toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},disabled:0===g.length,children:[(0,Pe.jsx)(yt,{className:"me-2"})," Export to CSV"]})]})]})}),0===e.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No appointment history found."}):0===g.length?(0,Pe.jsx)("div",{className:"alert alert-warning text-center",children:"No appointments match your search criteria."}):(0,Pe.jsx)("div",{className:"row",children:g.map((e=>(0,Pe.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Pe.jsxs)("div",{className:"card h-100 shadow",children:[(0,Pe.jsx)("div",{className:"card-header",children:(0,Pe.jsxs)("h5",{className:"mb-0",children:[(0,Pe.jsx)(Qt,{className:"me-2"})," ",e.doctor_name]})}),(0,Pe.jsxs)("div",{className:"card-body",children:[e.specialty&&(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Specialty:"})," ",e.specialty]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(nt,{className:"me-2"})," ",new Date(e.date).toLocaleDateString()]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(dt,{className:"me-2"})," ",e.time]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(Pt,{className:"me-2"})," ",e.location]}),e.notes&&(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Notes:"}),(0,Pe.jsx)("br",{}),e.notes]})]})]})},e.id)))})]})},iv=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!0),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)({id:null,doctor_name:"",specialty:"",date:"",time:"",consultation_type:"video",meeting_link:"",notes:"",reminder_set:!1});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:i}=await $e.from("telehealth_consultations").select("*").eq("user_id",e.id).order("date",{ascending:!0});if(i)throw i;s(t||[])}catch(e){console.error("Error fetching consultations:",e),a({message:"Error fetching consultations.",type:"danger"})}finally{n(!1)}},u=e=>{const{name:t,value:s,type:i,checked:n}=e.target;d((e=>({...e,[t]:"checkbox"===i?n:s})))},p=()=>{l(!1),d({id:null,doctor_name:"",specialty:"",date:"",time:"",consultation_type:"video",meeting_link:"",notes:"",reminder_set:!1})},f=e=>e===(new Date).toISOString().split("T")[0],m=e=>e<(new Date).toISOString().split("T")[0],g=e=>{const t=new Date,s=new Date(e)-t,i=Math.ceil(s/864e5);return i>0&&i<=3},v=e.filter((e=>!m(e.date))),b=e.filter((e=>m(e.date)));return i&&0===e.length?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[r&&(0,Pe.jsx)("div",{className:`alert alert-${r.type} text-center`,children:r.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(es,{className:"me-2"})," Telehealth Consultations"]}),(0,Pe.jsxs)("div",{className:"card shadow-lg p-4 mb-4",children:[(0,Pe.jsx)("h3",{children:o?"Edit Consultation":"Schedule New Consultation"}),(0,Pe.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");if(o){const{error:e}=await $e.from("telehealth_consultations").update({doctor_name:c.doctor_name,specialty:c.specialty,date:c.date,time:c.time,consultation_type:c.consultation_type,meeting_link:c.meeting_link,notes:c.notes,reminder_set:c.reminder_set}).eq("id",c.id);if(e)throw e;a({message:"Consultation updated successfully!",type:"success"})}else{const{error:t}=await $e.from("telehealth_consultations").insert([{doctor_name:c.doctor_name,specialty:c.specialty,date:c.date,time:c.time,consultation_type:c.consultation_type,meeting_link:c.meeting_link,notes:c.notes,reminder_set:c.reminder_set,user_id:e.id}]);if(t)throw t;a({message:"Consultation added successfully!",type:"success"})}p(),h()}catch(t){console.error("Error saving consultation:",t),a({message:"Error saving consultation.",type:"danger"})}finally{n(!1)}},children:[(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"doctor_name",className:"form-label",children:"Doctor Name"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"doctor_name",name:"doctor_name",value:c.doctor_name,onChange:u,required:!0})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"specialty",className:"form-label",children:"Specialty"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"specialty",name:"specialty",value:c.specialty,onChange:u})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"date",className:"form-label",children:"Date"}),(0,Pe.jsx)("input",{type:"date",className:"form-control",id:"date",name:"date",value:c.date,onChange:u,required:!0})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"time",className:"form-label",children:"Time"}),(0,Pe.jsx)("input",{type:"time",className:"form-control",id:"time",name:"time",value:c.time,onChange:u,required:!0})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"consultation_type",className:"form-label",children:"Consultation Type"}),(0,Pe.jsxs)("select",{className:"form-control",id:"consultation_type",name:"consultation_type",value:c.consultation_type,onChange:u,required:!0,children:[(0,Pe.jsx)("option",{value:"video",children:"Video Call"}),(0,Pe.jsx)("option",{value:"phone",children:"Phone Call"}),(0,Pe.jsx)("option",{value:"chat",children:"Chat"})]})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"meeting_link",className:"form-label",children:"Meeting Link/Phone Number"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"meeting_link",name:"meeting_link",value:c.meeting_link,onChange:u,placeholder:"Enter meeting link or phone number"})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"notes",className:"form-label",children:"Notes"}),(0,Pe.jsx)("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:c.notes,onChange:u,placeholder:"Reason for consultation, questions to ask, etc."})]}),(0,Pe.jsxs)("div",{className:"mb-3 form-check",children:[(0,Pe.jsx)("input",{type:"checkbox",className:"form-check-input",id:"reminder_set",name:"reminder_set",checked:c.reminder_set,onChange:u}),(0,Pe.jsx)("label",{className:"form-check-label",htmlFor:"reminder_set",children:"Set Reminder"})]}),(0,Pe.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",children:o?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(mt,{className:"me-2"})," Update Consultation"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Lt,{className:"me-2"})," Schedule Consultation"]})}),o&&(0,Pe.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:p,children:"Cancel"})]})]})]}),e.some((e=>f(e.date)))&&(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Pe.jsxs)("h3",{className:"mb-0",children:[(0,Pe.jsx)(dt,{className:"me-2"})," Today's Consultations"]})}),(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsx)("div",{className:"row",children:e.filter((e=>f(e.date))).map((e=>(0,Pe.jsx)("div",{className:"col-md-6 mb-3",children:(0,Pe.jsx)("div",{className:"card h-100 border-primary",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsx)("h5",{className:"card-title",children:e.doctor_name}),(0,Pe.jsx)("h6",{className:"card-subtitle mb-2 text-muted",children:e.specialty}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(dt,{className:"me-2"})," ",e.time,(0,Pe.jsx)("br",{}),"video"===e.consultation_type?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(es,{className:"me-2"})," Video Call"]}):"phone"===e.consultation_type?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Dt,{className:"me-2"})," Phone Call"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(jt,{className:"me-2"})," Chat"]})]}),e.meeting_link&&(0,Pe.jsx)("p",{className:"card-text",children:(0,Pe.jsx)("a",{href:"video"===e.consultation_type?e.meeting_link:`tel:${e.meeting_link}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-success",children:"video"===e.consultation_type?"Join Meeting":"Call Now"})}),e.notes&&(0,Pe.jsx)("p",{className:"card-text",children:(0,Pe.jsx)("small",{children:e.notes})})]})})},`today-${e.id}`)))})})]}),(0,Pe.jsx)("h2",{className:"text-center mb-3",children:"Upcoming Consultations"}),0===v.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No upcoming consultations. Schedule your first consultation above."}):(0,Pe.jsx)("div",{className:"row",children:v.map((t=>(0,Pe.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Pe.jsxs)("div",{className:"card h-100 shadow "+(f(t.date)?"border-primary":g(t.date)?"border-warning":""),children:[(0,Pe.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,Pe.jsxs)("h5",{className:"mb-0",children:[(0,Pe.jsx)(Qt,{className:"me-2"})," ",t.doctor_name]}),f(t.date)&&(0,Pe.jsx)("span",{className:"badge bg-primary",children:"Today"}),g(t.date)&&!f(t.date)&&(0,Pe.jsx)("span",{className:"badge bg-warning text-dark",children:"Soon"})]}),(0,Pe.jsxs)("div",{className:"card-body",children:[t.specialty&&(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Specialty:"})," ",t.specialty]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Date:"})," ",new Date(t.date).toLocaleDateString()]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Time:"})," ",t.time]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Type:"})," ","video"===t.consultation_type?"Video Call":"phone"===t.consultation_type?"Phone Call":"Chat"]}),t.meeting_link&&(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Link/Number:"})," ",t.meeting_link]}),t.notes&&(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Notes:"}),(0,Pe.jsx)("br",{}),t.notes]}),t.reminder_set&&(0,Pe.jsx)("p",{className:"card-text",children:(0,Pe.jsx)("span",{className:"badge bg-info text-dark",children:"Reminder Set"})})]}),(0,Pe.jsxs)("div",{className:"card-footer d-flex justify-content-between",children:[(0,Pe.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{l(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t),children:[(0,Pe.jsx)(mt,{className:"me-1"})," Edit"]}),(0,Pe.jsxs)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this consultation?")){n(!0);try{const{error:i}=await $e.from("telehealth_consultations").delete().eq("id",t);if(i)throw i;s(e.filter((e=>e.id!==t))),a({message:"Consultation deleted successfully!",type:"success"})}catch(i){console.error("Error deleting consultation:",i),a({message:"Error deleting consultation.",type:"danger"})}finally{n(!1)}}})(t.id),children:[(0,Pe.jsx)(Kt,{className:"me-1"})," Cancel"]})]})]})},t.id)))}),b.length>0&&(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)("h2",{className:"text-center mb-3 mt-5",children:"Past Consultations"}),(0,Pe.jsx)("div",{className:"table-responsive",children:(0,Pe.jsxs)("table",{className:"table table-striped",children:[(0,Pe.jsx)("thead",{children:(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("th",{children:"Doctor"}),(0,Pe.jsx)("th",{children:"Specialty"}),(0,Pe.jsx)("th",{children:"Date"}),(0,Pe.jsx)("th",{children:"Time"}),(0,Pe.jsx)("th",{children:"Type"}),(0,Pe.jsx)("th",{children:"Notes"})]})}),(0,Pe.jsx)("tbody",{children:b.map((e=>(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("td",{children:e.doctor_name}),(0,Pe.jsx)("td",{children:e.specialty}),(0,Pe.jsx)("td",{children:new Date(e.date).toLocaleDateString()}),(0,Pe.jsx)("td",{children:e.time}),(0,Pe.jsx)("td",{children:"video"===e.consultation_type?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(es,{className:"me-1"})," Video"]}):"phone"===e.consultation_type?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Dt,{className:"me-1"})," Phone"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(jt,{className:"me-1"})," Chat"]})}),(0,Pe.jsx)("td",{children:e.notes})]},`past-${e.id}`)))})]})})]})]})},nv=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)([]),[r,a]=(0,t.useState)(!0),[o,l]=(0,t.useState)(null),[c,d]=(0,t.useState)({email_reminders:!0,sms_reminders:!1,browser_notifications:!0,reminder_time:"24",phone_number:""});(0,t.useEffect)((()=>{h()}),[]);const h=async()=>{try{a(!0);const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:i,error:r}=await $e.from("appointments").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(r)throw r;const{data:o,error:l}=await $e.from("telehealth_consultations").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(l)throw l;const c=[...(i||[]).map((e=>({...e,type:"appointment"}))),...(o||[]).map((e=>({...e,type:"telehealth",doctor_name:e.doctor_name})))].sort(((e,t)=>new Date(`${e.date}T${e.time}`)-new Date(`${t.date}T${t.time}`)));s(c);const{data:h,error:u}=await $e.from("reminder_settings").select("*").eq("user_id",e.id).single();if(u&&"PGRST116"!==u.code)throw u;h&&d(h);const{data:p,error:f}=await $e.from("reminders").select("*").eq("user_id",e.id).gte("reminder_time",(new Date).toISOString()).order("reminder_time",{ascending:!0});if(f)throw f;n(p||[])}catch(e){console.error("Error fetching data:",e),l({message:"Error fetching data.",type:"danger"})}finally{a(!1)}},u=e=>{const{name:t,value:s,type:i,checked:n}=e.target;d((e=>({...e,[t]:"checkbox"===i?n:s})))},p=e=>e===(new Date).toISOString().split("T")[0],f=e=>{const t=new Date,s=new Date(e)-t,i=Math.ceil(s/864e5);return i>0&&i<=3};return r&&0===e.length&&0===i.length?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[o&&(0,Pe.jsx)("div",{className:`alert alert-${o.type} text-center`,children:o.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(tt,{className:"me-2"})," Appointment Reminders"]}),(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header",children:(0,Pe.jsx)("h3",{className:"mb-0",children:"Reminder Settings"})}),(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsx)("div",{className:"col-md-6 mb-3",children:(0,Pe.jsxs)("div",{className:"form-check form-switch",children:[(0,Pe.jsx)("input",{className:"form-check-input",type:"checkbox",id:"email_reminders",name:"email_reminders",checked:c.email_reminders,onChange:u}),(0,Pe.jsx)("label",{className:"form-check-label",htmlFor:"email_reminders",children:"Email Reminders"})]})}),(0,Pe.jsx)("div",{className:"col-md-6 mb-3",children:(0,Pe.jsxs)("div",{className:"form-check form-switch",children:[(0,Pe.jsx)("input",{className:"form-check-input",type:"checkbox",id:"browser_notifications",name:"browser_notifications",checked:c.browser_notifications,onChange:u}),(0,Pe.jsx)("label",{className:"form-check-label",htmlFor:"browser_notifications",children:"Browser Notifications"})]})})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsx)("div",{className:"col-md-6 mb-3",children:(0,Pe.jsxs)("div",{className:"form-check form-switch",children:[(0,Pe.jsx)("input",{className:"form-check-input",type:"checkbox",id:"sms_reminders",name:"sms_reminders",checked:c.sms_reminders,onChange:u}),(0,Pe.jsx)("label",{className:"form-check-label",htmlFor:"sms_reminders",children:"SMS Reminders"})]})}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"phone_number",className:"form-label",children:"Phone Number (for SMS)"}),(0,Pe.jsx)("input",{type:"tel",className:"form-control",id:"phone_number",name:"phone_number",value:c.phone_number,onChange:u,placeholder:"Enter your phone number",disabled:!c.sms_reminders})]})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"reminder_time",className:"form-label",children:"Send Reminders"}),(0,Pe.jsxs)("select",{className:"form-select",id:"reminder_time",name:"reminder_time",value:c.reminder_time,onChange:u,children:[(0,Pe.jsx)("option",{value:"1",children:"1 hour before"}),(0,Pe.jsx)("option",{value:"2",children:"2 hours before"}),(0,Pe.jsx)("option",{value:"6",children:"6 hours before"}),(0,Pe.jsx)("option",{value:"12",children:"12 hours before"}),(0,Pe.jsx)("option",{value:"24",children:"24 hours before"}),(0,Pe.jsx)("option",{value:"48",children:"2 days before"}),(0,Pe.jsx)("option",{value:"72",children:"3 days before"})]})]}),(0,Pe.jsx)("div",{className:"col-md-6 mb-3 d-flex align-items-end",children:(0,Pe.jsx)("button",{className:"btn btn-primary w-100",onClick:async()=>{try{a(!0);const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const{error:t}=await $e.from("reminder_settings").upsert({...c,user_id:e.id});if(t)throw t;l({message:"Reminder settings saved successfully!",type:"success"})}catch(e){console.error("Error saving reminder settings:",e),l({message:"Error saving reminder settings.",type:"danger"})}finally{a(!1)}},disabled:r,children:"Save Settings"})})]})]})]}),(0,Pe.jsx)("h2",{className:"text-center mb-3",children:"Active Reminders"}),0===i.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No active reminders. Set reminders for your appointments below."}):(0,Pe.jsx)("div",{className:"table-responsive mb-4",children:(0,Pe.jsxs)("table",{className:"table table-striped",children:[(0,Pe.jsx)("thead",{children:(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("th",{children:"Appointment"}),(0,Pe.jsx)("th",{children:"Doctor"}),(0,Pe.jsx)("th",{children:"Appointment Time"}),(0,Pe.jsx)("th",{children:"Reminder Time"}),(0,Pe.jsx)("th",{children:"Actions"})]})}),(0,Pe.jsx)("tbody",{children:i.map((e=>(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("td",{children:"telehealth"===e.appointment_type?"Telehealth":"In-person"}),(0,Pe.jsx)("td",{children:e.doctor_name}),(0,Pe.jsx)("td",{children:new Date(e.appointment_time).toLocaleString()}),(0,Pe.jsx)("td",{children:new Date(e.reminder_time).toLocaleString()}),(0,Pe.jsx)("td",{children:(0,Pe.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this reminder?"))try{a(!0);const{data:t,error:s}=await $e.from("reminders").select("*").eq("id",e).single();if(s)throw s;if("appointment"===t.appointment_type){const{error:e}=await $e.from("appointments").update({reminder_set:!1}).eq("id",t.appointment_id);if(e)throw e}else{const{error:e}=await $e.from("telehealth_consultations").update({reminder_set:!1}).eq("id",t.appointment_id);if(e)throw e}const{error:i}=await $e.from("reminders").delete().eq("id",e);if(i)throw i;l({message:"Reminder deleted successfully!",type:"success"}),h()}catch(t){console.error("Error deleting reminder:",t),l({message:"Error deleting reminder.",type:"danger"})}finally{a(!1)}})(e.id),children:(0,Pe.jsx)(Kt,{})})})]},e.id)))})]})}),(0,Pe.jsx)("h2",{className:"text-center mb-3",children:"Upcoming Appointments"}),0===e.length?(0,Pe.jsx)("div",{className:"alert alert-info text-center",children:"No upcoming appointments found. Schedule appointments to set reminders."}):(0,Pe.jsx)("div",{className:"row",children:e.map((e=>(0,Pe.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Pe.jsxs)("div",{className:"card h-100 shadow "+(p(e.date)?"border-primary":f(e.date)?"border-warning":""),children:[(0,Pe.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",children:[(0,Pe.jsxs)("h5",{className:"mb-0",children:[(0,Pe.jsx)(Qt,{className:"me-2"})," ",e.doctor_name]}),p(e.date)&&(0,Pe.jsx)("span",{className:"badge bg-primary",children:"Today"}),f(e.date)&&!p(e.date)&&(0,Pe.jsx)("span",{className:"badge bg-warning text-dark",children:"Soon"})]}),(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(nt,{className:"me-2"})," ",new Date(e.date).toLocaleDateString()]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)(dt,{className:"me-2"})," ",e.time]}),(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Type:"})," ","telehealth"===e.type?"Telehealth Consultation":"In-person Appointment"]}),e.location&&(0,Pe.jsxs)("p",{className:"card-text",children:[(0,Pe.jsx)("strong",{children:"Location:"})," ",e.location]})]}),(0,Pe.jsx)("div",{className:"card-footer",children:(0,Pe.jsx)("button",{className:"btn btn-block w-100",onClick:()=>(async e=>{try{a(!0);const{data:{user:t}}=await $e.auth.getUser();if(!t)return void(window.location.href="/");if(e.reminder_set){if("appointment"===e.type){const{error:t}=await $e.from("appointments").update({reminder_set:!1}).eq("id",e.id);if(t)throw t}else{const{error:t}=await $e.from("telehealth_consultations").update({reminder_set:!1}).eq("id",e.id);if(t)throw t}const{error:t}=await $e.from("reminders").delete().eq("appointment_id",e.id).eq("appointment_type",e.type);if(t)throw t;l({message:"Reminder removed successfully!",type:"success"})}else{const s=new Date(`${e.date}T${e.time}`),i=parseInt(c.reminder_time,10),n=new Date(s.getTime()-60*i*60*1e3);if("appointment"===e.type){const{error:t}=await $e.from("appointments").update({reminder_set:!0}).eq("id",e.id);if(t)throw t}else{const{error:t}=await $e.from("telehealth_consultations").update({reminder_set:!0}).eq("id",e.id);if(t)throw t}const{error:r}=await $e.from("reminders").insert([{user_id:t.id,appointment_id:e.id,appointment_type:e.type,reminder_time:n.toISOString(),appointment_time:s.toISOString(),doctor_name:e.doctor_name,location:e.location||"",sent:!1}]);if(r)throw r;l({message:"Reminder set successfully!",type:"success"})}h()}catch(t){console.error("Error toggling reminder:",t),l({message:"Error toggling reminder.",type:"danger"})}finally{a(!1)}})(e),disabled:r,children:e.reminder_set?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Yt,{className:"me-2"})," Reminder On"]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(Gt,{className:"me-2"})," Set Reminder"]})})})]})},e.id)))})]})},rv=()=>{const[e,s]=(0,t.useState)(""),[i,n]=(0,t.useState)("all"),[r,a]=(0,t.useState)({}),[o,l]=(0,t.useState)([]),[c,d]=(0,t.useState)([]),[h,u]=(0,t.useState)(!0),[p,f]=(0,t.useState)(null),[m,g]=(0,t.useState)([]);(0,t.useEffect)((()=>{v()}),[]);const v=async()=>{try{u(!0);const{data:e,error:t}=await $e.from("faqs").select("*").order("id");if(t)throw t;const{data:s,error:i}=await $e.from("tutorials").select("*").order("id");if(i)throw i;l(e||[]),d(s||[]);const n=[...new Set(e.map((e=>e.category)))],r=[...new Set(s.map((e=>e.category)))],a=[...new Set([...n,...r])];g(a)}catch(e){console.error("Error fetching help center data:",e),f({message:"Error loading help center content.",type:"danger"}),l(b),d(y),g([...new Set([...b.map((e=>e.category)),...y.map((e=>e.category))])])}finally{u(!1)}},b=[{id:1,category:"account",question:"How do I create an account?",answer:'To create an account, click on the "Sign Up" button on the login page. Fill in your personal details, including your email address and a secure password. Follow the verification steps sent to your email to complete the registration process.'},{id:2,category:"account",question:"How do I reset my password?",answer:'If you forgot your password, click on the "Forgot Password" link on the login page. Enter your registered email address, and we will send you a password reset link. Follow the instructions in the email to create a new password.'},{id:3,category:"appointments",question:"How do I schedule an appointment?",answer:'To schedule an appointment, navigate to the "Appointments" section in the navigation menu and select "Upcoming Appointments". Click on the "Schedule New Appointment" button and fill in the required details such as doctor name, date, time, and location. Click "Schedule Appointment" to confirm.'},{id:4,category:"appointments",question:"How do I cancel or reschedule an appointment?",answer:'To cancel or reschedule an appointment, go to the "Upcoming Appointments" page. Find the appointment you want to modify, then click the "Edit" button to change the date or time, or click the "Cancel" button to cancel the appointment entirely.'},{id:5,category:"medical",question:"How do I add my medical history?",answer:'To add your medical history, navigate to the "Medical History" page from the "Your Journey" menu. Click on "Add New Medical Record" and fill in the details about your condition, diagnosis date, doctor, and treatment. Click "Add Record" to save the information.'},{id:6,category:"medical",question:"How do I track my medications?",answer:'To track your medications, go to the "Medication Tracker" page from the "Your Journey" menu. Enter the medication name, frequency, and quantity, then click "Add Medication". You can view and manage all your medications from this page.'},{id:7,category:"telehealth",question:"How do I join a telehealth consultation?",answer:'To join a telehealth consultation, go to the "Telehealth Consultations" page. On the day of your appointment, you will see your consultation listed under "Today\'s Consultations". Click the "Join Meeting" button at the scheduled time to enter the virtual consultation room.'},{id:8,category:"telehealth",question:"What equipment do I need for a telehealth consultation?",answer:"For a telehealth consultation, you need a device with a camera and microphone (smartphone, tablet, or computer), a stable internet connection, and a quiet, private space. Make sure your device is charged and your browser allows camera and microphone access."},{id:9,category:"data",question:"Is my health data secure?",answer:"Yes, your health data is secure. We use industry-standard encryption and security measures to protect your personal and medical information. Our platform complies with healthcare privacy regulations, and your data is only accessible to you and the healthcare providers you authorize."},{id:10,category:"data",question:"How do I export my health data?",answer:'To export your health data, go to the "Data Backup & Export" page under the "Account" menu. Select the type of data you want to export and the format (PDF, CSV, etc.). Click "Export Data" and follow the prompts to download your information.'}],y=[{id:1,category:"getting-started",title:"Getting Started with DigiHealth",type:"video",description:"Learn the basics of navigating the DigiHealth platform and setting up your profile.",link:"#"},{id:2,category:"appointments",title:"How to Schedule and Manage Appointments",type:"guide",description:"A step-by-step guide to scheduling, rescheduling, and canceling appointments.",link:"#"},{id:3,category:"medical",title:"Managing Your Medical Records",type:"video",description:"Learn how to add, edit, and organize your medical history and records.",link:"#"},{id:4,category:"telehealth",title:"Preparing for Your First Telehealth Consultation",type:"guide",description:"Tips and instructions for a successful virtual healthcare appointment.",link:"#"},{id:5,category:"data",title:"Understanding Your Health Analytics",type:"video",description:"How to interpret and use the health analytics features to monitor your well-being.",link:"#"},{id:6,category:"account",title:"Account Security Best Practices",type:"guide",description:"Learn how to keep your DigiHealth account secure with strong passwords and two-factor authentication.",link:"#"}],x=o.filter((t=>{const s=""===e||t.question.toLowerCase().includes(e.toLowerCase())||t.answer.toLowerCase().includes(e.toLowerCase()),n="all"===i||t.category===i;return s&&n})),w=c.filter((t=>{const s=""===e||t.title.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase()),n="all"===i||t.category===i;return s&&n}));return h?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"container mt-4",children:[p&&(0,Pe.jsx)("div",{className:`alert alert-${p.type} text-center`,children:p.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(it,{className:"me-2"})," Help Center"]}),(0,Pe.jsx)("div",{className:"card shadow mb-4",children:(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsx)("div",{className:"col-md-8 mb-3",children:(0,Pe.jsxs)("div",{className:"input-group",children:[(0,Pe.jsx)("span",{className:"input-group-text",children:(0,Pe.jsx)(zt,{})}),(0,Pe.jsx)("input",{type:"text",className:"form-control",placeholder:"Search for help topics...",value:e,onChange:e=>s(e.target.value)})]})}),(0,Pe.jsx)("div",{className:"col-md-4 mb-3",children:(0,Pe.jsxs)("select",{className:"form-select",value:i,onChange:e=>n(e.target.value),children:[(0,Pe.jsx)("option",{value:"all",children:"All Categories"}),m.map(((e,t)=>(0,Pe.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1).replace("-"," ")},t)))]})})]})})}),(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Pe.jsxs)("h2",{className:"mb-0",children:[(0,Pe.jsx)(Ft,{className:"me-2"})," Frequently Asked Questions"]})}),(0,Pe.jsx)("div",{className:"card-body",children:0===x.length?(0,Pe.jsx)("div",{className:"alert alert-info",children:"No FAQs match your search criteria. Try a different search term or category."}):(0,Pe.jsx)("div",{className:"accordion",children:x.map((e=>(0,Pe.jsxs)("div",{className:"card mb-2",children:[(0,Pe.jsxs)("div",{className:"card-header d-flex justify-content-between align-items-center",onClick:()=>{var t;t=e.id,a((e=>({...e,[t]:!e[t]}))),(async e=>{try{r[e]||await $e.from("faq_analytics").insert([{faq_id:e,viewed_at:(new Date).toISOString()}])}catch(t){console.error("Error tracking FAQ view:",t)}})(e.id)},style:{cursor:"pointer"},children:[(0,Pe.jsx)("h5",{className:"mb-0",children:e.question}),r[e.id]?(0,Pe.jsx)(ct,{}):(0,Pe.jsx)(lt,{})]}),r[e.id]&&(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsx)("p",{children:e.answer})})]},e.id)))})})]}),(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-success text-white",children:(0,Pe.jsxs)("h2",{className:"mb-0",children:[(0,Pe.jsx)(es,{className:"me-2"})," Tutorials & Guides"]})}),(0,Pe.jsx)("div",{className:"card-body",children:0===w.length?(0,Pe.jsx)("div",{className:"alert alert-info",children:"No tutorials match your search criteria. Try a different search term or category."}):(0,Pe.jsx)("div",{className:"row",children:w.map((e=>(0,Pe.jsx)("div",{className:"col-md-6 col-lg-4 mb-4",children:(0,Pe.jsxs)("div",{className:"card h-100",children:[(0,Pe.jsxs)("div",{className:"card-header",children:["video"===e.type?(0,Pe.jsx)(es,{className:"me-2 text-danger"}):(0,Pe.jsx)(bt,{className:"me-2 text-primary"}),(0,Pe.jsx)("span",{className:"badge bg-secondary",children:e.category.replace("-"," ")})]}),(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsx)("h5",{className:"card-title",children:e.title}),(0,Pe.jsx)("p",{className:"card-text",children:e.description})]}),(0,Pe.jsx)("div",{className:"card-footer",children:(0,Pe.jsx)("a",{href:e.link,className:"btn btn-primary btn-sm w-100",onClick:()=>(async e=>{try{await $e.from("tutorial_analytics").insert([{tutorial_id:e,clicked_at:(new Date).toISOString()}])}catch(t){console.error("Error tracking tutorial click:",t)}})(e.id),target:"_blank",rel:"noopener noreferrer",children:"video"===e.type?"Watch Video":"Read Guide"})})]})},e.id)))})})]}),(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-info text-white",children:(0,Pe.jsx)("h2",{className:"mb-0",children:"Need More Help?"})}),(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsx)("div",{className:"col-md-4 mb-3",children:(0,Pe.jsx)("div",{className:"card h-100 text-center",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsx)("h3",{children:"Contact Support"}),(0,Pe.jsx)("p",{children:"Reach out to our support team for personalized assistance."}),(0,Pe.jsx)("a",{href:"/contact-support",className:"btn btn-primary",children:"Contact Support"})]})})}),(0,Pe.jsx)("div",{className:"col-md-4 mb-3",children:(0,Pe.jsx)("div",{className:"card h-100 text-center",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsx)("h3",{children:"Live Chat"}),(0,Pe.jsx)("p",{children:"Chat with our support agents in real-time for immediate help."}),(0,Pe.jsx)("a",{href:"/live-chat",className:"btn btn-primary",children:"Start Chat"})]})})}),(0,Pe.jsx)("div",{className:"col-md-4 mb-3",children:(0,Pe.jsx)("div",{className:"card h-100 text-center",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsx)("h3",{children:"Email Support"}),(0,Pe.jsx)("p",{children:"Send us an email and we'll get back to you within 24 hours."}),(0,Pe.jsx)("a",{href:"mailto:support@digihealth.com",className:"btn btn-primary",children:"Email Us"})]})})})]})})]})]})},av=()=>{const[e,s]=(0,t.useState)(!1),[i,n]=(0,t.useState)(null),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)({subject:"",category:"general",priority:"medium",message:"",attachFile:null}),[c,d]=(0,t.useState)([]);(0,t.useEffect)((()=>{h()}),[]),(0,t.useEffect)((()=>{if(o.subject.length>3||o.message.length>10){const e=`${o.subject} ${o.message}`.toLowerCase(),t=[{question:"How do I reset my password?",answer:'Click on "Forgot Password" on the login page and follow the instructions sent to your email.',keywords:["password","reset","forgot","login","sign in","cannot access"]},{question:"How do I schedule an appointment?",answer:'Go to "Upcoming Appointments" and click "Schedule New Appointment".',keywords:["schedule","appointment","book","doctor","visit","consultation"]},{question:"How do I update my profile information?",answer:'Navigate to "Profile Settings" under the Account menu to edit your personal details.',keywords:["profile","update","change","information","details","personal"]},{question:"How do I export my health data?",answer:'Go to "Data Backup & Export" under the Account menu to download your information.',keywords:["export","download","data","backup","information","records"]},{question:"How do I join a telehealth consultation?",answer:'On the day of your appointment, go to "Telehealth Consultations" and click "Join Meeting".',keywords:["telehealth","virtual","video","call","consultation","join","meeting"]}].filter((t=>t.keywords.some((t=>e.includes(t)))));d(t.slice(0,3))}else d([])}),[o.subject,o.message]);const h=async()=>{try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:s}=await $e.from("detailed_profiles").select("*").eq("id",e.id).single();if(s)throw s;a(t)}catch(e){console.error("Error fetching user profile:",e),n({message:"Error fetching user profile.",type:"danger"})}},u=e=>{const{name:t,value:s}=e.target;l((e=>({...e,[t]:s})))};return(0,Pe.jsxs)("div",{className:"container mt-4",children:[i&&(0,Pe.jsx)("div",{className:`alert alert-${i.type} text-center`,children:i.message}),(0,Pe.jsxs)("h1",{className:"text-center mb-4",children:[(0,Pe.jsx)(Et,{className:"me-2"})," Contact Support"]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsx)("div",{className:"col-lg-8",children:(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-primary text-white",children:(0,Pe.jsx)("h2",{className:"mb-0",children:"Submit a Support Request"})}),(0,Pe.jsxs)("div",{className:"card-body",children:[c.length>0&&(0,Pe.jsxs)("div",{className:"alert alert-info mb-4",children:[(0,Pe.jsxs)("h5",{children:[(0,Pe.jsx)(Nt,{className:"me-2"})," Did you know?"]}),(0,Pe.jsx)("p",{children:"We found some help articles that might answer your question:"}),(0,Pe.jsx)("ul",{className:"mb-0",children:c.map(((e,t)=>(0,Pe.jsxs)("li",{children:[(0,Pe.jsx)("strong",{children:e.question})," - ",e.answer]},t)))})]}),(0,Pe.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),s(!0);try{const{data:{user:e}}=await $e.auth.getUser();if(!e)return void(window.location.href="/");let t=null;if(o.attachFile){const s=`${e.id}-${Date.now()}-${o.attachFile.name}`,{data:i,error:n}=await $e.storage.from("support-attachments").upload(s,o.attachFile);if(n)throw n;const{data:r}=$e.storage.from("support-attachments").getPublicUrl(s);t=r.publicUrl}const{error:s}=await $e.from("support_tickets").insert([{user_id:e.id,subject:o.subject,category:o.category,priority:o.priority,message:o.message,attachment_url:t,status:"open",created_at:(new Date).toISOString()}]);if(s)throw s;n({message:"Support ticket submitted successfully! Our team will respond shortly.",type:"success"}),l({subject:"",category:"general",priority:"medium",message:"",attachFile:null}),document.getElementById("attachFile").value=""}catch(t){console.error("Error submitting support ticket:",t),n({message:"Error submitting support ticket. Please try again.",type:"danger"})}finally{s(!1)}},children:[(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"subject",className:"form-label",children:"Subject"}),(0,Pe.jsx)("input",{type:"text",className:"form-control",id:"subject",name:"subject",value:o.subject,onChange:u,required:!0,placeholder:"Brief description of your issue"})]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"category",className:"form-label",children:"Category"}),(0,Pe.jsxs)("select",{className:"form-select",id:"category",name:"category",value:o.category,onChange:u,children:[(0,Pe.jsx)("option",{value:"general",children:"General Question"}),(0,Pe.jsx)("option",{value:"account",children:"Account Issues"}),(0,Pe.jsx)("option",{value:"appointments",children:"Appointments"}),(0,Pe.jsx)("option",{value:"medical",children:"Medical Records"}),(0,Pe.jsx)("option",{value:"telehealth",children:"Telehealth"}),(0,Pe.jsx)("option",{value:"technical",children:"Technical Problem"}),(0,Pe.jsx)("option",{value:"billing",children:"Billing & Payments"})]})]}),(0,Pe.jsxs)("div",{className:"col-md-6 mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"priority",className:"form-label",children:"Priority"}),(0,Pe.jsxs)("select",{className:"form-select",id:"priority",name:"priority",value:o.priority,onChange:u,children:[(0,Pe.jsx)("option",{value:"low",children:"Low - General Question"}),(0,Pe.jsx)("option",{value:"medium",children:"Medium - Need Help Soon"}),(0,Pe.jsx)("option",{value:"high",children:"High - Urgent Issue"})]})]})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"message",className:"form-label",children:"Message"}),(0,Pe.jsx)("textarea",{className:"form-control",id:"message",name:"message",rows:"6",value:o.message,onChange:u,required:!0,placeholder:"Please describe your issue in detail. Include any error messages or steps to reproduce the problem."})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{htmlFor:"attachFile",className:"form-label",children:"Attach File (optional)"}),(0,Pe.jsx)("input",{type:"file",className:"form-control",id:"attachFile",onChange:e=>{l((t=>({...t,attachFile:e.target.files[0]})))}}),(0,Pe.jsx)("div",{className:"form-text",children:"You can attach screenshots or documents to help explain your issue (max 5MB)."})]}),(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:e,children:e?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."]}):"Submit Support Request"})]})]})]})}),(0,Pe.jsxs)("div",{className:"col-lg-4",children:[(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-info text-white",children:(0,Pe.jsx)("h3",{className:"mb-0",children:"Contact Information"})}),(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,Pe.jsx)(gt,{className:"me-3 fs-4 text-primary"}),(0,Pe.jsxs)("div",{children:[(0,Pe.jsx)("h5",{className:"mb-0",children:"Email Support"}),(0,Pe.jsx)("p",{className:"mb-0",children:"support@digihealth.com"}),(0,Pe.jsx)("small",{className:"text-muted",children:"Response within 24 hours"})]})]}),(0,Pe.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,Pe.jsx)(Dt,{className:"me-3 fs-4 text-primary"}),(0,Pe.jsxs)("div",{children:[(0,Pe.jsx)("h5",{className:"mb-0",children:"Phone Support"}),(0,Pe.jsx)("p",{className:"mb-0",children:"1-800-DIGI-HEALTH"}),(0,Pe.jsx)("small",{className:"text-muted",children:"Mon-Fri, 9am-5pm EST"})]})]}),(0,Pe.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Pe.jsx)(ht,{className:"me-3 fs-4 text-primary"}),(0,Pe.jsxs)("div",{children:[(0,Pe.jsx)("h5",{className:"mb-0",children:"Live Chat"}),(0,Pe.jsx)("p",{className:"mb-0",children:(0,Pe.jsx)("a",{href:"/live-chat",className:"btn btn-sm btn-outline-primary mt-1",children:"Start Chat"})}),(0,Pe.jsx)("small",{className:"text-muted",children:"Available 24/7"})]})]})]})]}),(0,Pe.jsxs)("div",{className:"card shadow mb-4",children:[(0,Pe.jsx)("div",{className:"card-header bg-success text-white",children:(0,Pe.jsx)("h3",{className:"mb-0",children:"Support Resources"})}),(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,Pe.jsx)(Ft,{className:"me-3 fs-4 text-success"}),(0,Pe.jsxs)("div",{children:[(0,Pe.jsx)("h5",{className:"mb-0",children:"Help Center"}),(0,Pe.jsx)("p",{className:"mb-0",children:(0,Pe.jsx)("a",{href:"/help-center",className:"btn btn-sm btn-outline-success mt-1",children:"Browse FAQs"})})]})]}),(0,Pe.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Pe.jsx)(vt,{className:"me-3 fs-4 text-warning"}),(0,Pe.jsxs)("div",{children:[(0,Pe.jsx)("h5",{className:"mb-0",children:"System Status"}),(0,Pe.jsx)("p",{className:"mb-0",children:(0,Pe.jsx)("span",{className:"badge bg-success",children:"All Systems Operational"})})]})]})]})]})]})]})]})},ov=()=>{const{user:e}=De(),[s,i]=(0,t.useState)([]),[n,r]=(0,t.useState)(""),[a,o]=(0,t.useState)(!1),[l,c]=(0,t.useState)(!1),[d,h]=(0,t.useState)("connecting"),[u,p]=(0,t.useState)(null),f=(0,t.useRef)(null);(0,t.useEffect)((()=>(m(),()=>{chatSubscription&&chatSubscription.unsubscribe()})),[e]),(0,t.useEffect)((()=>{g()}),[s]);const m=async()=>{try{const{data:t,error:s}=await $e.from("chat_sessions").select("*").eq("user_id",e.id).eq("status","active").single();if(s&&"PGRST116"!==s.code)throw s;let n;if(t)n=t.id;else{const{data:t,error:s}=await $e.from("chat_sessions").insert([{user_id:e.id,status:"active",created_at:(new Date).toISOString()}]).select().single();if(s)throw s;n=t.id}const{data:r,error:a}=await $e.from("chat_messages").select("*").eq("session_id",n).order("created_at",{ascending:!0});if(a)throw a;i(r||[]);$e.channel("chat_messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`session_id=eq.${n}`},(e=>{i((t=>[...t,e.new]))})).subscribe();const{data:o,error:l}=await $e.from("support_agents").select("*").eq("status","online").single();if(l&&"PGRST116"!==l.code)throw l;o?(p(o),h("connected")):h("waiting")}catch(t){console.error("Error initializing chat:",t),h("error")}},g=()=>{var e;null===(e=f.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};return(0,Pe.jsx)("div",{className:"container-fluid h-100",children:(0,Pe.jsxs)("div",{className:"row h-100",children:[(0,Pe.jsxs)("div",{className:"col-md-3 p-0 border-end",children:[(0,Pe.jsxs)("div",{className:"p-3 border-bottom",children:[(0,Pe.jsx)("h5",{className:"mb-0",children:"Chat Information"}),(0,Pe.jsxs)("small",{className:"text-muted",children:["Status: ",(0,Pe.jsx)("span",{className:"text-"+("connected"===d?"success":"warning"),children:d.charAt(0).toUpperCase()+d.slice(1)})]})]}),u&&(0,Pe.jsxs)("div",{className:"p-3",children:[(0,Pe.jsx)("h6",{className:"mb-2",children:"Support Agent"}),(0,Pe.jsxs)("div",{className:"d-flex align-items-center",children:[(0,Pe.jsx)("div",{className:"avatar-circle me-2",children:u.name.charAt(0)}),(0,Pe.jsxs)("div",{children:[(0,Pe.jsx)("div",{className:"fw-bold",children:u.name}),(0,Pe.jsx)("small",{className:"text-muted",children:u.role})]})]})]})]}),(0,Pe.jsxs)("div",{className:"col-md-9 p-0 d-flex flex-column",children:[(0,Pe.jsxs)("div",{className:"flex-grow-1 p-3 overflow-auto",style:{height:"calc(100vh - 200px)"},children:[s.map(((t,s)=>(0,Pe.jsx)("div",{className:`d-flex ${t.user_id===e.id?"justify-content-end":"justify-content-start"} mb-3`,children:(0,Pe.jsx)("div",{className:"chat-message "+(t.user_id===e.id?"bg-primary text-white":"bg-light"),children:"text"===t.type?(0,Pe.jsx)("p",{className:"mb-0",children:t.message}):"image"===t.type?(0,Pe.jsx)("img",{src:`https://aqdzmfhakqdwquszaqle.supabase.co/storage/v1/object/public/chat-attachments/${t.attachment_url}`,alt:"Shared image",className:"img-fluid rounded",style:{maxWidth:"200px"}}):(0,Pe.jsxs)("a",{href:`https://aqdzmfhakqdwquszaqle.supabase.co/storage/v1/object/public/chat-attachments/${t.attachment_url}`,target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none",children:[(0,Pe.jsx)(wt,{className:"me-2"}),t.message]})})},s))),(0,Pe.jsx)("div",{ref:f})]}),(0,Pe.jsx)("div",{className:"p-3 border-top",children:(0,Pe.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),n.trim())try{const{data:t}=await $e.from("chat_sessions").select("id").eq("user_id",e.id).eq("status","active").single();if(!t)throw new Error("No active chat session");const{error:s}=await $e.from("chat_messages").insert([{session_id:t.id,user_id:e.id,message:n.trim(),type:"text",created_at:(new Date).toISOString()}]);if(s)throw s;r("")}catch(s){console.error("Error sending message:",s)}},className:"d-flex gap-2",children:[(0,Pe.jsx)("input",{type:"text",className:"form-control",placeholder:"Type your message...",value:n,onChange:e=>r(e.target.value),onFocus:()=>o(!0),onBlur:()=>o(!1)}),(0,Pe.jsxs)("label",{className:"btn btn-outline-primary",children:[(0,Pe.jsx)("input",{type:"file",className:"d-none",onChange:async t=>{const s=t.target.files[0];if(s)try{const t=s.name.split(".").pop(),i=`${Math.random()}.${t}`,n=`${e.id}/${i}`,{error:r}=await $e.storage.from("chat-attachments").upload(n,s);if(r)throw r;const{data:a}=await $e.from("chat_sessions").select("id").eq("user_id",e.id).eq("status","active").single();if(!a)throw new Error("No active chat session");const{error:o}=await $e.from("chat_messages").insert([{session_id:a.id,user_id:e.id,message:s.name,type:s.type.startsWith("image/")?"image":"file",attachment_url:n,created_at:(new Date).toISOString()}]);if(o)throw o}catch(i){console.error("Error uploading file:",i)}},accept:"image/*,.pdf,.doc,.docx"}),(0,Pe.jsx)(wt,{})]}),(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",children:(0,Pe.jsx)(Rt,{})})]})})]})]})})},lv=async e=>{const{data:{user:t}}=await Me.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:s,error:i}=await Me.from("detailed_profiles").upsert({...e,id:t.id});if(i)throw i;return s},cv=()=>{const[e,s]=(0,t.useState)({first_name:"",last_name:"",email:"",phone:"",address:"",bio:"",profile_picture:""}),[i,n]=(0,t.useState)([]),[r,a]=(0,t.useState)(""),[o,l]=(0,t.useState)([]),[c,d]=(0,t.useState)(""),[h,u]=(0,t.useState)(!0),[p,f]=(0,t.useState)(!1),[m,g]=(0,t.useState)("profile"),[v,b]=(0,t.useState)(!1),[y,x]=(0,t.useState)("");(0,t.useEffect)((()=>{(async()=>{try{const e=await(async()=>{const{data:{user:e}}=await Me.auth.getUser();if(!e)throw new Error("User not authenticated");const{data:t,error:s}=await Me.from("detailed_profiles").select("*").eq("id",e.id).single();if(s)throw s;return t})();s(e)}catch(e){console.error("Error fetching profile:",e)}finally{u(!1)}})(),(async()=>{try{const e=await(async()=>{const{data:{user:e}}=await Me.auth.getUser();if(!e)throw new Error("User not authenticated");const{data:t,error:s}=await Me.from("diseases").select("*").eq("user_id",e.id);if(s)throw s;return t.map((e=>e.name))})();n(e)}catch(e){console.error("Error fetching disease names:",e)}})(),(async()=>{try{const e=await(async()=>{const{data:{user:e}}=await Me.auth.getUser();if(!e)throw new Error("User not authenticated");const{data:t,error:s}=await Me.from("parameters").select("*").eq("user_id",e.id);if(s)throw s;return t.map((e=>e.name))})();l(e)}catch(e){console.error("Error fetching parameters:",e)}})()}),[]);const w=e=>{const{name:t,value:i}=e.target;s((e=>({...e,[t]:i})))};return h?(0,Pe.jsx)(is,{}):(0,Pe.jsxs)("div",{className:"profile-page container",children:[y&&(0,Pe.jsx)("div",{className:"alert alert-info",children:y}),(0,Pe.jsxs)("div",{className:"profile-header row",children:[(0,Pe.jsxs)("div",{className:"col-md-2",children:[(0,Pe.jsx)("img",{src:e.profile_picture||"/default-profile.png",alt:"Profile",className:"profile-picture img-fluid rounded-circle"}),p&&(0,Pe.jsx)("input",{type:"file",onChange:async t=>{const i=t.target.files[0];if(!i)return;b(!0);const{data:{user:n},error:r}=await $e.auth.getUser();if(r||!n)return console.error("User not authenticated",r),x("User not authenticated."),void b(!1);const a=`${n.id}`,{data:o,error:l}=await $e.storage.from("profile-pictures").upload(a,i,{upsert:!0});if(l)return console.error("Error uploading profile picture:",l),x("Error uploading profile picture."),void b(!1);const{data:c,error:d}=$e.storage.from("profile-pictures").getPublicUrl(a);if(d)return console.error("Error getting public URL:",d),x("Error getting public URL."),void b(!1);const h=c.publicUrl;try{await lv({...e,profile_picture:h}),s((e=>({...e,profile_picture:h}))),x("Profile picture updated successfully!")}catch(u){console.error("Error updating profile with new profile picture URL:",u),x("Error updating profile picture.")}finally{b(!1)}},className:"form-control mt-2"}),v&&(0,Pe.jsx)(is,{})]}),(0,Pe.jsx)("div",{className:"col-md-5 d-flex align-items-center justify-content-between",children:(0,Pe.jsxs)("h1",{children:[e.first_name," ",e.last_name]})}),(0,Pe.jsx)("div",{className:"col-md-5 d-flex align-items-center justify-content-between",children:(0,Pe.jsx)("button",{onClick:()=>f(!p),className:"btn btn-primary",children:p?"Cancel":"Edit Profile"})})]}),(0,Pe.jsxs)("div",{className:"navigation-buttons my-3",children:[(0,Pe.jsx)("button",{className:"btn btn-outline-primary "+("profile"===m?"active":""),onClick:()=>g("profile"),children:"Profile"}),(0,Pe.jsx)("button",{className:"btn btn-outline-primary "+("diseases"===m?"active":""),onClick:()=>g("diseases"),children:"Diseases"}),(0,Pe.jsx)("button",{className:"btn btn-outline-primary "+("parameters"===m?"active":""),onClick:()=>g("parameters"),children:"Parameters"})]}),"profile"===m&&(0,Pe.jsxs)("div",{className:"profile-details",children:[(0,Pe.jsxs)("div",{className:"profile-field",children:[(0,Pe.jsx)("label",{children:"First Name:"}),p?(0,Pe.jsx)("input",{type:"text",name:"first_name",value:e.first_name,onChange:w,className:"form-control"}):(0,Pe.jsx)("span",{children:e.first_name})]}),(0,Pe.jsxs)("div",{className:"profile-field",children:[(0,Pe.jsx)("label",{children:"Last Name:"}),p?(0,Pe.jsx)("input",{type:"text",name:"last_name",value:e.last_name,onChange:w,className:"form-control"}):(0,Pe.jsx)("span",{children:e.last_name})]}),(0,Pe.jsxs)("div",{className:"profile-field",children:[(0,Pe.jsx)("label",{children:"Email:"}),p?(0,Pe.jsx)("input",{type:"email",name:"email",value:e.email,onChange:w,className:"form-control"}):(0,Pe.jsx)("span",{children:e.email})]}),(0,Pe.jsxs)("div",{className:"profile-field",children:[(0,Pe.jsx)("label",{children:"Phone:"}),p?(0,Pe.jsx)("input",{type:"text",name:"phone",value:e.phone,onChange:w,className:"form-control"}):(0,Pe.jsx)("span",{children:e.phone})]}),(0,Pe.jsxs)("div",{className:"profile-field",children:[(0,Pe.jsx)("label",{children:"Address:"}),p?(0,Pe.jsx)("input",{type:"text",name:"address",value:e.address,onChange:w,className:"form-control"}):(0,Pe.jsx)("span",{children:e.address})]}),(0,Pe.jsxs)("div",{className:"profile-field",children:[(0,Pe.jsx)("label",{children:"Bio:"}),p?(0,Pe.jsx)("textarea",{name:"bio",value:e.bio,onChange:w,className:"form-control"}):(0,Pe.jsx)("span",{children:e.bio})]}),p&&(0,Pe.jsx)("button",{onClick:async()=>{u(!0);try{await lv(e),x("Profile updated successfully!")}catch(t){console.error("Error updating profile:",t),x("Error updating profile.")}finally{u(!1),f(!1)}},className:"btn btn-success mt-3",children:"Save Changes"})]}),"diseases"===m&&(0,Pe.jsxs)("div",{className:"disease-management",children:[(0,Pe.jsx)("h2",{children:"Disease Management"}),(0,Pe.jsx)("div",{className:"disease-list",children:i.map(((e,t)=>(0,Pe.jsx)("div",{className:"disease-item",children:e},t)))}),(0,Pe.jsx)("input",{type:"text",value:r,onChange:e=>a(e.target.value),placeholder:"Add new disease",className:"form-control"}),(0,Pe.jsx)("button",{onClick:async()=>{if(r.trim())try{await(async e=>{const{data:{user:t}}=await Me.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:s,error:i}=await Me.from("diseases").insert([{name:e,user_id:t.id}]);if(i)throw i;return s})(r),n([...i,r]),a(""),x("Disease added successfully!")}catch(e){console.error("Error adding disease name:",e),x("Error adding disease name.")}},className:"btn btn-primary mt-2",children:"Add Disease"})]}),"parameters"===m&&(0,Pe.jsxs)("div",{className:"parameter-management",children:[(0,Pe.jsx)("h2",{children:"Parameter Management"}),(0,Pe.jsx)("div",{className:"parameter-list",children:o.map(((e,t)=>(0,Pe.jsx)("div",{className:"parameter-item",children:e},t)))}),(0,Pe.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Add new parameter",className:"form-control"}),(0,Pe.jsx)("button",{onClick:async()=>{if(c.trim())try{await(async e=>{const{data:{user:t}}=await Me.auth.getUser();if(!t)throw new Error("User not authenticated");const{data:s,error:i}=await Me.from("parameters").insert([{name:e,user_id:t.id}]);if(i)throw i;return s})(c),l([...o,c]),d(""),x("Parameter added successfully!")}catch(e){console.error("Error adding parameter:",e),x("Error adding parameter.")}},className:"btn btn-primary mt-2",children:"Add Parameter"})]})]})},dv=()=>{const[e,s]=(0,t.useState)({twoFactorEnabled:!1,emailNotifications:!0,loginNotifications:!0,passwordExpiry:90,maxLoginAttempts:5}),[i,n]=(0,t.useState)(!1),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)(null);(0,t.useEffect)((()=>{c()}),[]);const c=async()=>{try{const{data:{user:e}}=await Me.auth.getUser();if(!e)return;const{data:t,error:i}=await Me.from("security_settings").select("*").eq("user_id",e.id).single();if(i)throw i;t&&s(t)}catch(r){a("Failed to load security settings")}},d=e=>{const{name:t,value:i,type:n,checked:r}=e.target;s((e=>({...e,[t]:"checkbox"===n?r:i})))};return(0,Pe.jsxs)("div",{className:"container mt-4",children:[(0,Pe.jsx)("h2",{className:"mb-4",children:"Security Settings"}),r&&(0,Pe.jsx)("div",{className:"alert alert-danger",role:"alert",children:r}),o&&(0,Pe.jsx)("div",{className:"alert alert-success",role:"alert",children:o}),(0,Pe.jsx)("div",{className:"card",children:(0,Pe.jsx)("div",{className:"card-body",children:(0,Pe.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),n(!0),a(null),l(null);try{const{data:{user:t}}=await Me.auth.getUser();if(!t)throw new Error("No user found");const{error:s}=await Me.from("security_settings").upsert({user_id:t.id,...e,updated_at:(new Date).toISOString()});if(s)throw s;l("Security settings updated successfully")}catch(r){a(r.message)}finally{n(!1)}},children:[(0,Pe.jsxs)("div",{className:"mb-4",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(Bt,{className:"me-2"}),"Two-Factor Authentication"]}),(0,Pe.jsxs)("div",{className:"form-check form-switch",children:[(0,Pe.jsx)("input",{className:"form-check-input",type:"checkbox",id:"twoFactorEnabled",name:"twoFactorEnabled",checked:e.twoFactorEnabled,onChange:d}),(0,Pe.jsx)("label",{className:"form-check-label",htmlFor:"twoFactorEnabled",children:"Enable two-factor authentication"})]})]}),(0,Pe.jsxs)("div",{className:"mb-4",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(Jt,{className:"me-2"}),"Login Security"]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{className:"form-label",children:"Maximum Login Attempts"}),(0,Pe.jsx)("input",{type:"number",className:"form-control",name:"maxLoginAttempts",value:e.maxLoginAttempts,onChange:d,min:"1",max:"10"})]}),(0,Pe.jsxs)("div",{className:"mb-3",children:[(0,Pe.jsx)("label",{className:"form-label",children:"Password Expiry (days)"}),(0,Pe.jsx)("input",{type:"number",className:"form-control",name:"passwordExpiry",value:e.passwordExpiry,onChange:d,min:"30",max:"365"})]})]}),(0,Pe.jsxs)("div",{className:"mb-4",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(kt,{className:"me-2"}),"Activity Notifications"]}),(0,Pe.jsxs)("div",{className:"form-check mb-2",children:[(0,Pe.jsx)("input",{className:"form-check-input",type:"checkbox",id:"emailNotifications",name:"emailNotifications",checked:e.emailNotifications,onChange:d}),(0,Pe.jsx)("label",{className:"form-check-label",htmlFor:"emailNotifications",children:"Email notifications for security events"})]}),(0,Pe.jsxs)("div",{className:"form-check",children:[(0,Pe.jsx)("input",{className:"form-check-input",type:"checkbox",id:"loginNotifications",name:"loginNotifications",checked:e.loginNotifications,onChange:d}),(0,Pe.jsx)("label",{className:"form-check-label",htmlFor:"loginNotifications",children:"Notify on new device login"})]})]}),(0,Pe.jsxs)("div",{className:"mb-4",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(Ct,{className:"me-2"}),"Password Management"]}),(0,Pe.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>{},children:"Change Password"})]}),(0,Pe.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?"Saving...":"Save Security Settings"})]})})})]})},hv=()=>{const[e,s]=(0,t.useState)([]),[i,n]=(0,t.useState)(!1),[r,a]=(0,t.useState)(null),[o,l]=(0,t.useState)(null);(0,t.useEffect)((()=>{c()}),[]);const c=async()=>{try{const{data:{user:e}}=await Me.auth.getUser();if(!e)return;const{data:t,error:i}=await Me.from("backup_history").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(i)throw i;s(t||[])}catch(r){a("Failed to load backup history")}};return(0,Pe.jsxs)("div",{className:"container mt-4",children:[(0,Pe.jsx)("h2",{className:"mb-4",children:"Data Backup & Restore"}),r&&(0,Pe.jsx)("div",{className:"alert alert-danger",role:"alert",children:r}),o&&(0,Pe.jsx)("div",{className:"alert alert-success",role:"alert",children:o}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsxs)("div",{className:"col-md-6",children:[(0,Pe.jsx)("div",{className:"card mb-4",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(ft,{className:"me-2"}),"Export Data"]}),(0,Pe.jsx)("p",{className:"card-text",children:"Download a backup of your health data, including profile information, health records, appointments, and medications."}),(0,Pe.jsx)("button",{className:"btn btn-primary",onClick:async()=>{n(!0),a(null),l(null);try{const{data:{user:e}}=await Me.auth.getUser();if(!e)throw new Error("No user found");const[{data:t},{data:s},{data:i},{data:n}]=await Promise.all([Me.from("profiles").select("*").eq("id",e.id).single(),Me.from("health_data").select("*").eq("user_id",e.id),Me.from("appointments").select("*").eq("user_id",e.id),Me.from("medications").select("*").eq("user_id",e.id)]),{data:r,error:a}=await Me.from("backup_history").insert([{user_id:e.id,type:"export",status:"completed",created_at:(new Date).toISOString()}]).select().single();if(a)throw a;const o={profile:t,healthData:s,appointments:i,medications:n,exportDate:(new Date).toISOString()},d=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),h=window.URL.createObjectURL(d),u=document.createElement("a");u.href=h,u.download=`digihealth-backup-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(u),u.click(),window.URL.revokeObjectURL(h),document.body.removeChild(u),l("Data exported successfully"),c()}catch(r){a(r.message)}finally{n(!1)}},disabled:i,children:i?"Exporting...":"Export Data"})]})}),(0,Pe.jsx)("div",{className:"card",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(Xt,{className:"me-2"}),"Import Data"]}),(0,Pe.jsx)("p",{className:"card-text",children:"Restore your health data from a previous backup file."}),(0,Pe.jsx)("input",{type:"file",className:"form-control mb-3",accept:".json",onChange:async e=>{const t=e.target.files[0];if(t){n(!0),a(null),l(null);try{const{data:{user:e}}=await Me.auth.getUser();if(!e)throw new Error("No user found");const s=new FileReader;s.onload=async t=>{try{const s=JSON.parse(t.target.result),{data:i,error:n}=await Me.from("backup_history").insert([{user_id:e.id,type:"import",status:"completed",created_at:(new Date).toISOString()}]).select().single();if(n)throw n;s.profile&&await Me.from("profiles").upsert({...s.profile,id:e.id}),s.healthData&&await Me.from("health_data").upsert(s.healthData.map((t=>({...t,user_id:e.id})))),s.appointments&&await Me.from("appointments").upsert(s.appointments.map((t=>({...t,user_id:e.id})))),s.medications&&await Me.from("medications").upsert(s.medications.map((t=>({...t,user_id:e.id})))),l("Data imported successfully"),c()}catch(r){a("Invalid backup file format")}},s.readAsText(t)}catch(r){a(r.message)}finally{n(!1)}}},disabled:i})]})})]}),(0,Pe.jsx)("div",{className:"col-md-6",children:(0,Pe.jsx)("div",{className:"card",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(kt,{className:"me-2"}),"Backup History"]}),(0,Pe.jsx)("div",{className:"table-responsive",children:(0,Pe.jsxs)("table",{className:"table",children:[(0,Pe.jsx)("thead",{children:(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("th",{children:"Date"}),(0,Pe.jsx)("th",{children:"Type"}),(0,Pe.jsx)("th",{children:"Status"})]})}),(0,Pe.jsx)("tbody",{children:e.map((e=>(0,Pe.jsxs)("tr",{children:[(0,Pe.jsx)("td",{children:new Date(e.created_at).toLocaleString()}),(0,Pe.jsxs)("td",{children:["export"===e.type?(0,Pe.jsx)(ft,{className:"me-1"}):(0,Pe.jsx)(Xt,{className:"me-1"}),e.type.charAt(0).toUpperCase()+e.type.slice(1)]}),(0,Pe.jsx)("td",{children:(0,Pe.jsx)("span",{className:"badge bg-"+("completed"===e.status?"success":"warning"),children:e.status})})]},e.id)))})]})})]})})})]})]})};var uv=s(985);const pv=()=>{const[e,s]=(0,t.useState)(!1),[i,n]=(0,t.useState)(null),[r,a]=(0,t.useState)([]),o=console.log,l=console.error,c=console.warn;return(0,Pe.jsx)("div",{className:"card",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(ut,{className:"me-2"}),"Database Setup"]}),(0,Pe.jsxs)("p",{className:"card-text",children:["This utility will delete all existing tables and buckets in your Supabase project and recreate them with the proper structure.",(0,Pe.jsx)("strong",{className:"text-danger",children:" Use with caution as this will delete all existing data!"})]}),i&&(0,Pe.jsxs)("div",{className:`alert ${i.success?"alert-success":"alert-danger"} mt-3`,role:"alert",children:[i.success?(0,Pe.jsx)(ot,{className:"me-2"}):(0,Pe.jsx)(vt,{className:"me-2"}),i.message]}),(0,Pe.jsx)("div",{className:"d-grid gap-2 mt-3",children:(0,Pe.jsx)("button",{className:"btn btn-danger",onClick:async()=>{s(!0),n(null),a([]),console.log=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];a((e=>[...e,{type:"info",message:t.join(" ")}])),o(...t)},console.error=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];a((e=>[...e,{type:"error",message:t.join(" ")}])),l(...t)},console.warn=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];a((e=>[...e,{type:"warning",message:t.join(" ")}])),c(...t)};try{const e=await(0,uv.setupSupabaseTables)();n(e)}catch(e){n({success:!1,message:`Unexpected error: ${e.message}`})}finally{console.log=o,console.error=l,console.warn=c,s(!1)}},disabled:e,children:e?(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)($t,{className:"me-2 fa-spin"}),"Setting up database..."]}):(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(ut,{className:"me-2"}),"Reset and Setup Database"]})})}),r.length>0&&(0,Pe.jsxs)("div",{className:"mt-4",children:[(0,Pe.jsx)("h6",{children:"Setup Logs:"}),(0,Pe.jsx)("div",{className:"border rounded p-3 bg-light",style:{maxHeight:"300px",overflow:"auto"},children:r.map(((e,t)=>(0,Pe.jsx)("div",{className:"mb-1 "+("error"===e.type?"text-danger":"warning"===e.type?"text-warning":""),children:e.message},t)))})]})]})})},fv=()=>{var e;const{user:t}=De();return t&&"admin"===(null===(e=t.user_metadata)||void 0===e?void 0:e.role)?(0,Pe.jsxs)("div",{className:"container py-4",children:[(0,Pe.jsxs)("h1",{className:"mb-4",children:[(0,Pe.jsx)(ut,{className:"me-2"}),"Database Management"]}),(0,Pe.jsxs)("div",{className:"alert alert-warning mb-4",role:"alert",children:[(0,Pe.jsx)(vt,{className:"me-2"}),(0,Pe.jsx)("strong",{children:"Warning:"})," This page is for administrators only. The actions performed here will affect all users of the application."]}),(0,Pe.jsxs)("div",{className:"row",children:[(0,Pe.jsx)("div",{className:"col-md-8",children:(0,Pe.jsx)(pv,{})}),(0,Pe.jsx)("div",{className:"col-md-4",children:(0,Pe.jsx)("div",{className:"card",children:(0,Pe.jsxs)("div",{className:"card-body",children:[(0,Pe.jsxs)("h5",{className:"card-title",children:[(0,Pe.jsx)(At,{className:"me-2"}),"Database Information"]}),(0,Pe.jsx)("p",{className:"card-text",children:"The setup process will create the following resources:"}),(0,Pe.jsxs)("h6",{className:"mt-3",children:[(0,Pe.jsx)(Vt,{className:"me-2"}),"Tables"]}),(0,Pe.jsxs)("ul",{className:"list-group mb-3",children:[(0,Pe.jsx)("li",{className:"list-group-item",children:"detailed_profiles"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"profiles"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"conditions"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"medications"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"appointments"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"telehealth_consultations"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"vitals"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"diseases"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"medical_reports"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"support_tickets"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"chat_sessions"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"chat_messages"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"alerts"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"security_settings"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"backup_history"})]}),(0,Pe.jsxs)("h6",{className:"mt-3",children:[(0,Pe.jsx)(_t,{className:"me-2"}),"Storage Buckets"]}),(0,Pe.jsxs)("ul",{className:"list-group",children:[(0,Pe.jsx)("li",{className:"list-group-item",children:"profile-pictures"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"medical-reports"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"health-reports"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"chat-attachments"}),(0,Pe.jsx)("li",{className:"list-group-item",children:"support-attachments"})]})]})})})]})]}):(0,Pe.jsx)(me,{to:"/dashboard"})};const mv=function(){return(0,Pe.jsx)(ke,{basename:"/DiGiHealthAdv",children:(0,Pe.jsx)(Ie,{children:(0,Pe.jsxs)(be,{children:[(0,Pe.jsx)(ge,{path:"/",element:(0,Pe.jsx)(He,{})}),(0,Pe.jsx)(ge,{path:"/register",element:(0,Pe.jsx)(ss,{})}),(0,Pe.jsx)(ge,{path:"/dashboard",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(vl,{})})}),(0,Pe.jsx)(ge,{path:"/health-overview",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(Bg,{})})}),(0,Pe.jsx)(ge,{path:"/medical-history",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)($g,{})})}),(0,Pe.jsx)(ge,{path:"/chronic-disease-management",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(Hg,{})})}),(0,Pe.jsx)(ge,{path:"/vaccination-history",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(Ug,{})})}),(0,Pe.jsx)(ge,{path:"/medication-tracker",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(Vg,{})})}),(0,Pe.jsx)(ge,{path:"/health-analytics",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(ev,{})})}),(0,Pe.jsx)(ge,{path:"/appointments/upcoming",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(tv,{})})}),(0,Pe.jsx)(ge,{path:"/appointments/history",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(sv,{})})}),(0,Pe.jsx)(ge,{path:"/appointments/telehealth",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(iv,{})})}),(0,Pe.jsx)(ge,{path:"/appointments/reminders",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(nv,{})})}),(0,Pe.jsx)(ge,{path:"/help-center",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(rv,{})})}),(0,Pe.jsx)(ge,{path:"/support/contact",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(av,{})})}),(0,Pe.jsx)(ge,{path:"/support/chat",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(ov,{})})}),(0,Pe.jsx)(ge,{path:"/profile",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(cv,{})})}),(0,Pe.jsx)(ge,{path:"/settings/security",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(dv,{})})}),(0,Pe.jsx)(ge,{path:"/settings/backup",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(hv,{})})}),(0,Pe.jsx)(ge,{path:"/admin/database-setup",element:(0,Pe.jsx)(Be,{children:(0,Pe.jsx)(fv,{})})})]})})})},gv=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function vv(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const s=e.installing;null!=s&&(s.onstatechange=()=>{"installed"===s.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}const bv=e=>{e&&e instanceof Function&&s.e(453).then(s.bind(s,453)).then((t=>{let{getCLS:s,getFID:i,getFCP:n,getLCP:r,getTTFB:a}=t;s(e),i(e),n(e),r(e),a(e)}))};n.createRoot(document.getElementById("root")).render((0,Pe.jsx)(t.StrictMode,{children:(0,Pe.jsx)(mv,{})})),function(e){if("serviceWorker"in navigator){if(new URL("/DiGiHealthAdv",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="/DiGiHealthAdv/service-worker.js";gv?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((s=>{const i=s.headers.get("content-type");404===s.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):vv(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):vv(t,e)}))}}(),bv()})()})();
//# sourceMappingURL=main.e02a0a5e.js.map