(this.webpackJsonpdigihealth=this.webpackJsonpdigihealth||[]).push([[0],{19:function(e,a,t){},2:function(e,a,t){"use strict";t.r(a),t.d(a,"supabase",(function(){return l}));var n=t(60);const l=Object(n.a)("https://aqdzmfhakqdwquszaqle.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ")},44:function(e,a,t){},51:function(e,a,t){},52:function(e,a,t){},59:function(e,a,t){const{supabase:n}=t(2);e.exports={createExecuteSqlFunction:async()=>{try{const e="\n      CREATE OR REPLACE FUNCTION execute_sql(sql text)\n      RETURNS void AS $$\n      BEGIN\n        EXECUTE sql;\n      END;\n      $$ LANGUAGE plpgsql SECURITY DEFINER;\n    ",{error:a}=await n.rpc("execute_sql",{sql:e});a&&console.warn("Warning: Could not create execute_sql function. It might already exist.")}catch(e){console.warn("Warning: Error creating execute_sql function:",e.message)}},insertSampleData:async()=>{try{console.log("Inserting sample data...");const e=[{name:"Hypertension",category:"Cardiovascular",description:"High blood pressure condition"},{name:"Diabetes",category:"Endocrine",description:"Blood sugar regulation disorder"},{name:"Asthma",category:"Respiratory",description:"Chronic respiratory condition"},{name:"Arthritis",category:"Musculoskeletal",description:"Joint inflammation condition"},{name:"Depression",category:"Mental Health",description:"Mood disorder"},{name:"Anxiety",category:"Mental Health",description:"Anxiety disorder"},{name:"Migraine",category:"Neurological",description:"Severe headache condition"},{name:"Allergies",category:"Immunological",description:"Immune system response"},{name:"Hypothyroidism",category:"Endocrine",description:"Underactive thyroid condition"},{name:"Hyperthyroidism",category:"Endocrine",description:"Overactive thyroid condition"}],{error:a}=await n.from("diseases").upsert(e);if(a)throw a;console.log("Sample data inserted successfully")}catch(e){throw console.error("Error inserting sample data:",e),e}},createStorageBuckets:async()=>{try{console.log("Creating storage buckets...");const a="\n      ALTER DATABASE postgres SET \"app.settings.storage.enabled\" TO 'true';\n    ";await n.rpc("execute_sql",{sql:a});const t=["profile-pictures","medical-reports","health-reports","chat-attachments","support-attachments"];for(const r of t)try{const{error:e}=await n.storage.createBucket(r,{public:!0});e&&!e.message.includes("already exists")&&console.warn(`Warning creating bucket ${r}:`,e.message)}catch(e){console.warn(`Error creating bucket ${r}:`,e.message)}const l="\n      DO $$ \n      BEGIN\n        CREATE POLICY \"Allow public access to profile pictures\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'profile-pictures');\n        \n        CREATE POLICY \"Allow public access to medical reports\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'medical-reports');\n        \n        CREATE POLICY \"Allow public access to health reports\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'health-reports');\n        \n        CREATE POLICY \"Allow public access to chat attachments\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'chat-attachments');\n        \n        CREATE POLICY \"Allow public access to support attachments\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'support-attachments');\n      EXCEPTION\n        WHEN others THEN\n          NULL;\n      END $$;\n    ";await n.rpc("execute_sql",{sql:l}),console.log("Storage buckets and policies created successfully")}catch(e){console.warn("Warning: Error setting up storage:",e.message)}}}},63:function(e,a,t){e.exports=t(91)},72:function(e,a,t){},73:function(e,a,t){},81:function(e,a,t){},82:function(e,a,t){},83:function(e,a,t){},87:function(e,a,t){},88:function(e,a,t){},89:function(e,a,t){},90:function(e,a,t){},91:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(54),s=t.n(r),c=(t(71),t(12),t(72),t(73),t(13)),i=t(6),o=t(2);const m=Object(n.createContext)();function d(){return Object(n.useContext)(m)}function u(e){let{children:a}=e;const[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(!0);Object(n.useEffect)(()=>{o.supabase.auth.getSession().then(e=>{var a;let{data:{session:t}}=e;r(null!==(a=null===t||void 0===t?void 0:t.user)&&void 0!==a?a:null),c(!1)});const{data:{subscription:e}}=o.supabase.auth.onAuthStateChange((e,a)=>{var t;r(null!==(t=null===a||void 0===a?void 0:a.user)&&void 0!==t?t:null),c(!1)});return()=>e.unsubscribe()},[]);const i={user:t,loading:s,signUp:e=>o.supabase.auth.signUp(e),signIn:e=>o.supabase.auth.signInWithPassword(e),signOut:()=>o.supabase.auth.signOut()};return l.a.createElement(m.Provider,{value:i},!s&&a)}var p=t(10);t(50);function E(){const e=document.querySelectorAll(".menu-item"),a=document.querySelector(".overlay");e.forEach(e=>{e.classList.remove("active");const a=e.querySelector(".sub-menu");a&&a.classList.remove("active")}),a&&a.classList.remove("active"),document.body.style.overflow=""}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("health-overview");e&&e.addEventListener("click",()=>{window.location.href="view-reports.html"})});t(81);var h=()=>{const e=Object(i.q)(),[a,t]=Object(n.useState)(!1),[r,s]=Object(n.useState)(null);Object(n.useEffect)(()=>{!function(){const e=document.querySelectorAll(".menu-item"),a=document.querySelector(".overlay");e.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=e.querySelector(".sub-menu");n&&(n.classList.toggle("active"),e.classList.toggle("active"),a&&a.classList.toggle("active"),document.body.style.overflow=n.classList.contains("active")?"hidden":"")})}),a&&a.addEventListener("click",E)}(),m(),d()},[]);const m=async()=>{try{var e;const{data:{user:a}}=await o.supabase.auth.getUser();a&&"admin"===(null===(e=a.user_metadata)||void 0===e?void 0:e.role)&&t(!0)}catch(a){console.error("Error checking user role:",a)}},d=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(e){const{data:a,error:t}=await o.supabase.from("detailed_profiles").select("first_name, last_name, profile_picture").eq("id",e.id).single();!t&&a&&s(a)}}catch(e){console.error("Error fetching user profile:",e)}},u=a=>{a.preventDefault();switch(a.currentTarget.id){case"health-overview":e("/health-overview");break;case"medical-history":e("/medical-history");break;case"chronic-disease-management":e("/chronic-disease-management");break;case"vaccination-history":e("/vaccination-history");break;case"health-analytics":e("/health-analytics");break;case"medication-tracker":e("/medication-tracker");break;case"profile-settings":e("/profile");break;case"upcoming-appointments":e("/appointments/upcoming");break;case"appointment-history":e("/appointments/history");break;case"telehealth-consultations":e("/appointments/telehealth");break;case"appointment-reminders":e("/appointments/reminders");break;case"help-center":e("/help-center");break;case"contact-support":e("/support/contact");break;case"live-chat":e("/support/chat");break;case"security-settings":e("/settings/security");break;case"data-backup":e("/settings/backup");break;case"database-setup":e("/admin/database-setup");break;case"logout-div":p()}},p=async()=>{try{const{error:a}=await o.supabase.auth.signOut();if(a)throw a;e("/")}catch(a){console.error("Error logging out:",a.message)}};return l.a.createElement("header",{className:"modern-navbar"},l.a.createElement("div",{className:"navbar-container"},l.a.createElement("div",{className:"navbar-logo"},l.a.createElement(c.b,{to:"/dashboard"},l.a.createElement("img",{src:"/DiGiHealthAdv/favicon_io/android-chrome-512x512-Photoroom.png",alt:"DigiHealth Logo",className:"logo-image"}))),l.a.createElement("nav",{id:"menu",className:"navbar-menu"},l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"Your Journey")),l.a.createElement("div",{className:"sub-menu double"},l.a.createElement("div",{className:"icon-box",id:"health-overview",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-hospital-user"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Health Overview"),l.a.createElement("div",{className:"sub-text"},"See, add and update your Journey"))),l.a.createElement("div",{className:"icon-box",id:"vaccination-history",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-syringe"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Vaccination History"),l.a.createElement("div",{className:"sub-text"},"View and manage vaccinations"))),l.a.createElement("div",{className:"icon-box",id:"medication-tracker",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-pills"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Medication Tracker"),l.a.createElement("div",{className:"sub-text"},"Track prescribed medications"))),l.a.createElement("div",{className:"icon-box",id:"health-analytics",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-chart-line"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Health Analytics"),l.a.createElement("div",{className:"sub-text"},"View your health trends"))))),l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"Appointments")),l.a.createElement("div",{className:"sub-menu double"},l.a.createElement("div",{className:"icon-box",id:"upcoming-appointments",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-calendar-check"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Upcoming Appointments"),l.a.createElement("div",{className:"sub-text"},"View and manage appointments"))),l.a.createElement("div",{className:"icon-box",id:"appointment-history",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-history"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Appointment History"),l.a.createElement("div",{className:"sub-text"},"Check past appointments"))),l.a.createElement("div",{className:"icon-box",id:"telehealth-consultations",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-phone-alt"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Telehealth Consultations"),l.a.createElement("div",{className:"sub-text"},"Book virtual appointments"))),l.a.createElement("div",{className:"icon-box",id:"appointment-reminders",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-clock"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Appointment Reminders"),l.a.createElement("div",{className:"sub-text"},"Set and manage reminders"))))),l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"Support")),l.a.createElement("div",{className:"sub-menu double"},l.a.createElement("div",{className:"icon-box",id:"help-center",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-book"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Help Center"),l.a.createElement("div",{className:"sub-text"},"FAQs and tutorials"))),l.a.createElement("div",{className:"icon-box",id:"contact-support",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-life-ring"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Contact Support"),l.a.createElement("div",{className:"sub-text"},"Reach out to our team"))),l.a.createElement("div",{className:"icon-box",id:"live-chat",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-comment-dots"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Live Chat"),l.a.createElement("div",{className:"sub-text"},"Chat with support agents"))))),l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"AI Tools")),l.a.createElement("div",{className:"sub-menu double"},l.a.createElement("div",{className:"icon-box",id:"ai-health-metrics",onClick:a=>{a.preventDefault(),e("/ai/health-metrics")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-chart-bar"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Health Metrics AI"),l.a.createElement("div",{className:"sub-text"},"Smart analysis of your health data"))),l.a.createElement("div",{className:"icon-box",id:"ai-symptom-checker",onClick:a=>{a.preventDefault(),e("/ai/symptom-checker")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-stethoscope"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Symptom Checker"),l.a.createElement("div",{className:"sub-text"},"AI-powered symptom analysis"))),l.a.createElement("div",{className:"icon-box",id:"ai-document-scanner",onClick:a=>{a.preventDefault(),e("/ai/document-scanner")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-file-medical-alt"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Document Scanner"),l.a.createElement("div",{className:"sub-text"},"Extract text from medical documents"))),l.a.createElement("div",{className:"icon-box",id:"ai-medication-identifier",onClick:a=>{a.preventDefault(),e("/ai/medication-identifier")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-pills"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Medication Identifier"),l.a.createElement("div",{className:"sub-text"},"Identify pills from images"))),l.a.createElement("div",{className:"icon-box",id:"ai-image-analysis",onClick:a=>{a.preventDefault(),e("/ai/image-analysis")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-microscope"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Medical Image Analysis"),l.a.createElement("div",{className:"sub-text"},"AI analysis of medical images"))),l.a.createElement("div",{className:"icon-box",id:"ai-health-assistant",onClick:a=>{a.preventDefault(),e("/ai/health-assistant")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-robot"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Health Assistant"),l.a.createElement("div",{className:"sub-text"},"AI health chat assistant")))))),l.a.createElement("div",{className:"navbar-profile"},l.a.createElement("div",{className:"profile-menu menu-item"},l.a.createElement("div",{className:"profile-button"},(null===r||void 0===r?void 0:r.profile_picture)?l.a.createElement("img",{src:r.profile_picture,alt:"Profile",className:"profile-image"}):l.a.createElement("div",{className:"profile-avatar"},l.a.createElement("i",{className:"fas fa-user"}))),l.a.createElement("div",{className:"sub-menu profile-dropdown"},l.a.createElement("div",{className:"profile-info"},l.a.createElement("div",{className:"profile-name"},r?`${r.first_name||""} ${r.last_name||""}`:"User")),l.a.createElement("div",{className:"icon-box",id:"profile-settings",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-user-cog"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Profile Settings"))),l.a.createElement("div",{className:"icon-box",id:"security-settings",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-shield-alt"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Security Settings"))),l.a.createElement("div",{className:"icon-box",id:"data-backup",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-database"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Data Backup"))),a&&l.a.createElement("div",{className:"icon-box",id:"database-setup",onClick:u},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-server"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Database Setup"))),l.a.createElement("div",{className:"icon-box logout",id:"logout-div",onClick:p},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-sign-out-alt"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Logout"))))))))};t(82);var g=()=>l.a.createElement("footer",{className:"modern-footer"},l.a.createElement("div",{className:"footer-content"},l.a.createElement("div",{className:"footer-info"},l.a.createElement("p",null,"\xa9 ",(new Date).getFullYear()," DiGiHealth. All rights reserved.")),l.a.createElement("div",{className:"footer-links"},l.a.createElement("a",{href:"/terms"},"Terms"),l.a.createElement("a",{href:"/privacy"},"Privacy"),l.a.createElement("a",{href:"/support"},"Support"))));t(51);var b=e=>{let{children:a}=e;return l.a.createElement("div",{className:"dashboard-layout"},l.a.createElement(h,null),l.a.createElement("main",{className:"dashboard-main"},l.a.createElement("div",{className:"content-wrapper"},a)),l.a.createElement(g,null))};t(19),t(52);var f=()=>{const[e,a]=Object(n.useState)(!1),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(""),[m,d]=Object(n.useState)(""),[u,p]=Object(n.useState)(""),[E,h]=Object(n.useState)(""),[g,b]=Object(n.useState)(""),[f,y]=Object(n.useState)(""),[N,v]=Object(n.useState)(""),w=Object(i.q)(),_=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";console.log(`Notification: ${e}, Type: ${a}`),r({message:e,type:a}),setTimeout(()=>r(null),3e3)},x=t=>{t&&t.preventDefault(),a(!e)};return l.a.createElement("div",{id:"app",className:"auth-container"},l.a.createElement("header",{className:"auth-header"},l.a.createElement("img",{src:"/DiGiHealthAdv/favicon_io/android-chrome-512x512-Photoroom.png",alt:"Logo",className:"logo",style:{width:"200px",height:"auto"}})),t&&l.a.createElement("div",{className:`alert alert-${t.type} alert-dismissible fade show`,role:"alert"},t.message),l.a.createElement("div",{id:"login-signup",className:e?"signup-mode":"login-mode"},e?l.a.createElement("div",{id:"signup-form",className:"active"},l.a.createElement("form",{className:"form",onSubmit:async e=>{if(e.preventDefault(),f===N)try{const{data:e,error:t}=await o.supabase.auth.signUp({email:g,password:f,options:{data:{first_name:u,last_name:E}}});if(t)throw t;if(e.user){const{error:a}=await o.supabase.from("detailed_profiles").insert([{id:e.user.id,first_name:u,last_name:E,email:g,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}]);if(a)throw a}_("Account created successfully!","success"),a(!1)}catch(t){console.error("Signup error:",t.message),_(t.message,"danger")}else _("Passwords don't match","error")}},l.a.createElement("p",{className:"message"},"Signup now"),l.a.createElement("div",{className:"flex"},l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"firstname",type:"text",className:"input",placeholder:" ",value:u,onChange:e=>p(e.target.value)}),l.a.createElement("span",null,"Firstname")),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"lastname",type:"text",className:"input",placeholder:" ",value:E,onChange:e=>h(e.target.value)}),l.a.createElement("span",null,"Lastname"))),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"email",type:"email",className:"input",id:"signup-email",placeholder:" ",value:g,onChange:e=>b(e.target.value)}),l.a.createElement("span",null,"Email")),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"password",type:"password",className:"input",id:"signup-password",placeholder:" ",value:f,onChange:e=>y(e.target.value)}),l.a.createElement("span",null,"Password")),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"confirmPassword",type:"password",className:"input",placeholder:" ",value:N,onChange:e=>v(e.target.value)}),l.a.createElement("span",null,"Confirm password")),l.a.createElement("button",{type:"submit",className:"submit"},"Sign Up"),l.a.createElement("div",{className:"signin"},l.a.createElement("span",null,"Already have an account?"),l.a.createElement("a",{href:"#",onClick:x,className:"signin-link"},"Sign in")))):l.a.createElement("div",{id:"login-form",className:"active"},l.a.createElement("h2",null,"Login"),l.a.createElement("form",{className:"form1",onSubmit:async e=>{e.preventDefault();try{const{error:e}=await o.supabase.auth.signInWithPassword({email:s,password:m});if(e)throw e;_("Login successful!","success"),setTimeout(()=>{w("/dashboard")},3e3)}catch(a){console.error("Login error:",a.message),_(a.message,"danger")}}},l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"email",type:"email",className:"input",id:"login-email",autoComplete:"new-password",value:s,onChange:e=>c(e.target.value),placeholder:" "}),l.a.createElement("span",null,"Email")),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"password",type:"password",className:"input",id:"login-password",autoComplete:"login-password",value:m,onChange:e=>d(e.target.value),placeholder:" "}),l.a.createElement("span",null,"Password")),l.a.createElement("div",null,l.a.createElement("button",{type:"submit",id:"login-button"},"Login"),l.a.createElement("button",{type:"button",onClick:x},"Sign Up"))))))},y=t(1);var N=()=>{const e=Object(i.q)(),[a,t]=Object(n.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",role:"patient"}),[r,s]=Object(n.useState)(null),[c,m]=Object(n.useState)(!1),d=e=>{t({...a,[e.target.name]:e.target.value})};return l.a.createElement("div",{className:"container mt-5"},l.a.createElement("div",{className:"row justify-content-center"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"card shadow"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h2",{className:"text-center mb-4"},"Register"),r&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},r),l.a.createElement("form",{onSubmit:async t=>{if(t.preventDefault(),s(null),m(!0),a.password!==a.confirmPassword)return s("Passwords do not match"),void m(!1);try{const{data:t,error:n}=await o.supabase.auth.signUp({email:a.email,password:a.password,options:{data:{first_name:a.firstName,last_name:a.lastName,role:a.role}}});if(n)throw n;if(t.user){const{error:e}=await o.supabase.from("detailed_profiles").insert([{id:t.user.id,first_name:a.firstName,last_name:a.lastName,email:a.email,created_at:(new Date).toISOString()}]);if(e)throw e;const{error:n}=await o.supabase.from("profiles").insert([{id:t.user.id,full_name:`${a.firstName} ${a.lastName}`,email:a.email,role:a.role,created_at:(new Date).toISOString()}]);if(n)throw n}e("/dashboard")}catch(r){s(r.message)}finally{m(!1)}}},l.a.createElement("div",{className:"row mb-3"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("label",{className:"form-label"},"First Name"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(y.ib,null)),l.a.createElement("input",{type:"text",className:"form-control",name:"firstName",value:a.firstName,onChange:d,required:!0}))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("label",{className:"form-label"},"Last Name"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(y.ib,null)),l.a.createElement("input",{type:"text",className:"form-control",name:"lastName",value:a.lastName,onChange:d,required:!0})))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Email"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(y.r,null)),l.a.createElement("input",{type:"email",className:"form-control",name:"email",value:a.email,onChange:d,required:!0}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Password"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(y.J,null)),l.a.createElement("input",{type:"password",className:"form-control",name:"password",value:a.password,onChange:d,required:!0}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Confirm Password"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(y.J,null)),l.a.createElement("input",{type:"password",className:"form-control",name:"confirmPassword",value:a.confirmPassword,onChange:d,required:!0}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Role"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(y.kb,null)),l.a.createElement("select",{className:"form-select",name:"role",value:a.role,onChange:d},l.a.createElement("option",{value:"patient"},"Patient"),l.a.createElement("option",{value:"doctor"},"Doctor"),l.a.createElement("option",{value:"admin"},"Admin")))),l.a.createElement("button",{type:"submit",className:"btn btn-primary w-100",disabled:c},c?"Registering...":"Register")),l.a.createElement("div",{className:"text-center mt-3"},"Already have an account?"," ",l.a.createElement("a",{href:"/",className:"text-decoration-none"},"Login")))))))};t(83);var v=()=>l.a.createElement("div",{className:"spinner-overlay"},l.a.createElement("div",{className:"medical-spinner"},l.a.createElement("div",{className:"spinner-container"},l.a.createElement("div",{className:"cross-container"},l.a.createElement("div",{className:"cross-horizontal"}),l.a.createElement("div",{className:"cross-vertical"})),l.a.createElement("div",{className:"spinner-ring"})),l.a.createElement("div",{className:"heartbeat-container"},l.a.createElement("svg",{viewBox:"0 0 400 100",className:"ecg-line"},l.a.createElement("polyline",{className:"ecg-path",points:"0,50 30,50 45,50 60,20 75,80 90,50 105,50 120,50 150,50 170,50 185,50 200,20 215,80 230,50 245,50 270,50 300,50 320,50 335,50 350,20 365,80 380,50 395,50 400,50",fill:"none",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}))),l.a.createElement("div",{className:"spinner-text"},"Loading..."))),w=t(94),_=t(95),x=t(101),S=t(100),k=t(99),C=t(57);var A=e=>{let{size:a=140,showDownloadButton:t=!0,showHeader:r=!0,showOptions:s=!0,showCard:c=!0,onClick:m=null}=e;const{user:u}=d(),p=Object(i.q)(),[E,h]=Object(n.useState)(null),[g,b]=Object(n.useState)(!0),[f,N]=Object(n.useState)(""),[v,A]=Object(n.useState)(!0),[O,I]=Object(n.useState)(!0),[T,D]=Object(n.useState)(!0),[j,R]=Object(n.useState)(!0),[F,L]=Object(n.useState)(null);Object(n.useEffect)(()=>{console.log("EmergencyQRCode mounted, user:",u?"ID: "+u.id:"No user"),P()},[u]),Object(n.useEffect)(()=>{E&&q()},[E,v,O,T,j]);const P=async()=>{b(!0);try{if(!u)return console.error("No user is logged in"),void b(!1);const{data:e,error:a}=await o.supabase.from("detailed_profiles").select("*").eq("id",u.id).single();if(a){if(console.error("Error fetching profile:",a),"PGRST116"!==a.code)throw a;console.log("Creating new profile for user:",u.id)}const{data:t,error:n}=await o.supabase.from("user_allergies").select("*").eq("user_id",u.id);if(n)throw n;const{data:l,error:r}=await o.supabase.from("user_diseases").select("*").eq("user_id",u.id);if(r)throw r;const{data:s,error:c}=await o.supabase.from("medications").select("*").eq("user_id",u.id);if(c)throw c;h({...e,allergies:t||[],diseases:l||[],medications:s||[]}),console.log("Profile data loaded:",e)}catch(F){console.error("Error fetching profile data:",F)}finally{b(!1)}},q=()=>{if(!E)return;console.log("Generating QR data from profile:",E);let e={name:E.first_name&&E.last_name?`${E.first_name} ${E.last_name}`:"Unknown",dob:E.date_of_birth||"Unknown",bloodType:E.blood_group||"Unknown",weight:E.weight?E.weight+" kg":"Unknown",height:E.height?E.height+" cm":"Unknown"};v&&E.allergies&&E.allergies.length>0&&(e.allergies=E.allergies.map(e=>e.allergy_name||e.name)),O&&E.diseases&&E.diseases.length>0&&(e.conditions=E.diseases.map(e=>e.disease_name||e.name)),T&&E.emergency_contact_name&&(e.emergencyContact={name:E.emergency_contact_name,phone:E.emergency_contact_phone,relationship:E.emergency_contact_relationship}),j&&E.medications&&E.medications.length>0&&(e.medications=E.medications.map(e=>({name:e.name,dosage:e.daily_dose?e.daily_dose+" tablets daily":"As prescribed"})));const a=JSON.stringify(e);console.log("QR data generated:",a),N(a)},U=()=>{p("/profile?section=emergency-qr")};if(g)return l.a.createElement("div",{className:"text-center"},l.a.createElement(w.a,{animation:"border",role:"status",size:"sm"},l.a.createElement("span",{className:"visually-hidden"},"Loading...")));const M=l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"qrcode-container p-2 bg-light rounded "+(m?"cursor-pointer":""),onClick:m||(c?null:()=>U()),style:{display:"flex",justifyContent:"center",alignItems:"center",height:a+20,width:a+20,margin:"0 auto"}},f?l.a.createElement(C.a,{id:"emergency-qrcode",value:f,size:a,level:"H",includeMargin:!0}):l.a.createElement("div",{style:{width:a,height:a},className:"d-flex justify-content-center align-items-center border rounded"},l.a.createElement("div",{className:"text-center p-2"},l.a.createElement(y.R,{size:a/3,className:"text-muted mb-2"}),l.a.createElement("p",{className:"small text-muted mb-0"},"Set up your profile to create emergency QR")))),t&&f&&l.a.createElement("div",{className:"mt-3 d-flex flex-wrap gap-2 justify-content-center"},l.a.createElement(_.a,{variant:"primary",size:"sm",className:"d-flex align-items-center",onClick:()=>{const e=document.getElementById("emergency-qrcode");if(e)try{const a=e.toDataURL("image/png"),t=document.createElement("a");t.href=a,t.download="emergency-medical-id.png",document.body.appendChild(t),t.click(),document.body.removeChild(t)}catch(F){console.error("Error downloading QR code:",F)}}},l.a.createElement(y.p,{className:"me-1"})," Download QR Code")));return c?l.a.createElement("div",{className:"my-4"},l.a.createElement(x.a,{className:"shadow"},r&&l.a.createElement(x.a.Header,{className:"bg-primary text-white d-flex justify-content-between align-items-center"},l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement(y.R,{className:"me-2"}),l.a.createElement("h5",{className:"mb-0"},"Emergency Medical QR Code")),l.a.createElement(_.a,{variant:"outline-light",size:"sm",className:"d-flex align-items-center",onClick:U},l.a.createElement(y.q,{className:"me-1"})," Manage")),l.a.createElement(x.a.Body,{className:"d-flex flex-column align-items-center"},r&&l.a.createElement("div",{className:"text-center mb-3"},l.a.createElement("p",null,"This QR code contains your essential medical information for emergency situations.")),M,s&&l.a.createElement("div",{className:"mt-4 w-100"},l.a.createElement("h6",null,"Information Included:"),l.a.createElement(S.a,null,l.a.createElement("div",{className:"d-flex flex-wrap gap-3"},l.a.createElement(S.a.Check,{type:"switch",id:"include-allergies",label:"Allergies",checked:v,onChange:e=>A(e.target.checked)}),l.a.createElement(S.a.Check,{type:"switch",id:"include-diseases",label:"Medical Conditions",checked:O,onChange:e=>I(e.target.checked)}),l.a.createElement(S.a.Check,{type:"switch",id:"include-contacts",label:"Emergency Contacts",checked:T,onChange:e=>D(e.target.checked)}),l.a.createElement(S.a.Check,{type:"switch",id:"include-medications",label:"Medications",checked:j,onChange:e=>R(e.target.checked)})))),l.a.createElement(k.a,{variant:"info",className:"mt-3"},l.a.createElement("small",null,"Keep your profile information up-to-date for effective emergency response."))))):M};var O=()=>{var e;const a=Object(i.q)(),{user:t}=d(),[r,s]=Object(n.useState)(null),[m,u]=Object(n.useState)(!0),[p,E]=Object(n.useState)({vitals:[],medications:[],appointments:[],conditions:[],alerts:[],profile:null}),[h,g]=Object(n.useState)(null);Object(n.useEffect)(()=>{(async()=>{try{const{data:{user:e},error:t}=await o.supabase.auth.getUser();if(t||!e)return void a("/");const{data:n,error:l}=await o.supabase.from("detailed_profiles").select("*").eq("id",e.id).single();if(l){if("PGRST116"!==l.code)throw l;{const{data:a,error:t}=await o.supabase.from("detailed_profiles").insert([{id:e.id}]).select().single();if(t)throw t;E(e=>({...e,profile:a}))}}else E(e=>({...e,profile:n}))}catch(h){console.error("Error fetching data:",h),g("Failed to load dashboard data")}finally{u(!1)}})()},[a]);const b=[{title:"Profile",icon:"fa-user",description:"View and manage your profile information",link:"/profile",color:"primary"},{title:"Health Records",icon:"fa-file-medical",description:"Access your health records and history",link:"/health-records",color:"info"},{title:"Appointments",icon:"fa-calendar-check",description:"Schedule and manage appointments",link:"/appointments",color:"success"},{title:"Medications",icon:"fa-pills",description:"Track your medications and prescriptions",link:"/medications",color:"warning"}];return m?l.a.createElement(v,null):h?l.a.createElement("div",{className:"alert alert-danger"},h):l.a.createElement("div",{className:"container-fluid py-4"},l.a.createElement("div",{className:"row mb-4"},l.a.createElement("div",{className:"col"},l.a.createElement("h1",{className:"h3"},"Welcome, ",(null===(e=p.profile)||void 0===e?void 0:e.first_name)||"User","!"),l.a.createElement("p",{className:"text-muted"},"Here's an overview of your health information"))),l.a.createElement("div",{className:"row g-4 mb-5"},l.a.createElement("h4",{className:"mb-3"},"Main Features"),b.slice(0,3).map((e,a)=>l.a.createElement("div",{key:a,className:"col-12 col-md-6 col-lg-3"},l.a.createElement(c.b,{to:e.link,className:"text-decoration-none h-100"},l.a.createElement("div",{className:`card hover-card border-${e.color} h-100`},l.a.createElement("div",{className:"card-body d-flex flex-column"},l.a.createElement("div",{className:"d-flex align-items-center mb-2"},l.a.createElement("div",{className:`icon-circle bg-${e.color} text-white`},l.a.createElement("i",{className:"fas "+e.icon})),l.a.createElement("h5",{className:"card-title mb-0 ms-3"},e.title)),l.a.createElement("p",{className:"card-text text-muted flex-grow-1"},e.description)))))),l.a.createElement("div",{className:"col-12 col-md-6 col-lg-3"},l.a.createElement(x.a,{className:"hover-card border-danger h-100"},l.a.createElement(x.a.Body,{className:"d-flex flex-column"},l.a.createElement("div",{className:"d-flex align-items-center mb-2"},l.a.createElement("div",{className:"icon-circle bg-danger text-white"},l.a.createElement(y.R,null)),l.a.createElement("h5",{className:"card-title mb-0 ms-3"},"Emergency QR")),l.a.createElement("div",{className:"d-flex flex-column align-items-center justify-content-center flex-grow-1"},t?l.a.createElement(l.a.Fragment,null,l.a.createElement(A,{size:110,showDownloadButton:!1,showHeader:!1,showOptions:!1,showCard:!1,onClick:()=>a("/profile?section=emergency-qr")})):l.a.createElement("div",{className:"text-center"},l.a.createElement(v,{animation:"border",role:"status",size:"sm"},l.a.createElement("span",{className:"visually-hidden"},"Loading...")),l.a.createElement("p",{className:"text-muted small mt-2"},"Loading user data..."))))))),l.a.createElement("div",{className:"row g-4 mb-5"},l.a.createElement("div",{className:"col-12 col-md-6 col-lg-3"},l.a.createElement(c.b,{to:b[3].link,className:"text-decoration-none h-100"},l.a.createElement("div",{className:`card hover-card border-${b[3].color} h-100`},l.a.createElement("div",{className:"card-body d-flex flex-column"},l.a.createElement("div",{className:"d-flex align-items-center mb-2"},l.a.createElement("div",{className:`icon-circle bg-${b[3].color} text-white`},l.a.createElement("i",{className:"fas "+b[3].icon})),l.a.createElement("h5",{className:"card-title mb-0 ms-3"},b[3].title)),l.a.createElement("p",{className:"card-text text-muted flex-grow-1"},b[3].description))))),l.a.createElement("div",{className:"col-12 col-md-6 col-lg-9"})),l.a.createElement("h4",{className:"mb-3"},"AI-Powered Features"),l.a.createElement("div",{className:"row g-4 mb-5"},[{title:"Health Recommendations",icon:"fa-chart-line",description:"AI-powered health recommendations based on your profile",link:"/ai/health-recommendations",color:"primary"},{title:"Medical Image Analysis",icon:"fa-microscope",description:"AI analysis of medical images",link:"/ai/image-analysis",color:"info"},{title:"Health Assistant",icon:"fa-robot",description:"Chat with our AI health assistant",link:"/ai/health-assistant",color:"success"},{title:"Symptom Checker",icon:"fa-stethoscope",description:"AI-powered symptom analysis",link:"/ai/symptom-checker",color:"danger"},{title:"Document Scanner",icon:"fa-file-medical-alt",description:"Extract text from medical documents with AI",link:"/ai/document-scanner",color:"warning"},{title:"Medication Identifier",icon:"fa-pills",description:"Identify medications from images",link:"/ai/medication-identifier",color:"secondary"}].map((e,a)=>l.a.createElement("div",{key:a,className:"col-12 col-md-6 col-lg-3"},l.a.createElement(c.b,{to:e.link,className:"text-decoration-none h-100"},l.a.createElement("div",{className:`card hover-card border-${e.color} h-100`},l.a.createElement("div",{className:"card-body d-flex flex-column"},l.a.createElement("div",{className:"d-flex align-items-center mb-2"},l.a.createElement("div",{className:`icon-circle bg-${e.color} text-white`},l.a.createElement("i",{className:"fas "+e.icon})),l.a.createElement("h5",{className:"card-title mb-0 ms-3"},e.title)),l.a.createElement("p",{className:"card-text text-muted flex-grow-1"},e.description),a>=4&&l.a.createElement("div",{className:"position-absolute top-0 end-0 mt-2 me-2"},l.a.createElement("span",{className:"badge bg-danger"},"New")))))))))},I=t(96),T=t(97),D=t(58),j=t(98);var R=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(!1),[m,d]=Object(n.useState)({disease_id:"",since:"",file:null}),[u,p]=Object(n.useState)(null),[E,h]=Object(n.useState)(null),[g,b]=Object(n.useState)(null),[f,y]=Object(n.useState)(!1),[N,w]=Object(n.useState)([]),[k,C]=Object(n.useState)({}),[A,O]=Object(n.useState)(!1),[R,F]=Object(n.useState)(null),L=Object(i.q)(),P=Object(n.useCallback)((function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;g&&(clearTimeout(g),b(null)),h({message:e,type:a});const n=setTimeout(()=>{h(null),b(null)},t);b(n)}),[g]),q=Object(n.useCallback)(async e=>{const{data:a,error:t}=await o.supabase.from("user_diseases").select("*").eq("user_id",e);t||w(a)},[]),U=Object(n.useCallback)(async e=>{y(!0);try{const{data:t,error:n}=await o.supabase.from("healthrecords").select("\n          *,\n          user_diseases(disease_name)\n        ").eq("user_id",e);if(n)return console.error("Error fetching health data:",n),void P("Error loading health data: "+n.message,"danger");a(t)}catch(t){console.error("Exception fetching health data:",t),P("Error: "+t.message,"danger")}finally{y(!1)}},[P]);Object(n.useEffect)(()=>{(async()=>{y(!0);const{data:{user:e},error:a}=await o.supabase.auth.getUser();a||(e&&(r(e.id),U(e.id),q(e.id)),y(!1))})()},[U,q]);Object(n.useEffect)(()=>()=>{g&&clearTimeout(g)},[g]);return l.a.createElement(I.a,{className:"py-4"},f&&l.a.createElement(v,null),E&&l.a.createElement("div",{className:`alert alert-${E.type} position-fixed d-flex justify-content-between align-items-center`,style:{top:"20px",right:"20px",zIndex:1050,minWidth:"300px",maxWidth:"500px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},role:"alert"},l.a.createElement("span",null,E.message),l.a.createElement("button",{type:"button",className:"btn-close ms-3",onClick:()=>h(null),"aria-label":"Close"})),l.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},l.a.createElement("h2",{className:"text-primary"},"Health Reports"),l.a.createElement(_.a,{variant:"primary",onClick:()=>c(!0)},"+ Upload Report")),l.a.createElement(T.a,{className:"g-4"},e.map(e=>{var a;return l.a.createElement(D.a,{md:4,sm:6,key:e.id},l.a.createElement(x.a,{className:"shadow-sm border-0 hover-card h-100"},l.a.createElement(x.a.Body,{className:"p-4 d-flex flex-column"},l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement("div",{className:"icon-circle bg-primary text-white me-3"},l.a.createElement("i",{className:"fas fa-file-medical"})),l.a.createElement("div",null,l.a.createElement(x.a.Title,{className:"mb-1"},null===(a=e.user_diseases)||void 0===a?void 0:a.disease_name),l.a.createElement(x.a.Text,{className:"text-muted mb-0"},"Since: ",new Date(e.since).toLocaleDateString()))),l.a.createElement("div",{className:"mt-auto pt-3 d-flex justify-content-end gap-2"},l.a.createElement(_.a,{variant:"outline-danger",size:"sm",onClick:()=>{return a=e.id,F(a),void O(!0);var a},className:"d-flex align-items-center"},l.a.createElement("i",{className:"fas fa-trash me-1"})," Delete"),l.a.createElement(_.a,{variant:"outline-primary",size:"sm",onClick:()=>window.open(e.document_url,"_blank"),className:"d-flex align-items-center"},l.a.createElement("i",{className:"fas fa-eye me-1"})," View")))))})),l.a.createElement(j.a,{show:s,onHide:()=>c(!1),centered:!0,size:"md"},l.a.createElement(j.a.Header,{closeButton:!0,className:"border-bottom-0 pb-0"},l.a.createElement(j.a.Title,{className:"h4 fw-bold text-dark"},"Upload New Health Report")),l.a.createElement(j.a.Body,{className:"pt-4"},l.a.createElement(S.a,{onSubmit:async e=>{e.preventDefault(),y(!0);try{var a,n,l,r,s,i;if(!m.file)throw new Error("Please select a file to upload");if(!m.disease_id)throw new Error("Please select a disease");if(!m.since)throw new Error("Please select a date");const e=m.file.name.split(".").pop(),u=`${t}/${Date.now()}.${e}`,{data:E,error:h}=await o.supabase.storage.from("health-reports").upload(u,m.file);if(h)throw console.error("Supabase storage upload error:",h),new Error("Error uploading file: "+h.message);const{data:{publicUrl:g}}=o.supabase.storage.from("health-reports").getPublicUrl(u),b={user_id:t,disease_id:m.disease_id,since:m.since,document_url:g,created_at:(new Date).toISOString(),ai_summary:(null===k||void 0===k||null===(a=k.aiAnalysis)||void 0===a?void 0:a.summary)?String(k.aiAnalysis.summary).substring(0,255):"No summary available"},{data:f,error:N}=await o.supabase.from("healthrecords").insert([b]).select().single();if(N)throw console.error("Error inserting report data:",N),new Error("Error saving report: "+N.message);if((null===k||void 0===k?void 0:k.parameters)&&Object.keys(k.parameters).length>0){const e=Object.entries(k.parameters).map(e=>{let[a,n]=e;return{user_id:t,record_id:f.id,parameter_name:a,parameter_value:"object"===typeof n?JSON.stringify(n).substring(0,255):String(n||"N/A").substring(0,255),created_at:(new Date).toISOString()}}),{error:a}=await o.supabase.from("health_parameters").insert(e);a&&console.error("Error saving parameters:",a)}if((null===k||void 0===k||null===(n=k.aiAnalysis)||void 0===n||null===(l=n.conditions)||void 0===l?void 0:l.length)>0){const e=k.aiAnalysis.conditions.filter(e=>e&&e.trim()).map(e=>({record_id:f.id,condition_name:String(e).substring(0,255),user_id:t,created_at:(new Date).toISOString()})),{error:a}=await o.supabase.from("report_conditions").insert(e);a&&console.error("Error saving conditions:",a)}if((null===k||void 0===k||null===(r=k.aiAnalysis)||void 0===r||null===(s=r.medications)||void 0===s?void 0:s.length)>0){const e=k.aiAnalysis.medications.filter(e=>e&&e.trim()).map(e=>({record_id:f.id,medication_name:String(e).substring(0,255),user_id:t,created_at:(new Date).toISOString()})),{error:a}=await o.supabase.from("report_medications").insert(e);a&&console.error("Error saving medications:",a)}if(null===k||void 0===k||null===(i=k.aiAnalysis)||void 0===i?void 0:i.recommendations){const{error:e}=await o.supabase.from("report_recommendations").insert([{record_id:f.id,recommendation_text:String(k.aiAnalysis.recommendations).substring(0,255),user_id:t,created_at:(new Date).toISOString()}]);e&&console.error("Error saving recommendations:",e)}await U(t),c(!1),d({disease_id:"",since:"",file:null}),p(null),C({}),P("Report uploaded successfully!","success")}catch(u){console.error("Error uploading report:",u),P("Error uploading report: "+u.message,"danger")}finally{y(!1)}}},l.a.createElement(S.a.Group,{className:"mb-3"},l.a.createElement(S.a.Label,{className:"fw-bold d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-disease me-2 text-primary"}),"Select Health Condition"),l.a.createElement("div",{className:"d-flex gap-2"},l.a.createElement(S.a.Select,{value:m.disease_id,onChange:e=>{"add_new"===e.target.value?(c(!1),L("/profile")):d({...m,disease_id:e.target.value})},required:!0,className:"form-select"},l.a.createElement("option",{value:""},"Choose a health condition"),N.map(e=>l.a.createElement("option",{key:e.id,value:e.id},e.disease_name)),l.a.createElement("option",{value:"add_new",className:"text-primary"},"+ Add New Condition")),l.a.createElement(_.a,{variant:"outline-primary",size:"sm",onClick:()=>{c(!1),L("/profile")},className:"d-flex align-items-center"},l.a.createElement("i",{className:"fas fa-plus me-1"})," Add New")),l.a.createElement(S.a.Text,{className:"text-muted small"},"Select an existing condition or add a new one to your profile")),l.a.createElement(S.a.Group,{className:"mb-3"},l.a.createElement(S.a.Label,{className:"fw-bold d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-calendar-alt me-2 text-primary"}),"Report Date"),l.a.createElement(S.a.Control,{type:"date",value:m.since,onChange:e=>d({...m,since:e.target.value}),required:!0,className:"form-control"}),l.a.createElement(S.a.Text,{className:"text-muted small"},"When was this report created?")),l.a.createElement(S.a.Group,{className:"mb-3"},l.a.createElement(S.a.Label,{className:"fw-bold d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-file-upload me-2 text-primary"}),"Upload Report"),l.a.createElement("div",{className:"border rounded p-3 text-center bg-light"},l.a.createElement(S.a.Control,{type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:async e=>{const a=e.target.files[0];if(a){d({...m,file:a}),y(!0);try{var t,n,l,r,s,c,i,o;if(a.type.startsWith("image/"))return P("Image processing is temporarily unavailable. Please use PDF files for now.","warning"),void y(!1);p(null);const m=new FormData;m.append("file",a);try{const e=await fetch("https://digihealth-backend.onrender.com/api/check-env");if(e.ok){const a=await e.json();if(console.log("Backend environment status:",a),a.environment&&"not set"===a.environment.OPENAI_API_KEY)return P("The AI service is currently unavailable. File upload will proceed without AI analysis.","warning",1e4),C({parameters:{},aiAnalysis:{conditions:[],medications:[],recommendations:"AI analysis unavailable. Please review the document manually.",summary:"This document was uploaded but could not be analyzed by AI due to service unavailability."}}),void y(!1)}else console.warn("Backend environment check failed",await e.text())}catch(b){console.error("Error checking backend environment:",b)}console.log("Sending file to backend:",a.name,a.type,a.size);const d=await fetch("https://digihealth-backend.onrender.com/api/process-file",{method:"POST",body:m});if(!d.ok){let a,t="Error processing file";try{if(a=await d.json(),console.error("Backend error response:",a),t=a.error||t,a.details&&(a.details.includes("API key")||a.details.includes("authentication")||a.details.includes("401")))return P("The AI service is temporarily unavailable. Your file will be uploaded but not analyzed.","warning",1e4),C({parameters:{},aiAnalysis:{conditions:[],medications:[],recommendations:"AI analysis unavailable. Please review the document manually.",summary:"This document was uploaded but could not be analyzed by AI due to service unavailability."}}),void y(!1)}catch(e){console.error("Failed to parse error response",e)}throw new Error(t)}let N,v;try{var u,E,h,g;if(N=await d.json(),console.log("Backend response:",N),console.log("Response structure details:",{hasParameters:Boolean(N.parameters),parametersType:typeof N.parameters,parametersKeys:N.parameters?Object.keys(N.parameters):[],parametersValues:N.parameters?Object.values(N.parameters).map(e=>typeof e):[],hasAiAnalysis:Boolean(N.aiAnalysis),aiAnalysisType:typeof N.aiAnalysis,aiAnalysisKeys:N.aiAnalysis?Object.keys(N.aiAnalysis):[],conditionsType:(null===(u=N.aiAnalysis)||void 0===u?void 0:u.conditions)?typeof N.aiAnalysis.conditions:"undefined",isConditionsArray:!!(null===(E=N.aiAnalysis)||void 0===E?void 0:E.conditions)&&Array.isArray(N.aiAnalysis.conditions),medicationsType:(null===(h=N.aiAnalysis)||void 0===h?void 0:h.medications)?typeof N.aiAnalysis.medications:"undefined",isMedicationsArray:!!(null===(g=N.aiAnalysis)||void 0===g?void 0:g.medications)&&Array.isArray(N.aiAnalysis.medications)}),N&&N.parameters&&Object.keys(N.parameters).forEach(e=>{const a=N.parameters[e];N.parameters[e]=null===a||void 0===a?"N/A":"object"===typeof a?JSON.stringify(a):String(a)}),N&&N.aiAnalysis){if(!Array.isArray(N.aiAnalysis.conditions))if(console.warn("Conditions is not an array, converting:",N.aiAnalysis.conditions),"string"===typeof N.aiAnalysis.conditions)try{N.aiAnalysis.conditions=JSON.parse(N.aiAnalysis.conditions)}catch{N.aiAnalysis.conditions=[N.aiAnalysis.conditions]}else N.aiAnalysis.conditions&&"object"===typeof N.aiAnalysis.conditions?N.aiAnalysis.conditions=Object.values(N.aiAnalysis.conditions).map(String):N.aiAnalysis.conditions=[];if(!Array.isArray(N.aiAnalysis.medications))if(console.warn("Medications is not an array, converting:",N.aiAnalysis.medications),"string"===typeof N.aiAnalysis.medications)try{N.aiAnalysis.medications=JSON.parse(N.aiAnalysis.medications)}catch{N.aiAnalysis.medications=[N.aiAnalysis.medications]}else N.aiAnalysis.medications&&"object"===typeof N.aiAnalysis.medications?N.aiAnalysis.medications=Object.values(N.aiAnalysis.medications).map(String):N.aiAnalysis.medications=[];N.aiAnalysis.conditions=N.aiAnalysis.conditions.filter(e=>null!==e&&void 0!==e).map(e=>String(e)),N.aiAnalysis.medications=N.aiAnalysis.medications.filter(e=>null!==e&&void 0!==e).map(e=>String(e)),N.aiAnalysis.summary=String(N.aiAnalysis.summary||""),N.aiAnalysis.recommendations=String(N.aiAnalysis.recommendations||"")}else N&&(N.aiAnalysis={conditions:[],medications:[],recommendations:"",summary:""})}catch(f){throw console.error("Failed to parse response JSON:",f),new Error("Failed to parse server response. The file may be too large or in an unsupported format.")}if(!N||0===Object.keys(N).length)throw console.error("Empty response structure:",N),new Error("Server returned an empty response");if(!N.parameters&&!N.aiAnalysis)throw console.error("Invalid response structure:",N),new Error("Server returned an invalid response structure");C(N),v=N.parameters&&Object.keys(N.parameters).length>0?"File processed successfully. Review the extracted information below.":N.aiAnalysis&&(N.aiAnalysis.summary&&N.aiAnalysis.summary.length>0||N.aiAnalysis.conditions&&N.aiAnalysis.conditions.length>0||N.aiAnalysis.medications&&N.aiAnalysis.medications.length>0||N.aiAnalysis.recommendations&&N.aiAnalysis.recommendations.length>0)?"No specific parameters were extracted, but AI analysis is available.":"File processed, but limited information could be extracted. You can still upload it.",P(v,"success"),console.log("Backend response structure details:",{hasParameters:Boolean(N.parameters)&&Object.keys(N.parameters).length>0,parametersCount:N.parameters?Object.keys(N.parameters).length:0,hasAiAnalysis:Boolean(N.aiAnalysis),summaryLength:(null===(t=N.aiAnalysis)||void 0===t||null===(n=t.summary)||void 0===n?void 0:n.length)||0,conditionsLength:(null===(l=N.aiAnalysis)||void 0===l||null===(r=l.conditions)||void 0===r?void 0:r.length)||0,medicationsLength:(null===(s=N.aiAnalysis)||void 0===s||null===(c=s.medications)||void 0===c?void 0:c.length)||0,recommendationsLength:(null===(i=N.aiAnalysis)||void 0===i||null===(o=i.recommendations)||void 0===o?void 0:o.length)||0})}catch(N){console.error("Error processing file:",N),N.message.includes("API key")||N.message.includes("OpenAI")?(P("AI service is unavailable. Your file will be uploaded without analysis.","warning"),C({parameters:{},aiAnalysis:{conditions:[],medications:[],recommendations:"AI analysis unavailable. Please review the document manually.",summary:"This document was uploaded but could not be analyzed by AI due to service unavailability."}})):(P("Error processing file: "+N.message,"danger"),C({}))}finally{y(!1)}}},required:!0,className:"form-control",style:{display:"none"},id:"file-upload"}),l.a.createElement("label",{htmlFor:"file-upload",className:"btn btn-outline-primary w-100 d-flex flex-column align-items-center justify-content-center",style:{minHeight:"120px",cursor:"pointer"}},l.a.createElement("i",{className:"fas fa-cloud-upload-alt fa-2x mb-2 text-primary"}),l.a.createElement("span",{className:"h6 mb-1 text-dark"},"Click to upload or drag and drop"),l.a.createElement("small",{className:"text-muted"},"Supported formats: PDF, DOC, DOCX, JPG, JPEG, PNG"))),l.a.createElement(S.a.Text,{className:"text-muted small"},"Upload your medical report or test results. Our AI will analyze the content automatically.")),u&&l.a.createElement("div",{className:"mb-3"},l.a.createElement(S.a.Label,{className:"fw-bold d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-image me-2 text-primary"}),"Preview"),l.a.createElement("img",{src:u,alt:"Preview",className:"img-fluid rounded shadow-sm"})),(null===k||void 0===k?void 0:k.aiAnalysis)?l.a.createElement("div",{className:"mb-3"},l.a.createElement("h5",{className:"fw-bold mb-2 d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-robot me-2 text-primary"}),"AI Analysis"),l.a.createElement("div",{className:"card border-0 shadow-sm"},l.a.createElement("div",{className:"card-body"},k.aiAnalysis.summary?l.a.createElement(l.a.Fragment,null,l.a.createElement("h6",{className:"fw-bold mb-2 d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-file-alt me-2 text-primary"}),"Summary"),l.a.createElement("p",{className:"mb-3 text-dark"},String(k.aiAnalysis.summary))):l.a.createElement("p",{className:"text-muted"},"No summary available for this document."),k.aiAnalysis.conditions&&k.aiAnalysis.conditions.length>0&&l.a.createElement(l.a.Fragment,null,l.a.createElement("h6",{className:"fw-bold mb-2 d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-clipboard-list me-2 text-primary"}),"Conditions Identified"),l.a.createElement("ul",{className:"list-group list-group-flush mb-3"},k.aiAnalysis.conditions.map((e,a)=>l.a.createElement("li",{key:a,className:"list-group-item text-dark"},l.a.createElement("i",{className:"fas fa-check-circle text-success me-2"}),String(e))))),k.aiAnalysis.medications&&k.aiAnalysis.medications.length>0&&l.a.createElement(l.a.Fragment,null,l.a.createElement("h6",{className:"fw-bold mb-2 d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-pills me-2 text-primary"}),"Medications"),l.a.createElement("ul",{className:"list-group list-group-flush mb-3"},k.aiAnalysis.medications.map((e,a)=>l.a.createElement("li",{key:a,className:"list-group-item text-dark"},l.a.createElement("i",{className:"fas fa-pills text-info me-2"}),String(e))))),k.aiAnalysis.recommendations&&l.a.createElement(l.a.Fragment,null,l.a.createElement("h6",{className:"fw-bold mb-2 d-flex align-items-center text-dark fs-6"},l.a.createElement("i",{className:"fas fa-lightbulb me-2 text-primary"}),"Recommendations"),l.a.createElement("p",{className:"text-dark"},String(k.aiAnalysis.recommendations)))))):null,l.a.createElement("div",{className:"d-flex justify-content-end mt-3"},l.a.createElement(_.a,{type:"submit",variant:"primary",size:"sm",disabled:f,className:"px-3 d-flex align-items-center"},f?l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Uploading..."):l.a.createElement(l.a.Fragment,null,l.a.createElement("i",{className:"fas fa-upload me-2"}),"Upload Report")))))),l.a.createElement(j.a,{show:A,onHide:()=>O(!1),centered:!0},l.a.createElement(j.a.Header,{closeButton:!0,className:"border-bottom-0 pb-0"},l.a.createElement(j.a.Title,{className:"h4 fw-bold text-dark"},"Confirm Delete")),l.a.createElement(j.a.Body,{className:"pt-4"},l.a.createElement("div",{className:"text-center mb-4"},l.a.createElement("i",{className:"fas fa-exclamation-triangle text-warning fa-3x mb-3"}),l.a.createElement("h5",{className:"fw-bold text-dark mb-3"},"Are you sure you want to delete this report?"),l.a.createElement("p",{className:"text-dark"},"This action cannot be undone.")),l.a.createElement("div",{className:"d-flex justify-content-center gap-3"},l.a.createElement(_.a,{variant:"outline-secondary",onClick:()=>O(!1),size:"sm",className:"px-3"},"Cancel"),l.a.createElement(_.a,{variant:"danger",onClick:async()=>{y(!0);try{const{data:e,error:t}=await o.supabase.from("healthrecords").select("document_url").eq("id",R).single();if(t)throw console.error("Error fetching report:",t),new Error("Error fetching report: "+t.message);if(!e||!e.document_url)throw new Error("Report or document URL not found");const n=e.document_url.match(/health-reports\/([^\/]+)\/([^\/]+)$/);if(n&&n.length>=3){const e=n[1],a=`${e}/${n[2]}`,{error:t}=await o.supabase.storage.from("health-reports").remove([a]);if(t)throw console.error("Error deleting file:",t),new Error("Error deleting file: "+t.message)}const{error:l}=await o.supabase.from("healthrecords").delete().eq("id",R);if(l)throw console.error("Error deleting record:",l),new Error("Error deleting record: "+l.message);a(e=>e.filter(e=>e.id!==R)),P("Report deleted successfully","success")}catch(e){console.error("Error in delete process:",e),P("Error deleting report: "+e.message,"danger")}finally{y(!1),O(!1),F(null)}},size:"sm",className:"px-3 bg-danger text-white",disabled:f},f?l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Deleting..."):"Delete")))),l.a.createElement("div",{className:"mt-5 pt-5 border-top"},l.a.createElement("h5",null,"Troubleshooting"),l.a.createElement(_.a,{variant:"outline-secondary",size:"sm",onClick:async()=>{try{P("Testing with sample data...","info"),y(!0);const e=await fetch("https://digihealth-backend.onrender.com/api/test-response");if(!e.ok)throw new Error("Error fetching test data");const a=await e.json();console.log("Test response received:",a),C(a),P("Test data loaded successfully! You can view it in the modal.","success"),d({disease_id:N.length>0?N[0].id:"",since:(new Date).toISOString().split("T")[0],file:null}),c(!0)}catch(e){console.error("Error testing backend response:",e),P("Error: "+e.message,"danger")}finally{y(!1)}},className:"mt-2"},"Test Rendering"),l.a.createElement("small",{className:"d-block text-muted mt-2"},"Use this button to test rendering with sample data if you encounter issues.")))};var F=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)(!1),[d,u]=Object(n.useState)({id:null,condition:"",diagnosis_date:"",doctor:"",treatment:"",notes:""});Object(n.useEffect)(()=>{p()},[]);const p=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await o.supabase.from("medical_history").select("*").eq("user_id",e.id).order("diagnosis_date",{ascending:!1});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching medical records:",e),c({message:"Error fetching medical records.",type:"danger"})}finally{r(!1)}},E=e=>{const{name:a,value:t}=e.target;u(e=>({...e,[a]:t}))},h=()=>{m(!1),u({id:null,condition:"",diagnosis_date:"",doctor:"",treatment:"",notes:""})};return t&&0===e.length?l.a.createElement(v,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(y.A,{className:"me-2"})," Medical History"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Medical Record":"Add New Medical Record"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await o.supabase.from("medical_history").update({condition:d.condition,diagnosis_date:d.diagnosis_date,doctor:d.doctor,treatment:d.treatment,notes:d.notes}).eq("id",d.id);if(e)throw e;c({message:"Medical record updated successfully!",type:"success"})}else{const{error:a}=await o.supabase.from("medical_history").insert([{condition:d.condition,diagnosis_date:d.diagnosis_date,doctor:d.doctor,treatment:d.treatment,notes:d.notes,user_id:e.id}]);if(a)throw a;c({message:"Medical record added successfully!",type:"success"})}h(),p()}catch(a){console.error("Error saving medical record:",a),c({message:"Error saving medical record.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"condition",className:"form-label"},"Condition/Diagnosis"),l.a.createElement("input",{type:"text",className:"form-control",id:"condition",name:"condition",value:d.condition,onChange:E,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"diagnosis_date",className:"form-label"},"Diagnosis Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"diagnosis_date",name:"diagnosis_date",value:d.diagnosis_date,onChange:E,required:!0}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"doctor",className:"form-label"},"Doctor/Healthcare Provider"),l.a.createElement("input",{type:"text",className:"form-control",id:"doctor",name:"doctor",value:d.doctor,onChange:E})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"treatment",className:"form-label"},"Treatment"),l.a.createElement("input",{type:"text",className:"form-control",id:"treatment",name:"treatment",value:d.treatment,onChange:E}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:d.notes,onChange:E})),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.q,{className:"me-2"})," Update Record"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.Q,{className:"me-2"})," Add Record")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:h},"Cancel")))),l.a.createElement("h2",{className:"text-center mb-3"},"Your Medical History"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No medical records found. Add your first record above."):l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Condition"),l.a.createElement("th",null,"Diagnosis Date"),l.a.createElement("th",null,"Doctor"),l.a.createElement("th",null,"Treatment"),l.a.createElement("th",null,"Actions"))),l.a.createElement("tbody",null,e.map(t=>l.a.createElement("tr",{key:t.id},l.a.createElement("td",null,t.condition),l.a.createElement("td",null,new Date(t.diagnosis_date).toLocaleDateString()),l.a.createElement("td",null,t.doctor),l.a.createElement("td",null,t.treatment),l.a.createElement("td",null,l.a.createElement("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>(e=>{m(!0),u(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(y.q,null)),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this record?")){r(!0);try{const{error:n}=await o.supabase.from("medical_history").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Medical record deleted successfully!",type:"success"})}catch(n){console.error("Error deleting medical record:",n),c({message:"Error deleting medical record.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(y.fb,null)))))))))};console.warn("Importing supabase from utils/main.js is deprecated. Please import directly from utils/supabaseClient.js");var L=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)(!1),[d,u]=Object(n.useState)({id:null,disease_name:"",diagnosis_date:"",severity:"Mild",medications:"",symptoms:"",notes:""});Object(n.useEffect)(()=>{p()},[]);const p=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await o.supabase.from("chronic_diseases").select("*").eq("user_id",e.id).order("diagnosis_date",{ascending:!1});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching chronic diseases:",e),c({message:"Error fetching chronic diseases.",type:"danger"})}finally{r(!1)}},E=e=>{const{name:a,value:t}=e.target;u(e=>({...e,[a]:t}))},h=()=>{m(!1),u({id:null,disease_name:"",diagnosis_date:"",severity:"Mild",medications:"",symptoms:"",notes:""})},g=e=>{switch(e){case"Mild":return"bg-success";case"Moderate":return"bg-warning text-dark";case"Severe":return"bg-danger";default:return"bg-secondary"}};return t&&0===e.length?l.a.createElement(v,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(y.o,{className:"me-2"})," Chronic Disease Management"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Chronic Disease":"Add New Chronic Disease"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await o.supabase.from("chronic_diseases").update({disease_name:d.disease_name,diagnosis_date:d.diagnosis_date,severity:d.severity,medications:d.medications,symptoms:d.symptoms,notes:d.notes}).eq("id",d.id);if(e)throw e;c({message:"Chronic disease updated successfully!",type:"success"})}else{const{error:a}=await o.supabase.from("chronic_diseases").insert([{disease_name:d.disease_name,diagnosis_date:d.diagnosis_date,severity:d.severity,medications:d.medications,symptoms:d.symptoms,notes:d.notes,user_id:e.id}]);if(a)throw a;c({message:"Chronic disease added successfully!",type:"success"})}h(),p()}catch(a){console.error("Error saving chronic disease:",a),c({message:"Error saving chronic disease.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"disease_name",className:"form-label"},"Disease Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"disease_name",name:"disease_name",value:d.disease_name,onChange:E,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"diagnosis_date",className:"form-label"},"Diagnosis Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"diagnosis_date",name:"diagnosis_date",value:d.diagnosis_date,onChange:E,required:!0}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"severity",className:"form-label"},"Severity"),l.a.createElement("select",{className:"form-control",id:"severity",name:"severity",value:d.severity,onChange:E},l.a.createElement("option",{value:"Mild"},"Mild"),l.a.createElement("option",{value:"Moderate"},"Moderate"),l.a.createElement("option",{value:"Severe"},"Severe"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"medications",className:"form-label"},"Medications"),l.a.createElement("input",{type:"text",className:"form-control",id:"medications",name:"medications",value:d.medications,onChange:E,placeholder:"Separate multiple medications with commas"}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"symptoms",className:"form-label"},"Symptoms"),l.a.createElement("input",{type:"text",className:"form-control",id:"symptoms",name:"symptoms",value:d.symptoms,onChange:E,placeholder:"Separate multiple symptoms with commas"})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:d.notes,onChange:E})),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.q,{className:"me-2"})," Update Disease"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.Q,{className:"me-2"})," Add Disease")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:h},"Cancel")))),l.a.createElement("h2",{className:"text-center mb-3"},"Your Chronic Diseases"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No chronic diseases found. Add your first record above."):l.a.createElement("div",{className:"row"},e.map(t=>l.a.createElement("div",{key:t.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow"},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},l.a.createElement("h5",{className:"mb-0"},t.disease_name),l.a.createElement("span",{className:"badge "+g(t.severity)},t.severity)),l.a.createElement("div",{className:"card-body"},l.a.createElement("p",null,l.a.createElement("strong",null,"Diagnosed:")," ",new Date(t.diagnosis_date).toLocaleDateString()),t.medications&&l.a.createElement("p",null,l.a.createElement("strong",null,"Medications:"),l.a.createElement("br",null),t.medications.split(",").map((e,a)=>l.a.createElement("span",{key:a,className:"badge bg-info text-dark me-1 mb-1"},e.trim()))),t.symptoms&&l.a.createElement("p",null,l.a.createElement("strong",null,"Symptoms:"),l.a.createElement("br",null),t.symptoms.split(",").map((e,a)=>l.a.createElement("span",{key:a,className:"badge bg-secondary me-1 mb-1"},e.trim()))),t.notes&&l.a.createElement("p",null,l.a.createElement("strong",null,"Notes:"),l.a.createElement("br",null),t.notes)),l.a.createElement("div",{className:"card-footer d-flex justify-content-between"},l.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{m(!0),u(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(y.q,{className:"me-1"})," Edit"),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this chronic disease record?")){r(!0);try{const{error:n}=await o.supabase.from("chronic_diseases").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Chronic disease deleted successfully!",type:"success"})}catch(n){console.error("Error deleting chronic disease:",n),c({message:"Error deleting chronic disease.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(y.fb,{className:"me-1"})," Delete")))))))};t(87);var P=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[m,d]=Object(n.useState)(!1),[u,p]=Object(n.useState)("records"),[E,h]=Object(n.useState)({id:null,vaccine_name:"",date_administered:"",administered_by:"",lot_number:"",next_dose_date:"",notes:""}),[g,b]=Object(n.useState)(!1),f=Object(i.q)(),N=Object(n.useCallback)(async()=>{try{r(!0);const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return console.log("No user logged in"),void r(!1);const{data:t,error:n}=await o.supabase.from("vaccinations").select("*").eq("user_id",e.id).order("vaccine_date",{ascending:!1});if(n)return void console.error("Error fetching vaccinations:",n);a(t||[])}catch(e){console.error("Unexpected error:",e)}finally{r(!1)}},[f]);Object(n.useEffect)(()=>{N()},[N]);const v=e=>{const{name:a,value:t}=e.target;h(e=>({...e,[a]:t}))},x=async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");if(m){const{error:e}=await o.supabase.from("vaccinations").update({vaccine_name:E.vaccine_name,date_administered:E.date_administered,administered_by:E.administered_by,lot_number:E.lot_number,next_dose_date:E.next_dose_date,notes:E.notes}).eq("id",E.id);if(e)throw e;c({message:"Vaccination record updated successfully!",type:"success"})}else{const{error:a}=await o.supabase.from("vaccinations").insert([{vaccine_name:E.vaccine_name,date_administered:E.date_administered,administered_by:E.administered_by,lot_number:E.lot_number,next_dose_date:E.next_dose_date,notes:E.notes,user_id:e.id}]);if(a)throw a;c({message:"Vaccination record added successfully!",type:"success"})}k(),N(),p("records")}catch(a){console.error("Error saving vaccination record:",a),c({message:"Error saving vaccination record.",type:"danger"})}finally{r(!1)}},S=e=>{d(!0),h(e),p("form"),window.scrollTo({top:0,behavior:"smooth"})},k=()=>{d(!1),h({id:null,vaccine_name:"",date_administered:"",administered_by:"",lot_number:"",next_dose_date:"",notes:""})},C=e=>{if(!e)return!1;const a=new Date,t=new Date(e)-a,n=Math.ceil(t/864e5);return n>=0&&n<=30},A=e=>{if(!e)return!1;const a=new Date;return new Date(e)<a};if(t&&0===e.length)return l.a.createElement("div",{className:"text-center"},l.a.createElement(w.a,{animation:"border",role:"status"},l.a.createElement("span",{className:"visually-hidden"},"Loading...")));const O=e.some(e=>C(e.next_dose_date)||A(e.next_dose_date));return l.a.createElement(I.a,null,l.a.createElement("h1",{className:"my-4 page-title"},l.a.createElement(y.Z,{className:"me-2 text-primary"})," Vaccination History"),t?l.a.createElement("div",{className:"text-center"},l.a.createElement(w.a,{animation:"border",role:"status"},l.a.createElement("span",{className:"visually-hidden"},"Loading..."))):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"tabs-container"},l.a.createElement("div",{className:"nav-tabs-wrapper"},l.a.createElement("ul",{className:"nav nav-tabs"},l.a.createElement("li",{className:"nav-item"},l.a.createElement("button",{className:"nav-link "+("records"===u?"active":""),onClick:()=>p("records")},l.a.createElement(y.I,{className:"me-2"})," Vaccination Records",O&&l.a.createElement("span",{className:"upcoming-badge ms-2"},"!"))),l.a.createElement("li",{className:"nav-item"},l.a.createElement("button",{className:"nav-link "+("form"===u?"active":""),onClick:()=>{p("form"),m&&k()}},l.a.createElement(y.Q,{className:"me-2"})," ",m?"Edit Record":"Add New Record")))),l.a.createElement("div",{className:"tab-content"},"records"===u&&l.a.createElement("div",{className:"tab-pane active"},0===e.length?l.a.createElement("div",{className:"empty-state"},l.a.createElement(y.Z,{className:"mb-3",style:{fontSize:"3rem",color:"var(--secondary-color)"}}),l.a.createElement("h3",{className:"text-primary"},"No vaccination records found"),l.a.createElement("p",null,'Click "Add New Record" tab to record your first vaccination'),l.a.createElement(_.a,{variant:"primary",onClick:()=>p("form")},l.a.createElement(y.Q,{className:"me-2"})," Add New Record")):l.a.createElement(l.a.Fragment,null,O&&l.a.createElement("div",{className:"upcoming-section"},l.a.createElement("div",{className:"upcoming-header"},l.a.createElement("h3",{className:"mb-0"},l.a.createElement(y.e,{className:"me-2"})," Upcoming & Overdue Vaccinations")),l.a.createElement("div",{className:"upcoming-body"},l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Vaccine"),l.a.createElement("th",null,"Due Date"),l.a.createElement("th",null,"Status"),l.a.createElement("th",null,"Actions"))),l.a.createElement("tbody",null,e.filter(e=>C(e.next_dose_date)||A(e.next_dose_date)).map(e=>l.a.createElement("tr",{key:"upcoming-"+e.id},l.a.createElement("td",null,l.a.createElement(y.Z,{className:"me-2 text-primary"})," ",e.vaccine_name),l.a.createElement("td",null,l.a.createElement(y.d,{className:"me-2 text-primary"})," ",new Date(e.next_dose_date).toLocaleDateString()),l.a.createElement("td",null,l.a.createElement("span",{className:"status-badge "+(A(e.next_dose_date)?"status-overdue":"status-due-soon")},A(e.next_dose_date)?"Overdue":"Due Soon")),l.a.createElement("td",null,l.a.createElement("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>S(e)},l.a.createElement(y.q,{className:"me-1"})," Edit"))))))))),l.a.createElement("h2",{className:"section-title"},"Your Vaccination History"),l.a.createElement("div",{className:"vaccination-cards"},e.map(t=>{const n=(e=>A(e.next_dose_date)?{text:"Overdue",className:"status-overdue"}:C(e.next_dose_date)?{text:"Due Soon",className:"status-due-soon"}:e.next_dose_date?{text:"Scheduled",className:""}:{text:"Completed",className:"status-completed"})(t);return l.a.createElement("div",{className:"vaccine-card",key:t.id},l.a.createElement("h4",null,l.a.createElement(y.Z,{className:"me-2 text-primary"}),t.vaccine_name),l.a.createElement("div",{className:"vaccine-card-info"},l.a.createElement("p",null,l.a.createElement("strong",null,l.a.createElement(y.d,{className:"me-1 text-primary"})," Date Administered:"),new Date(t.date_administered).toLocaleDateString()),t.administered_by&&l.a.createElement("p",null,l.a.createElement("strong",null,l.a.createElement(y.kb,{className:"me-1 text-primary"})," Healthcare Provider:")," ",t.administered_by),t.lot_number&&l.a.createElement("p",null,l.a.createElement("strong",null,l.a.createElement(y.D,{className:"me-1 text-primary"})," Lot Number:")," ",t.lot_number),l.a.createElement("p",null,l.a.createElement("strong",null,l.a.createElement(y.e,{className:"me-1 text-primary"})," Next Dose:"),t.next_dose_date?new Date(t.next_dose_date).toLocaleDateString():"N/A",n.className&&l.a.createElement("span",{className:"status-badge "+n.className},n.text)),t.notes&&l.a.createElement("p",null,l.a.createElement("strong",null,l.a.createElement(y.Y,{className:"me-1 text-primary"})," Notes:")," ",t.notes)),l.a.createElement("div",{className:"vaccine-card-actions"},l.a.createElement("button",{className:"btn btn-primary",onClick:()=>S(t)},l.a.createElement(y.q,{className:"me-2"})," Edit"),l.a.createElement("button",{className:"btn btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this vaccination record?")){r(!0);try{const{error:n}=await o.supabase.from("vaccinations").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Vaccination record deleted successfully!",type:"success"})}catch(n){console.error("Error deleting vaccination record:",n),c({message:"Error deleting vaccination record.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(y.fb,{className:"me-2"})," Delete")))})))),"form"===u&&l.a.createElement("div",{className:"tab-pane active"},l.a.createElement("div",{className:"vaccine-form-card"},l.a.createElement("h3",{className:"form-title"},m?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.q,{className:"me-2 text-primary"})," Edit Vaccination Record"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.Q,{className:"me-2 text-primary"})," Add New Vaccination")),l.a.createElement("form",{onSubmit:x,className:"vaccination-form"},l.a.createElement("div",{className:"form-section"},l.a.createElement("h4",{className:"form-section-title"},l.a.createElement(y.W,{className:"me-2 text-primary"})," Basic Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"vaccine_name",className:"form-label text-dark"},l.a.createElement("span",{className:"text-danger"},"*")," Vaccine Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"vaccine_name",name:"vaccine_name",value:E.vaccine_name,onChange:v,placeholder:"Enter vaccine name",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},l.a.createElement(y.D,{className:"me-1"})," E.g., Influenza, COVID-19, Tetanus, HPV")),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"date_administered",className:"form-label text-dark"},l.a.createElement("span",{className:"text-danger"},"*")," Date Administered"),l.a.createElement("input",{type:"date",className:"form-control",id:"date_administered",name:"date_administered",value:E.date_administered,onChange:v,required:!0}),l.a.createElement("small",{className:"form-text text-muted"},l.a.createElement(y.d,{className:"me-1"})," When was the vaccine administered?")))),l.a.createElement("div",{className:"form-section"},l.a.createElement("h4",{className:"form-section-title"},l.a.createElement(y.kb,{className:"me-2 text-primary"})," Additional Details"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"administered_by",className:"form-label text-dark"},l.a.createElement(y.B,{className:"me-1 text-primary"})," Healthcare Provider"),l.a.createElement("input",{type:"text",className:"form-control",id:"administered_by",name:"administered_by",value:E.administered_by,onChange:v,placeholder:"Enter provider name or facility"}),l.a.createElement("small",{className:"form-text text-muted"},l.a.createElement(y.D,{className:"me-1"})," Doctor, clinic, or healthcare facility")),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"lot_number",className:"form-label text-dark"},l.a.createElement(y.D,{className:"me-1 text-primary"})," Lot Number"),l.a.createElement("input",{type:"text",className:"form-control",id:"lot_number",name:"lot_number",value:E.lot_number,onChange:v,placeholder:"Enter vaccine lot number"}),l.a.createElement("small",{className:"form-text text-muted"},l.a.createElement(y.D,{className:"me-1"})," Found on your vaccination card"))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"next_dose_date",className:"form-label text-dark"},l.a.createElement(y.e,{className:"me-1 text-primary"})," Next Dose Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"next_dose_date",name:"next_dose_date",value:E.next_dose_date,onChange:v}),l.a.createElement("small",{className:"form-text text-muted"},l.a.createElement(y.l,{className:"me-1"})," If another dose is required")),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label text-dark"},l.a.createElement(y.Y,{className:"me-1 text-primary"})," Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:E.notes,onChange:v,placeholder:"Any reactions, side effects, or important information"})))),l.a.createElement("div",{className:"form-actions"},l.a.createElement("button",{type:"submit",className:"btn btn-primary btn-lg"},m?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.q,{className:"me-2"})," Update Record"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.Q,{className:"me-2"})," Save Record")),m&&l.a.createElement("button",{type:"button",className:"btn btn-secondary btn-lg ms-3",onClick:k},"Cancel"),l.a.createElement("button",{type:"button",className:"btn btn-light btn-lg ms-auto",onClick:()=>p("records")},"Back to Records")))))))),s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center alert-dismissible fade show`},s.message,l.a.createElement("button",{type:"button",className:"btn-close",onClick:()=>c(null),"aria-label":"Close"})),l.a.createElement(j.a,{show:g,onHide:()=>b(!1),size:"lg",centered:!0,className:"vaccination-modal"},l.a.createElement(j.a.Header,{closeButton:!0,className:"border-bottom-0 pb-0"},l.a.createElement(j.a.Title,null,l.a.createElement(y.Q,{className:"me-2 text-primary"})," Add New Vaccination")),l.a.createElement(j.a.Body,{className:"pt-0"},l.a.createElement("div",{className:"vaccine-form-card border-0"},l.a.createElement("form",{onSubmit:e=>{e.preventDefault(),x(e),b(!1)},className:"vaccination-form"},l.a.createElement("div",{className:"form-section"},l.a.createElement("h4",{className:"form-section-title text-dark"},l.a.createElement(y.W,{className:"me-2 text-primary"})," Basic Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"vaccine_name",className:"form-label text-dark"},l.a.createElement("span",{className:"text-danger"},"*")," Vaccine Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"vaccine_name",name:"vaccine_name",value:E.vaccine_name,onChange:v,placeholder:"Enter vaccine name",required:!0}),l.a.createElement("small",{className:"form-text text-muted"},l.a.createElement(y.D,{className:"me-1"})," E.g., Influenza, COVID-19, Tetanus, HPV")),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"date_administered",className:"form-label text-dark"},l.a.createElement("span",{className:"text-danger"},"*")," Date Administered"),l.a.createElement("input",{type:"date",className:"form-control",id:"date_administered",name:"date_administered",value:E.date_administered,onChange:v,required:!0})))),l.a.createElement("div",{className:"form-section"},l.a.createElement("h4",{className:"form-section-title text-dark"},l.a.createElement(y.kb,{className:"me-2 text-primary"})," Additional Details"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"administered_by",className:"form-label text-dark"},"Healthcare Provider"),l.a.createElement("input",{type:"text",className:"form-control",id:"administered_by",name:"administered_by",value:E.administered_by,onChange:v,placeholder:"Enter provider name or facility"})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"lot_number",className:"form-label text-dark"},"Lot Number"),l.a.createElement("input",{type:"text",className:"form-control",id:"lot_number",name:"lot_number",value:E.lot_number,onChange:v,placeholder:"Enter vaccine lot number"}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"next_dose_date",className:"form-label text-dark"},l.a.createElement(y.e,{className:"me-1 text-primary"})," Next Dose Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"next_dose_date",name:"next_dose_date",value:E.next_dose_date,onChange:v}),l.a.createElement("small",{className:"form-text text-muted"},l.a.createElement(y.l,{className:"me-1"})," If another dose is required")),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label text-dark"},l.a.createElement(y.Y,{className:"me-1 text-primary"})," Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"2",value:E.notes,onChange:v,placeholder:"Any reactions, side effects, or important information"})))),l.a.createElement("div",{className:"d-flex justify-content-end mt-3"},l.a.createElement(_.a,{variant:"secondary",className:"me-2",onClick:()=>b(!1)},"Cancel"),l.a.createElement(_.a,{variant:"primary",type:"submit"},l.a.createElement(y.Q,{className:"me-2"})," Save Vaccination")))))))};t(88);var q=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)("medications"),[d,u]=Object(n.useState)({name:"",total_tablets:"",dose_per_intake:"",times_per_day:1,frequency:"daily",selected_days:[],reminder_time:"08:00"}),[p,E]=Object(n.useState)([]),[h,g]=Object(n.useState)(!1),[b,f]=Object(n.useState)(null),[N,w]=Object(n.useState)(!1);Object(n.useEffect)(()=>{x()},[]),Object(n.useEffect)(()=>{const a=e.some(e=>e.remaining_tablets<=e.dose_per_intake*e.times_per_day*3);w(a)},[e]);const x=async()=>{try{r(!0);const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await o.supabase.from("medications").select("*").eq("user_id",e.id).order("name",{ascending:!0});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching medications:",e),c({message:"Error fetching medications.",type:"danger"})}finally{r(!1)}},S=async e=>{if(e.preventDefault(),d.name&&d.total_tablets&&d.dose_per_intake){r(!0);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const{error:a}=await o.supabase.from("medications").insert([{name:d.name,total_tablets:parseInt(d.total_tablets),dose_per_intake:parseInt(d.dose_per_intake),times_per_day:parseInt(d.times_per_day),frequency:d.frequency,selected_days:d.selected_days,reminder_time:d.reminder_time,user_id:e.id,remaining_tablets:parseInt(d.total_tablets)}]);if(a)throw a;u({name:"",total_tablets:"",dose_per_intake:"",times_per_day:1,frequency:"daily",selected_days:[],reminder_time:"08:00"}),c({message:"Medication added successfully!",type:"success"}),x(),m("medications")}catch(a){console.error("Error adding medication:",a),c({message:"Error adding medication.",type:"danger"})}finally{r(!1)}}else c({message:"Please fill all required fields.",type:"danger"})},k=async e=>{try{const{data:a,error:t}=await o.supabase.from("medication_history").select("*").eq("medication_id",e).order("taken_at",{ascending:!1}).limit(30);if(t)throw t;E(a||[])}catch(a){console.error("Error fetching history:",a)}};return t&&0===e.length?l.a.createElement("div",{className:"text-center"},l.a.createElement(v,{animation:"border",role:"status"},l.a.createElement("span",{className:"visually-hidden"},"Loading..."))):l.a.createElement(I.a,null,l.a.createElement("h1",{className:"my-4 page-title"},l.a.createElement(y.P,{className:"me-2 text-primary"})," Medication Tracker"),s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center alert-dismissible fade show`},s.message,l.a.createElement("button",{type:"button",className:"btn-close",onClick:()=>c(null),"aria-label":"Close"})),l.a.createElement("div",{className:"tabs-container"},l.a.createElement("div",{className:"nav-tabs-wrapper"},l.a.createElement("ul",{className:"nav nav-tabs"},l.a.createElement("li",{className:"nav-item"},l.a.createElement("button",{className:"nav-link "+("medications"===i?"active":""),onClick:()=>m("medications")},l.a.createElement(y.I,{className:"me-2 text-primary"})," Your Medications",N&&l.a.createElement("span",{className:"upcoming-badge ms-2"},"!"))),l.a.createElement("li",{className:"nav-item"},l.a.createElement("button",{className:"nav-link "+("add"===i?"active":""),onClick:()=>m("add")},l.a.createElement(y.Q,{className:"me-2 text-primary"})," Add New Medication")))),l.a.createElement("div",{className:"tab-content"},"medications"===i&&l.a.createElement("div",{className:"tab-pane active"},(()=>{if(0===e.length)return l.a.createElement("div",{className:"empty-state"},l.a.createElement(y.P,{className:"mb-3",style:{fontSize:"3rem",color:"var(--secondary-color)"}}),l.a.createElement("h3",{className:"text-primary"},"No medications found"),l.a.createElement("p",null,'Click "Add New Medication" to record your first medication'),l.a.createElement(_.a,{variant:"primary",onClick:()=>m("add")},l.a.createElement(y.Q,{className:"me-2"})," Add New Medication"));const t=e.filter(e=>e.remaining_tablets<=e.dose_per_intake*e.times_per_day*3);return l.a.createElement(l.a.Fragment,null,t.length>0&&l.a.createElement("div",{className:"upcoming-section mb-4"},l.a.createElement("div",{className:"upcoming-header"},l.a.createElement("h3",{className:"mb-0"},l.a.createElement(y.s,{className:"me-2 text-primary"})," Low Stock Medications")),l.a.createElement("div",{className:"upcoming-body"},l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Medication"),l.a.createElement("th",null,"Remaining"),l.a.createElement("th",null,"Per Dose"),l.a.createElement("th",null,"Actions"))),l.a.createElement("tbody",null,t.map(e=>l.a.createElement("tr",{key:"low-stock-"+e.id},l.a.createElement("td",null,l.a.createElement(y.P,{className:"me-2 text-primary"})," ",e.name),l.a.createElement("td",null,e.remaining_tablets," tablets"),l.a.createElement("td",null,e.dose_per_intake," tablets"),l.a.createElement("td",null,l.a.createElement("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>{m("add")}},l.a.createElement(y.Q,{className:"me-1"})," Restock"))))))))),l.a.createElement("h2",{className:"section-title"},"Your Medications"),l.a.createElement("div",{className:"row"},e.map(t=>l.a.createElement("div",{key:t.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"medication-card"},l.a.createElement("h4",null,t.name),l.a.createElement("p",null,l.a.createElement("strong",null,"Total Tablets:")," ",t.total_tablets),l.a.createElement("p",null,l.a.createElement("strong",null,"Tablets per Dose:")," ",t.dose_per_intake),l.a.createElement("p",null,l.a.createElement("strong",null,"Times per Day:")," ",1===t.times_per_day?"Once a Day":2===t.times_per_day?"Twice a Day":3===t.times_per_day?"Three Times a Day":"Four Times a Day"),l.a.createElement("p",null,l.a.createElement("strong",null,"Frequency:")," ","daily"===t.frequency?"Daily":"twice_week"===t.frequency?"Twice a Week":"thrice_week"===t.frequency?"Three Times a Week":"once_week"===t.frequency?"Once a Week":"Alternate Days"),t.selected_days&&t.selected_days.length>0&&l.a.createElement("p",null,l.a.createElement("strong",null,"Days:")," ",t.selected_days.join(", ")),l.a.createElement("p",null,l.a.createElement("strong",null,"Remaining:")," ",t.remaining_tablets),l.a.createElement("p",null,l.a.createElement("strong",null,"Reminder Time:")," ",t.reminder_time),t.remaining_tablets<=t.dose_per_intake*t.times_per_day*3&&l.a.createElement("p",{className:"text-danger"},l.a.createElement(y.s,{className:"me-2"}),"Low stock! Please restock soon."),l.a.createElement("div",{className:"btn-group"},l.a.createElement("button",{className:"btn btn-success",onClick:()=>(async e=>{const a=e.remaining_tablets-e.dose_per_intake;if(a<0)c({message:"Not enough tablets remaining!",type:"danger"});else{r(!0);try{const{error:t}=await o.supabase.from("medications").update({remaining_tablets:a,last_taken_at:(new Date).toISOString()}).eq("id",e.id);if(t)throw t;const{error:n}=await o.supabase.from("medication_history").insert([{medication_id:e.id,user_id:e.user_id,status:"taken",taken_at:(new Date).toISOString()}]);if(n)throw n;c({message:"Dose recorded successfully!",type:"success"}),x()}catch(t){console.error("Error recording dose:",t),c({message:"Error recording dose.",type:"danger"})}finally{r(!1)}}})(t)},l.a.createElement(y.h,{className:"me-2"})," Take"),l.a.createElement("button",{className:"btn btn-warning",onClick:()=>(async e=>{try{const{error:a}=await o.supabase.from("medication_history").insert([{medication_id:e.id,user_id:e.user_id,status:"missed",taken_at:(new Date).toISOString()}]);if(a)throw a;c({message:"Missed dose recorded.",type:"warning"}),(null===b||void 0===b?void 0:b.id)===e.id&&k(e.id)}catch(a){console.error("Error recording missed dose:",a),c({message:"Error recording missed dose.",type:"danger"})}})(t)},l.a.createElement(y.bb,{className:"me-2"})," Missed"),l.a.createElement("button",{className:"btn btn-info",onClick:()=>(e=>{f(e),k(e.id),g(!0)})(t)},l.a.createElement(y.A,{className:"me-2"})," History"),l.a.createElement("button",{className:"btn btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this medication?")){r(!0);try{const{error:n}=await o.supabase.from("medications").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Medication deleted successfully!",type:"success"})}catch(n){console.error("Error deleting medication:",n),c({message:"Error deleting medication.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(y.fb,null))))))))})()),"add"===i&&l.a.createElement("div",{className:"tab-pane active"},l.a.createElement("div",{className:"medication-form-card"},l.a.createElement("h3",{className:"form-title"},l.a.createElement(y.Q,{className:"me-2 text-primary"})," Add New Medication"),l.a.createElement("form",{onSubmit:S,className:"medication-form"},l.a.createElement("div",{className:"form-section"},l.a.createElement("h4",{className:"form-section-title"},l.a.createElement(y.P,{className:"me-2 text-primary"})," Basic Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"medication_name",className:"form-label text-dark"},l.a.createElement("span",{className:"text-danger"},"*")," Medication Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"medication_name",value:d.name,onChange:e=>u(a=>({...a,name:e.target.value})),placeholder:"e.g., Paracetamol",required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"total_tablets",className:"form-label text-dark"},l.a.createElement("span",{className:"text-danger"},"*")," Total Tablets"),l.a.createElement("input",{type:"number",className:"form-control",id:"total_tablets",value:d.total_tablets,onChange:e=>u(a=>({...a,total_tablets:e.target.value})),placeholder:"e.g., 30",required:!0})))),l.a.createElement("div",{className:"form-section"},l.a.createElement("h4",{className:"form-section-title"},l.a.createElement(y.a,{className:"me-2 text-primary"})," Dosage Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("label",{htmlFor:"dose_per_intake",className:"form-label text-dark"},l.a.createElement("span",{className:"text-danger"},"*")," Tablets per Dose"),l.a.createElement("input",{type:"number",className:"form-control",id:"dose_per_intake",value:d.dose_per_intake,onChange:e=>u(a=>({...a,dose_per_intake:e.target.value})),placeholder:"e.g., 2",required:!0})),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("label",{htmlFor:"times_per_day",className:"form-label text-dark"},"Times per Day"),l.a.createElement("select",{className:"form-control",id:"times_per_day",value:d.times_per_day,onChange:e=>u(a=>({...a,times_per_day:e.target.value}))},l.a.createElement("option",{value:"1"},"Once a Day"),l.a.createElement("option",{value:"2"},"Twice a Day"),l.a.createElement("option",{value:"3"},"Three Times a Day"),l.a.createElement("option",{value:"4"},"Four Times a Day"))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("label",{htmlFor:"reminder_time",className:"form-label text-dark"},l.a.createElement(y.d,{className:"me-1 text-primary"})," Reminder Time"),l.a.createElement("input",{type:"time",className:"form-control",id:"reminder_time",value:d.reminder_time,onChange:e=>u(a=>({...a,reminder_time:e.target.value}))}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"frequency",className:"form-label text-dark"},"Frequency"),l.a.createElement("select",{className:"form-control",id:"frequency",value:d.frequency,onChange:e=>u(a=>({...a,frequency:e.target.value,selected_days:[]}))},l.a.createElement("option",{value:"daily"},"Daily"),l.a.createElement("option",{value:"twice_week"},"Twice a Week"),l.a.createElement("option",{value:"thrice_week"},"Three Times a Week"),l.a.createElement("option",{value:"once_week"},"Once a Week"),l.a.createElement("option",{value:"alternate"},"Alternate Days"))),("twice_week"===d.frequency||"thrice_week"===d.frequency||"once_week"===d.frequency)&&l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{className:"form-label text-dark"},"Select Days"),l.a.createElement("div",{className:"d-flex flex-wrap gap-2"},["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(e=>l.a.createElement("button",{key:e,type:"button",className:"btn btn-sm "+(d.selected_days.includes(e)?"btn-primary":"btn-outline-primary"),onClick:()=>(e=>{u(a=>{const t=a.selected_days.includes(e)?a.selected_days.filter(a=>a!==e):[...a.selected_days,e];return{...a,selected_days:t}})})(e)},e.substring(0,3))))))),l.a.createElement("div",{className:"form-actions"},l.a.createElement("button",{type:"submit",className:"btn btn-primary btn-lg"},l.a.createElement(y.Q,{className:"me-2"})," Add Medication"),l.a.createElement("button",{type:"button",className:"btn btn-light btn-lg ms-auto",onClick:()=>m("medications")},"Back to Medications"))))))),h&&b&&l.a.createElement("div",{className:"history-section"},l.a.createElement("h3",null,l.a.createElement(y.A,{className:"me-2"}),"History for ",b.name),l.a.createElement("table",{className:"history-table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Time"),l.a.createElement("th",null,"Status"),l.a.createElement("th",null,"Notes"))),l.a.createElement("tbody",null,p.length>0?p.map(e=>l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,new Date(e.taken_at).toLocaleDateString()),l.a.createElement("td",null,new Date(e.taken_at).toLocaleTimeString()),l.a.createElement("td",null,l.a.createElement("span",{className:"status-badge status-"+e.status},e.status.charAt(0).toUpperCase()+e.status.slice(1))),l.a.createElement("td",null,e.notes||"-"))):l.a.createElement("tr",null,l.a.createElement("td",{colSpan:"4",className:"text-center"},"No history records found")))),l.a.createElement("button",{className:"btn btn-secondary mt-3",onClick:()=>g(!1)},"Close History")))},U=t(22),M=t(8);M.f.register(M.e,M.k,M.m,M.j,M.r,M.s,M.h);var H=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)("weight"),[d,u]=Object(n.useState)("6months"),[p,E]=Object(n.useState)(null),[h,g]=Object(n.useState)(!1),[b,f]=Object(n.useState)({weight:"",heart_rate:"",blood_pressure_systolic:"",blood_pressure_diastolic:"",blood_sugar:"",oxygen_saturation:"",recorded_at:(new Date).toISOString().split("T")[0]});Object(n.useEffect)(()=>{N()},[]),Object(n.useEffect)(()=>{e.length>0&&_()},[e,i,d]);const N=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await o.supabase.from("health_metrics").select("*").eq("user_id",e.id).order("recorded_at",{ascending:!0});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching health data:",e),c({message:"Error fetching health data.",type:"danger"})}finally{r(!1)}},w=e=>{const{name:a,value:t}=e.target;f(e=>({...e,[a]:t}))},_=()=>{const a=new Date;let t=[...e];if("1month"===d){const n=new Date(a.setMonth(a.getMonth()-1));t=e.filter(e=>new Date(e.recorded_at)>=n)}else if("3months"===d){const n=new Date(a.setMonth(a.getMonth()-3));t=e.filter(e=>new Date(e.recorded_at)>=n)}else if("6months"===d){const n=new Date(a.setMonth(a.getMonth()-6));t=e.filter(e=>new Date(e.recorded_at)>=n)}else if("1year"===d){const n=new Date(a.setFullYear(a.getFullYear()-1));t=e.filter(e=>new Date(e.recorded_at)>=n)}const n=t.map(e=>new Date(e.recorded_at).toLocaleDateString()),l=t.map(e=>e[i]||0);let r="#4bc0c0",s="rgba(75, 192, 192, 0.2)";switch(i){case"weight":r="#4bc0c0",s="rgba(75, 192, 192, 0.2)";break;case"heart_rate":r="#ff6384",s="rgba(255, 99, 132, 0.2)";break;case"blood_pressure_systolic":case"blood_pressure_diastolic":r="#ff9f40",s="rgba(255, 159, 64, 0.2)";break;case"blood_sugar":r="#9966ff",s="rgba(153, 102, 255, 0.2)";break;case"oxygen_saturation":r="#36a2eb",s="rgba(54, 162, 235, 0.2)"}E({labels:n,datasets:[{label:x(i),data:l,borderColor:r,backgroundColor:s,tension:.1,fill:!0}]})},x=e=>{switch(e){case"weight":return"Weight (kg)";case"heart_rate":return"Heart Rate (bpm)";case"blood_pressure_systolic":return"Blood Pressure - Systolic (mmHg)";case"blood_pressure_diastolic":return"Blood Pressure - Diastolic (mmHg)";case"blood_sugar":return"Blood Sugar (mg/dL)";case"oxygen_saturation":return"Oxygen Saturation (%)";default:return e}},S=a=>{if(0===e.length)return"N/A";const t=[...e].sort((e,a)=>new Date(a.recorded_at)-new Date(e.recorded_at)),n=t[0][a];if(void 0===n||null===n)return"N/A";switch(a){case"weight":return n+" kg";case"heart_rate":return n+" bpm";case"blood_pressure_systolic":return`${n}/${t[0].blood_pressure_diastolic||"N/A"} mmHg`;case"blood_pressure_diastolic":return`${t[0].blood_pressure_systolic||"N/A"}/${n} mmHg`;case"blood_sugar":return n+" mg/dL";case"oxygen_saturation":return n+"%";default:return n}};return t&&0===e.length?l.a.createElement(v,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},l.a.createElement("h1",null,l.a.createElement(y.g,{className:"me-2"})," Health Analytics"),l.a.createElement("div",null,l.a.createElement("button",{className:"btn btn-primary me-2",onClick:()=>g(!h)},h?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.bb,null)," Cancel"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.Q,null)," Add New Metrics")),e.length>0&&l.a.createElement("button",{className:"btn btn-success",onClick:()=>{const a=e.map(e=>[new Date(e.recorded_at).toLocaleDateString(),e.weight||"",e.heart_rate||"",`${e.blood_pressure_systolic||""}/${e.blood_pressure_diastolic||""}`,e.blood_sugar||"",e.oxygen_saturation?e.oxygen_saturation+"%":""]),t=[["Date","Weight (kg)","Heart Rate (bpm)","Blood Pressure (mmHg)","Blood Sugar (mg/dL)","Oxygen Saturation (%)"].join(","),...a.map(e=>e.join(","))].join("\n"),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(n),r=document.createElement("a");r.setAttribute("href",l),r.setAttribute("download",`health_metrics_${(new Date).toISOString().split("T")[0]}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},"Export Data"))),h&&l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h3",{className:"mb-0"},"Add New Health Metrics")),l.a.createElement("div",{className:"card-body"},l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const a=Object.fromEntries(Object.entries(b).filter(e=>{let[a,t]=e;return""!==t}));a.user_id=e.id;const{error:t}=await o.supabase.from("health_metrics").insert([a]);if(t)throw t;c({message:"Health metrics added successfully!",type:"success"}),g(!1),f({weight:"",heart_rate:"",blood_pressure_systolic:"",blood_pressure_diastolic:"",blood_sugar:"",oxygen_saturation:"",recorded_at:(new Date).toISOString().split("T")[0]}),N()}catch(a){console.error("Error adding health metrics:",a),c({message:"Error adding health metrics.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"recorded_at",className:"form-label"},"Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"recorded_at",name:"recorded_at",value:b.recorded_at,onChange:w,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"weight",className:"form-label"},"Weight (kg)"),l.a.createElement("input",{type:"number",step:"0.1",className:"form-control",id:"weight",name:"weight",value:b.weight,onChange:w,placeholder:"e.g. 70.5"}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"heart_rate",className:"form-label"},"Heart Rate (bpm)"),l.a.createElement("input",{type:"number",className:"form-control",id:"heart_rate",name:"heart_rate",value:b.heart_rate,onChange:w,placeholder:"e.g. 72"})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"oxygen_saturation",className:"form-label"},"Oxygen Saturation (%)"),l.a.createElement("input",{type:"number",min:"0",max:"100",className:"form-control",id:"oxygen_saturation",name:"oxygen_saturation",value:b.oxygen_saturation,onChange:w,placeholder:"e.g. 98"}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"blood_pressure_systolic",className:"form-label"},"Blood Pressure - Systolic (mmHg)"),l.a.createElement("input",{type:"number",className:"form-control",id:"blood_pressure_systolic",name:"blood_pressure_systolic",value:b.blood_pressure_systolic,onChange:w,placeholder:"e.g. 120"})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"blood_pressure_diastolic",className:"form-label"},"Blood Pressure - Diastolic (mmHg)"),l.a.createElement("input",{type:"number",className:"form-control",id:"blood_pressure_diastolic",name:"blood_pressure_diastolic",value:b.blood_pressure_diastolic,onChange:w,placeholder:"e.g. 80"}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"blood_sugar",className:"form-label"},"Blood Sugar (mg/dL)"),l.a.createElement("input",{type:"number",className:"form-control",id:"blood_sugar",name:"blood_sugar",value:b.blood_sugar,onChange:w,placeholder:"e.g. 100"})),l.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:t},t?"Saving...":"Save Metrics")))),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No health data available. Please add health metrics to see analytics."):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"row mb-4"},l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card shadow h-100"},l.a.createElement("div",{className:"card-body text-center"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.nb,{className:"me-2"})," Weight"),l.a.createElement("h2",{className:"card-text"},S("weight"))))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card shadow h-100"},l.a.createElement("div",{className:"card-body text-center"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.z,{className:"me-2"})," Heart Rate"),l.a.createElement("h2",{className:"card-text"},S("heart_rate"))))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card shadow h-100"},l.a.createElement("div",{className:"card-body text-center"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.cb,{className:"me-2"})," Blood Pressure"),l.a.createElement("h2",{className:"card-text"},S("blood_pressure_systolic")))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"metricSelect",className:"form-label"},"Select Metric"),l.a.createElement("select",{id:"metricSelect",className:"form-select",value:i,onChange:e=>m(e.target.value)},l.a.createElement("option",{value:"weight"},"Weight"),l.a.createElement("option",{value:"heart_rate"},"Heart Rate"),l.a.createElement("option",{value:"blood_pressure_systolic"},"Blood Pressure (Systolic)"),l.a.createElement("option",{value:"blood_pressure_diastolic"},"Blood Pressure (Diastolic)"),l.a.createElement("option",{value:"blood_sugar"},"Blood Sugar"),l.a.createElement("option",{value:"oxygen_saturation"},"Oxygen Saturation"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"timeRangeSelect",className:"form-label"},"Time Range"),l.a.createElement("select",{id:"timeRangeSelect",className:"form-select",value:d,onChange:e=>u(e.target.value)},l.a.createElement("option",{value:"1month"},"Last Month"),l.a.createElement("option",{value:"3months"},"Last 3 Months"),l.a.createElement("option",{value:"6months"},"Last 6 Months"),l.a.createElement("option",{value:"1year"},"Last Year"),l.a.createElement("option",{value:"all"},"All Time")))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",{className:"mb-0"},(e=>{switch(e){case"weight":return l.a.createElement(y.nb,null);case"heart_rate":return l.a.createElement(y.z,null);case"blood_pressure_systolic":case"blood_pressure_diastolic":case"blood_sugar":return l.a.createElement(y.cb,null);case"oxygen_saturation":return l.a.createElement(y.K,null);default:return l.a.createElement(y.g,null)}})(i)," ",x(i)," Trend")),l.a.createElement("div",{className:"card-body"},p?l.a.createElement(U.b,{data:p,options:{responsive:!0,plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1}},scales:{y:{beginAtZero:!1}}}}):l.a.createElement("p",{className:"text-center"},"No data available for the selected metric and time range."))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",{className:"mb-0"},"Health Insights")),l.a.createElement("div",{className:"card-body"},l.a.createElement("p",null,"This dashboard provides a visual representation of your health metrics over time. Track your progress and identify trends to better manage your health."),l.a.createElement("p",null,"For personalized health advice, please consult with your healthcare provider.")))))};var B=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)(!1),[d,u]=Object(n.useState)({id:null,doctor_name:"",specialty:"",date:"",time:"",location:"",notes:"",reminder_set:!1});Object(n.useEffect)(()=>{p()},[]);const p=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:l}=await o.supabase.from("appointments").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(l)throw l;a(n||[])}catch(e){console.error("Error fetching appointments:",e),c({message:"Error fetching appointments.",type:"danger"})}finally{r(!1)}},E=e=>{const{name:a,value:t,type:n,checked:l}=e.target;u(e=>({...e,[a]:"checkbox"===n?l:t}))},h=()=>{m(!1),u({id:null,doctor_name:"",specialty:"",date:"",time:"",location:"",notes:"",reminder_set:!1})},g=e=>e===(new Date).toISOString().split("T")[0],b=e=>{const a=new Date,t=new Date(e)-a,n=Math.ceil(t/864e5);return n>0&&n<=3};return t&&0===e.length?l.a.createElement(v,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(y.e,{className:"me-2"})," Upcoming Appointments"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Appointment":"Schedule New Appointment"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await o.supabase.from("appointments").update({doctor_name:d.doctor_name,specialty:d.specialty,date:d.date,time:d.time,location:d.location,notes:d.notes,reminder_set:d.reminder_set}).eq("id",d.id);if(e)throw e;c({message:"Appointment updated successfully!",type:"success"})}else{const{error:a}=await o.supabase.from("appointments").insert([{doctor_name:d.doctor_name,specialty:d.specialty,date:d.date,time:d.time,location:d.location,notes:d.notes,reminder_set:d.reminder_set,user_id:e.id}]);if(a)throw a;c({message:"Appointment added successfully!",type:"success"})}h(),p()}catch(a){console.error("Error saving appointment:",a),c({message:"Error saving appointment.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"doctor_name",className:"form-label"},"Doctor Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"doctor_name",name:"doctor_name",value:d.doctor_name,onChange:E,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"specialty",className:"form-label"},"Specialty"),l.a.createElement("input",{type:"text",className:"form-control",id:"specialty",name:"specialty",value:d.specialty,onChange:E}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"date",className:"form-label"},"Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"date",name:"date",value:d.date,onChange:E,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"time",className:"form-label"},"Time"),l.a.createElement("input",{type:"time",className:"form-control",id:"time",name:"time",value:d.time,onChange:E,required:!0}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"location",className:"form-label"},"Location"),l.a.createElement("input",{type:"text",className:"form-control",id:"location",name:"location",value:d.location,onChange:E,required:!0})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:d.notes,onChange:E})),l.a.createElement("div",{className:"mb-3 form-check"},l.a.createElement("input",{type:"checkbox",className:"form-check-input",id:"reminder_set",name:"reminder_set",checked:d.reminder_set,onChange:E}),l.a.createElement("label",{className:"form-check-label",htmlFor:"reminder_set"},"Set Reminder")),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.q,{className:"me-2"})," Update Appointment"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.Q,{className:"me-2"})," Schedule Appointment")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:h},"Cancel")))),e.some(e=>g(e.date))&&l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h3",{className:"mb-0"},l.a.createElement(y.l,{className:"me-2"})," Today's Appointments")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},e.filter(e=>g(e.date)).map(e=>l.a.createElement("div",{key:"today-"+e.id,className:"col-md-6 mb-3"},l.a.createElement("div",{className:"card h-100 border-primary"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},e.doctor_name),l.a.createElement("h6",{className:"card-subtitle mb-2 text-muted"},e.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.l,{className:"me-2"})," ",e.time,l.a.createElement("br",null),l.a.createElement(y.L,{className:"me-2"})," ",e.location),e.notes&&l.a.createElement("p",{className:"card-text"},e.notes)))))))),l.a.createElement("h2",{className:"text-center mb-3"},"All Upcoming Appointments"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No upcoming appointments. Schedule your first appointment above."):l.a.createElement("div",{className:"row"},e.map(t=>l.a.createElement("div",{key:t.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow "+(g(t.date)?"border-primary":b(t.date)?"border-warning":"")},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},l.a.createElement("h5",{className:"mb-0"},l.a.createElement(y.kb,{className:"me-2"})," ",t.doctor_name),g(t.date)&&l.a.createElement("span",{className:"badge bg-primary"},"Today"),b(t.date)&&!g(t.date)&&l.a.createElement("span",{className:"badge bg-warning text-dark"},"Soon")),l.a.createElement("div",{className:"card-body"},t.specialty&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Specialty:")," ",t.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.e,{className:"me-2"})," ",new Date(t.date).toLocaleDateString()),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.l,{className:"me-2"})," ",t.time),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.L,{className:"me-2"})," ",t.location),t.notes&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Notes:"),l.a.createElement("br",null),t.notes),t.reminder_set&&l.a.createElement("p",{className:"card-text"},l.a.createElement("span",{className:"badge bg-info text-dark"},"Reminder Set"))),l.a.createElement("div",{className:"card-footer d-flex justify-content-between"},l.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{m(!0),u(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(y.q,{className:"me-1"})," Edit"),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this appointment?")){r(!0);try{const{error:n}=await o.supabase.from("appointments").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Appointment deleted successfully!",type:"success"})}catch(n){console.error("Error deleting appointment:",n),c({message:"Error deleting appointment.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(y.fb,{className:"me-1"})," Cancel")))))))};var z=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)(""),[d,u]=Object(n.useState)(""),[p,E]=Object(n.useState)(""),[h,g]=Object(n.useState)("desc");Object(n.useEffect)(()=>{b()},[]);const b=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:l}=await o.supabase.from("appointments").select("*").eq("user_id",e.id).lt("date",t).order("date",{ascending:!1});if(l)throw l;a(n||[])}catch(e){console.error("Error fetching appointment history:",e),c({message:"Error fetching appointment history.",type:"danger"})}finally{r(!1)}},f=e.filter(e=>{const a=""===i||e.doctor_name.toLowerCase().includes(i.toLowerCase())||e.specialty&&e.specialty.toLowerCase().includes(i.toLowerCase())||e.location&&e.location.toLowerCase().includes(i.toLowerCase())||e.notes&&e.notes.toLowerCase().includes(i.toLowerCase()),t=""===d||e.date===d,n=""===p||e.doctor_name.toLowerCase().includes(p.toLowerCase());return a&&t&&n}).sort((e,a)=>{const t=new Date(e.date),n=new Date(a.date);return"desc"===h?n-t:t-n});return t&&0===e.length?l.a.createElement(v,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(y.A,{className:"me-2"})," Appointment History"),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row mb-3"},l.a.createElement("div",{className:"col-md-6 mb-2"},l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(y.U,null)),l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search appointments...",value:i,onChange:e=>{m(e.target.value)}}))),l.a.createElement("div",{className:"col-md-3 mb-2"},l.a.createElement("input",{type:"date",className:"form-control",placeholder:"Filter by date",value:d,onChange:e=>{u(e.target.value)}})),l.a.createElement("div",{className:"col-md-3 mb-2"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Filter by doctor",value:p,onChange:e=>{E(e.target.value)}}))),l.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},l.a.createElement("button",{className:"btn btn-outline-secondary",onClick:()=>{g("desc"===h?"asc":"desc")}},"Sort by Date: ","desc"===h?"Newest First":"Oldest First"),l.a.createElement("button",{className:"btn btn-success",onClick:()=>{const e=f.map(e=>[e.doctor_name,e.specialty,new Date(e.date).toLocaleDateString(),e.time,e.location,e.notes]),a=[["Doctor","Specialty","Date","Time","Location","Notes"].join(","),...e.map(e=>e.map(e=>`"${e||""}"`).join(","))].join("\n"),t=new Blob([a],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(t),l=document.createElement("a");l.setAttribute("href",n),l.setAttribute("download",`appointment_history_${(new Date).toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)},disabled:0===f.length},l.a.createElement(y.v,{className:"me-2"})," Export to CSV")))),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No appointment history found."):0===f.length?l.a.createElement("div",{className:"alert alert-warning text-center"},"No appointments match your search criteria."):l.a.createElement("div",{className:"row"},f.map(e=>l.a.createElement("div",{key:e.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h5",{className:"mb-0"},l.a.createElement(y.kb,{className:"me-2"})," ",e.doctor_name)),l.a.createElement("div",{className:"card-body"},e.specialty&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Specialty:")," ",e.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.d,{className:"me-2"})," ",new Date(e.date).toLocaleDateString()),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.l,{className:"me-2"})," ",e.time),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.L,{className:"me-2"})," ",e.location),e.notes&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Notes:"),l.a.createElement("br",null),e.notes)))))))};var $=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)(!1),[d,u]=Object(n.useState)({id:null,doctor_name:"",specialty:"",date:"",time:"",consultation_type:"video",meeting_link:"",notes:"",reminder_set:!1});Object(n.useEffect)(()=>{p()},[]);const p=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await o.supabase.from("telehealth_consultations").select("*").eq("user_id",e.id).order("date",{ascending:!0});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching consultations:",e),c({message:"Error fetching consultations.",type:"danger"})}finally{r(!1)}},E=e=>{const{name:a,value:t,type:n,checked:l}=e.target;u(e=>({...e,[a]:"checkbox"===n?l:t}))},h=()=>{m(!1),u({id:null,doctor_name:"",specialty:"",date:"",time:"",consultation_type:"video",meeting_link:"",notes:"",reminder_set:!1})},g=e=>e===(new Date).toISOString().split("T")[0],b=e=>e<(new Date).toISOString().split("T")[0],f=e=>{const a=new Date,t=new Date(e)-a,n=Math.ceil(t/864e5);return n>0&&n<=3},N=e.filter(e=>!b(e.date)),w=e.filter(e=>b(e.date));return t&&0===e.length?l.a.createElement(v,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(y.mb,{className:"me-2"})," Telehealth Consultations"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Consultation":"Schedule New Consultation"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await o.supabase.from("telehealth_consultations").update({doctor_name:d.doctor_name,specialty:d.specialty,date:d.date,time:d.time,consultation_type:d.consultation_type,meeting_link:d.meeting_link,notes:d.notes,reminder_set:d.reminder_set}).eq("id",d.id);if(e)throw e;c({message:"Consultation updated successfully!",type:"success"})}else{const{error:a}=await o.supabase.from("telehealth_consultations").insert([{doctor_name:d.doctor_name,specialty:d.specialty,date:d.date,time:d.time,consultation_type:d.consultation_type,meeting_link:d.meeting_link,notes:d.notes,reminder_set:d.reminder_set,user_id:e.id}]);if(a)throw a;c({message:"Consultation added successfully!",type:"success"})}h(),p()}catch(a){console.error("Error saving consultation:",a),c({message:"Error saving consultation.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"doctor_name",className:"form-label"},"Doctor Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"doctor_name",name:"doctor_name",value:d.doctor_name,onChange:E,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"specialty",className:"form-label"},"Specialty"),l.a.createElement("input",{type:"text",className:"form-control",id:"specialty",name:"specialty",value:d.specialty,onChange:E}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"date",className:"form-label"},"Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"date",name:"date",value:d.date,onChange:E,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"time",className:"form-label"},"Time"),l.a.createElement("input",{type:"time",className:"form-control",id:"time",name:"time",value:d.time,onChange:E,required:!0}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"consultation_type",className:"form-label"},"Consultation Type"),l.a.createElement("select",{className:"form-control",id:"consultation_type",name:"consultation_type",value:d.consultation_type,onChange:E,required:!0},l.a.createElement("option",{value:"video"},"Video Call"),l.a.createElement("option",{value:"phone"},"Phone Call"),l.a.createElement("option",{value:"chat"},"Chat"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"meeting_link",className:"form-label"},"Meeting Link/Phone Number"),l.a.createElement("input",{type:"text",className:"form-control",id:"meeting_link",name:"meeting_link",value:d.meeting_link,onChange:E,placeholder:"Enter meeting link or phone number"}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:d.notes,onChange:E,placeholder:"Reason for consultation, questions to ask, etc."})),l.a.createElement("div",{className:"mb-3 form-check"},l.a.createElement("input",{type:"checkbox",className:"form-check-input",id:"reminder_set",name:"reminder_set",checked:d.reminder_set,onChange:E}),l.a.createElement("label",{className:"form-check-label",htmlFor:"reminder_set"},"Set Reminder")),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.q,{className:"me-2"})," Update Consultation"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.Q,{className:"me-2"})," Schedule Consultation")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:h},"Cancel")))),e.some(e=>g(e.date))&&l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h3",{className:"mb-0"},l.a.createElement(y.l,{className:"me-2"})," Today's Consultations")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},e.filter(e=>g(e.date)).map(e=>l.a.createElement("div",{key:"today-"+e.id,className:"col-md-6 mb-3"},l.a.createElement("div",{className:"card h-100 border-primary"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},e.doctor_name),l.a.createElement("h6",{className:"card-subtitle mb-2 text-muted"},e.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.l,{className:"me-2"})," ",e.time,l.a.createElement("br",null),"video"===e.consultation_type?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.mb,{className:"me-2"})," Video Call"):"phone"===e.consultation_type?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.O,{className:"me-2"})," Phone Call"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.H,{className:"me-2"})," Chat")),e.meeting_link&&l.a.createElement("p",{className:"card-text"},l.a.createElement("a",{href:"video"===e.consultation_type?e.meeting_link:"tel:"+e.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-success"},"video"===e.consultation_type?"Join Meeting":"Call Now")),e.notes&&l.a.createElement("p",{className:"card-text"},l.a.createElement("small",null,e.notes))))))))),l.a.createElement("h2",{className:"text-center mb-3"},"Upcoming Consultations"),0===N.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No upcoming consultations. Schedule your first consultation above."):l.a.createElement("div",{className:"row"},N.map(t=>l.a.createElement("div",{key:t.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow "+(g(t.date)?"border-primary":f(t.date)?"border-warning":"")},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},l.a.createElement("h5",{className:"mb-0"},l.a.createElement(y.kb,{className:"me-2"})," ",t.doctor_name),g(t.date)&&l.a.createElement("span",{className:"badge bg-primary"},"Today"),f(t.date)&&!g(t.date)&&l.a.createElement("span",{className:"badge bg-warning text-dark"},"Soon")),l.a.createElement("div",{className:"card-body"},t.specialty&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Specialty:")," ",t.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Date:")," ",new Date(t.date).toLocaleDateString()),l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Time:")," ",t.time),l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Type:")," ","video"===t.consultation_type?"Video Call":"phone"===t.consultation_type?"Phone Call":"Chat"),t.meeting_link&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Link/Number:")," ",t.meeting_link),t.notes&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Notes:"),l.a.createElement("br",null),t.notes),t.reminder_set&&l.a.createElement("p",{className:"card-text"},l.a.createElement("span",{className:"badge bg-info text-dark"},"Reminder Set"))),l.a.createElement("div",{className:"card-footer d-flex justify-content-between"},l.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{m(!0),u(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(y.q,{className:"me-1"})," Edit"),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this consultation?")){r(!0);try{const{error:n}=await o.supabase.from("telehealth_consultations").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Consultation deleted successfully!",type:"success"})}catch(n){console.error("Error deleting consultation:",n),c({message:"Error deleting consultation.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(y.fb,{className:"me-1"})," Cancel")))))),w.length>0&&l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"text-center mb-3 mt-5"},"Past Consultations"),l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Doctor"),l.a.createElement("th",null,"Specialty"),l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Time"),l.a.createElement("th",null,"Type"),l.a.createElement("th",null,"Notes"))),l.a.createElement("tbody",null,w.map(e=>l.a.createElement("tr",{key:"past-"+e.id},l.a.createElement("td",null,e.doctor_name),l.a.createElement("td",null,e.specialty),l.a.createElement("td",null,new Date(e.date).toLocaleDateString()),l.a.createElement("td",null,e.time),l.a.createElement("td",null,"video"===e.consultation_type?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.mb,{className:"me-1"})," Video"):"phone"===e.consultation_type?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.O,{className:"me-1"})," Phone"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.H,{className:"me-1"})," Chat")),l.a.createElement("td",null,e.notes))))))))};var W=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)([]),[s,c]=Object(n.useState)(!0),[i,m]=Object(n.useState)(null),[d,u]=Object(n.useState)({email_reminders:!0,sms_reminders:!1,browser_notifications:!0,reminder_time:"24",phone_number:""});Object(n.useEffect)(()=>{p()},[]);const p=async()=>{try{c(!0);const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:l}=await o.supabase.from("appointments").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(l)throw l;const{data:s,error:i}=await o.supabase.from("telehealth_consultations").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(i)throw i;const m=[...(n||[]).map(e=>({...e,type:"appointment"})),...(s||[]).map(e=>({...e,type:"telehealth",doctor_name:e.doctor_name}))].sort((e,a)=>new Date(`${e.date}T${e.time}`)-new Date(`${a.date}T${a.time}`));a(m);const{data:d,error:p}=await o.supabase.from("reminder_settings").select("*").eq("user_id",e.id).single();if(p&&"PGRST116"!==p.code)throw p;d&&u(d);const{data:E,error:h}=await o.supabase.from("reminders").select("*").eq("user_id",e.id).gte("reminder_time",(new Date).toISOString()).order("reminder_time",{ascending:!0});if(h)throw h;r(E||[])}catch(e){console.error("Error fetching data:",e),m({message:"Error fetching data.",type:"danger"})}finally{c(!1)}},E=e=>{const{name:a,value:t,type:n,checked:l}=e.target;u(e=>({...e,[a]:"checkbox"===n?l:t}))},h=e=>e===(new Date).toISOString().split("T")[0],g=e=>{const a=new Date,t=new Date(e)-a,n=Math.ceil(t/864e5);return n>0&&n<=3};return s&&0===e.length&&0===t.length?l.a.createElement(v,null):l.a.createElement("div",{className:"container mt-4"},i&&l.a.createElement("div",{className:`alert alert-${i.type} text-center`},i.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(y.a,{className:"me-2"})," Appointment Reminders"),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",{className:"mb-0"},"Reminder Settings")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("div",{className:"form-check form-switch"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"email_reminders",name:"email_reminders",checked:d.email_reminders,onChange:E}),l.a.createElement("label",{className:"form-check-label",htmlFor:"email_reminders"},"Email Reminders"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("div",{className:"form-check form-switch"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"browser_notifications",name:"browser_notifications",checked:d.browser_notifications,onChange:E}),l.a.createElement("label",{className:"form-check-label",htmlFor:"browser_notifications"},"Browser Notifications")))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("div",{className:"form-check form-switch"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"sms_reminders",name:"sms_reminders",checked:d.sms_reminders,onChange:E}),l.a.createElement("label",{className:"form-check-label",htmlFor:"sms_reminders"},"SMS Reminders"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"phone_number",className:"form-label"},"Phone Number (for SMS)"),l.a.createElement("input",{type:"tel",className:"form-control",id:"phone_number",name:"phone_number",value:d.phone_number,onChange:E,placeholder:"Enter your phone number",disabled:!d.sms_reminders}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"reminder_time",className:"form-label"},"Send Reminders"),l.a.createElement("select",{className:"form-select",id:"reminder_time",name:"reminder_time",value:d.reminder_time,onChange:E},l.a.createElement("option",{value:"1"},"1 hour before"),l.a.createElement("option",{value:"2"},"2 hours before"),l.a.createElement("option",{value:"6"},"6 hours before"),l.a.createElement("option",{value:"12"},"12 hours before"),l.a.createElement("option",{value:"24"},"24 hours before"),l.a.createElement("option",{value:"48"},"2 days before"),l.a.createElement("option",{value:"72"},"3 days before"))),l.a.createElement("div",{className:"col-md-6 mb-3 d-flex align-items-end"},l.a.createElement("button",{className:"btn btn-primary w-100",onClick:async()=>{try{c(!0);const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const{error:a}=await o.supabase.from("reminder_settings").upsert({...d,user_id:e.id});if(a)throw a;m({message:"Reminder settings saved successfully!",type:"success"})}catch(e){console.error("Error saving reminder settings:",e),m({message:"Error saving reminder settings.",type:"danger"})}finally{c(!1)}},disabled:s},"Save Settings"))))),l.a.createElement("h2",{className:"text-center mb-3"},"Active Reminders"),0===t.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No active reminders. Set reminders for your appointments below."):l.a.createElement("div",{className:"table-responsive mb-4"},l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Appointment"),l.a.createElement("th",null,"Doctor"),l.a.createElement("th",null,"Appointment Time"),l.a.createElement("th",null,"Reminder Time"),l.a.createElement("th",null,"Actions"))),l.a.createElement("tbody",null,t.map(e=>l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,"telehealth"===e.appointment_type?"Telehealth":"In-person"),l.a.createElement("td",null,e.doctor_name),l.a.createElement("td",null,new Date(e.appointment_time).toLocaleString()),l.a.createElement("td",null,new Date(e.reminder_time).toLocaleString()),l.a.createElement("td",null,l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async e=>{try{c(!0);const{error:a}=await o.supabase.from("appointment_reminders").delete().eq("id",e);if(a)throw a;r(t.filter(a=>a.id!==e)),m({message:"Reminder deleted successfully!",type:"success"})}catch(a){console.error("Error deleting reminder:",a),m({message:"Error deleting reminder.",type:"danger"})}finally{c(!1)}})(e.id)},l.a.createElement(y.fb,null)))))))),l.a.createElement("h2",{className:"text-center mb-3"},"Upcoming Appointments"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No upcoming appointments found. Schedule appointments to set reminders."):l.a.createElement("div",{className:"row"},e.map(e=>l.a.createElement("div",{key:e.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow "+(h(e.date)?"border-primary":g(e.date)?"border-warning":"")},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},l.a.createElement("h5",{className:"mb-0"},l.a.createElement(y.kb,{className:"me-2"})," ",e.doctor_name),h(e.date)&&l.a.createElement("span",{className:"badge bg-primary"},"Today"),g(e.date)&&!h(e.date)&&l.a.createElement("span",{className:"badge bg-warning text-dark"},"Soon")),l.a.createElement("div",{className:"card-body"},l.a.createElement("p",{className:"card-text"},l.a.createElement(y.d,{className:"me-2"})," ",new Date(e.date).toLocaleDateString()),l.a.createElement("p",{className:"card-text"},l.a.createElement(y.l,{className:"me-2"})," ",e.time),l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Type:")," ","telehealth"===e.type?"Telehealth Consultation":"In-person Appointment"),e.location&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Location:")," ",e.location)),l.a.createElement("div",{className:"card-footer"},l.a.createElement("button",{className:"btn btn-block w-100",onClick:()=>(async e=>{try{c(!0);const{data:{user:a}}=await o.supabase.auth.getUser();if(!a)return void(window.location.href="/");if(e.reminder_set){if("appointment"===e.type){const{error:a}=await o.supabase.from("appointments").update({reminder_set:!1}).eq("id",e.id);if(a)throw a}else{const{error:a}=await o.supabase.from("telehealth_consultations").update({reminder_set:!1}).eq("id",e.id);if(a)throw a}const{error:a}=await o.supabase.from("reminders").delete().eq("appointment_id",e.id).eq("appointment_type",e.type);if(a)throw a;m({message:"Reminder removed successfully!",type:"success"})}else{const t=new Date(`${e.date}T${e.time}`),n=parseInt(d.reminder_time,10),l=new Date(t.getTime()-60*n*60*1e3);if("appointment"===e.type){const{error:a}=await o.supabase.from("appointments").update({reminder_set:!0}).eq("id",e.id);if(a)throw a}else{const{error:a}=await o.supabase.from("telehealth_consultations").update({reminder_set:!0}).eq("id",e.id);if(a)throw a}const{error:r}=await o.supabase.from("reminders").insert([{user_id:a.id,appointment_id:e.id,appointment_type:e.type,reminder_time:l.toISOString(),appointment_time:t.toISOString(),doctor_name:e.doctor_name,location:e.location||"",sent:!1}]);if(r)throw r;m({message:"Reminder set successfully!",type:"success"})}p()}catch(a){console.error("Error toggling reminder:",a),m({message:"Error toggling reminder.",type:"danger"})}finally{c(!1)}})(e),disabled:s},e.reminder_set?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.eb,{className:"me-2"})," Reminder On"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.db,{className:"me-2"})," Set Reminder"))))))))};var Y=()=>{const[e,a]=Object(n.useState)(""),[t,r]=Object(n.useState)("all"),[s,c]=Object(n.useState)({}),[i,m]=Object(n.useState)([]),[d,u]=Object(n.useState)([]),[p,E]=Object(n.useState)(!0),[h,g]=Object(n.useState)(null),[b,f]=Object(n.useState)([]),N=Object(n.useCallback)(async()=>{try{E(!0);const{data:e,error:a}=await o.supabase.from("faqs").select("*").order("id");if(a)throw a;const{data:t,error:n}=await o.supabase.from("tutorials").select("*").order("id");if(n)throw n;m(e||[]),u(t||[]);const l=[...new Set(e.map(e=>e.category))],r=[...new Set(t.map(e=>e.category))],s=[...new Set([...l,...r])];f(s)}catch(e){console.error("Error fetching help center data:",e),g({message:"Error loading help center content.",type:"danger"}),m(w),u(_),f([...new Set([...w.map(e=>e.category),..._.map(e=>e.category)])])}finally{E(!1)}},[]);Object(n.useEffect)(()=>{N()},[N]);const w=[{id:1,category:"account",question:"How do I create an account?",answer:'To create an account, click on the "Sign Up" button on the login page. Fill in your personal details, including your email address and a secure password. Follow the verification steps sent to your email to complete the registration process.'},{id:2,category:"account",question:"How do I reset my password?",answer:'If you forgot your password, click on the "Forgot Password" link on the login page. Enter your registered email address, and we will send you a password reset link. Follow the instructions in the email to create a new password.'},{id:3,category:"appointments",question:"How do I schedule an appointment?",answer:'To schedule an appointment, navigate to the "Appointments" section in the navigation menu and select "Upcoming Appointments". Click on the "Schedule New Appointment" button and fill in the required details such as doctor name, date, time, and location. Click "Schedule Appointment" to confirm.'},{id:4,category:"appointments",question:"How do I cancel or reschedule an appointment?",answer:'To cancel or reschedule an appointment, go to the "Upcoming Appointments" page. Find the appointment you want to modify, then click the "Edit" button to change the date or time, or click the "Cancel" button to cancel the appointment entirely.'},{id:5,category:"medical",question:"How do I add my medical history?",answer:'To add your medical history, navigate to the "Medical History" page from the "Your Journey" menu. Click on "Add New Medical Record" and fill in the details about your condition, diagnosis date, doctor, and treatment. Click "Add Record" to save the information.'},{id:6,category:"medical",question:"How do I track my medications?",answer:'To track your medications, go to the "Medication Tracker" page from the "Your Journey" menu. Enter the medication name, frequency, and quantity, then click "Add Medication". You can view and manage all your medications from this page.'},{id:7,category:"telehealth",question:"How do I join a telehealth consultation?",answer:'To join a telehealth consultation, go to the "Telehealth Consultations" page. On the day of your appointment, you will see your consultation listed under "Today\'s Consultations". Click the "Join Meeting" button at the scheduled time to enter the virtual consultation room.'},{id:8,category:"telehealth",question:"What equipment do I need for a telehealth consultation?",answer:"For a telehealth consultation, you need a device with a camera and microphone (smartphone, tablet, or computer), a stable internet connection, and a quiet, private space. Make sure your device is charged and your browser allows camera and microphone access."},{id:9,category:"data",question:"Is my health data secure?",answer:"Yes, your health data is secure. We use industry-standard encryption and security measures to protect your personal and medical information. Our platform complies with healthcare privacy regulations, and your data is only accessible to you and the healthcare providers you authorize."},{id:10,category:"data",question:"How do I export my health data?",answer:'To export your health data, go to the "Data Backup & Export" page under the "Account" menu. Select the type of data you want to export and the format (PDF, CSV, etc.). Click "Export Data" and follow the prompts to download your information.'}],_=[{id:1,category:"getting-started",title:"Getting Started with DigiHealth",type:"video",description:"Learn the basics of navigating the DigiHealth platform and setting up your profile.",link:"#"},{id:2,category:"appointments",title:"How to Schedule and Manage Appointments",type:"guide",description:"A step-by-step guide to scheduling, rescheduling, and canceling appointments.",link:"#"},{id:3,category:"medical",title:"Managing Your Medical Records",type:"video",description:"Learn how to add, edit, and organize your medical history and records.",link:"#"},{id:4,category:"telehealth",title:"Preparing for Your First Telehealth Consultation",type:"guide",description:"Tips and instructions for a successful virtual healthcare appointment.",link:"#"},{id:5,category:"data",title:"Understanding Your Health Analytics",type:"video",description:"How to interpret and use the health analytics features to monitor your well-being.",link:"#"},{id:6,category:"account",title:"Account Security Best Practices",type:"guide",description:"Learn how to keep your DigiHealth account secure with strong passwords and two-factor authentication.",link:"#"}],x=i.filter(a=>{const n=""===e||a.question.toLowerCase().includes(e.toLowerCase())||a.answer.toLowerCase().includes(e.toLowerCase()),l="all"===t||a.category===t;return n&&l}),S=d.filter(a=>{const n=""===e||a.title.toLowerCase().includes(e.toLowerCase())||a.description.toLowerCase().includes(e.toLowerCase()),l="all"===t||a.category===t;return n&&l});return p?l.a.createElement(v,null):l.a.createElement("div",{className:"container mt-4"},h&&l.a.createElement("div",{className:`alert alert-${h.type} text-center`},h.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(y.b,{className:"me-2"})," Help Center"),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-8 mb-3"},l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(y.U,null)),l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search for help topics...",value:e,onChange:e=>a(e.target.value)}))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("select",{className:"form-select",value:t,onChange:e=>r(e.target.value)},l.a.createElement("option",{value:"all"},"All Categories"),b.map((e,a)=>l.a.createElement("option",{key:a,value:e},e.charAt(0).toUpperCase()+e.slice(1).replace("-"," ")))))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h2",{className:"mb-0"},l.a.createElement(y.S,{className:"me-2"})," Frequently Asked Questions")),l.a.createElement("div",{className:"card-body"},0===x.length?l.a.createElement("div",{className:"alert alert-info"},"No FAQs match your search criteria. Try a different search term or category."):l.a.createElement("div",{className:"accordion"},x.map(e=>l.a.createElement("div",{key:e.id,className:"card mb-2"},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center",onClick:()=>{var a;a=e.id,c(e=>({...e,[a]:!e[a]})),(async e=>{try{s[e]||await o.supabase.from("faq_analytics").insert([{faq_id:e,viewed_at:(new Date).toISOString()}])}catch(a){console.error("Error tracking FAQ view:",a)}})(e.id)},style:{cursor:"pointer"}},l.a.createElement("h5",{className:"mb-0"},e.question),s[e.id]?l.a.createElement(y.j,null):l.a.createElement(y.i,null)),s[e.id]&&l.a.createElement("div",{className:"card-body"},l.a.createElement("p",null,e.answer))))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-success text-white"},l.a.createElement("h2",{className:"mb-0"},l.a.createElement(y.mb,{className:"me-2"})," Tutorials & Guides")),l.a.createElement("div",{className:"card-body"},0===S.length?l.a.createElement("div",{className:"alert alert-info"},"No tutorials match your search criteria. Try a different search term or category."):l.a.createElement("div",{className:"row"},S.map(e=>l.a.createElement("div",{key:e.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100"},l.a.createElement("div",{className:"card-header"},"video"===e.type?l.a.createElement(y.mb,{className:"me-2 text-danger"}):l.a.createElement(y.u,{className:"me-2 text-primary"}),l.a.createElement("span",{className:"badge bg-secondary"},e.category.replace("-"," "))),l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},e.title),l.a.createElement("p",{className:"card-text"},e.description)),l.a.createElement("div",{className:"card-footer"},l.a.createElement("a",{href:e.link,className:"btn btn-primary btn-sm w-100",onClick:()=>(async e=>{try{await o.supabase.from("tutorial_analytics").insert([{tutorial_id:e,clicked_at:(new Date).toISOString()}])}catch(a){console.error("Error tracking tutorial click:",a)}})(e.id),target:"_blank",rel:"noopener noreferrer"},"video"===e.type?"Watch Video":"Read Guide")))))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-info text-white"},l.a.createElement("h2",{className:"mb-0"},"Need More Help?")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card h-100 text-center"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h3",null,"Contact Support"),l.a.createElement("p",null,"Reach out to our support team for personalized assistance."),l.a.createElement("a",{href:"/contact-support",className:"btn btn-primary"},"Contact Support")))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card h-100 text-center"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h3",null,"Live Chat"),l.a.createElement("p",null,"Chat with our support agents in real-time for immediate help."),l.a.createElement("a",{href:"/live-chat",className:"btn btn-primary"},"Start Chat")))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card h-100 text-center"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h3",null,"Email Support"),l.a.createElement("p",null,"Send us an email and we'll get back to you within 24 hours."),l.a.createElement("a",{href:"mailto:support@digihealth.com",className:"btn btn-primary"},"Email Us"))))))))};var G=()=>{const[e,a]=Object(n.useState)(!1),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)({subject:"",category:"general",priority:"medium",message:"",attachFile:null}),[d,u]=Object(n.useState)([]);Object(n.useEffect)(()=>{p()},[]),Object(n.useEffect)(()=>{if(i.subject.length>3||i.message.length>10){const e=`${i.subject} ${i.message}`.toLowerCase(),a=[{question:"How do I reset my password?",answer:'Click on "Forgot Password" on the login page and follow the instructions sent to your email.',keywords:["password","reset","forgot","login","sign in","cannot access"]},{question:"How do I schedule an appointment?",answer:'Go to "Upcoming Appointments" and click "Schedule New Appointment".',keywords:["schedule","appointment","book","doctor","visit","consultation"]},{question:"How do I update my profile information?",answer:'Navigate to "Profile Settings" under the Account menu to edit your personal details.',keywords:["profile","update","change","information","details","personal"]},{question:"How do I export my health data?",answer:'Go to "Data Backup & Export" under the Account menu to download your information.',keywords:["export","download","data","backup","information","records"]},{question:"How do I join a telehealth consultation?",answer:'On the day of your appointment, go to "Telehealth Consultations" and click "Join Meeting".',keywords:["telehealth","virtual","video","call","consultation","join","meeting"]}].filter(a=>a.keywords.some(a=>e.includes(a)));u(a.slice(0,3))}else u([])},[i.subject,i.message]);const p=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");const{data:a,error:t}=await o.supabase.from("detailed_profiles").select("*").eq("id",e.id).single();if(t)throw t;c(a)}catch(e){console.error("Error fetching user profile:",e),r({message:"Error fetching user profile.",type:"danger"})}},E=e=>{const{name:a,value:t}=e.target;m(e=>({...e,[a]:t}))};return l.a.createElement("div",{className:"container mt-4"},t&&l.a.createElement("div",{className:`alert alert-${t.type} text-center`},t.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(y.F,{className:"me-2"})," Contact Support"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-8"},l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h2",{className:"mb-0"},"Submit a Support Request")),l.a.createElement("div",{className:"card-body"},d.length>0&&l.a.createElement("div",{className:"alert alert-info mb-4"},l.a.createElement("h5",null,l.a.createElement(y.G,{className:"me-2"})," Did you know?"),l.a.createElement("p",null,"We found some help articles that might answer your question:"),l.a.createElement("ul",{className:"mb-0"},d.map((e,a)=>l.a.createElement("li",{key:a},l.a.createElement("strong",null,e.question)," - ",e.answer)))),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),a(!0);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void(window.location.href="/");let t=null;if(i.attachFile){const a=`${e.id}-${Date.now()}-${i.attachFile.name}`,{data:n,error:l}=await o.supabase.storage.from("support-attachments").upload(a,i.attachFile);if(l)throw l;const{data:r}=o.supabase.storage.from("support-attachments").getPublicUrl(a);t=r.publicUrl}const{error:n}=await o.supabase.from("support_tickets").insert([{user_id:e.id,subject:i.subject,category:i.category,priority:i.priority,message:i.message,attachment_url:t,status:"open",created_at:(new Date).toISOString()}]);if(n)throw n;r({message:"Support ticket submitted successfully! Our team will respond shortly.",type:"success"}),m({subject:"",category:"general",priority:"medium",message:"",attachFile:null}),document.getElementById("attachFile").value=""}catch(t){console.error("Error submitting support ticket:",t),r({message:"Error submitting support ticket. Please try again.",type:"danger"})}finally{a(!1)}}},l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"subject",className:"form-label"},"Subject"),l.a.createElement("input",{type:"text",className:"form-control",id:"subject",name:"subject",value:i.subject,onChange:E,required:!0,placeholder:"Brief description of your issue"})),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"category",className:"form-label"},"Category"),l.a.createElement("select",{className:"form-select",id:"category",name:"category",value:i.category,onChange:E},l.a.createElement("option",{value:"general"},"General Question"),l.a.createElement("option",{value:"account"},"Account Issues"),l.a.createElement("option",{value:"appointments"},"Appointments"),l.a.createElement("option",{value:"medical"},"Medical Records"),l.a.createElement("option",{value:"telehealth"},"Telehealth"),l.a.createElement("option",{value:"technical"},"Technical Problem"),l.a.createElement("option",{value:"billing"},"Billing & Payments"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"priority",className:"form-label"},"Priority"),l.a.createElement("select",{className:"form-select",id:"priority",name:"priority",value:i.priority,onChange:E},l.a.createElement("option",{value:"low"},"Low - General Question"),l.a.createElement("option",{value:"medium"},"Medium - Need Help Soon"),l.a.createElement("option",{value:"high"},"High - Urgent Issue")))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"message",className:"form-label"},"Message"),l.a.createElement("textarea",{className:"form-control",id:"message",name:"message",rows:"6",value:i.message,onChange:E,required:!0,placeholder:"Please describe your issue in detail. Include any error messages or steps to reproduce the problem."})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"attachFile",className:"form-label"},"Attach File (optional)"),l.a.createElement("input",{type:"file",className:"form-control",id:"attachFile",onChange:e=>{m(a=>({...a,attachFile:e.target.files[0]}))}}),l.a.createElement("div",{className:"form-text"},"You can attach screenshots or documents to help explain your issue (max 5MB).")),l.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:e},e?l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."):"Submit Support Request"))))),l.a.createElement("div",{className:"col-lg-4"},l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-info text-white"},l.a.createElement("h3",{className:"mb-0"},"Contact Information")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement(y.r,{className:"me-3 fs-4 text-primary"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"Email Support"),l.a.createElement("p",{className:"mb-0"},"support@digihealth.com"),l.a.createElement("small",{className:"text-muted"},"Response within 24 hours"))),l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement(y.O,{className:"me-3 fs-4 text-primary"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"Phone Support"),l.a.createElement("p",{className:"mb-0"},"1-800-DIGI-HEALTH"),l.a.createElement("small",{className:"text-muted"},"Mon-Fri, 9am-5pm EST"))),l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement(y.m,{className:"me-3 fs-4 text-primary"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"Live Chat"),l.a.createElement("p",{className:"mb-0"},l.a.createElement("a",{href:"/live-chat",className:"btn btn-sm btn-outline-primary mt-1"},"Start Chat")),l.a.createElement("small",{className:"text-muted"},"Available 24/7"))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-success text-white"},l.a.createElement("h3",{className:"mb-0"},"Support Resources")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement(y.S,{className:"me-3 fs-4 text-success"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"Help Center"),l.a.createElement("p",{className:"mb-0"},l.a.createElement("a",{href:"/help-center",className:"btn btn-sm btn-outline-success mt-1"},"Browse FAQs")))),l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement(y.s,{className:"me-3 fs-4 text-warning"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"System Status"),l.a.createElement("p",{className:"mb-0"},l.a.createElement("span",{className:"badge bg-success"},"All Systems Operational")))))))))};var V=()=>{const{user:e}=d(),[a,t]=Object(n.useState)([]),[r,s]=Object(n.useState)(""),[c,i]=Object(n.useState)(!1),[m,u]=Object(n.useState)(!1),[p,E]=Object(n.useState)("connecting"),[h,g]=Object(n.useState)(null),[b,f]=Object(n.useState)(null),N=Object(n.useRef)(null);Object(n.useEffect)(()=>(v(),()=>{b&&b.unsubscribe()}),[e,b]),Object(n.useEffect)(()=>{w()},[a]);const v=async()=>{try{const{data:a,error:n}=await o.supabase.from("chat_sessions").select("*").eq("user_id",e.id).eq("status","active").single();if(n&&"PGRST116"!==n.code)throw n;let l;if(a)l=a.id;else{const{data:a,error:t}=await o.supabase.from("chat_sessions").insert([{user_id:e.id,status:"active",created_at:(new Date).toISOString()}]).select().single();if(t)throw t;l=a.id}const{data:r,error:s}=await o.supabase.from("chat_messages").select("*").eq("session_id",l).order("created_at",{ascending:!0});if(s)throw s;t(r||[]);const c=o.supabase.channel("chat_messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:"session_id=eq."+l},e=>{t(a=>[...a,e.new])}).subscribe();f(c);const{data:i,error:m}=await o.supabase.from("support_agents").select("*").eq("status","online").single();if(m&&"PGRST116"!==m.code)throw m;i?(g(i),E("connected")):E("waiting")}catch(a){console.error("Error initializing chat:",a),E("error")}},w=()=>{N.current&&N.current.scrollIntoView({behavior:"smooth"})};return l.a.createElement("div",{className:"container-fluid h-100"},l.a.createElement("div",{className:"row h-100"},l.a.createElement("div",{className:"col-md-3 p-0 border-end"},l.a.createElement("div",{className:"p-3 border-bottom"},l.a.createElement("h5",{className:"mb-0"},"Chat Information"),l.a.createElement("small",{className:"text-muted"},"Status: ",l.a.createElement("span",{className:"text-"+("connected"===p?"success":"warning")},p.charAt(0).toUpperCase()+p.slice(1)))),h&&l.a.createElement("div",{className:"p-3"},l.a.createElement("h6",{className:"mb-2"},"Support Agent"),l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement("div",{className:"avatar-circle me-2"},h.name.charAt(0)),l.a.createElement("div",null,l.a.createElement("div",{className:"fw-bold"},h.name),l.a.createElement("small",{className:"text-muted"},h.role))))),l.a.createElement("div",{className:"col-md-9 p-0 d-flex flex-column"},l.a.createElement("div",{className:"flex-grow-1 p-3 overflow-auto",style:{height:"calc(100vh - 200px)"}},a.map((a,t)=>l.a.createElement("div",{key:t,className:`d-flex ${a.user_id===e.id?"justify-content-end":"justify-content-start"} mb-3`},l.a.createElement("div",{className:"chat-message "+(a.user_id===e.id?"bg-primary text-white":"bg-light")},"text"===a.type?l.a.createElement("p",{className:"mb-0"},a.message):"image"===a.type?l.a.createElement("img",{src:"https://aqdzmfhakqdwquszaqle.supabase.co/storage/v1/object/public/chat-attachments/"+a.attachment_url,alt:"Shared image",className:"img-fluid rounded",style:{maxWidth:"200px"}}):l.a.createElement("a",{href:"https://aqdzmfhakqdwquszaqle.supabase.co/storage/v1/object/public/chat-attachments/"+a.attachment_url,target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none"},l.a.createElement(y.t,{className:"me-2"}),a.message)))),l.a.createElement("div",{ref:N})),l.a.createElement("div",{className:"p-3 border-top"},l.a.createElement("form",{onSubmit:async a=>{if(a.preventDefault(),r.trim())try{const{data:a}=await o.supabase.from("chat_sessions").select("id").eq("user_id",e.id).eq("status","active").single();if(!a)throw new Error("No active chat session");const{error:t}=await o.supabase.from("chat_messages").insert([{session_id:a.id,user_id:e.id,message:r.trim(),type:"text",created_at:(new Date).toISOString()}]);if(t)throw t;s("")}catch(t){console.error("Error sending message:",t)}},className:"d-flex gap-2"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Type your message...",value:r,onChange:e=>s(e.target.value),onFocus:()=>i(!0),onBlur:()=>i(!1)}),l.a.createElement("label",{className:"btn btn-outline-primary"},l.a.createElement("input",{type:"file",className:"d-none",onChange:async a=>{const t=a.target.files[0];if(t)try{const a=t.name.split(".").pop(),n=`${Math.random()}.${a}`,l=`${e.id}/${n}`,{error:r}=await o.supabase.storage.from("chat-attachments").upload(l,t);if(r)throw r;const{data:s}=await o.supabase.from("chat_sessions").select("id").eq("user_id",e.id).eq("status","active").single();if(!s)throw new Error("No active chat session");const{error:c}=await o.supabase.from("chat_messages").insert([{session_id:s.id,user_id:e.id,message:t.name,type:t.type.startsWith("image/")?"image":"file",attachment_url:l,created_at:(new Date).toISOString()}]);if(c)throw c}catch(n){console.error("Error uploading file:",n)}},accept:"image/*,.pdf,.doc,.docx"}),l.a.createElement(y.t,null)),l.a.createElement("button",{type:"submit",className:"btn btn-primary"},l.a.createElement(y.N,null)))))))};t(89);var J=()=>{const[e,a]=Object(n.useState)({first_name:null,last_name:null,email:null,date_of_birth:null,gender:null,blood_group:null,height:"",weight:"",allergies:[],medical_conditions:[],emergency_contact_name:null,emergency_contact_phone:null,emergency_contact_relationship:null,phone:null,address:null,bio:"",profile_picture:null}),[t,r]=Object(n.useState)([]),[s,c]=Object(n.useState)(""),[i,m]=Object(n.useState)([]),[u,E]=Object(n.useState)({name:"",value:"",unit:""}),[h,g]=Object(n.useState)(!0),[b,f]=Object(n.useState)(!1),[y,N]=Object(n.useState)("profile"),[w,_]=Object(n.useState)(!1),[x,S]=Object(n.useState)(""),[k,C]=Object(n.useState)([]),[O,I]=Object(n.useState)({name:"",severity:"mild"}),[T,D]=Object(n.useState)([]),[j,R]=Object(n.useState)(!0),{user:F}=d();Object(n.useEffect)(()=>{L(),P(),U(),M();const e=new URLSearchParams(window.location.search).get("section");e&&N(e)},[F]),Object(n.useEffect)(()=>{"diseases"===y&&q()},[y]);const L=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:n}=await o.supabase.from("detailed_profiles").select("*").eq("id",e.id).single();if(n){if("PGRST116"!==n.code)throw n;{const{data:t,error:n}=await o.supabase.from("detailed_profiles").insert([{id:e.id}]).select().single();if(n)throw n;a(t||{})}}else a(t||{})}catch(e){p.b.error("Error fetching profile: "+e.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{g(!1)}},P=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await o.supabase.from("user_diseases").select("*").eq("user_id",e.id);if(t)throw t;r(a||[])}catch(e){console.error("Error fetching diseases:",e)}},q=async()=>{try{const{data:e,error:a}=await o.supabase.from("common_diseases").select("*");if(a)throw a;D(e||[])}catch(e){console.error("Error fetching common diseases:",e)}},U=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await o.supabase.from("user_allergies").select("*").eq("user_id",e.id);if(t)throw t;C(a||[])}catch(e){console.error("Error fetching allergies:",e)}},M=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await o.supabase.from("user_parameters").select("*").eq("user_id",e.id).order("date_recorded",{ascending:!1});if(t)throw t;m(a||[])}catch(e){console.error("Error fetching parameters:",e)}},H=e=>{const{name:t,value:n}=e.target;a(e=>({...e,[t]:n}))};return h?l.a.createElement(v,null):l.a.createElement("div",{className:"profile-page container-fluid"},x&&l.a.createElement("div",{className:"alert alert-info alert-dismissible fade show",role:"alert"},x,l.a.createElement("button",{type:"button",className:"btn-close",onClick:()=>S("")})),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-3 col-md-4"},l.a.createElement("div",{className:"profile-sidebar card mb-3"},l.a.createElement("div",{className:"d-lg-none"},l.a.createElement("button",{className:"btn btn-link w-100 text-start",onClick:()=>R(!j)},l.a.createElement("i",{className:"fas fa-bars me-2"}),"Menu")),l.a.createElement("div",{className:"card-body "+(j?"":"d-none d-lg-block")},l.a.createElement("div",{className:"profile-picture-container mb-3"},l.a.createElement("img",{src:e.profile_picture||"/default-profile.png",alt:"Profile",className:"profile-picture img-fluid rounded-circle mb-2"}),b&&l.a.createElement("div",{className:"mt-2"},l.a.createElement("input",{type:"file",onChange:async e=>{try{_(!0);const t=e.target.files[0];if(!t)return;const{data:{user:n}}=await o.supabase.auth.getUser();if(!n)throw new Error("No user logged in");const l=t.name.split(".").pop(),r=`${n.id}/${Math.random()}.${l}`,{error:s}=await o.supabase.storage.from("profile-pictures").upload(r,t);if(s)throw s;const{data:{publicUrl:c}}=o.supabase.storage.from("profile-pictures").getPublicUrl(r);a(e=>({...e,profile_picture:c}));const{error:i}=await o.supabase.from("detailed_profiles").update({profile_picture:c}).eq("id",n.id);if(i)throw i;p.b.success("Profile picture updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(t){p.b.error("Error uploading image: "+t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{_(!1)}},className:"form-control form-control-sm"})),w&&l.a.createElement(v,null)),l.a.createElement("h3",{className:"mb-0"},e.first_name," ",e.last_name),l.a.createElement("p",{className:"text-muted"},e.email),l.a.createElement("button",{onClick:()=>f(!b),className:`btn ${b?"btn-secondary":"btn-primary"} w-100`},b?"Cancel Editing":"Edit Profile")),l.a.createElement("div",{className:"list-group list-group-flush"},l.a.createElement("button",{className:"list-group-item list-group-item-action "+("profile"===y?"active":""),onClick:()=>N("profile")},l.a.createElement("i",{className:"fas fa-user me-2"})," Basic Information"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("medical"===y?"active":""),onClick:()=>N("medical")},l.a.createElement("i",{className:"fas fa-heartbeat me-2"})," Medical Information"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("emergency"===y?"active":""),onClick:()=>N("emergency")},l.a.createElement("i",{className:"fas fa-phone-alt me-2"})," Emergency Contacts"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("diseases"===y?"active":""),onClick:()=>N("diseases")},l.a.createElement("i",{className:"fas fa-notes-medical me-2"})," Diseases & Conditions"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("parameters"===y?"active":""),onClick:()=>N("parameters")},l.a.createElement("i",{className:"fas fa-chart-line me-2"})," Health Parameters"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("emergency-qr"===y?"active":""),onClick:()=>N("emergency-qr")},l.a.createElement("i",{className:"fas fa-qrcode me-2"})," Emergency QR Code")))),l.a.createElement("div",{className:"col-lg-9 col-md-8"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},"profile"===y&&l.a.createElement("div",{className:"profile-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Basic Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"First Name:"),b?l.a.createElement("input",{type:"text",name:"first_name",value:e.first_name,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.first_name))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Last Name:"),b?l.a.createElement("input",{type:"text",name:"last_name",value:e.last_name,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.last_name))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Email:"),b?l.a.createElement("input",{type:"email",name:"email",value:e.email,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.email))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Phone:"),b?l.a.createElement("input",{type:"tel",name:"phone",value:e.phone,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.phone))),l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Address:"),b?l.a.createElement("input",{type:"text",name:"address",value:e.address,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.address))),l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Bio:"),b?l.a.createElement("textarea",{name:"bio",value:e.bio,onChange:H,className:"form-control",rows:"3"}):l.a.createElement("p",{className:"form-control-plaintext"},e.bio))))),"medical"===y&&l.a.createElement("div",{className:"medical-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Medical Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Date of Birth:"),b?l.a.createElement("input",{type:"date",name:"date_of_birth",value:e.date_of_birth,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.date_of_birth))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Gender:"),b?l.a.createElement("select",{name:"gender",value:e.gender,onChange:H,className:"form-control"},l.a.createElement("option",{value:""},"Select Gender"),l.a.createElement("option",{value:"male"},"Male"),l.a.createElement("option",{value:"female"},"Female"),l.a.createElement("option",{value:"other"},"Other")):l.a.createElement("p",{className:"form-control-plaintext"},e.gender))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Blood Group:"),b?l.a.createElement("select",{name:"blood_group",value:e.blood_group,onChange:H,className:"form-control"},l.a.createElement("option",{value:""},"Select Blood Group"),l.a.createElement("option",{value:"A+"},"A+"),l.a.createElement("option",{value:"A-"},"A-"),l.a.createElement("option",{value:"B+"},"B+"),l.a.createElement("option",{value:"B-"},"B-"),l.a.createElement("option",{value:"AB+"},"AB+"),l.a.createElement("option",{value:"AB-"},"AB-"),l.a.createElement("option",{value:"O+"},"O+"),l.a.createElement("option",{value:"O-"},"O-")):l.a.createElement("p",{className:"form-control-plaintext"},e.blood_group))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Height (cm):"),b?l.a.createElement("input",{type:"number",name:"height",value:e.height,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.height))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Weight (kg):"),b?l.a.createElement("input",{type:"number",name:"weight",value:e.weight,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.weight))))),"emergency"===y&&l.a.createElement("div",{className:"emergency-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Emergency Contact Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Emergency Contact Name:"),b?l.a.createElement("input",{type:"text",name:"emergency_contact_name",value:e.emergency_contact_name,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.emergency_contact_name))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Emergency Contact Phone:"),b?l.a.createElement("input",{type:"tel",name:"emergency_contact_phone",value:e.emergency_contact_phone,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.emergency_contact_phone))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Relationship:"),b?l.a.createElement("input",{type:"text",name:"emergency_contact_relationship",value:e.emergency_contact_relationship,onChange:H,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.emergency_contact_relationship))))),"diseases"===y&&l.a.createElement("div",{className:"diseases-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Diseases & Medical Conditions"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"disease-list mb-4"},t.map(e=>l.a.createElement("span",{key:e.id,className:"badge bg-info me-2 mb-2 p-2"},e.disease_name))),b&&l.a.createElement("div",{className:"input-group mb-3"},l.a.createElement("select",{className:"form-select",value:s,onChange:e=>c(e.target.value)},l.a.createElement("option",{value:""},"Select a disease"),T.map(e=>l.a.createElement("option",{key:e.id,value:e.name},e.name))),l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Or enter a new disease",value:""===s?"":s,onChange:e=>c(e.target.value)}),l.a.createElement("button",{onClick:async()=>{if(s.trim())try{g(!0);const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:n}=await o.supabase.from("user_diseases").select("*").eq("user_id",e.id).eq("disease_name",s).single();if(n&&"PGRST116"!==n.code)throw n;if(a)p.b.info("This disease is already in your list",{position:"top-right",autoClose:3e3});else{const{data:a,error:n}=await o.supabase.from("user_diseases").insert([{user_id:e.id,disease_name:s,date_diagnosed:(new Date).toISOString()}]).select();if(n)throw n;r([...t,...a]),p.b.success("Disease added successfully!",{position:"top-right",autoClose:3e3})}c("")}catch(e){console.error("Error adding disease:",e),p.b.error("Error adding disease: "+e.message,{position:"top-right",autoClose:5e3})}finally{g(!1)}},className:"btn btn-primary"},"Add")))),l.a.createElement("h5",{className:"card-title mb-3 mt-4"},"Allergies"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"allergy-list mb-4"},k.map(e=>l.a.createElement("span",{key:e.id,className:"badge bg-warning text-dark me-2 mb-2 p-2"},e.allergy_name," (",e.severity,")"))),b&&l.a.createElement("div",{className:"row g-2"},l.a.createElement("div",{className:"col-sm-6"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Allergy name",value:O.name,onChange:e=>I({...O,name:e.target.value})})),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("select",{className:"form-select",value:O.severity,onChange:e=>I({...O,severity:e.target.value})},l.a.createElement("option",{value:"mild"},"Mild"),l.a.createElement("option",{value:"moderate"},"Moderate"),l.a.createElement("option",{value:"severe"},"Severe"))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("button",{onClick:async()=>{if(O.name.trim())try{g(!0);const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await o.supabase.from("user_allergies").select("*").eq("user_id",e.id).eq("allergy_name",O.name).single();if(t&&"PGRST116"!==t.code)throw t;if(a)p.b.info("This allergy is already in your list",{position:"top-right",autoClose:3e3});else{const{data:a,error:t}=await o.supabase.from("user_allergies").insert([{user_id:e.id,allergy_name:O.name,severity:O.severity}]).select();if(t)throw t;C([...k,...a]),p.b.success("Allergy added successfully!",{position:"top-right",autoClose:3e3})}I({name:"",severity:"mild"})}catch(e){console.error("Error adding allergy:",e),p.b.error("Error adding allergy: "+e.message,{position:"top-right",autoClose:5e3})}finally{g(!1)}else p.b.warning("Please enter an allergy name",{position:"top-right",autoClose:3e3})},className:"btn btn-primary w-100"},"Add")))))),"parameters"===y&&l.a.createElement("div",{className:"parameters-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Health Parameters"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"parameter-list mb-4"},i.map(e=>l.a.createElement("div",{key:e.id,className:"badge bg-success me-2 mb-2 p-2"},e.parameter_name,": ",e.value," ",e.unit))),b&&l.a.createElement("div",{className:"row g-2"},l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Parameter name",value:u.name,onChange:e=>E({...u,name:e.target.value})})),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Value",value:u.value,onChange:e=>E({...u,value:e.target.value})})),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Unit",value:u.unit,onChange:e=>E({...u,unit:e.target.value})})),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("button",{onClick:async()=>{if(u.name.trim()&&u.value.trim())try{g(!0);const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await o.supabase.from("user_parameters").insert([{user_id:e.id,parameter_name:u.name,value:u.value,unit:u.unit||"",date_recorded:(new Date).toISOString()}]).select();if(t)throw t;m([...i,...a]),E({name:"",value:"",unit:""}),p.b.success("Parameter added successfully!",{position:"top-right",autoClose:3e3})}catch(e){console.error("Error adding parameter:",e),p.b.error("Error adding parameter: "+e.message,{position:"top-right",autoClose:5e3})}finally{g(!1)}else p.b.warning("Please enter both parameter name and value",{position:"top-right",autoClose:3e3})},className:"btn btn-primary w-100"},"Add")))))),"emergency-qr"===y&&l.a.createElement("div",{className:"emergency-qr-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Emergency Medical QR Code"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-8 offset-md-2"},l.a.createElement("div",{className:"alert alert-info"},l.a.createElement("i",{className:"fas fa-info-circle me-2"}),"This QR code contains your essential medical information for emergency situations. Keep it accessible, such as in your wallet, on your phone, or on emergency medical ID."),l.a.createElement(A,{size:180}),l.a.createElement("div",{className:"mt-4"},l.a.createElement("p",{className:"text-muted"},l.a.createElement("i",{className:"fas fa-shield-alt me-2"}),l.a.createElement("strong",null,"Privacy Note:")," The QR code is updated automatically when you change your profile information, allergies, or medical conditions. The information included in the QR code is limited to what would be helpful in a medical emergency."))))),b&&"emergency-qr"!==y&&"parameters"!==y&&"diseases"!==y&&l.a.createElement("div",{className:"mt-4 text-end"},l.a.createElement("button",{onClick:async()=>{g(!0);try{const{data:{user:a}}=await o.supabase.auth.getUser();if(!a)throw new Error("No user logged in");const t={first_name:e.first_name||null,last_name:e.last_name||null,email:e.email||null,date_of_birth:e.date_of_birth||null,gender:e.gender||null,blood_group:e.blood_group||null,height:e.height||null,weight:e.weight||null,phone:e.phone||null,address:e.address||null,emergency_contact_name:e.emergency_contact_name||null,emergency_contact_phone:e.emergency_contact_phone||null,emergency_contact_relationship:e.emergency_contact_relationship||null,profile_picture:e.profile_picture||null,bio:e.bio||null,updated_at:(new Date).toISOString()},{error:n}=await o.supabase.from("detailed_profiles").update(t).eq("id",a.id);if(n)throw n;p.b.success("Profile updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),f(!1)}catch(a){p.b.error("Error updating profile: "+a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{g(!1)}},className:"btn btn-success"},"Save Changes")))))))};var Q=()=>{const[e,a]=Object(n.useState)({twoFactorEnabled:!1,emailNotifications:!0,loginNotifications:!0,passwordExpiry:90,maxLoginAttempts:5}),[t,r]=Object(n.useState)(!1),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)(null);Object(n.useEffect)(()=>{d()},[]);const d=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return;const{data:t,error:n}=await o.supabase.from("security_settings").select("*").eq("user_id",e.id).single();if(n)throw n;t&&a(t)}catch(s){c("Failed to load security settings")}},u=e=>{const{name:t,value:n,type:l,checked:r}=e.target;a(e=>({...e,[t]:"checkbox"===l?r:n}))};return l.a.createElement("div",{className:"container mt-4"},l.a.createElement("h2",{className:"mb-4"},"Security Settings"),s&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},s),i&&l.a.createElement("div",{className:"alert alert-success",role:"alert"},i),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("form",{onSubmit:async a=>{a.preventDefault(),r(!0),c(null),m(null);try{const{data:{user:a}}=await o.supabase.auth.getUser();if(!a)throw new Error("No user found");const{error:t}=await o.supabase.from("security_settings").upsert({user_id:a.id,...e,updated_at:(new Date).toISOString()});if(t)throw t;m("Security settings updated successfully")}catch(s){c(s.message)}finally{r(!1)}}},l.a.createElement("div",{className:"mb-4"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.V,{className:"me-2"}),"Two-Factor Authentication"),l.a.createElement("div",{className:"form-check form-switch"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"twoFactorEnabled",name:"twoFactorEnabled",checked:e.twoFactorEnabled,onChange:u}),l.a.createElement("label",{className:"form-check-label",htmlFor:"twoFactorEnabled"},"Enable two-factor authentication"))),l.a.createElement("div",{className:"mb-4"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.jb,{className:"me-2"}),"Login Security"),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Maximum Login Attempts"),l.a.createElement("input",{type:"number",className:"form-control",name:"maxLoginAttempts",value:e.maxLoginAttempts,onChange:u,min:"1",max:"10"})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Password Expiry (days)"),l.a.createElement("input",{type:"number",className:"form-control",name:"passwordExpiry",value:e.passwordExpiry,onChange:u,min:"30",max:"365"}))),l.a.createElement("div",{className:"mb-4"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.A,{className:"me-2"}),"Activity Notifications"),l.a.createElement("div",{className:"form-check mb-2"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"emailNotifications",name:"emailNotifications",checked:e.emailNotifications,onChange:u}),l.a.createElement("label",{className:"form-check-label",htmlFor:"emailNotifications"},"Email notifications for security events")),l.a.createElement("div",{className:"form-check"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"loginNotifications",name:"loginNotifications",checked:e.loginNotifications,onChange:u}),l.a.createElement("label",{className:"form-check-label",htmlFor:"loginNotifications"},"Notify on new device login"))),l.a.createElement("div",{className:"mb-4"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.E,{className:"me-2"}),"Password Management"),l.a.createElement("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>{}},"Change Password")),l.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:t},t?"Saving...":"Save Security Settings")))))};var X=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!1),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)(null);Object(n.useEffect)(()=>{d()},[]);const d=async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return;const{data:t,error:n}=await o.supabase.from("backup_history").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(n)throw n;a(t||[])}catch(s){c("Failed to load backup history")}};return l.a.createElement("div",{className:"container mt-4"},l.a.createElement("h2",{className:"mb-4"},"Data Backup & Restore"),s&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},s),i&&l.a.createElement("div",{className:"alert alert-success",role:"alert"},i),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.p,{className:"me-2"}),"Export Data"),l.a.createElement("p",{className:"card-text"},"Download a backup of your health data, including profile information, health records, appointments, and medications."),l.a.createElement("button",{className:"btn btn-primary",onClick:async()=>{r(!0),c(null),m(null);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user found");const[{data:a},{data:t},{data:n},{data:l},{data:s},{data:c}]=await Promise.all([o.supabase.from("profiles").select("*").eq("id",e.id).single(),o.supabase.from("health_metrics").select("*").eq("user_id",e.id),o.supabase.from("appointments").select("*").eq("user_id",e.id),o.supabase.from("medications").select("*").eq("user_id",e.id),o.supabase.from("medical_conditions").select("*").eq("user_id",e.id),o.supabase.from("health_alerts").select("*").eq("user_id",e.id)]),{data:i,error:u}=await o.supabase.from("backup_history").insert([{user_id:e.id,type:"export",status:"completed",created_at:(new Date).toISOString(),backup_data:{profile:a,healthMetrics:t,appointments:n,medications:l,medicalConditions:s,healthAlerts:c}}]).select().single();if(u)throw u;const p={profile:a,healthMetrics:t,appointments:n,medications:l,medicalConditions:s,healthAlerts:c,exportDate:(new Date).toISOString()},E=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),h=window.URL.createObjectURL(E),g=document.createElement("a");g.href=h,g.download=`digihealth-backup-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(h),document.body.removeChild(g),m("Data exported successfully"),d()}catch(s){c(s.message)}finally{r(!1)}},disabled:t},t?"Exporting...":"Export Data"))),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.hb,{className:"me-2"}),"Import Data"),l.a.createElement("p",{className:"card-text"},"Restore your health data from a previous backup file."),l.a.createElement("input",{type:"file",className:"form-control mb-3",accept:".json",onChange:async e=>{const a=e.target.files[0];if(a){r(!0),c(null),m(null);try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user found");const t=new FileReader;t.onload=async a=>{try{const t=JSON.parse(a.target.result),{data:n,error:l}=await o.supabase.from("backup_history").insert([{user_id:e.id,type:"import",status:"completed",created_at:(new Date).toISOString()}]).select().single();if(l)throw l;t.profile&&await o.supabase.from("profiles").upsert({...t.profile,id:e.id}),t.healthMetrics&&await o.supabase.from("health_metrics").upsert(t.healthMetrics.map(a=>({...a,user_id:e.id}))),t.appointments&&await o.supabase.from("appointments").upsert(t.appointments.map(a=>({...a,user_id:e.id}))),t.medications&&await o.supabase.from("medications").upsert(t.medications.map(a=>({...a,user_id:e.id}))),t.medicalConditions&&await o.supabase.from("medical_conditions").upsert(t.medicalConditions.map(a=>({...a,user_id:e.id}))),t.healthAlerts&&await o.supabase.from("health_alerts").upsert(t.healthAlerts.map(a=>({...a,user_id:e.id}))),m("Data imported successfully"),d()}catch(s){c("Invalid backup file format")}},t.readAsText(a)}catch(s){c(s.message)}finally{r(!1)}}},disabled:t})))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.A,{className:"me-2"}),"Backup History"),l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Type"),l.a.createElement("th",null,"Status"))),l.a.createElement("tbody",null,e.map(e=>l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,new Date(e.created_at).toLocaleString()),l.a.createElement("td",null,"export"===e.type?l.a.createElement(y.p,{className:"me-1"}):l.a.createElement(y.hb,{className:"me-1"}),e.type.charAt(0).toUpperCase()+e.type.slice(1)),l.a.createElement("td",null,l.a.createElement("span",{className:"badge bg-"+("completed"===e.status?"success":"warning")},e.status))))))))))))},Z=t(59);var K=()=>{const[e,a]=Object(n.useState)(!1),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)([]),i=console.log,o=console.error,m=console.warn;return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.n,{className:"me-2"}),"Database Setup"),l.a.createElement("p",{className:"card-text"},"This utility will delete all existing tables and buckets in your Supabase project and recreate them with the proper structure.",l.a.createElement("strong",{className:"text-danger"}," Use with caution as this will delete all existing data!")),t&&l.a.createElement("div",{className:`alert ${t.success?"alert-success":"alert-danger"} mt-3`,role:"alert"},t.success?l.a.createElement(y.h,{className:"me-2"}):l.a.createElement(y.s,{className:"me-2"}),t.message),l.a.createElement("div",{className:"d-grid gap-2 mt-3"},l.a.createElement("button",{className:"btn btn-danger",onClick:async()=>{a(!0),r(null),c([]),console.log=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];c(e=>[...e,{type:"info",message:a.join(" ")}]),i(...a)},console.error=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];c(e=>[...e,{type:"error",message:a.join(" ")}]),o(...a)},console.warn=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];c(e=>[...e,{type:"warning",message:a.join(" ")}]),m(...a)};try{const e=await Object(Z.setupSupabaseTables)();r(e)}catch(e){r({success:!1,message:"Unexpected error: "+e.message})}finally{console.log=i,console.error=o,console.warn=m,a(!1)}},disabled:e},e?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.X,{className:"me-2 fa-spin"}),"Setting up database..."):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.n,{className:"me-2"}),"Reset and Setup Database"))),s.length>0&&l.a.createElement("div",{className:"mt-4"},l.a.createElement("h6",null,"Setup Logs:"),l.a.createElement("div",{className:"border rounded p-3 bg-light",style:{maxHeight:"300px",overflow:"auto"}},s.map((e,a)=>l.a.createElement("div",{key:a,className:"mb-1 "+("error"===e.type?"text-danger":"warning"===e.type?"text-warning":"")},e.message))))))};var ee=()=>{var e;const{user:a}=d(),[t,r]=Object(n.useState)("");if(!a||"admin"!==(null===(e=a.user_metadata)||void 0===e?void 0:e.role))return l.a.createElement(i.a,{to:"/dashboard"});return l.a.createElement("div",{className:"container py-4"},l.a.createElement("h1",{className:"mb-4"},l.a.createElement(y.n,{className:"me-2"}),"Database Management"),l.a.createElement("div",{className:"alert alert-warning mb-4",role:"alert"},l.a.createElement(y.s,{className:"me-2"}),l.a.createElement("strong",null,"Warning:")," This page is for administrators only. The actions performed here will affect all users of the application."),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement(K,null)),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(y.D,{className:"me-2"}),"Database Information"),l.a.createElement("p",{className:"card-text"},"The setup process will create the following resources:"),l.a.createElement("h6",{className:"mt-3"},l.a.createElement(y.ab,{className:"me-2"}),"Tables"),l.a.createElement("ul",{className:"list-group mb-3"},l.a.createElement("li",{className:"list-group-item"},"detailed_profiles"),l.a.createElement("li",{className:"list-group-item"},"profiles"),l.a.createElement("li",{className:"list-group-item"},"conditions"),l.a.createElement("li",{className:"list-group-item"},"medications"),l.a.createElement("li",{className:"list-group-item"},"appointments"),l.a.createElement("li",{className:"list-group-item"},"telehealth_consultations"),l.a.createElement("li",{className:"list-group-item"},"vitals"),l.a.createElement("li",{className:"list-group-item"},"diseases"),l.a.createElement("li",{className:"list-group-item"},"medical_reports"),l.a.createElement("li",{className:"list-group-item"},"support_tickets"),l.a.createElement("li",{className:"list-group-item"},"chat_sessions"),l.a.createElement("li",{className:"list-group-item"},"chat_messages"),l.a.createElement("li",{className:"list-group-item"},"alerts"),l.a.createElement("li",{className:"list-group-item"},"security_settings"),l.a.createElement("li",{className:"list-group-item"},"backup_history")),l.a.createElement("h6",{className:"mt-3"},l.a.createElement(y.y,{className:"me-2"}),"Storage Buckets"),l.a.createElement("ul",{className:"list-group"},l.a.createElement("li",{className:"list-group-item"},"profile-pictures"),l.a.createElement("li",{className:"list-group-item"},"medical-reports"),l.a.createElement("li",{className:"list-group-item"},"health-reports"),l.a.createElement("li",{className:"list-group-item"},"chat-attachments"),l.a.createElement("li",{className:"list-group-item"},"support-attachments")))))),l.a.createElement("div",{className:"mt-5"},l.a.createElement("button",{className:"btn btn-primary",onClick:async()=>{try{r("Setting up database...");const{error:e}=await o.supabase.rpc("setup_profiles_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS profiles (\n            id UUID REFERENCES auth.users ON DELETE CASCADE PRIMARY KEY,\n            first_name VARCHAR(255),\n            last_name VARCHAR(255),\n            date_of_birth DATE,\n            gender VARCHAR(50),\n            blood_group VARCHAR(10),\n            height DECIMAL,\n            weight DECIMAL,\n            allergies TEXT[],\n            medical_conditions TEXT[],\n            emergency_contact_name VARCHAR(255),\n            emergency_contact_phone VARCHAR(20),\n            emergency_contact_relationship VARCHAR(100),\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW()),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          -- Add RLS policies\n          ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own profile"\n            ON profiles FOR SELECT\n            USING (auth.uid() = id);\n\n          CREATE POLICY "Users can update their own profile"\n            ON profiles FOR UPDATE\n            USING (auth.uid() = id);\n\n          CREATE POLICY "Users can insert their own profile"\n            ON profiles FOR INSERT\n            WITH CHECK (auth.uid() = id);\n        '});if(e)throw e;const{error:a}=await o.supabase.rpc("setup_health_metrics_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS health_metrics (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            metric_type VARCHAR(50),\n            value DECIMAL,\n            unit VARCHAR(20),\n            recorded_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW()),\n            notes TEXT\n          );\n\n          ALTER TABLE health_metrics ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own health metrics"\n            ON health_metrics FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own health metrics"\n            ON health_metrics FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(a)throw a;const{error:t}=await o.supabase.rpc("setup_medical_analyses_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS medical_analyses (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            image_type VARCHAR(50),\n            image_url TEXT,\n            result TEXT,\n            confidence DECIMAL,\n            analyzed_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE medical_analyses ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own medical analyses"\n            ON medical_analyses FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own medical analyses"\n            ON medical_analyses FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(t)throw t;const{error:n}=await o.supabase.rpc("setup_chat_history_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS chat_history (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            message TEXT,\n            response TEXT,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE chat_history ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own chat history"\n            ON chat_history FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert into their own chat history"\n            ON chat_history FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(n)throw n;const{error:l}=await o.supabase.rpc("setup_ai_recommendations_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS ai_recommendations (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            category VARCHAR(50),\n            recommendation TEXT,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE ai_recommendations ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own recommendations"\n            ON ai_recommendations FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own recommendations"\n            ON ai_recommendations FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(l)throw l;r("Database setup completed successfully!")}catch(e){console.error("Database setup error:",e),r("Error setting up database: "+e.message)}}},"Initialize Database"),l.a.createElement("div",{className:"mt-3"},l.a.createElement("p",null,t))))};M.f.register(M.e,M.k,M.m,M.j,M.r,M.s,M.h);var ae=e=>{let{initialTimeRange:a="1M"}=e;const{user:t}=d(),[r,s]=Object(n.useState)([]),[c,i]=Object(n.useState)(!0),[m,u]=Object(n.useState)("bloodPressure"),[p,E]=Object(n.useState)(a),h=[{value:"bloodPressure",label:"Blood Pressure"},{value:"bloodSugar",label:"Blood Sugar"},{value:"cholesterol",label:"Cholesterol"},{value:"heartRate",label:"Heart Rate"},{value:"temperature",label:"Temperature"},{value:"weight",label:"Weight"},{value:"oxygenSaturation",label:"Oxygen Saturation"}];Object(n.useEffect)(()=>{g()},[p,m]);const g=async()=>{try{i(!0);const e={"1W":"7 days","1M":"30 days","3M":"90 days","6M":"180 days","1Y":"365 days"},{data:a,error:n}=await o.supabase.from("health_metrics").select("*").eq("user_id",t.id).gte("recorded_at",new Date(Date.now()-24*parseInt(e[p])*60*60*1e3).toISOString()).order("recorded_at",{ascending:!0});if(n)throw n;s(a||[])}catch(e){console.error("Error fetching metrics:",e)}finally{i(!1)}},b={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:h.find(e=>e.value===m).label+" Trend"}},scales:{y:{beginAtZero:!1}}};return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex justify-content-between mb-3"},l.a.createElement("select",{className:"form-select w-auto",value:m,onChange:e=>u(e.target.value)},h.map(e=>l.a.createElement("option",{key:e.value,value:e.value},e.label))),l.a.createElement("select",{className:"form-select w-auto",value:p,onChange:e=>E(e.target.value)},l.a.createElement("option",{value:"1W"},"1 Week"),l.a.createElement("option",{value:"1M"},"1 Month"),l.a.createElement("option",{value:"3M"},"3 Months"),l.a.createElement("option",{value:"6M"},"6 Months"),l.a.createElement("option",{value:"1Y"},"1 Year"))),c?l.a.createElement("div",{className:"text-center"},"Loading..."):r.length>0?l.a.createElement(U.b,{data:(()=>{const e=r.map(e=>new Date(e.recorded_at).toLocaleDateString()),a=r.map(e=>{const a=e.metrics[m];if("bloodPressure"===m){const[e]=a.split("/");return parseInt(e)}return parseFloat(a)});return{labels:e,datasets:[{label:h.find(e=>e.value===m).label,data:a,fill:!1,borderColor:"rgb(75, 192, 192)",tension:.1}]}})(),options:b}):l.a.createElement("div",{className:"text-center"},"No data available for the selected period")))};var te=()=>{const{user:e}=d(),[a,t]=Object(n.useState)(!1),[r,s]=Object(n.useState)(null),[c,i]=Object(n.useState)(null),[m,u]=Object(n.useState)(null),[p,E]=Object(n.useState)("skin");return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h3",{className:"card-title mb-4"},"Medical Image Analysis"),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Image Type"),l.a.createElement("select",{className:"form-select",value:p,onChange:e=>E(e.target.value)},[{value:"skin",label:"Skin Condition"},{value:"xray",label:"X-Ray"},{value:"wound",label:"Wound/Injury"},{value:"eye",label:"Eye Condition"}].map(e=>l.a.createElement("option",{key:e.value,value:e.value},e.label)))),l.a.createElement("div",{className:"mb-4"},l.a.createElement("label",{className:"form-label"},"Upload Image"),l.a.createElement("input",{type:"file",className:"form-control",accept:"image/*",onChange:a=>{const n=a.target.files[0];n&&(async a=>{t(!0),i(null);try{const n=`${e.id}/${Date.now()}-${a.name}`,{data:l,error:r}=await o.supabase.storage.from("medical-images").upload(n,a);if(r)throw r;const{data:{publicUrl:c}}=o.supabase.storage.from("medical-images").getPublicUrl(n);u(c);const i=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Object({NODE_ENV:"production",PUBLIC_URL:"/DiGiHealthAdv",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ",REACT_APP_SUPABASE_URL:"https://aqdzmfhakqdwquszaqle.supabase.co"}).REACT_APP_OPENAI_API_KEY},body:JSON.stringify({model:"gpt-4-vision-preview",messages:[{role:"system",content:`You are a medical image analyzer specialized in ${p} conditions. Provide a detailed analysis while being cautious not to make definitive diagnoses.`},{role:"user",content:[{type:"text",text:`Please analyze this ${p} image and provide insights about what you observe. Include potential concerns and recommendations for professional medical consultation if needed.`},{type:"image_url",image_url:c}]}],max_tokens:500})}),m=await i.json(),{error:d}=await o.supabase.from("medical_analyses").insert([{user_id:e.id,image_url:c,analysis_type:p,analysis_result:m.choices[0].message.content,created_at:(new Date).toISOString()}]);if(d)throw d;s(m.choices[0].message.content)}catch(c){console.error("Error analyzing image:",c),i(c.message)}finally{t(!1)}})(n)},disabled:a})),a&&l.a.createElement("div",{className:"text-center mb-4"},l.a.createElement(y.X,{className:"spinner"}),l.a.createElement("p",null,"Analyzing image...")),m&&l.a.createElement("div",{className:"mb-4"},l.a.createElement("img",{src:m,alt:"Uploaded medical image",className:"img-fluid rounded",style:{maxHeight:"300px"}})),c&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},c),r&&l.a.createElement("div",{className:"mt-4"},l.a.createElement("h5",null,"Analysis Results:"),l.a.createElement("div",{className:"card bg-light"},l.a.createElement("div",{className:"card-body"},l.a.createElement("pre",{className:"mb-0",style:{whiteSpace:"pre-wrap"}},r))))))};var ne=()=>{const{user:e}=d(),[a,t]=Object(n.useState)([]),[r,s]=Object(n.useState)(""),[c,i]=Object(n.useState)(!1),[m,u]=Object(n.useState)("chat"),p=Object(n.useRef)(null);Object(n.useEffect)(()=>{p.current&&p.current.scrollIntoView({behavior:"smooth"})},[a]);const E=()=>{switch(m){case"diet":return"You are a nutritionist AI assistant. Provide personalized diet recommendations based on user's health conditions and goals. Always emphasize the importance of consulting healthcare providers before making significant dietary changes.";case"firstAid":return"You are a first aid instruction AI assistant. Provide clear, step-by-step first aid guidance for non-emergency situations. Always emphasize when professional medical attention is needed and include emergency contact recommendations when appropriate.";default:return"You are a helpful medical assistant. Explain medical terms in simple language and provide general health information. Always remind users to consult healthcare professionals for proper medical advice."}},h=async()=>{if(!r.trim())return;const n=r.trim();s(""),i(!0);const l={role:"user",content:n,timestamp:(new Date).toISOString()};t(e=>[...e,l]);try{const{data:l}=await o.supabase.from("profiles").select("medical_conditions, allergies, current_medications").eq("id",e.id).single(),r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Object({NODE_ENV:"production",PUBLIC_URL:"/DiGiHealthAdv",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ",REACT_APP_SUPABASE_URL:"https://aqdzmfhakqdwquszaqle.supabase.co"}).REACT_APP_OPENAI_API_KEY},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:E()},{role:"user",content:`User's health context - Medical conditions: ${l.medical_conditions.join(", ")}, Allergies: ${l.allergies.join(", ")}, Current medications: ${l.current_medications.join(", ")}`},...a.map(e=>({role:e.role,content:e.content})),{role:"user",content:n}],temperature:.7,max_tokens:500})}),s=await r.json();t(e=>[...e,{role:"assistant",content:s.choices[0].message.content,timestamp:(new Date).toISOString()}]),await o.supabase.from("chat_history").insert([{user_id:e.id,mode:m,message:n,response:s.choices[0].message.content,created_at:(new Date).toISOString()}])}catch(c){console.error("Error:",c),t(e=>[...e,{role:"assistant",content:"I apologize, but I encountered an error. Please try again.",timestamp:(new Date).toISOString()}])}finally{i(!1)}};return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},l.a.createElement("h3",{className:"card-title mb-0"},"diet"===m?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.lb,{className:"me-2"})," Diet Assistant"):"firstAid"===m?l.a.createElement(l.a.Fragment,null,l.a.createElement(y.x,{className:"me-2"})," First Aid Guide"):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.T,{className:"me-2"})," Health Assistant")),l.a.createElement("div",{className:"btn-group"},l.a.createElement("button",{className:"btn btn-"+("chat"===m?"primary":"outline-primary"),onClick:()=>u("chat")},"Chat"),l.a.createElement("button",{className:"btn btn-"+("diet"===m?"primary":"outline-primary"),onClick:()=>u("diet")},"Diet"),l.a.createElement("button",{className:"btn btn-"+("firstAid"===m?"primary":"outline-primary"),onClick:()=>u("firstAid")},"First Aid"))),l.a.createElement("div",{className:"chat-container bg-light p-3 rounded",style:{height:"400px",overflowY:"auto"}},a.map((e,a)=>l.a.createElement("div",{key:a,className:`d-flex ${"user"===e.role?"justify-content-end":"justify-content-start"} mb-3`},l.a.createElement("div",{className:("user"===e.role?"bg-primary text-white":"bg-white")+" p-3 rounded shadow-sm",style:{maxWidth:"75%"}},l.a.createElement("div",{className:"d-flex align-items-center mb-1"},"user"===e.role?l.a.createElement(y.ib,{className:"me-2"}):l.a.createElement(y.T,{className:"me-2"}),l.a.createElement("small",{className:"text-muted"},new Date(e.timestamp).toLocaleTimeString())),l.a.createElement("div",{style:{whiteSpace:"pre-wrap"}},e.content)))),l.a.createElement("div",{ref:p})),l.a.createElement("div",{className:"mt-3 d-flex"},l.a.createElement("input",{type:"text",className:"form-control me-2",value:r,onChange:e=>s(e.target.value),onKeyPress:e=>"Enter"===e.key&&h(),placeholder:"diet"===m?"Ask about diet recommendations...":"firstAid"===m?"Ask about first aid instructions...":"Ask your health-related question...",disabled:c}),l.a.createElement("button",{className:"btn btn-primary",onClick:h,disabled:c||!r.trim()},c?l.a.createElement(y.X,{className:"spinner"}):l.a.createElement(y.N,null)))))};M.f.register(M.e,M.k,M.m,M.j,M.c,M.a,M.p,M.r,M.s,M.h);var le=()=>{const{user:e}=d(),[a,t]=Object(n.useState)({healthTrends:[],imageAnalyses:[],chatHistory:[],recommendations:[]}),[r,s]=Object(n.useState)("week"),[c,i]=Object(n.useState)("all");Object(n.useEffect)(()=>{m()},[e,r,c]);const m=async()=>{try{const[a,n,l,r]=await Promise.all([o.supabase.from("health_metrics").select("*").eq("user_id",e.id).order("recorded_at",{ascending:!1}),o.supabase.from("medical_analyses").select("*").eq("user_id",e.id).order("analyzed_at",{ascending:!1}),o.supabase.from("chat_history").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}),o.supabase.from("ai_recommendations").select("*").eq("user_id",e.id).order("created_at",{ascending:!1})]);t({healthTrends:a.data||[],imageAnalyses:n.data||[],chatHistory:l.data||[],recommendations:r.data||[]})}catch(a){console.error("Error fetching AI insights:",a)}};return l.a.createElement("div",{className:"ai-insights-container"},l.a.createElement("h1",{className:"text-center mb-4"},"AI Health Insights Dashboard"),l.a.createElement("div",{className:"controls-section mb-4"},l.a.createElement("select",{value:r,onChange:e=>s(e.target.value),className:"form-select me-2"},l.a.createElement("option",{value:"week"},"Last Week"),l.a.createElement("option",{value:"month"},"Last Month"),l.a.createElement("option",{value:"year"},"Last Year")),l.a.createElement("select",{value:c,onChange:e=>i(e.target.value),className:"form-select"},l.a.createElement("option",{value:"all"},"All Metrics"),l.a.createElement("option",{value:"vitals"},"Vital Signs"),l.a.createElement("option",{value:"lab"},"Lab Results"),l.a.createElement("option",{value:"lifestyle"},"Lifestyle"))),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",null,l.a.createElement(y.g,null)," Health Trends Analysis")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement(U.b,{data:{labels:a.healthTrends.map(e=>new Date(e.recorded_at).toLocaleDateString()),datasets:[{label:"Health Score",data:a.healthTrends.map(e=>e.value),borderColor:"rgb(75, 192, 192)",tension:.1}]},options:{responsive:!0,plugins:{title:{display:!0,text:"Health Metrics Over Time"}}}})),l.a.createElement("div",{className:"col-md-6"},l.a.createElement(U.d,{data:{labels:["Blood Pressure","Heart Rate","Blood Sugar","Sleep","Exercise","Diet"],datasets:[{label:"Current Status",data:[65,75,70,80,60,85],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgb(75, 192, 192)"}]}}))))),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",null,l.a.createElement(y.w,null)," Medical Image Analysis History")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Image Type"),l.a.createElement("th",null,"Analysis Result"),l.a.createElement("th",null,"Confidence"))),l.a.createElement("tbody",null,a.imageAnalyses.map((e,a)=>l.a.createElement("tr",{key:a},l.a.createElement("td",null,new Date(e.analyzed_at).toLocaleDateString()),l.a.createElement("td",null,e.image_type),l.a.createElement("td",null,e.result),l.a.createElement("td",null,e.confidence,"%")))))))),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",null,l.a.createElement(y.c,null)," AI Health Recommendations")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement(U.c,{data:{labels:["Diet","Exercise","Sleep","Medication","Lifestyle"],datasets:[{data:[30,25,20,15,10],backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF"]}]},options:{plugins:{title:{display:!0,text:"Recommendation Categories"}}}})),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"recommendations-list"},a.recommendations.slice(0,5).map((e,a)=>l.a.createElement("div",{key:a,className:"recommendation-item"},l.a.createElement("h5",null,e.category),l.a.createElement("p",null,e.recommendation)))))))),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",null,l.a.createElement(y.T,null)," Health Assistant Interactions")),l.a.createElement("div",{className:"card-body"},l.a.createElement(U.a,{data:{labels:["Diet Queries","Symptom Analysis","Medical Terms","First Aid","General Health"],datasets:[{label:"Interaction Distribution",data:[45,32,28,15,30],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgb(75, 192, 192)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}}}}))))};var re=()=>{const[e,a]=Object(n.useState)(!0),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(null),[i,m]=Object(n.useState)(null),d=Object(n.useCallback)(async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)throw new Error("No user logged in");const t={weight:[{date:"2024-01-01",value:70},{date:"2024-02-01",value:69},{date:"2024-03-01",value:68}],bloodPressure:[{date:"2024-01-01",systolic:120,diastolic:80},{date:"2024-02-01",systolic:118,diastolic:78},{date:"2024-03-01",systolic:122,diastolic:82}],heartRate:[{date:"2024-01-01",value:72},{date:"2024-02-01",value:70},{date:"2024-03-01",value:71}]};c(t),u(t)}catch(t){console.error("Error fetching health metrics:",t),r("Failed to load health metrics")}finally{a(!1)}},[]);Object(n.useEffect)(()=>{d()},[d]);const u=e=>{m({weight:{trend:"decreasing",change:-2,recommendation:"Your weight shows a healthy decreasing trend. Keep up the good work!"},bloodPressure:{trend:"stable",recommendation:"Your blood pressure remains within normal range. Continue monitoring regularly."},heartRate:{trend:"stable",recommendation:"Your heart rate is consistent and within healthy range."},overall:{status:"Good",recommendations:["Maintain current lifestyle habits","Continue regular exercise","Keep monitoring your metrics"]}})};return e?l.a.createElement("div",{className:"text-center py-4"},l.a.createElement(v,null)):t?l.a.createElement("div",{className:"alert alert-danger m-4"},t):l.a.createElement("div",{className:"container py-4"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("h2",{className:"mb-4"},"AI Health Metrics Analysis"),s&&i&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h4",null,"Overall Health Status: ",l.a.createElement("span",{className:"text-success"},i.overall.status)),l.a.createElement("div",{className:"mt-3"},l.a.createElement("h5",null,"Key Findings:"),l.a.createElement("ul",{className:"list-group list-group-flush"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement("strong",null,"Weight:")," ",i.weight.recommendation),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("strong",null,"Blood Pressure:")," ",i.bloodPressure.recommendation),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("strong",null,"Heart Rate:")," ",i.heartRate.recommendation))))),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h4",null,"Recommendations"),l.a.createElement("ul",{className:"list-group list-group-flush"},i.overall.recommendations.map((e,a)=>l.a.createElement("li",{key:a,className:"list-group-item"},l.a.createElement("i",{className:"fas fa-check-circle text-success me-2"}),e))))),l.a.createElement("div",{className:"alert alert-info"},l.a.createElement("i",{className:"fas fa-info-circle me-2"}),"This analysis is based on your recorded health metrics. For personalized medical advice, please consult with your healthcare provider.")))))};var se=()=>{const[e,a]=Object(n.useState)(""),[t,r]=Object(n.useState)(""),[s,c]=Object(n.useState)("moderate"),[i,o]=Object(n.useState)(null),[m,d]=Object(n.useState)(!1),[u,p]=Object(n.useState)(null);return l.a.createElement("div",{className:"container py-4"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("h2",{className:"mb-4"},"AI Symptom Checker"),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("form",{onSubmit:async a=>{if(a.preventDefault(),e.trim()){d(!0),p(null),o(null);try{o({possibleConditions:[{condition:"Common Cold",probability:.8,description:"A viral infection causing runny nose, sore throat, and cough",recommendations:["Rest and hydration","Over-the-counter cold medications","Monitor symptoms"]},{condition:"Seasonal Allergies",probability:.6,description:"An allergic response to environmental triggers",recommendations:["Antihistamines","Avoid known triggers","Consider consulting an allergist"]}],urgencyLevel:"Low",generalAdvice:"Based on the symptoms described, immediate medical attention is not required. However, if symptoms worsen or persist, please consult a healthcare provider.",whenToSeekHelp:["Symptoms persist beyond 7 days","Development of high fever","Difficulty breathing","Severe pain"]})}catch(u){console.error("Error analyzing symptoms:",u),p("Failed to analyze symptoms. Please try again.")}finally{d(!1)}}}},l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"symptoms",className:"form-label"},"Describe your symptoms"),l.a.createElement("textarea",{className:"form-control",id:"symptoms",rows:"3",value:e,onChange:e=>a(e.target.value),placeholder:"Example: I have a headache, fever, and sore throat..."})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"duration",className:"form-label"},"How long have you had these symptoms?"),l.a.createElement("input",{type:"text",className:"form-control",id:"duration",value:t,onChange:e=>r(e.target.value),placeholder:"Example: 2 days"})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"severity",className:"form-label"},"Severity of symptoms"),l.a.createElement("select",{className:"form-select",id:"severity",value:s,onChange:e=>c(e.target.value)},l.a.createElement("option",{value:"mild"},"Mild"),l.a.createElement("option",{value:"moderate"},"Moderate"),l.a.createElement("option",{value:"severe"},"Severe"))),l.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:m||!e.trim()},m?l.a.createElement(v,null):"Analyze Symptoms")),u&&l.a.createElement("div",{className:"alert alert-danger mt-3"},u),i&&l.a.createElement("div",{className:"mt-4"},l.a.createElement("h4",null,"Analysis Results"),l.a.createElement("div",{className:"alert alert-info mb-3"},l.a.createElement("strong",null,"Urgency Level:")," ",i.urgencyLevel),l.a.createElement("h5",null,"Possible Conditions:"),i.possibleConditions.map((e,a)=>l.a.createElement("div",{key:a,className:"card mb-3"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h6",{className:"card-title"},e.condition,l.a.createElement("span",{className:"badge bg-primary ms-2"},(100*e.probability).toFixed(0),"% match")),l.a.createElement("p",{className:"card-text"},e.description),l.a.createElement("h6",null,"Recommendations:"),l.a.createElement("ul",null,e.recommendations.map((e,a)=>l.a.createElement("li",{key:a},e)))))),l.a.createElement("div",{className:"card mb-3"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",null,"When to Seek Medical Help:"),l.a.createElement("ul",null,i.whenToSeekHelp.map((e,a)=>l.a.createElement("li",{key:a},e))))),l.a.createElement("div",{className:"alert alert-warning"},l.a.createElement("i",{className:"fas fa-exclamation-triangle me-2"}),"This is an AI-powered analysis and should not replace professional medical advice. If you're concerned about your symptoms, please consult a healthcare provider.")))))))};const ce="gpt-4",ie="gpt-4-vision-preview",oe="https://digihealth-backend.onrender.com/api",me=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t=3;let n=0;for(;n<t;)try{console.log("Calling OpenAI proxy with options:",{...a,text:a.isImageAnalysis?"[Image prompt omitted]":"[Text prompt omitted]",model:a.model||ce});const t=a.timeout||45e3,n=new AbortController,s=setTimeout(()=>n.abort(),t);try{const t={text:e,model:a.model||(a.isImageAnalysis?ie:ce),...a},r=a.isImageAnalysis?oe+"/vision-analyze":oe+"/analyze-report";console.log("Making request to:",r);const c=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),signal:n.signal});if(clearTimeout(s),!c.ok){let e=`OpenAI API request failed: ${c.status} ${c.statusText}`;try{e=(await c.json()).error||e}catch(l){}throw new Error(e)}return await c.json()}catch(r){throw clearTimeout(s),r}}catch(s){if(console.error("Error calling OpenAI API:",s),"AbortError"===s.name)throw new Error("OpenAI request timed out. The model may be taking too long to process your request. Try again with a simpler query.");if(s.message.includes("Failed to fetch")){if(n<t-1){n++,console.log(`Retrying request (${n}/${t})...`),await new Promise(e=>setTimeout(e,1e3*n));continue}throw new Error("Could not connect to the OpenAI service. Please check your internet connection or try again later.")}if(s.message.includes("404"))throw new Error("Backend service is not available. Please check if the backend server is running and accessible.");throw s}},de=async e=>{try{console.log(`Extracting text from document using OpenAI: ${e.name} (${e.size} bytes)`);const a=Math.min(6e4,Math.max(3e4,e.size/5e3));console.log(`Setting timeout to ${a/1e3} seconds based on file size`);const t=await function(e){return new Promise((a,t)=>{const n=new FileReader;n.onload=()=>a(n.result),n.onerror=e=>t(e),n.readAsDataURL(e)})}(e),n="\n      Extract all text from this document image.\n      If this is a form, table, or structured document, preserve the structure as much as possible.\n      If this contains medical information, pay special attention to:\n      - Patient information\n      - Medication names and dosages\n      - Diagnoses\n      - Doctor's instructions\n      \n      Return ONLY the extracted text without any additional commentary.\n    ",l=await me(n,{imageUrl:t,isImageAnalysis:!0,model:"gpt-4-vision-preview",timeout:a});return{text:"string"===typeof l?l:JSON.stringify(l),pages:[],textAnnotations:[{description:"string"===typeof l?l:JSON.stringify(l)}]}}catch(a){if(console.error("Error extracting text with OpenAI:",a),("AbortError"===a.name||a.message.includes("timed out")||a.message.includes("Failed to fetch"))&&e.type.startsWith("image/")){console.log("Document extraction with OpenAI failed, attempting fallback...");try{return await async function(e){return new Promise((t,n)=>{const l=new FileReader;l.onload=function(e){try{t({text:"Document text extraction is currently unavailable. Please try again later when our services are back online.",fallback:!0,pages:[],textAnnotations:[]})}catch(a){n(a)}},l.onerror=function(){n(new Error("Failed to read the file"))},l.readAsDataURL(e)})}(e)}catch(t){console.error("Fallback extraction failed:",t)}}if("AbortError"===a.name||a.message.includes("timed out"))throw new Error("Document extraction timed out. The service may be experiencing high load or your document is too complex. Try with a smaller document or try again later.");if(a.message.includes("Failed to fetch"))throw new Error("Could not connect to the OpenAI service. Please check your internet connection or try again later.");throw a}};t(44);var ue=()=>{const[e,a]=Object(n.useState)(null),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(!1),[i,m]=Object(n.useState)(null),[d,u]=Object(n.useState)(null),[p,E]=Object(n.useState)(null),[h,g]=Object(n.useState)("general"),b=Object(n.useRef)(null),f=Object(n.useRef)(null);Object(n.useEffect)(()=>{const e=f.current;if(e){const a=e=>{e.preventDefault(),e.stopPropagation()},t=()=>e.classList.add("highlight"),n=()=>e.classList.remove("highlight"),l=e=>{a(e),n();const t=e.dataTransfer.files;t&&t.length&&N(t[0])};return["dragenter","dragover","dragleave","drop"].forEach(t=>{e.addEventListener(t,a,!1)}),["dragenter","dragover"].forEach(a=>{e.addEventListener(a,t,!1)}),["dragleave","drop"].forEach(a=>{e.addEventListener(a,n,!1)}),e.addEventListener("drop",l,!1),()=>{["dragenter","dragover","dragleave","drop"].forEach(t=>{e.removeEventListener(t,a,!1)}),["dragenter","dragover"].forEach(a=>{e.removeEventListener(a,t,!1)}),["dragleave","drop"].forEach(a=>{e.removeEventListener(a,n,!1)}),e.removeEventListener("drop",l,!1)}}},[]);const N=e=>{e&&(e.type.match("image.*")?(a(e),r(URL.createObjectURL(e)),m(null),u(null)):E({type:"danger",message:"Please upload a valid image file (JPEG, PNG, etc.)"}))},w=()=>{a(null),r(null),m(null),u(null),b.current&&(b.current.value="")},_=e=>{const a="This AI analysis is not a substitute for professional medical diagnosis. Please consult with a healthcare provider for proper evaluation and diagnosis.";return{skin:a+" Skin conditions particularly require in-person examination as many can appear similar in images.",xray:a+" X-ray interpretation requires board-certified radiologists for official diagnosis.",scan:a+" CT/MRI scans are complex and require specialized medical training to properly diagnose.",pathology:a+" Pathology diagnosis requires microscopic examination by a certified pathologist."}[e]||a},x=async(a,t)=>{try{const{data:{user:n}}=await o.supabase.auth.getUser();if(!n)return;const l=e.name.split(".").pop(),r=`${n.id}/${Date.now()}.${l}`,{error:s}=await o.supabase.storage.from("medical-images").upload(r,e);if(s)throw s;const{data:{publicUrl:c}}=o.supabase.storage.from("medical-images").getPublicUrl(r);await o.supabase.from("image_analyses").insert({user_id:n.id,image_url:c,analysis_type:h,analysis_result:a,vision_api_data:t?JSON.stringify(t):null,created_at:(new Date).toISOString()})}catch(d){console.error("Error saving analysis:",d)}};return l.a.createElement("div",{className:"ai-feature-container"},p&&l.a.createElement("div",{className:"notification notification-"+p.type},l.a.createElement("span",null,p.message),l.a.createElement("button",{className:"close-btn",onClick:()=>E(null)},"\xd7")),l.a.createElement("div",{className:"ai-feature-header"},l.a.createElement("h1",null,l.a.createElement(y.M,null)," Medical Image Analysis"),l.a.createElement("p",null,"Upload medical images for AI-powered analysis and insights. Our system can analyze X-rays, skin conditions, CT/MRI scans, and more.")),l.a.createElement("div",{className:"ai-feature-content"},l.a.createElement("div",{className:"feature-panel"},l.a.createElement("div",{className:"analysis-options"},l.a.createElement("div",{className:"option-group"},l.a.createElement("label",{htmlFor:"analysisType"},"Analysis Type"),l.a.createElement("select",{id:"analysisType",className:"type-select",value:h,onChange:e=>g(e.target.value)},l.a.createElement("option",{value:"general"},"General Medical Image Analysis"),l.a.createElement("option",{value:"skin"},"Skin Condition/Lesion"),l.a.createElement("option",{value:"xray"},"X-Ray"),l.a.createElement("option",{value:"scan"},"CT/MRI Scan"),l.a.createElement("option",{value:"pathology"},"Pathology Slide")))),l.a.createElement("div",{className:"upload-section"},l.a.createElement("div",{className:"drop-area",ref:f,onClick:()=>b.current&&b.current.click()},t?l.a.createElement("div",{className:"file-preview"},l.a.createElement("img",{src:t,alt:"Medical Image Preview",className:"preview-image"}),l.a.createElement("button",{className:"remove-file",onClick:e=>{e.stopPropagation(),w()}},l.a.createElement(y.gb,null))):l.a.createElement("div",{className:"upload-prompt"},l.a.createElement(y.C,{className:"upload-icon"}),l.a.createElement("h3",null,"Drag & Drop or Click to Upload"),l.a.createElement("p",null,"Upload a medical image for AI analysis")),l.a.createElement("input",{type:"file",className:"file-input",accept:"image/*",onChange:e=>{N(e.target.files[0])},ref:b,style:{display:"none"}})),l.a.createElement("div",{className:"action-buttons"},l.a.createElement("button",{className:"primary-button",onClick:async()=>{if(e){c(!0),u(null),E(null);try{const a=new FileReader;a.readAsDataURL(e),a.onloadend=async()=>{const e=a.result;try{E({type:"info",message:"Analyzing image with Vision API..."});const a=await async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["LABEL_DETECTION","TEXT_DETECTION"];try{if(!e||e.includes("base64,")&&e.split("base64,")[1].length<100||!e.includes("base64,")&&e.length<100)throw new Error("Invalid image content. The image may be corrupted or too small.");console.log("Analyzing image with OpenAI using features: "+a.join(", "));let n="Analyze this image and provide the following information in JSON format:\n";a.includes("LABEL_DETECTION")&&(n+="- labelAnnotations: An array of objects with 'description' (the label) and 'score' (confidence from 0-1)\n"),a.includes("TEXT_DETECTION")&&(n+="- textAnnotations: An array with the first element containing all detected text in the 'description' field\n"),a.includes("FACE_DETECTION")&&(n+="- faceAnnotations: An array of detected faces with details like 'joyLikelihood', 'sorrowLikelihood', etc.\n"),a.includes("OBJECT_LOCALIZATION")&&(n+="- localizedObjectAnnotations: An array of detected objects with 'name' and 'score' fields\n"),a.includes("IMAGE_PROPERTIES")&&(n+="- imagePropertiesAnnotation: Object containing 'dominantColors' with an array of color objects\n"),n+="\nFormat your response as a valid JSON object that matches the Google Cloud Vision API structure.";const l=await me(n,{imageUrl:e,isImageAnalysis:!0,model:"gpt-4-vision-preview",timeout:3e4});let r;if("string"===typeof l)try{const e=l.match(/```json\n([\s\S]*?)\n```/)||l.match(/```\n([\s\S]*?)\n```/)||l.match(/\{[\s\S]*\}/);r=e?JSON.parse(e[1]||e[0]):{textAnnotations:[{description:l}],labelAnnotations:[]}}catch(t){console.warn("Error parsing OpenAI response as JSON:",t),r={textAnnotations:[{description:l}],labelAnnotations:[]}}else r=l;return r}catch(d){if(console.error("Error analyzing image with OpenAI:",d),"AbortError"===d.name||d.message.includes("timed out"))throw new Error("Image analysis timed out. The service may be experiencing high load or connectivity issues.");if(d.message.includes("Failed to fetch"))throw new Error("Could not connect to the OpenAI service. Please check your internet connection or try again later.");throw d}}(e,["LABEL_DETECTION","TEXT_DETECTION","FACE_DETECTION","OBJECT_LOCALIZATION","IMAGE_PROPERTIES"]);if(!a)throw new Error("Could not analyze the image with Vision API");E({type:"info",message:"Vision API analysis complete. Generating detailed medical analysis..."});const t=`\n            You are a medical imaging specialist AI. Analyze this medical image and provide detailed observations.\n            ${(e=>{const a="You are a medical imaging specialist AI. Analyze this medical image and provide detailed observations. ",t={general:a+"Describe what you see, potential abnormalities, and possible conditions it might indicate. Be thorough but cautious about making definitive diagnoses.",skin:a+"This is a skin-related image. Describe the lesion/condition characteristics, possible differential diagnoses, and any concerning features. Mention if further evaluation is recommended.",xray:a+"This is an X-ray image. Describe the visible structures, any abnormalities, potential fractures, lesions, or other findings. Interpret the image as thoroughly as possible.",scan:a+"This is a CT/MRI scan. Describe the visible anatomical structures, any abnormalities, masses, inflammations, or other noteworthy findings. Provide detailed analysis of tissue characteristics.",pathology:a+"This is a pathology slide. Describe the cellular structures, any abnormal cells, patterns, or markers of disease. Analyze tissue architecture and cellular morphology."};return t[e]||t.general})(h)}\n            \n            Here are the results from initial computer vision analysis:\n            ${JSON.stringify(a,null,2)}\n            \n            Based on the image and these initial results, please provide your analysis in this format:\n            {\n              "findings": [list of key findings],\n              "interpretation": [detailed analysis],\n              "recommendations": [any recommended follow-ups],\n              "differential_diagnosis": [possible conditions to consider]\n            }\n          `,n=await me(t,{imageUrl:e,analysisType:h,isImageAnalysis:!0,visionData:a});if(!n)throw new Error("Could not generate medical analysis for the image");m({analysis:n.interpretation||n,findings:n.findings||[],recommendations:n.recommendations||[],differentialDiagnosis:n.differential_diagnosis||[],date:(new Date).toISOString(),disclaimer:_(h),imageType:h,visionAPIResults:a}),x(n.interpretation||n,a),E({type:"success",message:"Image analysis complete"})}catch(t){console.error("API error:",t);let e=t.message||"Error analyzing image. Please try again or use a different image.";e.includes("Vision API")?e=`Vision API error: ${e}. Please try again with a clearer image.`:e.includes("OpenAI")&&(e=`Analysis error: ${e}. Please try again or select a different analysis type.`),u(e),E({type:"danger",message:e})}c(!1)},a.onerror=()=>{u("Error reading image file. Please try again with a different image."),E({type:"danger",message:"Error reading image file. Please try again."}),c(!1)}}catch(a){console.error("Error processing image:",a),u(a.message||"Error processing image. Please try again."),E({type:"danger",message:a.message||"Error processing image. Please try again."}),c(!1)}}},disabled:!e||s},s?l.a.createElement(l.a.Fragment,null,l.a.createElement(v,{size:"sm"}),l.a.createElement("span",null,"Analyzing...")):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.M,null),l.a.createElement("span",null,"Analyze Image"))),l.a.createElement("button",{className:"secondary-button",onClick:w,disabled:!e||s},l.a.createElement(y.gb,null),l.a.createElement("span",null,"Reset"))),d&&l.a.createElement("div",{className:"error-message"},l.a.createElement("p",null,d)))),s?l.a.createElement("div",{className:"loading-panel"},l.a.createElement(v,null),l.a.createElement("p",null,"Analyzing your medical image..."),l.a.createElement("span",null,"This may take a moment as our AI performs detailed analysis")):i?l.a.createElement("div",{className:"results-panel"},l.a.createElement("div",{className:"results-header"},l.a.createElement("h2",null,"Analysis Results"),l.a.createElement("span",{className:"analysis-type"},h.charAt(0).toUpperCase()+h.slice(1)," Analysis")),l.a.createElement("div",{className:"results-content"},i.findings&&i.findings.length>0&&l.a.createElement("div",{className:"findings-section"},l.a.createElement("h3",null,"Key Findings"),l.a.createElement("ul",{className:"findings-list"},i.findings.map((e,a)=>l.a.createElement("li",{key:a},e)))),l.a.createElement("div",{className:"interpretation-section"},l.a.createElement("h3",null,"Interpretation"),l.a.createElement("div",{className:"interpretation-text"},"string"===typeof i.analysis?i.analysis.split("\n").map((e,a)=>e?l.a.createElement("p",{key:a},e):l.a.createElement("br",{key:a})):l.a.createElement("p",null,JSON.stringify(i.analysis)))),i.recommendations&&i.recommendations.length>0&&l.a.createElement("div",{className:"recommendations-section"},l.a.createElement("h3",null,"Recommendations"),l.a.createElement("ul",{className:"recommendations-list"},i.recommendations.map((e,a)=>l.a.createElement("li",{key:a},e)))),i.differentialDiagnosis&&i.differentialDiagnosis.length>0&&l.a.createElement("div",{className:"differential-section"},l.a.createElement("h3",null,"Differential Diagnosis"),l.a.createElement("ul",{className:"differential-list"},i.differentialDiagnosis.map((e,a)=>l.a.createElement("li",{key:a},e)))),i.visionAPIResults&&l.a.createElement("div",{className:"vision-insights"},l.a.createElement("h3",null,"Computer Vision Insights"),l.a.createElement("div",{className:"vision-insights-content"},i.visionAPIResults.labelAnnotations&&i.visionAPIResults.labelAnnotations.length>0&&l.a.createElement("div",{className:"vision-labels"},l.a.createElement("h4",null,"Image Labels"),l.a.createElement("ul",{className:"labels-list"},i.visionAPIResults.labelAnnotations.slice(0,6).map((e,a)=>l.a.createElement("li",{key:a},l.a.createElement("span",{className:"label-text"},e.description),l.a.createElement("span",{className:"label-confidence"},Math.round(100*e.score),"%"))))),i.visionAPIResults.textAnnotations&&i.visionAPIResults.textAnnotations.length>0&&l.a.createElement("div",{className:"vision-text"},l.a.createElement("h4",null,"Detected Text"),l.a.createElement("p",{className:"detected-text"},i.visionAPIResults.textAnnotations[0].description.substring(0,200),i.visionAPIResults.textAnnotations[0].description.length>200?"...":"")))),l.a.createElement("div",{className:"disclaimer"},l.a.createElement(y.D,null),l.a.createElement("p",null,l.a.createElement("strong",null,"Important Disclaimer:")," ",i.disclaimer)),l.a.createElement("div",{className:"analysis-date"},"Analysis generated on ",new Date(i.date).toLocaleString()))):l.a.createElement("div",{className:"placeholder-panel"},l.a.createElement("div",{className:"placeholder-content"},l.a.createElement(y.M,{className:"placeholder-icon"}),l.a.createElement("h3",null,"Upload an image to see analysis results"),l.a.createElement("p",null,"Our AI will analyze your medical image and provide detailed insights")))),l.a.createElement("div",{className:"ai-feature-tips"},l.a.createElement("h3",null,"About Medical Image Analysis"),l.a.createElement("div",{className:"tips-columns"},l.a.createElement("div",{className:"tips-column"},l.a.createElement("h4",null,"Common Uses"),l.a.createElement("ul",null,l.a.createElement("li",null,"Preliminary analysis of skin conditions"),l.a.createElement("li",null,"Identifying potential areas of concern in X-rays"),l.a.createElement("li",null,"Understanding CT/MRI scan information"),l.a.createElement("li",null,"Analyzing pathology slides"))),l.a.createElement("div",{className:"tips-column"},l.a.createElement("h4",null,"Limitations"),l.a.createElement("ul",null,l.a.createElement("li",null,"Not a replacement for professional diagnosis"),l.a.createElement("li",null,"Quality of analysis depends on image quality"),l.a.createElement("li",null,"May not detect all conditions or abnormalities"),l.a.createElement("li",null,"Should be used for educational purposes only"))))))};t(90);var pe=()=>{var e;const[a,t]=Object(n.useState)(!1),[r,s]=Object(n.useState)(null),[c,m]=Object(n.useState)(null),[d,u]=Object(n.useState)(null),[p,E]=Object(n.useState)([]),[h,g]=Object(n.useState)("general"),[b,f]=Object(n.useState)(""),[y,N]=Object(n.useState)(null),w=Object(i.q)(),_=[{id:"general",label:"General Health"},{id:"nutrition",label:"Nutrition & Diet"},{id:"fitness",label:"Fitness & Exercise"},{id:"sleep",label:"Sleep Improvement"},{id:"stress",label:"Stress Management"},{id:"chronic",label:"Chronic Condition Management"}];Object(n.useEffect)(()=>{(async()=>{try{const{data:{user:e}}=await o.supabase.auth.getUser();if(!e)return void w("/login");s(e.id),x(e.id),S(e.id)}catch(y){console.error("Error checking authentication",y)}})()},[w]);const x=async e=>{try{var a,t;const{data:n,error:l}=await o.supabase.from("profiles").select("\n          first_name, \n          last_name, \n          date_of_birth, \n          gender, \n          height, \n          weight,\n          user_conditions (\n            condition_name\n          ),\n          user_medications (\n            medication_name,\n            dosage\n          ),\n          health_metrics (*)\n        ").eq("id",e).single();if(l)throw l;let r=null;if(n.height&&n.weight){const e=n.height/100;r=(n.weight/(e*e)).toFixed(1)}m({...n,bmi:r,conditions:(null===(a=n.user_conditions)||void 0===a?void 0:a.map(e=>e.condition_name))||[],medications:(null===(t=n.user_medications)||void 0===t?void 0:t.map(e=>e.medication_name))||[]})}catch(y){console.error("Error fetching profile",y)}},S=async e=>{try{const{data:a,error:t}=await o.supabase.from("health_recommendations").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(t)throw t;E(a||[])}catch(y){console.error("Error fetching recommendation history",y)}},k=async e=>{try{const{error:a}=await o.supabase.from("health_recommendations").insert([{user_id:r,focus_area:e.focus_area,recommendations:JSON.stringify(e),created_at:e.created_at}]);if(a)throw a}catch(y){console.error("Error saving recommendations:",y)}},C=e=>{if(!e)return"Unknown";const a=new Date,t=new Date(e);let n=a.getFullYear()-t.getFullYear();const l=a.getMonth()-t.getMonth();return(l<0||0===l&&a.getDate()<t.getDate())&&n--,n};return l.a.createElement("div",{className:"container py-4"},l.a.createElement("h1",{className:"mb-4"},"AI Health Recommendations"),y&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},y),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-4 mb-4"},l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},"Generate Recommendations"),c?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"focusArea",className:"form-label"},"Focus Area"),l.a.createElement("select",{id:"focusArea",className:"form-select",value:h,onChange:e=>g(e.target.value),disabled:a},_.map(e=>l.a.createElement("option",{key:e.id,value:e.id},e.label)))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"additionalContext",className:"form-label"},"Additional Context (Optional)"),l.a.createElement("textarea",{id:"additionalContext",className:"form-control",rows:"3",placeholder:"Add any specific concerns or goals...",value:b,onChange:e=>f(e.target.value),disabled:a})),l.a.createElement("button",{className:"btn btn-primary w-100",onClick:async()=>{if(t(!0),N(null),!c)return N("Please complete your health profile first."),void t(!1);try{const e=`\n        You are a health and wellness advisor. Based on the following user profile, provide personalized health recommendations.\n        \n        User Profile:\n        - Age: ${C(c.date_of_birth)}\n        - Gender: ${c.gender||"Not specified"}\n        - Height: ${c.height?c.height+" cm":"Not provided"}\n        - Weight: ${c.weight?c.weight+" kg":"Not provided"}\n        - BMI: ${c.bmi||"Not calculated"}\n        ${c.conditions.length>0?"- Medical Conditions: "+c.conditions.join(", "):"- No medical conditions specified"}\n        ${c.medications.length>0?"- Medications: "+c.medications.join(", "):"- No medications specified"}\n        \n        Focus area: ${h}\n        \n        ${b?"Additional context: "+b:""}\n        \n        Please provide detailed health recommendations specific to the focus area. Include:\n        1. A summary of key recommendations\n        2. Detailed explanations and guidance\n        3. Specific actionable steps\n        4. Any relevant warnings or precautions\n        \n        Format your response as a JSON object with these keys:\n        - summary: A brief summary of recommendations (1-2 sentences)\n        - recommendations: Array of specific recommendation objects, each with:\n          - title: Short title for the recommendation\n          - description: Detailed explanation\n          - action_steps: Array of specific action steps\n        - warnings: Any important precautions or warnings\n      `,a=await me(e),n={focus_area:h,summary:a.summary||"",recommendations:a.recommendations||[],warnings:a.warnings||[],created_at:(new Date).toISOString()};u(n),await k(n),S(r)}catch(y){console.error("Error generating recommendations:",y),N("Failed to generate recommendations. Please try again later.")}finally{t(!1)}},disabled:a},a?l.a.createElement(l.a.Fragment,null,l.a.createElement(v,{size:"sm"})," Generating..."):"Generate Recommendations")):l.a.createElement("div",{className:"alert alert-warning"},"Please complete your health profile to receive personalized recommendations.",l.a.createElement("div",{className:"mt-3"},l.a.createElement("button",{className:"btn btn-primary",onClick:()=>w("/profile")},"Complete Profile"))),p.length>0&&l.a.createElement("div",{className:"mt-4"},l.a.createElement("h6",null,"Previous Recommendations"),l.a.createElement("div",{className:"list-group",style:{maxHeight:"250px",overflowY:"auto"}},p.map(e=>{var a;return l.a.createElement("button",{key:e.id,className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",onClick:()=>(async e=>{try{const a=p.find(a=>a.id===e);a&&u(JSON.parse(a.recommendations))}catch(y){console.error("Error viewing historical recommendation:",y)}})(e.id)},l.a.createElement("div",null,l.a.createElement("div",null,(null===(a=_.find(a=>a.id===e.focus_area))||void 0===a?void 0:a.label)||e.focus_area),l.a.createElement("small",{className:"text-muted"},new Date(e.created_at).toLocaleDateString())),l.a.createElement("span",{className:"badge bg-primary rounded-pill"},"View"))})))))),l.a.createElement("div",{className:"col-lg-8"},a?l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-body text-center py-5"},l.a.createElement(v,null),l.a.createElement("p",{className:"mt-3"},"Generating personalized health recommendations..."),l.a.createElement("p",{className:"text-muted small"},"This may take a moment as our AI analyzes your health profile"))):d?l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h5",{className:"mb-0"},(null===(e=_.find(e=>e.id===d.focus_area))||void 0===e?void 0:e.label)||d.focus_area," Recommendations")),l.a.createElement("div",{className:"card-body"},l.a.createElement("p",{className:"lead"},d.summary),l.a.createElement("div",{className:"recommendations-list mt-4"},d.recommendations.map((e,a)=>{var t;return l.a.createElement("div",{key:a,className:"recommendation-item mb-4"},l.a.createElement("h5",null,e.title),l.a.createElement("p",null,e.description),(null===(t=e.action_steps)||void 0===t?void 0:t.length)>0&&l.a.createElement("div",{className:"action-steps"},l.a.createElement("h6",null,"Action Steps:"),l.a.createElement("ul",null,e.action_steps.map((e,a)=>l.a.createElement("li",{key:a},e)))))})),d.warnings&&l.a.createElement("div",{className:"alert alert-warning mt-3"},l.a.createElement("h6",null,"Important Notes:"),l.a.createElement("p",null,d.warnings)),l.a.createElement("div",{className:"disclaimer mt-4"},l.a.createElement("small",{className:"text-muted"},l.a.createElement("strong",null,"Disclaimer:")," These recommendations are generated by AI based on your profile information. They are not a substitute for professional medical advice. Always consult with healthcare providers before making significant changes to your health regimen."))),l.a.createElement("div",{className:"card-footer text-muted"},l.a.createElement("small",null,"Generated on ",new Date(d.created_at).toLocaleString()))):l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-body p-5 text-center"},l.a.createElement("div",{className:"text-muted mb-3"},l.a.createElement("i",{className:"fas fa-lightbulb fa-3x"})),l.a.createElement("h5",null,"Select a focus area and generate recommendations"),l.a.createElement("p",{className:"text-muted"},"Our AI will analyze your health profile and provide personalized recommendations based on your specific needs and goals."))),l.a.createElement("div",{className:"card shadow-sm mt-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",null,"How We Create Your Recommendations"),l.a.createElement("p",null,"Our AI-powered recommendation system uses multiple data points from your health profile to generate personalized health guidance:"),l.a.createElement("div",{className:"row g-4"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"d-flex mb-2"},l.a.createElement("div",{className:"me-3 text-primary"},l.a.createElement("i",{className:"fas fa-user-circle fa-lg"})),l.a.createElement("div",null,l.a.createElement("h6",null,"Your Profile"),l.a.createElement("p",{className:"text-muted small mb-0"},"Age, gender, height, weight, and BMI are used to tailor recommendations to your body type and demographics.")))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"d-flex mb-2"},l.a.createElement("div",{className:"me-3 text-primary"},l.a.createElement("i",{className:"fas fa-notes-medical fa-lg"})),l.a.createElement("div",null,l.a.createElement("h6",null,"Medical Conditions"),l.a.createElement("p",{className:"text-muted small mb-0"},"Any conditions listed in your profile are considered to ensure recommendations are appropriate and safe.")))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"d-flex mb-2"},l.a.createElement("div",{className:"me-3 text-primary"},l.a.createElement("i",{className:"fas fa-chart-line fa-lg"})),l.a.createElement("div",null,l.a.createElement("h6",null,"Health Parameters"),l.a.createElement("p",{className:"text-muted small mb-0"},"Your recorded health metrics like blood pressure, cholesterol, and glucose levels inform specific health guidance.")))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"d-flex"},l.a.createElement("div",{className:"me-3 text-primary"},l.a.createElement("i",{className:"fas fa-brain fa-lg"})),l.a.createElement("div",null,l.a.createElement("h6",null,"AI Analysis"),l.a.createElement("p",{className:"text-muted small mb-0"},"Advanced AI models analyze your complete health profile to generate evidence-based recommendations specific to your selected focus area."))))),l.a.createElement("div",{className:"alert alert-info mt-3 mb-0"},l.a.createElement("small",null,l.a.createElement("strong",null,"Privacy Note:")," Your health data is processed securely. We use anonymized data when communicating with AI services to ensure your privacy is protected.")))))))};var Ee=()=>{const{user:e}=d(),[a,t]=Object(n.useState)(null),[r,s]=Object(n.useState)(null),[c,i]=Object(n.useState)(!1),[m,u]=Object(n.useState)(null),[p,E]=Object(n.useState)(null),[h,g]=Object(n.useState)(null),[b,f]=Object(n.useState)([]),[N,w]=Object(n.useState)(!1),[_,x]=Object(n.useState)("upload"),[S,k]=Object(n.useState)(null),[C,A]=Object(n.useState)(!1),O=Object(n.useRef)(null),I=Object(n.useRef)(null);Object(n.useEffect)(()=>{e&&(T(),F());const a=I.current;if(a){const e=e=>{e.preventDefault(),e.stopPropagation()},t=()=>a.classList.add("highlight"),n=()=>a.classList.remove("highlight"),l=a=>{e(a),n();const t=a.dataTransfer.files;t&&t.length&&D(t[0])};return["dragenter","dragover","dragleave","drop"].forEach(t=>{a.addEventListener(t,e,!1)}),["dragenter","dragover"].forEach(e=>{a.addEventListener(e,t,!1)}),["dragleave","drop"].forEach(e=>{a.addEventListener(e,n,!1)}),a.addEventListener("drop",l,!1),()=>{["dragenter","dragover","dragleave","drop"].forEach(t=>{a.removeEventListener(t,e,!1)}),["dragenter","dragover"].forEach(e=>{a.removeEventListener(e,t,!1)}),["dragleave","drop"].forEach(e=>{a.removeEventListener(e,n,!1)}),a.removeEventListener("drop",l,!1)}}},[e]);const T=async()=>{if(e){w(!0);try{const{data:a,error:t}=await o.supabase.from("document_scans").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(10);if(t)throw t;f(a||[])}catch(a){console.error("Error fetching scan history:",a)}finally{w(!1)}}},D=e=>{if(!e)return;if(!["image/jpeg","image/png","image/jpg","application/pdf"].includes(e.type))return void g({type:"danger",message:"Please upload a valid file (JPEG, PNG, or PDF)"});const a=e.size/1048576;a>10?g({type:"warning",message:`This file is ${a.toFixed(1)}MB, which may take longer to process or time out. Consider using a smaller file.`}):a>5&&g({type:"info",message:`This file is ${a.toFixed(1)}MB. Larger files may take longer to process.`}),t(e),e.type.startsWith("image/")?s(URL.createObjectURL(e)):s(null),u(null),E(null)},j=async t=>{try{const{error:n}=await o.supabase.from("document_scans").insert({user_id:e.id,document_name:a.name,extracted_text:t,created_at:(new Date).toISOString()});if(n)throw n}catch(n){console.error("Error saving to database:",n)}},R=()=>{t(null),s(null),u(null),E(null),O.current&&(O.current.value="")},F=async()=>{A(!0);try{const e=await(async()=>{console.log("Testing OpenAI connection...");try{const e="This is a connectivity test. Please respond with 'connected' if you receive this message.",a=await me(e,{timeout:1e4});return a?(console.log("OpenAI connection test response:",a),{connected:!0,backendStatus:"available",visionApiStatus:"using OpenAI instead",message:"OpenAI connection successful",timestamp:(new Date).toISOString()}):{connected:!1,backendStatus:"error",visionApiStatus:"unavailable",message:"OpenAI returned empty response",timestamp:(new Date).toISOString()}}catch(p){return console.error("OpenAI connection test failed:",p),"AbortError"===p.name||p.message.includes("timed out")?{connected:!1,backendStatus:"timeout",visionApiStatus:"timeout",message:"Connection test timed out",timestamp:(new Date).toISOString()}:p.message.includes("Failed to fetch")?{connected:!1,backendStatus:"unreachable",visionApiStatus:"unreachable",message:"Backend server is unreachable. Check your network connection or the server might be down.",timestamp:(new Date).toISOString()}:{connected:!1,backendStatus:"error",visionApiStatus:"error",message:p.message||"Unknown connection error",timestamp:(new Date).toISOString()}}})();k(e),e.connected||console.warn("Vision API connection test failed:",e.message)}catch(p){console.error("Error testing API connection:",p),k({connected:!1,message:"Error checking connection: "+(p.message||"Unknown error"),timestamp:(new Date).toISOString()})}finally{A(!1)}};return l.a.createElement("div",{className:"ai-feature-container"},h&&l.a.createElement("div",{className:"notification notification-"+h.type},l.a.createElement("span",null,h.message),l.a.createElement("button",{className:"close-btn",onClick:()=>g(null)},"\xd7")),l.a.createElement("div",{className:"ai-feature-header"},l.a.createElement("h1",null,l.a.createElement(y.u,null)," Medical Document Scanner"),l.a.createElement("p",null,"Upload medical documents, prescriptions, or reports to extract text using AI-powered OCR."),l.a.createElement("div",{className:"api-connection-status"},l.a.createElement("button",{className:"connection-test-button",onClick:F,disabled:C},C?l.a.createElement(l.a.Fragment,null,l.a.createElement(v,{size:"sm"})," Testing Connection..."):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.ob,null),S?S.connected?"API Connected":"Connection Issue":"Check API Connection")),S&&l.a.createElement("div",{className:"connection-details "+(S.connected?"connected":"disconnected")},l.a.createElement("p",null,l.a.createElement("strong",null,"Status:"),S.connected?l.a.createElement("span",{className:"status-connected"},"Connected"):l.a.createElement("span",{className:"status-disconnected"},"Disconnected")),l.a.createElement("p",null,l.a.createElement("strong",null,"Backend:")," ",S.backendStatus),"unknown"!==S.visionApiStatus&&l.a.createElement("p",null,l.a.createElement("strong",null,"Vision API:")," ",S.visionApiStatus),l.a.createElement("p",null,l.a.createElement("strong",null,"Message:")," ",S.message),l.a.createElement("p",null,l.a.createElement("strong",null,"Last Checked:")," ",new Date(S.timestamp).toLocaleTimeString()),!S.connected&&l.a.createElement("div",{className:"connection-warning"},l.a.createElement(y.s,null),l.a.createElement("span",null,"The document scanning service may not work properly due to connection issues."))))),l.a.createElement("div",{className:"tab-navigation"},l.a.createElement("button",{className:"tab-button "+("upload"===_?"active":""),onClick:()=>x("upload")},l.a.createElement(y.hb,null)," Upload & Scan"),l.a.createElement("button",{className:"tab-button "+("history"===_?"active":""),onClick:()=>x("history")},l.a.createElement(y.A,null)," Scan History")),"upload"===_?l.a.createElement("div",{className:"ai-feature-content"},l.a.createElement("div",{className:"feature-panel"},l.a.createElement("div",{className:"upload-section"},l.a.createElement("div",{className:"drop-area",ref:I,onClick:()=>O.current&&O.current.click()},a?l.a.createElement("div",{className:"file-preview"},r?l.a.createElement("img",{src:r,alt:"Document Preview",className:"preview-image"}):l.a.createElement("div",{className:"pdf-preview"},l.a.createElement(y.u,{className:"file-icon"}),l.a.createElement("span",{className:"file-name"},a.name)),l.a.createElement("div",{className:"file-info"},l.a.createElement("span",null,a.name),l.a.createElement("span",{className:"file-size"},(a.size/1024).toFixed(2)," KB")),l.a.createElement("button",{className:"remove-file",onClick:e=>{e.stopPropagation(),R()}},l.a.createElement(y.gb,null))):l.a.createElement("div",{className:"upload-prompt"},l.a.createElement(y.hb,{className:"upload-icon"}),l.a.createElement("h3",null,"Drag & Drop or Click to Upload"),l.a.createElement("p",null,"Support for JPEG, PNG, and PDF files")),l.a.createElement("input",{type:"file",className:"file-input",accept:"image/jpeg,image/png,image/jpg,application/pdf",onChange:e=>{D(e.target.files[0])},ref:O,style:{display:"none"}})),l.a.createElement("div",{className:"action-buttons"},l.a.createElement("button",{className:"primary-button",onClick:async()=>{if(a){i(!0),E(null),g(null);try{const t=a.size/1048576;t>3&&g({type:"info",message:`Processing a ${t.toFixed(1)}MB file. This may take a while...`});const n=await de(a);if(!n||!n.text)throw new Error("No text could be extracted from the document");u(n),e&&!n.fallback&&(await j(n.text),T()),n.fallback?g({type:"warning",message:"Server extraction is unavailable. Limited text extraction provided in fallback mode."}):g({type:"success",message:"Text successfully extracted from document"})}catch(t){console.error("Error extracting text:",t);let e=t.message||"Failed to extract text. Please try again with a different document.",n="danger";if(e.includes("timed out")){e=`Document extraction timed out after processing for too long. Your file (${(a.size/1048576).toFixed(1)}MB) might be too large or complex. Try with a smaller file or a clearer image.`,n="warning"}else e.includes("temporarily unavailable")&&(e="Document scanning service is temporarily unavailable. Please try again later.",n="warning");E(e),g({type:n,message:e})}finally{i(!1)}}},disabled:!a||c},c?l.a.createElement(l.a.Fragment,null,l.a.createElement(v,{size:"sm"}),l.a.createElement("span",null,"Processing...")):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.U,null),l.a.createElement("span",null,"Extract Text"))),l.a.createElement("button",{className:"secondary-button",onClick:R,disabled:!a||c},l.a.createElement(y.gb,null),l.a.createElement("span",null,"Reset")))),p&&l.a.createElement("div",{className:"error-message"},l.a.createElement("p",null,p))),m&&m.text&&l.a.createElement("div",{className:"results-panel"},l.a.createElement("div",{className:"results-header"},l.a.createElement("h2",null,"Extracted Text"),l.a.createElement("div",{className:"results-actions"},l.a.createElement("button",{className:"icon-button",onClick:()=>{m&&m.text&&navigator.clipboard.writeText(m.text).then(()=>{g({type:"success",message:"Text copied to clipboard"})}).catch(e=>{console.error("Failed to copy text:",e),g({type:"danger",message:"Failed to copy text to clipboard"})})},title:"Copy to clipboard"},l.a.createElement(y.k,null)),l.a.createElement("button",{className:"icon-button",onClick:()=>{if(!m||!m.text)return;const e=new Blob([m.text],{type:"text/plain"}),a=URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download=`extracted-text-${(new Date).toISOString().slice(0,10)}.txt`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a)},title:"Download as text file"},l.a.createElement(y.p,null)))),l.a.createElement("div",{className:"results-content"},l.a.createElement("pre",{className:"extracted-text"},m.text)))):l.a.createElement("div",{className:"history-panel"},l.a.createElement("h2",null,"Recent Scans"),N?l.a.createElement("div",{className:"loading-container"},l.a.createElement(v,null)):b.length>0?l.a.createElement("div",{className:"history-list"},b.map(e=>l.a.createElement("div",{key:e.id,className:"history-item",onClick:()=>(e=>{u({text:e.extracted_text}),x("upload")})(e)},l.a.createElement("div",{className:"history-item-icon"},l.a.createElement(y.u,null)),l.a.createElement("div",{className:"history-item-content"},l.a.createElement("h3",null,e.document_name),l.a.createElement("p",{className:"history-item-preview"},e.extracted_text.substring(0,120),e.extracted_text.length>120?"...":""),l.a.createElement("span",{className:"history-item-date"},new Date(e.created_at).toLocaleDateString()))))):l.a.createElement("div",{className:"empty-state"},l.a.createElement(y.u,{className:"empty-icon"}),l.a.createElement("p",null,"No scan history found. Upload a document to get started."))),l.a.createElement("div",{className:"ai-feature-tips"},l.a.createElement("h3",null,"Tips for Best Results"),l.a.createElement("ul",null,l.a.createElement("li",null,"Ensure documents are well-lit and clearly visible"),l.a.createElement("li",null,"Text extraction works best on typewritten documents"),l.a.createElement("li",null,"For handwritten text, ensure writing is clear and legible"),l.a.createElement("li",null,"For multi-page documents, scan one page at a time for best results"),l.a.createElement("li",null,"Position the camera directly above the document to avoid distortion"))))};var he=()=>{const{user:e}=d(),[a,t]=Object(n.useState)(null),[r,s]=Object(n.useState)(null),[c,i]=Object(n.useState)(!1),[m,u]=Object(n.useState)(null),[p,E]=Object(n.useState)(null),[h,g]=Object(n.useState)(null),[b,f]=Object(n.useState)([]),[N,w]=Object(n.useState)(!1),[_,x]=Object(n.useState)(!1),[S,k]=Object(n.useState)("upload"),C=Object(n.useRef)(null),A=Object(n.useRef)(null),O=Object(n.useRef)(null),I=Object(n.useRef)(null),T=Object(n.useRef)(null);Object(n.useEffect)(()=>(e&&D(),()=>{if(I.current){I.current.getTracks().forEach(e=>e.stop())}}),[e]),Object(n.useEffect)(()=>{const e=T.current;if(e&&!_){const a=e=>{e.preventDefault(),e.stopPropagation()},t=()=>e.classList.add("highlight"),n=()=>e.classList.remove("highlight"),l=e=>{a(e),n();const t=e.dataTransfer.files;t&&t.length&&j(t[0])};return["dragenter","dragover","dragleave","drop"].forEach(t=>{e.addEventListener(t,a,!1)}),["dragenter","dragover"].forEach(a=>{e.addEventListener(a,t,!1)}),["dragleave","drop"].forEach(a=>{e.addEventListener(a,n,!1)}),e.addEventListener("drop",l,!1),()=>{["dragenter","dragover","dragleave","drop"].forEach(t=>{e.removeEventListener(t,a,!1)}),["dragenter","dragover"].forEach(a=>{e.removeEventListener(a,t,!1)}),["dragleave","drop"].forEach(a=>{e.removeEventListener(a,n,!1)}),e.removeEventListener("drop",l,!1)}}},[_]);const D=async()=>{if(e){w(!0);try{const{data:a,error:t}=await o.supabase.from("medication_identifications").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(10);if(t)throw t;f(a||[])}catch(a){console.error("Error fetching identification history:",a)}finally{w(!1)}}},j=e=>{e&&(e.type.startsWith("image/")?(t(e),s(URL.createObjectURL(e)),u(null),E(null)):g({type:"danger",message:"Please upload a valid image file (JPEG, PNG)"}))},R=()=>{if(I.current){I.current.getTracks().forEach(e=>e.stop()),I.current=null}A.current&&(A.current.srcObject=null),x(!1)},F=e=>new Promise((a,t)=>{const n=new FileReader;n.readAsDataURL(e),n.onload=()=>a(n.result),n.onerror=e=>t(e)}),L=async a=>{try{const{name:t,confidence:n,dosage:l,warnings:s}=a.medication||{},c=r,{error:i}=await o.supabase.from("medication_identifications").insert({user_id:e.id,medication_name:t||"Unknown",confidence:n||0,dosage:l||"",warnings:s||[],image_url:c,created_at:(new Date).toISOString()});if(i)throw i}catch(t){console.error("Error saving to database:",t)}},P=()=>{t(null),s(null),u(null),E(null),C.current&&(C.current.value="")};return l.a.createElement("div",{className:"ai-feature-container"},h&&l.a.createElement("div",{className:"notification notification-"+h.type},l.a.createElement("span",null,h.message),l.a.createElement("button",{className:"close-btn",onClick:()=>g(null)},"\xd7")),l.a.createElement("div",{className:"ai-feature-header"},l.a.createElement("h1",null,l.a.createElement(y.P,null)," Medication Identifier"),l.a.createElement("p",null,"Take a photo of your medication or upload an image to identify pills, capsules, and prescription medications using AI vision analysis.")),l.a.createElement("div",{className:"tab-navigation"},l.a.createElement("button",{className:"tab-button "+("upload"===S?"active":""),onClick:()=>k("upload")},l.a.createElement(y.hb,null)," Upload & Identify"),l.a.createElement("button",{className:"tab-button "+("history"===S?"active":""),onClick:()=>k("history")},l.a.createElement(y.A,null)," Identification History")),"upload"===S?l.a.createElement("div",{className:"ai-feature-content"},l.a.createElement("div",{className:"feature-panel"},l.a.createElement("div",{className:"upload-section"},_?l.a.createElement("div",{className:"camera-container"},l.a.createElement("video",{ref:A,autoPlay:!0,playsInline:!0,className:"camera-preview"}),l.a.createElement("canvas",{ref:O,style:{display:"none"}}),l.a.createElement("div",{className:"camera-controls"},l.a.createElement("button",{className:"primary-button",onClick:()=>{if(!A.current||!O.current)return;const e=A.current,a=O.current,n=a.getContext("2d");a.width=e.videoWidth,a.height=e.videoHeight,n.drawImage(e,0,0,a.width,a.height),a.toBlob(e=>{const n=new File([e],"captured-image.jpg",{type:"image/jpeg"});t(n),s(a.toDataURL("image/jpeg")),R()},"image/jpeg",.9)}},l.a.createElement(y.f,null),l.a.createElement("span",null,"Capture Photo")),l.a.createElement("button",{className:"secondary-button",onClick:R},"Cancel"))):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"camera-upload-buttons"},l.a.createElement("button",{className:"camera-button",onClick:async()=>{try{const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});I.current=e,A.current&&(A.current.srcObject=e),x(!0),u(null),E(null)}catch(e){console.error("Error accessing camera:",e),g({type:"danger",message:"Unable to access camera. Please check permissions or use file upload."})}}},l.a.createElement(y.f,null)," Use Camera"),l.a.createElement("span",{className:"or-divider"},"or"),l.a.createElement("div",{className:"drop-area",ref:T,onClick:()=>C.current&&C.current.click()},r?l.a.createElement("div",{className:"file-preview"},l.a.createElement("img",{src:r,alt:"Medication Preview",className:"preview-image"}),l.a.createElement("button",{className:"remove-file",onClick:e=>{e.stopPropagation(),P()}},l.a.createElement(y.gb,null))):l.a.createElement("div",{className:"upload-prompt"},l.a.createElement(y.hb,{className:"upload-icon"}),l.a.createElement("h3",null,"Drag & Drop or Click to Upload"),l.a.createElement("p",null,"Upload an image of a medication to identify")),l.a.createElement("input",{type:"file",className:"file-input",accept:"image/*",onChange:e=>{j(e.target.files[0])},ref:C,style:{display:"none"}})))),r&&!_&&l.a.createElement("div",{className:"action-buttons"},l.a.createElement("button",{className:"primary-button",onClick:async()=>{if(a||r){i(!0),E(null),g(null);try{let t;t=r||await F(a);const n=await(async e=>{try{console.log("Identifying medication with OpenAI");const t='\n      Analyze this image of medication and identify the following details:\n      \n      1. Medication name (both brand and generic if visible)\n      2. Dosage information\n      3. Medication class/type\n      4. Physical description (color, shape, markings)\n      5. Any visible warnings or special instructions\n      6. Manufacturer information if visible\n      \n      Format your response as a JSON object with these fields:\n      {\n        "medicationName": "Name of medication",\n        "genericName": "Generic name if different",\n        "dosage": "Dosage information",\n        "medicationType": "Class/category of medication",\n        "appearance": "Physical description",\n        "warnings": ["Array of warnings"],\n        "manufacturer": "Manufacturer name",\n        "confidence": 0.95 // Your confidence score from 0-1\n      }\n    ',n=await me(t,{imageUrl:e,isImageAnalysis:!0,model:"gpt-4-vision-preview",timeout:3e4});let l;if("string"===typeof n)try{const e=n.match(/```json\n([\s\S]*?)\n```/)||n.match(/```\n([\s\S]*?)\n```/)||n.match(/\{[\s\S]*\}/);if(!e)throw new Error("Could not parse medication information");l=JSON.parse(e[1]||e[0])}catch(a){throw console.warn("Error parsing OpenAI medication response:",a),new Error("Could not parse medication information from the response")}else l=n;return l}catch(p){if(console.error("Error identifying medication with OpenAI:",p),"AbortError"===p.name||p.message.includes("timed out"))throw new Error("Medication identification timed out. Please try again with a clearer image.");if(p.message.includes("Failed to fetch"))throw new Error("Could not connect to the OpenAI service. Please check your internet connection or try again later.");throw p}})(t);if(!n||!n.medication)throw new Error("Could not identify medication from the image");u(n),e&&(await L(n),D()),g({type:"success",message:"Medication analysis complete"})}catch(t){console.error("Error identifying medication:",t),E(t.message||"Failed to analyze medication. Please try again with a clearer image."),g({type:"danger",message:t.message||"Failed to analyze medication. Please try again."})}finally{i(!1)}}},disabled:c},c?l.a.createElement(l.a.Fragment,null,l.a.createElement(v,{size:"sm"}),l.a.createElement("span",null,"Analyzing...")):l.a.createElement(l.a.Fragment,null,l.a.createElement(y.U,null),l.a.createElement("span",null,"Identify Medication"))),l.a.createElement("button",{className:"secondary-button",onClick:P,disabled:c},l.a.createElement(y.gb,null),l.a.createElement("span",null,"Reset"))),p&&l.a.createElement("div",{className:"error-message"},l.a.createElement("p",null,p)))),m&&m.medication&&l.a.createElement("div",{className:"results-panel medication-results"},l.a.createElement("div",{className:"results-header"},l.a.createElement("h2",null,"Medication Information")),l.a.createElement("div",{className:"results-content"},l.a.createElement("div",{className:"medication-info"},l.a.createElement("h3",{className:"medication-name"},m.medication.name||"Unknown Medication"),m.medication.confidence&&l.a.createElement("div",{className:"confidence-meter"},l.a.createElement("div",{className:"confidence-label"},l.a.createElement("span",null,"Confidence"),l.a.createElement("span",null,(100*m.medication.confidence).toFixed(0),"%")),l.a.createElement("div",{className:"confidence-bar"},l.a.createElement("div",{className:"confidence-fill",style:{width:100*m.medication.confidence+"%"}}))),m.medication.dosage&&l.a.createElement("div",{className:"info-section"},l.a.createElement("h4",null,"Dosage Information"),l.a.createElement("p",null,m.medication.dosage)),m.medication.description&&l.a.createElement("div",{className:"info-section"},l.a.createElement("h4",null,"Description"),l.a.createElement("p",null,m.medication.description)),m.medication.warnings&&m.medication.warnings.length>0&&l.a.createElement("div",{className:"info-section"},l.a.createElement("h4",null,"Warnings & Precautions"),l.a.createElement("ul",{className:"warning-list"},m.medication.warnings.map((e,a)=>l.a.createElement("li",{key:a,className:"warning-item"},l.a.createElement(y.D,{className:"warning-icon"}),l.a.createElement("span",null,e))))),m.medication.uses&&l.a.createElement("div",{className:"info-section"},l.a.createElement("h4",null,"Common Uses"),l.a.createElement("p",null,m.medication.uses))),l.a.createElement("div",{className:"disclaimer"},l.a.createElement(y.D,null),l.a.createElement("p",null,"This information is generated by AI and should not replace professional medical advice. Always consult with your healthcare provider about medications."))))):l.a.createElement("div",{className:"history-panel"},l.a.createElement("h2",null,"Medication Identification History"),N?l.a.createElement("div",{className:"loading-container"},l.a.createElement(v,null)):b.length>0?l.a.createElement("div",{className:"history-list"},b.map(e=>l.a.createElement("div",{key:e.id,className:"history-item medication-history-item",onClick:()=>(e=>{s(e.image_url),u({medication:{name:e.medication_name,confidence:e.confidence,dosage:e.dosage,warnings:e.warnings||[]}}),k("upload")})(e)},e.image_url&&l.a.createElement("div",{className:"history-item-image"},l.a.createElement("img",{src:e.image_url,alt:"Medication"})),l.a.createElement("div",{className:"history-item-content"},l.a.createElement("h3",null,e.medication_name),l.a.createElement("div",{className:"history-item-details"},l.a.createElement("span",{className:"dosage"},e.dosage||"No dosage information"),l.a.createElement("span",{className:"confidence"},(100*e.confidence).toFixed(0),"% match")),l.a.createElement("span",{className:"history-item-date"},new Date(e.created_at).toLocaleDateString()))))):l.a.createElement("div",{className:"empty-state"},l.a.createElement(y.P,{className:"empty-icon"}),l.a.createElement("p",null,"No identification history found. Identify a medication to get started."))),l.a.createElement("div",{className:"ai-feature-tips"},l.a.createElement("h3",null,"Tips for Best Results"),l.a.createElement("ul",null,l.a.createElement("li",null,"Ensure good lighting when taking photos of medications"),l.a.createElement("li",null,"Position the medication against a plain background"),l.a.createElement("li",null,"Capture both sides of pills if they have different markings"),l.a.createElement("li",null,"Include medication packaging in the photo when possible"),l.a.createElement("li",null,"Make sure any text or imprints on the medication are clearly visible"))))};var ge=function(){return l.a.createElement(c.a,{basename:"/DiGiHealthAdv",future:{v7_startTransition:!0,v7_relativeSplatPath:!0}},l.a.createElement(u,null,l.a.createElement(p.a,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored",transition:"Bounce",limit:3}),l.a.createElement(i.d,null,l.a.createElement(i.b,{path:"/",element:l.a.createElement(f,null)}),l.a.createElement(i.b,{path:"/register",element:l.a.createElement(N,null)}),l.a.createElement(i.b,{path:"/dashboard",element:l.a.createElement(b,null,l.a.createElement(O,null))}),l.a.createElement(i.b,{path:"/health-overview",element:l.a.createElement(b,null,l.a.createElement(R,null))}),l.a.createElement(i.b,{path:"/medical-history",element:l.a.createElement(b,null,l.a.createElement(F,null))}),l.a.createElement(i.b,{path:"/chronic-disease-management",element:l.a.createElement(b,null,l.a.createElement(L,null))}),l.a.createElement(i.b,{path:"/vaccination-history",element:l.a.createElement(b,null,l.a.createElement(P,null))}),l.a.createElement(i.b,{path:"/medication-tracker",element:l.a.createElement(b,null,l.a.createElement(q,null))}),l.a.createElement(i.b,{path:"/health-analytics",element:l.a.createElement(b,null,l.a.createElement(H,null))}),l.a.createElement(i.b,{path:"/appointments/upcoming",element:l.a.createElement(b,null,l.a.createElement(B,null))}),l.a.createElement(i.b,{path:"/appointments/history",element:l.a.createElement(b,null,l.a.createElement(z,null))}),l.a.createElement(i.b,{path:"/appointments/telehealth",element:l.a.createElement(b,null,l.a.createElement($,null))}),l.a.createElement(i.b,{path:"/appointments/reminders",element:l.a.createElement(b,null,l.a.createElement(W,null))}),l.a.createElement(i.b,{path:"/help-center",element:l.a.createElement(b,null,l.a.createElement(Y,null))}),l.a.createElement(i.b,{path:"/support/contact",element:l.a.createElement(b,null,l.a.createElement(G,null))}),l.a.createElement(i.b,{path:"/support/chat",element:l.a.createElement(b,null,l.a.createElement(V,null))}),l.a.createElement(i.b,{path:"/profile",element:l.a.createElement(b,null,l.a.createElement(J,null))}),l.a.createElement(i.b,{path:"/settings/security",element:l.a.createElement(b,null,l.a.createElement(Q,null))}),l.a.createElement(i.b,{path:"/settings/backup",element:l.a.createElement(b,null,l.a.createElement(X,null))}),l.a.createElement(i.b,{path:"/admin/database-setup",element:l.a.createElement(b,null,l.a.createElement(ee,null))}),l.a.createElement(i.b,{path:"/health-metrics",element:l.a.createElement(b,null,l.a.createElement(ae,null))}),l.a.createElement(i.b,{path:"/image-analysis",element:l.a.createElement(b,null,l.a.createElement(te,null))}),l.a.createElement(i.b,{path:"/health-assistant",element:l.a.createElement(b,null,l.a.createElement(ne,null))}),l.a.createElement(i.b,{path:"/ai-insights",element:l.a.createElement(b,null,l.a.createElement(le,null))}),l.a.createElement(i.b,{path:"/health-metrics/upload",element:l.a.createElement(b,null,l.a.createElement(ae,{mode:"upload"}))}),l.a.createElement(i.b,{path:"/image-analysis/history",element:l.a.createElement(b,null,l.a.createElement(te,{mode:"history"}))}),l.a.createElement(i.b,{path:"/health-assistant/recommendations",element:l.a.createElement(b,null,l.a.createElement(ne,{mode:"recommendations"}))}),l.a.createElement(i.b,{path:"/ai/health-metrics",element:l.a.createElement(b,null,l.a.createElement(re,null))}),l.a.createElement(i.b,{path:"/ai/image-analysis",element:l.a.createElement(b,null,l.a.createElement(ue,null))}),l.a.createElement(i.b,{path:"/ai/health-assistant",element:l.a.createElement(b,null,l.a.createElement(ne,null))}),l.a.createElement(i.b,{path:"/ai/health-recommendations",element:l.a.createElement(b,null,l.a.createElement(pe,null))}),l.a.createElement(i.b,{path:"/ai/symptom-checker",element:l.a.createElement(b,null,l.a.createElement(se,null))}),l.a.createElement(i.b,{path:"/ai/document-scanner",element:l.a.createElement(b,null,l.a.createElement(Ee,null))}),l.a.createElement(i.b,{path:"/ai/medication-identifier",element:l.a.createElement(b,null,l.a.createElement(he,null))}))))};const be=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function fe(e,a){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;null!=t&&(t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}var ye=e=>{e&&e instanceof Function&&t.e(3).then(t.bind(null,103)).then(a=>{let{getCLS:t,getFID:n,getFCP:l,getLCP:r,getTTFB:s}=a;t(e),n(e),l(e),r(e),s(e)})};s.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(ge,null))),function(e){if("serviceWorker"in navigator){if(new URL("/DiGiHealthAdv",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const a="/DiGiHealthAdv/service-worker.js";be?(!function(e,a){fetch(e,{headers:{"Service-Worker":"script"}}).then(t=>{const n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):fe(e,a)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(a,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})):fe(a,e)})}}(),ye()}},[[63,1,2]]]);
//# sourceMappingURL=main.bac87628.chunk.js.map