(this.webpackJsonpdigihealth=this.webpackJsonpdigihealth||[]).push([[0],{15:function(e,a,t){},30:function(e,a,t){},40:function(e,a,t){const{createClient:n}=t(22),l="https://aqdzmfhakqdwquszaqle.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ";const s=n(l,r);e.exports={createExecuteSqlFunction:async()=>{try{const e="\n      CREATE OR REPLACE FUNCTION execute_sql(sql text)\n      RETURNS void AS $$\n      BEGIN\n        EXECUTE sql;\n      END;\n      $$ LANGUAGE plpgsql SECURITY DEFINER;\n    ",{error:a}=await s.rpc("execute_sql",{sql:e});a&&console.warn("Warning: Could not create execute_sql function. It might already exist.")}catch(e){console.warn("Warning: Error creating execute_sql function:",e.message)}},insertSampleData:async()=>{try{console.log("Inserting sample data...");const e=[{name:"Hypertension",category:"Cardiovascular",description:"High blood pressure condition"},{name:"Diabetes",category:"Endocrine",description:"Blood sugar regulation disorder"},{name:"Asthma",category:"Respiratory",description:"Chronic respiratory condition"},{name:"Arthritis",category:"Musculoskeletal",description:"Joint inflammation condition"},{name:"Depression",category:"Mental Health",description:"Mood disorder"},{name:"Anxiety",category:"Mental Health",description:"Anxiety disorder"},{name:"Migraine",category:"Neurological",description:"Severe headache condition"},{name:"Allergies",category:"Immunological",description:"Immune system response"},{name:"Hypothyroidism",category:"Endocrine",description:"Underactive thyroid condition"},{name:"Hyperthyroidism",category:"Endocrine",description:"Overactive thyroid condition"}],{error:a}=await s.from("diseases").upsert(e);if(a)throw a;console.log("Sample data inserted successfully")}catch(e){throw console.error("Error inserting sample data:",e),e}},createStorageBuckets:async()=>{try{console.log("Creating storage buckets...");const a="\n      ALTER DATABASE postgres SET \"app.settings.storage.enabled\" TO 'true';\n    ";await s.rpc("execute_sql",{sql:a});const t=["profile-pictures","medical-reports","health-reports","chat-attachments","support-attachments"];for(const l of t)try{const{error:e}=await s.storage.createBucket(l,{public:!0});e&&!e.message.includes("already exists")&&console.warn(`Warning creating bucket ${l}:`,e.message)}catch(e){console.warn(`Error creating bucket ${l}:`,e.message)}const n="\n      DO $$ \n      BEGIN\n        CREATE POLICY \"Allow public access to profile pictures\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'profile-pictures');\n        \n        CREATE POLICY \"Allow public access to medical reports\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'medical-reports');\n        \n        CREATE POLICY \"Allow public access to health reports\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'health-reports');\n        \n        CREATE POLICY \"Allow public access to chat attachments\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'chat-attachments');\n        \n        CREATE POLICY \"Allow public access to support attachments\"\n        ON storage.objects FOR ALL\n        USING (bucket_id = 'support-attachments');\n      EXCEPTION\n        WHEN others THEN\n          NULL;\n      END $$;\n    ";await s.rpc("execute_sql",{sql:n}),console.log("Storage buckets and policies created successfully")}catch(e){console.warn("Warning: Error setting up storage:",e.message)}}}},44:function(e,a,t){e.exports=t(69)},53:function(e,a,t){},54:function(e,a,t){},62:function(e,a,t){},66:function(e,a,t){},67:function(e,a,t){},68:function(e,a,t){},69:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(32),s=t.n(r),c=(t(52),t(11),t(53),t(54),t(12)),i=t(4),o=t(22);const m=Object(o.createClient)("https://aqdzmfhakqdwquszaqle.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ"),d=Object(n.createContext)();function u(){return Object(n.useContext)(d)}function p(e){let{children:a}=e;const[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(!0);Object(n.useEffect)(()=>{m.auth.getSession().then(e=>{var a;let{data:{session:t}}=e;r(null!==(a=null===t||void 0===t?void 0:t.user)&&void 0!==a?a:null),c(!1)});const{data:{subscription:e}}=m.auth.onAuthStateChange((e,a)=>{var t;r(null!==(t=null===a||void 0===a?void 0:a.user)&&void 0!==t?t:null),c(!1)});return()=>e.unsubscribe()},[]);const i={user:t,loading:s,signUp:e=>m.auth.signUp(e),signIn:e=>m.auth.signInWithPassword(e),signOut:()=>m.auth.signOut()};return l.a.createElement(d.Provider,{value:i},!s&&a)}var E=t(10);t(29);function h(){const e=document.querySelectorAll(".menu-item"),a=document.querySelector(".overlay");e.forEach(e=>{e.classList.remove("active");const a=e.querySelector(".sub-menu");a&&a.classList.remove("active")}),a&&a.classList.remove("active"),document.body.style.overflow=""}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("health-overview");e&&e.addEventListener("click",()=>{window.location.href="view-reports.html"})});t(30);var g=()=>{const e=Object(i.q)(),[a,t]=Object(n.useState)(!1);Object(n.useEffect)(()=>{!function(){const e=document.querySelectorAll(".menu-item"),a=document.querySelector(".overlay");e.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=e.querySelector(".sub-menu");n&&(n.classList.toggle("active"),e.classList.toggle("active"),a&&a.classList.toggle("active"),document.body.style.overflow=n.classList.contains("active")?"hidden":"")})}),a&&a.addEventListener("click",h)}(),r()},[]);const r=async()=>{try{var e;const{data:{user:a}}=await m.auth.getUser();a&&"admin"===(null===(e=a.user_metadata)||void 0===e?void 0:e.role)&&t(!0)}catch(a){console.error("Error checking user role:",a)}},s=a=>{a.preventDefault();switch(a.currentTarget.id){case"health-overview":e("/health-overview");break;case"medical-history":e("/medical-history");break;case"chronic-disease-management":e("/chronic-disease-management");break;case"vaccination-history":e("/vaccination-history");break;case"health-analytics":e("/health-analytics");break;case"medication-tracker":e("/medication-tracker");break;case"profile-settings":e("/profile");break;case"upcoming-appointments":e("/appointments/upcoming");break;case"appointment-history":e("/appointments/history");break;case"telehealth-consultations":e("/appointments/telehealth");break;case"appointment-reminders":e("/appointments/reminders");break;case"help-center":e("/help-center");break;case"contact-support":e("/support/contact");break;case"live-chat":e("/support/chat");break;case"security-settings":e("/settings/security");break;case"data-backup":e("/settings/backup");break;case"database-setup":e("/admin/database-setup");break;case"logout-div":o()}},o=async()=>{try{const{error:a}=await m.auth.signOut();if(a)throw a;e("/")}catch(a){console.error("Error logging out:",a.message)}};return l.a.createElement("nav",{id:"menu"},l.a.createElement("div",{className:"logo"},l.a.createElement(c.b,{to:"/dashboard"},l.a.createElement("img",{src:"/DiGiHealthAdv/favicon_io/android-chrome-512x512-Photoroom.png",alt:"Logo",className:"logo"}))),l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"Your Journey")),l.a.createElement("div",{className:"sub-menu triple"},l.a.createElement("div",{className:"icon-box",id:"health-overview",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-hospital-user"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Health Overview"),l.a.createElement("div",{className:"sub-text"},"See, add and update your Journey"))),l.a.createElement("div",{className:"icon-box",id:"medical-history",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-timeline"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Medical History"),l.a.createElement("div",{className:"sub-text"},"Through your Journey"))),l.a.createElement("div",{className:"icon-box",id:"chronic-disease-management",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-diagnoses"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Chronic Disease Management"),l.a.createElement("div",{className:"sub-text"},"Manage your chronic conditions"))),l.a.createElement("div",{className:"icon-box",id:"vaccination-history",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-syringe"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Vaccination History"),l.a.createElement("div",{className:"sub-text"},"View and manage vaccinations"))),l.a.createElement("div",{className:"icon-box",id:"medication-tracker",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-pills"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Medication Tracker"),l.a.createElement("div",{className:"sub-text"},"Track prescribed medications"))),l.a.createElement("div",{className:"icon-box",id:"health-analytics",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-chart-line"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Health Analytics"),l.a.createElement("div",{className:"sub-text"},"View your health trends"))))),l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"Appointments")),l.a.createElement("div",{className:"sub-menu double"},l.a.createElement("div",{className:"icon-box",id:"upcoming-appointments",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-calendar-check"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Upcoming Appointments"),l.a.createElement("div",{className:"sub-text"},"View and manage appointments"))),l.a.createElement("div",{className:"icon-box",id:"appointment-history",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-history"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Appointment History"),l.a.createElement("div",{className:"sub-text"},"Check past appointments"))),l.a.createElement("div",{className:"icon-box",id:"telehealth-consultations",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-phone-alt"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Telehealth Consultations"),l.a.createElement("div",{className:"sub-text"},"Book virtual appointments"))),l.a.createElement("div",{className:"icon-box",id:"appointment-reminders",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-clock"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Appointment Reminders"),l.a.createElement("div",{className:"sub-text"},"Set and manage reminders"))))),l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"Support")),l.a.createElement("div",{className:"sub-menu double"},l.a.createElement("div",{className:"icon-box",id:"help-center",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-book"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Help Center"),l.a.createElement("div",{className:"sub-text"},"FAQs and tutorials"))),l.a.createElement("div",{className:"icon-box",id:"contact-support",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-life-ring"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Contact Support"),l.a.createElement("div",{className:"sub-text"},"Reach out to our team"))),l.a.createElement("div",{className:"icon-box",id:"live-chat",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-comment-dots"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Live Chat"),l.a.createElement("div",{className:"sub-text"},"Chat with support agents"))))),l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"AI Tools")),l.a.createElement("div",{className:"sub-menu double"},l.a.createElement("div",{className:"icon-box",id:"ai-image-analysis",onClick:a=>{a.preventDefault(),e("/ai/image-analysis")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-microscope"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Medical Image Analysis"),l.a.createElement("div",{className:"sub-text"},"AI analysis of medical images"))),l.a.createElement("div",{className:"icon-box",id:"ai-health-assistant",onClick:a=>{a.preventDefault(),e("/ai/health-assistant")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-robot"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Health Assistant"),l.a.createElement("div",{className:"sub-text"},"Chat with our AI assistant"))),l.a.createElement("div",{className:"icon-box",id:"ai-recommendations",onClick:a=>{a.preventDefault(),e("/ai/health-recommendations")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-lightbulb"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Health Recommendations"),l.a.createElement("div",{className:"sub-text"},"Get personalized AI recommendations"))),l.a.createElement("div",{className:"icon-box",id:"ai-symptom-checker",onClick:a=>{a.preventDefault(),e("/ai/symptom-checker")}},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-stethoscope"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Symptom Checker"),l.a.createElement("div",{className:"sub-text"},"AI analysis of symptoms"))))),l.a.createElement("div",{className:"menu-item"},l.a.createElement("div",{className:"menu-text"},l.a.createElement("a",{href:"#","data-link":!0},"Account")),l.a.createElement("div",{className:"sub-menu double"},l.a.createElement("div",{className:"icon-box",id:"profile-settings",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-user-cog"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Profile Settings"),l.a.createElement("div",{className:"sub-text"},"Edit your personal details"))),l.a.createElement("div",{className:"icon-box",id:"security-settings",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-lock"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Security Settings"),l.a.createElement("div",{className:"sub-text"},"Manage passwords and 2FA"))),l.a.createElement("div",{className:"icon-box",id:"data-backup",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-download"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Data Backup & Export"),l.a.createElement("div",{className:"sub-text"},"Backup and download your data"))),a&&l.a.createElement("div",{className:"icon-box",id:"database-setup",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa fa-database"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Database Setup"),l.a.createElement("div",{className:"sub-text"},"Reset and setup database tables"))),l.a.createElement("div",{className:"icon-box",id:"logout-div",onClick:s},l.a.createElement("div",{className:"icon"},l.a.createElement("i",{className:"fa-solid fa-arrow-right-from-bracket"})),l.a.createElement("div",{className:"text"},l.a.createElement("div",{className:"title"},"Logout"),l.a.createElement("div",{className:"sub-text"},"Logout your account"))))))};var b=()=>l.a.createElement("footer",{style:{position:"relative",backgroundImage:"linear-gradient(0deg, #2AF598 0%, #08AEEA 100%)",width:"100%",textAlign:"center",padding:"1rem",marginTop:"auto",color:"#fff"}},l.a.createElement("p",null,"\xa9 ",(new Date).getFullYear()," DiGiHealth. All rights reserved."));var y=e=>{let{children:a}=e;return l.a.createElement("div",{className:"dashboard-layout"},l.a.createElement(g,null),l.a.createElement("main",null,a),l.a.createElement(b,null))};const f=Object(o.createClient)("https://aqdzmfhakqdwquszaqle.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ");t(15);var N=()=>{const[e,a]=Object(n.useState)(!1),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(""),[o,m]=Object(n.useState)(""),[d,u]=Object(n.useState)(""),[p,E]=Object(n.useState)(""),[h,g]=Object(n.useState)(""),[b,y]=Object(n.useState)(""),[N,v]=Object(n.useState)(""),w=Object(i.q)(),_=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";console.log(`Notification: ${e}, Type: ${a}`),r({message:e,type:a}),setTimeout(()=>r(null),3e3)};return l.a.createElement("div",{id:"app"},l.a.createElement("header",null,l.a.createElement("img",{src:"/DiGiHealthAdv/favicon_io/android-chrome-512x512-Photoroom.png",alt:"Logo",className:"logo",style:{width:"250px",height:"100%"}})),t&&l.a.createElement("div",{className:`alert alert-${t.type} alert-dismissible fade show`,role:"alert"},t.message),l.a.createElement("div",{id:"login-signup"},e?l.a.createElement("div",{id:"signup-form"},l.a.createElement("form",{className:"form",onSubmit:async e=>{if(e.preventDefault(),b===N)try{const{data:e,error:a}=await f.auth.signUp({email:h,password:b,options:{data:{first_name:d,last_name:p}}});if(a)throw a;if(e.user){const{error:a}=await f.from("detailed_profiles").insert([{id:e.user.id,first_name:d,last_name:p,email:h,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}]);if(a)throw a}_("Account created successfully!","success"),w("/dashboard")}catch(a){console.error("Signup error:",a.message),_(a.message,"danger")}else _("Passwords don't match","error")}},l.a.createElement("p",{className:"message"},"Signup now"),l.a.createElement("div",{className:"flex"},l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"firstname",type:"text",className:"input",placeholder:" ",value:d,onChange:e=>u(e.target.value)}),l.a.createElement("span",null,"Firstname")),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"lastname",type:"text",className:"input",placeholder:" ",value:p,onChange:e=>E(e.target.value)}),l.a.createElement("span",null,"Lastname"))),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"email",type:"email",className:"input",id:"signup-email",placeholder:" ",value:h,onChange:e=>g(e.target.value)}),l.a.createElement("span",null,"Email")),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"password",type:"password",className:"input",id:"signup-password",placeholder:" ",value:b,onChange:e=>y(e.target.value)}),l.a.createElement("span",null,"Password")),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"confirmPassword",type:"password",className:"input",placeholder:" ",value:N,onChange:e=>v(e.target.value)}),l.a.createElement("span",null,"Confirm password")),l.a.createElement("button",{type:"submit",className:"submit"},"Submit"),l.a.createElement("p",{className:"signin"},"Already have an account?"," ",l.a.createElement("a",{href:"/",onClick:()=>a(!1)},"Signin")))):l.a.createElement("div",{id:"login-form"},l.a.createElement("h2",null,"Login"),l.a.createElement("form",{className:"form1",onSubmit:async e=>{e.preventDefault();try{const{error:e}=await f.auth.signInWithPassword({email:s,password:o});if(e)throw e;_("Login successful!","success"),setTimeout(()=>{w("/dashboard")},3e3)}catch(a){console.error("Login error:",a.message),_(a.message,"danger")}}},l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"email",type:"email",className:"input",id:"login-email",autoComplete:"new-password",value:s,onChange:e=>c(e.target.value)}),l.a.createElement("span",null,"Email")),l.a.createElement("label",null,l.a.createElement("input",{required:!0,name:"password",type:"password",className:"input",id:"login-password",autoComplete:"login-password",value:o,onChange:e=>m(e.target.value)}),l.a.createElement("span",null,"Password")),l.a.createElement("div",null,l.a.createElement("button",{type:"submit",id:"login-button"},"Login"),l.a.createElement("button",{type:"button",onClick:()=>a(!0)},"Sign Up"))))))},v=t(1);var w=()=>{const e=Object(i.q)(),[a,t]=Object(n.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",role:"patient"}),[r,s]=Object(n.useState)(null),[c,o]=Object(n.useState)(!1),d=e=>{t({...a,[e.target.name]:e.target.value})};return l.a.createElement("div",{className:"container mt-5"},l.a.createElement("div",{className:"row justify-content-center"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"card shadow"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h2",{className:"text-center mb-4"},"Register"),r&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},r),l.a.createElement("form",{onSubmit:async t=>{if(t.preventDefault(),s(null),o(!0),a.password!==a.confirmPassword)return s("Passwords do not match"),void o(!1);try{const{data:t,error:n}=await m.auth.signUp({email:a.email,password:a.password,options:{data:{first_name:a.firstName,last_name:a.lastName,role:a.role}}});if(n)throw n;if(t.user){const{error:e}=await m.from("detailed_profiles").insert([{id:t.user.id,first_name:a.firstName,last_name:a.lastName,email:a.email,created_at:(new Date).toISOString()}]);if(e)throw e;const{error:n}=await m.from("profiles").insert([{id:t.user.id,full_name:`${a.firstName} ${a.lastName}`,email:a.email,role:a.role,created_at:(new Date).toISOString()}]);if(n)throw n}e("/dashboard")}catch(r){s(r.message)}finally{o(!1)}}},l.a.createElement("div",{className:"row mb-3"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("label",{className:"form-label"},"First Name"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(v.Y,null)),l.a.createElement("input",{type:"text",className:"form-control",name:"firstName",value:a.firstName,onChange:d,required:!0}))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("label",{className:"form-label"},"Last Name"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(v.Y,null)),l.a.createElement("input",{type:"text",className:"form-control",name:"lastName",value:a.lastName,onChange:d,required:!0})))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Email"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(v.p,null)),l.a.createElement("input",{type:"email",className:"form-control",name:"email",value:a.email,onChange:d,required:!0}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Password"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(v.E,null)),l.a.createElement("input",{type:"password",className:"form-control",name:"password",value:a.password,onChange:d,required:!0}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Confirm Password"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(v.E,null)),l.a.createElement("input",{type:"password",className:"form-control",name:"confirmPassword",value:a.confirmPassword,onChange:d,required:!0}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Role"),l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(v.ab,null)),l.a.createElement("select",{className:"form-select",name:"role",value:a.role,onChange:d},l.a.createElement("option",{value:"patient"},"Patient"),l.a.createElement("option",{value:"doctor"},"Doctor"),l.a.createElement("option",{value:"admin"},"Admin")))),l.a.createElement("button",{type:"submit",className:"btn btn-primary w-100",disabled:c},c?"Registering...":"Register")),l.a.createElement("div",{className:"text-center mt-3"},"Already have an account?"," ",l.a.createElement("a",{href:"/",className:"text-decoration-none"},"Login")))))))};t(62);var _=()=>l.a.createElement("div",{className:"spinner-overlay"},l.a.createElement("div",{className:"medical-spinner"},l.a.createElement("div",{className:"spinner-container"},l.a.createElement("div",{className:"cross-container"},l.a.createElement("div",{className:"cross-horizontal"}),l.a.createElement("div",{className:"cross-vertical"})),l.a.createElement("div",{className:"spinner-ring"})),l.a.createElement("div",{className:"heartbeat-container"},l.a.createElement("svg",{viewBox:"0 0 400 100",className:"ecg-line"},l.a.createElement("polyline",{className:"ecg-path",points:"0,50 30,50 45,50 60,20 75,80 90,50 105,50 120,50 150,50 170,50 185,50 200,20 215,80 230,50 245,50 270,50 300,50 320,50 335,50 350,20 365,80 380,50 395,50 400,50",fill:"none",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}))),l.a.createElement("div",{className:"spinner-text"},"Loading..."))),S=t(7);S.f.register(S.e,S.k,S.m,S.j,S.a,S.r,S.s,S.h);var x=()=>{var e;const a=Object(i.q)(),{user:t}=u(),[r,s]=Object(n.useState)(null),[o,m]=Object(n.useState)(!0),[d,p]=Object(n.useState)({vitals:[],medications:[],appointments:[],conditions:[],alerts:[],profile:null}),[E,h]=Object(n.useState)(null);Object(n.useEffect)(()=>{(async()=>{try{const{data:{user:e},error:t}=await f.auth.getUser();if(t||!e)return void a("/");const{data:n,error:l}=await f.from("detailed_profiles").select("*").eq("id",e.id).single();if(l){if("PGRST116"!==l.code)throw l;{const{data:a,error:t}=await f.from("detailed_profiles").insert([{id:e.id}]).select().single();if(t)throw t;p(e=>({...e,profile:a}))}}else p(e=>({...e,profile:n}))}catch(E){console.error("Error fetching data:",E),h("Failed to load dashboard data")}finally{m(!1)}})()},[a]);return o?l.a.createElement(_,null):E?l.a.createElement("div",{className:"alert alert-danger"},E):l.a.createElement("div",{className:"dashboard container-fluid py-4"},l.a.createElement("div",{className:"row mb-4"},l.a.createElement("div",{className:"col"},l.a.createElement("h1",{className:"h3"},"Welcome, ",(null===(e=d.profile)||void 0===e?void 0:e.first_name)||"User","!"),l.a.createElement("p",{className:"text-muted"},"Here's an overview of your health information"))),l.a.createElement("div",{className:"row mb-4"}),l.a.createElement("h4",{className:"mb-3"},"Main Features"),l.a.createElement("div",{className:"row g-4 mb-5"},[{title:"Profile",icon:"fa-user",description:"View and manage your profile information",link:"/profile",color:"primary"},{title:"Health Records",icon:"fa-file-medical",description:"Access your health records and history",link:"/health-records",color:"info"},{title:"Appointments",icon:"fa-calendar-check",description:"Schedule and manage appointments",link:"/appointments",color:"success"},{title:"Medications",icon:"fa-pills",description:"Track your medications and prescriptions",link:"/medications",color:"warning"}].map((e,a)=>l.a.createElement("div",{key:a,className:"col-12 col-md-6 col-lg-3"},l.a.createElement(c.b,{to:e.link,className:"text-decoration-none"},l.a.createElement("div",{className:`card h-100 border-${e.color} shadow-sm hover-card`},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement("div",{className:`icon-circle bg-${e.color} text-white`},l.a.createElement("i",{className:"fas "+e.icon})),l.a.createElement("h5",{className:"card-title mb-0 ms-3"},e.title)),l.a.createElement("p",{className:"card-text text-muted"},e.description))))))),l.a.createElement("h4",{className:"mb-3"},"AI-Powered Features"),l.a.createElement("div",{className:"row g-4 mb-5"},[{title:"Health Recommendations",icon:"fa-chart-line",description:"AI-powered health recommendations based on your profile",link:"/ai/health-recommendations",color:"primary"},{title:"Medical Image Analysis",icon:"fa-microscope",description:"AI analysis of medical images",link:"/ai/image-analysis",color:"info"},{title:"Health Assistant",icon:"fa-robot",description:"Chat with our AI health assistant",link:"/ai/health-assistant",color:"success"},{title:"Symptom Checker",icon:"fa-stethoscope",description:"AI-powered symptom analysis",link:"/ai/symptom-checker",color:"danger"}].map((e,a)=>l.a.createElement("div",{key:a,className:"col-12 col-md-6 col-lg-3"},l.a.createElement(c.b,{to:e.link,className:"text-decoration-none"},l.a.createElement("div",{className:`card h-100 border-${e.color} shadow-sm hover-card`},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement("div",{className:`icon-circle bg-${e.color} text-white`},l.a.createElement("i",{className:"fas "+e.icon})),l.a.createElement("h5",{className:"card-title mb-0 ms-3"},e.title)),l.a.createElement("p",{className:"card-text text-muted"},e.description))))))),l.a.createElement("div",{className:"row mt-4"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},"Quick Actions"),l.a.createElement("div",{className:"row g-2"},l.a.createElement("div",{className:"col-6 col-md-3"},l.a.createElement(c.b,{to:"/appointments/new",className:"btn btn-outline-primary w-100"},l.a.createElement("i",{className:"fas fa-plus-circle me-2"}),"New Appointment")),l.a.createElement("div",{className:"col-6 col-md-3"},l.a.createElement(c.b,{to:"/medications/add",className:"btn btn-outline-success w-100"},l.a.createElement("i",{className:"fas fa-pills me-2"}),"Add Medication")),l.a.createElement("div",{className:"col-6 col-md-3"},l.a.createElement(c.b,{to:"/reports/upload",className:"btn btn-outline-info w-100"},l.a.createElement("i",{className:"fas fa-upload me-2"}),"Upload Report")),l.a.createElement("div",{className:"col-6 col-md-3"},l.a.createElement(c.b,{to:"/ai/health-assistant",className:"btn btn-outline-danger w-100"},l.a.createElement("i",{className:"fas fa-robot me-2"}),"AI Assistant"))))))))},A=t(73),C=t(78),k=t(74),O=t(35),I=t(77),j=t(75),T=t(76);const D={actionButton:{display:"inline-block",opacity:1,visibility:"visible"}};var F=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)({first_name:"",last_name:"",email:""}),[i,o]=Object(n.useState)(!1),[m,d]=Object(n.useState)({disease_id:"",since:"",file:null}),[u,p]=Object(n.useState)(null),[E,h]=Object(n.useState)(null),[g,b]=Object(n.useState)(null),[y,N]=Object(n.useState)(!1),[v,w]=Object(n.useState)([]),[S,x]=Object(n.useState)([]),[F,R]=Object(n.useState)({}),[q,L]=Object(n.useState)(!1),[P,M]=Object(n.useState)(null);Object(n.useEffect)(()=>{(async()=>{N(!0);const{data:{user:e},error:a}=await f.auth.getUser();a||(e&&(r(e.id),Y(e.id),B(e.id),U(e.id),H(e.id)),N(!1))})()},[]);const U=async e=>{const{data:a,error:t}=await f.from("user_diseases").select("*").eq("user_id",e);t||w(a)},H=async e=>{const{data:a,error:t}=await f.from("user_parameters").select("*").eq("user_id",e);t||x(a)},B=async e=>{const{data:a,error:t}=await f.from("profiles").select("first_name, last_name, email").eq("id",e).single();t||c(a)},Y=async e=>{N(!0);try{const{data:t,error:n}=await f.from("healthrecords").select("\n          *,\n          user_diseases(disease_name)\n        ").eq("user_id",e);if(n)return console.error("Error fetching health data:",n),void $("Error loading health data: "+n.message,"danger");a(t)}catch(t){console.error("Exception fetching health data:",t),$("Error: "+t.message,"danger")}finally{N(!1)}},$=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;g&&clearTimeout(g),h({message:e,type:a});const n=setTimeout(()=>{h(null)},t);b(n)};Object(n.useEffect)(()=>()=>{g&&clearTimeout(g)},[g]);return l.a.createElement(A.a,{className:"py-4"},y&&l.a.createElement(_,null),E&&l.a.createElement("div",{className:`alert alert-${E.type} position-fixed d-flex justify-content-between align-items-center`,style:{top:"20px",right:"20px",zIndex:1050,minWidth:"300px",maxWidth:"500px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},role:"alert"},l.a.createElement("span",null,E.message),l.a.createElement("button",{type:"button",className:"btn-close ms-3",onClick:()=>h(null),"aria-label":"Close"})),l.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},l.a.createElement("h2",{className:"text-primary"},"Health Reports"),l.a.createElement(C.a,{variant:"primary",onClick:()=>o(!0)},"+ Upload Report")),l.a.createElement(k.a,null,e.map(e=>{var a;return l.a.createElement(O.a,{md:3,sm:6,key:e.id,className:"mb-3"},l.a.createElement(I.a,{className:"shadow-sm border-0"},l.a.createElement(I.a.Body,null,l.a.createElement(I.a.Title,null,"Disease: ",null===(a=e.user_diseases)||void 0===a?void 0:a.disease_name),l.a.createElement(I.a.Text,null,"Since: ",e.since),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement(C.a,{variant:"danger",size:"md",className:"m-2",style:D.actionButton,onClick:()=>{return a=e.id,M(a),void L(!0);var a}},"Delete"),l.a.createElement(C.a,{variant:"info",size:"md",className:"m-2",style:D.actionButton,onClick:()=>window.open(e.document_url,"_blank")},"View")))))})),l.a.createElement(j.a,{show:i,onHide:()=>o(!1),centered:!0},l.a.createElement(j.a.Header,{closeButton:!0},l.a.createElement(j.a.Title,null,"Upload New Report")),l.a.createElement(j.a.Body,null,l.a.createElement(T.a,{onSubmit:async e=>{e.preventDefault(),N(!0);try{var a,n,l,r,s,c;if(!m.file)throw new Error("Please select a file to upload");if(!m.disease_id)throw new Error("Please select a disease");if(!m.since)throw new Error("Please select a date");const e=m.file.name.split(".").pop(),i=`${t}/${Date.now()}.${e}`;console.log("Uploading file to Supabase storage:",i);const{data:u,error:E}=await f.storage.from("health-reports").upload(i,m.file);if(E)throw console.error("Supabase storage upload error:",E),new Error("Error uploading file: "+E.message);const{data:{publicUrl:h}}=f.storage.from("health-reports").getPublicUrl(i);console.log("File uploaded successfully, public URL:",h);const g={user_id:t,disease_id:m.disease_id,since:m.since,document_url:h,created_at:(new Date).toISOString(),ai_summary:(null===F||void 0===F||null===(a=F.aiAnalysis)||void 0===a?void 0:a.summary)||null};console.log("Inserting report data:",g);const{data:b,error:y}=await f.from("healthrecords").insert([g]).select().single();if(y)throw console.error("Error inserting report data:",y),new Error("Error saving report: "+y.message);if(console.log("Report inserted successfully:",b),!b||!b.id)throw new Error("Failed to get report ID from database");let v=!1,w=[];if((null===F||void 0===F?void 0:F.parameters)&&Object.keys(F.parameters).length>0){const e=Object.entries(F.parameters).map(e=>{let[a,n]=e;return{user_id:t,record_id:b.id,parameter_name:a,parameter_value:"object"===typeof n?JSON.stringify(n):String(n||"N/A"),created_at:(new Date).toISOString()}});console.log("Saving parameters:",e.length);const{error:a}=await f.from("health_parameters").insert(e);a&&(console.error("Error saving parameters:",a),v=!0,w.push("Parameters: "+a.message))}else console.log("No parameters to save");if((null===F||void 0===F||null===(n=F.aiAnalysis)||void 0===n||null===(l=n.conditions)||void 0===l?void 0:l.length)>0){const e=F.aiAnalysis.conditions.filter(e=>e&&e.trim()).map(e=>({record_id:b.id,condition_name:e.trim(),user_id:t,created_at:(new Date).toISOString()}));console.log("Saving conditions:",e.length);const{error:a}=await f.from("report_conditions").insert(e);a&&(console.error("Error saving conditions:",a),v=!0,w.push("Conditions: "+a.message))}else console.log("No conditions to save");if((null===F||void 0===F||null===(r=F.aiAnalysis)||void 0===r||null===(s=r.medications)||void 0===s?void 0:s.length)>0){const e=F.aiAnalysis.medications.filter(e=>e&&e.trim()).map(e=>({record_id:b.id,medication_name:e.trim(),user_id:t,created_at:(new Date).toISOString()}));console.log("Saving medications:",e.length);const{error:a}=await f.from("report_medications").insert(e);a&&(console.error("Error saving medications:",a),v=!0,w.push("Medications: "+a.message))}else console.log("No medications to save");if(null===F||void 0===F||null===(c=F.aiAnalysis)||void 0===c?void 0:c.recommendations){console.log("Saving recommendations");const{error:e}=await f.from("report_recommendations").insert([{record_id:b.id,recommendation_text:F.aiAnalysis.recommendations,user_id:t,created_at:(new Date).toISOString()}]);e&&(console.error("Error saving recommendations:",e),v=!0,w.push("Recommendations: "+e.message))}else console.log("No recommendations to save");await Y(t),o(!1),d({disease_id:"",since:"",file:null}),p(null),R({}),v?$("Report uploaded but some data couldn't be saved: "+w.join(", "),"warning"):$("Report uploaded successfully!","success")}catch(i){console.error("Error uploading report:",i),$("Error uploading report: "+i.message,"danger")}finally{N(!1)}}},l.a.createElement(T.a.Group,{className:"mb-3"},l.a.createElement(T.a.Label,null,"Select Disease"),l.a.createElement(T.a.Select,{value:m.disease_id,onChange:e=>d({...m,disease_id:e.target.value}),required:!0},l.a.createElement("option",{value:""},"Select a disease"),v.map(e=>l.a.createElement("option",{key:e.id,value:e.id},e.disease_name)))),l.a.createElement(T.a.Group,{className:"mb-3"},l.a.createElement(T.a.Label,null,"Since"),l.a.createElement(T.a.Control,{type:"date",value:m.since,onChange:e=>d({...m,since:e.target.value}),required:!0})),l.a.createElement(T.a.Group,{className:"mb-3"},l.a.createElement(T.a.Label,null,"Upload File"),l.a.createElement(T.a.Control,{type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:async e=>{const a=e.target.files[0];if(a){d({...m,file:a}),N(!0);try{var t,n,l,r,s,c,i,o;if(a.type.startsWith("image/"))return $("Image processing is temporarily unavailable. Please use PDF files for now.","warning"),void N(!1);p(null);const m=new FormData;m.append("file",a);try{const e=await fetch("https://digihealth-backend.onrender.com/api/check-env");if(e.ok){const a=await e.json();if(console.log("Backend environment status:",a),a.environment&&"not set"===a.environment.OPENAI_API_KEY)return $("The AI service is currently unavailable. File upload will proceed without AI analysis.","warning",1e4),R({parameters:{},aiAnalysis:{conditions:[],medications:[],recommendations:"AI analysis unavailable. Please review the document manually.",summary:"This document was uploaded but could not be analyzed by AI due to service unavailability."}}),void N(!1)}else console.warn("Backend environment check failed",await e.text())}catch(b){console.error("Error checking backend environment:",b)}console.log("Sending file to backend:",a.name,a.type,a.size);const d=await fetch("https://digihealth-backend.onrender.com/api/process-file",{method:"POST",body:m});if(!d.ok){let a,t="Error processing file";try{if(a=await d.json(),console.error("Backend error response:",a),t=a.error||t,a.details&&(a.details.includes("API key")||a.details.includes("authentication")||a.details.includes("401")))return $("The AI service is temporarily unavailable. Your file will be uploaded but not analyzed.","warning",1e4),R({parameters:{},aiAnalysis:{conditions:[],medications:[],recommendations:"AI analysis unavailable. Please review the document manually.",summary:"This document was uploaded but could not be analyzed by AI due to service unavailability."}}),void N(!1)}catch(e){console.error("Failed to parse error response",e)}throw new Error(t)}let f,v;try{var u,E,h,g;if(f=await d.json(),console.log("Backend response:",f),console.log("Response structure details:",{hasParameters:Boolean(f.parameters),parametersType:typeof f.parameters,parametersKeys:f.parameters?Object.keys(f.parameters):[],parametersValues:f.parameters?Object.values(f.parameters).map(e=>typeof e):[],hasAiAnalysis:Boolean(f.aiAnalysis),aiAnalysisType:typeof f.aiAnalysis,aiAnalysisKeys:f.aiAnalysis?Object.keys(f.aiAnalysis):[],conditionsType:(null===(u=f.aiAnalysis)||void 0===u?void 0:u.conditions)?typeof f.aiAnalysis.conditions:"undefined",isConditionsArray:!!(null===(E=f.aiAnalysis)||void 0===E?void 0:E.conditions)&&Array.isArray(f.aiAnalysis.conditions),medicationsType:(null===(h=f.aiAnalysis)||void 0===h?void 0:h.medications)?typeof f.aiAnalysis.medications:"undefined",isMedicationsArray:!!(null===(g=f.aiAnalysis)||void 0===g?void 0:g.medications)&&Array.isArray(f.aiAnalysis.medications)}),f&&f.parameters&&Object.keys(f.parameters).forEach(e=>{const a=f.parameters[e];f.parameters[e]=null===a||void 0===a?"N/A":"object"===typeof a?JSON.stringify(a):String(a)}),f&&f.aiAnalysis){if(!Array.isArray(f.aiAnalysis.conditions))if(console.warn("Conditions is not an array, converting:",f.aiAnalysis.conditions),"string"===typeof f.aiAnalysis.conditions)try{f.aiAnalysis.conditions=JSON.parse(f.aiAnalysis.conditions)}catch{f.aiAnalysis.conditions=[f.aiAnalysis.conditions]}else f.aiAnalysis.conditions&&"object"===typeof f.aiAnalysis.conditions?f.aiAnalysis.conditions=Object.values(f.aiAnalysis.conditions).map(String):f.aiAnalysis.conditions=[];if(!Array.isArray(f.aiAnalysis.medications))if(console.warn("Medications is not an array, converting:",f.aiAnalysis.medications),"string"===typeof f.aiAnalysis.medications)try{f.aiAnalysis.medications=JSON.parse(f.aiAnalysis.medications)}catch{f.aiAnalysis.medications=[f.aiAnalysis.medications]}else f.aiAnalysis.medications&&"object"===typeof f.aiAnalysis.medications?f.aiAnalysis.medications=Object.values(f.aiAnalysis.medications).map(String):f.aiAnalysis.medications=[];f.aiAnalysis.conditions=f.aiAnalysis.conditions.filter(e=>null!==e&&void 0!==e).map(e=>String(e)),f.aiAnalysis.medications=f.aiAnalysis.medications.filter(e=>null!==e&&void 0!==e).map(e=>String(e)),f.aiAnalysis.summary=String(f.aiAnalysis.summary||""),f.aiAnalysis.recommendations=String(f.aiAnalysis.recommendations||"")}else f&&(f.aiAnalysis={conditions:[],medications:[],recommendations:"",summary:""})}catch(y){throw console.error("Failed to parse response JSON:",y),new Error("Failed to parse server response. The file may be too large or in an unsupported format.")}if(!f||0===Object.keys(f).length)throw console.error("Empty response structure:",f),new Error("Server returned an empty response");if(!f.parameters&&!f.aiAnalysis)throw console.error("Invalid response structure:",f),new Error("Server returned an invalid response structure");R(f),v=f.parameters&&Object.keys(f.parameters).length>0?"File processed successfully. Review the extracted information below.":f.aiAnalysis&&(f.aiAnalysis.summary&&f.aiAnalysis.summary.length>0||f.aiAnalysis.conditions&&f.aiAnalysis.conditions.length>0||f.aiAnalysis.medications&&f.aiAnalysis.medications.length>0||f.aiAnalysis.recommendations&&f.aiAnalysis.recommendations.length>0)?"No specific parameters were extracted, but AI analysis is available.":"File processed, but limited information could be extracted. You can still upload it.",$(v,"success"),console.log("Backend response structure details:",{hasParameters:Boolean(f.parameters)&&Object.keys(f.parameters).length>0,parametersCount:f.parameters?Object.keys(f.parameters).length:0,hasAiAnalysis:Boolean(f.aiAnalysis),summaryLength:(null===(t=f.aiAnalysis)||void 0===t||null===(n=t.summary)||void 0===n?void 0:n.length)||0,conditionsLength:(null===(l=f.aiAnalysis)||void 0===l||null===(r=l.conditions)||void 0===r?void 0:r.length)||0,medicationsLength:(null===(s=f.aiAnalysis)||void 0===s||null===(c=s.medications)||void 0===c?void 0:c.length)||0,recommendationsLength:(null===(i=f.aiAnalysis)||void 0===i||null===(o=i.recommendations)||void 0===o?void 0:o.length)||0})}catch(f){console.error("Error processing file:",f),f.message.includes("API key")||f.message.includes("OpenAI")?($("AI service is unavailable. Your file will be uploaded without analysis.","warning"),R({parameters:{},aiAnalysis:{conditions:[],medications:[],recommendations:"AI analysis unavailable. Please review the document manually.",summary:"This document was uploaded but could not be analyzed by AI due to service unavailability."}})):($("Error processing file: "+f.message,"danger"),R({}))}finally{N(!1)}}},required:!0})),u&&l.a.createElement("img",{src:u,alt:"Preview",className:"img-fluid rounded mb-3"}),F&&(!F.parameters||0===Object.keys(F.parameters).length)&&(!F.aiAnalysis||0===Object.keys(F.aiAnalysis).length)&&l.a.createElement("div",{className:"alert alert-info mt-3"},l.a.createElement("i",{className:"bi bi-info-circle me-2"}),"No parameters or analysis could be extracted from this document. You can still upload it for record-keeping."),F.parameters&&Object.keys(F.parameters).length>0&&l.a.createElement("div",{className:"mb-3"},l.a.createElement("h5",null,"Extracted Parameters:"),l.a.createElement("ul",{className:"list-group"},Object.entries(F.parameters).map(e=>{let[a,t]=e;return l.a.createElement("li",{key:a,className:"list-group-item"},a,": ","object"===typeof t?JSON.stringify(t):String(t||"N/A"))}))),(null===F||void 0===F?void 0:F.aiAnalysis)?l.a.createElement("div",{className:"mb-3"},l.a.createElement("h5",null,"AI Analysis"),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},F.aiAnalysis.summary?l.a.createElement(l.a.Fragment,null,l.a.createElement("h6",null,"Summary"),l.a.createElement("p",null,String(F.aiAnalysis.summary))):l.a.createElement("p",{className:"text-muted"},"No summary available for this document."),F.aiAnalysis.conditions&&F.aiAnalysis.conditions.length>0&&l.a.createElement(l.a.Fragment,null,l.a.createElement("h6",{className:"mt-3"},"Conditions Identified"),l.a.createElement("ul",{className:"list-group"},F.aiAnalysis.conditions.map((e,a)=>l.a.createElement("li",{key:a,className:"list-group-item list-group-item-info"},String(e))))),F.aiAnalysis.medications&&F.aiAnalysis.medications.length>0&&l.a.createElement(l.a.Fragment,null,l.a.createElement("h6",{className:"mt-3"},"Medications"),l.a.createElement("ul",{className:"list-group"},F.aiAnalysis.medications.map((e,a)=>l.a.createElement("li",{key:a,className:"list-group-item list-group-item-warning"},String(e))))),F.aiAnalysis.recommendations&&l.a.createElement(l.a.Fragment,null,l.a.createElement("h6",{className:"mt-3"},"Recommendations"),l.a.createElement("p",null,String(F.aiAnalysis.recommendations)))))):null,l.a.createElement(C.a,{type:"submit",variant:"primary",disabled:y},y?"Uploading...":"Upload Report")))),l.a.createElement(j.a,{show:q,onHide:()=>L(!1),centered:!0},l.a.createElement(j.a.Header,{closeButton:!0},l.a.createElement(j.a.Title,null,"Confirm Delete")),l.a.createElement(j.a.Body,null,l.a.createElement("p",null,"Are you sure you want to delete this report?"),l.a.createElement("div",{className:"d-flex justify-content-end"},l.a.createElement(C.a,{variant:"secondary",onClick:()=>L(!1),className:"me-2"},"Cancel"),l.a.createElement(C.a,{variant:"danger",onClick:async()=>{N(!0);try{const{data:l,error:r}=await f.from("healthrecords").select("*").eq("id",P).single();if(r)throw console.error("Error fetching report:",r),new Error("Error fetching report: "+r.message);console.log("Report to delete:",l);try{const{error:e}=await f.from("health_parameters").delete().eq("record_id",P);e&&console.error("Error deleting health parameters:",e)}catch(n){console.error("Exception deleting health parameters:",n)}try{const{error:e}=await f.from("report_conditions").delete().eq("record_id",P);e&&console.error("Error deleting report conditions:",e)}catch(n){console.error("Exception deleting report conditions:",n)}try{const{error:e}=await f.from("report_medications").delete().eq("record_id",P);e&&console.error("Error deleting report medications:",e)}catch(n){console.error("Exception deleting report medications:",n)}try{const{error:e}=await f.from("report_recommendations").delete().eq("record_id",P);e&&console.error("Error deleting report recommendations:",e)}catch(n){console.error("Exception deleting report recommendations:",n)}try{const{error:e}=await f.from("report_ai_analysis").delete().eq("report_id",P);e&&console.error("Error deleting AI analysis:",e)}catch(n){console.error("Exception deleting AI analysis:",n)}if(l.document_url)try{const e=l.document_url.split("/").pop(),a=l.document_url.match(/health-reports\/([^\/]+)\/([^\/]+)$/);let n;if(a&&a.length>=3){const e=a[1];n=`${e}/${a[2]}`}else n=`${t}/${e}`;console.log("Attempting to delete file at path:",n);const{error:r}=await f.storage.from("health-reports").remove([n]);r?console.error("Error deleting file:",r):console.log("File deleted successfully")}catch(n){console.error("Exception during file deletion:",n)}const{error:s}=await f.from("healthrecords").delete().eq("id",P);if(s)throw console.error("Error deleting healthrecord:",s),new Error("Error deleting report: "+s.message);console.log("Report deleted successfully"),a(e.filter(e=>e.id!==P)),Y(t),$("Report deleted successfully","success")}catch(n){console.error("Error in delete process:",n),$("Error deleting report: "+n.message,"danger")}finally{N(!1),L(!1),M(null)}}},"Delete")))),l.a.createElement("div",{className:"mt-5 pt-5 border-top"},l.a.createElement("h5",null,"Troubleshooting"),l.a.createElement(C.a,{variant:"outline-secondary",size:"sm",onClick:async()=>{try{$("Testing with sample data...","info"),N(!0);const e=await fetch("https://digihealth-backend.onrender.com/api/test-response");if(!e.ok)throw new Error("Error fetching test data");const a=await e.json();console.log("Test response received:",a),R(a),$("Test data loaded successfully! You can view it in the modal.","success"),d({disease_id:v.length>0?v[0].id:"",since:(new Date).toISOString().split("T")[0],file:null}),o(!0)}catch(e){console.error("Error testing backend response:",e),$("Error: "+e.message,"danger")}finally{N(!1)}},className:"mt-2"},"Test Rendering"),l.a.createElement("small",{className:"d-block text-muted mt-2"},"Use this button to test rendering with sample data if you encounter issues.")))};var R=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(!1),[m,d]=Object(n.useState)({id:null,condition:"",diagnosis_date:"",doctor:"",treatment:"",notes:""});Object(n.useEffect)(()=>{u()},[]);const u=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await f.from("medical_history").select("*").eq("user_id",e.id).order("diagnosis_date",{ascending:!1});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching medical records:",e),c({message:"Error fetching medical records.",type:"danger"})}finally{r(!1)}},p=e=>{const{name:a,value:t}=e.target;d(e=>({...e,[a]:t}))},E=()=>{o(!1),d({id:null,condition:"",diagnosis_date:"",doctor:"",treatment:"",notes:""})};return t&&0===e.length?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.y,{className:"me-2"})," Medical History"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Medical Record":"Add New Medical Record"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await f.from("medical_history").update({condition:m.condition,diagnosis_date:m.diagnosis_date,doctor:m.doctor,treatment:m.treatment,notes:m.notes}).eq("id",m.id);if(e)throw e;c({message:"Medical record updated successfully!",type:"success"})}else{const{error:a}=await f.from("medical_history").insert([{condition:m.condition,diagnosis_date:m.diagnosis_date,doctor:m.doctor,treatment:m.treatment,notes:m.notes,user_id:e.id}]);if(a)throw a;c({message:"Medical record added successfully!",type:"success"})}E(),u()}catch(a){console.error("Error saving medical record:",a),c({message:"Error saving medical record.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"condition",className:"form-label"},"Condition/Diagnosis"),l.a.createElement("input",{type:"text",className:"form-control",id:"condition",name:"condition",value:m.condition,onChange:p,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"diagnosis_date",className:"form-label"},"Diagnosis Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"diagnosis_date",name:"diagnosis_date",value:m.diagnosis_date,onChange:p,required:!0}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"doctor",className:"form-label"},"Doctor/Healthcare Provider"),l.a.createElement("input",{type:"text",className:"form-control",id:"doctor",name:"doctor",value:m.doctor,onChange:p})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"treatment",className:"form-label"},"Treatment"),l.a.createElement("input",{type:"text",className:"form-control",id:"treatment",name:"treatment",value:m.treatment,onChange:p}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:m.notes,onChange:p})),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.o,{className:"me-2"})," Update Record"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.K,{className:"me-2"})," Add Record")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:E},"Cancel")))),l.a.createElement("h2",{className:"text-center mb-3"},"Your Medical History"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No medical records found. Add your first record above."):l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Condition"),l.a.createElement("th",null,"Diagnosis Date"),l.a.createElement("th",null,"Doctor"),l.a.createElement("th",null,"Treatment"),l.a.createElement("th",null,"Actions"))),l.a.createElement("tbody",null,e.map(t=>l.a.createElement("tr",{key:t.id},l.a.createElement("td",null,t.condition),l.a.createElement("td",null,new Date(t.diagnosis_date).toLocaleDateString()),l.a.createElement("td",null,t.doctor),l.a.createElement("td",null,t.treatment),l.a.createElement("td",null,l.a.createElement("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>(e=>{o(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(v.o,null)),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this record?")){r(!0);try{const{error:n}=await f.from("medical_history").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Medical record deleted successfully!",type:"success"})}catch(n){console.error("Error deleting medical record:",n),c({message:"Error deleting medical record.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(v.W,null)))))))))};var q=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(!1),[m,d]=Object(n.useState)({id:null,disease_name:"",diagnosis_date:"",severity:"Mild",medications:"",symptoms:"",notes:""});Object(n.useEffect)(()=>{u()},[]);const u=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await f.from("chronic_diseases").select("*").eq("user_id",e.id).order("diagnosis_date",{ascending:!1});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching chronic diseases:",e),c({message:"Error fetching chronic diseases.",type:"danger"})}finally{r(!1)}},p=e=>{const{name:a,value:t}=e.target;d(e=>({...e,[a]:t}))},E=()=>{o(!1),d({id:null,disease_name:"",diagnosis_date:"",severity:"Mild",medications:"",symptoms:"",notes:""})},h=e=>{switch(e){case"Mild":return"bg-success";case"Moderate":return"bg-warning text-dark";case"Severe":return"bg-danger";default:return"bg-secondary"}};return t&&0===e.length?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.m,{className:"me-2"})," Chronic Disease Management"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Chronic Disease":"Add New Chronic Disease"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await f.from("chronic_diseases").update({disease_name:m.disease_name,diagnosis_date:m.diagnosis_date,severity:m.severity,medications:m.medications,symptoms:m.symptoms,notes:m.notes}).eq("id",m.id);if(e)throw e;c({message:"Chronic disease updated successfully!",type:"success"})}else{const{error:a}=await f.from("chronic_diseases").insert([{disease_name:m.disease_name,diagnosis_date:m.diagnosis_date,severity:m.severity,medications:m.medications,symptoms:m.symptoms,notes:m.notes,user_id:e.id}]);if(a)throw a;c({message:"Chronic disease added successfully!",type:"success"})}E(),u()}catch(a){console.error("Error saving chronic disease:",a),c({message:"Error saving chronic disease.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"disease_name",className:"form-label"},"Disease Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"disease_name",name:"disease_name",value:m.disease_name,onChange:p,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"diagnosis_date",className:"form-label"},"Diagnosis Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"diagnosis_date",name:"diagnosis_date",value:m.diagnosis_date,onChange:p,required:!0}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"severity",className:"form-label"},"Severity"),l.a.createElement("select",{className:"form-control",id:"severity",name:"severity",value:m.severity,onChange:p},l.a.createElement("option",{value:"Mild"},"Mild"),l.a.createElement("option",{value:"Moderate"},"Moderate"),l.a.createElement("option",{value:"Severe"},"Severe"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"medications",className:"form-label"},"Medications"),l.a.createElement("input",{type:"text",className:"form-control",id:"medications",name:"medications",value:m.medications,onChange:p,placeholder:"Separate multiple medications with commas"}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"symptoms",className:"form-label"},"Symptoms"),l.a.createElement("input",{type:"text",className:"form-control",id:"symptoms",name:"symptoms",value:m.symptoms,onChange:p,placeholder:"Separate multiple symptoms with commas"})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:m.notes,onChange:p})),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.o,{className:"me-2"})," Update Disease"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.K,{className:"me-2"})," Add Disease")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:E},"Cancel")))),l.a.createElement("h2",{className:"text-center mb-3"},"Your Chronic Diseases"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No chronic diseases found. Add your first record above."):l.a.createElement("div",{className:"row"},e.map(t=>l.a.createElement("div",{key:t.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow"},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},l.a.createElement("h5",{className:"mb-0"},t.disease_name),l.a.createElement("span",{className:"badge "+h(t.severity)},t.severity)),l.a.createElement("div",{className:"card-body"},l.a.createElement("p",null,l.a.createElement("strong",null,"Diagnosed:")," ",new Date(t.diagnosis_date).toLocaleDateString()),t.medications&&l.a.createElement("p",null,l.a.createElement("strong",null,"Medications:"),l.a.createElement("br",null),t.medications.split(",").map((e,a)=>l.a.createElement("span",{key:a,className:"badge bg-info text-dark me-1 mb-1"},e.trim()))),t.symptoms&&l.a.createElement("p",null,l.a.createElement("strong",null,"Symptoms:"),l.a.createElement("br",null),t.symptoms.split(",").map((e,a)=>l.a.createElement("span",{key:a,className:"badge bg-secondary me-1 mb-1"},e.trim()))),t.notes&&l.a.createElement("p",null,l.a.createElement("strong",null,"Notes:"),l.a.createElement("br",null),t.notes)),l.a.createElement("div",{className:"card-footer d-flex justify-content-between"},l.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{o(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(v.o,{className:"me-1"})," Edit"),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this chronic disease record?")){r(!0);try{const{error:n}=await f.from("chronic_diseases").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Chronic disease deleted successfully!",type:"success"})}catch(n){console.error("Error deleting chronic disease:",n),c({message:"Error deleting chronic disease.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(v.W,{className:"me-1"})," Delete")))))))};var L=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(!1),[m,d]=Object(n.useState)({id:null,vaccine_name:"",date_administered:"",administered_by:"",lot_number:"",next_dose_date:"",notes:""});Object(n.useEffect)(()=>{u()},[]);const u=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await f.from("vaccinations").select("*").eq("user_id",e.id).order("date_administered",{ascending:!1});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching vaccinations:",e),c({message:"Error fetching vaccinations.",type:"danger"})}finally{r(!1)}},p=e=>{const{name:a,value:t}=e.target;d(e=>({...e,[a]:t}))},E=()=>{o(!1),d({id:null,vaccine_name:"",date_administered:"",administered_by:"",lot_number:"",next_dose_date:"",notes:""})},h=e=>{if(!e)return!1;const a=new Date,t=new Date(e)-a,n=Math.ceil(t/864e5);return n>=0&&n<=30},g=e=>{if(!e)return!1;const a=new Date;return new Date(e)<a};return t&&0===e.length?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.Q,{className:"me-2"})," Vaccination History"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Vaccination Record":"Add New Vaccination"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await f.from("vaccinations").update({vaccine_name:m.vaccine_name,date_administered:m.date_administered,administered_by:m.administered_by,lot_number:m.lot_number,next_dose_date:m.next_dose_date,notes:m.notes}).eq("id",m.id);if(e)throw e;c({message:"Vaccination record updated successfully!",type:"success"})}else{const{error:a}=await f.from("vaccinations").insert([{vaccine_name:m.vaccine_name,date_administered:m.date_administered,administered_by:m.administered_by,lot_number:m.lot_number,next_dose_date:m.next_dose_date,notes:m.notes,user_id:e.id}]);if(a)throw a;c({message:"Vaccination record added successfully!",type:"success"})}E(),u()}catch(a){console.error("Error saving vaccination record:",a),c({message:"Error saving vaccination record.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"vaccine_name",className:"form-label"},"Vaccine Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"vaccine_name",name:"vaccine_name",value:m.vaccine_name,onChange:p,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"date_administered",className:"form-label"},"Date Administered"),l.a.createElement("input",{type:"date",className:"form-control",id:"date_administered",name:"date_administered",value:m.date_administered,onChange:p,required:!0}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"administered_by",className:"form-label"},"Administered By"),l.a.createElement("input",{type:"text",className:"form-control",id:"administered_by",name:"administered_by",value:m.administered_by,onChange:p})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"lot_number",className:"form-label"},"Lot Number"),l.a.createElement("input",{type:"text",className:"form-control",id:"lot_number",name:"lot_number",value:m.lot_number,onChange:p}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"next_dose_date",className:"form-label"},"Next Dose Date (if applicable)"),l.a.createElement("input",{type:"date",className:"form-control",id:"next_dose_date",name:"next_dose_date",value:m.next_dose_date,onChange:p})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:m.notes,onChange:p}))),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.o,{className:"me-2"})," Update Record"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.K,{className:"me-2"})," Add Record")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:E},"Cancel")))),e.some(e=>h(e.next_dose_date)||g(e.next_dose_date))&&l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-warning text-dark"},l.a.createElement("h3",{className:"mb-0"},l.a.createElement(v.e,{className:"me-2"})," Upcoming & Overdue Vaccinations")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Vaccine"),l.a.createElement("th",null,"Due Date"),l.a.createElement("th",null,"Status"))),l.a.createElement("tbody",null,e.filter(e=>h(e.next_dose_date)||g(e.next_dose_date)).map(e=>l.a.createElement("tr",{key:"upcoming-"+e.id},l.a.createElement("td",null,e.vaccine_name),l.a.createElement("td",null,new Date(e.next_dose_date).toLocaleDateString()),l.a.createElement("td",null,g(e.next_dose_date)?l.a.createElement("span",{className:"badge bg-danger"},"Overdue"):l.a.createElement("span",{className:"badge bg-warning text-dark"},"Due Soon"))))))))),l.a.createElement("h2",{className:"text-center mb-3"},"Your Vaccination History"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No vaccination records found. Add your first record above."):l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Vaccine"),l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Administered By"),l.a.createElement("th",null,"Lot Number"),l.a.createElement("th",null,"Next Dose"),l.a.createElement("th",null,"Actions"))),l.a.createElement("tbody",null,e.map(t=>l.a.createElement("tr",{key:t.id},l.a.createElement("td",null,t.vaccine_name),l.a.createElement("td",null,new Date(t.date_administered).toLocaleDateString()),l.a.createElement("td",null,t.administered_by),l.a.createElement("td",null,t.lot_number),l.a.createElement("td",null,t.next_dose_date?l.a.createElement(l.a.Fragment,null,new Date(t.next_dose_date).toLocaleDateString(),g(t.next_dose_date)&&l.a.createElement("span",{className:"badge bg-danger ms-2"},"Overdue"),h(t.next_dose_date)&&!g(t.next_dose_date)&&l.a.createElement("span",{className:"badge bg-warning text-dark ms-2"},"Due Soon")):"N/A"),l.a.createElement("td",null,l.a.createElement("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>(e=>{o(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(v.o,null)),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this vaccination record?")){r(!0);try{const{error:n}=await f.from("vaccinations").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Vaccination record deleted successfully!",type:"success"})}catch(n){console.error("Error deleting vaccination record:",n),c({message:"Error deleting vaccination record.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(v.W,null)))))))))};var P=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)({name:"",frequency:"",customFrequency:"",quantity:""}),[s,c]=Object(n.useState)(!0),[i,o]=Object(n.useState)(null);Object(n.useEffect)(()=>{(async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await f.from("medications").select("*").eq("user_id",e.id);if(n)throw n;a(t)}catch(e){console.error("Error fetching medications:",e)}finally{c(!1)}})()},[]),Object(n.useEffect)(()=>{"granted"!==Notification.permission&&Notification.requestPermission().then(e=>{"granted"!==e&&console.warn("Notification permission not granted")})},[]);const m=e=>{const{name:a,value:t}=e.target;r(e=>({...e,[a]:t}))};return s?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},i&&l.a.createElement("div",{className:`alert alert-${i.type} text-center`},i.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.J,{className:"me-2"})," Medication Tracker"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"name",className:"form-label"},"Medication Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"name",name:"name",value:t.name,onChange:m})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"quantity",className:"form-label"},"Quantity (number of tablets)"),l.a.createElement("input",{type:"number",className:"form-control",id:"quantity",name:"quantity",value:t.quantity,onChange:m}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"frequency",className:"form-label"},"Frequency"),l.a.createElement("select",{className:"form-control",id:"frequency",name:"frequency",value:t.frequency,onChange:m},l.a.createElement("option",{value:""},"Select frequency"),l.a.createElement("option",{value:"Once a day"},"Once a day"),l.a.createElement("option",{value:"Twice a day"},"Twice a day"),l.a.createElement("option",{value:"Three times a day"},"Three times a day"),l.a.createElement("option",{value:"Every 6 hours"},"Every 6 hours"),l.a.createElement("option",{value:"Every 8 hours"},"Every 8 hours"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"customFrequency",className:"form-label"},"Custom Frequency"),l.a.createElement("input",{type:"text",className:"form-control",id:"customFrequency",name:"customFrequency",placeholder:"e.g., Every 4 hours",value:t.customFrequency,onChange:m}))),l.a.createElement("button",{className:"btn btn-primary w-100",onClick:async()=>{c(!0);try{const{data:{user:n}}=await f.auth.getUser();if(!n)return void(window.location.href="/");const l=t.customFrequency||t.frequency,{data:s,error:i}=await f.from("medications").insert([{name:t.name,frequency:l,quantity:t.quantity,user_id:n.id,last_taken:(new Date).toISOString()}]).select();if(i)throw i;a([...e,...s]),r({name:"",frequency:"",customFrequency:"",quantity:""}),o({message:"Medication added successfully!",type:"success"}),new Notification("Medication added successfully!")}catch(n){console.error("Error adding medication:",n),o({message:"Error adding medication.",type:"danger"}),new Notification("Error adding medication.")}finally{c(!1)}}},l.a.createElement(v.K,{className:"me-2"})," Add Medication")),l.a.createElement("h2",{className:"text-center mb-3"},"Your Medications"),l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Frequency"),l.a.createElement("th",null,"Quantity"),l.a.createElement("th",null,"Action"))),l.a.createElement("tbody",null,e.map(t=>l.a.createElement("tr",{key:t.id},l.a.createElement("td",null,t.name),l.a.createElement("td",null,t.frequency),l.a.createElement("td",null,t.quantity),l.a.createElement("td",null,l.a.createElement("button",{className:"btn btn-danger btn-sm",onClick:()=>(async t=>{c(!0);try{const{error:n}=await f.from("medications").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),o({message:"Medication deleted successfully!",type:"success"}),new Notification("Medication deleted successfully!")}catch(n){console.error("Error deleting medication:",n),o({message:"Error deleting medication.",type:"danger"}),new Notification("Error deleting medication.")}finally{c(!1)}})(t.id)},l.a.createElement(v.W,null))))))))},M=t(16);S.f.register(S.e,S.k,S.m,S.j,S.r,S.s,S.h);var U=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)("weight"),[m,d]=Object(n.useState)("6months"),[u,p]=Object(n.useState)(null),[E,h]=Object(n.useState)(!1),[g,b]=Object(n.useState)({weight:"",heart_rate:"",blood_pressure_systolic:"",blood_pressure_diastolic:"",blood_sugar:"",oxygen_saturation:"",recorded_at:(new Date).toISOString().split("T")[0]});Object(n.useEffect)(()=>{y()},[]),Object(n.useEffect)(()=>{e.length>0&&w()},[e,i,m]);const y=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await f.from("health_metrics").select("*").eq("user_id",e.id).order("recorded_at",{ascending:!0});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching health data:",e),c({message:"Error fetching health data.",type:"danger"})}finally{r(!1)}},N=e=>{const{name:a,value:t}=e.target;b(e=>({...e,[a]:t}))},w=()=>{const a=new Date;let t=[...e];if("1month"===m){const n=new Date(a.setMonth(a.getMonth()-1));t=e.filter(e=>new Date(e.recorded_at)>=n)}else if("3months"===m){const n=new Date(a.setMonth(a.getMonth()-3));t=e.filter(e=>new Date(e.recorded_at)>=n)}else if("6months"===m){const n=new Date(a.setMonth(a.getMonth()-6));t=e.filter(e=>new Date(e.recorded_at)>=n)}else if("1year"===m){const n=new Date(a.setFullYear(a.getFullYear()-1));t=e.filter(e=>new Date(e.recorded_at)>=n)}const n=t.map(e=>new Date(e.recorded_at).toLocaleDateString()),l=t.map(e=>e[i]||0);let r="#4bc0c0",s="rgba(75, 192, 192, 0.2)";switch(i){case"weight":r="#4bc0c0",s="rgba(75, 192, 192, 0.2)";break;case"heart_rate":r="#ff6384",s="rgba(255, 99, 132, 0.2)";break;case"blood_pressure_systolic":case"blood_pressure_diastolic":r="#ff9f40",s="rgba(255, 159, 64, 0.2)";break;case"blood_sugar":r="#9966ff",s="rgba(153, 102, 255, 0.2)";break;case"oxygen_saturation":r="#36a2eb",s="rgba(54, 162, 235, 0.2)"}p({labels:n,datasets:[{label:S(i),data:l,borderColor:r,backgroundColor:s,tension:.1,fill:!0}]})},S=e=>{switch(e){case"weight":return"Weight (kg)";case"heart_rate":return"Heart Rate (bpm)";case"blood_pressure_systolic":return"Blood Pressure - Systolic (mmHg)";case"blood_pressure_diastolic":return"Blood Pressure - Diastolic (mmHg)";case"blood_sugar":return"Blood Sugar (mg/dL)";case"oxygen_saturation":return"Oxygen Saturation (%)";default:return e}},x=a=>{if(0===e.length)return"N/A";const t=[...e].sort((e,a)=>new Date(a.recorded_at)-new Date(e.recorded_at)),n=t[0][a];if(void 0===n||null===n)return"N/A";switch(a){case"weight":return n+" kg";case"heart_rate":return n+" bpm";case"blood_pressure_systolic":return`${n}/${t[0].blood_pressure_diastolic||"N/A"} mmHg`;case"blood_pressure_diastolic":return`${t[0].blood_pressure_systolic||"N/A"}/${n} mmHg`;case"blood_sugar":return n+" mg/dL";case"oxygen_saturation":return n+"%";default:return n}};return t&&0===e.length?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},l.a.createElement("h1",null,l.a.createElement(v.f,{className:"me-2"})," Health Analytics"),l.a.createElement("div",null,l.a.createElement("button",{className:"btn btn-primary me-2",onClick:()=>h(!E)},E?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.S,null)," Cancel"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.K,null)," Add New Metrics")),e.length>0&&l.a.createElement("button",{className:"btn btn-success",onClick:()=>{const a=e.map(e=>[new Date(e.recorded_at).toLocaleDateString(),e.weight||"",e.heart_rate||"",`${e.blood_pressure_systolic||""}/${e.blood_pressure_diastolic||""}`,e.blood_sugar||"",e.oxygen_saturation?e.oxygen_saturation+"%":""]),t=[["Date","Weight (kg)","Heart Rate (bpm)","Blood Pressure (mmHg)","Blood Sugar (mg/dL)","Oxygen Saturation (%)"].join(","),...a.map(e=>e.join(","))].join("\n"),n=new Blob([t],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(n),r=document.createElement("a");r.setAttribute("href",l),r.setAttribute("download",`health_metrics_${(new Date).toISOString().split("T")[0]}.csv`),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},"Export Data"))),E&&l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h3",{className:"mb-0"},"Add New Health Metrics")),l.a.createElement("div",{className:"card-body"},l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const a=Object.fromEntries(Object.entries(g).filter(e=>{let[a,t]=e;return""!==t}));a.user_id=e.id;const{error:t}=await f.from("health_metrics").insert([a]);if(t)throw t;c({message:"Health metrics added successfully!",type:"success"}),h(!1),b({weight:"",heart_rate:"",blood_pressure_systolic:"",blood_pressure_diastolic:"",blood_sugar:"",oxygen_saturation:"",recorded_at:(new Date).toISOString().split("T")[0]}),y()}catch(a){console.error("Error adding health metrics:",a),c({message:"Error adding health metrics.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"recorded_at",className:"form-label"},"Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"recorded_at",name:"recorded_at",value:g.recorded_at,onChange:N,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"weight",className:"form-label"},"Weight (kg)"),l.a.createElement("input",{type:"number",step:"0.1",className:"form-control",id:"weight",name:"weight",value:g.weight,onChange:N,placeholder:"e.g. 70.5"}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"heart_rate",className:"form-label"},"Heart Rate (bpm)"),l.a.createElement("input",{type:"number",className:"form-control",id:"heart_rate",name:"heart_rate",value:g.heart_rate,onChange:N,placeholder:"e.g. 72"})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"oxygen_saturation",className:"form-label"},"Oxygen Saturation (%)"),l.a.createElement("input",{type:"number",min:"0",max:"100",className:"form-control",id:"oxygen_saturation",name:"oxygen_saturation",value:g.oxygen_saturation,onChange:N,placeholder:"e.g. 98"}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"blood_pressure_systolic",className:"form-label"},"Blood Pressure - Systolic (mmHg)"),l.a.createElement("input",{type:"number",className:"form-control",id:"blood_pressure_systolic",name:"blood_pressure_systolic",value:g.blood_pressure_systolic,onChange:N,placeholder:"e.g. 120"})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"blood_pressure_diastolic",className:"form-label"},"Blood Pressure - Diastolic (mmHg)"),l.a.createElement("input",{type:"number",className:"form-control",id:"blood_pressure_diastolic",name:"blood_pressure_diastolic",value:g.blood_pressure_diastolic,onChange:N,placeholder:"e.g. 80"}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"blood_sugar",className:"form-label"},"Blood Sugar (mg/dL)"),l.a.createElement("input",{type:"number",className:"form-control",id:"blood_sugar",name:"blood_sugar",value:g.blood_sugar,onChange:N,placeholder:"e.g. 100"})),l.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:t},t?"Saving...":"Save Metrics")))),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No health data available. Please add health metrics to see analytics."):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"row mb-4"},l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card shadow h-100"},l.a.createElement("div",{className:"card-body text-center"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.db,{className:"me-2"})," Weight"),l.a.createElement("h2",{className:"card-text"},x("weight"))))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card shadow h-100"},l.a.createElement("div",{className:"card-body text-center"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.x,{className:"me-2"})," Heart Rate"),l.a.createElement("h2",{className:"card-text"},x("heart_rate"))))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card shadow h-100"},l.a.createElement("div",{className:"card-body text-center"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.T,{className:"me-2"})," Blood Pressure"),l.a.createElement("h2",{className:"card-text"},x("blood_pressure_systolic")))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"metricSelect",className:"form-label"},"Select Metric"),l.a.createElement("select",{id:"metricSelect",className:"form-select",value:i,onChange:e=>o(e.target.value)},l.a.createElement("option",{value:"weight"},"Weight"),l.a.createElement("option",{value:"heart_rate"},"Heart Rate"),l.a.createElement("option",{value:"blood_pressure_systolic"},"Blood Pressure (Systolic)"),l.a.createElement("option",{value:"blood_pressure_diastolic"},"Blood Pressure (Diastolic)"),l.a.createElement("option",{value:"blood_sugar"},"Blood Sugar"),l.a.createElement("option",{value:"oxygen_saturation"},"Oxygen Saturation"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"timeRangeSelect",className:"form-label"},"Time Range"),l.a.createElement("select",{id:"timeRangeSelect",className:"form-select",value:m,onChange:e=>d(e.target.value)},l.a.createElement("option",{value:"1month"},"Last Month"),l.a.createElement("option",{value:"3months"},"Last 3 Months"),l.a.createElement("option",{value:"6months"},"Last 6 Months"),l.a.createElement("option",{value:"1year"},"Last Year"),l.a.createElement("option",{value:"all"},"All Time")))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",{className:"mb-0"},(e=>{switch(e){case"weight":return l.a.createElement(v.db,null);case"heart_rate":return l.a.createElement(v.x,null);case"blood_pressure_systolic":case"blood_pressure_diastolic":case"blood_sugar":return l.a.createElement(v.T,null);case"oxygen_saturation":return l.a.createElement(v.F,null);default:return l.a.createElement(v.f,null)}})(i)," ",S(i)," Trend")),l.a.createElement("div",{className:"card-body"},u?l.a.createElement(M.b,{data:u,options:{responsive:!0,plugins:{legend:{position:"top"},tooltip:{mode:"index",intersect:!1}},scales:{y:{beginAtZero:!1}}}}):l.a.createElement("p",{className:"text-center"},"No data available for the selected metric and time range."))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",{className:"mb-0"},"Health Insights")),l.a.createElement("div",{className:"card-body"},l.a.createElement("p",null,"This dashboard provides a visual representation of your health metrics over time. Track your progress and identify trends to better manage your health."),l.a.createElement("p",null,"For personalized health advice, please consult with your healthcare provider.")))))};var H=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(!1),[m,d]=Object(n.useState)({id:null,doctor_name:"",specialty:"",date:"",time:"",location:"",notes:"",reminder_set:!1});Object(n.useEffect)(()=>{u()},[]);const u=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:l}=await f.from("appointments").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(l)throw l;a(n||[])}catch(e){console.error("Error fetching appointments:",e),c({message:"Error fetching appointments.",type:"danger"})}finally{r(!1)}},p=e=>{const{name:a,value:t,type:n,checked:l}=e.target;d(e=>({...e,[a]:"checkbox"===n?l:t}))},E=()=>{o(!1),d({id:null,doctor_name:"",specialty:"",date:"",time:"",location:"",notes:"",reminder_set:!1})},h=e=>e===(new Date).toISOString().split("T")[0],g=e=>{const a=new Date,t=new Date(e)-a,n=Math.ceil(t/864e5);return n>0&&n<=3};return t&&0===e.length?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.e,{className:"me-2"})," Upcoming Appointments"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Appointment":"Schedule New Appointment"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await f.from("appointments").update({doctor_name:m.doctor_name,specialty:m.specialty,date:m.date,time:m.time,location:m.location,notes:m.notes,reminder_set:m.reminder_set}).eq("id",m.id);if(e)throw e;c({message:"Appointment updated successfully!",type:"success"})}else{const{error:a}=await f.from("appointments").insert([{doctor_name:m.doctor_name,specialty:m.specialty,date:m.date,time:m.time,location:m.location,notes:m.notes,reminder_set:m.reminder_set,user_id:e.id}]);if(a)throw a;c({message:"Appointment added successfully!",type:"success"})}E(),u()}catch(a){console.error("Error saving appointment:",a),c({message:"Error saving appointment.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"doctor_name",className:"form-label"},"Doctor Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"doctor_name",name:"doctor_name",value:m.doctor_name,onChange:p,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"specialty",className:"form-label"},"Specialty"),l.a.createElement("input",{type:"text",className:"form-control",id:"specialty",name:"specialty",value:m.specialty,onChange:p}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"date",className:"form-label"},"Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"date",name:"date",value:m.date,onChange:p,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"time",className:"form-label"},"Time"),l.a.createElement("input",{type:"time",className:"form-control",id:"time",name:"time",value:m.time,onChange:p,required:!0}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"location",className:"form-label"},"Location"),l.a.createElement("input",{type:"text",className:"form-control",id:"location",name:"location",value:m.location,onChange:p,required:!0})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:m.notes,onChange:p})),l.a.createElement("div",{className:"mb-3 form-check"},l.a.createElement("input",{type:"checkbox",className:"form-check-input",id:"reminder_set",name:"reminder_set",checked:m.reminder_set,onChange:p}),l.a.createElement("label",{className:"form-check-label",htmlFor:"reminder_set"},"Set Reminder")),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.o,{className:"me-2"})," Update Appointment"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.K,{className:"me-2"})," Schedule Appointment")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:E},"Cancel")))),e.some(e=>h(e.date))&&l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h3",{className:"mb-0"},l.a.createElement(v.j,{className:"me-2"})," Today's Appointments")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},e.filter(e=>h(e.date)).map(e=>l.a.createElement("div",{key:"today-"+e.id,className:"col-md-6 mb-3"},l.a.createElement("div",{className:"card h-100 border-primary"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},e.doctor_name),l.a.createElement("h6",{className:"card-subtitle mb-2 text-muted"},e.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.j,{className:"me-2"})," ",e.time,l.a.createElement("br",null),l.a.createElement(v.G,{className:"me-2"})," ",e.location),e.notes&&l.a.createElement("p",{className:"card-text"},e.notes)))))))),l.a.createElement("h2",{className:"text-center mb-3"},"All Upcoming Appointments"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No upcoming appointments. Schedule your first appointment above."):l.a.createElement("div",{className:"row"},e.map(t=>l.a.createElement("div",{key:t.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow "+(h(t.date)?"border-primary":g(t.date)?"border-warning":"")},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},l.a.createElement("h5",{className:"mb-0"},l.a.createElement(v.ab,{className:"me-2"})," ",t.doctor_name),h(t.date)&&l.a.createElement("span",{className:"badge bg-primary"},"Today"),g(t.date)&&!h(t.date)&&l.a.createElement("span",{className:"badge bg-warning text-dark"},"Soon")),l.a.createElement("div",{className:"card-body"},t.specialty&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Specialty:")," ",t.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.e,{className:"me-2"})," ",new Date(t.date).toLocaleDateString()),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.j,{className:"me-2"})," ",t.time),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.G,{className:"me-2"})," ",t.location),t.notes&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Notes:"),l.a.createElement("br",null),t.notes),t.reminder_set&&l.a.createElement("p",{className:"card-text"},l.a.createElement("span",{className:"badge bg-info text-dark"},"Reminder Set"))),l.a.createElement("div",{className:"card-footer d-flex justify-content-between"},l.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{o(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(v.o,{className:"me-1"})," Edit"),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this appointment?")){r(!0);try{const{error:n}=await f.from("appointments").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Appointment deleted successfully!",type:"success"})}catch(n){console.error("Error deleting appointment:",n),c({message:"Error deleting appointment.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(v.W,{className:"me-1"})," Cancel")))))))};var B=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(""),[m,d]=Object(n.useState)(""),[u,p]=Object(n.useState)(""),[E,h]=Object(n.useState)("desc");Object(n.useEffect)(()=>{g()},[]);const g=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:l}=await f.from("appointments").select("*").eq("user_id",e.id).lt("date",t).order("date",{ascending:!1});if(l)throw l;a(n||[])}catch(e){console.error("Error fetching appointment history:",e),c({message:"Error fetching appointment history.",type:"danger"})}finally{r(!1)}},b=e.filter(e=>{const a=""===i||e.doctor_name.toLowerCase().includes(i.toLowerCase())||e.specialty&&e.specialty.toLowerCase().includes(i.toLowerCase())||e.location&&e.location.toLowerCase().includes(i.toLowerCase())||e.notes&&e.notes.toLowerCase().includes(i.toLowerCase()),t=""===m||e.date===m,n=""===u||e.doctor_name.toLowerCase().includes(u.toLowerCase());return a&&t&&n}).sort((e,a)=>{const t=new Date(e.date),n=new Date(a.date);return"desc"===E?n-t:t-n});return t&&0===e.length?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.y,{className:"me-2"})," Appointment History"),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row mb-3"},l.a.createElement("div",{className:"col-md-6 mb-2"},l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(v.N,null)),l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search appointments...",value:i,onChange:e=>{o(e.target.value)}}))),l.a.createElement("div",{className:"col-md-3 mb-2"},l.a.createElement("input",{type:"date",className:"form-control",placeholder:"Filter by date",value:m,onChange:e=>{d(e.target.value)}})),l.a.createElement("div",{className:"col-md-3 mb-2"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Filter by doctor",value:u,onChange:e=>{p(e.target.value)}}))),l.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-3"},l.a.createElement("button",{className:"btn btn-outline-secondary",onClick:()=>{h("desc"===E?"asc":"desc")}},"Sort by Date: ","desc"===E?"Newest First":"Oldest First"),l.a.createElement("button",{className:"btn btn-success",onClick:()=>{const e=b.map(e=>[e.doctor_name,e.specialty,new Date(e.date).toLocaleDateString(),e.time,e.location,e.notes]),a=[["Doctor","Specialty","Date","Time","Location","Notes"].join(","),...e.map(e=>e.map(e=>`"${e||""}"`).join(","))].join("\n"),t=new Blob([a],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(t),l=document.createElement("a");l.setAttribute("href",n),l.setAttribute("download",`appointment_history_${(new Date).toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)},disabled:0===b.length},l.a.createElement(v.t,{className:"me-2"})," Export to CSV")))),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No appointment history found."):0===b.length?l.a.createElement("div",{className:"alert alert-warning text-center"},"No appointments match your search criteria."):l.a.createElement("div",{className:"row"},b.map(e=>l.a.createElement("div",{key:e.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h5",{className:"mb-0"},l.a.createElement(v.ab,{className:"me-2"})," ",e.doctor_name)),l.a.createElement("div",{className:"card-body"},e.specialty&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Specialty:")," ",e.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.d,{className:"me-2"})," ",new Date(e.date).toLocaleDateString()),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.j,{className:"me-2"})," ",e.time),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.G,{className:"me-2"})," ",e.location),e.notes&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Notes:"),l.a.createElement("br",null),e.notes)))))))};var Y=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!0),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(!1),[m,d]=Object(n.useState)({id:null,doctor_name:"",specialty:"",date:"",time:"",consultation_type:"video",meeting_link:"",notes:"",reminder_set:!1});Object(n.useEffect)(()=>{u()},[]);const u=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const{data:t,error:n}=await f.from("telehealth_consultations").select("*").eq("user_id",e.id).order("date",{ascending:!0});if(n)throw n;a(t||[])}catch(e){console.error("Error fetching consultations:",e),c({message:"Error fetching consultations.",type:"danger"})}finally{r(!1)}},p=e=>{const{name:a,value:t,type:n,checked:l}=e.target;d(e=>({...e,[a]:"checkbox"===n?l:t}))},E=()=>{o(!1),d({id:null,doctor_name:"",specialty:"",date:"",time:"",consultation_type:"video",meeting_link:"",notes:"",reminder_set:!1})},h=e=>e===(new Date).toISOString().split("T")[0],g=e=>e<(new Date).toISOString().split("T")[0],b=e=>{const a=new Date,t=new Date(e)-a,n=Math.ceil(t/864e5);return n>0&&n<=3},y=e.filter(e=>!g(e.date)),N=e.filter(e=>g(e.date));return t&&0===e.length?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},s&&l.a.createElement("div",{className:`alert alert-${s.type} text-center`},s.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.cb,{className:"me-2"})," Telehealth Consultations"),l.a.createElement("div",{className:"card shadow-lg p-4 mb-4"},l.a.createElement("h3",null,i?"Edit Consultation":"Schedule New Consultation"),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),r(!0);try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");if(i){const{error:e}=await f.from("telehealth_consultations").update({doctor_name:m.doctor_name,specialty:m.specialty,date:m.date,time:m.time,consultation_type:m.consultation_type,meeting_link:m.meeting_link,notes:m.notes,reminder_set:m.reminder_set}).eq("id",m.id);if(e)throw e;c({message:"Consultation updated successfully!",type:"success"})}else{const{error:a}=await f.from("telehealth_consultations").insert([{doctor_name:m.doctor_name,specialty:m.specialty,date:m.date,time:m.time,consultation_type:m.consultation_type,meeting_link:m.meeting_link,notes:m.notes,reminder_set:m.reminder_set,user_id:e.id}]);if(a)throw a;c({message:"Consultation added successfully!",type:"success"})}E(),u()}catch(a){console.error("Error saving consultation:",a),c({message:"Error saving consultation.",type:"danger"})}finally{r(!1)}}},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"doctor_name",className:"form-label"},"Doctor Name"),l.a.createElement("input",{type:"text",className:"form-control",id:"doctor_name",name:"doctor_name",value:m.doctor_name,onChange:p,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"specialty",className:"form-label"},"Specialty"),l.a.createElement("input",{type:"text",className:"form-control",id:"specialty",name:"specialty",value:m.specialty,onChange:p}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"date",className:"form-label"},"Date"),l.a.createElement("input",{type:"date",className:"form-control",id:"date",name:"date",value:m.date,onChange:p,required:!0})),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"time",className:"form-label"},"Time"),l.a.createElement("input",{type:"time",className:"form-control",id:"time",name:"time",value:m.time,onChange:p,required:!0}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"consultation_type",className:"form-label"},"Consultation Type"),l.a.createElement("select",{className:"form-control",id:"consultation_type",name:"consultation_type",value:m.consultation_type,onChange:p,required:!0},l.a.createElement("option",{value:"video"},"Video Call"),l.a.createElement("option",{value:"phone"},"Phone Call"),l.a.createElement("option",{value:"chat"},"Chat"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"meeting_link",className:"form-label"},"Meeting Link/Phone Number"),l.a.createElement("input",{type:"text",className:"form-control",id:"meeting_link",name:"meeting_link",value:m.meeting_link,onChange:p,placeholder:"Enter meeting link or phone number"}))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"notes",className:"form-label"},"Notes"),l.a.createElement("textarea",{className:"form-control",id:"notes",name:"notes",rows:"3",value:m.notes,onChange:p,placeholder:"Reason for consultation, questions to ask, etc."})),l.a.createElement("div",{className:"mb-3 form-check"},l.a.createElement("input",{type:"checkbox",className:"form-check-input",id:"reminder_set",name:"reminder_set",checked:m.reminder_set,onChange:p}),l.a.createElement("label",{className:"form-check-label",htmlFor:"reminder_set"},"Set Reminder")),l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("button",{type:"submit",className:"btn btn-primary"},i?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.o,{className:"me-2"})," Update Consultation"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.K,{className:"me-2"})," Schedule Consultation")),i&&l.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:E},"Cancel")))),e.some(e=>h(e.date))&&l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h3",{className:"mb-0"},l.a.createElement(v.j,{className:"me-2"})," Today's Consultations")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},e.filter(e=>h(e.date)).map(e=>l.a.createElement("div",{key:"today-"+e.id,className:"col-md-6 mb-3"},l.a.createElement("div",{className:"card h-100 border-primary"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},e.doctor_name),l.a.createElement("h6",{className:"card-subtitle mb-2 text-muted"},e.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.j,{className:"me-2"})," ",e.time,l.a.createElement("br",null),"video"===e.consultation_type?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.cb,{className:"me-2"})," Video Call"):"phone"===e.consultation_type?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.I,{className:"me-2"})," Phone Call"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.D,{className:"me-2"})," Chat")),e.meeting_link&&l.a.createElement("p",{className:"card-text"},l.a.createElement("a",{href:"video"===e.consultation_type?e.meeting_link:"tel:"+e.meeting_link,target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm btn-success"},"video"===e.consultation_type?"Join Meeting":"Call Now")),e.notes&&l.a.createElement("p",{className:"card-text"},l.a.createElement("small",null,e.notes))))))))),l.a.createElement("h2",{className:"text-center mb-3"},"Upcoming Consultations"),0===y.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No upcoming consultations. Schedule your first consultation above."):l.a.createElement("div",{className:"row"},y.map(t=>l.a.createElement("div",{key:t.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow "+(h(t.date)?"border-primary":b(t.date)?"border-warning":"")},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},l.a.createElement("h5",{className:"mb-0"},l.a.createElement(v.ab,{className:"me-2"})," ",t.doctor_name),h(t.date)&&l.a.createElement("span",{className:"badge bg-primary"},"Today"),b(t.date)&&!h(t.date)&&l.a.createElement("span",{className:"badge bg-warning text-dark"},"Soon")),l.a.createElement("div",{className:"card-body"},t.specialty&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Specialty:")," ",t.specialty),l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Date:")," ",new Date(t.date).toLocaleDateString()),l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Time:")," ",t.time),l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Type:")," ","video"===t.consultation_type?"Video Call":"phone"===t.consultation_type?"Phone Call":"Chat"),t.meeting_link&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Link/Number:")," ",t.meeting_link),t.notes&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Notes:"),l.a.createElement("br",null),t.notes),t.reminder_set&&l.a.createElement("p",{className:"card-text"},l.a.createElement("span",{className:"badge bg-info text-dark"},"Reminder Set"))),l.a.createElement("div",{className:"card-footer d-flex justify-content-between"},l.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:()=>(e=>{o(!0),d(e),window.scrollTo({top:0,behavior:"smooth"})})(t)},l.a.createElement(v.o,{className:"me-1"})," Edit"),l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this consultation?")){r(!0);try{const{error:n}=await f.from("telehealth_consultations").delete().eq("id",t);if(n)throw n;a(e.filter(e=>e.id!==t)),c({message:"Consultation deleted successfully!",type:"success"})}catch(n){console.error("Error deleting consultation:",n),c({message:"Error deleting consultation.",type:"danger"})}finally{r(!1)}}})(t.id)},l.a.createElement(v.W,{className:"me-1"})," Cancel")))))),N.length>0&&l.a.createElement(l.a.Fragment,null,l.a.createElement("h2",{className:"text-center mb-3 mt-5"},"Past Consultations"),l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Doctor"),l.a.createElement("th",null,"Specialty"),l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Time"),l.a.createElement("th",null,"Type"),l.a.createElement("th",null,"Notes"))),l.a.createElement("tbody",null,N.map(e=>l.a.createElement("tr",{key:"past-"+e.id},l.a.createElement("td",null,e.doctor_name),l.a.createElement("td",null,e.specialty),l.a.createElement("td",null,new Date(e.date).toLocaleDateString()),l.a.createElement("td",null,e.time),l.a.createElement("td",null,"video"===e.consultation_type?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.cb,{className:"me-1"})," Video"):"phone"===e.consultation_type?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.I,{className:"me-1"})," Phone"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.D,{className:"me-1"})," Chat")),l.a.createElement("td",null,e.notes))))))))};var $=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)([]),[s,c]=Object(n.useState)(!0),[i,o]=Object(n.useState)(null),[m,d]=Object(n.useState)({email_reminders:!0,sms_reminders:!1,browser_notifications:!0,reminder_time:"24",phone_number:""});Object(n.useEffect)(()=>{u()},[]);const u=async()=>{try{c(!0);const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const t=(new Date).toISOString().split("T")[0],{data:n,error:l}=await f.from("appointments").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(l)throw l;const{data:s,error:i}=await f.from("telehealth_consultations").select("*").eq("user_id",e.id).gte("date",t).order("date",{ascending:!0});if(i)throw i;const o=[...(n||[]).map(e=>({...e,type:"appointment"})),...(s||[]).map(e=>({...e,type:"telehealth",doctor_name:e.doctor_name}))].sort((e,a)=>new Date(`${e.date}T${e.time}`)-new Date(`${a.date}T${a.time}`));a(o);const{data:m,error:u}=await f.from("reminder_settings").select("*").eq("user_id",e.id).single();if(u&&"PGRST116"!==u.code)throw u;m&&d(m);const{data:p,error:E}=await f.from("reminders").select("*").eq("user_id",e.id).gte("reminder_time",(new Date).toISOString()).order("reminder_time",{ascending:!0});if(E)throw E;r(p||[])}catch(e){console.error("Error fetching data:",e),o({message:"Error fetching data.",type:"danger"})}finally{c(!1)}},p=e=>{const{name:a,value:t,type:n,checked:l}=e.target;d(e=>({...e,[a]:"checkbox"===n?l:t}))},E=e=>e===(new Date).toISOString().split("T")[0],h=e=>{const a=new Date,t=new Date(e)-a,n=Math.ceil(t/864e5);return n>0&&n<=3};return s&&0===e.length&&0===t.length?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},i&&l.a.createElement("div",{className:`alert alert-${i.type} text-center`},i.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.a,{className:"me-2"})," Appointment Reminders"),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",{className:"mb-0"},"Reminder Settings")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("div",{className:"form-check form-switch"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"email_reminders",name:"email_reminders",checked:m.email_reminders,onChange:p}),l.a.createElement("label",{className:"form-check-label",htmlFor:"email_reminders"},"Email Reminders"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("div",{className:"form-check form-switch"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"browser_notifications",name:"browser_notifications",checked:m.browser_notifications,onChange:p}),l.a.createElement("label",{className:"form-check-label",htmlFor:"browser_notifications"},"Browser Notifications")))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("div",{className:"form-check form-switch"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"sms_reminders",name:"sms_reminders",checked:m.sms_reminders,onChange:p}),l.a.createElement("label",{className:"form-check-label",htmlFor:"sms_reminders"},"SMS Reminders"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"phone_number",className:"form-label"},"Phone Number (for SMS)"),l.a.createElement("input",{type:"tel",className:"form-control",id:"phone_number",name:"phone_number",value:m.phone_number,onChange:p,placeholder:"Enter your phone number",disabled:!m.sms_reminders}))),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"reminder_time",className:"form-label"},"Send Reminders"),l.a.createElement("select",{className:"form-select",id:"reminder_time",name:"reminder_time",value:m.reminder_time,onChange:p},l.a.createElement("option",{value:"1"},"1 hour before"),l.a.createElement("option",{value:"2"},"2 hours before"),l.a.createElement("option",{value:"6"},"6 hours before"),l.a.createElement("option",{value:"12"},"12 hours before"),l.a.createElement("option",{value:"24"},"24 hours before"),l.a.createElement("option",{value:"48"},"2 days before"),l.a.createElement("option",{value:"72"},"3 days before"))),l.a.createElement("div",{className:"col-md-6 mb-3 d-flex align-items-end"},l.a.createElement("button",{className:"btn btn-primary w-100",onClick:async()=>{try{c(!0);const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const{error:a}=await f.from("reminder_settings").upsert({...m,user_id:e.id});if(a)throw a;o({message:"Reminder settings saved successfully!",type:"success"})}catch(e){console.error("Error saving reminder settings:",e),o({message:"Error saving reminder settings.",type:"danger"})}finally{c(!1)}},disabled:s},"Save Settings"))))),l.a.createElement("h2",{className:"text-center mb-3"},"Active Reminders"),0===t.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No active reminders. Set reminders for your appointments below."):l.a.createElement("div",{className:"table-responsive mb-4"},l.a.createElement("table",{className:"table table-striped"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Appointment"),l.a.createElement("th",null,"Doctor"),l.a.createElement("th",null,"Appointment Time"),l.a.createElement("th",null,"Reminder Time"),l.a.createElement("th",null,"Actions"))),l.a.createElement("tbody",null,t.map(e=>l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,"telehealth"===e.appointment_type?"Telehealth":"In-person"),l.a.createElement("td",null,e.doctor_name),l.a.createElement("td",null,new Date(e.appointment_time).toLocaleString()),l.a.createElement("td",null,new Date(e.reminder_time).toLocaleString()),l.a.createElement("td",null,l.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this reminder?"))try{c(!0);const{data:a,error:t}=await f.from("reminders").select("*").eq("id",e).single();if(t)throw t;if("appointment"===a.appointment_type){const{error:e}=await f.from("appointments").update({reminder_set:!1}).eq("id",a.appointment_id);if(e)throw e}else{const{error:e}=await f.from("telehealth_consultations").update({reminder_set:!1}).eq("id",a.appointment_id);if(e)throw e}const{error:n}=await f.from("reminders").delete().eq("id",e);if(n)throw n;o({message:"Reminder deleted successfully!",type:"success"}),u()}catch(a){console.error("Error deleting reminder:",a),o({message:"Error deleting reminder.",type:"danger"})}finally{c(!1)}})(e.id)},l.a.createElement(v.W,null)))))))),l.a.createElement("h2",{className:"text-center mb-3"},"Upcoming Appointments"),0===e.length?l.a.createElement("div",{className:"alert alert-info text-center"},"No upcoming appointments found. Schedule appointments to set reminders."):l.a.createElement("div",{className:"row"},e.map(e=>l.a.createElement("div",{key:e.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100 shadow "+(E(e.date)?"border-primary":h(e.date)?"border-warning":"")},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},l.a.createElement("h5",{className:"mb-0"},l.a.createElement(v.ab,{className:"me-2"})," ",e.doctor_name),E(e.date)&&l.a.createElement("span",{className:"badge bg-primary"},"Today"),h(e.date)&&!E(e.date)&&l.a.createElement("span",{className:"badge bg-warning text-dark"},"Soon")),l.a.createElement("div",{className:"card-body"},l.a.createElement("p",{className:"card-text"},l.a.createElement(v.d,{className:"me-2"})," ",new Date(e.date).toLocaleDateString()),l.a.createElement("p",{className:"card-text"},l.a.createElement(v.j,{className:"me-2"})," ",e.time),l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Type:")," ","telehealth"===e.type?"Telehealth Consultation":"In-person Appointment"),e.location&&l.a.createElement("p",{className:"card-text"},l.a.createElement("strong",null,"Location:")," ",e.location)),l.a.createElement("div",{className:"card-footer"},l.a.createElement("button",{className:"btn btn-block w-100",onClick:()=>(async e=>{try{c(!0);const{data:{user:a}}=await f.auth.getUser();if(!a)return void(window.location.href="/");if(e.reminder_set){if("appointment"===e.type){const{error:a}=await f.from("appointments").update({reminder_set:!1}).eq("id",e.id);if(a)throw a}else{const{error:a}=await f.from("telehealth_consultations").update({reminder_set:!1}).eq("id",e.id);if(a)throw a}const{error:a}=await f.from("reminders").delete().eq("appointment_id",e.id).eq("appointment_type",e.type);if(a)throw a;o({message:"Reminder removed successfully!",type:"success"})}else{const t=new Date(`${e.date}T${e.time}`),n=parseInt(m.reminder_time,10),l=new Date(t.getTime()-60*n*60*1e3);if("appointment"===e.type){const{error:a}=await f.from("appointments").update({reminder_set:!0}).eq("id",e.id);if(a)throw a}else{const{error:a}=await f.from("telehealth_consultations").update({reminder_set:!0}).eq("id",e.id);if(a)throw a}const{error:r}=await f.from("reminders").insert([{user_id:a.id,appointment_id:e.id,appointment_type:e.type,reminder_time:l.toISOString(),appointment_time:t.toISOString(),doctor_name:e.doctor_name,location:e.location||"",sent:!1}]);if(r)throw r;o({message:"Reminder set successfully!",type:"success"})}u()}catch(a){console.error("Error toggling reminder:",a),o({message:"Error toggling reminder.",type:"danger"})}finally{c(!1)}})(e),disabled:s},e.reminder_set?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.V,{className:"me-2"})," Reminder On"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.U,{className:"me-2"})," Set Reminder"))))))))};var z=()=>{const[e,a]=Object(n.useState)(""),[t,r]=Object(n.useState)("all"),[s,c]=Object(n.useState)({}),[i,o]=Object(n.useState)([]),[m,d]=Object(n.useState)([]),[u,p]=Object(n.useState)(!0),[E,h]=Object(n.useState)(null),[g,b]=Object(n.useState)([]);Object(n.useEffect)(()=>{y()},[]);const y=async()=>{try{p(!0);const{data:e,error:a}=await f.from("faqs").select("*").order("id");if(a)throw a;const{data:t,error:n}=await f.from("tutorials").select("*").order("id");if(n)throw n;o(e||[]),d(t||[]);const l=[...new Set(e.map(e=>e.category))],r=[...new Set(t.map(e=>e.category))],s=[...new Set([...l,...r])];b(s)}catch(e){console.error("Error fetching help center data:",e),h({message:"Error loading help center content.",type:"danger"}),o(N),d(w),b([...new Set([...N.map(e=>e.category),...w.map(e=>e.category)])])}finally{p(!1)}},N=[{id:1,category:"account",question:"How do I create an account?",answer:'To create an account, click on the "Sign Up" button on the login page. Fill in your personal details, including your email address and a secure password. Follow the verification steps sent to your email to complete the registration process.'},{id:2,category:"account",question:"How do I reset my password?",answer:'If you forgot your password, click on the "Forgot Password" link on the login page. Enter your registered email address, and we will send you a password reset link. Follow the instructions in the email to create a new password.'},{id:3,category:"appointments",question:"How do I schedule an appointment?",answer:'To schedule an appointment, navigate to the "Appointments" section in the navigation menu and select "Upcoming Appointments". Click on the "Schedule New Appointment" button and fill in the required details such as doctor name, date, time, and location. Click "Schedule Appointment" to confirm.'},{id:4,category:"appointments",question:"How do I cancel or reschedule an appointment?",answer:'To cancel or reschedule an appointment, go to the "Upcoming Appointments" page. Find the appointment you want to modify, then click the "Edit" button to change the date or time, or click the "Cancel" button to cancel the appointment entirely.'},{id:5,category:"medical",question:"How do I add my medical history?",answer:'To add your medical history, navigate to the "Medical History" page from the "Your Journey" menu. Click on "Add New Medical Record" and fill in the details about your condition, diagnosis date, doctor, and treatment. Click "Add Record" to save the information.'},{id:6,category:"medical",question:"How do I track my medications?",answer:'To track your medications, go to the "Medication Tracker" page from the "Your Journey" menu. Enter the medication name, frequency, and quantity, then click "Add Medication". You can view and manage all your medications from this page.'},{id:7,category:"telehealth",question:"How do I join a telehealth consultation?",answer:'To join a telehealth consultation, go to the "Telehealth Consultations" page. On the day of your appointment, you will see your consultation listed under "Today\'s Consultations". Click the "Join Meeting" button at the scheduled time to enter the virtual consultation room.'},{id:8,category:"telehealth",question:"What equipment do I need for a telehealth consultation?",answer:"For a telehealth consultation, you need a device with a camera and microphone (smartphone, tablet, or computer), a stable internet connection, and a quiet, private space. Make sure your device is charged and your browser allows camera and microphone access."},{id:9,category:"data",question:"Is my health data secure?",answer:"Yes, your health data is secure. We use industry-standard encryption and security measures to protect your personal and medical information. Our platform complies with healthcare privacy regulations, and your data is only accessible to you and the healthcare providers you authorize."},{id:10,category:"data",question:"How do I export my health data?",answer:'To export your health data, go to the "Data Backup & Export" page under the "Account" menu. Select the type of data you want to export and the format (PDF, CSV, etc.). Click "Export Data" and follow the prompts to download your information.'}],w=[{id:1,category:"getting-started",title:"Getting Started with DigiHealth",type:"video",description:"Learn the basics of navigating the DigiHealth platform and setting up your profile.",link:"#"},{id:2,category:"appointments",title:"How to Schedule and Manage Appointments",type:"guide",description:"A step-by-step guide to scheduling, rescheduling, and canceling appointments.",link:"#"},{id:3,category:"medical",title:"Managing Your Medical Records",type:"video",description:"Learn how to add, edit, and organize your medical history and records.",link:"#"},{id:4,category:"telehealth",title:"Preparing for Your First Telehealth Consultation",type:"guide",description:"Tips and instructions for a successful virtual healthcare appointment.",link:"#"},{id:5,category:"data",title:"Understanding Your Health Analytics",type:"video",description:"How to interpret and use the health analytics features to monitor your well-being.",link:"#"},{id:6,category:"account",title:"Account Security Best Practices",type:"guide",description:"Learn how to keep your DigiHealth account secure with strong passwords and two-factor authentication.",link:"#"}],S=i.filter(a=>{const n=""===e||a.question.toLowerCase().includes(e.toLowerCase())||a.answer.toLowerCase().includes(e.toLowerCase()),l="all"===t||a.category===t;return n&&l}),x=m.filter(a=>{const n=""===e||a.title.toLowerCase().includes(e.toLowerCase())||a.description.toLowerCase().includes(e.toLowerCase()),l="all"===t||a.category===t;return n&&l});return u?l.a.createElement(_,null):l.a.createElement("div",{className:"container mt-4"},E&&l.a.createElement("div",{className:`alert alert-${E.type} text-center`},E.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.b,{className:"me-2"})," Help Center"),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-8 mb-3"},l.a.createElement("div",{className:"input-group"},l.a.createElement("span",{className:"input-group-text"},l.a.createElement(v.N,null)),l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Search for help topics...",value:e,onChange:e=>a(e.target.value)}))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("select",{className:"form-select",value:t,onChange:e=>r(e.target.value)},l.a.createElement("option",{value:"all"},"All Categories"),g.map((e,a)=>l.a.createElement("option",{key:a,value:e},e.charAt(0).toUpperCase()+e.slice(1).replace("-"," ")))))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h2",{className:"mb-0"},l.a.createElement(v.L,{className:"me-2"})," Frequently Asked Questions")),l.a.createElement("div",{className:"card-body"},0===S.length?l.a.createElement("div",{className:"alert alert-info"},"No FAQs match your search criteria. Try a different search term or category."):l.a.createElement("div",{className:"accordion"},S.map(e=>l.a.createElement("div",{key:e.id,className:"card mb-2"},l.a.createElement("div",{className:"card-header d-flex justify-content-between align-items-center",onClick:()=>{var a;a=e.id,c(e=>({...e,[a]:!e[a]})),(async e=>{try{s[e]||await f.from("faq_analytics").insert([{faq_id:e,viewed_at:(new Date).toISOString()}])}catch(a){console.error("Error tracking FAQ view:",a)}})(e.id)},style:{cursor:"pointer"}},l.a.createElement("h5",{className:"mb-0"},e.question),s[e.id]?l.a.createElement(v.i,null):l.a.createElement(v.h,null)),s[e.id]&&l.a.createElement("div",{className:"card-body"},l.a.createElement("p",null,e.answer))))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-success text-white"},l.a.createElement("h2",{className:"mb-0"},l.a.createElement(v.cb,{className:"me-2"})," Tutorials & Guides")),l.a.createElement("div",{className:"card-body"},0===x.length?l.a.createElement("div",{className:"alert alert-info"},"No tutorials match your search criteria. Try a different search term or category."):l.a.createElement("div",{className:"row"},x.map(e=>l.a.createElement("div",{key:e.id,className:"col-md-6 col-lg-4 mb-4"},l.a.createElement("div",{className:"card h-100"},l.a.createElement("div",{className:"card-header"},"video"===e.type?l.a.createElement(v.cb,{className:"me-2 text-danger"}):l.a.createElement(v.s,{className:"me-2 text-primary"}),l.a.createElement("span",{className:"badge bg-secondary"},e.category.replace("-"," "))),l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},e.title),l.a.createElement("p",{className:"card-text"},e.description)),l.a.createElement("div",{className:"card-footer"},l.a.createElement("a",{href:e.link,className:"btn btn-primary btn-sm w-100",onClick:()=>(async e=>{try{await f.from("tutorial_analytics").insert([{tutorial_id:e,clicked_at:(new Date).toISOString()}])}catch(a){console.error("Error tracking tutorial click:",a)}})(e.id),target:"_blank",rel:"noopener noreferrer"},"video"===e.type?"Watch Video":"Read Guide")))))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-info text-white"},l.a.createElement("h2",{className:"mb-0"},"Need More Help?")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card h-100 text-center"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h3",null,"Contact Support"),l.a.createElement("p",null,"Reach out to our support team for personalized assistance."),l.a.createElement("a",{href:"/contact-support",className:"btn btn-primary"},"Contact Support")))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card h-100 text-center"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h3",null,"Live Chat"),l.a.createElement("p",null,"Chat with our support agents in real-time for immediate help."),l.a.createElement("a",{href:"/live-chat",className:"btn btn-primary"},"Start Chat")))),l.a.createElement("div",{className:"col-md-4 mb-3"},l.a.createElement("div",{className:"card h-100 text-center"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h3",null,"Email Support"),l.a.createElement("p",null,"Send us an email and we'll get back to you within 24 hours."),l.a.createElement("a",{href:"mailto:support@digihealth.com",className:"btn btn-primary"},"Email Us"))))))))};var W=()=>{const[e,a]=Object(n.useState)(!1),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)({subject:"",category:"general",priority:"medium",message:"",attachFile:null}),[m,d]=Object(n.useState)([]);Object(n.useEffect)(()=>{u()},[]),Object(n.useEffect)(()=>{if(i.subject.length>3||i.message.length>10){const e=`${i.subject} ${i.message}`.toLowerCase(),a=[{question:"How do I reset my password?",answer:'Click on "Forgot Password" on the login page and follow the instructions sent to your email.',keywords:["password","reset","forgot","login","sign in","cannot access"]},{question:"How do I schedule an appointment?",answer:'Go to "Upcoming Appointments" and click "Schedule New Appointment".',keywords:["schedule","appointment","book","doctor","visit","consultation"]},{question:"How do I update my profile information?",answer:'Navigate to "Profile Settings" under the Account menu to edit your personal details.',keywords:["profile","update","change","information","details","personal"]},{question:"How do I export my health data?",answer:'Go to "Data Backup & Export" under the Account menu to download your information.',keywords:["export","download","data","backup","information","records"]},{question:"How do I join a telehealth consultation?",answer:'On the day of your appointment, go to "Telehealth Consultations" and click "Join Meeting".',keywords:["telehealth","virtual","video","call","consultation","join","meeting"]}].filter(a=>a.keywords.some(a=>e.includes(a)));d(a.slice(0,3))}else d([])},[i.subject,i.message]);const u=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");const{data:a,error:t}=await f.from("detailed_profiles").select("*").eq("id",e.id).single();if(t)throw t;c(a)}catch(e){console.error("Error fetching user profile:",e),r({message:"Error fetching user profile.",type:"danger"})}},p=e=>{const{name:a,value:t}=e.target;o(e=>({...e,[a]:t}))};return l.a.createElement("div",{className:"container mt-4"},t&&l.a.createElement("div",{className:`alert alert-${t.type} text-center`},t.message),l.a.createElement("h1",{className:"text-center mb-4"},l.a.createElement(v.B,{className:"me-2"})," Contact Support"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-8"},l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h2",{className:"mb-0"},"Submit a Support Request")),l.a.createElement("div",{className:"card-body"},m.length>0&&l.a.createElement("div",{className:"alert alert-info mb-4"},l.a.createElement("h5",null,l.a.createElement(v.C,{className:"me-2"})," Did you know?"),l.a.createElement("p",null,"We found some help articles that might answer your question:"),l.a.createElement("ul",{className:"mb-0"},m.map((e,a)=>l.a.createElement("li",{key:a},l.a.createElement("strong",null,e.question)," - ",e.answer)))),l.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),a(!0);try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void(window.location.href="/");let t=null;if(i.attachFile){const a=`${e.id}-${Date.now()}-${i.attachFile.name}`,{data:n,error:l}=await f.storage.from("support-attachments").upload(a,i.attachFile);if(l)throw l;const{data:r}=f.storage.from("support-attachments").getPublicUrl(a);t=r.publicUrl}const{error:n}=await f.from("support_tickets").insert([{user_id:e.id,subject:i.subject,category:i.category,priority:i.priority,message:i.message,attachment_url:t,status:"open",created_at:(new Date).toISOString()}]);if(n)throw n;r({message:"Support ticket submitted successfully! Our team will respond shortly.",type:"success"}),o({subject:"",category:"general",priority:"medium",message:"",attachFile:null}),document.getElementById("attachFile").value=""}catch(t){console.error("Error submitting support ticket:",t),r({message:"Error submitting support ticket. Please try again.",type:"danger"})}finally{a(!1)}}},l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"subject",className:"form-label"},"Subject"),l.a.createElement("input",{type:"text",className:"form-control",id:"subject",name:"subject",value:i.subject,onChange:p,required:!0,placeholder:"Brief description of your issue"})),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"category",className:"form-label"},"Category"),l.a.createElement("select",{className:"form-select",id:"category",name:"category",value:i.category,onChange:p},l.a.createElement("option",{value:"general"},"General Question"),l.a.createElement("option",{value:"account"},"Account Issues"),l.a.createElement("option",{value:"appointments"},"Appointments"),l.a.createElement("option",{value:"medical"},"Medical Records"),l.a.createElement("option",{value:"telehealth"},"Telehealth"),l.a.createElement("option",{value:"technical"},"Technical Problem"),l.a.createElement("option",{value:"billing"},"Billing & Payments"))),l.a.createElement("div",{className:"col-md-6 mb-3"},l.a.createElement("label",{htmlFor:"priority",className:"form-label"},"Priority"),l.a.createElement("select",{className:"form-select",id:"priority",name:"priority",value:i.priority,onChange:p},l.a.createElement("option",{value:"low"},"Low - General Question"),l.a.createElement("option",{value:"medium"},"Medium - Need Help Soon"),l.a.createElement("option",{value:"high"},"High - Urgent Issue")))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"message",className:"form-label"},"Message"),l.a.createElement("textarea",{className:"form-control",id:"message",name:"message",rows:"6",value:i.message,onChange:p,required:!0,placeholder:"Please describe your issue in detail. Include any error messages or steps to reproduce the problem."})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"attachFile",className:"form-label"},"Attach File (optional)"),l.a.createElement("input",{type:"file",className:"form-control",id:"attachFile",onChange:e=>{o(a=>({...a,attachFile:e.target.files[0]}))}}),l.a.createElement("div",{className:"form-text"},"You can attach screenshots or documents to help explain your issue (max 5MB).")),l.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:e},e?l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Submitting..."):"Submit Support Request"))))),l.a.createElement("div",{className:"col-lg-4"},l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-info text-white"},l.a.createElement("h3",{className:"mb-0"},"Contact Information")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement(v.p,{className:"me-3 fs-4 text-primary"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"Email Support"),l.a.createElement("p",{className:"mb-0"},"support@digihealth.com"),l.a.createElement("small",{className:"text-muted"},"Response within 24 hours"))),l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement(v.I,{className:"me-3 fs-4 text-primary"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"Phone Support"),l.a.createElement("p",{className:"mb-0"},"1-800-DIGI-HEALTH"),l.a.createElement("small",{className:"text-muted"},"Mon-Fri, 9am-5pm EST"))),l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement(v.k,{className:"me-3 fs-4 text-primary"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"Live Chat"),l.a.createElement("p",{className:"mb-0"},l.a.createElement("a",{href:"/live-chat",className:"btn btn-sm btn-outline-primary mt-1"},"Start Chat")),l.a.createElement("small",{className:"text-muted"},"Available 24/7"))))),l.a.createElement("div",{className:"card shadow mb-4"},l.a.createElement("div",{className:"card-header bg-success text-white"},l.a.createElement("h3",{className:"mb-0"},"Support Resources")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex align-items-center mb-3"},l.a.createElement(v.L,{className:"me-3 fs-4 text-success"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"Help Center"),l.a.createElement("p",{className:"mb-0"},l.a.createElement("a",{href:"/help-center",className:"btn btn-sm btn-outline-success mt-1"},"Browse FAQs")))),l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement(v.q,{className:"me-3 fs-4 text-warning"}),l.a.createElement("div",null,l.a.createElement("h5",{className:"mb-0"},"System Status"),l.a.createElement("p",{className:"mb-0"},l.a.createElement("span",{className:"badge bg-success"},"All Systems Operational")))))))))};var G=()=>{const{user:e}=u(),[a,t]=Object(n.useState)([]),[r,s]=Object(n.useState)(""),[c,i]=Object(n.useState)(!1),[o,m]=Object(n.useState)(!1),[d,p]=Object(n.useState)("connecting"),[E,h]=Object(n.useState)(null),[g,b]=Object(n.useState)(null),y=Object(n.useRef)(null);Object(n.useEffect)(()=>(N(),()=>{g&&g.unsubscribe()}),[e,g]),Object(n.useEffect)(()=>{w()},[a]);const N=async()=>{try{const{data:a,error:n}=await f.from("chat_sessions").select("*").eq("user_id",e.id).eq("status","active").single();if(n&&"PGRST116"!==n.code)throw n;let l;if(a)l=a.id;else{const{data:a,error:t}=await f.from("chat_sessions").insert([{user_id:e.id,status:"active",created_at:(new Date).toISOString()}]).select().single();if(t)throw t;l=a.id}const{data:r,error:s}=await f.from("chat_messages").select("*").eq("session_id",l).order("created_at",{ascending:!0});if(s)throw s;t(r||[]);const c=f.channel("chat_messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:"session_id=eq."+l},e=>{t(a=>[...a,e.new])}).subscribe();b(c);const{data:i,error:o}=await f.from("support_agents").select("*").eq("status","online").single();if(o&&"PGRST116"!==o.code)throw o;i?(h(i),p("connected")):p("waiting")}catch(a){console.error("Error initializing chat:",a),p("error")}},w=()=>{y.current&&y.current.scrollIntoView({behavior:"smooth"})};return l.a.createElement("div",{className:"container-fluid h-100"},l.a.createElement("div",{className:"row h-100"},l.a.createElement("div",{className:"col-md-3 p-0 border-end"},l.a.createElement("div",{className:"p-3 border-bottom"},l.a.createElement("h5",{className:"mb-0"},"Chat Information"),l.a.createElement("small",{className:"text-muted"},"Status: ",l.a.createElement("span",{className:"text-"+("connected"===d?"success":"warning")},d.charAt(0).toUpperCase()+d.slice(1)))),E&&l.a.createElement("div",{className:"p-3"},l.a.createElement("h6",{className:"mb-2"},"Support Agent"),l.a.createElement("div",{className:"d-flex align-items-center"},l.a.createElement("div",{className:"avatar-circle me-2"},E.name.charAt(0)),l.a.createElement("div",null,l.a.createElement("div",{className:"fw-bold"},E.name),l.a.createElement("small",{className:"text-muted"},E.role))))),l.a.createElement("div",{className:"col-md-9 p-0 d-flex flex-column"},l.a.createElement("div",{className:"flex-grow-1 p-3 overflow-auto",style:{height:"calc(100vh - 200px)"}},a.map((a,t)=>l.a.createElement("div",{key:t,className:`d-flex ${a.user_id===e.id?"justify-content-end":"justify-content-start"} mb-3`},l.a.createElement("div",{className:"chat-message "+(a.user_id===e.id?"bg-primary text-white":"bg-light")},"text"===a.type?l.a.createElement("p",{className:"mb-0"},a.message):"image"===a.type?l.a.createElement("img",{src:"https://aqdzmfhakqdwquszaqle.supabase.co/storage/v1/object/public/chat-attachments/"+a.attachment_url,alt:"Shared image",className:"img-fluid rounded",style:{maxWidth:"200px"}}):l.a.createElement("a",{href:"https://aqdzmfhakqdwquszaqle.supabase.co/storage/v1/object/public/chat-attachments/"+a.attachment_url,target:"_blank",rel:"noopener noreferrer",className:"text-decoration-none"},l.a.createElement(v.r,{className:"me-2"}),a.message)))),l.a.createElement("div",{ref:y})),l.a.createElement("div",{className:"p-3 border-top"},l.a.createElement("form",{onSubmit:async a=>{if(a.preventDefault(),r.trim())try{const{data:a}=await f.from("chat_sessions").select("id").eq("user_id",e.id).eq("status","active").single();if(!a)throw new Error("No active chat session");const{error:t}=await f.from("chat_messages").insert([{session_id:a.id,user_id:e.id,message:r.trim(),type:"text",created_at:(new Date).toISOString()}]);if(t)throw t;s("")}catch(t){console.error("Error sending message:",t)}},className:"d-flex gap-2"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Type your message...",value:r,onChange:e=>s(e.target.value),onFocus:()=>i(!0),onBlur:()=>i(!1)}),l.a.createElement("label",{className:"btn btn-outline-primary"},l.a.createElement("input",{type:"file",className:"d-none",onChange:async a=>{const t=a.target.files[0];if(t)try{const a=t.name.split(".").pop(),n=`${Math.random()}.${a}`,l=`${e.id}/${n}`,{error:r}=await f.storage.from("chat-attachments").upload(l,t);if(r)throw r;const{data:s}=await f.from("chat_sessions").select("id").eq("user_id",e.id).eq("status","active").single();if(!s)throw new Error("No active chat session");const{error:c}=await f.from("chat_messages").insert([{session_id:s.id,user_id:e.id,message:t.name,type:t.type.startsWith("image/")?"image":"file",attachment_url:l,created_at:(new Date).toISOString()}]);if(c)throw c}catch(n){console.error("Error uploading file:",n)}},accept:"image/*,.pdf,.doc,.docx"}),l.a.createElement(v.r,null)),l.a.createElement("button",{type:"submit",className:"btn btn-primary"},l.a.createElement(v.H,null)))))))};t(66);var J=()=>{const[e,a]=Object(n.useState)({first_name:null,last_name:null,email:null,date_of_birth:null,gender:null,blood_group:null,height:"",weight:"",allergies:[],medical_conditions:[],emergency_contact_name:null,emergency_contact_phone:null,emergency_contact_relationship:null,phone:null,address:null,bio:"",profile_picture:null}),[t,r]=Object(n.useState)([]),[s,c]=Object(n.useState)(""),[i,o]=Object(n.useState)([]),[m,d]=Object(n.useState)({name:"",value:"",unit:""}),[u,p]=Object(n.useState)(!0),[h,g]=Object(n.useState)(!1),[b,y]=Object(n.useState)("profile"),[N,v]=Object(n.useState)(!1),[w,S]=Object(n.useState)(""),[x,A]=Object(n.useState)([]),[C,k]=Object(n.useState)({name:"",severity:"mild"}),[O,I]=Object(n.useState)([]),[j,T]=Object(n.useState)(!0);Object(n.useEffect)(()=>{D()},[]),Object(n.useEffect)(()=>{"diseases"===b?(F(),R(),q()):"parameters"===b&&L()},[b]);const D=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)throw new Error("No user logged in");const{data:t,error:n}=await f.from("detailed_profiles").select("*").eq("id",e.id).single();if(n){if("PGRST116"!==n.code)throw n;{const{data:t,error:n}=await f.from("detailed_profiles").insert([{id:e.id}]).select().single();if(n)throw n;a(t||{})}}else a(t||{})}catch(e){E.b.error("Error fetching profile: "+e.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{p(!1)}},F=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await f.from("user_diseases").select("*").eq("user_id",e.id);if(t)throw t;r(a||[])}catch(e){console.error("Error fetching diseases:",e)}},R=async()=>{try{const{data:e,error:a}=await f.from("common_diseases").select("*");if(a)throw a;I(e||[])}catch(e){console.error("Error fetching common diseases:",e)}},q=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await f.from("user_allergies").select("*").eq("user_id",e.id);if(t)throw t;A(a||[])}catch(e){console.error("Error fetching allergies:",e)}},L=async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await f.from("user_parameters").select("*").eq("user_id",e.id).order("date_recorded",{ascending:!1});if(t)throw t;o(a||[])}catch(e){console.error("Error fetching parameters:",e)}},P=e=>{const{name:t,value:n}=e.target;a(e=>({...e,[t]:n}))};return u?l.a.createElement(_,null):l.a.createElement("div",{className:"profile-page container-fluid"},w&&l.a.createElement("div",{className:"alert alert-info alert-dismissible fade show",role:"alert"},w,l.a.createElement("button",{type:"button",className:"btn-close",onClick:()=>S("")})),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-3 col-md-4"},l.a.createElement("div",{className:"profile-sidebar card mb-3"},l.a.createElement("div",{className:"d-lg-none"},l.a.createElement("button",{className:"btn btn-link w-100 text-start",onClick:()=>T(!j)},l.a.createElement("i",{className:"fas fa-bars me-2"}),"Menu")),l.a.createElement("div",{className:"card-body "+(j?"":"d-none d-lg-block")},l.a.createElement("div",{className:"profile-picture-container mb-3"},l.a.createElement("img",{src:e.profile_picture||"/default-profile.png",alt:"Profile",className:"profile-picture img-fluid rounded-circle mb-2"}),h&&l.a.createElement("div",{className:"mt-2"},l.a.createElement("input",{type:"file",onChange:async e=>{try{v(!0);const t=e.target.files[0];if(!t)return;const{data:{user:n}}=await f.auth.getUser();if(!n)throw new Error("No user logged in");const l=t.name.split(".").pop(),r=`${n.id}/${Math.random()}.${l}`,{error:s}=await f.storage.from("profile-pictures").upload(r,t);if(s)throw s;const{data:{publicUrl:c}}=f.storage.from("profile-pictures").getPublicUrl(r);a(e=>({...e,profile_picture:c}));const{error:i}=await f.from("detailed_profiles").update({profile_picture:c}).eq("id",n.id);if(i)throw i;E.b.success("Profile picture updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(t){E.b.error("Error uploading image: "+t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{v(!1)}},className:"form-control form-control-sm"})),N&&l.a.createElement(_,null)),l.a.createElement("h3",{className:"mb-0"},e.first_name," ",e.last_name),l.a.createElement("p",{className:"text-muted"},e.email),l.a.createElement("button",{onClick:()=>g(!h),className:`btn ${h?"btn-secondary":"btn-primary"} w-100`},h?"Cancel Editing":"Edit Profile")),l.a.createElement("div",{className:"list-group list-group-flush"},l.a.createElement("button",{className:"list-group-item list-group-item-action "+("profile"===b?"active":""),onClick:()=>y("profile")},l.a.createElement("i",{className:"fas fa-user me-2"})," Basic Information"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("medical"===b?"active":""),onClick:()=>y("medical")},l.a.createElement("i",{className:"fas fa-heartbeat me-2"})," Medical Information"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("emergency"===b?"active":""),onClick:()=>y("emergency")},l.a.createElement("i",{className:"fas fa-phone-alt me-2"})," Emergency Contacts"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("diseases"===b?"active":""),onClick:()=>y("diseases")},l.a.createElement("i",{className:"fas fa-notes-medical me-2"})," Diseases & Conditions"),l.a.createElement("button",{className:"list-group-item list-group-item-action "+("parameters"===b?"active":""),onClick:()=>y("parameters")},l.a.createElement("i",{className:"fas fa-chart-line me-2"})," Health Parameters")))),l.a.createElement("div",{className:"col-lg-9 col-md-8"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},"profile"===b&&l.a.createElement("div",{className:"profile-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Basic Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"First Name:"),h?l.a.createElement("input",{type:"text",name:"first_name",value:e.first_name,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.first_name))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Last Name:"),h?l.a.createElement("input",{type:"text",name:"last_name",value:e.last_name,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.last_name))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Email:"),h?l.a.createElement("input",{type:"email",name:"email",value:e.email,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.email))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Phone:"),h?l.a.createElement("input",{type:"tel",name:"phone",value:e.phone,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.phone))),l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Address:"),h?l.a.createElement("input",{type:"text",name:"address",value:e.address,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.address))),l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Bio:"),h?l.a.createElement("textarea",{name:"bio",value:e.bio,onChange:P,className:"form-control",rows:"3"}):l.a.createElement("p",{className:"form-control-plaintext"},e.bio))))),"medical"===b&&l.a.createElement("div",{className:"medical-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Medical Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Date of Birth:"),h?l.a.createElement("input",{type:"date",name:"date_of_birth",value:e.date_of_birth,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.date_of_birth))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Gender:"),h?l.a.createElement("select",{name:"gender",value:e.gender,onChange:P,className:"form-control"},l.a.createElement("option",{value:""},"Select Gender"),l.a.createElement("option",{value:"male"},"Male"),l.a.createElement("option",{value:"female"},"Female"),l.a.createElement("option",{value:"other"},"Other")):l.a.createElement("p",{className:"form-control-plaintext"},e.gender))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Blood Group:"),h?l.a.createElement("select",{name:"blood_group",value:e.blood_group,onChange:P,className:"form-control"},l.a.createElement("option",{value:""},"Select Blood Group"),l.a.createElement("option",{value:"A+"},"A+"),l.a.createElement("option",{value:"A-"},"A-"),l.a.createElement("option",{value:"B+"},"B+"),l.a.createElement("option",{value:"B-"},"B-"),l.a.createElement("option",{value:"AB+"},"AB+"),l.a.createElement("option",{value:"AB-"},"AB-"),l.a.createElement("option",{value:"O+"},"O+"),l.a.createElement("option",{value:"O-"},"O-")):l.a.createElement("p",{className:"form-control-plaintext"},e.blood_group))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Height (cm):"),h?l.a.createElement("input",{type:"number",name:"height",value:e.height,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.height))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Weight (kg):"),h?l.a.createElement("input",{type:"number",name:"weight",value:e.weight,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.weight))))),"emergency"===b&&l.a.createElement("div",{className:"emergency-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Emergency Contact Information"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Emergency Contact Name:"),h?l.a.createElement("input",{type:"text",name:"emergency_contact_name",value:e.emergency_contact_name,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.emergency_contact_name))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Emergency Contact Phone:"),h?l.a.createElement("input",{type:"tel",name:"emergency_contact_phone",value:e.emergency_contact_phone,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.emergency_contact_phone))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"profile-field"},l.a.createElement("label",null,"Relationship:"),h?l.a.createElement("input",{type:"text",name:"emergency_contact_relationship",value:e.emergency_contact_relationship,onChange:P,className:"form-control"}):l.a.createElement("p",{className:"form-control-plaintext"},e.emergency_contact_relationship))))),"diseases"===b&&l.a.createElement("div",{className:"diseases-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Diseases & Medical Conditions"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"disease-list mb-4"},t.map(e=>l.a.createElement("span",{key:e.id,className:"badge bg-info me-2 mb-2 p-2"},e.disease_name))),h&&l.a.createElement("div",{className:"input-group mb-3"},l.a.createElement("select",{className:"form-select",value:s,onChange:e=>c(e.target.value)},l.a.createElement("option",{value:""},"Select a disease"),O.map(e=>l.a.createElement("option",{key:e.id,value:e.name},e.name))),l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Or enter a new disease",value:""===s?"":s,onChange:e=>c(e.target.value)}),l.a.createElement("button",{onClick:async()=>{if(s.trim())try{p(!0);const{data:{user:e}}=await f.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:n}=await f.from("user_diseases").select("*").eq("user_id",e.id).eq("disease_name",s).single();if(n&&"PGRST116"!==n.code)throw n;if(a)E.b.info("This disease is already in your list",{position:"top-right",autoClose:3e3});else{const{data:a,error:n}=await f.from("user_diseases").insert([{user_id:e.id,disease_name:s,date_diagnosed:(new Date).toISOString()}]).select();if(n)throw n;r([...t,...a]),E.b.success("Disease added successfully!",{position:"top-right",autoClose:3e3})}c("")}catch(e){console.error("Error adding disease:",e),E.b.error("Error adding disease: "+e.message,{position:"top-right",autoClose:5e3})}finally{p(!1)}},className:"btn btn-primary"},"Add")))),l.a.createElement("h5",{className:"card-title mb-3 mt-4"},"Allergies"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"allergy-list mb-4"},x.map(e=>l.a.createElement("span",{key:e.id,className:"badge bg-warning text-dark me-2 mb-2 p-2"},e.allergy_name," (",e.severity,")"))),h&&l.a.createElement("div",{className:"row g-2"},l.a.createElement("div",{className:"col-sm-6"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Allergy name",value:C.name,onChange:e=>k({...C,name:e.target.value})})),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("select",{className:"form-select",value:C.severity,onChange:e=>k({...C,severity:e.target.value})},l.a.createElement("option",{value:"mild"},"Mild"),l.a.createElement("option",{value:"moderate"},"Moderate"),l.a.createElement("option",{value:"severe"},"Severe"))),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("button",{onClick:async()=>{if(C.name.trim())try{p(!0);const{data:{user:e}}=await f.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await f.from("user_allergies").select("*").eq("user_id",e.id).eq("allergy_name",C.name).single();if(t&&"PGRST116"!==t.code)throw t;if(a)E.b.info("This allergy is already in your list",{position:"top-right",autoClose:3e3});else{const{data:a,error:t}=await f.from("user_allergies").insert([{user_id:e.id,allergy_name:C.name,severity:C.severity}]).select();if(t)throw t;A([...x,...a]),E.b.success("Allergy added successfully!",{position:"top-right",autoClose:3e3})}k({name:"",severity:"mild"})}catch(e){console.error("Error adding allergy:",e),E.b.error("Error adding allergy: "+e.message,{position:"top-right",autoClose:5e3})}finally{p(!1)}else E.b.warning("Please enter an allergy name",{position:"top-right",autoClose:3e3})},className:"btn btn-primary w-100"},"Add")))))),"parameters"===b&&l.a.createElement("div",{className:"parameters-section"},l.a.createElement("h4",{className:"card-title mb-4"},"Health Parameters"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("div",{className:"parameter-list mb-4"},i.map(e=>l.a.createElement("div",{key:e.id,className:"badge bg-success me-2 mb-2 p-2"},e.parameter_name,": ",e.value," ",e.unit))),h&&l.a.createElement("div",{className:"row g-2"},l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Parameter name",value:m.name,onChange:e=>d({...m,name:e.target.value})})),l.a.createElement("div",{className:"col-sm-4"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Value",value:m.value,onChange:e=>d({...m,value:e.target.value})})),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("input",{type:"text",className:"form-control",placeholder:"Unit",value:m.unit,onChange:e=>d({...m,unit:e.target.value})})),l.a.createElement("div",{className:"col-sm-2"},l.a.createElement("button",{onClick:async()=>{if(m.name.trim()&&m.value.trim())try{p(!0);const{data:{user:e}}=await f.auth.getUser();if(!e)throw new Error("No user logged in");const{data:a,error:t}=await f.from("user_parameters").insert([{user_id:e.id,parameter_name:m.name,value:m.value,unit:m.unit||"",date_recorded:(new Date).toISOString()}]).select();if(t)throw t;o([...i,...a]),d({name:"",value:"",unit:""}),E.b.success("Parameter added successfully!",{position:"top-right",autoClose:3e3})}catch(e){console.error("Error adding parameter:",e),E.b.error("Error adding parameter: "+e.message,{position:"top-right",autoClose:5e3})}finally{p(!1)}else E.b.warning("Please enter both parameter name and value",{position:"top-right",autoClose:3e3})},className:"btn btn-primary w-100"},"Add")))))),h&&l.a.createElement("div",{className:"mt-4 text-end"},l.a.createElement("button",{onClick:async()=>{p(!0);try{const{data:{user:a}}=await f.auth.getUser();if(!a)throw new Error("No user logged in");const t={first_name:e.first_name||null,last_name:e.last_name||null,email:e.email||null,date_of_birth:e.date_of_birth||null,gender:e.gender||null,blood_group:e.blood_group||null,height:e.height||null,weight:e.weight||null,phone:e.phone||null,address:e.address||null,emergency_contact_name:e.emergency_contact_name||null,emergency_contact_phone:e.emergency_contact_phone||null,emergency_contact_relationship:e.emergency_contact_relationship||null,profile_picture:e.profile_picture||null,bio:e.bio||null,updated_at:(new Date).toISOString()},{error:n}=await f.from("detailed_profiles").update(t).eq("id",a.id);if(n)throw n;E.b.success("Profile updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0}),g(!1)}catch(a){E.b.error("Error updating profile: "+a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}finally{p(!1)}},className:"btn btn-success"},"Save Changes")))))))};var V=()=>{const[e,a]=Object(n.useState)({twoFactorEnabled:!1,emailNotifications:!0,loginNotifications:!0,passwordExpiry:90,maxLoginAttempts:5}),[t,r]=Object(n.useState)(!1),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(null);Object(n.useEffect)(()=>{d()},[]);const d=async()=>{try{const{data:{user:e}}=await m.auth.getUser();if(!e)return;const{data:t,error:n}=await m.from("security_settings").select("*").eq("user_id",e.id).single();if(n)throw n;t&&a(t)}catch(s){c("Failed to load security settings")}},u=e=>{const{name:t,value:n,type:l,checked:r}=e.target;a(e=>({...e,[t]:"checkbox"===l?r:n}))};return l.a.createElement("div",{className:"container mt-4"},l.a.createElement("h2",{className:"mb-4"},"Security Settings"),s&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},s),i&&l.a.createElement("div",{className:"alert alert-success",role:"alert"},i),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("form",{onSubmit:async a=>{a.preventDefault(),r(!0),c(null),o(null);try{const{data:{user:a}}=await m.auth.getUser();if(!a)throw new Error("No user found");const{error:t}=await m.from("security_settings").upsert({user_id:a.id,...e,updated_at:(new Date).toISOString()});if(t)throw t;o("Security settings updated successfully")}catch(s){c(s.message)}finally{r(!1)}}},l.a.createElement("div",{className:"mb-4"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.O,{className:"me-2"}),"Two-Factor Authentication"),l.a.createElement("div",{className:"form-check form-switch"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"twoFactorEnabled",name:"twoFactorEnabled",checked:e.twoFactorEnabled,onChange:u}),l.a.createElement("label",{className:"form-check-label",htmlFor:"twoFactorEnabled"},"Enable two-factor authentication"))),l.a.createElement("div",{className:"mb-4"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.Z,{className:"me-2"}),"Login Security"),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Maximum Login Attempts"),l.a.createElement("input",{type:"number",className:"form-control",name:"maxLoginAttempts",value:e.maxLoginAttempts,onChange:u,min:"1",max:"10"})),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Password Expiry (days)"),l.a.createElement("input",{type:"number",className:"form-control",name:"passwordExpiry",value:e.passwordExpiry,onChange:u,min:"30",max:"365"}))),l.a.createElement("div",{className:"mb-4"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.y,{className:"me-2"}),"Activity Notifications"),l.a.createElement("div",{className:"form-check mb-2"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"emailNotifications",name:"emailNotifications",checked:e.emailNotifications,onChange:u}),l.a.createElement("label",{className:"form-check-label",htmlFor:"emailNotifications"},"Email notifications for security events")),l.a.createElement("div",{className:"form-check"},l.a.createElement("input",{className:"form-check-input",type:"checkbox",id:"loginNotifications",name:"loginNotifications",checked:e.loginNotifications,onChange:u}),l.a.createElement("label",{className:"form-check-label",htmlFor:"loginNotifications"},"Notify on new device login"))),l.a.createElement("div",{className:"mb-4"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.A,{className:"me-2"}),"Password Management"),l.a.createElement("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>{}},"Change Password")),l.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:t},t?"Saving...":"Save Security Settings")))))};var X=()=>{const[e,a]=Object(n.useState)([]),[t,r]=Object(n.useState)(!1),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(null);Object(n.useEffect)(()=>{d()},[]);const d=async()=>{try{const{data:{user:e}}=await m.auth.getUser();if(!e)return;const{data:t,error:n}=await m.from("backup_history").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(n)throw n;a(t||[])}catch(s){c("Failed to load backup history")}};return l.a.createElement("div",{className:"container mt-4"},l.a.createElement("h2",{className:"mb-4"},"Data Backup & Restore"),s&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},s),i&&l.a.createElement("div",{className:"alert alert-success",role:"alert"},i),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.n,{className:"me-2"}),"Export Data"),l.a.createElement("p",{className:"card-text"},"Download a backup of your health data, including profile information, health records, appointments, and medications."),l.a.createElement("button",{className:"btn btn-primary",onClick:async()=>{r(!0),c(null),o(null);try{const{data:{user:e}}=await m.auth.getUser();if(!e)throw new Error("No user found");const[{data:a},{data:t},{data:n},{data:l},{data:s},{data:c}]=await Promise.all([m.from("profiles").select("*").eq("id",e.id).single(),m.from("health_metrics").select("*").eq("user_id",e.id),m.from("appointments").select("*").eq("user_id",e.id),m.from("medications").select("*").eq("user_id",e.id),m.from("medical_conditions").select("*").eq("user_id",e.id),m.from("health_alerts").select("*").eq("user_id",e.id)]),{data:i,error:u}=await m.from("backup_history").insert([{user_id:e.id,type:"export",status:"completed",created_at:(new Date).toISOString(),backup_data:{profile:a,healthMetrics:t,appointments:n,medications:l,medicalConditions:s,healthAlerts:c}}]).select().single();if(u)throw u;const p={profile:a,healthMetrics:t,appointments:n,medications:l,medicalConditions:s,healthAlerts:c,exportDate:(new Date).toISOString()},E=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),h=window.URL.createObjectURL(E),g=document.createElement("a");g.href=h,g.download=`digihealth-backup-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(g),g.click(),window.URL.revokeObjectURL(h),document.body.removeChild(g),o("Data exported successfully"),d()}catch(s){c(s.message)}finally{r(!1)}},disabled:t},t?"Exporting...":"Export Data"))),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.X,{className:"me-2"}),"Import Data"),l.a.createElement("p",{className:"card-text"},"Restore your health data from a previous backup file."),l.a.createElement("input",{type:"file",className:"form-control mb-3",accept:".json",onChange:async e=>{const a=e.target.files[0];if(a){r(!0),c(null),o(null);try{const{data:{user:e}}=await m.auth.getUser();if(!e)throw new Error("No user found");const t=new FileReader;t.onload=async a=>{try{const t=JSON.parse(a.target.result),{data:n,error:l}=await m.from("backup_history").insert([{user_id:e.id,type:"import",status:"completed",created_at:(new Date).toISOString()}]).select().single();if(l)throw l;t.profile&&await m.from("profiles").upsert({...t.profile,id:e.id}),t.healthMetrics&&await m.from("health_metrics").upsert(t.healthMetrics.map(a=>({...a,user_id:e.id}))),t.appointments&&await m.from("appointments").upsert(t.appointments.map(a=>({...a,user_id:e.id}))),t.medications&&await m.from("medications").upsert(t.medications.map(a=>({...a,user_id:e.id}))),t.medicalConditions&&await m.from("medical_conditions").upsert(t.medicalConditions.map(a=>({...a,user_id:e.id}))),t.healthAlerts&&await m.from("health_alerts").upsert(t.healthAlerts.map(a=>({...a,user_id:e.id}))),o("Data imported successfully"),d()}catch(s){c("Invalid backup file format")}},t.readAsText(a)}catch(s){c(s.message)}finally{r(!1)}}},disabled:t})))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.y,{className:"me-2"}),"Backup History"),l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Type"),l.a.createElement("th",null,"Status"))),l.a.createElement("tbody",null,e.map(e=>l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,new Date(e.created_at).toLocaleString()),l.a.createElement("td",null,"export"===e.type?l.a.createElement(v.n,{className:"me-1"}):l.a.createElement(v.X,{className:"me-1"}),e.type.charAt(0).toUpperCase()+e.type.slice(1)),l.a.createElement("td",null,l.a.createElement("span",{className:"badge bg-"+("completed"===e.status?"success":"warning")},e.status))))))))))))},Z=t(40);var K=()=>{const[e,a]=Object(n.useState)(!1),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)([]),i=console.log,o=console.error,m=console.warn;return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.l,{className:"me-2"}),"Database Setup"),l.a.createElement("p",{className:"card-text"},"This utility will delete all existing tables and buckets in your Supabase project and recreate them with the proper structure.",l.a.createElement("strong",{className:"text-danger"}," Use with caution as this will delete all existing data!")),t&&l.a.createElement("div",{className:`alert ${t.success?"alert-success":"alert-danger"} mt-3`,role:"alert"},t.success?l.a.createElement(v.g,{className:"me-2"}):l.a.createElement(v.q,{className:"me-2"}),t.message),l.a.createElement("div",{className:"d-grid gap-2 mt-3"},l.a.createElement("button",{className:"btn btn-danger",onClick:async()=>{a(!0),r(null),c([]),console.log=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];c(e=>[...e,{type:"info",message:a.join(" ")}]),i(...a)},console.error=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];c(e=>[...e,{type:"error",message:a.join(" ")}]),o(...a)},console.warn=function(){for(var e=arguments.length,a=new Array(e),t=0;t<e;t++)a[t]=arguments[t];c(e=>[...e,{type:"warning",message:a.join(" ")}]),m(...a)};try{const e=await Object(Z.setupSupabaseTables)();r(e)}catch(e){r({success:!1,message:"Unexpected error: "+e.message})}finally{console.log=i,console.error=o,console.warn=m,a(!1)}},disabled:e},e?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.P,{className:"me-2 fa-spin"}),"Setting up database..."):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.l,{className:"me-2"}),"Reset and Setup Database"))),s.length>0&&l.a.createElement("div",{className:"mt-4"},l.a.createElement("h6",null,"Setup Logs:"),l.a.createElement("div",{className:"border rounded p-3 bg-light",style:{maxHeight:"300px",overflow:"auto"}},s.map((e,a)=>l.a.createElement("div",{key:a,className:"mb-1 "+("error"===e.type?"text-danger":"warning"===e.type?"text-warning":"")},e.message))))))};var Q=()=>{var e;const{user:a}=u(),[t,r]=Object(n.useState)("");if(!a||"admin"!==(null===(e=a.user_metadata)||void 0===e?void 0:e.role))return l.a.createElement(i.a,{to:"/dashboard"});return l.a.createElement("div",{className:"container py-4"},l.a.createElement("h1",{className:"mb-4"},l.a.createElement(v.l,{className:"me-2"}),"Database Management"),l.a.createElement("div",{className:"alert alert-warning mb-4",role:"alert"},l.a.createElement(v.q,{className:"me-2"}),l.a.createElement("strong",null,"Warning:")," This page is for administrators only. The actions performed here will affect all users of the application."),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement(K,null)),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},l.a.createElement(v.z,{className:"me-2"}),"Database Information"),l.a.createElement("p",{className:"card-text"},"The setup process will create the following resources:"),l.a.createElement("h6",{className:"mt-3"},l.a.createElement(v.R,{className:"me-2"}),"Tables"),l.a.createElement("ul",{className:"list-group mb-3"},l.a.createElement("li",{className:"list-group-item"},"detailed_profiles"),l.a.createElement("li",{className:"list-group-item"},"profiles"),l.a.createElement("li",{className:"list-group-item"},"conditions"),l.a.createElement("li",{className:"list-group-item"},"medications"),l.a.createElement("li",{className:"list-group-item"},"appointments"),l.a.createElement("li",{className:"list-group-item"},"telehealth_consultations"),l.a.createElement("li",{className:"list-group-item"},"vitals"),l.a.createElement("li",{className:"list-group-item"},"diseases"),l.a.createElement("li",{className:"list-group-item"},"medical_reports"),l.a.createElement("li",{className:"list-group-item"},"support_tickets"),l.a.createElement("li",{className:"list-group-item"},"chat_sessions"),l.a.createElement("li",{className:"list-group-item"},"chat_messages"),l.a.createElement("li",{className:"list-group-item"},"alerts"),l.a.createElement("li",{className:"list-group-item"},"security_settings"),l.a.createElement("li",{className:"list-group-item"},"backup_history")),l.a.createElement("h6",{className:"mt-3"},l.a.createElement(v.w,{className:"me-2"}),"Storage Buckets"),l.a.createElement("ul",{className:"list-group"},l.a.createElement("li",{className:"list-group-item"},"profile-pictures"),l.a.createElement("li",{className:"list-group-item"},"medical-reports"),l.a.createElement("li",{className:"list-group-item"},"health-reports"),l.a.createElement("li",{className:"list-group-item"},"chat-attachments"),l.a.createElement("li",{className:"list-group-item"},"support-attachments")))))),l.a.createElement("div",{className:"mt-5"},l.a.createElement("button",{className:"btn btn-primary",onClick:async()=>{try{r("Setting up database...");const{error:e}=await f.rpc("setup_profiles_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS profiles (\n            id UUID REFERENCES auth.users ON DELETE CASCADE PRIMARY KEY,\n            first_name VARCHAR(255),\n            last_name VARCHAR(255),\n            date_of_birth DATE,\n            gender VARCHAR(50),\n            blood_group VARCHAR(10),\n            height DECIMAL,\n            weight DECIMAL,\n            allergies TEXT[],\n            medical_conditions TEXT[],\n            emergency_contact_name VARCHAR(255),\n            emergency_contact_phone VARCHAR(20),\n            emergency_contact_relationship VARCHAR(100),\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW()),\n            updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          -- Add RLS policies\n          ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own profile"\n            ON profiles FOR SELECT\n            USING (auth.uid() = id);\n\n          CREATE POLICY "Users can update their own profile"\n            ON profiles FOR UPDATE\n            USING (auth.uid() = id);\n\n          CREATE POLICY "Users can insert their own profile"\n            ON profiles FOR INSERT\n            WITH CHECK (auth.uid() = id);\n        '});if(e)throw e;const{error:a}=await f.rpc("setup_health_metrics_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS health_metrics (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            metric_type VARCHAR(50),\n            value DECIMAL,\n            unit VARCHAR(20),\n            recorded_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW()),\n            notes TEXT\n          );\n\n          ALTER TABLE health_metrics ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own health metrics"\n            ON health_metrics FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own health metrics"\n            ON health_metrics FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(a)throw a;const{error:t}=await f.rpc("setup_medical_analyses_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS medical_analyses (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            image_type VARCHAR(50),\n            image_url TEXT,\n            result TEXT,\n            confidence DECIMAL,\n            analyzed_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE medical_analyses ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own medical analyses"\n            ON medical_analyses FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own medical analyses"\n            ON medical_analyses FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(t)throw t;const{error:n}=await f.rpc("setup_chat_history_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS chat_history (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            message TEXT,\n            response TEXT,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE chat_history ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own chat history"\n            ON chat_history FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert into their own chat history"\n            ON chat_history FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(n)throw n;const{error:l}=await f.rpc("setup_ai_recommendations_table",{sql_command:'\n          CREATE TABLE IF NOT EXISTS ai_recommendations (\n            id UUID DEFAULT uuid_generate_v4() PRIMARY KEY,\n            user_id UUID REFERENCES profiles(id) ON DELETE CASCADE,\n            category VARCHAR(50),\n            recommendation TEXT,\n            created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE(\'utc\'::text, NOW())\n          );\n\n          ALTER TABLE ai_recommendations ENABLE ROW LEVEL SECURITY;\n\n          CREATE POLICY "Users can view their own recommendations"\n            ON ai_recommendations FOR SELECT\n            USING (auth.uid() = user_id);\n\n          CREATE POLICY "Users can insert their own recommendations"\n            ON ai_recommendations FOR INSERT\n            WITH CHECK (auth.uid() = user_id);\n        '});if(l)throw l;r("Database setup completed successfully!")}catch(e){console.error("Database setup error:",e),r("Error setting up database: "+e.message)}}},"Initialize Database"),l.a.createElement("div",{className:"mt-3"},l.a.createElement("p",null,t))))};S.f.register(S.e,S.k,S.m,S.j,S.r,S.s,S.h);var ee=e=>{let{mode:a,initialTimeRange:t="1M"}=e;const{user:r}=u(),[s,c]=Object(n.useState)([]),[i,o]=Object(n.useState)(!0),[m,d]=Object(n.useState)("bloodPressure"),[p,E]=Object(n.useState)(t),h=[{value:"bloodPressure",label:"Blood Pressure"},{value:"bloodSugar",label:"Blood Sugar"},{value:"cholesterol",label:"Cholesterol"},{value:"heartRate",label:"Heart Rate"},{value:"temperature",label:"Temperature"},{value:"weight",label:"Weight"},{value:"oxygenSaturation",label:"Oxygen Saturation"}];Object(n.useEffect)(()=>{g()},[p,m]);const g=async()=>{try{o(!0);const e={"1W":"7 days","1M":"30 days","3M":"90 days","6M":"180 days","1Y":"365 days"},{data:a,error:t}=await f.from("health_metrics").select("*").eq("user_id",r.id).gte("recorded_at",new Date(Date.now()-24*parseInt(e[p])*60*60*1e3).toISOString()).order("recorded_at",{ascending:!0});if(t)throw t;c(a||[])}catch(e){console.error("Error fetching metrics:",e)}finally{o(!1)}},b={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:h.find(e=>e.value===m).label+" Trend"}},scales:{y:{beginAtZero:!1}}};return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex justify-content-between mb-3"},l.a.createElement("select",{className:"form-select w-auto",value:m,onChange:e=>d(e.target.value)},h.map(e=>l.a.createElement("option",{key:e.value,value:e.value},e.label))),l.a.createElement("select",{className:"form-select w-auto",value:p,onChange:e=>E(e.target.value)},l.a.createElement("option",{value:"1W"},"1 Week"),l.a.createElement("option",{value:"1M"},"1 Month"),l.a.createElement("option",{value:"3M"},"3 Months"),l.a.createElement("option",{value:"6M"},"6 Months"),l.a.createElement("option",{value:"1Y"},"1 Year"))),i?l.a.createElement("div",{className:"text-center"},"Loading..."):s.length>0?l.a.createElement(M.b,{data:(()=>{const e=s.map(e=>new Date(e.recorded_at).toLocaleDateString()),a=s.map(e=>{const a=e.metrics[m];if("bloodPressure"===m){const[e]=a.split("/");return parseInt(e)}return parseFloat(a)});return{labels:e,datasets:[{label:h.find(e=>e.value===m).label,data:a,fill:!1,borderColor:"rgb(75, 192, 192)",tension:.1}]}})(),options:b}):l.a.createElement("div",{className:"text-center"},"No data available for the selected period")))};var ae=()=>{const{user:e}=u(),[a,t]=Object(n.useState)(!1),[r,s]=Object(n.useState)(null),[c,i]=Object(n.useState)(null),[o,m]=Object(n.useState)(null),[d,p]=Object(n.useState)("skin");return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h3",{className:"card-title mb-4"},"Medical Image Analysis"),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{className:"form-label"},"Image Type"),l.a.createElement("select",{className:"form-select",value:d,onChange:e=>p(e.target.value)},[{value:"skin",label:"Skin Condition"},{value:"xray",label:"X-Ray"},{value:"wound",label:"Wound/Injury"},{value:"eye",label:"Eye Condition"}].map(e=>l.a.createElement("option",{key:e.value,value:e.value},e.label)))),l.a.createElement("div",{className:"mb-4"},l.a.createElement("label",{className:"form-label"},"Upload Image"),l.a.createElement("input",{type:"file",className:"form-control",accept:"image/*",onChange:a=>{const n=a.target.files[0];n&&(async a=>{t(!0),i(null);try{const n=`${e.id}/${Date.now()}-${a.name}`,{data:l,error:r}=await f.storage.from("medical-images").upload(n,a);if(r)throw r;const{data:{publicUrl:c}}=f.storage.from("medical-images").getPublicUrl(n);m(c);const i=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Object({NODE_ENV:"production",PUBLIC_URL:"/DiGiHealthAdv",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ",REACT_APP_SUPABASE_URL:"https://aqdzmfhakqdwquszaqle.supabase.co"}).REACT_APP_OPENAI_API_KEY},body:JSON.stringify({model:"gpt-4-vision-preview",messages:[{role:"system",content:`You are a medical image analyzer specialized in ${d} conditions. Provide a detailed analysis while being cautious not to make definitive diagnoses.`},{role:"user",content:[{type:"text",text:`Please analyze this ${d} image and provide insights about what you observe. Include potential concerns and recommendations for professional medical consultation if needed.`},{type:"image_url",image_url:c}]}],max_tokens:500})}),o=await i.json(),{error:u}=await f.from("medical_analyses").insert([{user_id:e.id,image_url:c,analysis_type:d,analysis_result:o.choices[0].message.content,created_at:(new Date).toISOString()}]);if(u)throw u;s(o.choices[0].message.content)}catch(c){console.error("Error analyzing image:",c),i(c.message)}finally{t(!1)}})(n)},disabled:a})),a&&l.a.createElement("div",{className:"text-center mb-4"},l.a.createElement(v.P,{className:"spinner"}),l.a.createElement("p",null,"Analyzing image...")),o&&l.a.createElement("div",{className:"mb-4"},l.a.createElement("img",{src:o,alt:"Uploaded medical image",className:"img-fluid rounded",style:{maxHeight:"300px"}})),c&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},c),r&&l.a.createElement("div",{className:"mt-4"},l.a.createElement("h5",null,"Analysis Results:"),l.a.createElement("div",{className:"card bg-light"},l.a.createElement("div",{className:"card-body"},l.a.createElement("pre",{className:"mb-0",style:{whiteSpace:"pre-wrap"}},r))))))};var te=()=>{const{user:e}=u(),[a,t]=Object(n.useState)([]),[r,s]=Object(n.useState)(""),[c,i]=Object(n.useState)(!1),[o,m]=Object(n.useState)("chat"),d=Object(n.useRef)(null);Object(n.useEffect)(()=>{(()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})})()},[a]);const p=()=>{switch(o){case"diet":return"You are a nutritionist AI assistant. Provide personalized diet recommendations based on user's health conditions and goals. Always emphasize the importance of consulting healthcare providers before making significant dietary changes.";case"firstAid":return"You are a first aid instruction AI assistant. Provide clear, step-by-step first aid guidance for non-emergency situations. Always emphasize when professional medical attention is needed and include emergency contact recommendations when appropriate.";default:return"You are a helpful medical assistant. Explain medical terms in simple language and provide general health information. Always remind users to consult healthcare professionals for proper medical advice."}},E=async()=>{if(!r.trim())return;const n=r.trim();s(""),i(!0);const l={role:"user",content:n,timestamp:(new Date).toISOString()};t(e=>[...e,l]);try{const{data:l}=await f.from("profiles").select("medical_conditions, allergies, current_medications").eq("id",e.id).single(),r=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+Object({NODE_ENV:"production",PUBLIC_URL:"/DiGiHealthAdv",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFxZHptZmhha3Fkd3F1c3phcWxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE0MDgyNTAsImV4cCI6MjA0Njk4NDI1MH0.4euPXQKyddaJuGhf5Etqdla8LF-h-p-gs1uVxw6dutQ",REACT_APP_SUPABASE_URL:"https://aqdzmfhakqdwquszaqle.supabase.co"}).REACT_APP_OPENAI_API_KEY},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:p()},{role:"user",content:`User's health context - Medical conditions: ${l.medical_conditions.join(", ")}, Allergies: ${l.allergies.join(", ")}, Current medications: ${l.current_medications.join(", ")}`},...a.map(e=>({role:e.role,content:e.content})),{role:"user",content:n}],temperature:.7,max_tokens:500})}),s=await r.json();t(e=>[...e,{role:"assistant",content:s.choices[0].message.content,timestamp:(new Date).toISOString()}]),await f.from("chat_history").insert([{user_id:e.id,mode:o,message:n,response:s.choices[0].message.content,created_at:(new Date).toISOString()}])}catch(c){console.error("Error:",c),t(e=>[...e,{role:"assistant",content:"I apologize, but I encountered an error. Please try again.",timestamp:(new Date).toISOString()}])}finally{i(!1)}};return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},l.a.createElement("h3",{className:"card-title mb-0"},"diet"===o?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.bb,{className:"me-2"})," Diet Assistant"):"firstAid"===o?l.a.createElement(l.a.Fragment,null,l.a.createElement(v.v,{className:"me-2"})," First Aid Guide"):l.a.createElement(l.a.Fragment,null,l.a.createElement(v.M,{className:"me-2"})," Health Assistant")),l.a.createElement("div",{className:"btn-group"},l.a.createElement("button",{className:"btn btn-"+("chat"===o?"primary":"outline-primary"),onClick:()=>m("chat")},"Chat"),l.a.createElement("button",{className:"btn btn-"+("diet"===o?"primary":"outline-primary"),onClick:()=>m("diet")},"Diet"),l.a.createElement("button",{className:"btn btn-"+("firstAid"===o?"primary":"outline-primary"),onClick:()=>m("firstAid")},"First Aid"))),l.a.createElement("div",{className:"chat-container bg-light p-3 rounded",style:{height:"400px",overflowY:"auto"}},a.map((e,a)=>l.a.createElement("div",{key:a,className:`d-flex ${"user"===e.role?"justify-content-end":"justify-content-start"} mb-3`},l.a.createElement("div",{className:("user"===e.role?"bg-primary text-white":"bg-white")+" p-3 rounded shadow-sm",style:{maxWidth:"75%"}},l.a.createElement("div",{className:"d-flex align-items-center mb-1"},"user"===e.role?l.a.createElement(v.Y,{className:"me-2"}):l.a.createElement(v.M,{className:"me-2"}),l.a.createElement("small",{className:"text-muted"},new Date(e.timestamp).toLocaleTimeString())),l.a.createElement("div",{style:{whiteSpace:"pre-wrap"}},e.content)))),l.a.createElement("div",{ref:d})),l.a.createElement("div",{className:"mt-3 d-flex"},l.a.createElement("input",{type:"text",className:"form-control me-2",value:r,onChange:e=>s(e.target.value),onKeyPress:e=>"Enter"===e.key&&E(),placeholder:"diet"===o?"Ask about diet recommendations...":"firstAid"===o?"Ask about first aid instructions...":"Ask your health-related question...",disabled:c}),l.a.createElement("button",{className:"btn btn-primary",onClick:E,disabled:c||!r.trim()},c?l.a.createElement(v.P,{className:"spinner"}):l.a.createElement(v.H,null)))))};S.f.register(S.e,S.k,S.m,S.j,S.c,S.a,S.p,S.r,S.s,S.h);var ne=()=>{const{user:e}=u(),[a,t]=Object(n.useState)({healthTrends:[],imageAnalyses:[],chatHistory:[],recommendations:[]}),[r,s]=Object(n.useState)("week"),[c,i]=Object(n.useState)("all");Object(n.useEffect)(()=>{o()},[e,r,c]);const o=async()=>{try{const[a,n,l,r]=await Promise.all([f.from("health_metrics").select("*").eq("user_id",e.id).order("recorded_at",{ascending:!1}),f.from("medical_analyses").select("*").eq("user_id",e.id).order("analyzed_at",{ascending:!1}),f.from("chat_history").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}),f.from("ai_recommendations").select("*").eq("user_id",e.id).order("created_at",{ascending:!1})]);t({healthTrends:a.data||[],imageAnalyses:n.data||[],chatHistory:l.data||[],recommendations:r.data||[]})}catch(a){console.error("Error fetching AI insights:",a)}};return l.a.createElement("div",{className:"ai-insights-container"},l.a.createElement("h1",{className:"text-center mb-4"},"AI Health Insights Dashboard"),l.a.createElement("div",{className:"controls-section mb-4"},l.a.createElement("select",{value:r,onChange:e=>s(e.target.value),className:"form-select me-2"},l.a.createElement("option",{value:"week"},"Last Week"),l.a.createElement("option",{value:"month"},"Last Month"),l.a.createElement("option",{value:"year"},"Last Year")),l.a.createElement("select",{value:c,onChange:e=>i(e.target.value),className:"form-select"},l.a.createElement("option",{value:"all"},"All Metrics"),l.a.createElement("option",{value:"vitals"},"Vital Signs"),l.a.createElement("option",{value:"lab"},"Lab Results"),l.a.createElement("option",{value:"lifestyle"},"Lifestyle"))),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",null,l.a.createElement(v.f,null)," Health Trends Analysis")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement(M.b,{data:{labels:a.healthTrends.map(e=>new Date(e.recorded_at).toLocaleDateString()),datasets:[{label:"Health Score",data:a.healthTrends.map(e=>e.value),borderColor:"rgb(75, 192, 192)",tension:.1}]},options:{responsive:!0,plugins:{title:{display:!0,text:"Health Metrics Over Time"}}}})),l.a.createElement("div",{className:"col-md-6"},l.a.createElement(M.d,{data:{labels:["Blood Pressure","Heart Rate","Blood Sugar","Sleep","Exercise","Diet"],datasets:[{label:"Current Status",data:[65,75,70,80,60,85],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgb(75, 192, 192)",pointBackgroundColor:"rgb(75, 192, 192)"}]}}))))),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",null,l.a.createElement(v.u,null)," Medical Image Analysis History")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"table-responsive"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Image Type"),l.a.createElement("th",null,"Analysis Result"),l.a.createElement("th",null,"Confidence"))),l.a.createElement("tbody",null,a.imageAnalyses.map((e,a)=>l.a.createElement("tr",{key:a},l.a.createElement("td",null,new Date(e.analyzed_at).toLocaleDateString()),l.a.createElement("td",null,e.image_type),l.a.createElement("td",null,e.result),l.a.createElement("td",null,e.confidence,"%")))))))),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",null,l.a.createElement(v.c,null)," AI Health Recommendations")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement(M.c,{data:{labels:["Diet","Exercise","Sleep","Medication","Lifestyle"],datasets:[{data:[30,25,20,15,10],backgroundColor:["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF"]}]},options:{plugins:{title:{display:!0,text:"Recommendation Categories"}}}})),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"recommendations-list"},a.recommendations.slice(0,5).map((e,a)=>l.a.createElement("div",{key:a,className:"recommendation-item"},l.a.createElement("h5",null,e.category),l.a.createElement("p",null,e.recommendation)))))))),l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-header"},l.a.createElement("h3",null,l.a.createElement(v.M,null)," Health Assistant Interactions")),l.a.createElement("div",{className:"card-body"},l.a.createElement(M.a,{data:{labels:["Diet Queries","Symptom Analysis","Medical Terms","First Aid","General Health"],datasets:[{label:"Interaction Distribution",data:[45,32,28,15,30],backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgb(75, 192, 192)",borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}}}}))))};var le=()=>{const[e,a]=Object(n.useState)(!0),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(null),[i,o]=Object(n.useState)(null);Object(n.useEffect)(()=>{d()},[]);const d=async()=>{try{const{data:{user:e}}=await m.auth.getUser();if(!e)throw new Error("No user logged in");const t={weight:[{date:"2024-01-01",value:70},{date:"2024-02-01",value:69},{date:"2024-03-01",value:68}],bloodPressure:[{date:"2024-01-01",systolic:120,diastolic:80},{date:"2024-02-01",systolic:118,diastolic:78},{date:"2024-03-01",systolic:122,diastolic:82}],heartRate:[{date:"2024-01-01",value:72},{date:"2024-02-01",value:70},{date:"2024-03-01",value:71}]};c(t),u(t)}catch(t){console.error("Error fetching health metrics:",t),r("Failed to load health metrics")}finally{a(!1)}},u=e=>{o({weight:{trend:"decreasing",change:-2,recommendation:"Your weight shows a healthy decreasing trend. Keep up the good work!"},bloodPressure:{trend:"stable",recommendation:"Your blood pressure remains within normal range. Continue monitoring regularly."},heartRate:{trend:"stable",recommendation:"Your heart rate is consistent and within healthy range."},overall:{status:"Good",recommendations:["Maintain current lifestyle habits","Continue regular exercise","Keep monitoring your metrics"]}})};return e?l.a.createElement("div",{className:"text-center py-4"},l.a.createElement(_,null)):t?l.a.createElement("div",{className:"alert alert-danger m-4"},t):l.a.createElement("div",{className:"container py-4"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-12"},l.a.createElement("h2",{className:"mb-4"},"AI Health Metrics Analysis"),s&&i&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h4",null,"Overall Health Status: ",l.a.createElement("span",{className:"text-success"},i.overall.status)),l.a.createElement("div",{className:"mt-3"},l.a.createElement("h5",null,"Key Findings:"),l.a.createElement("ul",{className:"list-group list-group-flush"},l.a.createElement("li",{className:"list-group-item"},l.a.createElement("strong",null,"Weight:")," ",i.weight.recommendation),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("strong",null,"Blood Pressure:")," ",i.bloodPressure.recommendation),l.a.createElement("li",{className:"list-group-item"},l.a.createElement("strong",null,"Heart Rate:")," ",i.heartRate.recommendation))))),l.a.createElement("div",{className:"card mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h4",null,"Recommendations"),l.a.createElement("ul",{className:"list-group list-group-flush"},i.overall.recommendations.map((e,a)=>l.a.createElement("li",{key:a,className:"list-group-item"},l.a.createElement("i",{className:"fas fa-check-circle text-success me-2"}),e))))),l.a.createElement("div",{className:"alert alert-info"},l.a.createElement("i",{className:"fas fa-info-circle me-2"}),"This analysis is based on your recorded health metrics. For personalized medical advice, please consult with your healthcare provider.")))))};const re=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const t=await fetch("https://digihealth-backend.onrender.com/api/analyze-report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,...a})});if(!t.ok)throw new Error("API request failed");return await t.json()}catch(t){throw console.error("Error calling OpenAI API:",t),t}};t(67);var se=()=>{const[e,a]=Object(n.useState)(null),[t,r]=Object(n.useState)(null),[s,c]=Object(n.useState)(!1),[i,o]=Object(n.useState)(null),[d,u]=Object(n.useState)(null),[p,E]=Object(n.useState)(null),[h,g]=Object(n.useState)("general"),b=Object(n.useRef)(null),y=e=>{const a="This AI analysis is not a substitute for professional medical diagnosis. Please consult with a healthcare provider for proper evaluation and diagnosis.";return{skin:a+" Skin conditions particularly require in-person examination as many can appear similar in images.",xray:a+" X-ray interpretation requires board-certified radiologists for official diagnosis.",scan:a+" CT/MRI scans are complex and require specialized medical training to properly diagnose.",pathology:a+" Pathology diagnosis requires microscopic examination by a certified pathologist."}[e]||a},f=async a=>{try{const{data:{user:t}}=await m.auth.getUser();if(!t)return;const n=e.name.split(".").pop(),l=`${t.id}/${Date.now()}.${n}`,{error:r}=await m.storage.from("medical-images").upload(l,e);if(r)throw r;const{data:{publicUrl:s}}=m.storage.from("medical-images").getPublicUrl(l);await m.from("image_analyses").insert({user_id:t.id,image_url:s,analysis_type:h,analysis_result:a,created_at:(new Date).toISOString()})}catch(d){console.error("Error saving analysis:",d)}};return l.a.createElement("div",{className:"container-fluid py-4"},p&&l.a.createElement("div",{className:`alert alert-${p.type} alert-dismissible fade show`},p.message,l.a.createElement("button",{type:"button",className:"btn-close",onClick:()=>E(null)})),l.a.createElement("h1",{className:"mb-4"},"Medical Image Analysis"),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-6"},l.a.createElement("div",{className:"card shadow-sm mb-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},"Upload Medical Image"),l.a.createElement("p",{className:"card-text text-muted"},"Upload a medical image for AI analysis. Supported types: X-rays, skin conditions, CT/MRI scans, pathology slides."),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"analysisType",className:"form-label"},"Analysis Type"),l.a.createElement("select",{id:"analysisType",className:"form-select",value:h,onChange:e=>g(e.target.value)},l.a.createElement("option",{value:"general"},"General Medical Image Analysis"),l.a.createElement("option",{value:"skin"},"Skin Condition/Lesion"),l.a.createElement("option",{value:"xray"},"X-Ray"),l.a.createElement("option",{value:"scan"},"CT/MRI Scan"),l.a.createElement("option",{value:"pathology"},"Pathology Slide"))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"imageUpload",className:"form-label"},"Upload Image"),l.a.createElement("input",{type:"file",className:"form-control",id:"imageUpload",accept:"image/*",onChange:e=>{const t=e.target.files[0];t&&(t.type.match("image.*")?(a(t),r(URL.createObjectURL(t)),o(null),u(null)):E({type:"danger",message:"Please upload a valid image file (JPEG, PNG, etc.)"}))},ref:b})),t&&l.a.createElement("div",{className:"mb-3 text-center"},l.a.createElement("img",{src:t,alt:"Preview",className:"img-fluid mb-2 border rounded",style:{maxHeight:"300px"}})),l.a.createElement("div",{className:"d-grid gap-2"},l.a.createElement("button",{className:"btn btn-primary",onClick:async()=>{if(e){c(!0),u(null);try{const a=new FileReader;a.readAsDataURL(e),a.onloadend=async()=>{const e=a.result;try{const a=`\n            You are a medical imaging specialist AI. Analyze this medical image and provide detailed observations.\n            ${(e=>{const a="You are a medical imaging specialist AI. Analyze this medical image and provide detailed observations. ",t={general:a+"Describe what you see, potential abnormalities, and possible conditions it might indicate. Be thorough but cautious about making definitive diagnoses.",skin:a+"This is a skin-related image. Describe the lesion/condition characteristics, possible differential diagnoses, and any concerning features. Mention if further evaluation is recommended.",xray:a+"This is an X-ray image. Describe the visible structures, any abnormalities, potential fractures, lesions, or other findings. Interpret the image as thoroughly as possible.",scan:a+"This is a CT/MRI scan. Describe the visible anatomical structures, any abnormalities, masses, inflammations, or other noteworthy findings. Provide detailed analysis of tissue characteristics.",pathology:a+"This is a pathology slide. Describe the cellular structures, any abnormal cells, patterns, or markers of disease. Analyze tissue architecture and cellular morphology."};return t[e]||t.general})(h)}\n            \n            Please provide your analysis in this format:\n            {\n              "findings": [list of key findings],\n              "interpretation": [detailed analysis],\n              "recommendations": [any recommended follow-ups],\n              "differential_diagnosis": [possible conditions to consider]\n            }\n          `,t=await re(a,{imageUrl:e,analysisType:h,isImageAnalysis:!0});o({analysis:t.interpretation||t,findings:t.findings||[],recommendations:t.recommendations||[],date:(new Date).toISOString(),disclaimer:y(h),imageType:h}),f(t.interpretation||t)}catch(t){console.error("API error:",t),u("Error analyzing image. Please try again or use a different image.")}c(!1)},a.onerror=()=>{u("Error reading image file. Please try again with a different image."),c(!1)}}catch(a){console.error("Error processing image:",a),u("Error processing image. Please try again."),c(!1)}}},disabled:!e||s},s?l.a.createElement(l.a.Fragment,null,l.a.createElement(_,{size:"sm"})," Analyzing..."):"Analyze Image"),l.a.createElement("button",{className:"btn btn-outline-secondary",onClick:()=>{a(null),r(null),o(null),u(null),b.current&&(b.current.value="")},disabled:s},"Reset"))))),l.a.createElement("div",{className:"col-lg-6"},s?l.a.createElement("div",{className:"card shadow-sm mb-4"},l.a.createElement("div",{className:"card-body text-center py-5"},l.a.createElement(_,null),l.a.createElement("p",{className:"mt-3"},"Analyzing your medical image..."),l.a.createElement("p",{className:"text-muted small"},"This may take a moment"))):i?l.a.createElement("div",{className:"card shadow-sm mb-4"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h5",{className:"card-title mb-0"},"Analysis Results")),l.a.createElement("div",{className:"card-body"},l.a.createElement("div",{className:"analysis-content"},i.analysis.split("\n").map((e,a)=>e?l.a.createElement("p",{key:a},e):l.a.createElement("br",{key:a}))),l.a.createElement("div",{className:"alert alert-warning mt-3"},l.a.createElement("strong",null,"Important Disclaimer:")," ",i.disclaimer)),l.a.createElement("div",{className:"card-footer text-muted"},l.a.createElement("small",null,"Analysis generated on ",new Date(i.date).toLocaleString()))):d?l.a.createElement("div",{className:"alert alert-danger"},d):l.a.createElement("div",{className:"card shadow-sm mb-4"},l.a.createElement("div",{className:"card-body p-5 text-center"},l.a.createElement("div",{className:"text-muted mb-3"},l.a.createElement("i",{className:"fas fa-microscope fa-3x"})),l.a.createElement("h5",null,"Upload an image to see analysis results"),l.a.createElement("p",{className:"text-muted"},"The AI will analyze your medical image and provide insights."))))),l.a.createElement("div",{className:"mt-4"},l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",null,"About Medical Image Analysis"),l.a.createElement("p",null,"This feature uses AI to analyze various types of medical images. Please note that this is not a substitute for professional medical diagnosis. Always consult with a healthcare provider for proper evaluation."),l.a.createElement("div",{className:"row g-4 mt-2"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("h6",null,"Common Uses"),l.a.createElement("ul",null,l.a.createElement("li",null,"Preliminary analysis of skin conditions"),l.a.createElement("li",null,"Identifying potential areas of concern in X-rays"),l.a.createElement("li",null,"Understanding CT/MRI scan information"),l.a.createElement("li",null,"Analyzing pathology slides"))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("h6",null,"Limitations"),l.a.createElement("ul",null,l.a.createElement("li",null,"Not a replacement for professional diagnosis"),l.a.createElement("li",null,"Quality of analysis depends on image quality"),l.a.createElement("li",null,"May not detect all conditions or abnormalities"),l.a.createElement("li",null,"Should be used for educational purposes only"))))))))};t(68);var ce=()=>{var e;const[a,t]=Object(n.useState)(!1),[r,s]=Object(n.useState)(null),[c,o]=Object(n.useState)(null),[m,d]=Object(n.useState)(null),[u,p]=Object(n.useState)([]),[E,h]=Object(n.useState)("general"),[g,b]=Object(n.useState)(""),[y,N]=Object(n.useState)(null),v=Object(i.q)(),w=[{id:"general",label:"General Health"},{id:"nutrition",label:"Nutrition & Diet"},{id:"fitness",label:"Fitness & Exercise"},{id:"sleep",label:"Sleep Improvement"},{id:"stress",label:"Stress Management"},{id:"chronic",label:"Chronic Condition Management"}];Object(n.useEffect)(()=>{(async()=>{try{const{data:{user:e}}=await f.auth.getUser();if(!e)return void v("/login");s(e.id),S(e.id),x(e.id)}catch(y){console.error("Error checking authentication",y)}})()},[v]);const S=async e=>{try{var a,t;const{data:n,error:l}=await f.from("profiles").select("\n          first_name, \n          last_name, \n          date_of_birth, \n          gender, \n          height, \n          weight,\n          user_conditions (\n            condition_name\n          ),\n          user_medications (\n            medication_name,\n            dosage\n          ),\n          health_metrics (*)\n        ").eq("id",e).single();if(l)throw l;let r=null;if(n.height&&n.weight){const e=n.height/100;r=(n.weight/(e*e)).toFixed(1)}o({...n,bmi:r,conditions:(null===(a=n.user_conditions)||void 0===a?void 0:a.map(e=>e.condition_name))||[],medications:(null===(t=n.user_medications)||void 0===t?void 0:t.map(e=>e.medication_name))||[]})}catch(y){console.error("Error fetching profile",y)}},x=async e=>{try{const{data:a,error:t}=await f.from("health_recommendations").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(t)throw t;p(a||[])}catch(y){console.error("Error fetching recommendation history",y)}},A=async e=>{try{const{error:a}=await f.from("health_recommendations").insert([{user_id:r,focus_area:e.focus_area,recommendations:JSON.stringify(e),created_at:e.created_at}]);if(a)throw a}catch(y){console.error("Error saving recommendations:",y)}},C=e=>{if(!e)return"Unknown";const a=new Date,t=new Date(e);let n=a.getFullYear()-t.getFullYear();const l=a.getMonth()-t.getMonth();return(l<0||0===l&&a.getDate()<t.getDate())&&n--,n};return l.a.createElement("div",{className:"container py-4"},l.a.createElement("h1",{className:"mb-4"},"AI Health Recommendations"),y&&l.a.createElement("div",{className:"alert alert-danger",role:"alert"},y),l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"col-lg-4 mb-4"},l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",{className:"card-title"},"Generate Recommendations"),c?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"focusArea",className:"form-label"},"Focus Area"),l.a.createElement("select",{id:"focusArea",className:"form-select",value:E,onChange:e=>h(e.target.value),disabled:a},w.map(e=>l.a.createElement("option",{key:e.id,value:e.id},e.label)))),l.a.createElement("div",{className:"mb-3"},l.a.createElement("label",{htmlFor:"additionalContext",className:"form-label"},"Additional Context (Optional)"),l.a.createElement("textarea",{id:"additionalContext",className:"form-control",rows:"3",placeholder:"Add any specific concerns or goals...",value:g,onChange:e=>b(e.target.value),disabled:a})),l.a.createElement("button",{className:"btn btn-primary w-100",onClick:async()=>{if(t(!0),N(null),!c)return N("Please complete your health profile first."),void t(!1);try{const e=`\n        You are a health and wellness advisor. Based on the following user profile, provide personalized health recommendations.\n        \n        User Profile:\n        - Age: ${C(c.date_of_birth)}\n        - Gender: ${c.gender||"Not specified"}\n        - Height: ${c.height?c.height+" cm":"Not provided"}\n        - Weight: ${c.weight?c.weight+" kg":"Not provided"}\n        - BMI: ${c.bmi||"Not calculated"}\n        ${c.conditions.length>0?"- Medical Conditions: "+c.conditions.join(", "):"- No medical conditions specified"}\n        ${c.medications.length>0?"- Medications: "+c.medications.join(", "):"- No medications specified"}\n        \n        Focus area: ${E}\n        \n        ${g?"Additional context: "+g:""}\n        \n        Please provide detailed health recommendations specific to the focus area. Include:\n        1. A summary of key recommendations\n        2. Detailed explanations and guidance\n        3. Specific actionable steps\n        4. Any relevant warnings or precautions\n        \n        Format your response as a JSON object with these keys:\n        - summary: A brief summary of recommendations (1-2 sentences)\n        - recommendations: Array of specific recommendation objects, each with:\n          - title: Short title for the recommendation\n          - description: Detailed explanation\n          - action_steps: Array of specific action steps\n        - warnings: Any important precautions or warnings\n      `,a=await re(e),n={focus_area:E,summary:a.summary||"",recommendations:a.recommendations||[],warnings:a.warnings||[],created_at:(new Date).toISOString()};d(n),await A(n),x(r)}catch(y){console.error("Error generating recommendations:",y),N("Failed to generate recommendations. Please try again later.")}finally{t(!1)}},disabled:a},a?l.a.createElement(l.a.Fragment,null,l.a.createElement(_,{size:"sm"})," Generating..."):"Generate Recommendations")):l.a.createElement("div",{className:"alert alert-warning"},"Please complete your health profile to receive personalized recommendations.",l.a.createElement("div",{className:"mt-3"},l.a.createElement("button",{className:"btn btn-primary",onClick:()=>v("/profile")},"Complete Profile"))),u.length>0&&l.a.createElement("div",{className:"mt-4"},l.a.createElement("h6",null,"Previous Recommendations"),l.a.createElement("div",{className:"list-group",style:{maxHeight:"250px",overflowY:"auto"}},u.map(e=>{var a;return l.a.createElement("button",{key:e.id,className:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",onClick:()=>(async e=>{try{const a=u.find(a=>a.id===e);a&&d(JSON.parse(a.recommendations))}catch(y){console.error("Error viewing historical recommendation:",y)}})(e.id)},l.a.createElement("div",null,l.a.createElement("div",null,(null===(a=w.find(a=>a.id===e.focus_area))||void 0===a?void 0:a.label)||e.focus_area),l.a.createElement("small",{className:"text-muted"},new Date(e.created_at).toLocaleDateString())),l.a.createElement("span",{className:"badge bg-primary rounded-pill"},"View"))})))))),l.a.createElement("div",{className:"col-lg-8"},a?l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-body text-center py-5"},l.a.createElement(_,null),l.a.createElement("p",{className:"mt-3"},"Generating personalized health recommendations..."),l.a.createElement("p",{className:"text-muted small"},"This may take a moment as our AI analyzes your health profile"))):m?l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-header bg-primary text-white"},l.a.createElement("h5",{className:"mb-0"},(null===(e=w.find(e=>e.id===m.focus_area))||void 0===e?void 0:e.label)||m.focus_area," Recommendations")),l.a.createElement("div",{className:"card-body"},l.a.createElement("p",{className:"lead"},m.summary),l.a.createElement("div",{className:"recommendations-list mt-4"},m.recommendations.map((e,a)=>{var t;return l.a.createElement("div",{key:a,className:"recommendation-item mb-4"},l.a.createElement("h5",null,e.title),l.a.createElement("p",null,e.description),(null===(t=e.action_steps)||void 0===t?void 0:t.length)>0&&l.a.createElement("div",{className:"action-steps"},l.a.createElement("h6",null,"Action Steps:"),l.a.createElement("ul",null,e.action_steps.map((e,a)=>l.a.createElement("li",{key:a},e)))))})),m.warnings&&l.a.createElement("div",{className:"alert alert-warning mt-3"},l.a.createElement("h6",null,"Important Notes:"),l.a.createElement("p",null,m.warnings)),l.a.createElement("div",{className:"disclaimer mt-4"},l.a.createElement("small",{className:"text-muted"},l.a.createElement("strong",null,"Disclaimer:")," These recommendations are generated by AI based on your profile information. They are not a substitute for professional medical advice. Always consult with healthcare providers before making significant changes to your health regimen."))),l.a.createElement("div",{className:"card-footer text-muted"},l.a.createElement("small",null,"Generated on ",new Date(m.created_at).toLocaleString()))):l.a.createElement("div",{className:"card shadow-sm"},l.a.createElement("div",{className:"card-body p-5 text-center"},l.a.createElement("div",{className:"text-muted mb-3"},l.a.createElement("i",{className:"fas fa-lightbulb fa-3x"})),l.a.createElement("h5",null,"Select a focus area and generate recommendations"),l.a.createElement("p",{className:"text-muted"},"Our AI will analyze your health profile and provide personalized recommendations based on your specific needs and goals."))),l.a.createElement("div",{className:"card shadow-sm mt-4"},l.a.createElement("div",{className:"card-body"},l.a.createElement("h5",null,"How We Create Your Recommendations"),l.a.createElement("p",null,"Our AI-powered recommendation system uses multiple data points from your health profile to generate personalized health guidance:"),l.a.createElement("div",{className:"row g-4"},l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"d-flex mb-2"},l.a.createElement("div",{className:"me-3 text-primary"},l.a.createElement("i",{className:"fas fa-user-circle fa-lg"})),l.a.createElement("div",null,l.a.createElement("h6",null,"Your Profile"),l.a.createElement("p",{className:"text-muted small mb-0"},"Age, gender, height, weight, and BMI are used to tailor recommendations to your body type and demographics.")))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"d-flex mb-2"},l.a.createElement("div",{className:"me-3 text-primary"},l.a.createElement("i",{className:"fas fa-notes-medical fa-lg"})),l.a.createElement("div",null,l.a.createElement("h6",null,"Medical Conditions"),l.a.createElement("p",{className:"text-muted small mb-0"},"Any conditions listed in your profile are considered to ensure recommendations are appropriate and safe.")))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"d-flex mb-2"},l.a.createElement("div",{className:"me-3 text-primary"},l.a.createElement("i",{className:"fas fa-chart-line fa-lg"})),l.a.createElement("div",null,l.a.createElement("h6",null,"Health Parameters"),l.a.createElement("p",{className:"text-muted small mb-0"},"Your recorded health metrics like blood pressure, cholesterol, and glucose levels inform specific health guidance.")))),l.a.createElement("div",{className:"col-md-6"},l.a.createElement("div",{className:"d-flex"},l.a.createElement("div",{className:"me-3 text-primary"},l.a.createElement("i",{className:"fas fa-brain fa-lg"})),l.a.createElement("div",null,l.a.createElement("h6",null,"AI Analysis"),l.a.createElement("p",{className:"text-muted small mb-0"},"Advanced AI models analyze your complete health profile to generate evidence-based recommendations specific to your selected focus area."))))),l.a.createElement("div",{className:"alert alert-info mt-3 mb-0"},l.a.createElement("small",null,l.a.createElement("strong",null,"Privacy Note:")," Your health data is processed securely. We use anonymized data when communicating with AI services to ensure your privacy is protected.")))))))};var ie=function(){return l.a.createElement(c.a,{basename:"/DiGiHealthAdv"},l.a.createElement(p,null,l.a.createElement(E.a,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"colored"}),l.a.createElement(i.d,null,l.a.createElement(i.b,{path:"/",element:l.a.createElement(N,null)}),l.a.createElement(i.b,{path:"/register",element:l.a.createElement(w,null)}),l.a.createElement(i.b,{path:"/dashboard",element:l.a.createElement(y,null,l.a.createElement(x,null))}),l.a.createElement(i.b,{path:"/health-overview",element:l.a.createElement(y,null,l.a.createElement(F,null))}),l.a.createElement(i.b,{path:"/medical-history",element:l.a.createElement(y,null,l.a.createElement(R,null))}),l.a.createElement(i.b,{path:"/chronic-disease-management",element:l.a.createElement(y,null,l.a.createElement(q,null))}),l.a.createElement(i.b,{path:"/vaccination-history",element:l.a.createElement(y,null,l.a.createElement(L,null))}),l.a.createElement(i.b,{path:"/medication-tracker",element:l.a.createElement(y,null,l.a.createElement(P,null))}),l.a.createElement(i.b,{path:"/health-analytics",element:l.a.createElement(y,null,l.a.createElement(U,null))}),l.a.createElement(i.b,{path:"/appointments/upcoming",element:l.a.createElement(y,null,l.a.createElement(H,null))}),l.a.createElement(i.b,{path:"/appointments/history",element:l.a.createElement(y,null,l.a.createElement(B,null))}),l.a.createElement(i.b,{path:"/appointments/telehealth",element:l.a.createElement(y,null,l.a.createElement(Y,null))}),l.a.createElement(i.b,{path:"/appointments/reminders",element:l.a.createElement(y,null,l.a.createElement($,null))}),l.a.createElement(i.b,{path:"/help-center",element:l.a.createElement(y,null,l.a.createElement(z,null))}),l.a.createElement(i.b,{path:"/support/contact",element:l.a.createElement(y,null,l.a.createElement(W,null))}),l.a.createElement(i.b,{path:"/support/chat",element:l.a.createElement(y,null,l.a.createElement(G,null))}),l.a.createElement(i.b,{path:"/profile",element:l.a.createElement(y,null,l.a.createElement(J,null))}),l.a.createElement(i.b,{path:"/settings/security",element:l.a.createElement(y,null,l.a.createElement(V,null))}),l.a.createElement(i.b,{path:"/settings/backup",element:l.a.createElement(y,null,l.a.createElement(X,null))}),l.a.createElement(i.b,{path:"/admin/database-setup",element:l.a.createElement(y,null,l.a.createElement(Q,null))}),l.a.createElement(i.b,{path:"/health-metrics",element:l.a.createElement(y,null,l.a.createElement(ee,null))}),l.a.createElement(i.b,{path:"/image-analysis",element:l.a.createElement(y,null,l.a.createElement(ae,null))}),l.a.createElement(i.b,{path:"/health-assistant",element:l.a.createElement(y,null,l.a.createElement(te,null))}),l.a.createElement(i.b,{path:"/ai-insights",element:l.a.createElement(y,null,l.a.createElement(ne,null))}),l.a.createElement(i.b,{path:"/health-metrics/upload",element:l.a.createElement(y,null,l.a.createElement(ee,{mode:"upload"}))}),l.a.createElement(i.b,{path:"/image-analysis/history",element:l.a.createElement(y,null,l.a.createElement(ae,{mode:"history"}))}),l.a.createElement(i.b,{path:"/health-assistant/recommendations",element:l.a.createElement(y,null,l.a.createElement(te,{mode:"recommendations"}))}),l.a.createElement(i.b,{path:"/ai/health-metrics",element:l.a.createElement(y,null,l.a.createElement(le,null))}),l.a.createElement(i.b,{path:"/ai/image-analysis",element:l.a.createElement(y,null,l.a.createElement(se,null))}),l.a.createElement(i.b,{path:"/ai/health-assistant",element:l.a.createElement(y,null,l.a.createElement(te,null))}),l.a.createElement(i.b,{path:"/ai/health-recommendations",element:l.a.createElement(y,null,l.a.createElement(ce,null))}),l.a.createElement(i.b,{path:"/ai/symptom-checker",element:l.a.createElement(y,null,l.a.createElement(te,{mode:"symptoms"}))}),l.a.createElement(i.b,{path:"/ai/image-analysis",element:l.a.createElement(se,null)}),l.a.createElement(i.b,{path:"/ai/health-assistant",element:l.a.createElement(te,null)}),l.a.createElement(i.b,{path:"/ai/health-recommendations",element:l.a.createElement(ce,null)}))))};const oe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function me(e,a){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;null!=t&&(t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}var de=e=>{e&&e instanceof Function&&t.e(3).then(t.bind(null,80)).then(a=>{let{getCLS:t,getFID:n,getFCP:l,getLCP:r,getTTFB:s}=a;t(e),n(e),l(e),r(e),s(e)})};s.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(ie,null))),function(e){if("serviceWorker"in navigator){if(new URL("/DiGiHealthAdv",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const a="/DiGiHealthAdv/service-worker.js";oe?(!function(e,a){fetch(e,{headers:{"Service-Worker":"script"}}).then(t=>{const n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):me(e,a)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(a,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})):me(a,e)})}}(),de()}},[[44,1,2]]]);
//# sourceMappingURL=main.bd06318a.chunk.js.map